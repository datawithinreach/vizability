/*! For license information please see main.0e8b0dff.js.LICENSE.txt */
(()=>{var t={262:t=>{"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!==i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!==i--;){var a=o[i];if(!t(e[a],n[a]))return!1}return!0}return e!==e&&n!==n}},872:function(t,e,n){var r,i,o,a,s,l,u,c,f,d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C,S,D,F,T,N,O,z,R,P,B,L,j,U=n(400).default;j=()=>(()=>{var t={2781:t=>{"use strict";function e(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>=0?(o=a,i=a-1):r=a+1}return o}function n(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>0?(o=a,i=a-1):r=a+1}return o}function r(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<0?(o=a,r=a+1):i=a-1}return o}function i(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<=0?(o=a,r=a+1):i=a-1}return o}function o(t,e,n,r,i){for(;r<=i;){var o=r+i>>>1,a=t[o],s=void 0!==n?n(a,e):a-e;if(0===s)return o;s<=0?r=o+1:i=o-1}return-1}function a(t,e,n,r,i,o){return"function"==typeof n?o(t,e,n,void 0===r?0:0|r,void 0===i?t.length-1:0|i):o(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}t.exports={ge:function(t,n,r,i,o){return a(t,n,r,i,o,e)},gt:function(t,e,r,i,o){return a(t,e,r,i,o,n)},lt:function(t,e,n,i,o){return a(t,e,n,i,o,r)},le:function(t,e,n,r,o){return a(t,e,n,r,o,i)},eq:function(t,e,n,r,i){return a(t,e,n,r,i,o)}}},8138:t=>{var e=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,r;try{e=Map}catch(t){e=function(){}}try{n=Set}catch(t){n=function(){}}try{r=Promise}catch(t){r=function(){}}function i(o,s,l,u,c){"object"==typeof s&&(l=s.depth,u=s.prototype,c=s.includeNonEnumerable,s=s.circular);var f=[],d=[],h="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===l&&(l=1/0),function o(l,p){if(null===l)return null;if(0===p)return l;var m,g;if("object"!=typeof l)return l;if(t(l,e))m=new e;else if(t(l,n))m=new n;else if(t(l,r))m=new r((function(t,e){l.then((function(e){t(o(e,p-1))}),(function(t){e(o(t,p-1))}))}));else if(i.__isArray(l))m=[];else if(i.__isRegExp(l))m=new RegExp(l.source,a(l)),l.lastIndex&&(m.lastIndex=l.lastIndex);else if(i.__isDate(l))m=new Date(l.getTime());else{if(h&&Buffer.isBuffer(l))return m=Buffer.allocUnsafe?Buffer.allocUnsafe(l.length):new Buffer(l.length),l.copy(m),m;t(l,Error)?m=Object.create(l):void 0===u?(g=Object.getPrototypeOf(l),m=Object.create(g)):(m=Object.create(u),g=u)}if(s){var y=f.indexOf(l);if(-1!=y)return d[y];f.push(l),d.push(m)}for(var v in t(l,e)&&l.forEach((function(t,e){var n=o(e,p-1),r=o(t,p-1);m.set(n,r)})),t(l,n)&&l.forEach((function(t){var e=o(t,p-1);m.add(e)})),l){var b;g&&(b=Object.getOwnPropertyDescriptor(g,v)),b&&null==b.set||(m[v]=o(l[v],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(l);for(v=0;v<x.length;v++){var _=x[v];(!(k=Object.getOwnPropertyDescriptor(l,_))||k.enumerable||c)&&(m[_]=o(l[_],p-1),k.enumerable||Object.defineProperty(m,_,{enumerable:!1}))}}if(c){var w=Object.getOwnPropertyNames(l);for(v=0;v<w.length;v++){var k,A=w[v];(k=Object.getOwnPropertyDescriptor(l,A))&&k.enumerable||(m[A]=o(l[A],p-1),Object.defineProperty(m,A,{enumerable:!1}))}}return m}(o,l)}function o(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=o,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===o(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===o(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===o(t)},i.__getRegExpFlags=a,i}();t.exports&&(t.exports=e)},9378:t=>{"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!=i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!t(e[a],n[a]))return!1}return!0}return e!=e&&n!=n}},5695:t=>{"use strict";t.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var n,r="boolean"==typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},o={key:r,value:t[r]};return n(i,o)}}),o=[];return function t(e){if(e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!=typeof e)return JSON.stringify(e);var n,a;if(Array.isArray(e)){for(a="[",n=0;n<e.length;n++)n&&(a+=","),a+=t(e[n])||"null";return a+"]"}if(null===e)return"null";if(-1!==o.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(e)-1,l=Object.keys(e).sort(i&&i(e));for(a="",n=0;n<l.length;n++){var u=l[n],c=t(e[u]);c&&(a&&(a+=","),a+=JSON.stringify(u)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(t)}},2636:(t,e,n)=>{"use strict";var r=n(2781);function i(t,e,n,r,i){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=i,this.count=(e?e.count:0)+(n?n.count:0)+r.length}t.exports=function(t){return t&&0!==t.length?new y(g(t)):new y(null)};var o=i.prototype;function a(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function s(t,e){var n=g(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function l(t,e){var n=t.intervals([]);n.push(e),s(t,n)}function u(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),s(t,n),1)}function c(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var i=n(t[r]);if(i)return i}}function f(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var i=n(t[r]);if(i)return i}}function d(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function h(t,e){return t-e}function p(t,e){return t[0]-e[0]||t[1]-e[1]}function m(t,e){return t[1]-e[1]||t[0]-e[0]}function g(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(h);var r=e[e.length>>1],o=[],a=[],s=[];for(n=0;n<t.length;++n){var l=t[n];l[1]<r?o.push(l):r<l[0]?a.push(l):s.push(l)}var u=s,c=s.slice();return u.sort(p),c.sort(m),new i(r,g(o),g(a),u,c)}function y(t){this.root=t}o.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},o.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?l(this,t):this.left.insert(t):this.left=g([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?l(this,t):this.right.insert(t):this.right=g([t]);else{var n=r.ge(this.leftPoints,t,p),i=r.ge(this.rightPoints,t,m);this.leftPoints.splice(n,0,t),this.rightPoints.splice(i,0,t)}},o.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?u(this,t):2===(s=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===s&&(this.count-=1),s):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?u(this,t):2===(s=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===s&&(this.count-=1),s):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,i=this.left;i.right;)n=i,i=i.right;if(n===this)i.right=this.right;else{var o=this.left,s=this.right;n.count-=i.count,n.right=i.left,i.left=o,i.right=s}a(this,i),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?a(this,this.left):a(this,this.right);return 1}for(o=r.ge(this.leftPoints,t,p);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t)for(this.count-=1,this.leftPoints.splice(o,1),s=r.ge(this.rightPoints,t,m);s<this.rightPoints.length&&this.rightPoints[s][1]===t[1];++s)if(this.rightPoints[s]===t)return this.rightPoints.splice(s,1),1;return 0},o.queryPoint=function(t,e){return t<this.mid?this.left&&(n=this.left.queryPoint(t,e))?n:c(this.leftPoints,t,e):t>this.mid?this.right&&(n=this.right.queryPoint(t,e))?n:f(this.rightPoints,t,e):d(this.leftPoints,e);var n},o.queryInterval=function(t,e,n){var r;return t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n))||e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n))?r:e<this.mid?c(this.leftPoints,e,n):t>this.mid?f(this.rightPoints,t,n):d(this.leftPoints,n)};var v=y.prototype;v.insert=function(t){this.root?this.root.insert(t):this.root=new i(t[0],null,null,[t],[t])},v.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},v.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},v.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(v,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(v,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},7646:function(t){var e;e=()=>(()=>{var t={138:t=>{var e=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,r;try{e=Map}catch(t){e=function(){}}try{n=Set}catch(t){n=function(){}}try{r=Promise}catch(t){r=function(){}}function i(o,s,l,u,c){"object"==typeof s&&(l=s.depth,u=s.prototype,c=s.includeNonEnumerable,s=s.circular);var f=[],d=[],h="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===l&&(l=1/0),function o(l,p){if(null===l)return null;if(0===p)return l;var m,g;if("object"!=typeof l)return l;if(t(l,e))m=new e;else if(t(l,n))m=new n;else if(t(l,r))m=new r((function(t,e){l.then((function(e){t(o(e,p-1))}),(function(t){e(o(t,p-1))}))}));else if(i.__isArray(l))m=[];else if(i.__isRegExp(l))m=new RegExp(l.source,a(l)),l.lastIndex&&(m.lastIndex=l.lastIndex);else if(i.__isDate(l))m=new Date(l.getTime());else{if(h&&Buffer.isBuffer(l))return m=Buffer.allocUnsafe?Buffer.allocUnsafe(l.length):new Buffer(l.length),l.copy(m),m;t(l,Error)?m=Object.create(l):void 0===u?(g=Object.getPrototypeOf(l),m=Object.create(g)):(m=Object.create(u),g=u)}if(s){var y=f.indexOf(l);if(-1!=y)return d[y];f.push(l),d.push(m)}for(var v in t(l,e)&&l.forEach((function(t,e){var n=o(e,p-1),r=o(t,p-1);m.set(n,r)})),t(l,n)&&l.forEach((function(t){var e=o(t,p-1);m.add(e)})),l){var b;g&&(b=Object.getOwnPropertyDescriptor(g,v)),b&&null==b.set||(m[v]=o(l[v],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(l);for(v=0;v<x.length;v++){var _=x[v];(!(k=Object.getOwnPropertyDescriptor(l,_))||k.enumerable||c)&&(m[_]=o(l[_],p-1),k.enumerable||Object.defineProperty(m,_,{enumerable:!1}))}}if(c){var w=Object.getOwnPropertyNames(l);for(v=0;v<w.length;v++){var k,A=w[v];(k=Object.getOwnPropertyDescriptor(l,A))&&k.enumerable||(m[A]=o(l[A],p-1),Object.defineProperty(m,A,{enumerable:!1}))}}return m}(o,l)}function o(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=o,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===o(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===o(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===o(t)},i.__getRegExpFlags=a,i}();t.exports&&(t.exports=e)},914:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(601),i=n.n(r),o=n(609),a=n.n(o)()(i());a.push([t.id,".olli-dialog {\n  border: 1px solid black;\n  padding: 10px 15px;\n  position: fixed;\n  left: 25%;\n  right: 25%;\n  top: 15%;\n  background: #fff;\n  -webkit-box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.75);\n  -moz-box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.75);\n  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.75);\n}\n\n.olli-dialog button {\n  margin-bottom: 5px;\n}\n\n.olli-dialog h2 {\n  margin: 0;\n}\n\n.olli-dialog p {\n  margin-top: 0;\n}\n\n.olli-dialog #olli-dialog-content * {\n  max-width: 100%;\n}\n\n.olli-dialog #olli-dialog-content:has(table) {\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.olli-hidden {\n  display: none;\n}",""]);const s=a},370:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(601),i=n.n(r),o=n(609),a=n.n(o)()(i());a.push([t.id,".olli-vis ul[role='tree'] {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n}\n\n.olli-vis ul[role='tree'] li {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n}\n\n.olli-vis [role='treeitem']:not(.expanded) + [role='group'] {\n  display: none;\n}\n\n.olli-vis [role='treeitem'].expanded + [role='group'] {\n  display: block;\n}\n\n.olli-vis [role='treeitem']:not(.expanded) > ul {\n  display: none;\n}\n\n.olli-vis [role='treeitem'].expanded > ul {\n  display: block;\n}\n\n/* .olli-vis [role=\"treeitem\"],\n.olli-vis [role=\"treeitem\"] span {\n  width: 9em;\n  margin: 0;\n  padding: 0.125em;\n  display: block;\n} */\n\n/* disable default keyboard focus styling for treeitems\n   Keyboard focus is styled with the following CSS */\n.olli-vis :focus {\n  outline: 0;\n}\n\n.olli-vis .focus,\n.olli-vis span.focus {\n  border-color: black;\n  background-color: #eee;\n}\n\n.olli-vis .hover,\n.olli-vis span:hover {\n  background-color: #ddd;\n}\n",""]);const s=a},609:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);r&&a[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},879:function(t){t.exports=function(){"use strict";var t=6e4,e=36e5,n="millisecond",r="second",i="minute",o="hour",a="day",s="week",l="month",u="quarter",c="year",f="date",d="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},g=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},y={s:g,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+g(r,2,"0")+":"+g(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,l),o=n-i<0,a=e.clone().add(r+(o?-1:1),l);return+(-(r+(n-i)/(o?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:l,y:c,w:s,d:a,D:f,h:o,m:i,s:r,ms:n,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},v="en",b={};b[v]=m;var x=function(t){return t instanceof A},_=function t(e,n,r){var i;if(!e)return v;if("string"==typeof e){var o=e.toLowerCase();b[o]&&(i=o),n&&(b[o]=n,i=o);var a=e.split("-");if(!i&&a.length>1)return t(a[0])}else{var s=e.name;b[s]=e,i=s}return!r&&i&&(v=i),i||!r&&v},w=function(t,e){if(x(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new A(n)},k=y;k.l=_,k.i=x,k.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var A=function(){function m(t){this.$L=_(t.locale,null,!0),this.parse(t)}var g=m.prototype;return g.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(k.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(h);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},g.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},g.$utils=function(){return k},g.isValid=function(){return!(this.$d.toString()===d)},g.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},g.isAfter=function(t,e){return w(t)<this.startOf(e)},g.isBefore=function(t,e){return this.endOf(e)<w(t)},g.$g=function(t,e,n){return k.u(t)?this[e]:this.set(n,t)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(t,e){var n=this,u=!!k.u(e)||e,d=k.p(t),h=function(t,e){var r=k.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return u?r:r.endOf(a)},p=function(t,e){return k.w(n.toDate()[t].apply(n.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},m=this.$W,g=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case c:return u?h(1,0):h(31,11);case l:return u?h(1,g):h(0,g+1);case s:var b=this.$locale().weekStart||0,x=(m<b?m+7:m)-b;return h(u?y-x:y+(6-x),g);case a:case f:return p(v+"Hours",0);case o:return p(v+"Minutes",1);case i:return p(v+"Seconds",2);case r:return p(v+"Milliseconds",3);default:return this.clone()}},g.endOf=function(t){return this.startOf(t,!1)},g.$set=function(t,e){var s,u=k.p(t),d="set"+(this.$u?"UTC":""),h=(s={},s[a]=d+"Date",s[f]=d+"Date",s[l]=d+"Month",s[c]=d+"FullYear",s[o]=d+"Hours",s[i]=d+"Minutes",s[r]=d+"Seconds",s[n]=d+"Milliseconds",s)[u],p=u===a?this.$D+(e-this.$W):e;if(u===l||u===c){var m=this.clone().set(f,1);m.$d[h](p),m.init(),this.$d=m.set(f,Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},g.set=function(t,e){return this.clone().$set(t,e)},g.get=function(t){return this[k.p(t)]()},g.add=function(n,u){var f,d=this;n=Number(n);var h=k.p(u),p=function(t){var e=w(d);return k.w(e.date(e.date()+Math.round(t*n)),d)};if(h===l)return this.set(l,this.$M+n);if(h===c)return this.set(c,this.$y+n);if(h===a)return p(1);if(h===s)return p(7);var m=(f={},f[i]=t,f[o]=e,f[r]=1e3,f)[h]||1,g=this.$d.getTime()+n*m;return k.w(g,this)},g.subtract=function(t,e){return this.add(-1*t,e)},g.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=k.z(this),o=this.$H,a=this.$m,s=this.$M,l=n.weekdays,u=n.months,c=function(t,n,i,o){return t&&(t[n]||t(e,r))||i[n].slice(0,o)},f=function(t){return k.s(o%12||12,t,"0")},h=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:k.s(s+1,2,"0"),MMM:c(n.monthsShort,s,u,3),MMMM:c(u,s),D:this.$D,DD:k.s(this.$D,2,"0"),d:String(this.$W),dd:c(n.weekdaysMin,this.$W,l,2),ddd:c(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:k.s(o,2,"0"),h:f(1),hh:f(2),a:h(o,a,!0),A:h(o,a,!1),m:String(a),mm:k.s(a,2,"0"),s:String(this.$s),ss:k.s(this.$s,2,"0"),SSS:k.s(this.$ms,3,"0"),Z:i};return r.replace(p,(function(t,e){return e||m[t]||i.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,f,d){var h,p=k.p(f),m=w(n),g=(m.utcOffset()-this.utcOffset())*t,y=this-m,v=k.m(this,m);return v=(h={},h[c]=v/12,h[l]=v,h[u]=v/3,h[s]=(y-g)/6048e5,h[a]=(y-g)/864e5,h[o]=y/e,h[i]=y/t,h[r]=y/1e3,h)[p]||y,d?v:k.a(v)},g.daysInMonth=function(){return this.endOf(l).$D},g.$locale=function(){return b[this.$L]},g.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=_(t,e,!0);return r&&(n.$L=r),n},g.clone=function(){return k.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},m}(),E=A.prototype;return w.prototype=E,[["$ms",n],["$s",r],["$m",i],["$H",o],["$W",a],["$M",l],["$y",c],["$D",f]].forEach((function(t){E[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,A,w),t.$i=!0),w},w.locale=_,w.isDayjs=x,w.unix=function(t){return w(1e3*t)},w.en=b[v],w.Ls=b,w.p={},w}()},378:t=>{"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!=i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!t(e[a],n[a]))return!1}return!0}return e!=e&&n!=n}},695:t=>{"use strict";t.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var n,r="boolean"==typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},o={key:r,value:t[r]};return n(i,o)}}),o=[];return function t(e){if(e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!=typeof e)return JSON.stringify(e);var n,a;if(Array.isArray(e)){for(a="[",n=0;n<e.length;n++)n&&(a+=","),a+=t(e[n])||"null";return a+"]"}if(null===e)return"null";if(-1!==o.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(e)-1,l=Object.keys(e).sort(i&&i(e));for(a="",n=0;n<l.length;n++){var u=l[n],c=t(e[u]);c&&(a&&(a+=","),a+=JSON.stringify(u)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(t)}},62:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},a=[],s=0;s<t.length;s++){var l=t[s],u=r.base?l[0]+r.base:l[0],c=o[u]||0,f="".concat(u," ").concat(c);o[u]=c+1;var d=n(f),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(h);else{var p=i(h,r);r.byIndex=s,e.splice(s,0,{identifier:f,updater:p,references:1})}a.push(f)}return a}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var l=r(t,i),u=0;u<o.length;u++){var c=n(o[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=l}}},793:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},173:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},892:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},36:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},464:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},925:(t,e,n)=>{t.exports=n(448)},448:(t,e,n)=>{function r(t){let e=null;try{e=n.g.localStorage.getItem(t)}catch(t){throw new Error("localStorage not accessible")}return e}function i(t,e){try{n.g.localStorage.setItem(t,e)}catch(t){throw new Error("localStorage not accessible")}}function o(t){try{n.g.localStorage.removeItem(t)}catch(t){throw new Error("localStorage not accessible")}}t.exports=class{constructor(t,e){if(e){const n=parseInt(e,10);if(!n||n<=0)throw new Error("version has to be a positive integer");this.name=t,this.version=n;const a=parseInt(r(t),10)||0;n>a&&(o("".concat(t,":").concat(a)),i(t,e.toString(10)))}else{const e=parseInt(r(t),10)||0;if(!e)throw new Error("There is no existing storage named ".concat(t));this.name=t,this.version=e}}read(){const t="".concat(this.name,":").concat(this.version),e=r(t);let n=null;if(e)try{n=JSON.parse(e)}catch(e){o(t)}return n}write(t){const e="".concat(this.name,":").concat(this.version),n=JSON.stringify(t);void 0===n?o(e):i(e,n)}static reset(){!function(){try{n.g.localStorage.clear()}catch(t){throw new Error("localStorage not accessible")}}()}}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nc=void 0;var _={};return(()=>{"use strict";n.r(_),n.d(_,{isMultiOlliSpec:()=>YW,olli:()=>a$,typeInference:()=>i$});var t={};n.r(t),n.d(t,{aggregate:()=>xs,bin:()=>_s,collect:()=>ks,compare:()=>As,countpattern:()=>Ms,cross:()=>Cs,density:()=>Ts,dotbin:()=>Ps,expression:()=>Bs,extent:()=>js,facet:()=>qs,field:()=>Is,filter:()=>$s,flatten:()=>Hs,fold:()=>Zs,formula:()=>Ys,generate:()=>Vs,impute:()=>Qs,joinaggregate:()=>Js,kde:()=>Ks,key:()=>tl,load:()=>nl,lookup:()=>il,multiextent:()=>ol,multivalues:()=>sl,params:()=>ul,pivot:()=>cl,prefacet:()=>fl,project:()=>dl,proxy:()=>hl,quantile:()=>pl,relay:()=>ml,sample:()=>gl,sequence:()=>yl,sieve:()=>vl,subflow:()=>Us,timeunit:()=>bl,tupleindex:()=>_l,values:()=>wl,window:()=>Cl});var e={};n.r(e),n.d(e,{interpolate:()=>Jc,interpolateArray:()=>$c,interpolateBasis:()=>Nc,interpolateBasisClosed:()=>Oc,interpolateCubehelix:()=>Vd,interpolateCubehelixLong:()=>Gd,interpolateDate:()=>Zc,interpolateDiscrete:()=>td,interpolateHcl:()=>Rd,interpolateHclLong:()=>Pd,interpolateHsl:()=>dd,interpolateHslLong:()=>hd,interpolateHue:()=>ed,interpolateLab:()=>Od,interpolateNumber:()=>Yc,interpolateNumberArray:()=>Ic,interpolateObject:()=>Vc,interpolateRgb:()=>Lc,interpolateRgbBasis:()=>Uc,interpolateRgbBasisClosed:()=>qc,interpolateRound:()=>Kc,interpolateString:()=>Qc,interpolateTransformCss:()=>sd,interpolateTransformSvg:()=>ld,interpolateZoom:()=>cd,piecewise:()=>Wf,quantize:()=>Xd});var w={};n.r(w),n.d(w,{bound:()=>sb,identifier:()=>cb,mark:()=>fb,overlap:()=>db,render:()=>bb,viewlayout:()=>Ub});var k={};n.r(k),n.d(k,{axisticks:()=>Ib,datajoin:()=>Wb,encode:()=>Hb,legendentries:()=>Zb,linkpath:()=>Qb,pie:()=>nx,scale:()=>ox,sortitems:()=>ux,stack:()=>px});var A={};n.r(A),n.d(A,{contour:()=>Xk,geojson:()=>Kk,geopath:()=>tA,geopoint:()=>eA,geoshape:()=>nA,graticule:()=>rA,heatmap:()=>iA,isocontour:()=>Uk,kde2d:()=>Yk,projection:()=>aA});var E={};n.r(E),n.d(E,{force:()=>eE});var M={};n.r(M),n.d(M,{nest:()=>iM,pack:()=>cM,partition:()=>dM,stratify:()=>hM,tree:()=>gM,treelinks:()=>yM,treemap:()=>xM});var C={};n.r(C),n.d(C,{label:()=>jM});var S={};n.r(S),n.d(S,{loess:()=>qM,regression:()=>WM});var D={};n.r(D),n.d(D,{voronoi:()=>bC});var F={};n.r(F),n.d(F,{wordcloud:()=>zC});var T={};n.r(T),n.d(T,{crossfilter:()=>qC,resolvefilter:()=>IC});const N=()=>(window._olli||(window._olli={}),window._olli),O=t=>{window._olli=Object.assign(Object.assign({},window._olli),t)},z=t=>{O({instancesOnPage:(N().instancesOnPage||[]).concat([t])}),N().keyListenerAttached||(document.addEventListener("keydown",(t=>{if(!(t=>{switch(null==t?void 0:t.nodeName){case"INPUT":return!["range","button","checkbox","number"].includes(t.getAttribute("type")||"");case"TEXTAREA":return!0}return"string"==typeof(null==t?void 0:t.getAttribute("contenteditable"))})(document.activeElement)){const{lastVisitedInstance:e,instancesOnPage:n}=N();if("KeyO"===t.code){const r=!(!e||!document.body.contains(e.rootDomNode))&&e||(n.length?n[0]:null);if(r)if(document.activeElement===r.rootDomNode){const e=n.indexOf(r);if(t.shiftKey){if(e>0){const t=n[e-1];t.setFocusToItem(t.rootTreeItem)}}else if(e<n.length-1){const t=n[e+1];t.setFocusToItem(t.rootTreeItem)}}else r.lastFocusedTreeItem&&document.activeElement!==r.lastFocusedTreeItem.domNode?r.setFocusToItem(r.lastFocusedTreeItem):r.setFocusToItem(r.rootTreeItem)}}})),O({keyListenerAttached:!0}))};function R(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function P(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function B(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function L(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function j(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?L:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R;if(t===R)return L;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}(i);r>n;){if(r-n>600){const o=r-n+1,a=e-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);j(t,e,Math.max(n,Math.floor(e-a*l/o+u)),Math.min(r,Math.floor(e+(o-a)*l/o+u)),i)}const o=t[e];let a=n,s=r;for(q(t,n,e),i(t[r],o)>0&&q(t,n,r);a<s;){for(q(t,a,s),++a,--s;i(t[a],o)<0;)++a;for(;i(t[s],o)>0;)--s}0===i(t[n],o)?q(t,n,s):(++s,q(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function q(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function I(t){return null===t?NaN:+t}function W(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return B(t);if(e>=1)return P(t);var r,i=(r-1)*e,o=Math.floor(i),a=P(j(t,o).subarray(0,o+1));return a+(B(t.subarray(o+1))-a)*(i-o)}}function $(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}}function H(t,e){return W(t,.5,e)}function*Z(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function Y(t,e,n){const r=Float64Array.from(Z(t,n));return r.sort(R),e.map((t=>$(r,t)))}function V(t,e){return Y(t,[.25,.5,.75],e)}function G(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let a of t)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of t)null!=(s=e(s,++a,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=V(t,e),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function X(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let o,a,s,l,u,c,f=t.extent[0],d=t.extent[1];const h=t.span||d-f||Math.abs(f)||1;if(t.step)o=t.step;else if(t.steps){for(l=h/e,u=0,c=t.steps.length;u<c&&t.steps[u]<l;++u);o=t.steps[Math.max(0,u-1)]}else{for(a=Math.ceil(Math.log(e)/r),s=t.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>e;)o*=n;for(u=0,c=i.length;u<c;++u)l=o/i[u],l>=s&&h/l<=e&&(o=l)}l=Math.log(o);const p=l>=0?0:1+~~(-l/r),m=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(l=Math.floor(f/o+m)*o,f=f<l?l-o:l,d=Math.ceil(d/o)*o),{start:f,stop:d===f?f+o:d,step:o}}var Q=Math.random;function J(t,e,n,r){r=r||(t=>t);const i=t.length,o=new Float64Array(i);let a,s=0,l=1,u=r(t[0]),c=u,f=u+e;for(;l<i;++l){if(a=r(t[l]),a>=f){for(c=(u+c)/2;s<l;++s)o[s]=c;f=a+e,u=a}c=a}for(c=(u+c)/2;s<l;++s)o[s]=c;return n?function(t,e){const n=t.length;let r,i,o=0,a=1;for(;t[o]===t[a];)++a;for(;a<n;){for(r=a+1;t[a]===t[r];)++r;if(t[a]-t[a-1]<e){for(i=a+(o+r-a-a>>1);i<a;)t[i++]=t[a];for(;i>a;)t[i--]=t[o]}o=a,a=r}return t}(o,e+e/4):o}const K=Math.sqrt(2*Math.PI),tt=Math.SQRT2;let et=NaN;function nt(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(et==et)i=et,et=NaN;else{do{i=2*Q()-1,o=2*Q()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,et=o*r}return t+i*e}function rt(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*K)}function it(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,o=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,o/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,o=t/e/2.506628274631)}return r>0?1-o:o}function ot(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*tt*function(t){let e,n=-Math.log((1-t)*(1+t));return n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0,e*t}(2*t-1)}function at(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>nt(n,r),pdf:t=>rt(t,n,r),cdf:t=>it(t,n,r),icdf:t=>ot(t,n,r)};return i.mean(t).stdev(e)}function st(t,e){const n=at();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=G(t)),i):e},sample:()=>t[~~(Q()*r)]+e*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-t[a])/e);return o/e/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-t[a])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function lt(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+nt()*e)}function ut(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*K*t)}function ct(t,e,n){return it(Math.log(t),e,n)}function ft(t,e,n){return Math.exp(ot(t,e,n))}function dt(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*Q()}function ht(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function pt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function mt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function gt(t,e,n){let r=0,i=0;for(const o of t){const t=n(o);null==e(o)||null==t||isNaN(t)||(r+=(t-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function yt(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-o*t,o]}function vt(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,o=new Float64Array(i),a=new Float64Array(i);let s,l,u,c=0,f=0,d=0;for(u of t)o[c]=s=+e(u),a[c]=l=+n(u),++c,f+=(s-f)/c,d+=(l-d)/c;for(c=0;c<i;++c)o[c]-=f,a[c]-=d;return[o,a,f,d]}function bt(t,e,n,r){let i,o,a=-1;for(const s of t)i=e(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function xt(t,e,n,r,i){let o=0,a=0;return bt(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;o+=n*n,a+=s*s})),1-o/a}function _t(t,e,n){let r=0,i=0,o=0,a=0,s=0;bt(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=yt(r,i,o,a),u=t=>l[0]+l[1]*t;return{coef:l,predict:u,rSquared:xt(t,e,n,i,u)}}function wt(t,e,n){const[r,i,o,a]=vt(t,e,n),s=r.length;let l,u,c,f,d=0,h=0,p=0,m=0,g=0;for(l=0;l<s;)u=r[l],c=i[l++],f=u*u,d+=(f-d)/l,h+=(f*u-h)/l,p+=(f*f-p)/l,m+=(u*c-m)/l,g+=(f*c-g)/l;const y=p-d*d,v=d*y-h*h,b=(g*d-m*h)/v,x=(m*y-g*h)/v,_=-b*d,w=t=>b*(t-=o)*t+x*t+_+a;return{coef:[_-x*o+b*o*o+a,x-2*b*o,b],predict:w,rSquared:xt(t,e,n,a,w)}}function kt(t,e,n,r){const i=Array(t);let o,a,s,l;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(s=e[o],l=1,i[o]+=s,a=1;a<=o;++a)l*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*l;return i[0]+=r,i}function At(t){return(t=1-t*t*t)*t*t}function Et(t,e,n){const r=t[e];let i=n[0],o=n[1]+1;if(!(o>=t.length))for(;e>i&&t[o]-r<=r-t[i];)n[0]=++i,n[1]=o,++o}const Mt=.5*Math.PI/180;function Ct(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],a=e[1],s=a-o,l=s/r,u=[i(o)],c=[];if(n===r){for(let t=1;t<r;++t)u.push(i(o+t/n*s));return u.push(i(a)),u}c.push(i(a));for(let m=n;--m>0;)c.push(i(o+m/n*s));let f=u[0],d=c[c.length-1];const h=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let o=0;o<i;++o){const t=e[o][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(f[1],c);for(;d;){const t=i((f[0]+d[0])/2);t[0]-f[0]>=l&&St(f,t,d,h,p)>Mt?c.push(t):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function St(t,e,n,r,i){const o=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),a=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(o-a)}function Dt(t,e,n){return t.fields=e||[],t.fname=n,t}function Ft(t){return null==t?null:t.fname}function Tt(t){return null==t?null:t.fields}function Nt(t){return 1===t.length?Ot(t[0]):zt(t)}const Ot=t=>function(e){return e[t]},zt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Rt(t){throw Error(t)}function Pt(t){const e=[],n=t.length;let r,i,o,a=null,s=0,l="";function u(){e.push(l+t.substring(r,i)),l="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)l+=t.substring(r,i++),r=i;else if(o===a)u(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&u(),s=r=i+1):"]"===o&&(s||Rt("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&Rt("Access path missing closing bracket: "+t),a&&Rt("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function Bt(t,e,n){const r=Pt(t);return t=1===r.length?r[0]:t,Dt((n&&n.get||Nt)(r),[t],e||t)}const Lt=Bt("id"),jt=Dt((t=>t),[],"identity"),Ut=Dt((()=>0),[],"zero"),qt=Dt((()=>1),[],"one"),It=Dt((()=>!0),[],"true"),Wt=Dt((()=>!1),[],"false");function $t(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const Ht=0,Zt=1,Yt=2,Vt=3,Gt=4;function Xt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$t,r=t||Ht;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=Zt&&n(e||"error","ERROR",arguments),this},warn(){return r>=Yt&&n(e||"warn","WARN",arguments),this},info(){return r>=Vt&&n(e||"log","INFO",arguments),this},debug(){return r>=Gt&&n(e||"log","DEBUG",arguments),this}}}var Qt=Array.isArray;function Jt(t){return t===Object(t)}function Kt(t){return t[t.length-1]}function te(t){return null==t||""===t?null:+t}const ee=t=>e=>t*Math.exp(e),ne=t=>e=>Math.log(t*e),re=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),ie=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,oe=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function ae(t,e,n,r){const i=n(t[0]),o=n(Kt(t)),a=(o-i)*e;return[r(i-a),r(o-a)]}function se(t,e,n,r,i){const o=r(t[0]),a=r(Kt(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function le(t,e,n){return se(t,e,n,te,jt)}function ue(t,e,n){const r=Math.sign(t[0]);return se(t,e,n,ne(r),ee(r))}function ce(t,e,n,r){return se(t,e,n,oe(r),oe(1/r))}function fe(t,e,n,r){return se(t,e,n,re(r),ie(r))}function de(t){return null!=t?Qt(t)?t:[t]:[]}function he(t){return"function"==typeof t}const pe="descending";function me(t,e,n){n=n||{},e=de(e)||[];const r=[],i=[],o={},a=n.comparator||ye;return de(t).forEach(((t,a)=>{null!=t&&(r.push(e[a]===pe?-1:1),i.push(t=he(t)?t:Bt(t,null,n)),(Tt(t)||[]).forEach((t=>o[t]=1)))})),0===i.length?null:Dt(a(i,r),Object.keys(o))}const ge=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),ye=(t,e)=>1===t.length?ve(t[0],e[0]):be(t,e,t.length),ve=(t,e)=>function(n,r){return ge(t(n),t(r))*e},be=(t,e,n)=>(e.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=t[s],a=ge(o(r),o(i));return a*e[s]});function xe(t){return he(t)?t:()=>t}function _e(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function we(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function ke(t,e){let n,r,i,o,a=0;if(t&&(n=t.length))if(null==e){for(r=t[a];a<n&&(null==r||r!=r);r=t[++a]);for(i=o=r;a<n;++a)r=t[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[a]);a<n&&(null==r||r!=r);r=e(t[++a]));for(i=o=r;a<n;++a)r=e(t[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}const Ae=Object.prototype.hasOwnProperty;function Ee(t,e){return Ae.call(t,e)}const Me={};function Ce(t){let e,n={};function r(t){return Ee(n,t)&&n[t]!==Me}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===Me&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=Me),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===Me||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function Se(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),we(r,n)}function De(t,e,n,r){let i,o=e[0],a=e[e.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=a:t<a)}function Fe(t){return"boolean"==typeof t}function Te(t){return"[object Date]"===Object.prototype.toString.call(t)}function Ne(t){return"number"==typeof t}function Oe(t){return"string"==typeof t}function ze(t,e,n){t&&(t=e?de(t).map((t=>t.replace(/\\(.)/g,"$1"))):de(t));const r=t&&t.length,i=n&&n.get||Nt,o=t=>i(e?[t]:Pt(t));let a;if(r)if(1===r){const e=o(t[0]);a=function(t){return""+e(t)}}else{const e=t.map(o);a=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else a=function(){return""};return Dt(a,t,"key")}function Re(t,e){let n="";for(;--e>=0;)n+=t;return n}function Pe(t){return t&&Kt(t)-t[0]||0}function Be(t){return Qt(t)?"["+t.map(Be)+"]":Jt(t)||Oe(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Le(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t||!t)}const je=t=>Ne(t)||Te(t)?t:Date.parse(t);function Ue(t,e){return e=e||je,null==t||""===t?null:e(t)}function qe(t){return null==t||""===t?null:t+""}function Ie(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function We(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var $e={},He={},Ze=34,Ye=10,Ve=13;function Ge(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Xe(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Qe(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Je(t){return t}function Ke(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return tn(t,e)}))}:tn(t,e)}function tn(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=en(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function en(t,e){var n=function(t){if(null==t)return Je;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+a;l<u;)c[l]=t[l],++l;return c}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,a)}function o(t){return n(t)}function a(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=a(e.arcs);break;case"MultiLineString":n=e.arcs.map(a);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function nn(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)})),e.forEach((function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),s=a[0],l=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=l]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o}function rn(t){return en(t,on.apply(this,arguments))}function on(t,e,n){var r,i,o;if(arguments.length>1)r=function(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function l(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(l)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:nn(t,r)}}const an=Math.sqrt(50),sn=Math.sqrt(10),ln=Math.sqrt(2);function un(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=an?10:o>=sn?5:o>=ln?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?un(t,e,2*n):[s,l,u]}function cn(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];const r=e<t,[i,o,a]=r?un(e,t,n):un(t,e,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function fn(t,e,n){return un(t=+t,e=+e,n=+n)[2]}function dn(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?fn(e,t,n):fn(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}var hn,pn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mn(t){if(!(e=pn.exec(t)))throw new Error("invalid format: "+t);var e;return new gn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function gn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function yn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function vn(t){return(t=yn(Math.abs(t)))?t[1]:NaN}function bn(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(vn(e)/3)))-vn(Math.abs(t)))}function xn(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vn(e)-vn(t))+1}function _n(t){return Math.max(0,-vn(Math.abs(t)))}function wn(t,e){var n=yn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}mn.prototype=gn.prototype,gn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const kn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>wn(100*t,e),r:wn,s:function(t,e){var n=yn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(hn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+yn(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function An(t){return t}var En,Mn,Cn,Sn=Array.prototype.map,Dn=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Fn(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?An:(e=Sn.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?An:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Sn.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=mn(t)).fill,n=t.align,f=t.sign,d=t.symbol,h=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):kn[v]||(void 0===g&&(g=12),y=!0,v="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?o:/[%p]/.test(v)?l:"",_=kn[v],w=/[defgprs%]/.test(v);function k(t){var i,o,l,d=b,k=x;if("c"===v)k=_(t)+k,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:_(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0==+t&&"+"!==f&&(A=!1),d=(A?"("===f?f:u:"-"===f||"("===f?"":f)+d,k=("s"===v?Dn[8+hn/3]:"")+k+(A&&"("===f?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){k=(46===l?a+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}m&&!h&&(t=r(t,1/0));var E=d.length+t.length+k.length,M=E<p?new Array(p-E+1).join(e):"";switch(m&&h&&(t=r(M+t,M.length?p-k.length:1/0),M=""),n){case"<":t=d+t+k+M;break;case"=":t=d+M+t+k;break;case"^":t=M.slice(0,E=M.length>>1)+d+t+k+M.slice(E);break;default:t=M+d+t+k}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:f,formatPrefix:function(t,e){var n=f(((t=mn(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(vn(e)/3))),i=Math.pow(10,-r),o=Dn[8+r/3];return function(t){return n(i*t)+o}}}}En=Fn({thousands:",",grouping:[3],currency:["$",""]}),Mn=En.format,Cn=En.formatPrefix;const Tn=new Date,Nn=new Date;function On(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=e=>(t(e=new Date(+e)),e),i.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),i.round=t=>{const e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),e(n,o),t(n)}while(s<n&&n<r);return a},i.filter=n=>On((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})),n&&(i.count=(e,r)=>(Tn.setTime(+e),Nn.setTime(+r),t(Tn),t(Nn),Math.floor(n(Tn,Nn))),i.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?e=>r(e)%t==0:e=>i.count(0,e)%t==0):i:null)),i}const zn=1e3,Rn=6e4,Pn=36e5,Bn=864e5,Ln=6048e5,jn=31536e6,Un=On((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Rn)/Bn),(t=>t.getDate()-1)),qn=(Un.range,On((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Bn),(t=>t.getUTCDate()-1))),In=(qn.range,On((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Bn),(t=>Math.floor(t/Bn))));function Wn(t){return On((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Rn)/Ln))}In.range;const $n=Wn(0),Hn=Wn(1),Zn=Wn(2),Yn=Wn(3),Vn=Wn(4),Gn=Wn(5),Xn=Wn(6);function Qn(t){return On((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/Ln))}$n.range,Hn.range,Zn.range,Yn.range,Vn.range,Gn.range,Xn.range;const Jn=Qn(0),Kn=Qn(1),tr=Qn(2),er=Qn(3),nr=Qn(4),rr=Qn(5),ir=Qn(6),or=(Jn.range,Kn.range,tr.range,er.range,nr.range,rr.range,ir.range,On((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear())));or.every=t=>isFinite(t=Math.floor(t))&&t>0?On((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null,or.range;const ar=On((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));ar.every=t=>isFinite(t=Math.floor(t))&&t>0?On((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null,ar.range;const sr=On((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth())),lr=(sr.range,On((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth()))),ur=(lr.range,On((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn-t.getMinutes()*Rn)}),((t,e)=>{t.setTime(+t+e*Pn)}),((t,e)=>(e-t)/Pn),(t=>t.getHours()))),cr=(ur.range,On((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*Pn)}),((t,e)=>(e-t)/Pn),(t=>t.getUTCHours()))),fr=(cr.range,On((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn)}),((t,e)=>{t.setTime(+t+e*Rn)}),((t,e)=>(e-t)/Rn),(t=>t.getMinutes()))),dr=(fr.range,On((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*Rn)}),((t,e)=>(e-t)/Rn),(t=>t.getUTCMinutes()))),hr=(dr.range,On((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*zn)}),((t,e)=>(e-t)/zn),(t=>t.getUTCSeconds()))),pr=(hr.range,On((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t)));function mr(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gr(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=R,n=(e,n)=>R(t(e),n),r=(e,n)=>t(e)-n):(e=t===R||t===mr?t:yr,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function yr(){return 0}pr.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?On((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):pr:null),pr.range;const vr="year",br="quarter",xr="month",_r="week",wr="date",kr="day",Ar="dayofyear",Er="hours",Mr="minutes",Cr="seconds",Sr="milliseconds",Dr=[vr,br,xr,_r,wr,kr,Ar,Er,Mr,Cr,Sr],Fr=Dr.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function Tr(t){const e=de(t).slice(),n={};return e.length||Rt("Missing time unit."),e.forEach((t=>{Ee(Fr,t)?n[t]=1:Rt("Invalid time unit: ".concat(t,"."))})),(n[_r]||n[kr]?1:0)+(n[br]||n[xr]||n[wr]?1:0)+(n[Ar]?1:0)>1&&Rt("Incompatible time units: ".concat(t)),e.sort(((t,e)=>Fr[t]-Fr[e])),e}const Nr={[vr]:"%Y ",[br]:"Q%q ",[xr]:"%b ",[wr]:"%d ",[_r]:"W%U ",[kr]:"%a ",[Ar]:"%j ",[Er]:"%H:00",[Mr]:"00:%M",[Cr]:":%S",[Sr]:".%L",["".concat(vr,"-").concat(xr)]:"%Y-%m ",["".concat(vr,"-").concat(xr,"-").concat(wr)]:"%Y-%m-%d ",["".concat(Er,"-").concat(Mr)]:"%H:%M"},Or=new Date;function zr(t){return Or.setFullYear(t),Or.setMonth(0),Or.setDate(1),Or.setHours(0,0,0,0),Or}function Rr(t){return Un.count(zr(t.getFullYear())-1,t)}function Pr(t){return $n.count(zr(t.getFullYear())-1,t)}function Br(t){return zr(t).getDay()}function Lr(t,e,n,r,i,o,a){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,o,a);return s.setFullYear(t),s}return new Date(t,e,n,r,i,o,a)}function jr(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return qn.count(e-1,t)}function Ur(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Jn.count(e-1,t)}function qr(t){return Or.setTime(Date.UTC(t,0,1)),Or.getUTCDay()}function Ir(t,e,n,r,i,o,a){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,a));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,a))}function Wr(t,e,n,r,i){const o=e||1,a=Kt(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===a&&o,e),l=new Date,u=Ie(t),c=u[vr]?s(vr):xe(2012),f=u[xr]?s(xr):u[br]?s(br):Ut,d=u[_r]&&u[kr]?s(kr,1,_r+kr):u[_r]?s(_r,1):u[kr]?s(kr,1):u[wr]?s(wr,1):u[Ar]?s(Ar,1):qt,h=u[Er]?s(Er):Ut,p=u[Mr]?s(Mr):Ut,m=u[Cr]?s(Cr):Ut,g=u[Sr]?s(Sr):Ut;return function(t){l.setTime(+t);const e=c(l);return i(e,f(l),d(l,e),h(l),p(l),m(l),g(l))}}function $r(t,e,n){return e+7*t-(n+6)%7}const Hr={[vr]:t=>t.getFullYear(),[br]:t=>Math.floor(t.getMonth()/3),[xr]:t=>t.getMonth(),[wr]:t=>t.getDate(),[Er]:t=>t.getHours(),[Mr]:t=>t.getMinutes(),[Cr]:t=>t.getSeconds(),[Sr]:t=>t.getMilliseconds(),[Ar]:t=>Rr(t),[_r]:t=>Pr(t),[_r+kr]:(t,e)=>$r(Pr(t),t.getDay(),Br(e)),[kr]:(t,e)=>$r(1,t.getDay(),Br(e))},Zr={[br]:t=>3*t,[_r]:(t,e)=>$r(t,0,Br(e))};function Yr(t,e){return Wr(t,e||1,Hr,Zr,Lr)}const Vr={[vr]:t=>t.getUTCFullYear(),[br]:t=>Math.floor(t.getUTCMonth()/3),[xr]:t=>t.getUTCMonth(),[wr]:t=>t.getUTCDate(),[Er]:t=>t.getUTCHours(),[Mr]:t=>t.getUTCMinutes(),[Cr]:t=>t.getUTCSeconds(),[Sr]:t=>t.getUTCMilliseconds(),[Ar]:t=>jr(t),[_r]:t=>Ur(t),[kr]:(t,e)=>$r(1,t.getUTCDay(),qr(e)),[_r+kr]:(t,e)=>$r(Ur(t),t.getUTCDay(),qr(e))},Gr={[br]:t=>3*t,[_r]:(t,e)=>$r(t,0,qr(e))};function Xr(t,e){return Wr(t,e||1,Vr,Gr,Ir)}const Qr={[vr]:or,[br]:sr.every(3),[xr]:sr,[_r]:$n,[wr]:Un,[kr]:Un,[Ar]:Un,[Er]:ur,[Mr]:fr,[Cr]:hr,[Sr]:pr},Jr={[vr]:ar,[br]:lr.every(3),[xr]:lr,[_r]:Jn,[wr]:qn,[kr]:qn,[Ar]:qn,[Er]:cr,[Mr]:dr,[Cr]:hr,[Sr]:pr};function Kr(t){return Qr[t]}function ti(t){return Jr[t]}function ei(t,e,n){return t?t.offset(e,n):void 0}function ni(t,e,n,r){return t?t.range(e,n,r):void 0}const ri=31536e6,ii=[vr,xr,wr,Er,Mr,Cr,Sr],oi=ii.slice(0,-1),ai=oi.slice(0,-1),si=ai.slice(0,-1),li=si.slice(0,-1),ui=[vr,xr],ci=[vr],fi=[[oi,1,1e3],[oi,5,5e3],[oi,15,15e3],[oi,30,3e4],[ai,1,6e4],[ai,5,3e5],[ai,15,9e5],[ai,30,18e5],[si,1,36e5],[si,3,108e5],[si,6,216e5],[si,12,432e5],[li,1,864e5],[[vr,_r],1,6048e5],[ui,1,2592e6],[ui,3,7776e6],[ci,1,ri]];function di(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function hi(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function pi(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function mi(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,u=Ci(i),c=Si(i),f=Ci(o),d=Si(o),h=Ci(a),p=Si(a),m=Ci(s),g=Si(s),y=Ci(l),v=Si(l),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Gi,e:Gi,f:to,g:fo,G:po,H:Xi,I:Qi,j:Ji,L:Ki,m:eo,M:no,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Bo,s:Lo,S:ro,u:io,U:oo,V:so,w:lo,W:uo,x:null,X:null,y:co,Y:ho,Z:mo,"%":Po},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:go,e:go,f:_o,g:No,G:zo,H:yo,I:vo,j:bo,L:xo,m:wo,M:ko,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Bo,s:Lo,S:Ao,u:Eo,U:Mo,V:So,w:Do,W:Fo,x:null,X:null,y:To,Y:Oo,Z:Ro,"%":Po},_={a:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:ji,e:ji,f:Hi,g:Ri,G:zi,H:qi,I:qi,j:Ui,L:$i,m:Li,M:Ii,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:Bi,Q:Yi,s:Vi,S:Wi,u:Fi,U:Ti,V:Ni,w:Di,W:Oi,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:Ri,Y:zi,Z:Pi,"%":Zi};function w(t,e){return function(n){var r,i,o,a=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(i=_i[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}}function k(t,e){return function(n){var r,i,o=pi(1900,void 0,1);if(A(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=hi(pi(o.y,0,1))).getUTCDay(),r=i>4||0===i?Kn.ceil(r):Kn(r),r=qn.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=di(pi(o.y,0,1))).getDay(),r=i>4||0===i?Hn.ceil(r):Hn(r),r=Un.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?hi(pi(o.y,0,1)).getUTCDay():di(pi(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,hi(o)):di(o)}}function A(t,e,n,r){for(var i,o,a=0,s=e.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=_[i in _i?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=k(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=k(t+="",!0);return e.toString=function(){return t},e}}}var gi,yi,vi,bi,xi,_i={"-":"",_:" ",0:"0"},wi=/^\s*\d+/,ki=/^%/,Ai=/[\\^$*+?|[\]().{}]/g;function Ei(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Mi(t){return t.replace(Ai,"\\$&")}function Ci(t){return new RegExp("^(?:"+t.map(Mi).join("|")+")","i")}function Si(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function Di(t,e,n){var r=wi.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Fi(t,e,n){var r=wi.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ti(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Ni(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Oi(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function zi(t,e,n){var r=wi.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ri(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Pi(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Bi(t,e,n){var r=wi.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Li(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function ji(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Ui(t,e,n){var r=wi.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function qi(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Ii(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Wi(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function $i(t,e,n){var r=wi.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Hi(t,e,n){var r=wi.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Zi(t,e,n){var r=ki.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Yi(t,e,n){var r=wi.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Vi(t,e,n){var r=wi.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Gi(t,e){return Ei(t.getDate(),e,2)}function Xi(t,e){return Ei(t.getHours(),e,2)}function Qi(t,e){return Ei(t.getHours()%12||12,e,2)}function Ji(t,e){return Ei(1+Un.count(or(t),t),e,3)}function Ki(t,e){return Ei(t.getMilliseconds(),e,3)}function to(t,e){return Ki(t,e)+"000"}function eo(t,e){return Ei(t.getMonth()+1,e,2)}function no(t,e){return Ei(t.getMinutes(),e,2)}function ro(t,e){return Ei(t.getSeconds(),e,2)}function io(t){var e=t.getDay();return 0===e?7:e}function oo(t,e){return Ei($n.count(or(t)-1,t),e,2)}function ao(t){var e=t.getDay();return e>=4||0===e?Vn(t):Vn.ceil(t)}function so(t,e){return t=ao(t),Ei(Vn.count(or(t),t)+(4===or(t).getDay()),e,2)}function lo(t){return t.getDay()}function uo(t,e){return Ei(Hn.count(or(t)-1,t),e,2)}function co(t,e){return Ei(t.getFullYear()%100,e,2)}function fo(t,e){return Ei((t=ao(t)).getFullYear()%100,e,2)}function ho(t,e){return Ei(t.getFullYear()%1e4,e,4)}function po(t,e){var n=t.getDay();return Ei((t=n>=4||0===n?Vn(t):Vn.ceil(t)).getFullYear()%1e4,e,4)}function mo(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ei(e/60|0,"0",2)+Ei(e%60,"0",2)}function go(t,e){return Ei(t.getUTCDate(),e,2)}function yo(t,e){return Ei(t.getUTCHours(),e,2)}function vo(t,e){return Ei(t.getUTCHours()%12||12,e,2)}function bo(t,e){return Ei(1+qn.count(ar(t),t),e,3)}function xo(t,e){return Ei(t.getUTCMilliseconds(),e,3)}function _o(t,e){return xo(t,e)+"000"}function wo(t,e){return Ei(t.getUTCMonth()+1,e,2)}function ko(t,e){return Ei(t.getUTCMinutes(),e,2)}function Ao(t,e){return Ei(t.getUTCSeconds(),e,2)}function Eo(t){var e=t.getUTCDay();return 0===e?7:e}function Mo(t,e){return Ei(Jn.count(ar(t)-1,t),e,2)}function Co(t){var e=t.getUTCDay();return e>=4||0===e?nr(t):nr.ceil(t)}function So(t,e){return t=Co(t),Ei(nr.count(ar(t),t)+(4===ar(t).getUTCDay()),e,2)}function Do(t){return t.getUTCDay()}function Fo(t,e){return Ei(Kn.count(ar(t)-1,t),e,2)}function To(t,e){return Ei(t.getUTCFullYear()%100,e,2)}function No(t,e){return Ei((t=Co(t)).getUTCFullYear()%100,e,2)}function Oo(t,e){return Ei(t.getUTCFullYear()%1e4,e,4)}function zo(t,e){var n=t.getUTCDay();return Ei((t=n>=4||0===n?nr(t):nr.ceil(t)).getUTCFullYear()%1e4,e,4)}function Ro(){return"+0000"}function Po(){return"%"}function Bo(t){return+t}function Lo(t){return Math.floor(+t/1e3)}function jo(t){const e={};return n=>e[n]||(e[n]=t(n))}function Uo(t){const e=jo(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=mn(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return r=e(n),i=e(".1f")(1)[1],t=>{const e=r(t),n=e.indexOf(i);if(n<0)return e;let o=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(e,n);const a=o<e.length?e.slice(o):"";for(;--o>n;)if("0"!==e[o]){++o;break}return e.slice(0,o)+a}}var r,i;return e(n)},formatSpan(t,r,i,o){o=mn(null==o?",f":o);const a=dn(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=bn(a,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(l=xn(a,s))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=_n(a))||(o.precision=l-2*("%"===o.type))}return e(o)}}}let qo,Io;function Wo(t){return Uo(Fn(t))}function $o(t){return arguments.length?qo=Wo(t):qo}function Ho(t,e,n){Jt(n=n||{})||Rt("Invalid time multi-format specifier: ".concat(n));const r=e(Cr),i=e(Mr),o=e(Er),a=e(wr),s=e(_r),l=e(xr),u=e(br),c=e(vr),f=t(n[Sr]||".%L"),d=t(n[Cr]||":%S"),h=t(n[Mr]||"%I:%M"),p=t(n[Er]||"%I %p"),m=t(n[wr]||n[kr]||"%a %d"),g=t(n[_r]||"%b %d"),y=t(n[xr]||"%B"),v=t(n[br]||"%B"),b=t(n[vr]||"%Y");return t=>(r(t)<t?f:i(t)<t?d:o(t)<t?h:a(t)<t?p:l(t)<t?s(t)<t?m:g:c(t)<t?u(t)<t?y:v:b)(t)}function Zo(t){const e=jo(t.format),n=jo(t.utcFormat);return{timeFormat:t=>Oe(t)?e(t):Ho(e,Kr,t),utcFormat:t=>Oe(t)?n(t):Ho(n,ti,t),timeParse:jo(t.parse),utcParse:jo(t.utcParse)}}function Yo(t){return Zo(mi(t))}function Vo(t){return arguments.length?Io=Yo(t):Io}gi=mi({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),yi=gi.format,vi=gi.parse,bi=gi.utcFormat,xi=gi.utcParse,qo=Uo({format:Mn,formatPrefix:Cn}),Io=Zo({format:yi,parse:vi,utcFormat:bi,utcParse:xi});const Go=(t,e)=>we({},t,e),Xo=/^(data:|([A-Za-z]+:)?\/\/)/,Qo=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Jo=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function Ko(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function ta(t,e){e=we({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,a;const s=Qo.test(t.replace(Jo,""));null!=t&&"string"==typeof t&&s||Rt("Sanitize failure, invalid URI: "+Be(t));const l=Xo.test(t);return(a=e.baseURL)&&!l&&(t.startsWith("/")||a.endsWith("/")||(t="/"+t),t=a+t),o=(i=t.startsWith("file://"))||"file"===e.mode||"http"!==e.mode&&!l&&n,i?t=t.slice(7):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function ea(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):na}async function na(){Rt("No file system access.")}function ra(t){return t?async function(e,n){const r=we({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?he(o[i])?o[i]():o.text():Rt(o.status+""+o.statusText)}:ia}async function ia(){Rt("No HTTP fetch method available.")}const oa=t=>null!=t&&t==t,aa=t=>!(Number.isNaN(+t)||t instanceof Date),sa={boolean:Le,integer:te,number:te,date:Ue,string:qe,unknown:jt},la=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>aa(t)&&Number.isInteger(+t),aa,t=>!Number.isNaN(Date.parse(t))],ua=["boolean","integer","number","date"];function ca(t){const e=function(e,n){const r={delimiter:t};return fa(e,n?we(n,r):r)};return e.responseType="text",e}function fa(t,e){return e.header&&(t=e.header.map(Be).join(e.delimiter)+"\n"+t),function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return He;if(u)return u=!1,$e;var e,r,i=a;if(t.charCodeAt(i)===Ze){for(;a++<o&&t.charCodeAt(a)!==Ze||t.charCodeAt(++a)===Ze;);return(e=a)>=o?l=!0:(r=t.charCodeAt(a++))===Ye?u=!0:r===Ve&&(u=!0,t.charCodeAt(a)===Ye&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===Ye)u=!0;else if(r===Ve)u=!0,t.charCodeAt(a)===Ye&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===Ye&&--o,t.charCodeAt(o-1)===Ve&&--o;(r=c())!==He;){for(var f=[];r!==$e&&r!==He;)f.push(r),r=c();e&&null==(f=e(f,s++))||i.push(f)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?function(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Qe(-e,6):e>9999?"+"+Qe(e,6):Qe(e,4))+"-"+Qe(t.getUTCMonth()+1,2)+"-"+Qe(t.getUTCDate(),2)+(o?"T"+Qe(n,2)+":"+Qe(r,2)+":"+Qe(i,2)+"."+Qe(o,3)+"Z":i?"T"+Qe(n,2)+":"+Qe(r,2)+":"+Qe(i,2)+"Z":r||n?"T"+Qe(n,2)+":"+Qe(r,2)+"Z":"")}(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Ge(t);return function(r,i){return e(n(r),i,t)}}(t,e):Ge(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=Xe(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Xe(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}(e.delimiter).parse(t+"")}function da(t,e){const n=e&&e.property?Bt(e.property):jt;return!Jt(t)||(r=t,"function"==typeof Buffer&&he(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){return!Qt(t)&&function(t){return t&&he(t[Symbol.iterator])}(t)&&(t=[...t]),e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}fa.responseType="text",da.responseType="json";const ha={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function pa(t,e){let n,r,i,o;return t=da(t,e),e&&e.feature?(n=Ke,i=e.feature):e&&e.mesh?(n=rn,i=e.mesh,o=ha[e.filter]):Rt("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):Rt("Invalid TopoJSON object: "+i),r&&r.features||[r]}pa.responseType="json";const ma={dsv:fa,csv:ca(","),tsv:ca("\t"),json:da,topojson:pa};function ga(t,e){return arguments.length>1?(ma[t]=e,this):Ee(ma,t)?ma[t]:null}function ya(t){const e=ga(t);return e&&e.responseType||"text"}const va=function(t,e){return e=>({options:e||{},sanitize:ta,load:Ko,fileAccess:!1,file:ea(null),http:ra(t)})}("undefined"!=typeof fetch&&fetch);function ba(t){const e=t||jt,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function xa(t,e){try{await e(t)}catch(e){t.error(e)}}const _a=Symbol("vega_id");let wa=1;function ka(t){return!(!t||!Aa(t))}function Aa(t){return t[_a]}function Ea(t,e){return t[_a]=e,t}function Ma(t){const e=t===Object(t)?t:{data:t};return Aa(e)?e:Ea(e,wa++)}function Ca(t){return Sa(t,Ma({}))}function Sa(t,e){for(const n in t)e[n]=t[n];return e}function Da(t,e){return Ea(e,Aa(t))}function Fa(t,e){return t?e?(n,r)=>t(n,r)||Aa(e(n))-Aa(e(r)):(e,n)=>t(e,n)||Aa(e)-Aa(n):null}function Ta(t){return t&&t.constructor===Na}function Na(){const t=[],e=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:Na,insert(e){const n=de(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=he(t)?r:e,i=de(t),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify(t,e,r){const o={field:e,value:xe(r)};return he(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return he(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return a=!0,this},pulse(s,l){const u={},c={};let f,d,h,p,m,g;for(f=0,d=l.length;f<d;++f)u[Aa(l[f])]=1;for(f=0,d=e.length;f<d;++f)m=e[f],u[Aa(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach((t=>{p(t)&&(u[Aa(t)]=-1)}));for(f=0,d=t.length;f<d;++f)m=t[f],g=Aa(m),u[g]?u[g]=1:s.add.push(Ma(t[f]));for(f=0,d=l.length;f<d;++f)m=l[f],u[Aa(m)]<0&&s.rem.push(m);function y(t,e,n){n?t[e]=n(t):s.encode=e,a||(c[Aa(t)]=t)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,g=u[Aa(m)],g>0&&(y(m,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach((t=>{p(t)&&u[Aa(t)]>0&&y(t,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=e.length||r.length?l.filter((t=>u[Aa(t)]>0)):l.slice();else for(g in c)s.mod.push(c[g]);return(o||null==o&&(e.length||r.length))&&s.clean(!0),s}}}const Oa="_:mod:_";function za(){Object.defineProperty(this,Oa,{writable:!0,value:{}})}za.prototype={set(t,e,n,r){const i=this,o=i[t],a=i[Oa];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,a[e+":"+t]=-1,a[t]=-1):(o!==n||r)&&(i[t]=n,a[t]=Qt(n)?1+n.length:-1),i},modified(t,e){const n=this[Oa];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(Qt(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[Oa]={},this}};let Ra=0;const Pa=new za;function Ba(t,e,n,r){this.id=++Ra,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function La(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}Ba.prototype={targets(){return this._targets||(this._targets=ba(Lt))},set(t){return this.value!==t?(this.value=t,1):0},skip:La(1),modified:La(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new za,i=this._argops=this._argops||[],o=[];let a,s,l,u;const c=(t,n,a)=>{a instanceof Ba?(a!==this&&(e&&a.targets().add(this),o.push(a)),i.push({op:a,name:t,index:n})):r.set(t,n,a)};for(a in t)if(s=t[a],"pulse"===a)de(s).forEach((t=>{t instanceof Ba?t!==this&&(t.targets().add(this),o.push(t)):Rt("Pulse parameters must be operator instances.")})),this.source=s;else if(Qt(s))for(r.set(a,-1,Array(l=s.length)),u=0;u<l;++u)c(a,u,s[u]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(t){const e=this._argval||Pa,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===t,e.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let ja=0;function Ua(t,e,n){this.id=++ja,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function qa(t,e,n){return new Ua(t,e,n)}Ua.prototype={_filter:It,_apply:jt,targets(){return this._targets||(this._targets=ba(Lt))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=qa(t);return this.targets().add(e),e},apply(t){const e=qa(null,t);return this.targets().add(e),e},merge(){const t=qa();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=qa();return this.targets().add(qa(null,null,_e(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(qa(null,null,(()=>n=!0))),e.targets().add(qa(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=It,this._targets=null}};const Ia={skip:!0};function Wa(t,e,n,r,i,o){const a=we({},o,Ia);let s,l;he(n)||(n=xe(n)),void 0===r?s=e=>t.touch(n(e)):he(r)?(l=new Ba(null,r,i,!1),s=e=>{l.evaluate(e);const r=n(e),i=l.value;Ta(i)?t.pulse(r,i,o):t.update(r,i,a)}):s=e=>t.update(n(e),r,a),e.apply(s)}function $a(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const a=o||{},s=new Ba(null,function(t,e){return e=he(e)?e:xe(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(a.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const Ha={};function Za(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Ya(t,e){const n=[];return We(t,e,(t=>n.push(t))),n}function Va(t,e){const n={};return t.visit(e,(t=>{n[Aa(t)]=1})),t=>n[Aa(t)]?null:t}function Ga(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function Xa(t,e,n,r){const i=this;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===e){if(a.fields){const t=i.fields||(i.fields={});for(const e in a.fields)t[e]=1}a.changed(i.ADD)&&(o|=i.ADD),a.changed(i.REM)&&(o|=i.REM),a.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function Qa(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}Za.prototype={StopPropagation:Ha,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new Za(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new Za(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,Va(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return Qt(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?Qt(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Ga(n.addF,e)),2&t&&(n.remF=Ga(n.remF,e)),4&t&&(n.modF=Ga(n.modF,e)),16&t&&(n.srcF=Ga(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=Ya(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=Ya(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=Ya(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return We(n.source,n.srcF,r),n;1&t&&We(n.add,n.addF,r),2&t&&We(n.rem,n.remF,r),4&t&&We(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||We(i,t?Va(n,5):n.srcF,r)}return n}},Se(Xa,Za,{fork(t){const e=new Za(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?Qt(t)?t.some((t=>n[t])):n[t]:0},filter(){Rt("MultiPulse does not support filtering.")},materialize(){Rt("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const Ja={skip:!1,force:!1};function Ka(t,e,n,r){let i,o;const a=t[n];for(;n>e&&(o=n-1>>1,i=t[o],r(a,i)<0);)t[n]=i,n=o;return t[n]=a}function ts(){this.logger(Xt()),this.logLevel(Zt),this._clock=0,this._rank=0,this._locale=function(t,e){const n=arguments.length;return n&&2!==n&&Rt("defaultLocale expects either zero or two arguments."),n?Go($o(t),Vo(e)):Go($o(),Vo())}();try{this._loader=va()}catch(t){}this._touched=ba(Lt),this._input={},this._pulse=null,this._heap=function(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Ka(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,o=t[e];let a,s=1+(e<<1);for(;s<i;)a=s+1,a<i&&n(t[s],t[a])>=0&&(s=a),t[e]=t[s],s=1+((e=s)<<1);t[e]=o,Ka(t,r,e,n)}(e,0,t)):r=n,r}}}(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function es(t){return function(){return this._log[t].apply(this,arguments)}}function ns(t,e){Ba.call(this,t,null,e)}ts.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:es("error"),warn:es("warn"),info:es("info"),debug:es("debug"),logLevel:es("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,o=1;return t instanceof Ba?i=t:t&&t.prototype instanceof Ba?i=new t:he(t)?i=new Ba(null,t):(o=0,i=new Ba(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&Rt("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||Ja);const r=new Za(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||Ja;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||Ja;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:Na,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return function(t,e,n,r){const i=ga((e=e||{}).type||"json");return i||Rt("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=Vo();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,l,u,c,f=t.columns||Object.keys(t[0]);"auto"===e&&(e=function(t,e){return e.reduce(((e,n)=>(e[n]=function(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=la.length,i=la.map(((t,e)=>e+1));for(let o,a,s=0,l=0;s<n;++s)for(a=e?t[s][e]:t[s],o=0;o<r;++o)if(i[o]&&oa(a)&&!la[o](a)&&(i[o]=0,++l,l===la.length))return"string";return ua[i.reduce(((t,e)=>0===t?e:t),0)-1]}(t,n),e)),{})}(t,f)),f=Object.keys(e);const d=f.map((t=>{const i=e[t];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:")))return o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1)),("utc"===o[0]?r:n)(a);if(!sa[i])throw Error("Illegal format pattern: "+t+":"+i);return sa[i]}));for(s=0,u=t.length,c=f.length;s<u;++s)for(o=t[s],l=0;l<c;++l)a=f[l],o[a]=d[l](o[a])}(t,e.parse,n,r),Ee(t,"columns")&&delete t.columns,t}(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0==--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(It).insert(o.data||[])),i.done(),o},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:ya(e&&e.type)});try{r=n.parse(r,e)}catch(e){i=-2,n.warn("Data ingestion failed",t,e)}}catch(e){i=-1,n.warn("Loading failed",t,e)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,o=qa(n,r),a=function(t){t.dataflow=i;try{o.receive(t)}catch(t){i.error(t)}finally{i.run()}};let s;s="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):de(t);const l=s.length;for(let u=0;u<l;++u)s[u].addEventListener(e,a);return o},on:function(t,e,n,r,i){return(t instanceof Ba?$a:Wa)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return Qa(r);if(r._pending&&await r._pending,e&&await xa(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Za(r,o,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=ba(Lt);let a,s,l,u=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,t)),s.then?s=await s:s.async&&(i.push(s.async),s=Ha),s!==Ha&&a._targets&&a._targets.forEach((t=>r._enqueue(t))),++u):r._enqueue(a,!0)}catch(t){r._heap.clear(),l=t}if(r._input={},r._pulse=null,r.debug("Pulse ".concat(o,": ").concat(u," operators")),l&&(r._postrun=[],r.error(l)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await xa(r,t[e].callback)}return n&&await xa(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(t){r.error(t)}}))})))),r},run:function(t,e,n){return this._pulse?Qa(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(t){this.error(t)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&Qt(n)?new Xa(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==Ha&&(t.source=e.source),t)}(this._pulse,n&&n.pulse)}},Se(ns,Ba,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const rs={};function is(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function os(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function as(t,e,n){return n||t+(e?"_"+e:"")}const ss=()=>{},ls={init:ss,add:ss,rem:ss,idx:0},us={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},cs=Object.keys(us).filter((t=>"__count__"!==t));function fs(t,e){return us[t](e)}function ds(t,e){return t.idx-e.idx}function hs(){this.valid=0,this.missing=0,this._ops.forEach((t=>t.init(this)))}function ps(t,e){null!=t&&""!==t?t==t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function ms(t,e){null!=t&&""!==t?t==t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function gs(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function ys(t,e){const n=e||jt,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=us[t]())}))};return t.forEach(n),Object.values(e).sort(ds)}(t),i=t.slice().sort(ds);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=hs,o.prototype.add=ps,o.prototype.rem=ms,o.prototype.set=gs,o.prototype.get=n,o.fields=t.map((t=>t.out)),o}function vs(t){this._key=t?Bt(t):Aa,this.reset()}[...cs,"__count__"].forEach((t=>{us[t]=function(t,e){return n=>we({name:t,out:n||t},ls,e)}(t,us[t])}));const bs=vs.prototype;function xs(t){ns.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function _s(t){ns.call(this,null,t)}function ws(t,e,n){const r=t;let i=e||[],o=n||[],a={},s=0;return{add:t=>o.push(t),remove:t=>a[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter((t=>!a[r(t)])),a={},s=0),e&&t&&i.sort(t),o.length&&(i=t?function(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const a=new e.constructor(i+o);let s=0,l=0,u=0;for(;s<i&&l<o;++u)a[u]=t(e[s],n[l])>0?n[l++]:e[s++];for(;s<i;++s,++u)a[u]=e[s];for(;l<o;++l,++u)a[u]=n[l];return a}(t,i,o.sort(t)):i.concat(o),o=[]),i)}}function ks(t){ns.call(this,[],t)}function As(t){Ba.call(this,null,Es,t)}function Es(t){return this.value&&!t.modified()?this.value:me(t.fields,t.orders)}function Ms(t){ns.call(this,null,t)}function Cs(t){ns.call(this,null,t)}bs.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},bs.add=function(t){this._add.push(t)},bs.rem=function(t){this._rem.push(t)},bs.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,o=Array(r-i),a={};let s,l,u;for(s=0;s<i;++s)a[n(e[s])]=1;for(s=0,l=0;s<r;++s)a[n(u=t[s])]?a[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o},bs.distinct=function(t){const e=this.values(),n={};let r,i=e.length,o=0;for(;--i>=0;)r=t(e[i])+"",Ee(n,r)||(n[r]=1,++o);return o},bs.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=function(t,e){const n=t.length;let r,i,o,a,s,l=-1;if(null==e){for(;++l<n;)if(i=t[l],null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=t[l],null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}else{for(;++l<n;)if(i=e(t[l],l,t),null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=e(t[l],l,t),null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}return[a,s]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},bs.argmin=function(t){return this.extent(t)[0]||{}},bs.argmax=function(t){return this.extent(t)[1]||{}},bs.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},bs.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},bs.quartile=function(t){return this._get===t&&this._q||(this._q=V(this.values(),t),this._get=t),this._q},bs.q1=function(t){return this.quartile(t)[0]},bs.q2=function(t){return this.quartile(t)[1]},bs.q3=function(t){return this.quartile(t)[2]},bs.ci=function(t){return this._get===t&&this._ci||(this._ci=function(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(Z(t,r)),o=i.length;let a,s,l,u;for(l=0,u=Array(1e3);l<1e3;++l){for(a=0,s=0;s<o;++s)a+=i[~~(Q()*o)];u[l]=a/o}return u.sort(R),[W(u,.025),W(u,.975)]}(this.values(),0,0,t),this._get=t),this._ci},bs.ci0=function(t){return this.ci(t)[0]},bs.ci1=function(t){return this.ci(t)[1]},xs.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:cs},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},Se(xs,ns,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):Object.create(null),e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function o(t){let e,o,a,s;for(e in t)for(a=t[e].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(t._prev),o(e),function o(a,s,l){const u=n[l],c=r[l++];for(const n in c){const r=a?a+"|"+n:n;s[u]=c[n],l<i?o(r,s,l):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=de(Tt(t)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,e.push(o))}this._dims=de(t.groupby),this._dnames=this._dims.map((t=>{const e=Ft(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:os(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=t.fields||[null],a=t.ops||["count"],s=t.as||[],l=o.length,u={};let c,f,d,h,p,m;for(l!==a.length&&Rt("Unmatched number of fields and aggregate ops."),m=0;m<l;++m)c=o[m],f=a[m],null==c&&"count"!==f&&Rt("Null aggregate field specified."),h=Ft(c),p=as(f,h,s[m]),n.push(p),"count"!==f?(d=u[h],d||(i(c),d=u[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(fs(f,p))):this._counts.push(p);return this._measures=this._measures.map((t=>ys(t,t.field))),Object.create(null)},cellkey:os(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new vs),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](t);return e?Da(e.tuple,o):Ma(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,a=t.rem,s=t.mod;let l,u,c,f;if(r)for(u in r)l=r[u],i&&!l.num||a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(e[c])),e[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(0===l.num&&i?a:s).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,t}}),_s.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},Se(_s,ns,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,a=t.as||["bin0","bin1"],s=a[0],l=a[1];let u;return u=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(Tt(t.field))?e.ADD_MOD:e.ADD,e.visit(u,n?t=>{const e=r(t);t[s]=e,t[l]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[s]=r(t)),e.modifies(n?a:s)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=X(t),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=t.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const l=function(t){let n=te(e(t));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return l.start=a,l.stop=n.stop,l.step=r,this.value=Dt(l,Tt(e),t.name||"bin_"+Ft(e))}}),ks.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Se(ks,ns,{transform(t,e){const n=e.fork(e.ALL),r=ws(Aa,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Fa(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),Se(As,Ba),Ms.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},Se(Ms,ns,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,o)||[],l=0,u=i.length;l<u;++l)a.test(r=i[l])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,a=this._stop,s=t.field,l=t.as||["text","count"],u=n((t=>i[t]=1+(i[t]||0))),c=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,u):(e.visit(e.ADD,u),e.visit(e.REM,c)),this._finish(e,l)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],o=e[1],a=t.fork(t.NO_SOURCE|t.NO_FIELDS);let s,l,u;for(s in n)l=r[s],u=n[s]||0,!l&&u?(r[s]=l=Ma({}),l[i]=s,l[o]=u,a.add.push(l)):0===u?(l&&a.rem.push(l),n[s]=null,r[s]=null):l[o]!==u&&(l[o]=u,a.mod.push(l));return a.modifies(e)}}),Cs.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Se(Cs,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],o=r[1],a=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,o,a=[],s={},l=t.length,u=0;u<l;++u)for(s[e]=o=t[u],i=0;i<l;++i)s[n]=t[i],r(s)&&(a.push(Ma(s)),(s={})[e]=o);return a}(s,i,o,t.filter||It)):n.mod=s,n.source=this.value,n.modifies(r)}});const Ss={kde:st,mixture:function(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=Q();let i=t[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(e<o){i=t[a];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)},normal:at,lognormal:function(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>lt(n,r),pdf:t=>ut(t,n,r),cdf:t=>ct(t,n,r),icdf:t=>ft(t,n,r)};return i.mean(t).stdev(e)},uniform:function(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>dt(n,r),pdf:t=>ht(t,n,r),cdf:t=>pt(t,n,r),icdf:t=>mt(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}},Ds="function";function Fs(t,e){const n=t[Ds];Ee(Ss,n)||Rt("Unknown distribution function: "+n);const r=Ss[n]();for(const i in t)"field"===i?r.data((t.from||e()).map(t[i])):"distributions"===i?r[i](t[i].map((t=>Fs(t,e)))):typeof r[i]===Ds&&r[i](t[i]);return r}function Ts(t){ns.call(this,null,t)}const Ns=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Os={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Ns},{name:"weights",type:"number",array:!0}]};function zs(t,e){return t?t.map(((t,n)=>e[n]||Ft(t))):null}function Rs(t,e,n){const r=[],i=t=>t(l);let o,a,s,l,u,c;if(null==e)r.push(t.map(n));else for(o={},a=0,s=t.length;a<s;++a)l=t[a],u=e.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}function Ps(t){ns.call(this,null,t)}function Bs(t){Ba.call(this,null,Ls,t),this.modified(!0)}function Ls(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Dt((n=>e(n,t)),Tt(e),Ft(e))}function js(t){ns.call(this,[void 0,void 0],t)}function Us(t,e){Ba.call(this,t),this.parent=e,this.count=0}function qs(t){ns.call(this,{},t),this._keys=Ce();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function Is(t){Ba.call(this,null,Ws,t)}function Ws(t){return this.value&&!t.modified()?this.value:Qt(t.name)?de(t.name).map((t=>Bt(t))):Bt(t.name,t.as)}function $s(t){ns.call(this,Ce(),t)}function Hs(t){ns.call(this,[],t)}function Zs(t){ns.call(this,[],t)}function Ys(t){ns.call(this,null,t)}function Vs(t){ns.call(this,[],t)}Ts.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Ns.concat(Os)},{name:"as",type:"string",array:!0,default:["value","density"]}]},Se(Ts,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=Fs(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let a=t.method||"pdf";"pdf"!==a&&"cdf"!==a&&Rt("Invalid density method: "+a),t.extent||r.data||Rt("Missing density extent parameter."),a=r[a];const s=t.as||["value","density"],l=Ct(a,t.extent||ke(r.data()),i,o).map((t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],Ma(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),Ps.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},Se(Ps,ns,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=Rs(e.source,t.groupby,jt),i=t.smooth||!1,o=t.field,a=t.step||((t,e)=>Pe(ke(t,e))/30)(n,o),s=Fa(((t,e)=>o(t)-o(e))),l=t.as||"bin",u=r.length;let c,f=1/0,d=-1/0,h=0;for(;h<u;++h){const t=r[h].sort(s);c=-1;for(const e of J(t,a,i,o))e<f&&(f=e),e>d&&(d=e),t[++c][l]=e}return this.value={start:f,stop:d,step:a},e.reflow(!0).modifies(l)}}),Se(Bs,Ba),js.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Se(js,ns,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=te(r(t));null!=e&&(e<o&&(o=e),e>a&&(a=e))})),!Number.isFinite(o)||!Number.isFinite(a)){let t=Ft(r);t&&(t=' for field "'.concat(t,'"')),e.dataflow.warn("Infinite extent".concat(t,": [").concat(o,", ").concat(a,"]")),o=a=void 0}this.value=[o,a]}}),Se(Us,Ba,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),Se(qs,ns,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let o,a,s=Ee(i,t)&&i[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[t])&&a.tuple,o=n.dataflow,s=new Us(n.fork(n.NO_SOURCE),this),o.add(s).connect(e(o,t,a)),i[t]=s,this.activate(s)),s},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,a=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=Aa(t),n=o.get(e);void 0!==n&&(o.delete(e),s(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);o.set(Aa(t),e),s(e).add(t)})),a||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=Aa(t),n=o.get(e),i=r(t);n===i?s(i).mod(t):(o.set(e,i),s(n).rem(t),s(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{s(o.get(Aa(t))).mod(t)})),a&&e.visit(e.REFLOW,(t=>{const e=Aa(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),s(n).rem(t),s(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),Se(Is,Ba),$s.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Se($s,ns,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),o=i.add,a=i.rem,s=i.mod,l=t.expr;let u=!0;function c(e){const n=Aa(e),i=l(e,t),c=r.get(n);i&&c?(r.delete(n),o.push(e)):i||c?u&&i&&!c&&s.push(e):(r.set(n,1),a.push(e))}return e.visit(e.REM,(t=>{const e=Aa(t);r.has(e)?r.delete(e):a.push(t)})),e.visit(e.ADD,(e=>{l(e,t)?o.push(e):r.set(Aa(e),1)})),e.visit(e.MOD,c),t.modified()&&(u=!1,e.visit(e.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Hs.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Se(Hs,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=zs(r,t.as||[]),o=t.index||null,a=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),s=e.reduce(((t,e)=>Math.max(t,e.length)),0);let l,u,c,f=0;for(;f<s;++f){for(u=Ca(t),l=0;l<a;++l)u[i[l]]=null==(c=e[l][f])?null:c;o&&(u[o]=f),n.add.push(u)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),Zs.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Se(Zs,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(Ft),o=t.as||["key","value"],a=o[0],s=o[1],l=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,o=0;o<l;++o)e=Ca(t),e[a]=i[o],e[s]=r[o](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(o)}}),Ys.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Se(Ys,ns,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,(e=>e[r]=n(e,t)))}}),Se(Vs,ns,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,o,a,s=this.value,l=t.size-s.length;if(l>0){for(i=[];--l>=0;)i.push(a=Ma(r(t))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-l),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-l);return n.source=this.value=s,n}});const Gs={value:"value",median:H,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:B,max:P},Xs=[];function Qs(t){ns.call(this,[],t)}function Js(t){xs.call(this,t)}function Ks(t){ns.call(this,null,t)}function tl(t){Ba.call(this,null,el,t)}function el(t){return this.value&&!t.modified()?this.value:ze(t.fields,t.flat)}function nl(t){ns.call(this,[],t),this._pending=null}function rl(t,e,n){n.forEach(Ma);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function il(t){ns.call(this,{},t)}function ol(t){Ba.call(this,null,al,t)}function al(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function sl(t){Ba.call(this,null,ll,t)}function ll(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function ul(t){ns.call(this,null,t)}function cl(t){xs.call(this,t)}function fl(t){qs.call(this,t)}function dl(t){ns.call(this,null,t)}function hl(t){ns.call(this,null,t)}function pl(t){ns.call(this,null,t)}function ml(t){ns.call(this,null,t)}function gl(t){ns.call(this,[],t),this.count=0}function yl(t){ns.call(this,null,t)}function vl(t){ns.call(this,null,t),this.modified(!0)}function bl(t){ns.call(this,null,t)}Qs.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Se(Qs,ns,{transform(t,e){var n,r,i,o,a,s,l,u,c,f,d=e.fork(e.ALL),h=function(t){var e,n=t.method||Gs.value;if(null!=Gs[n])return n===Gs.value?(e=void 0!==t.value?t.value:0,()=>e):Gs[n];Rt("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),m=Ft(t.field),g=Ft(t.key),y=(t.groupby||[]).map(Ft),v=function(t,e,n,r){var i,o,a,s,l,u,c,f,d=t=>t(f),h=[],p=r?r.slice():[],m={},g={};for(p.forEach(((t,e)=>m[t]=e+1)),s=0,c=t.length;s<c;++s)u=n(f=t[s]),l=m[u]||(m[u]=p.push(u)),(a=g[o=(i=e?e.map(d):Xs)+""])||(a=g[o]=[],h.push(a),a.values=i),a[l-1]=f;return h.domain=p,h}(e.source,t.groupby,t.key,t.keyvals),b=[],x=this.value,_=v.domain.length;for(a=0,u=v.length;a<u;++a)for(i=(n=v[a]).values,r=NaN,l=0;l<_;++l)if(null==n[l]){for(o=v.domain[l],f={_impute:!0},s=0,c=i.length;s<c;++s)f[y[s]]=i[s];f[g]=o,f[m]=Number.isNaN(r)?r=h(n,p):r,b.push(Ma(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),Js.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:cs},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},Se(Js,xs,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{we(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),Ks.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Se(Ks,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=Rs(r,t.groupby,t.field),o=(t.groupby||[]).map(Ft),a=t.bandwidth,s=t.cumulative?"cdf":"pdf",l=t.as||["value","density"],u=[];let c=t.extent,f=t.steps||t.minsteps||25,d=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&Rt("Invalid density method: "+s),"shared"===t.resolve&&(c||(c=ke(r,t.field)),f=d=t.steps||d),i.forEach((e=>{const n=st(e,a)[s],r=t.counts?e.length:1;Ct(n,c||ke(e),f,d).forEach((t=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=e.dims[r];n[l[0]]=t[0],n[l[1]]=t[1]*r,u.push(Ma(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),Se(tl,Ba),Se(nl,ns,{transform(t,e){const n=e.dataflow;if(this._pending)return rl(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return rl(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then((t=>(this._pending=de(t.data),t=>t.touch(this))));return{async:e}}return n.request(t.url,t.format).then((t=>rl(this,e,de(t.data))))}}),il.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Se(il,ns,{transform(t,e){const n=t.fields,r=t.index,i=t.values,o=null==t.default?null:t.default,a=t.modified(),s=n.length;let l,u,c,f=a?e.SOURCE:e.ADD,d=e,h=t.as;return i?(u=i.length,s>1&&!h&&Rt('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*u&&Rt('The "as" parameter has too few output field names.'),h=h||i.map(Ft),l=function(t){for(var e,a,l=0,c=0;l<s;++l)if(null==(a=r.get(n[l](t))))for(e=0;e<u;++e,++c)t[h[c]]=o;else for(e=0;e<u;++e,++c)t[h[c]]=i[e](a)}):(h||Rt("Missing output field names."),l=function(t){for(var e,i=0;i<s;++i)e=r.get(n[i](t)),t[h[i]]=null==e?o:e}),a?d=e.reflow(!0):(c=n.some((t=>e.modified(t.fields))),f|=c?e.MOD:0),e.visit(f,l),d.modifies(h)}}),Se(ol,Ba),Se(sl,Ba),Se(ul,ns,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),cl.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:cs,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},Se(cl,xs,{_transform:xs.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=Tt(n).concat(Tt(r)),a=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(ge),e?i.slice(0,e):i}(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:a.map((()=>i)),fields:a.map((t=>function(t,e,n,r){return Dt((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,o))),as:a.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),Se(fl,qs,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Aa(t),n,e,t);return(t.modified("field")||r&&e.modified(Tt(r)))&&Rt("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(Ma(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),dl.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Se(dl,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=zs(t.fields,t.as||[]),o=r?(t,e)=>function(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):Sa;let a;return this.value?a=this.value:(e=e.addAll(),a=this.value={}),e.visit(e.REM,(t=>{const e=Aa(t);n.rem.push(a[e]),a[e]=null})),e.visit(e.ADD,(t=>{const e=o(t,Ma({}));a[Aa(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(o(t,a[Aa(t)]))})),n}}),Se(hl,ns,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),pl.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},Se(pl,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=Rs(e.materialize(e.SOURCE).source,t.groupby,t.field),o=(t.groupby||[]).map(Ft),a=[],s=t.step||.01,l=t.probs||is(s/2,1-1e-14,s),u=l.length;return i.forEach((t=>{const e=Y(t,l);for(let n=0;n<u;++n){const i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[r[0]]=l[n],i[r[1]]=e[n],a.push(Ma(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),Se(ml,ns,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=Aa(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=Ca(t);r[Aa(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[Aa(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),gl.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Se(gl,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value.reduce(((t,e)=>(t[Aa(e)]=1,t)),{});let a=this.value,s=this.count,l=0;function u(t){let e,r;a.length<i?a.push(t):(r=~~((s+1)*Q()),r<a.length&&r>=l&&(e=a[r],o[Aa(e)]&&n.rem.push(e),a[r]=t)),++s}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=Aa(t);o[e]&&(o[e]=-1,n.rem.push(t)),--s})),a=a.filter((t=>-1!==o[Aa(t)]))),(e.rem.length||r)&&a.length<i&&e.source&&(l=s=a.length,e.visit(e.SOURCE,(t=>{o[Aa(t)]||u(t)})),l=-1),r&&a.length>i){const t=a.length-i;for(let e=0;e<t;++e)o[Aa(a[e])]=-1,n.rem.push(a[e]);a=a.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{o[Aa(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,u),(e.add.length||l<0)&&(n.add=a.filter((t=>!o[Aa(t)]))),this.count=s,this.value=n.source=a,n}}),yl.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Se(yl,ns,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=is(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,Ma(e)})),n.add=e.add.concat(this.value),n}}),Se(vl,ns,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const xl=["unit0","unit1"];function _l(t){ns.call(this,Ce(),t)}function wl(t){ns.call(this,null,t)}bl.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Dr,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:xl}]},Se(bl,ns,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),a=(i?ti:Kr)(o.unit).offset,s=t.as||xl,l=s[0],u=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=e.ADD;return(t.modified()||e.changed(e.REM)||e.modified(Tt(n)))&&(h=(e=e.reflow(!0)).SOURCE,f=1/0,d=-1/0),e.visit(h,(t=>{const e=n(t);let i,s;null==e?(t[l]=null,r&&(t[u]=null)):(t[l]=i=s=o(e),r&&(t[u]=s=a(i,c)),i<f&&(f=i),s>d&&(d=s))})),o.start=f,o.stop=d,e.modifies(r?s:l)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:function(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(Pe(e))/n;let i,o,a=gr((t=>t[2])).right(fi,r);return a===fi.length?(i=ci,o=dn(e[0]/ri,e[1]/ri,n)):a?(a=fi[r/fi[a-1][2]<fi[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=ii,o=Math.max(dn(e[0],e[1],n),1)),{units:i,step:o}}({extent:t.extent||ke(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),o=Tr(r),a=this.value||{},s=(n?Xr:Yr)(o,i);return s.unit=Kt(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),Se(_l,ns,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let a=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),Se(wl,ns,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(Fa(t.sort)):e.source).map(t.field))}});const kl={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=kl.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||Rt("ntile num must be greater than zero.");const n=kl.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||Rt("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n)if(null!=t(e[n]))return n;return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}},Al=Object.keys(kl);function El(t){const e=de(t.ops),n=de(t.fields),r=de(t.params),i=de(t.as),o=this.outputs=[],a=this.windows=[],s={},l={},u=[],c=[];let f=!0;function d(t){de(Tt(t)).forEach((t=>s[t]=1))}d(t.sort),e.forEach(((t,e)=>{const s=n[e],h=Ft(s),p=as(t,h,i[e]);if(d(s),o.push(p),Ee(kl,t))a.push(function(t,e,n,r){const i=kl[t](e,n);return{init:i.init||Ut,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==s&&"count"!==t&&Rt("Null aggregate field specified."),"count"===t)return void u.push(p);f=!1;let e=l[h];e||(e=l[h]=[],e.field=s,c.push(e)),e.push(fs(t,p))}})),(u.length||c.length)&&(this.cell=function(t,e,n){t=t.map((t=>ys(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new t[a](r);if(r.store)var s=r.data=new vs;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,a;for(s&&s.values(),i=0,a=e.length;i<a;++i)t[e[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)o[t].init()},r}(c,u,f)),this.inputs=Object.keys(s)}const Ml=El.prototype;function Cl(t){ns.call(this,{},t),this._mlen=0,this._mods=[]}function Sl(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=t.data(n),l=s.length,u=o?gr(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||xe(-1)};e.init();for(let f=0;f<l;++f)Dl(c,a,f,l),o&&Fl(c,u),e.update(c,s[f])}function Dl(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Fl(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}function Tl(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Nl(t){this._context=t}function Ol(){}function zl(t){this._context=t}function Rl(t){this._context=t}function Pl(t,e){this._basis=new Nl(t),this._beta=e}Ml.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},Ml.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,o=r&&r.length;let a;if(n){for(a=t.p0;a<t.i0;++a)n.rem(i[a]);for(a=t.p1;a<t.i1;++a)n.add(i[a]);n.set(e)}for(a=0;a<o;++a)r[a].update(t,e)},Cl.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Al.concat(cs)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},Se(Cl,ns,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=Fa(t.sort),i=os(t.groupby),o=t=>this.group(i(t));let a=this.state;a&&!n||(a=this.state=new El(t)),n||e.modified(a.inputs)?(this.value={},e.visit(e.SOURCE,(t=>o(t).add(t)))):(e.visit(e.REM,(t=>o(t).remove(t))),e.visit(e.ADD,(t=>o(t).add(t))));for(let s=0,l=this._mlen;s<l;++s)Sl(this._mods[s],a,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(a.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=ws(Aa),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),Nl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Tl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Tl(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},zl.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Tl(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Rl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Tl(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Pl.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*a),this._beta*e[l]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const Bl=function t(e){function n(t){return 1===e?new Nl(t):new Pl(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Ll(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function jl(t,e){this._context=t,this._k=(1-e)/6}jl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ll(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Ll(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Ul=function t(e){function n(t){return new jl(t,e)}return n.tension=function(e){return t(+e)},n}(0);function ql(t,e){this._context=t,this._k=(1-e)/6}ql.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ll(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Il=function t(e){function n(t){return new ql(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Wl(t,e){this._context=t,this._k=(1-e)/6}Wl.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Ll(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const $l=function t(e){function n(t){return new Wl(t,e)}return n.tension=function(e){return t(+e)},n}(0),Hl=Math.abs,Zl=Math.atan2,Yl=Math.cos,Vl=Math.max,Gl=Math.min,Xl=Math.sin,Ql=Math.sqrt,Jl=1e-12,Kl=Math.PI,tu=Kl/2,eu=2*Kl;function nu(t){return t>=1?tu:t<=-1?-tu:Math.asin(t)}function ru(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>Jl){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>Jl){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function iu(t,e){this._context=t,this._alpha=e}iu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:ru(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const ou=function t(e){function n(t){return e?new iu(t,e):new jl(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function au(t,e){this._context=t,this._alpha=e}au.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:ru(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const su=function t(e){function n(t){return e?new au(t,e):new Wl(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function lu(t,e){this._context=t,this._alpha=e}lu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ru(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const uu=function t(e){function n(t){return e?new lu(t,e):new ql(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function cu(t){this._context=t}function fu(t){return new cu(t)}function du(t){this._context=t}function hu(t){return t<0?-1:1}function pu(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(hu(o)+hu(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function mu(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function gu(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function yu(t){this._context=t}function vu(t){this._context=new bu(t)}function bu(t){this._context=t}function xu(t){this._context=t}function _u(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function wu(t,e){this._context=t,this._t=e}function ku(t){return function(){return t}}cu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},du.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},yu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gu(this,this._t0,mu(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,gu(this,mu(this,n=pu(this,t,e)),n);break;default:gu(this,this._t0,n=pu(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(vu.prototype=Object.create(yu.prototype)).point=function(t,e){yu.prototype.point.call(this,e,t)},bu.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},xu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=_u(t),i=_u(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},wu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const Au=Math.PI,Eu=2*Au,Mu=1e-6,Cu=Eu-Mu;function Su(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Du{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Su:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: ".concat(t));if(e>15)return Su;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append(r||(r=U(["M",",",""])),this._x0=this._x1=+t,this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(i||(i=U(["Z"]))))}lineTo(t,e){this._append(o||(o=U(["L",",",""])),this._x1=+t,this._y1=+e)}quadraticCurveTo(t,e,n,r){this._append(a||(a=U(["Q",",",",",",",""])),+t,+e,this._x1=+n,this._y1=+r)}bezierCurveTo(t,e,n,r,i,o){this._append(s||(s=U(["C",",",",",",",",",",",""])),+t,+e,+n,+r,this._x1=+i,this._y1=+o)}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let o=this._x1,a=this._y1,s=n-t,d=r-e,h=o-t,p=a-e,m=h*h+p*p;if(null===this._x1)this._append(l||(l=U(["M",",",""])),this._x1=t,this._y1=e);else if(m>Mu)if(Math.abs(p*s-d*h)>Mu&&i){let l=n-o,f=r-a,g=s*s+d*d,y=l*l+f*f,v=Math.sqrt(g),b=Math.sqrt(m),x=i*Math.tan((Au-Math.acos((g+m-y)/(2*v*b)))/2),_=x/b,w=x/v;Math.abs(_-1)>Mu&&this._append(u||(u=U(["L",",",""])),t+_*h,e+_*p),this._append(c||(c=U(["A",",",",0,0,",",",",",""])),i,i,+(p*l>h*f),this._x1=t+w*s,this._y1=e+w*d)}else this._append(f||(f=U(["L",",",""])),this._x1=t,this._y1=e)}arc(t,e,n,r,i,o){if(t=+t,e=+e,o=!!o,(n=+n)<0)throw new Error("negative radius: ".concat(n));let a=n*Math.cos(r),s=n*Math.sin(r),l=t+a,u=e+s,c=1^o,f=o?r-i:i-r;null===this._x1?this._append(d||(d=U(["M",",",""])),l,u):(Math.abs(this._x1-l)>Mu||Math.abs(this._y1-u)>Mu)&&this._append(h||(h=U(["L",",",""])),l,u),n&&(f<0&&(f=f%Eu+Eu),f>Cu?this._append(p||(p=U(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,c,t-a,e-s,n,n,c,this._x1=l,this._y1=u):f>Mu&&this._append(m||(m=U(["A",",",",0,",",",",",",",""])),n,n,+(f>=Au),c,this._x1=t+n*Math.cos(i),this._y1=e+n*Math.sin(i)))}rect(t,e,n,r){this._append(g||(g=U(["M",",","h","v","h","Z"])),this._x0=this._x1=+t,this._y0=this._y1=+e,n=+n,+r,-n)}toString(){return this._}}function Fu(){return new Du}function Tu(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: ".concat(n));e=t}return t},()=>new Du(e)}function Nu(t){return t.innerRadius}function Ou(t){return t.outerRadius}function zu(t){return t.startAngle}function Ru(t){return t.endAngle}function Pu(t){return t&&t.padAngle}function Bu(t,e,n,r,i,o,a){var s=t-n,l=e-r,u=(a?o:-o)/Ql(s*s+l*l),c=u*l,f=-u*s,d=t+c,h=e+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,v=p-d,b=m-h,x=v*v+b*b,_=i-o,w=d*m-p*h,k=(b<0?-1:1)*Ql(Vl(0,_*_*x-w*w)),A=(w*b-v*k)/x,E=(-w*v-b*k)/x,M=(w*b+v*k)/x,C=(-w*v+b*k)/x,S=A-g,D=E-y,F=M-g,T=C-y;return S*S+D*D>F*F+T*T&&(A=M,E=C),{cx:A,cy:E,x01:-c,y01:-f,x11:A*(i/_-1),y11:E*(i/_-1)}}function Lu(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function ju(t){return t[0]}function Uu(t){return t[1]}function qu(t,e){var n=ku(!0),r=null,i=fu,o=null,a=Tu(s);function s(s){var l,u,c,f=(s=Lu(s)).length,d=!1;for(null==r&&(o=i(c=a())),l=0;l<=f;++l)!(l<f&&n(u=s[l],l,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+t(u,l,s),+e(u,l,s));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?ju:ku(t),e="function"==typeof e?e:void 0===e?Uu:ku(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:ku(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s}function Iu(t,e,n){var r=null,i=ku(!0),o=null,a=fu,s=null,l=Tu(u);function u(u){var c,f,d,h,p,m=(u=Lu(u)).length,g=!1,y=new Array(m),v=new Array(m);for(null==o&&(s=a(p=l())),c=0;c<=m;++c){if(!(c<m&&i(h=u[c],c,u))===g)if(g=!g)f=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=f;--d)s.point(y[d],v[d]);s.lineEnd(),s.areaEnd()}g&&(y[c]=+t(h,c,u),v[c]=+e(h,c,u),s.point(r?+r(h,c,u):y[c],n?+n(h,c,u):v[c]))}if(p)return s=null,p+""||null}function c(){return qu().defined(i).curve(a).context(o)}return t="function"==typeof t?t:void 0===t?ju:ku(+t),e="function"==typeof e?e:ku(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?Uu:ku(+n),u.x=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ku(+t),u):r},u.y=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:ku(+t),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:ku(!!t),u):i},u.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),u):a},u.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),u):o},u}Fu.prototype=Du.prototype,Array.prototype.slice,Ql(3);const Wu={draw(t,e){const n=Ql(e/Kl);t.moveTo(n,0),t.arc(0,0,n,0,eu)}};function $u(t,e){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}Ql(1/3),Xl(Kl/10),Xl(7*Kl/10),Xl(eu/10),Yl(eu/10),Ql(3),Ql(3),Ql(3),Ql(12);const Hu=gr(R),Zu=Hu.right,Yu=Hu.left,Vu=(gr(I).center,Zu);function Gu(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Xu(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Qu(){}var Ju=.7,Ku=1/Ju,tc="\\s*([+-]?\\d+)\\s*",ec="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rc=/^#([0-9a-f]{3,8})$/,ic=new RegExp("^rgb\\(".concat(tc,",").concat(tc,",").concat(tc,"\\)$")),oc=new RegExp("^rgb\\(".concat(nc,",").concat(nc,",").concat(nc,"\\)$")),ac=new RegExp("^rgba\\(".concat(tc,",").concat(tc,",").concat(tc,",").concat(ec,"\\)$")),sc=new RegExp("^rgba\\(".concat(nc,",").concat(nc,",").concat(nc,",").concat(ec,"\\)$")),lc=new RegExp("^hsl\\(".concat(ec,",").concat(nc,",").concat(nc,"\\)$")),uc=new RegExp("^hsla\\(".concat(ec,",").concat(nc,",").concat(nc,",").concat(ec,"\\)$")),cc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function fc(){return this.rgb().formatHex()}function dc(){return this.rgb().formatRgb()}function hc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=rc.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?pc(e):3===n?new vc(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?mc(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?mc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ic.exec(t))?new vc(e[1],e[2],e[3],1):(e=oc.exec(t))?new vc(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ac.exec(t))?mc(e[1],e[2],e[3],e[4]):(e=sc.exec(t))?mc(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=lc.exec(t))?Ac(e[1],e[2]/100,e[3]/100,1):(e=uc.exec(t))?Ac(e[1],e[2]/100,e[3]/100,e[4]):cc.hasOwnProperty(t)?pc(cc[t]):"transparent"===t?new vc(NaN,NaN,NaN,0):null}function pc(t){return new vc(t>>16&255,t>>8&255,255&t,1)}function mc(t,e,n,r){return r<=0&&(t=e=n=NaN),new vc(t,e,n,r)}function gc(t){return t instanceof Qu||(t=hc(t)),t?new vc((t=t.rgb()).r,t.g,t.b,t.opacity):new vc}function yc(t,e,n,r){return 1===arguments.length?gc(t):new vc(t,e,n,null==r?1:r)}function vc(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function bc(){return"#".concat(kc(this.r)).concat(kc(this.g)).concat(kc(this.b))}function xc(){const t=_c(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(wc(this.r),", ").concat(wc(this.g),", ").concat(wc(this.b)).concat(1===t?")":", ".concat(t,")"))}function _c(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function kc(t){return((t=wc(t))<16?"0":"")+t.toString(16)}function Ac(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Cc(t,e,n,r)}function Ec(t){if(t instanceof Cc)return new Cc(t.h,t.s,t.l,t.opacity);if(t instanceof Qu||(t=hc(t)),!t)return new Cc;if(t instanceof Cc)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new Cc(a,s,l,t.opacity)}function Mc(t,e,n,r){return 1===arguments.length?Ec(t):new Cc(t,e,n,null==r?1:r)}function Cc(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Sc(t){return(t=(t||0)%360)<0?t+360:t}function Dc(t){return Math.max(0,Math.min(1,t||0))}function Fc(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Tc(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function Nc(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Tc((n-r/e)*e,a,i,o,s)}}function Oc(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return Tc((n-r/e)*e,i,o,a,s)}}Gu(Qu,hc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fc,formatHex:fc,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ec(this).formatHsl()},formatRgb:dc,toString:dc}),Gu(vc,yc,Xu(Qu,{brighter(t){return t=null==t?Ku:Math.pow(Ku,t),new vc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Ju:Math.pow(Ju,t),new vc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vc(wc(this.r),wc(this.g),wc(this.b),_c(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bc,formatHex:bc,formatHex8:function(){return"#".concat(kc(this.r)).concat(kc(this.g)).concat(kc(this.b)).concat(kc(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:xc,toString:xc})),Gu(Cc,Mc,Xu(Qu,{brighter(t){return t=null==t?Ku:Math.pow(Ku,t),new Cc(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Ju:Math.pow(Ju,t),new Cc(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new vc(Fc(t>=240?t-240:t+120,i,r),Fc(t,i,r),Fc(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Cc(Sc(this.h),Dc(this.s),Dc(this.l),_c(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=_c(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(Sc(this.h),", ").concat(100*Dc(this.s),"%, ").concat(100*Dc(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const zc=t=>()=>t;function Rc(t,e){return function(n){return t+n*e}}function Pc(t,e){var n=e-t;return n?Rc(t,n>180||n<-180?n-360*Math.round(n/360):n):zc(isNaN(t)?e:t)}function Bc(t,e){var n=e-t;return n?Rc(t,n):zc(isNaN(t)?e:t)}const Lc=function t(e){var n=function(t){return 1==(t=+t)?Bc:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):zc(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=yc(t)).r,(e=yc(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Bc(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function jc(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=yc(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var Uc=jc(Nc),qc=jc(Oc);function Ic(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function Wc(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function $c(t,e){return(Wc(e)?Ic:Hc)(t,e)}function Hc(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Jc(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function Zc(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Yc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Vc(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Jc(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Gc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xc=new RegExp(Gc.source,"g");function Qc(t,e){var n,r,i,o=Gc.lastIndex=Xc.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=Gc.exec(t))&&(r=Xc.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Yc(n,r)})),o=Xc.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function Jc(t,e){var n,r=typeof e;return null==e||"boolean"===r?zc(e):("number"===r?Yc:"string"===r?(n=hc(e))?(e=n,Lc):Qc:e instanceof hc?Lc:e instanceof Date?Zc:Wc(e)?Ic:Array.isArray(e)?Hc:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Vc:Yc)(t,e)}function Kc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function tf(t){return+t}var ef=[0,1];function nf(t){return t}function rf(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function of(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=rf(i,r),o=n(a,o)):(r=rf(r,i),o=n(o,a)),function(t){return o(r(t))}}function af(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=rf(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Vu(t,e,1,r)-1;return o[n](i[n](e))}}function sf(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function lf(){var t,e,n,r,i,o,a=ef,s=ef,l=Jc,u=nf;function c(){var t=Math.min(a.length,s.length);return u!==nf&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(a[0],a[t-1])),r=t>2?af:of,i=o=null,f}function f(e){return null==e||isNaN(e=+e)?n:(i||(i=r(a.map(t),s,l)))(t(u(e)))}return f.invert=function(n){return u(e((o||(o=r(s,a.map(t),Yc)))(n)))},f.domain=function(t){return arguments.length?(a=Array.from(t,tf),c()):a.slice()},f.range=function(t){return arguments.length?(s=Array.from(t),c()):s.slice()},f.rangeRound=function(t){return s=Array.from(t),l=Kc,c()},f.clamp=function(t){return arguments.length?(u=!!t||nf,c()):u!==nf},f.interpolate=function(t){return arguments.length?(l=t,c()):l},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,c()}}function uf(){return lf()(nf,nf)}function cf(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function ff(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}function df(t,e,n,r){var i,o=dn(t,e,n);switch((r=mn(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=bn(o,a))||(r.precision=i),Cn(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=xn(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=_n(o))||(r.precision=i-2*("%"===r.type))}return Mn(r)}function hf(t){var e=t.domain;return t.ticks=function(t){var n=e();return cn(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return df(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,s=o.length-1,l=o[a],u=o[s],c=10;for(u<l&&(i=l,l=u,u=i,i=a,a=s,s=i);c-- >0;){if((i=fn(l,u,n))===r)return o[a]=l,o[s]=u,e(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function pf(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}function mf(t){return Math.log(t)}function gf(t){return Math.exp(t)}function yf(t){return-Math.log(-t)}function vf(t){return-Math.exp(-t)}function bf(t){return isFinite(t)?+("1e"+t):t<0?0:t}function xf(t){return(e,n)=>-t(-e,n)}function _f(t){const e=t(mf,gf),n=e.domain;let r,i,o=10;function a(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(o),i=function(t){return 10===t?bf:t===Math.E?Math.exp:e=>Math.pow(t,e)}(o),n()[0]<0?(r=xf(r),i=xf(i),t(yf,vf)):t(mf,gf),e}return e.base=function(t){return arguments.length?(o=+t,a()):o},e.domain=function(t){return arguments.length?(n(t),a()):n()},e.ticks=t=>{const e=n();let a=e[0],s=e[e.length-1];const l=s<a;l&&([a,s]=[s,a]);let u,c,f=r(a),d=r(s);const h=null==t?10:+t;let p=[];if(!(o%1)&&d-f<h){if(f=Math.floor(f),d=Math.ceil(d),a>0){for(;f<=d;++f)for(u=1;u<o;++u)if(c=f<0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}}else for(;f<=d;++f)for(u=o-1;u>=1;--u)if(c=f>0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}2*p.length<h&&(p=cn(a,s,h))}else p=cn(f,d,Math.min(d-f,h)).map(i);return l?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=mn(n)).precision||(n.trim=!0),n=Mn(n)),t===1/0)return n;const a=Math.max(1,o*t/e.ticks().length);return t=>{let e=t/i(Math.round(r(t)));return e*o<o-.5&&(e*=o),e<=a?n(t):""}},e.nice=()=>n(pf(n(),{floor:t=>i(Math.floor(r(t))),ceil:t=>i(Math.ceil(r(t)))})),e}function wf(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function kf(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Af(t){return t<0?-t*t:t*t}function Ef(t){var e=t(nf,nf),n=1;return e.exponent=function(e){return arguments.length?1==(n=+e)?t(nf,nf):.5===n?t(kf,Af):t(wf(n),wf(1/n)):n},hf(e)}function Mf(){var t=Ef(lf());return t.copy=function(){return sf(t,Mf()).exponent(t.exponent())},cf.apply(t,arguments),t}function Cf(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Sf(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Df(t){var e=1,n=t(Cf(e),Sf(e));return n.constant=function(n){return arguments.length?t(Cf(e=+n),Sf(e)):e},hf(n)}function Ff(t,e,n,r,i,o){const a=[[hr,1,zn],[hr,5,5e3],[hr,15,15e3],[hr,30,3e4],[o,1,Rn],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,Pn],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,Bn],[r,2,1728e5],[n,1,Ln],[e,1,2592e6],[e,3,7776e6],[t,1,jn]];function s(e,n,r){const i=Math.abs(n-e)/r,o=gr((t=>{let[,,e]=t;return e})).right(a,i);if(o===a.length)return t.every(dn(e/jn,n/jn,r));if(0===o)return pr.every(Math.max(dn(e,n,r),1));const[s,l]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(l)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"==typeof n.range?n:s(t,e,n),o=i?i.range(t,+e+1):[];return r?o.reverse():o},s]}const[Tf,Nf]=Ff(ar,lr,Jn,In,cr,dr),[Of,zf]=Ff(or,sr,$n,Un,ur,fr);function Rf(t){return new Date(t)}function Pf(t){return t instanceof Date?+t:+new Date(+t)}function Bf(t,e,n,r,i,o,a,s,l,u){var c=uf(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),v=u("%b %d"),b=u("%B"),x=u("%Y");function _(t){return(l(t)<t?h:s(t)<t?p:a(t)<t?m:o(t)<t?g:r(t)<t?i(t)<t?y:v:n(t)<t?b:x)(t)}return c.invert=function(t){return new Date(f(t))},c.domain=function(t){return arguments.length?d(Array.from(t,Pf)):d().map(Rf)},c.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},c.tickFormat=function(t,e){return null==e?_:u(e)},c.nice=function(t){var n=d();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(pf(n,t)):c},c.copy=function(){return sf(c,Bf(t,e,n,r,i,o,a,s,l,u))},c}function Lf(){return cf.apply(Bf(Of,zf,or,sr,$n,Un,ur,fr,hr,yi).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function jf(){var t,e,n,r,i,o=0,a=1,s=nf,l=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([o,a]=i,t=r(o=+o),e=r(a=+a),n=t===e?0:1/(e-t),u):[o,a]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=c(Jc),u.rangeRound=c(Kc),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),u}}function Uf(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function qf(){var t=hf(jf()(nf));return t.copy=function(){return Uf(t,qf())},ff.apply(t,arguments)}function If(){var t=Ef(jf());return t.copy=function(){return Uf(t,If()).exponent(t.exponent())},ff.apply(t,arguments)}function Wf(t,e){void 0===e&&(e=t,t=Jc);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function $f(){var t,e,n,r,i,o,a,s=0,l=.5,u=1,c=1,f=nf,d=!1;function h(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(c*t<c*e?r:i),f(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,f=Wf(t,[n,r,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(a){return arguments.length?([s,l,u]=a,t=o(s=+s),e=o(l=+l),n=o(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,h):[s,l,u]},h.clamp=function(t){return arguments.length?(d=!!t,h):d},h.interpolator=function(t){return arguments.length?(f=t,h):f},h.range=p(Jc),h.rangeRound=p(Kc),h.unknown=function(t){return arguments.length?(a=t,h):a},function(a){return o=a,t=a(s),e=a(l),n=a(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,h}}function Hf(){var t=Ef($f());return t.copy=function(){return Uf(t,Hf()).exponent(t.exponent())},ff.apply(t,arguments)}class Zf extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qf;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(Vf(this,t))}has(t){return super.has(Vf(this,t))}set(t,e){return super.set(Gf(this,t),e)}delete(t){return super.delete(Xf(this,t))}}class Yf extends Set{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qf;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const n of t)this.add(n)}has(t){return super.has(Vf(this,t))}add(t){return super.add(Gf(this,t))}delete(t){return super.delete(Xf(this,t))}}function Vf(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function Gf(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function Xf(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function Qf(t){return null!==t&&"object"==typeof t?t.valueOf():t}const Jf=Symbol("implicit");function Kf(){var t=new Zf,e=[],n=[],r=Jf;function i(i){let o=t.get(i);if(void 0===o){if(r!==Jf)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Zf;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Kf(e,n).unknown(r)},cf.apply(i,arguments),i}function td(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function ed(t,e){var n=Pc(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}var nd,rd=180/Math.PI,id={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function od(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*rd,skewX:Math.atan(l)*rd,scaleX:a,scaleY:s}}function ad(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:Yc(t,i)},{i:l-2,x:Yc(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Yc(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Yc(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Yc(t,n)},{i:s-2,x:Yc(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var sd=ad((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?id:od(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ld=ad((function(t){return null==t?id:(nd||(nd=document.createElementNS("http://www.w3.org/2000/svg","g")),nd.setAttribute("transform",t),(t=nd.transform.baseVal.consolidate())?od((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):id)}),", ",")",")");function ud(t){return((t=Math.exp(t))+1/t)/2}const cd=function t(e,n,r){function i(t,i){var o,a,s=t[0],l=t[1],u=t[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-l,m=h*h+p*p;if(m<1e-12)a=Math.log(d/u)/e,o=function(t){return[s+t*h,l+t*p,u*Math.exp(e*t*a)]};else{var g=Math.sqrt(m),y=(d*d-u*u+r*m)/(2*u*n*g),v=(d*d-u*u-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-b)/e,o=function(t){var r=t*a,i=ud(b),o=u/(n*g)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+o*h,l+o*p,u*i/ud(e*r+b)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function fd(t){return function(e,n){var r=t((e=Mc(e)).h,(n=Mc(n)).h),i=Bc(e.s,n.s),o=Bc(e.l,n.l),a=Bc(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}const dd=fd(Pc);var hd=fd(Bc);const pd=Math.PI/180,md=180/Math.PI,gd=.96422,yd=1,vd=.82521,bd=4/29,xd=6/29,_d=3*xd*xd,wd=.008856451679035631;function kd(t){if(t instanceof Ed)return new Ed(t.l,t.a,t.b,t.opacity);if(t instanceof Td)return Nd(t);t instanceof vc||(t=gc(t));var e,n,r=Dd(t.r),i=Dd(t.g),o=Dd(t.b),a=Md((.2225045*r+.7168786*i+.0606169*o)/yd);return r===i&&i===o?e=n=a:(e=Md((.4360747*r+.3850649*i+.1430804*o)/gd),n=Md((.0139322*r+.0971045*i+.7141733*o)/vd)),new Ed(116*a-16,500*(e-a),200*(a-n),t.opacity)}function Ad(t,e,n,r){return 1===arguments.length?kd(t):new Ed(t,e,n,null==r?1:r)}function Ed(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Md(t){return t>wd?Math.pow(t,1/3):t/_d+bd}function Cd(t){return t>xd?t*t*t:_d*(t-bd)}function Sd(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Dd(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Fd(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Td)return new Td(t.h,t.c,t.l,t.opacity);if(t instanceof Ed||(t=kd(t)),0===t.a&&0===t.b)return new Td(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*md;return new Td(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new Td(t,e,n,null==r?1:r)}function Td(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Nd(t){if(isNaN(t.h))return new Ed(t.l,0,0,t.opacity);var e=t.h*pd;return new Ed(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Od(t,e){var n=Bc((t=Ad(t)).l,(e=Ad(e)).l),r=Bc(t.a,e.a),i=Bc(t.b,e.b),o=Bc(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function zd(t){return function(e,n){var r=t((e=Fd(e)).h,(n=Fd(n)).h),i=Bc(e.c,n.c),o=Bc(e.l,n.l),a=Bc(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}Gu(Ed,Ad,Xu(Qu,{brighter(t){return new Ed(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new Ed(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new vc(Sd(3.1338561*(e=gd*Cd(e))-1.6168667*(t=yd*Cd(t))-.4906146*(n=vd*Cd(n))),Sd(-.9787684*e+1.9161415*t+.033454*n),Sd(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Gu(Td,Fd,Xu(Qu,{brighter(t){return new Td(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Td(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Nd(this).rgb()}}));const Rd=zd(Pc);var Pd=zd(Bc),Bd=-.14861,Ld=1.78277,jd=-.29227,Ud=-.90649,qd=1.97294,Id=qd*Ud,Wd=qd*Ld,$d=Ld*jd-Ud*Bd;function Hd(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Zd)return new Zd(t.h,t.s,t.l,t.opacity);t instanceof vc||(t=gc(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=($d*r+Id*e-Wd*n)/($d+Id-Wd),o=r-i,a=(qd*(n-i)-jd*o)/Ud,s=Math.sqrt(a*a+o*o)/(qd*i*(1-i)),l=s?Math.atan2(a,o)*md-120:NaN;return new Zd(l<0?l+360:l,s,i,t.opacity)}(t):new Zd(t,e,n,null==r?1:r)}function Zd(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Yd(t){return function e(n){function r(e,r){var i=t((e=Hd(e)).h,(r=Hd(r)).h),o=Bc(e.s,r.s),a=Bc(e.l,r.l),s=Bc(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Gu(Zd,Hd,Xu(Qu,{brighter(t){return t=null==t?Ku:Math.pow(Ku,t),new Zd(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Ju:Math.pow(Ju,t),new Zd(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*pd,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new vc(255*(e+n*(Bd*r+Ld*i)),255*(e+n*(jd*r+Ud*i)),255*(e+n*(qd*r)),this.opacity)}}));const Vd=Yd(Pc);var Gd=Yd(Bc);function Xd(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function Qd(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const Jd="linear",Kd="log",th="pow",eh="sqrt",nh="symlog",rh="time",ih="utc",oh="sequential",ah="diverging",sh="quantile",lh="quantize",uh="threshold",ch="ordinal",fh="point",dh="band",hh="bin-ordinal",ph="continuous",mh="discrete",gh="discretizing",yh="interpolating",vh="temporal";function bh(){const t=Kf().unknown(void 0),e=t.domain,n=t.range;let r,i,o=[0,1],a=!1,s=0,l=0,u=.5;function c(){const t=e().length,c=o[1]<o[0],f=o[1-c],d=Qd(t,s,l);let h=o[c-0];r=(f-h)/(d||1),a&&(r=Math.floor(r)),h+=(f-h-r*(t-s))*u,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const p=is(t).map((t=>h+r*t));return n(c?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),c()):e()},t.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},t.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,c()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(a=!!t,c()):a},t.padding=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),s=l,c()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),c()):s},t.paddingOuter=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let l,u,c,f=+t[0],d=+t[1];return f!=f||d!=d||(d<f&&(c=f,f=d,d=c),d<a[0]||f>o[1-r])?void 0:(l=Math.max(0,Zu(a,f)-1),u=f===d?l:Zu(a,d)-1,f-a[l]>i+1e-10&&++l,r&&(c=l,l=s-u,u=s-c),l>u?void 0:e().slice(l,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return bh().domain(e()).range(o).round(a).paddingInner(s).paddingOuter(l).align(u)},c()}function xh(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return xh(e())},t}var _h=Array.prototype.map;const wh=Array.prototype.slice,kh=new Map,Ah=Symbol("vega_scale");function Eh(t){return t[Ah]=!0,t}function Mh(t,e,n){return arguments.length>1?(kh.set(t,function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,o,a,s=e[0],l=e[1],u=-1;for(l<s&&(i=s,s=l,l=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=l&&(u<0&&(u=o),r=o);if(!(u<0))return s=t.invertExtent(n[u]),l=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=t,Eh(n)};return r.metadata=Ie(de(n)),r}(t,e,n)),this):Ch(t)?kh.get(t):void 0}function Ch(t){return kh.has(t)}function Sh(t,e){const n=kh.get(t);return n&&n.metadata[e]}function Dh(t){return Sh(t,ph)}function Fh(t){return Sh(t,mh)}function Th(t){return Sh(t,gh)}function Nh(t){return Sh(t,Kd)}function Oh(t){return Sh(t,yh)}function zh(t){return Sh(t,sh)}Mh("identity",(function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,tf),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,tf):[0,1],hf(r)})),Mh(Jd,(function t(){var e=uf();return e.copy=function(){return sf(e,t())},cf.apply(e,arguments),hf(e)}),ph),Mh(Kd,(function t(){const e=_f(lf()).domain([1,10]);return e.copy=()=>sf(e,t()).base(e.base()),cf.apply(e,arguments),e}),[ph,Kd]),Mh(th,Mf,ph),Mh(eh,(function(){return Mf.apply(null,arguments).exponent(.5)}),ph),Mh(nh,(function t(){var e=Df(lf());return e.copy=function(){return sf(e,t()).constant(e.constant())},cf.apply(e,arguments)}),ph),Mh(rh,Lf,[ph,vh]),Mh(ih,(function(){return cf.apply(Bf(Tf,Nf,ar,lr,Jn,qn,cr,dr,hr,bi).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[ph,vh]),Mh(oh,qf,[ph,yh]),Mh("".concat(oh,"-").concat(Jd),qf,[ph,yh]),Mh("".concat(oh,"-").concat(Kd),(function t(){var e=_f(jf()).domain([1,10]);return e.copy=function(){return Uf(e,t()).base(e.base())},ff.apply(e,arguments)}),[ph,yh,Kd]),Mh("".concat(oh,"-").concat(th),If,[ph,yh]),Mh("".concat(oh,"-").concat(eh),(function(){return If.apply(null,arguments).exponent(.5)}),[ph,yh]),Mh("".concat(oh,"-").concat(nh),(function t(){var e=Df(jf());return e.copy=function(){return Uf(e,t()).constant(e.constant())},ff.apply(e,arguments)}),[ph,yh]),Mh("".concat(ah,"-").concat(Jd),(function t(){var e=hf($f()(nf));return e.copy=function(){return Uf(e,t())},ff.apply(e,arguments)}),[ph,yh]),Mh("".concat(ah,"-").concat(Kd),(function t(){var e=_f($f()).domain([.1,1,10]);return e.copy=function(){return Uf(e,t()).base(e.base())},ff.apply(e,arguments)}),[ph,yh,Kd]),Mh("".concat(ah,"-").concat(th),Hf,[ph,yh]),Mh("".concat(ah,"-").concat(eh),(function(){return Hf.apply(null,arguments).exponent(.5)}),[ph,yh]),Mh("".concat(ah,"-").concat(nh),(function t(){var e=Df($f());return e.copy=function(){return Uf(e,t()).constant(e.constant())},ff.apply(e,arguments)}),[ph,yh]),Mh(sh,(function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=$(n,t/e);return a}function a(t){return null==t||isNaN(t=+t)?e:r[Vu(i,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(R),o()},a.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return i.slice()},a.copy=function(){return t().domain(n).range(r).unknown(e)},cf.apply(a,arguments)}),[gh,sh]),Mh(lh,(function t(){var e,n=0,r=1,i=1,o=[.5],a=[0,1];function s(t){return null!=t&&t<=t?a[Vu(o,t,0,i)]:e}function l(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,l()):[n,r]},s.range=function(t){return arguments.length?(i=(a=Array.from(t)).length-1,l()):a.slice()},s.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(a).unknown(e)},cf.apply(hf(s),arguments)}),gh),Mh(uh,(function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return null!=t&&t<=t?r[Vu(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},cf.apply(o,arguments)}),gh),Mh(hh,(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Vu(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return _h.call(t,te)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=wh.call(t),r):n.slice()},r.tickFormat=function(t,n){return df(e[0],Kt(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[mh,gh]),Mh(ch,Kf,mh),Mh(dh,bh,mh),Mh(fh,(function(){return xh(bh().paddingInner(1))}),mh);const Rh=["clamp","base","constant","exponent"];function Ph(t,e,n){return Wf(Lh(e||"rgb",n),t)}function Bh(t,e,n){const r=n-e;let i,o,a;return r&&Number.isFinite(r)?(i=(o=t.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=Mh(o)().domain([e,n]).range([0,1]),Rh.forEach((e=>t[e]?a[e](t[e]()):0)),a):xe(.5)}function Lh(t,n){const r=e[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=n&&r&&r.gamma?r.gamma(n):r}function jh(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Uh(t,e){for(const n in t)Ih(n,e(t[n]))}const qh={};function Ih(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(qh[t]=e,this):qh[t]}Uh({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},jh),Uh({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>Ph(jh(t))));const Wh="symbol",$h="discrete",Hh=t=>Qt(t)?t.map((t=>String(t))):String(t),Zh=(t,e)=>t[1]-e[1],Yh=(t,e)=>e[1]-t[1];function Vh(t,e,n){let r;return Ne(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(Pe(t.domain())/n||1)))),Jt(e)&&(r=e.step,e=e.interval),Oe(e)&&(e=t.type===rh?Kr(e):t.type==ih?ti(e):Rt("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function Gh(t,e,n){let r=t.range(),i=r[0],o=Kt(r),a=Zh;if(i>o&&(r=o,o=i,i=r,a=Yh),i=Math.floor(i),o=Math.ceil(o),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=o)).sort(a).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],Kt(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function Xh(t,e){return t.bins?Gh(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Qh(t,e,n,r,i,o){const a=e.type;let s=Hh;if(a===rh||i===rh)s=t.timeFormat(r);else if(a===ih||i===ih)s=t.utcFormat(r);else if(Nh(a)){const i=t.formatFloat(r);if(o||e.bins)s=i;else{const t=Jh(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function Jh(t,e,n){const r=Xh(t,e),i=t.base(),o=Math.log(i),a=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=a};return n?r.filter(s):s}const Kh={[sh]:"quantiles",[lh]:"thresholds",[uh]:"domain"},tp={[sh]:"quantiles",[lh]:"domain"};function ep(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=Kt(t),e}(t.bins):t.type===Kd?Jh(t,e,!0):Kh[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Kh[t.type]]()):Xh(t,e)}const np=t=>Kh[t.type]||t.bins;function rp(t,e,n,r,i,o,a){const s=tp[e.type]&&o!==rh&&o!==ih?function(t,e,n){const r=e[tp[e.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return t.formatSpan(0,a,30,n)}(t,e,i):Qh(t,e,n,i,o,a);return r===Wh&&np(e)?ip(s):r===$h?ap(s):sp(s)}const ip=t=>(e,n,r)=>{const i=op(r[n+1],op(r.max,1/0)),o=lp(e,t),a=lp(i,t);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},op=(t,e)=>null!=t?t:e,ap=t=>(e,n)=>n?t(e):null,sp=t=>e=>t(e),lp=(t,e)=>Number.isFinite(t)?e(t):null;function up(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(t,e,n,r){const i=r||e.type;return Oe(n)&&function(t){return Sh(t,vh)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==rh?n||i!==ih?rp(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}(t,e,n.format,n.formatType);if(Th(e.type)){const t=ep(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Fh(e.type)){const t=e.domain(),n=t.length;return"".concat(n," value").concat(1===n?"":"s",": ").concat(n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", "))}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(Kt(t)))}}let cp=0;const fp="p_";function dp(t){return t&&t.gradient}function hp(t,e,n){const r=t.gradient;let i=t.id,o="radial"===r?fp:"";return i||(i=t.id="gradient_"+cp++,"radial"===r?(t.x1=pp(t.x1,.5),t.y1=pp(t.y1,.5),t.r1=pp(t.r1,0),t.x2=pp(t.x2,.5),t.y2=pp(t.y2,.5),t.r2=pp(t.r2,.5),o=fp):(t.x1=pp(t.x1,0),t.y1=pp(t.y1,0),t.x2=pp(t.x2,1),t.y2=pp(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+o+i+")"}function pp(t,e){return null!=t?t:e}const mp={basis:{curve:function(t){return new Nl(t)}},"basis-closed":{curve:function(t){return new zl(t)}},"basis-open":{curve:function(t){return new Rl(t)}},bundle:{curve:Bl,tension:"beta",value:.85},cardinal:{curve:Ul,tension:"tension",value:0},"cardinal-open":{curve:Il,tension:"tension",value:0},"cardinal-closed":{curve:$l,tension:"tension",value:0},"catmull-rom":{curve:ou,tension:"alpha",value:.5},"catmull-rom-closed":{curve:su,tension:"alpha",value:.5},"catmull-rom-open":{curve:uu,tension:"alpha",value:.5},linear:{curve:fu},"linear-closed":{curve:function(t){return new du(t)}},monotone:{horizontal:function(t){return new vu(t)},vertical:function(t){return new yu(t)}},natural:{curve:function(t){return new xu(t)}},step:{curve:function(t){return new wu(t,.5)}},"step-after":{curve:function(t){return new wu(t,1)}},"step-before":{curve:function(t){return new wu(t,0)}}};function gp(t,e,n){var r=Ee(mp,t)&&mp[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const yp={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},vp=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,bp=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,xp=/^((\s+,?\s*)|(,\s*))/,_p=/^[01]/;function wp(t){const e=[];return(t.match(vp)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=yp[r],o=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let o=0;o<e;++o){const e="a"!==t||3!==o&&4!==o?bp:_p,a=n.slice(i).match(e);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(xp);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),a=o.length;if(a<i||a&&a%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<a;t+=i)e.push([n,...o.slice(t,t+i)])}})),e}const kp=Math.PI/180,Ap=Math.PI/2,Ep=2*Math.PI,Mp=Math.sqrt(3)/2;var Cp={},Sp={},Dp=[].join;function Fp(t){const e=Dp.call(t);if(Sp[e])return Sp[e];var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7];const c=u*a,f=-l*s,d=l*a,h=u*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),_=n+p-x*m,w=r+m+x*p,k=n+g,A=r+y,E=k+x*y,M=A-x*g;return Sp[e]=[c*_+f*w,d*_+h*w,c*E+f*M,d*E+h*M,c*k+f*A,d*k+h*A]}const Tp=["l",0,0,0,0,0,0,0];function Np(t,e,n){const r=Tp[0]=t[0];if("a"===r||"A"===r)Tp[1]=e*t[1],Tp[2]=n*t[2],Tp[3]=t[3],Tp[4]=t[4],Tp[5]=t[5],Tp[6]=e*t[6],Tp[7]=n*t[7];else if("h"===r||"H"===r)Tp[1]=e*t[1];else if("v"===r||"V"===r)Tp[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)Tp[i]=(i%2==1?e:n)*t[i];return Tp}function Op(t,e,n,r,i,o){var a,s,l,u,c,f=null,d=0,h=0,p=0,m=0,g=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var v=0,b=e.length;v<b;++v){switch(a=e[v],1===i&&1===o||(a=Np(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],t.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],t.lineTo(d+n,h+r);break;case"h":d+=a[1],t.lineTo(d+n,h+r);break;case"H":d=a[1],t.lineTo(d+n,h+r);break;case"v":h+=a[1],t.lineTo(d+n,h+r);break;case"V":h=a[1],t.lineTo(d+n,h+r);break;case"m":g=d+=a[1],y=h+=a[2],t.moveTo(d+n,h+r);break;case"M":g=d=a[1],y=h=a[2],t.moveTo(d+n,h+r);break;case"c":s=d+a[5],l=h+a[6],p=d+a[3],m=h+a[4],t.bezierCurveTo(d+a[1]+n,h+a[2]+r,p+n,m+r,s+n,l+r),d=s,h=l;break;case"C":d=a[5],h=a[6],p=a[3],m=a[4],t.bezierCurveTo(a[1]+n,a[2]+r,p+n,m+r,d+n,h+r);break;case"s":s=d+a[3],l=h+a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,d+a[1]+n,h+a[2]+r,s+n,l+r),p=d+a[1],m=h+a[2],d=s,h=l;break;case"S":s=a[3],l=a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"q":s=d+a[3],l=h+a[4],p=d+a[1],m=h+a[2],t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"Q":s=a[3],l=a[4],t.quadraticCurveTo(a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"t":s=d+a[1],l=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,m=h):"t"===f[0]?(p=2*d-u,m=2*h-c):"q"===f[0]&&(p=2*d-p,m=2*h-m),u=p,c=m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),h=l,p=(d=s)+a[1],m=h+a[2];break;case"T":s=a[1],l=a[2],p=2*d-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"a":zp(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":zp(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=g,h=y,t.closePath()}f=a}}function zp(t,e,n,r){const i=function(t,e,n,r,i,o,a,s,l){const u=Dp.call(arguments);if(Cp[u])return Cp[u];const c=a*kp,f=Math.sin(c),d=Math.cos(c),h=d*(s-t)*.5+f*(l-e)*.5,p=d*(l-e)*.5-f*(s-t)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=d/n,y=f/n,v=-f/r,b=d/r,x=g*s+y*l,_=v*s+b*l,w=g*t+y*e,k=v*t+b*e;let A=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;A<0&&(A=0);let E=Math.sqrt(A);o==i&&(E=-E);const M=.5*(x+w)-E*(k-_),C=.5*(_+k)+E*(w-x),S=Math.atan2(_-C,x-M);let D=Math.atan2(k-C,w-M)-S;D<0&&1===o?D+=Ep:D>0&&0===o&&(D-=Ep);const F=Math.ceil(Math.abs(D/(Ap+.001))),T=[];for(let N=0;N<F;++N){const t=S+N*D/F,e=S+(N+1)*D/F;T[N]=[M,C,t,e,n,r,f,d]}return Cp[u]=T}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let o=0;o<i.length;++o){const e=Fp(i[o]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const Rp=.5773502691896257,Pp={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,Ep)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n,i=r-n*Rp,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n,i=r-n*Rp;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};var Bp={};const Lp=.448084975506;function jp(t){return t.x}function Up(t){return t.y}function qp(t){return t.width}function Ip(t){return t.height}function Wp(t){return"function"==typeof t?t:()=>+t}function $p(t,e,n){return Math.max(e,Math.min(t,n))}function Hp(t,e){return null!=t?t:e}const Zp=t=>t.x||0,Yp=t=>t.y||0,Vp=t=>!(!1===t.defined),Gp=function(){var t=Nu,e=Ou,n=ku(0),r=null,i=zu,o=Ru,a=Pu,s=null,l=Tu(u);function u(){var u,c,f=+t.apply(this,arguments),d=+e.apply(this,arguments),h=i.apply(this,arguments)-tu,p=o.apply(this,arguments)-tu,m=Hl(p-h),g=p>h;if(s||(s=u=l()),d<f&&(c=d,d=f,f=c),d>Jl)if(m>eu-Jl)s.moveTo(d*Yl(h),d*Xl(h)),s.arc(0,0,d,h,p,!g),f>Jl&&(s.moveTo(f*Yl(p),f*Xl(p)),s.arc(0,0,f,p,h,g));else{var y,v,b=h,x=p,_=h,w=p,k=m,A=m,E=a.apply(this,arguments)/2,M=E>Jl&&(r?+r.apply(this,arguments):Ql(f*f+d*d)),C=Gl(Hl(d-f)/2,+n.apply(this,arguments)),S=C,D=C;if(M>Jl){var F=nu(M/f*Xl(E)),T=nu(M/d*Xl(E));(k-=2*F)>Jl?(_+=F*=g?1:-1,w-=F):(k=0,_=w=(h+p)/2),(A-=2*T)>Jl?(b+=T*=g?1:-1,x-=T):(A=0,b=x=(h+p)/2)}var N=d*Yl(b),O=d*Xl(b),z=f*Yl(w),R=f*Xl(w);if(C>Jl){var P,B=d*Yl(x),L=d*Xl(x),j=f*Yl(_),U=f*Xl(_);if(m<Kl)if(P=function(t,e,n,r,i,o,a,s){var l=n-t,u=r-e,c=a-i,f=s-o,d=f*l-c*u;if(!(d*d<Jl))return[t+(d=(c*(e-o)-f*(t-i))/d)*l,e+d*u]}(N,O,j,U,B,L,z,R)){var q=N-P[0],I=O-P[1],W=B-P[0],$=L-P[1],H=1/Xl(function(t){return t>1?0:t<-1?Kl:Math.acos(t)}((q*W+I*$)/(Ql(q*q+I*I)*Ql(W*W+$*$)))/2),Z=Ql(P[0]*P[0]+P[1]*P[1]);S=Gl(C,(f-Z)/(H-1)),D=Gl(C,(d-Z)/(H+1))}else S=D=0}A>Jl?D>Jl?(y=Bu(j,U,N,O,d,D,g),v=Bu(B,L,z,R,d,D,g),s.moveTo(y.cx+y.x01,y.cy+y.y01),D<C?s.arc(y.cx,y.cy,D,Zl(y.y01,y.x01),Zl(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,D,Zl(y.y01,y.x01),Zl(y.y11,y.x11),!g),s.arc(0,0,d,Zl(y.cy+y.y11,y.cx+y.x11),Zl(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,D,Zl(v.y11,v.x11),Zl(v.y01,v.x01),!g))):(s.moveTo(N,O),s.arc(0,0,d,b,x,!g)):s.moveTo(N,O),f>Jl&&k>Jl?S>Jl?(y=Bu(z,R,B,L,f,-S,g),v=Bu(N,O,j,U,f,-S,g),s.lineTo(y.cx+y.x01,y.cy+y.y01),S<C?s.arc(y.cx,y.cy,S,Zl(y.y01,y.x01),Zl(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,S,Zl(y.y01,y.x01),Zl(y.y11,y.x11),!g),s.arc(0,0,f,Zl(y.cy+y.y11,y.cx+y.x11),Zl(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,S,Zl(v.y11,v.x11),Zl(v.y01,v.x01),!g))):s.arc(0,0,f,w,_,g):s.lineTo(z,R)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Kl/2;return[Yl(r)*n,Xl(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ku(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ku(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:ku(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:ku(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:ku(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),Xp=Iu().x(Zp).y1(Yp).y0((t=>(t.y||0)+(t.height||0))).defined(Vp),Qp=Iu().y(Yp).x1(Zp).x0((t=>(t.x||0)+(t.width||0))).defined(Vp),Jp=qu().x(Zp).y(Yp).defined(Vp),Kp=function(){var t=jp,e=Up,n=qp,r=Ip,i=Wp(0),o=i,a=i,s=i,l=null;function u(u,c,f){var d,h=null!=c?c:+t.call(this,u),p=null!=f?f:+e.call(this,u),m=+n.call(this,u),g=+r.call(this,u),y=Math.min(m,g)/2,v=$p(+i.call(this,u),0,y),b=$p(+o.call(this,u),0,y),x=$p(+a.call(this,u),0,y),_=$p(+s.call(this,u),0,y);if(l||(l=d=Fu()),v<=0&&b<=0&&x<=0&&_<=0)l.rect(h,p,m,g);else{var w=h+m,k=p+g;l.moveTo(h+v,p),l.lineTo(w-b,p),l.bezierCurveTo(w-Lp*b,p,w,p+Lp*b,w,p+b),l.lineTo(w,k-_),l.bezierCurveTo(w,k-Lp*_,w-Lp*_,k,w-_,k),l.lineTo(h+x,k),l.bezierCurveTo(h+Lp*x,k,h,k-Lp*x,h,k-x),l.lineTo(h,p+v),l.bezierCurveTo(h,p+Lp*v,h+Lp*v,p,h+v,p),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(e){return arguments.length?(t=Wp(e),u):t},u.y=function(t){return arguments.length?(e=Wp(t),u):e},u.width=function(t){return arguments.length?(n=Wp(t),u):n},u.height=function(t){return arguments.length?(r=Wp(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=Wp(t),o=null!=e?Wp(e):i,s=null!=n?Wp(n):i,a=null!=r?Wp(r):o,u):i},u.context=function(t){return arguments.length?(l=null==t?null:t,u):l},u}().x(Zp).y(Yp).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Hp(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Hp(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Hp(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Hp(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),tm=function(t,e){let n=null,r=Tu(i);function i(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"==typeof t?t:ku(t||Wu),e="function"==typeof e?e:ku(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"==typeof e?e:ku(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}().type((t=>{return e=t.shape||"circle",Ee(Pp,e)?Pp[e]:function(t){if(!Ee(Bp,t)){const e=wp(t);Bp[t]={draw:function(t,n){Op(t,e,0,0,Math.sqrt(n)/2)}}}return Bp[t]}(e);var e})).size((t=>Hp(t.size,64))),em=function(){var t,e,n,r,i,o,a,s,l=null;function u(t,e,n){const r=n/2;if(i){var u=a-e,c=t-o;if(u||c){var f=Math.sqrt(u*u+c*c),d=(u/=f)*s,h=(c/=f)*s,p=Math.atan2(c,u);l.moveTo(o-d,a-h),l.lineTo(t-u*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+d,a+h),l.arc(o,a,s,p,p+Math.PI)}else l.arc(t,e,r,0,Ep);l.closePath()}else i=1;o=t,a=e,s=r}function c(o){var a,s,c,f=o.length,d=!1;for(null==l&&(l=c=Fu()),a=0;a<=f;++a)!(a<f&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&u(+t(s,a,o),+e(s,a,o),+n(s,a,o));if(c)return l=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(r=t,c):r},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}().x(Zp).y(Yp).defined(Vp).size((t=>t.size||1));function nm(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function rm(t,e,n,r){return Kp.context(t)(e,n,r)}var im=1;function om(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+im++),a=i.clipping[o]||(i.clipping[o]={id:o});return he(r)?a.path=r(null):nm(n)?a.path=rm(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function am(t){this.clear(),t&&this.union(t)}function sm(t){this.mark=t,this.bounds=this.bounds||new am}function lm(t){sm.call(this,t),this.items=this.items||[]}function um(t){this._pending=0,this._loader=t||va()}function cm(t){t._pending+=1}function fm(t){t._pending-=1}function dm(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}am.prototype={clone(){return new am(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(t),l=Math.sin(t),u=e-e*s+n*l,c=n-e*l-n*s;return[s*r-l*i+u,l*r+s*i+c,s*r-l*a+u,l*r+s*a+c,s*o-l*i+u,l*o+s*i+c,s*o-l*a+u,l*o+s*a+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Se(lm,sm),um.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return cm(e),e._loader.sanitize(t,{context:"href"}).then((t=>(fm(e),t))).catch((()=>(fm(e),null)))},loadImage(t){const e=this,n="undefined"!=typeof Image?Image:null;return cm(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=Ee(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>fm(e),i.onerror=()=>fm(e),i.src=r,i})).catch((t=>(fm(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const hm=Ep-1e-8;let pm,mm,gm,ym,vm,bm,xm,_m;const wm=(t,e)=>pm.add(t,e),km=(t,e)=>wm(mm=t,gm=e),Am=t=>wm(t,pm.y1),Em=t=>wm(pm.x1,t),Mm=(t,e)=>vm*t+xm*e,Cm=(t,e)=>bm*t+_m*e,Sm=(t,e)=>wm(Mm(t,e),Cm(t,e)),Dm=(t,e)=>km(Mm(t,e),Cm(t,e));function Fm(t,e){return pm=t,e?(ym=e*kp,vm=_m=Math.cos(ym),bm=Math.sin(ym),xm=-bm):(vm=_m=1,ym=bm=xm=0),Tm}const Tm={beginPath(){},closePath(){},moveTo:Dm,lineTo:Dm,rect(t,e,n,r){ym?(Sm(t+n,e),Sm(t+n,e+r),Sm(t,e+r),Dm(t,e)):(wm(t+n,e+r),km(t,e))},quadraticCurveTo(t,e,n,r){const i=Mm(t,e),o=Cm(t,e),a=Mm(n,r),s=Cm(n,r);Nm(mm,i,a,Am),Nm(gm,o,s,Em),km(a,s)},bezierCurveTo(t,e,n,r,i,o){const a=Mm(t,e),s=Cm(t,e),l=Mm(n,r),u=Cm(n,r),c=Mm(i,o),f=Cm(i,o);Om(mm,a,l,c,Am),Om(gm,s,u,f,Em),km(c,f)},arc(t,e,n,r,i,o){if(r+=ym,i+=ym,mm=n*Math.cos(i)+t,gm=n*Math.sin(i)+e,Math.abs(i-r)>hm)wm(t-n,e-n),wm(t+n,e+n);else{const a=r=>wm(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,l;if(a(r),a(i),i!==r)if((r%=Ep)<0&&(r+=Ep),(i%=Ep)<0&&(i+=Ep),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=Ep,s=r-r%Ap,l=0;l<4&&s>i;++l,s-=Ap)a(s);else for(s=r-r%Ap+Ap,l=0;l<4&&s<i;++l,s+=Ap)a(s)}}};function Nm(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function Om(t,e,n,r,i){const o=r-t+3*e-3*n,a=t+n-2*e,s=t-e;let l,u=0,c=0;Math.abs(o)>1e-14?(l=a*a+s*o,l>=0&&(l=Math.sqrt(l),u=(-a+l)/o,c=(-a-l)/o)):u=.5*s/a,0<u&&u<1&&i(zm(u,t,e,n,r)),0<c&&c<1&&i(zm(c,t,e,n,r))}function zm(t,e,n,r,i){const o=1-t,a=o*o,s=t*t;return a*o*e+3*a*t*n+3*o*s*r+s*t*i}var Rm=(Rm=$u(1,1))?Rm.getContext("2d"):null;const Pm=new am;function Bm(t){return function(e,n){if(!Rm)return!0;t(Rm,e),Pm.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=Pm;for(let t=i;t<=a;++t)for(let e=r;e<=o;++e)if(Rm.isPointInPath(e,t))return!0;return!1}}function Lm(t,e){return e.contains(t.x||0,t.y||0)}function jm(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,o=t.height||0;return e.intersects(Pm.set(n,r,n+i,r+o))}function Um(t,e,n,r,i){const{x1:o,y1:a,x2:s,y2:l}=t,u=r-e,c=i-n;let f,d,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(f=-u,d=-(o-e)),1===p&&(f=u,d=s-e),2===p&&(f=-c,d=-(a-n)),3===p&&(f=c,d=l-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>g)return!1;h>m&&(m=h)}else if(f>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function qm(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Im(t,e){return null==t?e:t}function Wm(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function $m(t,e,n){return dp(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+Im(e.x1,.5)*r,n.y1+Im(e.y1,.5)*i,Math.max(r,i)*Im(e.r1,0),n.x1+Im(e.x2,.5)*r,n.y1+Im(e.y2,.5)*i,Math.max(r,i)*Im(e.r2,.5));else{const a=Im(e.x1,0),s=Im(e.y1,0),l=Im(e.x2,1),u=Im(e.y2,0);if(a!==l&&s!==u&&r!==i){const n=$u(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=Wm(o.createLinearGradient(a,s,l,u),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+l*r,n.y1+u*i)}return Wm(o,e.stops)}(t,n,e.bounds):n}function Hm(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=$m(t,e,e.fill),!0)}var Zm=[];function Ym(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=$m(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Zm),t.lineDashOffset=e.strokeDashOffset||0),!0)}function Vm(t,e){return t.zindex-e.zindex||t.index-e.index}function Gm(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(Vm)}function Xm(t,e){var n,r,i=t.items;if(!i||!i.length)return;const o=Gm(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}function Qm(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const o=Gm(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Jm(t){return function(e,n,r){Xm(n,(n=>{r&&!r.intersects(n.bounds)||tg(t,e,n,n)}))}}function Km(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||tg(t,e,n.items[0],n.items)}}function tg(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(qm(e,n),n.fill&&Hm(e,n,i)&&e.fill(),n.stroke&&Ym(e,n,i)&&e.stroke()))}function eg(t){return t=t||It,function(e,n,r,i,o,a){return r*=e.pixelRatio,i*=e.pixelRatio,Qm(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return t(e,n,r,i,o,a)?n:void 0}))}}function ng(t,e){return function(n,r,i,o){var a,s,l=Array.isArray(r)?r[0]:r,u=null==e?l.fill:e,c=l.stroke&&n.isPointInStroke;return c&&(a=l.strokeWidth,s=l.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function rg(t){return eg(ng(t))}function ig(t,e){return"translate("+t+","+e+")"}function og(t){return"rotate("+t+")"}function ag(t){return ig(t.x||0,t.y||0)}function sg(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=kp),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return ig(t.x||0,t.y||0)+(t.angle?" "+og(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(Fm(t,n.angle),n),dm(t,n).translate(n.x||0,n.y||0)},draw:Jm(r),pick:rg(r),isect:n||Bm(r)}}var lg=sg("arc",(function(t,e){return Gp.context(t)(e)}));function ug(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=ng(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(Fm(t),r),dm(t,r[0]))},draw:Km(r),pick:function(t,e,n,r,o,a){var s=e.items,l=e.bounds;return!s||!s.length||l&&!l.contains(o,a)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Lm,tip:n}}var cg=ug("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Qp:Xp).curve(gp(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",a=t.length,s=1/0;--a>=0;)!1!==t[a].defined&&(r=Math.abs(t[a][o]-i))<s&&(s=r,n=t[a]);return n}));function fg(t,e){t.beginPath(),nm(e)?rm(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function dg(t){const e=Im(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function hg(t,e){const n=dg(e);t("d",rm(null,e,n,n))}function pg(t,e,n,r){const i=dg(e);t.beginPath(),rm(t,e,(n||0)+i,(r||0)+i)}const mg=ng(pg),gg=ng(pg,!1),yg=ng(pg,!0);var vg={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",ag(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),dm(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){Xm(e,(e=>{const r=e.x||0,i=e.y||0,o=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(pg(t,e,r,i),qm(t,e),e.fill&&Hm(t,e,a)&&t.fill(),e.stroke&&!o&&Ym(t,e,a)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&fg(t,e),n&&n.translate(-r,-i),Xm(e,(e=>{this.draw(t,e,n)})),n&&n.translate(r,i),t.restore(),o&&e.stroke&&a&&(pg(t,e,r,i),qm(t,e),Ym(t,e,a)&&t.stroke())}))},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const a=n*t.pixelRatio,s=r*t.pixelRatio;return Qm(e,(l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),m=l.clip;if(m&&(i<c||i>h||o<f||o>p))return;if(t.save(),t.translate(c,f),c=i-c,f=o-f,m&&nm(l)&&!yg(t,l,a,s))return t.restore(),null;const g=l.strokeForeground,y=!1!==e.interactive;return y&&g&&l.stroke&&gg(t,l,a,s)?(t.restore(),l):(u=Qm(l,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,c,f)?this.pick(t,n,r,c,f):null)),!u&&y&&(l.fill||!g&&l.stroke)&&mg(t,l,a,s)&&(u=l),t.restore(),u||null)}))},isect:jm,content:function(t,e,n){t("clip-path",e.clip?om(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),hg(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?hg(t,e):t("d","")}},bg={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function xg(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function _g(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function wg(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function kg(t,e){return"center"===t?e/2:"right"===t?e:0}function Ag(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var Eg={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=xg(e,n),i=_g(e,r),o=wg(e,r),a=(e.x||0)-kg(e.align,i),s=(e.y||0)-Ag(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",bg["xmlns:xlink"],"xlink:href"),t("transform",ig(a,s)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=_g(e,n),i=wg(e,n),o=(e.x||0)-kg(e.align,r),a=(e.y||0)-Ag(e.baseline,i);return t.set(o,a,o+r,a+i)},draw:function(t,e,n){Xm(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=xg(e,this);let i=_g(e,r),o=wg(e,r);if(0===i||0===o)return;let a,s,l,u,c=(e.x||0)-kg(e.align,i),f=(e.y||0)-Ag(e.baseline,o);!1!==e.aspect&&(s=r.width/r.height,l=e.width/e.height,s==s&&l==l&&s!==l&&(l<s?(u=i/s,f+=(o-u)/2,o=u):(u=o*s,c+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(qm(t,e),t.globalAlpha=null!=(a=e.opacity)?a:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,c,f,i,o))}))},pick:eg(),isect:It,get:xg,xOffset:kg,yOffset:Ag},Mg=ug("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Jp.curve(gp(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function Cg(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,a=e.scaleY||1,s=(e.angle||0)*kp,l=e.pathCache;l&&l.path===n||((e.pathCache=l=wp(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),Op(t,l,0,0,o,a),t.rotate(-s),t.translate(-r,-i)):Op(t,l,r,i,o,a)}var Sg={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return ig(t.x||0,t.y||0)+(t.angle?" "+og(t.angle):"")+(t.scaleX||t.scaleY?" scale("+(t.scaleX||1)+","+(t.scaleY||1)+")":"")}(e)),t("d",e.path)},bound:function(t,e){return Cg(Fm(t,e.angle),e)?t.set(0,0,0,0):dm(t,e,!0)},draw:Jm(Cg),pick:rg(Cg),isect:Bm(Cg)};function Dg(t,e){t.beginPath(),rm(t,e)}var Fg={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",rm(null,e))},bound:function(t,e){var n,r;return dm(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Jm(Dg),pick:rg(Dg),isect:jm};function Tg(t,e,n){var r,i,o,a;return!(!e.stroke||!Ym(t,e,n)||(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,a=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),0))}var Ng={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",ag(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return dm(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Xm(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&Tg(t,e,r)&&(qm(t,e),t.stroke())}}))},pick:eg((function(t,e,n,r){return!!t.isPointInStroke&&Tg(t,e,1)&&t.isPointInStroke(n,r)})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Um(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},Og=sg("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),zg=sg("symbol",(function(t,e){return tm.context(t)(e)}),Lm);const Rg=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>Ee(e,t)||Ee(n,t),get:t=>Ee(e,t)?e[t]:Ee(n,t)?o(t,n[t]):void 0,set:(t,n)=>Ee(e,t)?e[t]=n:o(t,n)}}();var Pg={height:Ig,measureWidth:Ug,estimateWidth:Lg,width:Lg,canvas:Bg};function Bg(t){Pg.width=t&&Rm?Ug:Lg}function Lg(t,e){return jg(Zg(t,e),Ig(t))}function jg(t,e){return~~(.8*t.length*e)}function Ug(t,e){return Ig(t)<=0||!(e=Zg(t,e))?0:qg(e,Vg(t))}function qg(t,e){const n="(".concat(e,") ").concat(t);let r=Rg.get(n);return void 0===r&&(Rm.font=e,r=Rm.measureText(t).width,Rg.set(n,r)),r}function Ig(t){return null!=t.fontSize?+t.fontSize||0:11}function Wg(t){return null!=t.lineHeight?t.lineHeight:Ig(t)+2}function $g(t){return e=t.lineBreak&&t.text&&!Qt(t.text)?t.text.split(t.lineBreak):t.text,Qt(e)?e.length>1?e:e[0]:e;var e}function Hg(t){const e=$g(t);return(Qt(e)?e.length-1:0)*Wg(t)}function Zg(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(Pg.width===Ug){const e=Vg(t);return t=>qg(t,e)}{const e=Ig(t);return t=>jg(t,e)}}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"\u2026",a="rtl"===t.dir,s=0,l=e.length;if(n-=r(o),a){for(;s<l;)i=s+l>>>1,r(e.slice(i))>n?s=i+1:l=i;return o+e.slice(s)}for(;s<l;)i=1+(s+l>>>1),r(e.slice(0,i))<n?s=i:l=i-1;return e.slice(0,s)+o}(t,n):n}function Yg(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Vg(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Ig(t)+"px "+Yg(t,e)}function Gg(t){var e=t.baseline,n=Ig(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Wg(t):"line-bottom"===e?.29*n-.5*Wg(t):0)}Bg(!0);const Xg={left:"start",center:"middle",right:"end"},Qg=new am;function Jg(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-Ap,n+=i*Math.cos(e),r+=i*Math.sin(e)),Qg.x1=n,Qg.y1=r,Qg}function Kg(t,e,n){var r,i=Pg.height(e),o=e.align,a=Jg(e),s=a.x1,l=a.y1,u=e.dx||0,c=(e.dy||0)+Gg(e)-Math.round(.8*i),f=$g(e);if(Qt(f)?(i+=Wg(e)*(f.length-1),r=f.reduce(((t,n)=>Math.max(t,Pg.width(e,n))),0)):r=Pg.width(e,f),"center"===o?u-=r/2:"right"===o&&(u-=r),t.set(u+=s,c+=l,u+r,c+i),e.angle&&!n)t.rotate(e.angle*kp,s,l);else if(2===n)return t.rotatedPoints(e.angle*kp,s,l);return t}var ty={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Gg(e),o=Jg(e),a=o.x1,s=o.y1,l=e.angle||0;t("text-anchor",Xg[e.align]||"start"),l?(n=ig(a,s)+" "+og(l),(r||i)&&(n+=" "+ig(r,i))):n=ig(a+r,s+i),t("transform",n)},bound:Kg,draw:function(t,e,n){Xm(e,(e=>{var r,i,o,a,s,l,u,c=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===c||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Vg(e),t.textAlign=e.align||"left",i=(r=Jg(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*kp),i=o=0),i+=e.dx||0,o+=(e.dy||0)+Gg(e),l=$g(e),qm(t,e),Qt(l))for(s=Wg(e),a=0;a<l.length;++a)u=Zg(e,l[a]),e.fill&&Hm(t,e,c)&&t.fillText(u,i,o),e.stroke&&Ym(t,e,c)&&t.strokeText(u,i,o),o+=s;else u=Zg(e,l),e.fill&&Hm(t,e,c)&&t.fillText(u,i,o),e.stroke&&Ym(t,e,c)&&t.strokeText(u,i,o);e.angle&&t.restore()}}))},pick:eg((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var a=Jg(e),s=a.x1,l=a.y1,u=Kg(Qg,e,1),c=-e.angle*kp,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*l),p=d*i+f*o+(l-d*s-f*l);return u.contains(h,p)})),isect:function(t,e){const n=Kg(Qg,t,2);return Um(e,n[0],n[1],n[2],n[3])||Um(e,n[0],n[1],n[4],n[5])||Um(e,n[4],n[5],n[6],n[7])||Um(e,n[2],n[3],n[6],n[7])}},ey=ug("trail",(function(t,e){return em.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),ny={arc:lg,area:cg,group:vg,image:Eg,line:Mg,path:Sg,rect:Fg,rule:Ng,shape:Og,symbol:zg,text:ty,trail:ey};function ry(t,e,n){var r=ny[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new am),t,n)}var iy={mark:null};const oy=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function ay(t){return sy("string"==typeof t?JSON.parse(t):t)}function sy(t){var e,n,r,i=t.marktype,o=t.items;if(o)for(n=0,r=o.length;n<r;++n)e=i?"mark":"group",o[n][e]=t,o[n].zindex&&(o[n][e].zdirty=!0),"group"===(i||e)&&sy(o[n]);return i&&function(t,e,n){var r,i,o,a,s=ny[t.marktype],l=s.bound,u=t.items,c=u&&u.length;if(s.nested)return c?o=u[0]:(iy.mark=t,o=iy),a=ry(o,l,n),e&&e.union(a)||a;if(e=e||t.bounds&&t.bounds.clear()||new am,c)for(r=0,i=u.length;r<i;++r)e.union(ry(u[r],l,n));t.bounds=e}(t),t}function ly(t){arguments.length?this.root=ay(t):(this.root=uy({marktype:"group",name:"root",role:"frame"}),this.root.items=[new lm(this.root)])}function uy(t,e){const n={bounds:new am,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function cy(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function fy(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function dy(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=cy(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function hy(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function py(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function my(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function gy(t,e){this._active=null,this._handlers={},this._loader=t||va(),this._tooltip=e||yy}function yy(t,e,n,r){t.element().setAttribute("title",r||"")}function vy(t){this._el=null,this._bgcolor=null,this._loader=new um(t)}ly.prototype={toJSON(t){return function(t,e){return JSON.stringify(t,oy,e)}(this.root,t||0)},mark(t,e,n){const r=uy(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},gy.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=cy(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,o,a=t&&t.mark;if(a&&(i=ny[a.marktype]).tip){for((o=my(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(a.items,o)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,l+=t.y||0;return{x:s,y:l,width:o,height:a,left:s,top:l,right:s+o,bottom:l+a}}},vy.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const by="dragenter",xy="dragleave",_y="dragover",wy="mousedown",ky="mousemove",Ay="mouseout",Ey="mouseover",My="click",Cy="mousewheel",Sy="touchstart",Dy="touchmove",Fy="touchend",Ty=ky,Ny=Ay,Oy=My;function zy(t,e){gy.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function Ry(t,e){(t=>t===Sy||t===Dy||t===Fy?[Sy,Dy,Fy]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function Py(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r)),this.fire(t,r)}}function By(t){return function(e){this.fire(t,e),this._active=null}}Se(zy,gy,{initialize(t,e,n){return this._canvas=t&&fy(t,"canvas"),[My,wy,ky,Ay,xy].forEach((t=>Ry(this,t))),gy.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",by,xy,_y,wy,"mouseup",ky,Ay,Ey,My,"dblclick","wheel",Cy,Sy,Dy,Fy],DOMMouseScroll(t){this.fire(Cy,t)},mousemove:Py(ky,Ey,Ay),dragover:Py(_y,by,xy),mouseout:By(Ay),dragleave:By(xy),mousedown(t){this._down=this._active,this.fire(wy,t)},click(t){this._down===this._active&&(this.fire(My,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Sy,t,!0)},touchmove(t){this.fire(Dy,t,!0)},touchend(t){this.fire(Fy,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===Oy&&r&&r.href?this.handleHref(e,r,r.href):t!==Ty&&t!==Ny||this.handleTooltip(e,r,t!==Ny),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(Ry(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=my(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const o=this.context();return ny[t.marktype].pick.call(this,o,t,e,n,r,i)}});var Ly="undefined"!=typeof window&&window.devicePixelRatio||1;function jy(t){vy.call(this,t),this._options={},this._redraw=!1,this._dirty=new am,this._tempb=new am}const Uy=vy.prototype;function qy(t,e){gy.call(this,t,e);const n=this;n._hrefHandler=Iy(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=Iy(n,((t,e)=>{n.handleTooltip(t,e,t.type!==Ny)}))}Se(jy,vy,{initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:$u(1,1,this._options.type),t&&this._canvas&&(hy(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Uy.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(Uy.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,o){const a="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),l=a?Ly:i;t.width=e*l,t.height=n*l;for(const u in o)s[u]=o[u];a&&1!==l&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||Rt("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((t,e,n)=>(new am).set(0,0,e,n).translate(-t[0],-t[1]))(n,r,i);e.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,s),e.restore(),o.clear(),this},draw(t,e,n){const r=ny[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),he(n)?(t.beginPath(),n(t),t.clip()):fg(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}});const Iy=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};Se(qy,gy,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(Oy,this._hrefHandler),r.removeEventListener(Ty,this._tooltipHandler),r.removeEventListener(Ny,this._tooltipHandler)),this._svg=r=t&&fy(t,"svg"),r&&(r.addEventListener(Oy,this._hrefHandler),r.addEventListener(Ty,this._tooltipHandler),r.addEventListener(Ny,this._tooltipHandler)),gy.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:Iy(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Wy="aria-hidden",$y="aria-label",Hy="role",Zy="aria-roledescription",Yy="graphics-object",Vy="graphics-symbol",Gy=(t,e,n)=>({[Hy]:t,[Zy]:e,[$y]:n||void 0}),Xy=Ie(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Qy={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?nv(t):null,i=t.context,o=i.scales[e.scale].value,a=i.dataflow.locale(),s=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(r?" titled '".concat(r,"'"):"")+" for a ".concat(Fh(s)?"discrete":s," scale")+" with ".concat(up(a,o,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?nv(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,o=Object.keys(i),a=t.context,s=a.scales[i[o[0]]].value,l=a.dataflow.locale();return((u=r).length?u[0].toUpperCase()+u.slice(1):u)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return(t=t.map((t=>t+("fill"===t||"stroke"===t?" color":"")))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+Kt(t)}(o))+" with ".concat(up(l,s,t));var u}},"title-text":{desc:"title",caption:t=>"Title text '".concat(ev(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(ev(t),"'")}},Jy={ariaRole:Hy,ariaRoleDescription:Zy,description:$y};function Ky(t,e){const n=!1===e.aria;if(t(Wy,n||void 0),n||null==e.description)for(const r in Jy)t(Jy[r],void 0);else{const n=e.mark.marktype;t($y,e.description),t(Hy,e.ariaRole||("group"===n?Yy:Vy)),t(Zy,e.ariaRoleDescription||"".concat(n," mark"))}}function tv(t){return!1===t.aria?{[Wy]:!0}:Xy[t.role]?null:Qy[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Gy(e.role||Vy,e.desc,n.description||r(n))}catch(t){return null}}(t,Qy[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Gy(n?Yy:Vy,"".concat(e," mark container"),t.description)}(t)}function ev(t){return de(t.text).join(" ")}function nv(t){try{return de(Kt(t.items).items[0].text).join(" ")}catch(t){return null}}const rv=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function iv(){let t="",e="",n="";const r=[],i=()=>e=n="",o=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(rv(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),a),a={open(s){(o=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(o)})(s),e="<"+s;for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(const t of u)for(const e in t)o(e,t[e]);return a},close(){const o=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(o,">"):"/>"):"</".concat(o,">"),i(),a},attr:o,text:t=>(n+=rv(t),a),toString:()=>t};return a}const ov=t=>av(iv(),t)+"";function av(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):av(t,e)}return t.close()}const sv={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},lv={blend:"mix-blend-mode"},uv={fill:"none","stroke-miterlimit":10},cv="http://www.w3.org/2000/xmlns/",fv=bg.xmlns;function dv(t){vy.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const hv=vy.prototype;function pv(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function mv(t,e,n){let r,i,o;if("radial"===e.gradient){let r=dy(t,n++,"pattern",fv);kv(r,{id:fp+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=dy(r,0,"rect",fv),kv(r,{width:1,height:1,fill:"url(".concat(Ev(),"#").concat(e.id,")")}),kv(t=dy(t,n++,"radialGradient",fv),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else kv(t=dy(t,n++,"linearGradient",fv),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=dy(t,r,"stop",fv),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return hy(t,r),n}function gv(t,e,n){let r;return(t=dy(t,n,"clipPath",fv)).setAttribute("id",e.id),e.path?(r=dy(t,0,"path",fv),r.setAttribute("d",e.path)):(r=dy(t,0,"rect",fv),kv(r,{x:0,y:0,width:e.width,height:e.height})),hy(t,1),n+1}function yv(t,e,n,r,i){let o,a=t._svg;if(!a&&(o=e.ownerDocument,a=cy(o,r,fv),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},"g"===r))){const e=cy(o,"path",fv);a.appendChild(e),e.__data__=t;const n=cy(o,"g",fv);a.appendChild(n),n.__data__=t;const r=cy(o,"path",fv);a.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}Se(dv,vy,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=dy(t,0,"svg",fv),this._svg.setAttributeNS(cv,"xmlns",fv),this._svg.setAttributeNS(cv,"xmlns:xlink",bg["xmlns:xlink"]),this._svg.setAttribute("version",bg.version),this._svg.setAttribute("class","marks"),hy(t,1),this._root=dy(this._svg,0,"g",fv),kv(this._root,uv),hy(this._svg,1)),this.background(this._bgcolor),hv.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),hv.background.apply(this,arguments)},resize(t,e,n,r){return hv.resize.call(this,t,e,n,r),this._svg&&(kv(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=dy(t,0,"rect",fv),kv(n,{width:this._width,height:this._height,fill:e}));const r=ov(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),hy(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,o,a,s,l;for(a=0,s=t.length;a<s;++a)n=t[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=ny[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,pv(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,pv(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=ny[e.marktype],o=!1===e.interactive?"none":null,a="g"===i.tag,s=yv(e,t,n,"g",r);s.setAttribute("class",py(e));const l=tv(e);for(const d in l)Av(s,d,l[d]);a||Av(s,"pointer-events",o),Av(s,"clip-path",e.clip?om(this,e,e.group):null);let u=null,c=0;const f=t=>{const e=this.isDirty(t),n=yv(t,s,u,i.tag,r);e&&(this._update(i,n,t),a&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;Xm(n,(n=>{r=t.mark(e,n,r),++i})),hy(e,1+i)}(this,n,t)),u=n,++c};return i.nested?e.items.length&&f(e.items[0]):Xm(e,f),hy(s,c),s},_update(t,e,n){vv=e,bv=e.__values__,Ky(_v,n),t.attr(_v,n,this);const r=xv[t.type];r&&r.call(this,t,e,n),vv&&this.style(vv,n)},style(t,e){if(null!=e){for(const n in sv){let r="font"===n?Yg(e):e[n];if(r===bv[n])continue;const i=sv[n];null==r?t.removeAttribute(i):(dp(r)&&(r=hp(r,this._defs.gradient,Ev())),t.setAttribute(i,r+"")),bv[n]=r}for(const n in lv)wv(t,lv[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=dy(t,1,"defs",fv)),r=mv(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=dy(t,1,"defs",fv)),r=gv(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):hy(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let vv=null,bv=null;const xv={group(t,e,n){const r=vv=e.childNodes[2];bv=r.__values__,t.foreground(_v,n,this),bv=e.__values__,vv=e.childNodes[1],t.content(_v,n,this);const i=vv=e.childNodes[0];t.background(_v,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==bv.events&&(Av(r,"pointer-events",o),Av(i,"pointer-events",o),bv.events=o),n.strokeForeground&&n.stroke){const t=n.fill;Av(r,"display",null),this.style(i,n),Av(i,"stroke",null),t&&(n.fill=null),bv=r.__values__,this.style(r,n),t&&(n.fill=t),vv=null}else Av(r,"display","none")},image(t,e,n){!1===n.smooth?(wv(e,"image-rendering","optimizeSpeed"),wv(e,"image-rendering","pixelated")):wv(e,"image-rendering",null)},text(t,e,n){const r=$g(n);let i,o,a,s;Qt(r)?(o=r.map((t=>Zg(n,t))),i=o.join("\n"),i!==bv.text&&(hy(e,0),a=e.ownerDocument,s=Wg(n),o.forEach(((t,r)=>{const i=cy(a,"tspan",fv);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),bv.text=i)):(o=Zg(n,r),o!==bv.text&&(e.textContent=o,bv.text=o)),Av(e,"font-family",Yg(n)),Av(e,"font-size",Ig(n)+"px"),Av(e,"font-style",n.fontStyle),Av(e,"font-variant",n.fontVariant),Av(e,"font-weight",n.fontWeight)}};function _v(t,e,n){e!==bv[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(vv,t,e,n):Av(vv,t,e),bv[t]=e)}function wv(t,e,n){n!==bv[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),bv[e]=n)}function kv(t,e){for(const n in e)Av(t,n,e[n])}function Av(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function Ev(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Mv(t){vy.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}Se(Mv,vy,{svg(){return this._text},_render(t){const e=iv();e.open("svg",we({},bg,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",uv,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=ny[e.marktype],r=n.tag,i=[Ky,n.attr];t.open("g",{class:py(e),"clip-path":e.clip?om(this,e,e.group):null},tv(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&t.open("a",a),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=$g(o);if(Qt(e)){const n={x:0,dy:Wg(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Zg(o,e[r])).close()}else t.text(Zg(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),Xm(o,(e=>this.mark(t,e))),t.close(),r&&a?(i&&(o.fill=null),o.stroke=a,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),a&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):Xm(e,o),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(o,e,this))):n(o,e,this),r&&function(t,e,n,r,i){let o;if(null==e)return t;if("bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===r&&(t["font-family"]=Yg(e),t["font-size"]=Ig(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in sv){let n=e[a];const r=sv[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(dp(n)&&(n=hp(n,i.gradient,"")),t[r]=n)}for(const a in lv){const t=e[a];null!=t&&(o=o||[],o.push("".concat(lv[a],": ").concat(t,";")))}o&&(t.style=o.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:fp+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const Cv="canvas",Sv=Cv,Dv="svg",Fv={};function Tv(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Fv[t]=e,this):Fv[t]}function Nv(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)Ov(i[s],e,n,r);else for(const t=ny[o].isect;s<a;++s){const n=i[s];zv(n,e,t)&&r.push(n)}}return r}function Ov(t,e,n,r){n&&n(t.mark)&&zv(t,e,ny.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const a=t.x||0,s=t.y||0;e.translate(-a,-s);for(let t=0;t<o;++t)Nv(i[t],e,n,r);e.translate(a,s)}return r}function zv(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}Fv[Cv]=Fv.png={renderer:jy,headless:jy,handler:zy},Fv.svg={renderer:dv,headless:Mv,handler:qy},Fv.none={};const Rv=new am,Pv="top",Bv="left",Lv="right",jv="bottom",Uv="start",qv="middle",Iv="end",Wv="group",$v="axis",Hv="title",Zv="legend",Yv="row-header",Vv="row-footer",Gv="row-title",Xv="column-header",Qv="column-footer",Jv="column-title",Kv="fit-x",tb="fit-y",eb="none",nb="all",rb="each",ib="flush",ob="column",ab="row";function sb(t){ns.call(this,null,t)}function lb(t,e,n){return e(t.bounds.clear(),t,n)}Se(sb,ns,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=ny[i],a=o.bound;let s,l=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),l=lb(r,a),r.items.forEach((t=>{t.bounds.clear().union(l)}));else if(i===Wv||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),l.clear(),r.items.forEach((t=>l.union(lb(t,a)))),r.role){case $v:case Zv:case Hv:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,(t=>{l.union(lb(t,a))})),e.visit(e.MOD,(t=>{s=s||l.alignsWith(t.bounds),n.dirty(t),l.union(lb(t,a))})),s&&(l.clear(),r.items.forEach((t=>l.union(t.bounds))));return function(t){const e=t.clip;if(he(e))e(Fm(Rv.clear()));else{if(!e)return;Rv.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(Rv)}(r),e.modifies("bounds")}});const ub=":vega_identifier:";function cb(t){ns.call(this,0,t)}function fb(t){ns.call(this,null,t)}function db(t){ns.call(this,null,t)}cb.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Se(cb,ns,{transform(t,e){const n=(i=e.dataflow)._signals[ub]||(i._signals[ub]=i.add(0)),r=t.as;var i;let o=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++o)),n.set(this.value=o),e}}),Se(fb,ns,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===Wv?lm:sm;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const hb={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&pb(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},pb=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),mb=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(pb(o,n=t[r].bounds,e))return!0},gb=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},yb=t=>(t.forEach((t=>t.opacity=1)),t),vb=(t,e)=>t.reflow(e.modified()).modifies("opacity");function bb(t){ns.call(this,null,t)}Se(db,ns,{transform(t,e){const n=hb[t.method]||hb.parity,r=t.separation||0;let i,o,a=e.materialize(e.SOURCE).source;if(!a||!a.length)return;if(!t.method)return t.modified("method")&&(yb(a),e=vb(e,t)),e;if(a=a.filter(gb),!a.length)return;if(t.sort&&(a=a.slice().sort(t.sort)),i=yb(a),e=vb(e,t),i.length>=3&&mb(i,r)){do{i=n(i,r)}while(i.length>=3&&mb(i,r));i.length<3&&!Kt(a).opacity&&(i.length>1&&(Kt(i).opacity=0),Kt(a).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=((t,e,n)=>{var r=t.range(),i=new am;return e===Pv||e===jv?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),a.forEach((t=>{o(t)||(t.opacity=0)})));const s=i[0].mark.bounds.clear();return a.forEach((t=>{t.opacity&&s.union(t.bounds)})),e}}),Se(bb,ns,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const xb=new am;function _b(t,e,n){return t[e]===n?0:(t[e]=n,1)}function wb(t){var e=t.items[0].orient;return e===Bv||e===Lv}function kb(t,e,n,r){var i,o,a=e.items[0],s=a.datum,l=null!=a.translate?a.translate:.5,u=a.orient,c=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&Hg(g),x=0,_=0;switch(xb.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),u){case Pv:x=h||0,_=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(f,0),g&&Ab(t,g,o,y,b,0,-1,v);break;case Bv:x=-d,_=h||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,f),g&&Ab(t,g,o,y,b,1,-1,v);break;case Lv:x=n+d,_=h||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,f),g&&Ab(t,g,o,y,b,1,1,v);break;case jv:x=h||0,_=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(f,o),g&&Ab(t,g,o,y,0,0,1,v);break;default:x=a.x,_=a.y}return dm(v.translate(x,_),a),_b(a,"x",x+l)|_b(a,"y",_+l)&&(a.bounds=xb,t.dirty(a),a.bounds=v,t.dirty(a)),a.mark.bounds.clear().union(v)}function Ab(t,e,n,r,i,o,a,s){const l=e.bounds;if(e.auto){const s=a*(n+i+r);let u=0,c=0;t.dirty(e),o?u=(e.x||0)-(e.x=s):c=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(l.translate(-u,-c)),t.dirty(e)}s.union(l)}const Eb=(t,e)=>Math.floor(Math.min(t,e)),Mb=(t,e)=>Math.ceil(Math.max(t,e));function Cb(t){return(new am).set(0,0,t.width||0,t.height||0)}function Sb(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function Db(t,e,n){const r=Jt(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function Fb(t){return t<0?Math.ceil(-t):0}function Tb(t,e,n){var r,i,o,a,s,l,u,c,f,d,h,p=!n.nodirty,m=n.bounds===ib?Cb:Sb,g=xb.set(0,0,0,0),y=Db(n.align,ob),v=Db(n.align,ab),b=Db(n.padding,ob),x=Db(n.padding,ab),_=n.columns||e.length,w=_<=0?1:Math.ceil(e.length/_),k=e.length,A=Array(k),E=Array(_),M=0,C=Array(k),S=Array(w),D=0,F=Array(k),T=Array(k),N=Array(k);for(i=0;i<_;++i)E[i]=0;for(i=0;i<w;++i)S[i]=0;for(i=0;i<k;++i)l=e[i],s=N[i]=m(l),l.x=l.x||0,F[i]=0,l.y=l.y||0,T[i]=0,o=i%_,a=~~(i/_),M=Math.max(M,u=Math.ceil(s.x2)),D=Math.max(D,c=Math.ceil(s.y2)),E[o]=Math.max(E[o],u),S[a]=Math.max(S[a],c),A[i]=b+Fb(s.x1),C[i]=x+Fb(s.y1),p&&t.dirty(e[i]);for(i=0;i<k;++i)i%_==0&&(A[i]=0),i<_&&(C[i]=0);if(y===rb)for(o=1;o<_;++o){for(h=0,i=o;i<k;i+=_)h<A[i]&&(h=A[i]);for(i=o;i<k;i+=_)A[i]=h+E[o-1]}else if(y===nb){for(h=0,i=0;i<k;++i)i%_&&h<A[i]&&(h=A[i]);for(i=0;i<k;++i)i%_&&(A[i]=h+M)}else for(y=!1,o=1;o<_;++o)for(i=o;i<k;i+=_)A[i]+=E[o-1];if(v===rb)for(a=1;a<w;++a){for(h=0,r=(i=a*_)+_;i<r;++i)h<C[i]&&(h=C[i]);for(i=a*_;i<r;++i)C[i]=h+S[a-1]}else if(v===nb){for(h=0,i=_;i<k;++i)h<C[i]&&(h=C[i]);for(i=_;i<k;++i)C[i]=h+D}else for(v=!1,a=1;a<w;++a)for(r=(i=a*_)+_;i<r;++i)C[i]+=S[a-1];for(f=0,i=0;i<k;++i)f=A[i]+(i%_?f:0),F[i]+=f-e[i].x;for(o=0;o<_;++o)for(d=0,i=o;i<k;i+=_)d+=C[i],T[i]+=d-e[i].y;if(y&&Db(n.center,ob)&&w>1)for(i=0;i<k;++i)(f=(s=y===nb?M:E[i%_])-N[i].x2-e[i].x-F[i])>0&&(F[i]+=f/2);if(v&&Db(n.center,ab)&&1!==_)for(i=0;i<k;++i)(d=(s=v===nb?D:S[~~(i/_)])-N[i].y2-e[i].y-T[i])>0&&(T[i]+=d/2);for(i=0;i<k;++i)g.union(N[i].translate(F[i],T[i]));switch(f=Db(n.anchor,"x"),d=Db(n.anchor,"y"),Db(n.anchor,ob)){case Iv:f-=g.width();break;case qv:f-=g.width()/2}switch(Db(n.anchor,ab)){case Iv:d-=g.height();break;case qv:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),i=0;i<k;++i)e[i].mark.bounds.clear();for(i=0;i<k;++i)(l=e[i]).x+=F[i]+=f,l.y+=T[i]+=d,g.union(l.mark.bounds.union(l.bounds.translate(F[i],T[i]))),p&&t.dirty(l);return g}function Nb(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function Ob(t,e){return t.bounds[e]}function zb(t,e,n,r,i,o,a,s,l,u,c,f,d,h){var p,m,g,y,v,b,x,_,w,k=n.length,A=0,E=0;if(!k)return A;for(p=c;p<k;p+=f)n[p]&&(A=a(A,l(n[p],u)));if(!e.length)return A;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),A+=o,m=0,y=e.length;m<y;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=c,m=0,y=e.length;m<y;++m,p+=f){for(v=(b=e[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);s?(_=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),w=A):(_=A,w=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),v.union(b.bounds.translate(_-(b.x||0),w-(b.y||0))),b.x=_,b.y=w,t.dirty(b),E=a(E,v[u])}return E}function Rb(t,e,n,r,i,o){if(e){t.dirty(e);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),e.bounds.translate(a-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=a,e.y=s,t.dirty(e)}}function Pb(t,e,n,r,i,o,a){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),l=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,s("offset",0)),u=s("anchor",Uv),c=u===Iv?1:u===qv?.5:0,f={align:rb,bounds:s("bounds",ib),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case Bv:f.anchor={x:Math.floor(r.x1)-l,column:Iv,y:c*(a||r.height()+2*r.y1),row:u};break;case Lv:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case Pv:f.anchor={y:Math.floor(i.y1)-l,row:Iv,x:c*(o||i.width()+2*i.x1),column:u};break;case jv:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case"top-left":f.anchor={x:l,y:l};break;case"top-right":f.anchor={x:o-l,y:l,column:Iv};break;case"bottom-left":f.anchor={x:l,y:a-l,row:Iv};break;case"bottom-right":f.anchor={x:o-l,y:a-l,column:Iv,row:Iv}}return f}function Bb(t,e){var n,r,i=e.items[0],o=i.datum,a=i.orient,s=i.bounds,l=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var a=e.items[1].items[0],s=a.anchor,l=e.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case Bv:i+=Math.ceil(a.bounds.width())+l;break;case Lv:case jv:break;default:o+=a.bounds.height()+l}switch((i||o)&&jb(t,n,i,o),a.orient){case Bv:c+=Lb(e,n,a,s,1,1);break;case Lv:u+=Lb(e,n,a,Iv,0,0)+l,c+=Lb(e,n,a,s,1,1);break;case jv:u+=Lb(e,n,a,s,0,0),c+=Lb(e,n,a,Iv,-1,0,1)+l;break;default:u+=Lb(e,n,a,s,0,0)}(u||c)&&jb(t,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(jb(t,n,-u,0),jb(t,a,-u,0))}else(i||o)&&jb(t,n,i,o)}(t,i,i.items[0].items[0]),s=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),"symbol"===o.type&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),a!==eb&&(i.x=l=0,i.y=u=0),i.width=n,i.height=r,dm(s.set(l,u,l+n,u+r),i),i.mark.bounds.clear().union(s),i}function Lb(t,e,n,r,i,o,a){const s="symbol"!==t.datum.type,l=n.datum.vgrad,u=(!s||!o&&l||a?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,c=l&&o?u:0,f=l&&o?0:u,d=i<=0?0:Hg(n);return Math.round(r===Uv?c:r===Iv?f-d:.5*(u-d))}function jb(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function Ub(t){ns.call(this,null,t)}function qb(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function Ib(t){ns.call(this,null,t)}function Wb(t){ns.call(this,null,t)}function $b(){return Ma({})}function Hb(t){ns.call(this,null,t)}function Zb(t){ns.call(this,[],t)}Se(Ub,ns,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&function(t,e,n){var r,i,o,a,s,l,u,c=function(t){var e,n,r=t.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(e=r[o]).items,e.marktype===Wv)switch(e.role){case $v:case Zv:case Hv:break;case Yv:a.rowheaders.push(...n);break;case Vv:a.rowfooters.push(...n);break;case Xv:a.colheaders.push(...n);break;case Qv:a.colfooters.push(...n);break;case Gv:a.rowtitle=n[0];break;case Jv:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(e),f=c.marks,d=n.bounds===ib?Nb:Ob,h=n.offset,p=n.columns||f.length,m=p<=0?1:Math.ceil(f.length/p),g=m*p;const y=Tb(t,f,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(l=Db(n.headerBand,ab,null),r=zb(t,c.rowheaders,f,0,m,-Db(h,"rowHeader"),Eb,0,d,"x1",0,p,1,l)),c.colheaders&&(l=Db(n.headerBand,ob,null),i=zb(t,c.colheaders,f,0,p,-Db(h,"columnHeader"),Eb,1,d,"y1",0,1,p,l)),c.rowfooters&&(l=Db(n.footerBand,ab,null),o=zb(t,c.rowfooters,f,0,m,Db(h,"rowFooter"),Mb,0,d,"x2",p-1,p,1,l)),c.colfooters&&(l=Db(n.footerBand,ob,null),a=zb(t,c.colfooters,f,0,p,Db(h,"columnFooter"),Mb,1,d,"y2",g-p,1,p,l)),c.rowtitle&&(s=Db(n.titleAnchor,ab),u=Db(h,"rowTitle"),u=s===Iv?o+u:r-u,l=Db(n.titleBand,ab,.5),Rb(t,c.rowtitle,u,0,y,l)),c.coltitle&&(s=Db(n.titleAnchor,ob),u=Db(h,"columnTitle"),u=s===Iv?a+u:i-u,l=Db(n.titleBand,ob,.5),Rb(t,c.coltitle,u,1,y,l))}(n,e,t.layout),function(t,e,n){var r,i,o,a,s,l=e.items,u=Math.max(0,e.width||0),c=Math.max(0,e.height||0),f=(new am).set(0,0,u,c),d=f.clone(),h=f.clone(),p=[];for(a=0,s=l.length;a<s;++a)switch((i=l[a]).role){case $v:(wb(i)?d:h).union(kb(t,i,u,c));break;case Hv:r=i;break;case Zv:p.push(Bb(t,i));break;case"frame":case"scope":case Yv:case Vv:case Gv:case Xv:case Qv:case Jv:d.union(i.bounds),h.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(o=t.orient||Lv)!==eb&&(e[o]||(e[o]=[])).push(t)}));for(const r in e){const i=e[r];Tb(t,i,Pb(i,r,n.legends,d,h,u,c))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),!n.autosize||"fit"!==n.autosize.type&&n.autosize.type!==Kv&&n.autosize.type!==tb)f.union(r);else switch(e.orient){case Bv:case Lv:f.add(r.x1,0).add(r.x2,0);break;case Pv:case jv:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(t,e,n,r,i){var o,a=e.items[0],s=a.frame,l=a.orient,u=a.anchor,c=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=l===Bv||l===Lv?r:n,m=0,g=0,y=0,v=0,b=0;if(s!==Wv?l===Bv?(m=i.y2,p=i.y1):l===Lv?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):l===Bv&&(m=r,p=0),o=u===Uv?m:u===Iv?p:(m+p)/2,h&&h.text){switch(l){case Pv:case jv:b=d.bounds.height()+f;break;case Bv:v=d.bounds.width()+f;break;case Lv:v=-d.bounds.width()-f}xb.clear().union(h.bounds),xb.translate(v-(h.x||0),b-(h.y||0)),_b(h,"x",v)|_b(h,"y",b)&&(t.dirty(h),h.bounds.clear().union(xb),h.mark.bounds.clear().union(xb),t.dirty(h)),xb.clear().union(h.bounds)}else xb.clear();switch(xb.union(d.bounds),l){case Pv:g=o,y=i.y1-xb.height()-c;break;case Bv:g=i.x1-xb.width()-c,y=o;break;case Lv:g=i.x2+xb.width()+c,y=o;break;case jv:g=o,y=i.y2+c;break;default:g=a.x,y=a.y}return _b(a,"x",g)|_b(a,"y",y)&&(xb.translate(g,y),t.dirty(a),a.bounds.clear().union(xb),e.bounds.clear().union(xb),t.dirty(a)),a.bounds}(t,r,u,c,f)),e.clip&&f.set(0,0,e.width||0,e.height||0),function(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let a=t._width,s=t._height,l=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,e.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===i.contains){const e=t.padding();a-=e.left+e.right,s-=e.top+e.bottom}o===eb?(u=0,f=0,l=a,c=s):"fit"===o?(l=Math.max(0,a-u-d),c=Math.max(0,s-f-h)):o===Kv?(l=Math.max(0,a-u-d),s=c+f+h):o===tb?(a=l+u+d,c=Math.max(0,s-f-h)):"pad"===o&&(a=l+u+d,s=c+f+h),t._resizeView(a,s,l,c,[u,f],i.resize)}(t,e,f,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}}),Se(Ib,ns,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,a=Vh(o,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||Qh(n,o,a,t.formatSpecifier,t.formatType,!!t.values),l=t.values?Gh(o,t.values,a):Xh(o,a);return i&&(r.rem=i),i=l.map(((t,e)=>Ma({index:e/(l.length-1||1),value:t,label:s(t)}))),t.extra&&i.length&&i.push(Ma({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),Se(Wb,ns,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||$b,o=t.key||Aa,a=this.value;return Qt(r.encode)&&(r.encode=null),a&&(t.modified("key")||e.modified(o))&&Rt("DataJoin does not support modified key function or fields."),a||(e=e.addAll(),this.value=a=function(t){const e=Ce().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(o)),e.visit(e.ADD,(t=>{const e=o(t);let n=a.get(e);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),a.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=o(t),n=a.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=o(t),n=a.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),Se(Hb,ns,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if(Qt(o)){if(!n.changed()&&!o.every((t=>i[t])))return e.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||Wt,l=i.enter||Wt,u=i.exit||Wt,c=(o&&!a?i[o]:s)||Wt;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{l(e,t),s(e,t)})),n.modifies(l.output),n.modifies(s.output),c!==Wt&&c!==s&&(e.visit(e.ADD,(e=>{c(e,t)})),n.modifies(c.output))),e.changed(e.REM)&&u!==Wt&&(e.visit(e.REM,(e=>{u(e,t)})),n.modifies(u.output)),a||c!==Wt){const i=e.MOD|(t.modified()?e.REFLOW:0);a?(e.visit(i,(e=>{const i=l(e,t)||r;(c(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)):e.visit(i,(e=>{(c(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:e.StopPropagation}}),Se(Zb,ns,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,a,s=e.dataflow.locale(),l=e.fork(e.NO_SOURCE|e.NO_FIELDS),u=this.value,c=t.type||Wh,f=t.scale,d=+t.limit,h=Vh(f,null==t.count?5:t.count,t.minstep),p=!!t.values||c===Wh,m=t.format||rp(s,f,h,c,t.formatSpecifier,t.formatType,p),g=t.values||ep(f,h);return u&&(l.rem=u),c===Wh?(d&&g.length>d?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=g.slice(0,d-1),a=!0):u=g,he(i=t.size)?(t.values||0!==f(u[0])||(u=u.slice(1)),o=u.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=xe(o=i||8),u=u.map(((e,n)=>Ma({index:n,label:m(e,n,u),value:e,offset:o,size:i(e,t)}))),a&&(a=g[u.length],u.push(Ma({index:u.length,label:"\u2026".concat(g.length-u.length," entries"),value:a,offset:o,size:i(a,t)})))):"gradient"===c?(n=f.domain(),r=Bh(f,n[0],Kt(n)),g.length<3&&!t.values&&n[0]!==Kt(n)&&(g=[n[0],Kt(n)]),u=g.map(((t,e)=>Ma({index:e,label:m(t,e,g),value:t,perc:r(t)})))):(i=g.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+Kt(e),o=i-r;if(t.type===uh){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}(f),u=g.map(((t,e)=>Ma({index:e,label:m(t,e,g),value:t,perc:e?r(t):0,perc2:e===i?1:r(g[e+1])})))),l.source=u,l.add=u,this.value=u,l}});const Yb=t=>t.source.x,Vb=t=>t.source.y,Gb=t=>t.target.x,Xb=t=>t.target.y;function Qb(t){ns.call(this,{},t)}Qb.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Se(Qb,ns,{transform(t,e){var n=t.sourceX||Yb,r=t.sourceY||Vb,i=t.targetX||Gb,o=t.targetY||Xb,a=t.as||"path",s=t.orient||"vertical",l=t.shape||"line",u=ex.get(l+"-"+s)||ex.get(l);return u||Rt("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[a]=u(n(t),r(t),i(t),o(t))})),e.reflow(t.modified()).modifies(a)}});const Jb=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,Kb=(t,e,n,r)=>{var i=n-t,o=r-e,a=Math.hypot(i,o)/2;return"M"+t+","+e+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},tx=(t,e,n,r)=>{const i=n-t,o=r-e,a=.2*(i+o),s=.2*(o-i);return"M"+t+","+e+"C"+(t+a)+","+(e+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},ex=Ce({line:Jb,"line-radial":(t,e,n,r)=>Jb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:Kb,"arc-radial":(t,e,n,r)=>Kb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:tx,"curve-radial":(t,e,n,r)=>tx(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*a+","+e*s+"L"+r*a+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n),l=(e+r)/2;return"M"+e*i+","+e*o+"C"+l*i+","+l*o+" "+l*a+","+l*s+" "+r*a+","+r*s}});function nx(t){ns.call(this,null,t)}function rx(t){return Dh(t)&&t!==oh}nx.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Se(nx,ns,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],a=o[0],s=o[1],l=t.field||qt,u=t.startAngle||0,c=null!=t.endAngle?t.endAngle:2*Math.PI,f=e.source,d=f.map(l),h=d.length,p=u,m=(c-u)/qb(d),g=is(h);for(t.sort&&g.sort(((t,e)=>d[t]-d[e])),n=0;n<h;++n)i=d[g[n]],(r=f[g[n]])[a]=p,r[s]=p+=i*m;return this.value=d,e.reflow(t.modified()).modifies(o)}});const ix=Ie(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function ox(t){ns.call(this,null,t),this.modified(!0)}function ax(t,e,n){return Nh(t)&&Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0))!==e.length&&n.warn("Log scale domain includes zero: "+Be(e)),e}function sx(t,e,n){return he(t)&&(e||n)?function(t,e){const n=e[0],r=Kt(e)-n;return function(e){return t(n+e*r)}}(t,lx(e||[0,1],n)):t}function lx(t,e){return e?t.slice().reverse():t}function ux(t){ns.call(this,null,t)}Se(ox,ns,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";return n===oh?oh+"-"+Jd:(function(t){const e=t.type;return Dh(e)&&e!==rh&&e!==ih&&(t.scheme||t.range&&t.range.length&&t.range.every(Oe))}(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?oh+"-":3===e?ah+"-":""),(r+n||Jd).toLowerCase())}(t);for(i in r&&i===r.type||(this.value=r=Mh(i)()),t)if(!ix[i]){if("padding"===i&&rx(r.type))continue;he(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){t!==dh&&t!==fh&&Rt("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===fh?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Qd(n,i,r)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i=e.schemeExtent;return Qt(e.scheme)?r=Ph(e.scheme,e.interpolate,e.interpolateGamma):(r=Ih(e.scheme.toLowerCase()))||Rt("Unrecognized scheme name: ".concat(e.scheme)),n=t===uh?n+1:t===hh?n-1:t===sh||t===lh?+e.schemeCount||5:n,Oh(t)?sx(r,i,e.reverse):he(r)?function(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}(sx(r,i),n):t===ch?r:r.slice(0,n)}(r,e,n),he(o))){if(t.interpolator)return t.interpolator(o);Rt("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&Oh(r))return t.interpolator(Ph(lx(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(Lh(e.interpolate,e.interpolateGamma)):he(t.round)?t.round(i):he(t.rangeRound)&&t.interpolate(i?Kc:Jc),o&&t.range(lx(o,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!Qt(r)){const e=t.domain(),n=e[0],i=Kt(e),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||Rt("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=is(a,s+o/2,o)}return r?t.bins=r:t.bins&&delete t.bins,t.type===hh&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain()),n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(ax(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,a=e.domain,s=t.type,l=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===Jd||e===th||e===eh)}(t);if(!a)return 0;if(rx(s)&&e.padding&&a[0]!==Kt(a)&&(a=function(t,e,n,r,i,o){var a=Math.abs(Kt(n)-n[0]),s=a/(a-2*r),l=t===Kd?ue(e,null,s):t===eh?ce(e,null,s,.5):t===th?ce(e,null,s,i||1):t===nh?fe(e,null,s,o||1):le(e,null,s);return(e=e.slice())[0]=l[0],e[e.length-1]=l[1],e}(s,a,e.range,e.padding,e.exponent,e.constant)),(l||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(a=a.slice()).length-1||1,l&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=e.domainMin&&(a[0]=e.domainMin),null!=e.domainMax&&(a[i]=e.domainMax),null!=e.domainMid)){const t=(o=e.domainMid)>a[i]?i+1:o<a[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(t,0,o)}return t.domain(ax(s,a,n)),s===ch&&t.unknown(e.domainImplicit?Jf:void 0),e.nice&&t.nice&&t.nice(!0!==e.nice&&Vh(t,e.nice)||null),a.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Se(ux,ns,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(Fa(t.sort)),this.modified(n),e}});const cx="zero",fx="center",dx="normalize",hx=["y0","y1"];function px(t){ns.call(this,null,t)}function mx(t,e,n,r,i){for(var o,a=(e-t.sum)/2,s=t.length,l=0;l<s;++l)(o=t[l])[r]=a,o[i]=a+=Math.abs(n(o))}function gx(t,e,n,r,i){for(var o,a=1/t.sum,s=0,l=t.length,u=0,c=0;u<l;++u)(o=t[u])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function yx(t,e,n,r,i){for(var o,a,s=0,l=0,u=t.length,c=0;c<u;++c)(o=+n(a=t[c]))<0?(a[r]=l,a[i]=l+=o):(a[r]=s,a[i]=s+=o)}px.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:cx,values:[cx,fx,dx]},{name:"as",type:"string",array:!0,length:2,default:hx}]},Se(px,ns,{transform(t,e){var n,r,i,o,a=t.as||hx,s=a[0],l=a[1],u=Fa(t.sort),c=t.field||qt,f=t.offset===fx?mx:t.offset===dx?gx:yx;for(n=function(t,e,n,r){var i,o,a,s,l,u,c,f,d,h=[],p=t=>t(l);if(null==e)h.push(t.slice());else for(i={},o=0,a=t.length;o<a;++o)l=t[o],(c=i[u=e.map(p)])||(i[u]=c=[],h.push(c)),c.push(l);for(u=0,d=0,s=h.length;u<s;++u){for(o=0,f=0,a=(c=h[u]).length;o<a;++o)f+=Math.abs(r(c[o]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(e.source,t.groupby,u,c),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,c,s,l);return e.reflow(t.modified()).modifies(a)}});const vx=t=>t;function bx(t,e){t&&_x.hasOwnProperty(t.type)&&_x[t.type](t,e)}var xx={Feature:function(t,e){bx(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)bx(n[r].geometry,e)}},_x={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){wx(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)wx(n[r],e,0)},Polygon:function(t,e){kx(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)kx(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)bx(n[r],e)}};function wx(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function kx(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)wx(t[n],e,1);e.polygonEnd()}function Ax(t,e){t&&xx.hasOwnProperty(t.type)?xx[t.type](t,e):bx(t,e)}class Ex{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[n++]=a),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}var Mx=1e-6,Cx=1e-12,Sx=Math.PI,Dx=Sx/2,Fx=Sx/4,Tx=2*Sx,Nx=180/Sx,Ox=Sx/180,zx=Math.abs,Rx=Math.atan,Px=Math.atan2,Bx=Math.cos,Lx=Math.ceil,jx=Math.exp,Ux=(Math.floor,Math.hypot),qx=Math.log,Ix=Math.pow,Wx=Math.sin,$x=Math.sign||function(t){return t>0?1:t<0?-1:0},Hx=Math.sqrt,Zx=Math.tan;function Yx(t){return t>1?0:t<-1?Sx:Math.acos(t)}function Vx(t){return t>1?Dx:t<-1?-Dx:Math.asin(t)}function Gx(){}var Xx,Qx,Jx,Kx,t_=new Ex,e_=new Ex,n_={point:Gx,lineStart:Gx,lineEnd:Gx,polygonStart:function(){n_.lineStart=r_,n_.lineEnd=a_},polygonEnd:function(){n_.lineStart=n_.lineEnd=n_.point=Gx,t_.add(zx(e_)),e_=new Ex},result:function(){var t=t_/2;return t_=new Ex,t}};function r_(){n_.point=i_}function i_(t,e){n_.point=o_,Xx=Jx=t,Qx=Kx=e}function o_(t,e){e_.add(Kx*t-Jx*e),Jx=t,Kx=e}function a_(){o_(Xx,Qx)}const s_=n_;var l_=1/0,u_=l_,c_=-l_,f_=c_,d_={point:function(t,e){t<l_&&(l_=t),t>c_&&(c_=t),e<u_&&(u_=e),e>f_&&(f_=e)},lineStart:Gx,lineEnd:Gx,polygonStart:Gx,polygonEnd:Gx,result:function(){var t=[[l_,u_],[c_,f_]];return c_=f_=-(u_=l_=1/0),t}};const h_=d_;var p_,m_,g_,y_,v_=0,b_=0,x_=0,__=0,w_=0,k_=0,A_=0,E_=0,M_=0,C_={point:S_,lineStart:D_,lineEnd:N_,polygonStart:function(){C_.lineStart=O_,C_.lineEnd=z_},polygonEnd:function(){C_.point=S_,C_.lineStart=D_,C_.lineEnd=N_},result:function(){var t=M_?[A_/M_,E_/M_]:k_?[__/k_,w_/k_]:x_?[v_/x_,b_/x_]:[NaN,NaN];return v_=b_=x_=__=w_=k_=A_=E_=M_=0,t}};function S_(t,e){v_+=t,b_+=e,++x_}function D_(){C_.point=F_}function F_(t,e){C_.point=T_,S_(g_=t,y_=e)}function T_(t,e){var n=t-g_,r=e-y_,i=Hx(n*n+r*r);__+=i*(g_+t)/2,w_+=i*(y_+e)/2,k_+=i,S_(g_=t,y_=e)}function N_(){C_.point=S_}function O_(){C_.point=R_}function z_(){P_(p_,m_)}function R_(t,e){C_.point=P_,S_(p_=g_=t,m_=y_=e)}function P_(t,e){var n=t-g_,r=e-y_,i=Hx(n*n+r*r);__+=i*(g_+t)/2,w_+=i*(y_+e)/2,k_+=i,A_+=(i=y_*t-g_*e)*(g_+t),E_+=i*(y_+e),M_+=3*i,S_(g_=t,y_=e)}const B_=C_;function L_(t){this._context=t}L_.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Tx)}},result:Gx};var j_,U_,q_,I_,W_,$_=new Ex,H_={point:Gx,lineStart:function(){H_.point=Z_},lineEnd:function(){j_&&Y_(U_,q_),H_.point=Gx},polygonStart:function(){j_=!0},polygonEnd:function(){j_=null},result:function(){var t=+$_;return $_=new Ex,t}};function Z_(t,e){H_.point=Y_,U_=I_=t,q_=W_=e}function Y_(t,e){I_-=t,W_-=e,$_.add(Hx(I_*I_+W_*W_)),I_=t,W_=e}const V_=H_;let G_,X_,Q_,J_;class K_{constructor(t){this._append=null==t?tw:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));if(e>15)return tw;if(e!==G_){const t=10**e;G_=e,X_=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return X_}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append(y||(y=U(["M",",",""])),t,e),this._point=1;break;case 1:this._append(v||(v=U(["L",",",""])),t,e);break;default:if(this._append(b||(b=U(["M",",",""])),t,e),this._radius!==Q_||this._append!==X_){const t=this._radius,e=this._;this._="",this._append(x||(x=U(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),t,t,t,-2*t,t,t,2*t),Q_=t,X_=this._append,J_=this._,this._=e}this._+=J_}}result(){const t=this._;return this._="",t.length?t:null}}function tw(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function ew(t,e){let n,r,i=3,o=4.5;function a(t){return t&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),Ax(t,n(r))),r.result()}return a.area=function(t){return Ax(t,n(s_)),s_.result()},a.measure=function(t){return Ax(t,n(V_)),V_.result()},a.bounds=function(t){return Ax(t,n(h_)),h_.result()},a.centroid=function(t){return Ax(t,n(B_)),B_.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,vx):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new K_(i)):new L_(e=t),"function"!=typeof o&&r.pointRadius(o),a):e},a.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(r.pointRadius(+t),+t),a):o},a.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));i=e}return null===e&&(r=new K_(i)),a},a.projection(t).digits(i).context(e)}function nw(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:Gx,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function rw(t,e){return zx(t[0]-e[0])<Mx&&zx(t[1]-e[1])<Mx}function iw(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function ow(t,e,n,r,i){var o,a,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(rw(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*Mx}s.push(n=new iw(r,t,null,!0)),l.push(n.o=new iw(r,null,n,!1)),s.push(n=new iw(a,t,null,!1)),l.push(n.o=new iw(a,null,n,!0))}})),s.length){for(l.sort(e),aw(s),aw(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function aw(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function sw(t){return[Px(t[1],t[0]),Vx(t[2])]}function lw(t){var e=t[0],n=t[1],r=Bx(n);return[r*Bx(e),r*Wx(e),Wx(n)]}function uw(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function cw(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function fw(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function dw(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function hw(t){var e=Hx(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function pw(t){return zx(t[0])<=Sx?t[0]:$x(t[0])*((zx(t[0])+Sx)%Tx-Sx)}function mw(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function gw(t,e,n,r){return function(i){var o,a,s,l=e(i),u=nw(),c=e(u),f=!1,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,a=mw(a);var t=function(t,e){var n=pw(e),r=e[1],i=Wx(r),o=[Wx(n),-Bx(n),0],a=0,s=0,l=new Ex;1===i?r=Dx+Mx:-1===i&&(r=-Dx-Mx);for(var u=0,c=t.length;u<c;++u)if(d=(f=t[u]).length)for(var f,d,h=f[d-1],p=pw(h),m=h[1]/2+Fx,g=Wx(m),y=Bx(m),v=0;v<d;++v,p=x,g=w,y=k,h=b){var b=f[v],x=pw(b),_=b[1]/2+Fx,w=Wx(_),k=Bx(_),A=x-p,E=A>=0?1:-1,M=E*A,C=M>Sx,S=g*w;if(l.add(Px(S*E*Wx(M),y*k+S*Bx(M))),a+=C?A+E*Tx:A,C^p>=n^x>=n){var D=cw(lw(h),lw(b));hw(D);var F=cw(o,D);hw(F);var T=(C^A>=0?-1:1)*Vx(F[2]);(r>T||r===T&&(D[0]||D[1]))&&(s+=C^A>=0?1:-1)}}return(a<-Mx||a<Mx&&l<-Cx)^1&s}(o,r);a.length?(f||(i.polygonStart(),f=!0),ow(a,vw,t,n,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(e,n){t(e,n)&&i.point(e,n)}function p(t,e){l.point(t,e)}function m(){d.point=p,l.lineStart()}function g(){d.point=h,l.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,n,r,l=c.clean(),d=u.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&l){if((e=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else h>1&&2&l&&d.push(d.pop().concat(d.shift())),a.push(d.filter(yw))}return d}}function yw(t){return t.length>1}function vw(t,e){return((t=t.x)[0]<0?t[1]-Dx-Mx:Dx-t[1])-((e=e.x)[0]<0?e[1]-Dx-Mx:Dx-e[1])}const bw=gw((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?Sx:-Sx,l=zx(o-n);zx(l-Sx)<Mx?(t.point(n,r=(r+a)/2>0?Dx:-Dx),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&l>=Sx&&(zx(n-i)<Mx&&(n-=i*Mx),zx(o-s)<Mx&&(o-=s*Mx),r=function(t,e,n,r){var i,o,a=Wx(t-n);return zx(a)>Mx?Rx((Wx(e)*(o=Bx(r))*Wx(n)-Wx(r)*(i=Bx(e))*Wx(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*Dx,r.point(-Sx,i),r.point(0,i),r.point(Sx,i),r.point(Sx,0),r.point(Sx,-i),r.point(0,-i),r.point(-Sx,-i),r.point(-Sx,0),r.point(-Sx,i);else if(zx(t[0]-e[0])>Mx){var o=t[0]<e[0]?Sx:-Sx;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-Sx,-Dx]);function xw(t,e){(e=lw(e))[0]-=t,hw(e);var n=Yx(-e[1]);return((-e[2]<0?-n:n)+Tx-Mx)%Tx}var _w=1e9,ww=-_w;function kw(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return zx(r[0]-t)<Mx?i>0?0:3:zx(r[0]-n)<Mx?i>0?2:1:zx(r[1]-e)<Mx?i>0?1:0:i>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var l,u,c,f,d,h,p,m,g,y,v,b=a,x=nw(),_={point:w,lineStart:function(){_.point=k,u&&u.push(c=[]),y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(k(f,d),h&&g&&x.rejoin(),l.push(x.result())),_.point=w,g&&b.lineEnd()},polygonStart:function(){b=x,l=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],l=1,c=s.length,f=s[0],d=f[0],h=f[1];l<c;++l)o=d,a=h,d=(f=s[l])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(t-o)&&++e:h<=r&&(d-o)*(r-a)<(h-a)*(t-o)&&--e;return e}(),n=v&&e,i=(l=mw(l)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&ow(l,s,e,o,a),a.polygonEnd()),b=a,l=u=c=null}};function w(t,e){i(t,e)&&b.point(t,e)}function k(o,a){var s=i(o,a);if(u&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var l=[p=Math.max(ww,Math.min(_w,p)),m=Math.max(ww,Math.min(_w,m))],x=[o=Math.max(ww,Math.min(_w,o)),a=Math.max(ww,Math.min(_w,a))];!function(t,e,n,r,i,o){var a,s=t[0],l=t[1],u=0,c=1,f=e[0]-s,d=e[1]-l;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(t[0]=s+u*f,t[1]=l+u*d),c<1&&(e[0]=s+c*f,e[1]=l+c*d),!0}}}}}(l,x,t,e,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(l[0],l[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return _}}function Aw(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Ew(t,e){return zx(t)>Sx&&(t-=Math.round(t/Tx)*Tx),[t,e]}function Mw(t,e,n){return(t%=Tx)?e||n?Aw(Sw(t),Dw(e,n)):Sw(t):e||n?Dw(e,n):Ew}function Cw(t){return function(e,n){return zx(e+=t)>Sx&&(e-=Math.round(e/Tx)*Tx),[e,n]}}function Sw(t){var e=Cw(t);return e.invert=Cw(-t),e}function Dw(t,e){var n=Bx(t),r=Wx(t),i=Bx(e),o=Wx(e);function a(t,e){var a=Bx(e),s=Bx(t)*a,l=Wx(t)*a,u=Wx(e),c=u*n+s*r;return[Px(l*i-c*o,s*n-u*r),Vx(c*i+l*o)]}return a.invert=function(t,e){var a=Bx(e),s=Bx(t)*a,l=Wx(t)*a,u=Wx(e),c=u*i-l*o;return[Px(l*i+u*o,s*n+c*r),Vx(c*n-s*r)]},a}function Fw(t){return function(e){var n=new Tw;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Tw(){}function Nw(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Ax(n,t.stream(h_)),e(h_.result()),null!=r&&t.clipExtent(r),t}function Ow(t,e,n){return Nw(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function zw(t,e,n){return Ow(t,[[0,0],e],n)}function Rw(t,e,n){return Nw(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function Pw(t,e,n){return Nw(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}Ew.invert=Ew,Tw.prototype={constructor:Tw,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Bw=16,Lw=Bx(30*Ox);function jw(t,e){return+e?function(t,e){function n(r,i,o,a,s,l,u,c,f,d,h,p,m,g){var y=u-r,v=c-i,b=y*y+v*v;if(b>4*e&&m--){var x=a+d,_=s+h,w=l+p,k=Hx(x*x+_*_+w*w),A=Vx(w/=k),E=zx(zx(w)-1)<Mx||zx(o-f)<Mx?(o+f)/2:Px(_,x),M=t(E,A),C=M[0],S=M[1],D=C-r,F=S-i,T=v*D-y*F;(T*T/b>e||zx((y*D+v*F)/b-.5)>.3||a*d+s*h+l*p<Lw)&&(n(r,i,o,a,s,l,C,S,E,x/=k,_/=k,w,m,g),g.point(C,S),n(C,S,E,x,_,w,u,c,f,d,h,p,m,g))}}return function(e){var r,i,o,a,s,l,u,c,f,d,h,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,m.point=v,e.lineStart()}function v(r,i){var o=lw([r,i]),a=t(r,i);n(c,f,u,d,h,p,c=a[0],f=a[1],u=r,d=o[0],h=o[1],p=o[2],Bw,e),e.point(c,f)}function b(){m.point=g,e.lineEnd()}function x(){y(),m.point=_,m.lineEnd=w}function _(t,e){v(r=t,e),i=c,o=f,a=d,s=h,l=p,m.point=v}function w(){n(c,f,u,d,h,p,i,o,r,a,s,l,Bw,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return Fw({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var Uw=Fw({point:function(t,e){this.stream.point(t*Ox,e*Ox)}});function qw(t,e,n,r,i,o){if(!o)return function(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}(t,e,n,r,i);var a=Bx(o),s=Wx(o),l=a*t,u=s*t,c=a/t,f=s/t,d=(s*n-a*e)/t,h=(s*e+a*n)/t;function p(t,o){return[l*(t*=r)-u*(o*=i)+e,n-u*t-l*o]}return p.invert=function(t,e){return[r*(c*t-f*e+d),i*(h-f*t-c*e)]},p}function Iw(t){return Ww((function(){return t}))()}function Ww(t){var e,n,r,i,o,a,s,l,u,c,f=150,d=480,h=250,p=0,m=0,g=0,y=0,v=0,b=0,x=1,_=1,w=null,k=bw,A=null,E=vx,M=.5;function C(t){return l(t[0]*Ox,t[1]*Ox)}function S(t){return(t=l.invert(t[0],t[1]))&&[t[0]*Nx,t[1]*Nx]}function D(){var t=qw(f,0,0,x,_,b).apply(null,e(p,m)),r=qw(f,d-t[0],h-t[1],x,_,b);return n=Mw(g,y,v),s=Aw(e,r),l=Aw(n,s),a=jw(s,M),F()}function F(){return u=c=null,C}return C.stream=function(t){return u&&c===t?u:u=Uw(function(t){return Fw({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(E(c=t)))))},C.preclip=function(t){return arguments.length?(k=t,w=void 0,F()):k},C.postclip=function(t){return arguments.length?(E=t,A=r=i=o=null,F()):E},C.clipAngle=function(t){return arguments.length?(k=+t?function(t){var e=Bx(t),n=6*Ox,r=e>0,i=zx(e)>Mx;function o(t,n){return Bx(t)*Bx(n)>e}function a(t,n,r){var i=[1,0,0],o=cw(lw(t),lw(n)),a=uw(o,o),s=o[0],l=a-s*s;if(!l)return!r&&t;var u=e*a/l,c=-e*s/l,f=cw(i,o),d=dw(i,u);fw(d,dw(o,c));var h=f,p=uw(d,h),m=uw(h,h),g=p*p-m*(uw(d,d)-1);if(!(g<0)){var y=Hx(g),v=dw(h,(-p-y)/m);if(fw(v,d),v=sw(v),!r)return v;var b,x=t[0],_=n[0],w=t[1],k=n[1];_<x&&(b=x,x=_,_=b);var A=_-x,E=zx(A-Sx)<Mx;if(!E&&k<w&&(b=w,w=k,k=b),E||A<Mx?E?w+k>0^v[1]<(zx(v[0]-x)<Mx?w:k):w<=v[1]&&v[1]<=k:A>Sx^(x<=v[0]&&v[0]<=_)){var M=dw(h,(-p+y)/m);return fw(M,d),[v,sw(M)]}}}function s(e,n){var i=r?t:Sx-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return gw(o,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,d){var h,p=[f,d],m=o(f,d),g=r?m?0:s(f,d):m?s(f+(f<0?Sx:-Sx),d):0;if(!e&&(u=l=m)&&t.lineStart(),m!==l&&(!(h=a(e,p))||rw(e,h)||rw(p,h))&&(p[2]=1),m!==l)c=0,m?(t.lineStart(),h=a(p,e),t.point(h[0],h[1])):(h=a(e,p),t.point(h[0],h[1],2),t.lineEnd()),e=h;else if(i&&e&&r^m){var y;g&n||!(y=a(p,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!m||e&&rw(e,p)||t.point(p[0],p[1]),e=p,l=m,n=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,r,i,o){!function(t,e,n,r,i,o){if(n){var a=Bx(e),s=Wx(e),l=r*n;null==i?(i=e+r*Tx,o=e-l/2):(i=xw(a,i),o=xw(a,o),(r>0?i<o:i>o)&&(i+=r*Tx));for(var u,c=i;r>0?c>o:c<o;c-=l)u=sw([a,-s*Bx(c),-s*Wx(c)]),t.point(u[0],u[1])}}(o,t,n,i,e,r)}),r?[0,-t]:[-Sx,t-Sx])}(w=t*Ox):(w=null,bw),F()):w*Nx},C.clipExtent=function(t){return arguments.length?(E=null==t?(A=r=i=o=null,vx):kw(A=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),F()):null==A?null:[[A,r],[i,o]]},C.scale=function(t){return arguments.length?(f=+t,D()):f},C.translate=function(t){return arguments.length?(d=+t[0],h=+t[1],D()):[d,h]},C.center=function(t){return arguments.length?(p=t[0]%360*Ox,m=t[1]%360*Ox,D()):[p*Nx,m*Nx]},C.rotate=function(t){return arguments.length?(g=t[0]%360*Ox,y=t[1]%360*Ox,v=t.length>2?t[2]%360*Ox:0,D()):[g*Nx,y*Nx,v*Nx]},C.angle=function(t){return arguments.length?(b=t%360*Ox,D()):b*Nx},C.reflectX=function(t){return arguments.length?(x=t?-1:1,D()):x<0},C.reflectY=function(t){return arguments.length?(_=t?-1:1,D()):_<0},C.precision=function(t){return arguments.length?(a=jw(s,M=t*t),F()):Hx(M)},C.fitExtent=function(t,e){return Ow(C,t,e)},C.fitSize=function(t,e){return zw(C,t,e)},C.fitWidth=function(t,e){return Rw(C,t,e)},C.fitHeight=function(t,e){return Pw(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&S,D()}}function $w(t){var e=0,n=Sx/3,r=Ww(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*Ox,n=t[1]*Ox):[e*Nx,n*Nx]},i}function Hw(t,e){var n=Wx(t),r=(n+Wx(e))/2;if(zx(r)<Mx)return function(t){var e=Bx(t);function n(t,n){return[t*e,Wx(n)/e]}return n.invert=function(t,n){return[t/e,Vx(n*e)]},n}(t);var i=1+n*(2*r-n),o=Hx(i)/r;function a(t,e){var n=Hx(i-2*r*Wx(e))/r;return[n*Wx(t*=r),o-n*Bx(t)]}return a.invert=function(t,e){var n=o-e,a=Px(t,zx(n))*$x(n);return n*r<0&&(a-=Sx*$x(t)*$x(n)),[a/r,Vx((i-(t*t+n*n)*r*r)/(2*r))]},a}function Zw(){return $w(Hw).scale(155.424).center([0,33.6442])}function Yw(){return Zw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Vw(t){return function(e,n){var r=Bx(e),i=Bx(n),o=t(r*i);return o===1/0?[2,0]:[o*i*Wx(e),o*Wx(n)]}}function Gw(t){return function(e,n){var r=Hx(e*e+n*n),i=t(r),o=Wx(i),a=Bx(i);return[Px(e*o,r*a),Vx(r&&n*o/r)]}}var Xw=Vw((function(t){return Hx(2/(1+t))}));Xw.invert=Gw((function(t){return 2*Vx(t/2)}));var Qw=Vw((function(t){return(t=Yx(t))&&t/Wx(t)}));function Jw(t,e){return[t,qx(Zx((Dx+e)/2))]}function Kw(t){var e,n,r,i=Iw(t),o=i.center,a=i.scale,s=i.translate,l=i.clipExtent,u=null;function c(){var o=Sx*a(),s=i(function(t){function e(e){return(e=t(e[0]*Ox,e[1]*Ox))[0]*=Nx,e[1]*=Nx,e}return t=Mw(t[0]*Ox,t[1]*Ox,t.length>2?t[2]*Ox:0),e.invert=function(e){return(e=t.invert(e[0]*Ox,e[1]*Ox))[0]*=Nx,e[1]*=Nx,e},e}(i.rotate()).invert([0,0]));return l(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===Jw?[[Math.max(s[0]-o,u),e],[Math.min(s[0]+o,n),r]]:[[u,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),c()):a()},i.translate=function(t){return arguments.length?(s(t),c()):s()},i.center=function(t){return arguments.length?(o(t),c()):o()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),c()):null==u?null:[[u,e],[n,r]]},c()}function tk(t){return Zx((Dx+t)/2)}function ek(t,e){var n=Bx(t),r=t===e?Wx(t):qx(n/Bx(e))/qx(tk(e)/tk(t)),i=n*Ix(tk(t),r)/r;if(!r)return Jw;function o(t,e){i>0?e<-Dx+Mx&&(e=-Dx+Mx):e>Dx-Mx&&(e=Dx-Mx);var n=i/Ix(tk(e),r);return[n*Wx(r*t),i-n*Bx(r*t)]}return o.invert=function(t,e){var n=i-e,o=$x(r)*Hx(t*t+n*n),a=Px(t,zx(n))*$x(n);return n*r<0&&(a-=Sx*$x(t)*$x(n)),[a/r,2*Rx(Ix(i/o,1/r))-Dx]},o}function nk(t,e){return[t,e]}function rk(t,e){var n=Bx(t),r=t===e?Wx(t):(n-Bx(e))/(e-t),i=n/r+t;if(zx(r)<Mx)return nk;function o(t,e){var n=i-e,o=r*t;return[n*Wx(o),i-n*Bx(o)]}return o.invert=function(t,e){var n=i-e,o=Px(t,zx(n))*$x(n);return n*r<0&&(o-=Sx*$x(t)*$x(n)),[o/r,i-$x(r)*Hx(t*t+n*n)]},o}Qw.invert=Gw((function(t){return t})),Jw.invert=function(t,e){return[t,2*Rx(jx(e))-Dx]},nk.invert=nk;var ik=1.340264,ok=-.081106,ak=893e-6,sk=.003796,lk=Hx(3)/2;function uk(t,e){var n=Vx(lk*Wx(e)),r=n*n,i=r*r*r;return[t*Bx(n)/(lk*(ik+3*ok*r+i*(7*ak+9*sk*r))),n*(ik+ok*r+i*(ak+sk*r))]}function ck(t,e){var n=Bx(e),r=Bx(t)*n;return[n*Wx(t)/r,Wx(e)/r]}function fk(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function dk(t,e){return[Bx(e)*Wx(t),Wx(e)]}function hk(t,e){var n=Bx(e),r=1+Bx(t)*n;return[n*Wx(t)/r,Wx(e)/r]}function pk(t,e){return[qx(Zx((Dx+e)/2)),-t]}uk.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(ik+ok*i+o*(ak+sk*i))-e)/(ik+3*ok*i+o*(7*ak+9*sk*i)))*r)*i*i,!(zx(n)<Cx));++a);return[lk*t*(ik+3*ok*i+o*(7*ak+9*sk*i))/Bx(r),Vx(Wx(r)/lk)]},ck.invert=Gw(Rx),fk.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(zx(n)>Mx&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},dk.invert=Gw(Vx),hk.invert=Gw((function(t){return 2*Rx(t)})),pk.invert=function(t,e){return[-e,2*Rx(jx(t))-Dx]};var mk=Math.abs,gk=(Math.atan,Math.atan2,Math.ceil,Math.cos),yk=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),vk=(Math.tan,1e-6),bk=Math.PI,xk=bk/2,_k=(Math.SQRT1_2,kk(2));function wk(t){return t>1?xk:t<-1?-xk:Math.asin(t)}function kk(t){return t>0?Math.sqrt(t):0}function Ak(t,e){var n,r=t*yk(e),i=30;do{e-=n=(e+yk(e)-r)/(1+gk(e))}while(mk(n)>vk&&--i>0);return e/2}kk(bk);var Ek=function(t,e,n){function r(r,i){return[t*r*gk(i=Ak(n,i)),e*yk(i)]}return r.invert=function(r,i){return i=wk(i/e),[r/(t*gk(i)),wk((2*i+yk(2*i))/n)]},r}(_k/xk,_k,bk);const Mk=ew(),Ck=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Sk(t,e){if(!t||"string"!=typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(Fk[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=ew().projection(r),r.copy=r.copy||function(){const t=n();return Ck.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},Eh(r)}}(t,e),this):Fk[t]||null}function Dk(t){return t&&t.path||Mk}const Fk={albers:Yw,albersusa:function(){var t,e,n,r,i,o,a=Yw(),s=Zw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Zw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){o=[t,e]}};function c(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function f(){return t=e=null,c}return c.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:a).invert(t)},c.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),s.stream(n),l.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},c.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),l.precision(t),f()):a.precision()},c.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),l.scale(t),c.translate(a.translate())):a.scale()},c.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],c=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,c-.238*e],[o+.455*e,c+.238*e]]).stream(u),r=s.translate([o-.307*e,c+.201*e]).clipExtent([[o-.425*e+Mx,c+.12*e+Mx],[o-.214*e-Mx,c+.234*e-Mx]]).stream(u),i=l.translate([o-.205*e,c+.212*e]).clipExtent([[o-.214*e+Mx,c+.166*e+Mx],[o-.115*e-Mx,c+.234*e-Mx]]).stream(u),f()},c.fitExtent=function(t,e){return Ow(c,t,e)},c.fitSize=function(t,e){return zw(c,t,e)},c.fitWidth=function(t,e){return Rw(c,t,e)},c.fitHeight=function(t,e){return Pw(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return Iw(Xw).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Iw(Qw).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return $w(ek).scale(109.5).parallels([30,30])},conicequalarea:Zw,conicequidistant:function(){return $w(rk).scale(131.154).center([0,13.9389])},equalEarth:function(){return Iw(uk).scale(177.158)},equirectangular:function(){return Iw(nk).scale(152.63)},gnomonic:function(){return Iw(ck).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,o,a,s=1,l=0,u=0,c=1,f=1,d=0,h=null,p=1,m=1,g=Fw({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=vx;function v(){return p=s*c,m=s*f,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+l,i+u]}return b.invert=function(n){var r=n[0]-l,i=n[1]-u;if(d){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/m]},b.stream=function(t){return o&&a===t?o:o=g(y(a=t))},b.postclip=function(t){return arguments.length?(y=t,h=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(h=n=r=i=null,vx):kw(h=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==h?null:[[h,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],v()):[l,u]},b.angle=function(n){return arguments.length?(e=Wx(d=n%360*Ox),t=Bx(d),v()):d*Nx},b.reflectX=function(t){return arguments.length?(c=t?-1:1,v()):c<0},b.reflectY=function(t){return arguments.length?(f=t?-1:1,v()):f<0},b.fitExtent=function(t,e){return Ow(b,t,e)},b.fitSize=function(t,e){return zw(b,t,e)},b.fitWidth=function(t,e){return Rw(b,t,e)},b.fitHeight=function(t,e){return Pw(b,t,e)},b},mercator:function(){return Kw(Jw).scale(961/Tx)},mollweide:function(){return Iw(Ek).scale(169.529)},naturalEarth1:function(){return Iw(fk).scale(175.295)},orthographic:function(){return Iw(dk).scale(249.5).clipAngle(90+Mx)},stereographic:function(){return Iw(hk).scale(250).clipAngle(142)},transversemercator:function(){var t=Kw(pk),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const n in Fk)Sk(n,Fk[n]);function Tk(t,e,n){var r=is(t,e-Mx,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Nk(t,e,n){var r=is(t,e-Mx,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Ok(){}const zk=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Rk(){var t=1,e=1,n=a;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,l,u,c,f,d=new Array,h=new Array;for(a=s=-1,u=n[0]>=r,zk[u<<1].forEach(p);++a<t-1;)l=u,u=n[a+1]>=r,zk[l|u<<1].forEach(p);for(zk[u<<0].forEach(p);++s<e-1;){for(a=-1,u=n[s*t+t]>=r,c=n[s*t]>=r,zk[u<<1|c<<2].forEach(p);++a<t-1;)l=u,u=n[s*t+t+a+1]>=r,f=c,c=n[s*t+a+1]>=r,zk[l|u<<1|c<<2|f<<3].forEach(p);zk[u|c<<3].forEach(p)}for(a=-1,c=n[s*t]>=r,zk[c<<2].forEach(p);++a<t-1;)f=c,c=n[s*t+a+1]>=r,zk[c<<2|f<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+a,t[0][1]+s],l=[t[1][0]+a,t[1][1]+s],u=o(r),c=o(l);(e=h[u])?(n=d[c])?(delete h[e.end],delete d[n.start],e===n?(e.ring.push(l),i(e.ring)):d[e.start]=h[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[e.end],e.ring.push(l),h[e.end=c]=e):(e=d[c])?(n=h[u])?(delete d[e.start],delete h[n.end],e===n?(e.ring.push(l),i(e.ring)):d[n.start]=h[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=u]=e):d[u]=h[c]={start:u,end:c,ring:[r,l]}}zk[c<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):s.push(t)})),s.forEach((t=>{for(var e,n=0,r=a.length;n<r;++n)if(-1!==Pk((e=a[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],l=0|a,u=0|s,c=r[u*t+l];a>0&&a<t&&l===a&&(o=r[u*t+l-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<e&&u===s&&(o=r[(u-1)*t+l],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||Rt("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?a:Ok,r):n===a},r}function Pk(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=Bk(t,e[r]))return n;return 0}function Bk(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var l=t[o],u=l[0],c=l[1],f=t[s],d=f[0],h=f[1];if(Lk(l,f,e))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function Lk(t,e,n){var r,i,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],a=e[r],i<=o&&o<=a||a<=o&&o<=i)}function jk(t,e,n){return function(r){var i=ke(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,l=e?dn(o,a,t):s/(t+1);return is(o+l,a,l)}}function Uk(t){ns.call(this,null,t)}function qk(t,e,n,r,i){const o=t.x1||0,a=t.y1||0,s=e*n<0;function l(t){t.forEach(u)}function u(t){s&&t.reverse(),t.forEach(c)}function c(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-a)*n+i}return function(t){return t.coordinates.forEach(l),t}}function Ik(t,e,n){const r=t>=0?t:G(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Wk(t){return he(t)?t:xe(+t)}function $k(){var t=t=>t[0],e=t=>t[1],n=qt,r=[-1,-1],i=960,o=500,a=2;function s(s,l){const u=Ik(r[0],s,t)>>a,c=Ik(r[1],s,e)>>a,f=u?u+2:0,d=c?c+2:0,h=2*f+(i>>a),p=2*d+(o>>a),m=new Float32Array(h*p),g=new Float32Array(h*p);let y=m;s.forEach((r=>{const i=f+(+t(r)>>a),o=d+(+e(r)>>a);i>=0&&i<h&&o>=0&&o<p&&(m[i+o*h]+=+n(r))})),u>0&&c>0?(Hk(h,p,m,g,u),Zk(h,p,g,m,c),Hk(h,p,m,g,u),Zk(h,p,g,m,c),Hk(h,p,m,g,u),Zk(h,p,g,m,c)):u>0?(Hk(h,p,m,g,u),Hk(h,p,g,m,u),Hk(h,p,m,g,u),y=g):c>0&&(Zk(h,p,m,g,c),Zk(h,p,g,m,c),Zk(h,p,m,g,c),y=g);const v=l?Math.pow(2,-2*a):1/qb(y);for(let t=0,e=h*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(i>>a),y2:d+(o>>a)}}return s.x=function(e){return arguments.length?(t=Wk(e),s):t},s.y=function(t){return arguments.length?(e=Wk(t),s):e},s.weight=function(t){return arguments.length?(n=Wk(t),s):n},s.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||Rt("invalid size"),i=e,o=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||Rt("invalid cell size"),a=Math.floor(Math.log(t)/Math.LN2),s):1<<a},s.bandwidth=function(t){return arguments.length?(1===(t=de(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&Rt("invalid bandwidth"),r=t,s):r},s}function Hk(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+a*t]),e>=i&&(e>=o&&(s-=n[e-o+a*t]),r[e-i+a*t]=s/Math.min(e+1,t-1+o-e,o))}function Zk(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let s=0,l=0;s<e+i;++s)s<e&&(l+=n[a+s*t]),s>=i&&(s>=o&&(l-=n[a+(s-o)*t]),r[a+(s-i)*t]=l/Math.min(s+1,e-1+o-s,o))}function Yk(t){ns.call(this,null,t)}Uk.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Se(Uk,ns,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||jt,o=Rk().smooth(!1!==t.smooth),a=t.thresholds||function(t,e,n){const r=jk(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>P(e(t).values))))}(r,i,t),s=null===t.as?null:t.as||"contour",l=[];return r.forEach((e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,Qt(a)?a:a(n.values));!function(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;if(he(i)&&(i=i(n,r)),he(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const a=(Ne(i)?i:i[0])||1,s=(Ne(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;t.forEach(qk(e,a,s,l,u))}(r,n,e,t),r.forEach((t=>{l.push(Sa(e,Ma(null!=s?{[s]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),Yk.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Vk=["x","y","weight","size","cellSize","bandwidth"];function Gk(t,e){return Vk.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function Xk(t){ns.call(this,null,t)}Se(Yk,ns,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,o,a,s,l=[],u=t=>t(o);if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}(e.materialize(e.SOURCE).source,t.groupby),o=(t.groupby||[]).map(Ft),a=Gk($k(),t),s=t.as||"grid";return n=i.map((e=>Ma(function(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}({[s]:a(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),Xk.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Se(Xk,ns,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=Rk().smooth(!1!==t.smooth),a=t.values,s=t.thresholds||jk(t.count||10,t.nice,!!a),l=t.size;return a||(a=e.materialize(e.SOURCE).source,r=qk(n=Gk($k(),t)(a,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],a=n.values),s=Qt(s)?s:s(a),a=o.size(l)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(Ma),i}});const Qk="Feature",Jk="FeatureCollection";function Kk(t){ns.call(this,null,t)}function tA(t){ns.call(this,null,t)}function eA(t){ns.call(this,null,t)}function nA(t){ns.call(this,null,t)}function rA(t){ns.call(this,[],t),this.generator=function(){var t,e,n,r,i,o,a,s,l,u,c,f,d=10,h=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return is(Lx(r/p)*p,n,p).map(c).concat(is(Lx(s/m)*m,a,m).map(f)).concat(is(Lx(e/d)*d,t,d).filter((function(t){return zx(t%p)>Mx})).map(l)).concat(is(Lx(o/h)*h,i,h).filter((function(t){return zx(t%m)>Mx})).map(u))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],y):[p,m]},y.stepMinor=function(t){return arguments.length?(d=+t[0],h=+t[1],y):[d,h]},y.precision=function(d){return arguments.length?(g=+d,l=Tk(o,i,90),u=Nk(e,t,g),c=Tk(s,a,90),f=Nk(r,n,g),y):g},y.extentMajor([[-180,-90+Mx],[180,90-Mx]]).extentMinor([[-180,-80-Mx],[180,80+Mx]])}()}function iA(t){ns.call(this,null,t)}function oA(t){if(!he(t))return!1;const e=Ie(Tt(t));return e.$x||e.$y||e.$value||e.$max}function aA(t){ns.call(this,null,t),this.modified(!0)}function sA(t,e,n){he(t[e])&&t[e](n)}function lA(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,l,u,c,f,d,h=t._root,p={data:r},m=t._x0,g=t._y0,y=t._x1,v=t._y1;if(!h)return t._root=p,t;for(;h.length;)if((u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=h,!(h=h[f=c<<1|u]))return i[f]=p,t;if(s=+t._x.call(null,h.data),l=+t._y.call(null,h.data),e===s&&n===l)return p.next=h,i?i[f]=p:t._root=p,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|u)==(d=(l>=a)<<1|s>=o));return i[d]=h,i[f]=p,t}function uA(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function cA(t){return t[0]}function fA(t){return t[1]}function dA(t,e,n){var r=new hA(null==e?cA:e,null==n?fA:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function hA(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function pA(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}Kk.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Se(Kk,ns,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,a=o&&o[0],s=o&&o[1],l=t.geojson||!o&&jt,u=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(Tt(l))||a&&e.modified(Tt(a))||s&&e.modified(Tt(s)),this.value&&!n||(u=e.SOURCE,this._features=r=[],this._points=i=[]),l&&e.visit(u,(t=>r.push(l(t)))),a&&s&&(e.visit(u,(t=>{var e=a(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:Qk,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:Jk,features:r}}}),tA.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Se(tA,ns,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||jt,o=t.as||"path",a=n.SOURCE;!r||t.modified()?(this.value=r=Dk(t.projection),n.materialize().reflow()):a=i===jt||e.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(t,e){const n=t.pointRadius();return t.context(null),null!=e&&t.pointRadius(e),n}(r,t.pointRadius);return n.visit(a,(t=>t[o]=r(i(t)))),r.pointRadius(s),n.modifies(o)}}),eA.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Se(eA,ns,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],a=t.as||["x","y"],s=a[0],l=a[1];function u(t){const e=r([i(t),o(t)]);e?(t[s]=e[0],t[l]=e[1]):(t[s]=void 0,t[l]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,u):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,u)),e.modifies(a)}}),nA.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Se(nA,ns,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>(t.context(e),r),r}(Dk(t.projection),t.field||Bt("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(t=>t[i]=r)),n.modifies(i)}}),rA.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Se(rA,ns,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const o in t)he(i[o])&&i[o](t[o]);return n=i(),r.length?e.mod.push(Da(r[0],n)):e.add.push(Ma(n)),r[0]=n,e}}),iA.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Se(iA,ns,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||jt,o=function(t,e){let n;return he(t)?(n=n=>t(n,e),n.dep=oA(t)):t?n=xe(t):(n=t=>t.$value/t.$max||0,n.dep=!0),n}(t.opacity,t),a=function(t,e){let n;return he(t)?(n=n=>yc(t(n,e)),n.dep=oA(t)):n=xe(yc(t||"#888")),n}(t.color,t),s=t.as||"image",l={$x:0,$y:0,$value:0,$max:r?P(n.map((t=>P(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=we({},t,l);r||(n.$max=P(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,o=t.height,a=t.x1||0,s=t.y1||0,l=t.x2||i,u=t.y2||o,c=t.values,f=c?t=>c[t]:Ut,d=$u(l-a,u-s),h=d.getContext("2d"),p=h.getImageData(0,0,l-a,u-s),m=p.data;for(let g=s,y=0;g<u;++g){e.$y=g-s;for(let t=a,o=g*i;t<l;++t,y+=4){e.$x=t-a,e.$value=f(t+o);const i=n(e);m[y+0]=i.r,m[y+1]=i.g,m[y+2]=i.b,m[y+3]=~~(255*r(e))}}return h.putImageData(p,0,0),d}(e,n,a.dep?a:xe(a(n)),o.dep?o:xe(o(n)))})),e.reflow(!0).modifies(s)}}),Se(aA,ns,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=Sk((t||"mercator").toLowerCase());return e||Rt("Unrecognized projection type: "+t),e()}(t.type),Ck.forEach((e=>{null!=t[e]&&sA(n,e,t[e])}))):Ck.forEach((e=>{t.modified(e)&&sA(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return 1===(t=de(t)).length?t[0]:{type:Jk,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===Jk?t.features:de(t).filter((t=>null!=t)).map((t=>t.type===Qk?t:{type:Qk,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var mA=dA.prototype=hA.prototype;function gA(t){return function(){return t}}function yA(t){return 1e-6*(t()-.5)}function vA(t){return t.x+t.vx}function bA(t){return t.y+t.vy}mA.copy=function(){var t,e,n=new hA(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=pA(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=pA(e));return n},mA.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return lA(this.cover(e,n),e,n,t)},mA.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>f&&(f=i));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<o;++n)lA(this,a[n],s[n],t[n]);return this},mA.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,l=i-n||1,u=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},mA.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},mA.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},mA.find=function(t,e,n){var r,i,o,a,s,l,u,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new uA(m,c,f,d,h)),null==n?n=1/0:(c=t-n,f=e-n,d=t+n,h=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(o=l.y0)>h||(a=l.x1)<c||(s=l.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new uA(m[3],g,y,a,s),new uA(m[2],i,y,g,s),new uA(m[1],g,o,a,y),new uA(m[0],i,o,g,y)),(u=(e>=y)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var v=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=v*v+b*b;if(x<n){var _=Math.sqrt(n=x);c=t-_,f=e-_,d=t+_,h=e+_,r=m.data}}return r},mA.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,l,u,c,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((u=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(l=(m+y)/2))?m=l:y=l,e=h,!(h=h[f=c<<1|u]))return this;if(!h.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,d=f)}for(;h.data!==t;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(h=e[0]||e[1]||e[2]||e[3])&&h===(e[3]||e[2]||e[1]||e[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},mA.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},mA.root=function(){return this._root},mA.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},mA.visit=function(t){var e,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new uA(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&l.length){var u=(r+o)/2,c=(i+a)/2;(n=l[3])&&s.push(new uA(n,u,c,o,a)),(n=l[2])&&s.push(new uA(n,r,c,u,a)),(n=l[1])&&s.push(new uA(n,u,i,o,c)),(n=l[0])&&s.push(new uA(n,r,i,u,c))}return this},mA.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new uA(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(a+l)/2,f=(s+u)/2;(o=i[0])&&n.push(new uA(o,a,s,c,f)),(o=i[1])&&n.push(new uA(o,c,s,l,f)),(o=i[2])&&n.push(new uA(o,a,f,c,u)),(o=i[3])&&n.push(new uA(o,c,f,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},mA.x=function(t){return arguments.length?(this._x=t,this):this._x},mA.y=function(t){return arguments.length?(this._y=t,this):this._y};var xA={value:()=>{}};function _A(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new wA(r)}function wA(t){this._=t}function kA(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function AA(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=xA,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}wA.prototype=_A.prototype={constructor:wA,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(n=(t=o[a]).type)i[n]=AA(i[n],t.name,e);else if(null==e)for(n in i)i[n]=AA(i[n],t.name,null);return this}for(;++a<s;)if((n=(t=o[a]).type)&&(n=kA(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new wA(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const EA=_A;var MA,CA,SA=0,DA=0,FA=0,TA=1e3,NA=0,OA=0,zA=0,RA="object"==typeof performance&&performance.now?performance:Date,PA="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function BA(){return OA||(PA(LA),OA=RA.now()+zA)}function LA(){OA=0}function jA(){this._call=this._time=this._next=null}function UA(t,e,n){var r=new jA;return r.restart(t,e,n),r}function qA(){OA=(NA=RA.now())+zA,SA=DA=0;try{!function(){BA(),++SA;for(var t,e=MA;e;)(t=OA-e._time)>=0&&e._call.call(void 0,t),e=e._next;--SA}()}finally{SA=0,function(){for(var t,e,n=MA,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:MA=e);CA=t,WA(r)}(),OA=0}}function IA(){var t=RA.now(),e=t-NA;e>TA&&(zA-=e,NA=t)}function WA(t){SA||(DA&&(DA=clearTimeout(DA)),t-OA>24?(t<1/0&&(DA=setTimeout(qA,t-RA.now()-zA)),FA&&(FA=clearInterval(FA))):(FA||(NA=RA.now(),FA=setInterval(IA,TA)),SA=1,PA(qA)))}jA.prototype=UA.prototype={constructor:jA,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?BA():+n)+(null==e?0:+e),this._next||CA===this||(CA?CA._next=this:MA=this,CA=this),this._call=t,this._time=n,WA()},stop:function(){this._call&&(this._call=null,this._time=1/0,WA())}};const $A=4294967296;function HA(t){return t.x}function ZA(t){return t.y}var YA=Math.PI*(3-Math.sqrt(5));function VA(t){return t.index}function GA(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const XA={center:function(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,l=0;for(i=0;i<a;++i)s+=(o=n[i]).x,l+=o.y;for(s=(s/a-t)*r,l=(l/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=l}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,o=1;function a(){for(var t,a,l,u,c,f,d,h=e.length,p=0;p<o;++p)for(a=dA(e,vA,bA).visitAfter(s),t=0;t<h;++t)l=e[t],f=n[l.index],d=f*f,u=l.x+l.vx,c=l.y+l.vy,a.visit(m);function m(t,e,n,o,a){var s=t.data,h=t.r,p=f+h;if(!s)return e>u+p||o<u-p||n>c+p||a<c-p;if(s.index>l.index){var m=u-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=yA(r))*m),0===g&&(y+=(g=yA(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,l.vx+=(m*=y)*(p=(h*=h)/(d+h)),l.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=gA(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,l()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:gA(+e),l(),a):t},a},nbody:function(){var t,e,n,r,i,o=gA(-30),a=1,s=1/0,l=.81;function u(n){var i,o=t.length,a=dA(t,HA,ZA).visitAfter(f);for(r=n,i=0;i<o;++i)e=t[i],a.visit(d)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function f(t){var e,n,r,o,a,s=0,l=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,l+=n,r+=n*e.x,o+=n*e.y);t.x=r/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,o,u,c){if(!t.value)return!0;var f=t.x-e.x,d=t.y-e.y,h=c-o,p=f*f+d*d;if(h*h/l<p)return p<s&&(0===f&&(p+=(f=yA(n))*f),0===d&&(p+=(d=yA(n))*d),p<a&&(p=Math.sqrt(a*p)),e.vx+=f*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===f&&(p+=(f=yA(n))*f),0===d&&(p+=(d=yA(n))*d),p<a&&(p=Math.sqrt(a*p)));do{t.data!==e&&(h=i[t.data.index]*r/p,e.vx+=f*h,e.vy+=d*h)}while(t=t.next)}}return u.initialize=function(e,r){t=e,n=r,c()},u.strength=function(t){return arguments.length?(o="function"==typeof t?t:gA(+t),c(),u):o},u.distanceMin=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u},link:function(t){var e,n,r,i,o,a,s=VA,l=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=gA(30),c=1;function f(r){for(var i=0,s=t.length;i<c;++i)for(var l,u,f,d,h,p,m,g=0;g<s;++g)u=(l=t[g]).source,d=(f=l.target).x+f.vx-u.x-u.vx||yA(a),h=f.y+f.vy-u.y-u.vy||yA(a),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*e[g],h*=p,f.vx-=d*(m=o[g]),f.vy-=h*m,u.vx+=d*(m=1-m),u.vy+=h*m}function d(){if(r){var a,l,u=r.length,c=t.length,f=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(a=0,i=new Array(u);a<c;++a)(l=t[a]).index=a,"object"!=typeof l.source&&(l.source=GA(f,l.source)),"object"!=typeof l.target&&(l.target=GA(f,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)l=t[a],o[a]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);e=new Array(c),h(),n=new Array(c),p()}}function h(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+l(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,a=e,d()},f.links=function(e){return arguments.length?(t=e,d(),f):t},f.id=function(t){return arguments.length?(s=t,f):s},f.iterations=function(t){return arguments.length?(c=+t,f):c},f.strength=function(t){return arguments.length?(l="function"==typeof t?t:gA(+t),h(),f):l},f.distance=function(t){return arguments.length?(u="function"==typeof t?t:gA(+t),p(),f):u},f},x:function(t){var e,n,r,i=gA(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=gA(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:gA(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:gA(+e),a(),o):t},o},y:function(t){var e,n,r,i=gA(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=gA(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:gA(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:gA(+e),a(),o):t},o}},QA="forces",JA=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],KA=["static","iterations"],tE=["x","y","vx","vy"];function eE(t){ns.call(this,null,t)}function nE(t,e,n,r){var i,o,a,s,l=de(e.forces);for(i=0,o=JA.length;i<o;++i)(a=JA[i])!==QA&&e.modified(a)&&t[a](e[a]);for(i=0,o=l.length;i<o;++i)s=QA+i,(a=n||e.modified(QA,i)?iE(l[i]):r&&rE(l[i],r)?t.force(s):null)&&t.force(s,a);for(o=t.numForces||0;i<o;++i)t.force(QA+i,null);return t.numForces=l.length,t}function rE(t,e){var n,r;for(n in t)if(he(r=t[n])&&e.modified(Tt(r)))return 1;return 0}function iE(t){var e,n;for(n in Ee(XA,t.force)||Rt("Unrecognized force: "+t.force),e=XA[t.force](),t)he(e[n])&&oE(e[n],t[n],t);return e}function oE(t,e,n){t(he(e)?t=>e(t,n):e)}function aE(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function sE(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=uE)):void 0===e&&(e=lE);for(var n,r,i,o,a,s=new dE(t),l=[s];n=l.pop();)if((i=e(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)l.push(r=i[o]=new dE(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(fE)}function lE(t){return t.children}function uE(t){return Array.isArray(t)?t[1]:null}function cE(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function fE(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function dE(t){this.data=t,this.depth=this.height=0,this.parent=null}function hE(t){return null==t?null:pE(t)}function pE(t){if("function"!=typeof t)throw new Error;return t}function mE(){return 0}function gE(t){return function(){return t}}eE.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:tE}]},Se(eE,ns,{transform(t,e){var n,r,i=this.value,o=e.changed(e.ADD_REM),a=t.modified(JA),s=t.iterations||300;if(i?(o&&(e.modifies("index"),i.nodes(e.source)),(a||e.changed(e.MOD))&&nE(i,t,0,e)):(this.value=i=function(t,e){const n=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=UA(f),u=EA("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%$A)/$A}();function f(){d(),u.call("tick",e),n<r&&(l.stop(),u.call("end",e))}function d(r){var l,u,c=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),l=0;l<c;++l)null==(u=t[l]).fx?u.x+=u.vx*=a:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=a:(u.y=u.fy,u.vy=0);return e}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*YA;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),h(),e={tick:d,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(c=t,s.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,l,u=0,c=t.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(a=(i=e-(s=t[u]).x)*i+(o=n-s.y)*o)<r&&(l=s,r=a);return l},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),nE(n,e,!0).on("end",(()=>o=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(o=!0,i.tick()),e.modifies("index")),a||o||t.modified(KA)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let s,l=this._argops,u=0,c=l.length;u<c;++u)if(s=l[u],s.name===QA&&"link"===s.op._argval.force)for(var r,i=s.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(tE)}}),dE.prototype=sE.prototype={constructor:dE,count:function(){return this.eachAfter(aE)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(e,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return sE(this).eachBefore(cE)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};const yE=4294967296;function vE(t,e){var n,r;if(_E(e,t))return[e];for(n=0;n<t.length;++n)if(bE(e,t[n])&&_E(kE(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(bE(kE(t[n],t[r]),e)&&bE(kE(t[n],e),t[r])&&bE(kE(t[r],e),t[n])&&_E(AE(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function bE(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function xE(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function _E(t,e){for(var n=0;n<e.length;++n)if(!xE(t,e[n]))return!1;return!0}function wE(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return kE(t[0],t[1]);case 3:return AE(t[0],t[1],t[2])}var e}function kE(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,l=o-n,u=a-r,c=s-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+s)/2}}function AE(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,l=e.r,u=n.x,c=n.y,f=n.r,d=r-a,h=r-u,p=i-s,m=i-c,g=l-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+l*l,x=v-u*u-c*c+f*f,_=h*p-d*m,w=(p*x-m*b)/(2*_)-r,k=(m*g-p*y)/_,A=(h*b-d*x)/(2*_)-i,E=(d*y-h*g)/_,M=k*k+E*E-1,C=2*(o+w*k+A*E),S=w*w+A*A-o*o,D=-(Math.abs(M)>1e-6?(C+Math.sqrt(C*C-4*M*S))/(2*M):S/C);return{x:r+w+k*D,y:i+A+E*D,r:D}}function EE(t,e,n){var r,i,o,a,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(i=e.r+n.r,i*=i,a=t.r+n.r,i>(a*=a)?(r=(u+a-i)/(2*u),o=Math.sqrt(Math.max(0,a/u-r*r)),n.x=t.x-r*s-o*l,n.y=t.y-r*l+o*s):(r=(u+i-a)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*s-o*l,n.y=e.y+r*l+o*s)):(n.x=e.x+n.r,n.y=e.y)}function ME(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function CE(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function SE(t){this._=t,this.next=null,this.previous=null}function DE(t){return Math.sqrt(t.value)}function FE(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function TE(t,e,n){return function(r){if(i=r.children){var i,o,a,s=i.length,l=t(r)*e||0;if(l)for(o=0;o<s;++o)i[o].r+=l;if(a=function(t,e){if(!(o=(t=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,r,i,o,a,s,l,u,c,f,d;if((n=t[0]).x=0,n.y=0,!(o>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;EE(r,n,i=t[2]),n=new SE(n),r=new SE(r),i=new SE(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(l=3;l<o;++l){EE(n._,r._,i=t[l]),i=new SE(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(ME(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue t}f+=u._.r,u=u.next}else{if(ME(c._,i._)){(n=c).next=r,r.previous=n,--l;continue t}d+=c._.r,c=c.previous}}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=CE(n);(i=i.next)!==r;)(s=CE(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=function(t,e){for(var n,r,i=0,o=(t=function(t,e){let n,r,i=t.length;for(;i;)r=e()*i--|0,n=t[i],t[i]=t[r],t[r]=n;return t}(Array.from(t),e)).length,a=[];i<o;)n=t[i],r&&xE(r,n)?++i:(r=wE(a=vE(a,n)),i=0);return r}(n,e),l=0;l<o;++l)(n=t[l]).x-=i.x,n.y-=i.y;return i.r}(i,n),l)for(o=0;o<s;++o)i[o].r-=l;r.r=a+l}}}function NE(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function OE(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function zE(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(r-e)/t.value;++s<l;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*u}var RE={depth:-1},PE={},BE={};function LE(t){return t.id}function jE(t){return t.parentId}function UE(){var t,e=LE,n=jE;function r(r){var i,o,a,s,l,u,c,f,d=Array.from(r),h=e,p=n,m=new Map;if(null!=t){const e=d.map(((e,n)=>function(t){let e=(t="".concat(t)).length;return IE(t,e-1)&&!IE(t,e-2)&&(t=t.slice(0,-1)),"/"===t[0]?t:"/".concat(t)}(t(e,n,r)))),n=e.map(qE),i=new Set(e).add("");for(const t of n)i.has(t)||(i.add(t),e.push(t),n.push(qE(t)),d.push(BE));h=(t,n)=>e[n],p=(t,e)=>n[e]}for(a=0,i=d.length;a<i;++a)o=d[a],u=d[a]=new dE(o),null!=(c=h(o,a,r))&&(c+="")&&(f=u.id=c,m.set(f,m.has(f)?PE:u)),null!=(c=p(o,a,r))&&(c+="")&&(u.parent=c);for(a=0;a<i;++a)if(c=(u=d[a]).parent){if(!(l=m.get(c)))throw new Error("missing: "+c);if(l===PE)throw new Error("ambiguous: "+c);l.children?l.children.push(u):l.children=[u],u.parent=l}else{if(s)throw new Error("multiple roots");s=u}if(!s)throw new Error("no root");if(null!=t){for(;s.data===BE&&1===s.children.length;)s=s.children[0],--i;for(let t=d.length-1;t>=0&&(u=d[t]).data===BE;--t)u.data=null}if(s.parent=RE,s.eachBefore((function(t){t.depth=t.parent.depth+1,--i})).eachBefore(fE),s.parent=null,i>0)throw new Error("cycle");return s}return r.id=function(t){return arguments.length?(e=hE(t),r):e},r.parentId=function(t){return arguments.length?(n=hE(t),r):n},r.path=function(e){return arguments.length?(t=hE(e),r):t},r}function qE(t){let e=t.length;if(e<2)return"";for(;--e>1&&!IE(t,e););return t.slice(0,e)}function IE(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}function WE(t,e){return t.parent===e.parent?1:2}function $E(t){var e=t.children;return e?e[0]:t.t}function HE(t){var e=t.children;return e?e[e.length-1]:t.t}function ZE(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function YE(t,e,n){return t.a.parent===e.parent?t.a:n}function VE(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function GE(t,e){return t.parent===e.parent?1:2}function XE(t,e){return t+e.x}function QE(t,e){return Math.max(t,e.y)}function JE(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(i-n)/t.value;++s<l;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*u}VE.prototype=Object.create(dE.prototype);var KE=(1+Math.sqrt(5))/2;function tM(t,e,n,r,i,o){for(var a,s,l,u,c,f,d,h,p,m,g,y=[],v=e.children,b=0,x=0,_=v.length,w=e.value;b<_;){l=i-n,u=o-r;do{c=v[x++].value}while(!c&&x<_);for(f=d=c,g=c*c*(m=Math.max(u/l,l/u)/(w*t)),p=Math.max(d/g,g/f);x<_;++x){if(c+=s=v[x].value,s<f&&(f=s),s>d&&(d=s),g=c*c*m,(h=Math.max(d/g,g/f))>p){c-=s;break}p=h}y.push(a={value:c,dice:l<u,children:v.slice(b,x)}),a.dice?zE(a,n,r,i,w?r+=u*c/w:o):JE(a,n,r,w?n+=l*c/w:i,o),w-=c,b=x}return y}const eM=function t(e){function n(t,n,r,i,o){tM(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(KE),nM=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,l,u,c,f=-1,d=a.length,h=t.value;++f<d;){for(l=(s=a[f]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?zE(s,n,r,i,h?r+=(o-r)*s.value/h:o):JE(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else t._squarify=a=tM(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(KE);function rM(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function iM(t){ns.call(this,null,t)}iM.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const oM=t=>t.values;function aM(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,o=t[r++],a={},s={};let l,u,c,f=-1;for(;++f<i;)l=o(u=e[f])+"",(c=a[l])?c.push(u):a[l]=[u];for(l in a)s[l]=n(a[l],r);return s}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function sM(t){ns.call(this,null,t)}Se(iM,ns,{transform(t,e){e.source||Rt("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each((t=>{t.children&&ka(t.data)&&i.rem.push(t.data)})),this.value=o=sE({values:de(t.keys).reduce(((t,e)=>(t.key(e),t)),aM()).entries(i.source)},oM),n&&o.each((t=>{t.children&&(t=Ma(t.data),i.add.push(t),i.source.push(t))})),rM(o,Aa,Aa)),i.source.root=o,i}});const lM=(t,e)=>t.parent===e.parent?1:2;Se(sM,ns,{transform(t,e){e.source&&e.source.root||Rt(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(Fa(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?lM:qt);try{this.value=n(i)}catch(t){Rt(t)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}(t,r,o))),e.reflow(t.modified()).modifies(o).modifies("leaf")}});const uM=["x","y","r","depth","children"];function cM(t){sM.call(this,t)}cM.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:uM.length,default:uM}]},Se(cM,sM,{layout:function(){var t=null,e=1,n=1,r=mE;function i(i){const o=function(){let t=1;return()=>(t=(1664525*t+1013904223)%yE)/yE}();return i.x=e/2,i.y=n/2,t?i.eachBefore(FE(t)).eachAfter(TE(r,.5,o)).eachBefore(NE(1)):i.eachBefore(FE(DE)).eachAfter(TE(mE,1,o)).eachAfter(TE(r,i.r/Math.min(e,n),o)).eachBefore(NE(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=hE(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:gE(+t),i):r},i},params:["radius","size","padding"],fields:uM});const fM=["x0","y0","x1","y1","depth","children"];function dM(t){sM.call(this,t)}function hM(t){ns.call(this,null,t)}dM.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:fM.length,default:fM}]},Se(dM,sM,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&zE(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(OE),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:fM}),hM.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Se(hM,ns,{transform(t,e){e.source||Rt("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?rM(UE().id(t.key).parentId(t.parentKey)(i.source),t.key,It):rM(UE()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const pM={tidy:function(){var t=WE,e=1,n=1,r=null;function i(i){var l=function(t){for(var e,n,r,i,o,a=new VE(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new VE(r[i],i)),n.parent=e;return(a.parent=new VE(null,0)).children=[a],a}(i);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),r)i.eachBefore(s);else{var u=i,c=i,f=i;i.eachBefore((function(t){t.x<u.x&&(u=t),t.x>c.x&&(c=t),t.depth>f.depth&&(f=t)}));var d=u===c?1:t(u,c)/2,h=d-u.x,p=e/(c.x+d+h),m=n/(f.depth||1);i.eachBefore((function(t){t.x=(t.x+h)*p,t.y=t.depth*m}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,l=o.parent.children[0],u=o.m,c=a.m,f=s.m,d=l.m;s=HE(s),o=$E(o),s&&o;)l=$E(l),(a=HE(a)).a=e,(i=s.z+f-o.z-u+t(s._,o._))>0&&(ZE(YE(s,e,r),e,i),u+=i,c+=i),f+=s.m,u+=o.m,d+=l.m,c+=a.m;s&&!HE(a)&&(a.t=s,a.m+=f-c),o&&!$E(l)&&(l.t=o,l.m+=u-d,r=e)}return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=GE,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(XE,0)/t.length}(n),e.y=function(t){return 1+t.reduce(QE,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),l=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),u=s.x-t(s,l)/2,c=l.x+t(l,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-u)/(c-u)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},mM=["x","y","depth","children"];function gM(t){sM.call(this,t)}function yM(t){ns.call(this,[],t)}gM.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:mM.length,default:mM}]},Se(gM,sM,{layout(t){const e=t||"tidy";if(Ee(pM,e))return pM[e]();Rt("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:mM}),yM.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Se(yM,ns,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||Rt("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>o[Aa(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[Aa(e)]&&o[Aa(n)]&&i.add.push(Ma({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>o[Aa(t)]=1)),n.forEach((t=>{(o[Aa(t.source)]||o[Aa(t.target)])&&i.mod.push(t)}))),i}});const vM={binary:function(t,e,n,r,i){var o,a,s=t.children,l=s.length,u=new Array(l+1);for(u[0]=a=o=0;o<l;++o)u[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,l){if(e>=n-1){var c=s[e];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=l)}for(var f=u[e],d=r/2+f,h=e+1,p=n-1;h<p;){var m=h+p>>>1;u[m]<d?h=m+1:p=m}d-u[h-1]<u[h]-d&&e+1<h&&--h;var g=u[h]-f,y=r-g;if(a-i>l-o){var v=r?(i*y+a*g)/r:a;t(e,h,g,i,o,v,l),t(h,n,y,v,o,a,l)}else{var b=r?(o*y+l*g)/r:l;t(e,h,g,i,o,a,b),t(h,n,y,i,b,a,l)}}(0,l,t.value,e,n,r,i)},dice:zE,slice:JE,slicedice:function(t,e,n,r,i){(1&t.depth?JE:zE)(t,e,n,r,i)},squarify:eM,resquarify:nM},bM=["x0","y0","x1","y1","depth","children"];function xM(t){sM.call(this,t)}xM.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:bM.length,default:bM}]},Se(xM,sM,{layout(){const t=function(){var t=eM,e=!1,n=1,r=1,i=[0],o=mE,a=mE,s=mE,l=mE,u=mE;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(f),i=[0],e&&t.eachBefore(OE),t}function f(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,f=e.x1-n,d=e.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),e.x0=r,e.y0=c,e.x1=f,e.y1=d,e.children&&(n=i[e.depth+1]=o(e)/2,r+=u(e)-n,c+=a(e)-n,(f-=s(e)-n)<r&&(r=f=(r+f)/2),(d-=l(e)-n)<c&&(c=d=(c+d)/2),t(e,r,c,f,d))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=pE(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:gE(+t),c):o},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:gE(+t),c):a},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:gE(+t),c):s},c.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:gE(+t),c):l},c.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:gE(+t),c):u},c}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{Ee(vM,e)?t.tile(vM[e]):Rt("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:bM});const _M=4278190080;function wM(t,e,n){return new Uint32Array(t.getImageData(0,0,e,n).data.buffer)}function kM(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>kM(t,e.items,n)))})):ny[r].draw(t,{items:n?e.map(AM):e})}function AM(t){const e=Sa(t,{});return e.stroke&&0!==e.strokeOpacity||e.fill&&0!==e.fillOpacity?{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}:e}const EM=31,MM=new Uint32Array(33),CM=new Uint32Array(33);CM[0]=0,MM[0]=~CM[0];for(let n=1;n<=32;++n)CM[n]=CM[n-1]<<1|1,MM[n]=~CM[n];function SM(t,e,n,r,i,o){let a=n/2;return t-a<0||t+a>i||e-(a=r/2)<0||e+a>o}function DM(t,e,n,r,i,o,a,s){const l=i*o/(2*r),u=t(e-l),c=t(e+l),f=t(n-(o/=2)),d=t(n+o);return a.outOfBounds(u,f,c,d)||a.getRange(u,f,c,d)||s&&s.getRange(u,f,c,d)}const FM=[-1,-1,1,1],TM=[-1,1,-1,1],NM=["right","center","left"],OM=["bottom","middle","top"];function zM(t,e,n,r,i,o,a,s,l,u,c,f){return!(i.outOfBounds(t,n,e,r)||(f&&o||i).getRange(t,n,e,r))}const RM={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},PM={naive:function(t,e,n,r){const i=t.width,o=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,a=t.datum.fontSize,s=Pg.width(t.datum,t.datum.text);let l,u,c,f,d,h,p,m=0;for(let r=0;r<n;++r)l=e[r].x,c=e[r].y,u=void 0===e[r].x2?l:e[r].x2,f=void 0===e[r].y2?c:e[r].y2,d=(l+u)/2,h=(c+f)/2,p=Math.abs(u-l+f-c),p>=m&&(m=p,t.x=d,t.y=h);return d=s/2,h=a/2,l=t.x-d,u=t.x+d,c=t.y-h,f=t.y+h,t.align="center",l<0&&u<=i?t.align="left":0<=l&&i<u&&(t.align="right"),t.baseline="middle",c<0&&f<=o?t.baseline="top":0<=c&&o<f&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1];function l(e,n,r,l,u){const c=t.invert(e),f=t.invert(n);let d,h=r,p=o;if(!SM(c,f,l,u,i,o)&&!DM(t,c,f,u,l,h,a,s)&&!DM(t,c,f,u,l,u,a,null)){for(;p-h>=1;)d=(h+p)/2,DM(t,c,f,u,l,d,a,s)?p=d:h=d;if(h>r)return[c,f,h,!0]}}return function(e){const s=e.datum.datum.items[r].items,u=s.length,c=e.datum.fontSize,f=Pg.width(e.datum,e.datum.text);let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C,S,D=n?c:0,F=!1,T=!1,N=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,h=void 0===s[r].x2?d:s[r].x2,m=void 0===s[r].y2?p:s[r].y2,d>h&&(S=d,d=h,h=S),p>m&&(S=p,p=m,m=S),x=t(d),w=t(h),_=~~((x+w)/2),k=t(p),E=t(m),A=~~((k+E)/2),v=_;v>=x;--v)for(b=A;b>=k;--b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);for(v=_;v<=w;++v)for(b=A;b<=E;++b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);F||n||(M=Math.abs(h-d+m-p),g=(d+h)/2,y=(p+m)/2,M>=N&&!SM(g,y,f,c,i,o)&&!DM(t,g,y,c,f,c,a,null)&&(N=M,e.x=g,e.y=y,T=!0))}return!(!F&&!T||(g=f/2,y=c/2,a.setRange(t(e.x-g),t(e.y-y),t(e.x+g),t(e.y+y)),e.align="center",e.baseline="middle",0))}},floodfill:function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=t.bitmap();return function(e){const u=e.datum.datum.items[r].items,c=u.length,f=e.datum.fontSize,d=Pg.width(e.datum,e.datum.text),h=[];let p,m,g,y,v,b,x,_,w,k,A,E,M=n?f:0,C=!1,S=!1,D=0;for(let r=0;r<c;++r){for(p=u[r].x,g=u[r].y,m=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?g:u[r].y2,h.push([t((p+m)/2),t((g+y)/2)]);h.length;)if([x,_]=h.pop(),!(a.get(x,_)||s.get(x,_)||l.get(x,_))){l.set(x,_);for(let t=0;t<4;++t)v=x+FM[t],b=_+TM[t],l.outOfBounds(v,b,v,b)||h.push([v,b]);if(v=t.invert(x),b=t.invert(_),w=M,k=o,!SM(v,b,d,f,i,o)&&!DM(t,v,b,f,d,w,a,s)&&!DM(t,v,b,f,d,f,a,null)){for(;k-w>=1;)A=(w+k)/2,DM(t,v,b,f,d,A,a,s)?k=A:w=A;w>M&&(e.x=v,e.y=b,M=w,C=!0)}}C||n||(E=Math.abs(m-p+y-g),v=(p+m)/2,b=(g+y)/2,E>=D&&!SM(v,b,d,f,i,o)&&!DM(t,v,b,f,d,f,a,null)&&(D=E,e.x=v,e.y=b,S=!0))}return!(!C&&!S||(v=d/2,b=f/2,a.setRange(t(e.x-v),t(e.y-b),t(e.x+v),t(e.y+b)),e.align="center",e.baseline="middle",0))}}},BM=["x","y","opacity","align","baseline"],LM=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function jM(t){ns.call(this,null,t)}function UM(t,e){var n,r,i,o,a,s,l=[],u=function(t){return t(o)};if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}function qM(t){ns.call(this,null,t)}jM.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:LM},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:BM.length,default:BM}]},Se(jM,ns,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t.sort;return he(r)&&e.modified(r.fields)}()))return;t.size&&2===t.size.length||Rt("Size parameter should be specified as a [width, height] array.");const r=t.as||BM;return function(t,e,n,r,i,o,a,s,l,u,c){if(!t.length)return t;const f=Math.max(r.length,i.length),d=function(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}(r,f),h=function(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=RM[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}(i,f),p=(x=t[0].datum)&&x.mark&&x.mark.marktype,m="group"===p&&t[0].datum.items[l].marktype,g="area"===m,y=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,m,s,l),v=null===u||u===1/0,b=g&&"naive"===c;var x;let _=-1,w=-1;const k=t.map((t=>{const e=v?Pg.width(t,t.text):void 0;return _=Math.max(_,e),w=Math.max(w,t.fontSize),{datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t),textWidth:e}}));u=null===u||u===1/0?Math.max(_,w)+Math.max(...r):u;const A=function(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),a=t=>~~((t+n)/r);return a.invert=t=>t*r-n,a.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+32)/32));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>5]&1<<(i&EM)},set:(e,n)=>{const i=n*t+e;r(i>>>5,1<<(i&EM))},clear:(e,n)=>{const r=n*t+e;i(r>>>5,~(1<<(r&EM)))},getRange:(e,r,i,o)=>{let a,s,l,u,c=o;for(;c>=r;--c)if(a=c*t+e,s=c*t+i,l=a>>>5,u=s>>>5,l===u){if(n[l]&MM[a&EM]&CM[1+(s&EM)])return!0}else{if(n[l]&MM[a&EM])return!0;if(n[u]&CM[1+(s&EM)])return!0;for(let t=l+1;t<u;++t)if(n[t])return!0}return!1},setRange:(e,n,i,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+i,l=a>>>5,u=s>>>5,l===u)r(l,MM[a&EM]&CM[1+(s&EM)]);else for(r(l,MM[a&EM]),r(u,CM[1+(s&EM)]),c=l+1;c<u;++c)r(c,4294967295)},clearRange:(e,n,r,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+r,l=a>>>5,u=s>>>5,l===u)i(l,CM[a&EM]|MM[1+(s&EM)]);else for(i(l,CM[a&EM]),i(u,MM[1+(s&EM)]),c=l+1;c<u;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=e||i>=t}}(i,o),a.ratio=r,a.padding=n,a.width=t,a.height=e,a}(e[0],e[1],u);let E;if(!b){n&&k.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<h.length&&!e;++t)e=5===h[t]||d[t]<0;const r=(p&&a||g)&&t.map((t=>t.datum));E=o.length||r?function(t,e,n,r,i){const o=t.width,a=t.height,s=r||i,l=$u(o,a).getContext("2d"),u=$u(o,a).getContext("2d"),c=s&&$u(o,a).getContext("2d");n.forEach((t=>kM(l,t,!1))),kM(u,e,!1),s&&kM(c,e,!0);const f=wM(l,o,a),d=wM(u,o,a),h=s&&wM(c,o,a),p=t.bitmap(),m=s&&t.bitmap();let g,y,v,b,x,_,w,k;for(y=0;y<a;++y)for(g=0;g<o;++g)x=y*o+g,_=f[x]&_M,k=d[x]&_M,w=s&&h[x]&_M,(_||w||k)&&(v=t(g),b=t(y),i||!_&&!k||p.set(v,b),s&&(_||w)&&m.set(v,b));return[p,m]}(A,r||[],o,e,g):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(A,a&&k)}const M=g?PM[c](A,E,a,l):function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=r.length;return function(e){var u;const c=e.boundary,f=e.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C=null!==(u=e.textWidth)&&void 0!==u?u:0;for(let i=0;i<l;++i){if(d=(3&n[i])-1,h=(n[i]>>>2&3)-1,p=0===d&&0===h||r[i]<0,m=d&&h?Math.SQRT1_2:1,g=r[i]<0?-1:1,y=c[1+d]+r[i]*d*m,w=c[4+h]+g*f*h/2+r[i]*h*m,b=w-f/2,x=w+f/2,k=t(y),E=t(b),M=t(x),!C){if(!zM(k,k,E,M,a,s,0,0,0,0,0,p))continue;C=Pg.width(e.datum,e.datum.text)}if(_=y+g*C*d/2,y=_-C/2,v=_+C/2,k=t(y),A=t(v),zM(k,A,E,M,a,s,0,0,0,0,0,p))return e.x=d?d*g<0?v:y:_,e.y=h?h*g<0?x:b:w,e.align=NM[d*g+1],e.baseline=OM[h*g+1],a.setRange(k,E,A,M),!0}return!1}}(A,E,h,d);return k.forEach((t=>t.opacity=+M(t))),k}(e.materialize(e.SOURCE).source||[],t.size,t.sort,de(null==t.offset?1:t.offset),de(t.anchor||LM),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),qM.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Se(qM,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=UM(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Ft),o=i.length,a=t.as||[Ft(t.x),Ft(t.y)],s=[];r.forEach((e=>{(function(t,e,n,r){const[i,o,a,s]=vt(t,e,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const t=[0,u-1];for(let n=0;n<l;++n){const e=i[n],r=t[0],a=t[1],s=e-i[r]>i[a]-e?r:a;let l=0,u=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-e||1);for(let t=r;t<=a;++t){const n=i[t],r=o[t],a=At(Math.abs(e-n)*g)*d[t],s=n*a;l+=a,u+=s,h+=r*a,p+=r*s,m+=n*s}const[y,v]=yt(u/l,h/l,p/l,m/l);c[n]=y+v*e,f[n]=Math.abs(o[n]-c[n]),Et(i,n+1,t)}if(2===h)break;const e=H(f);if(Math.abs(e)<1e-12)break;for(let n,r,i=0;i<l;++i)n=f[i]/(6*e),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,o=[];let a,s=0,l=0,u=[];for(;s<i;++s)a=t[s]+n,u[0]===a?u[1]+=(e[s]-u[1])/++l:(l=0,u[1]+=r,u=[a,e[s]],o.push(u));return u[1]+=r,o}(i,c,a,s)})(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let r=0;r<o;++r)n[i[r]]=e.dims[r];n[a[0]]=t[0],n[a[1]]=t[1],s.push(Ma(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const IM={constant:gt,linear:_t,log:function(t,e,n){let r=0,i=0,o=0,a=0,s=0;bt(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=yt(r,i,o,a),u=t=>l[0]+l[1]*Math.log(t);return{coef:l,predict:u,rSquared:xt(t,e,n,i,u)}},exp:function(t,e,n){const[r,i,o,a]=vt(t,e,n);let s,l,u,c=0,f=0,d=0,h=0,p=0;bt(t,e,n,((t,e)=>{s=r[p++],l=Math.log(e),u=s*e,c+=(e*l-c)/p,f+=(u-f)/p,d+=(u*l-d)/p,h+=(s*u-h)/p}));const[m,g]=yt(f/a,c/a,d/a,h/a),y=t=>Math.exp(m+g*(t-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:xt(t,e,n,a,y)}},pow:function(t,e,n){let r=0,i=0,o=0,a=0,s=0,l=0;bt(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++l,r+=(n-r)/l,i+=(u-i)/l,o+=(n*u-o)/l,a+=(n*n-a)/l,s+=(e-s)/l}));const u=yt(r,i,o,a),c=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:xt(t,e,n,s,c)}},quad:wt,poly:function(t,e,n,r){if(0===r)return gt(t,e,n);if(1===r)return _t(t,e,n);if(2===r)return wt(t,e,n);const[i,o,a,s]=vt(t,e,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d)*o[p];for(u.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(u);const y=function(t){const e=t.length-1,n=[];let r,i,o,a,s;for(r=0;r<e;++r){for(a=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][a])&&(a=i);for(o=r;o<e+1;++o)s=t[o][r],t[o][r]=t[o][a],t[o][a]=s;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,o=i+1;o<e;++o)s+=t[o][i]*n[o];n[i]=(t[e][i]-s)/t[i][i]}return n}(c),v=t=>{t-=a;let e=s+y[0]+y[1]*t+y[2]*t*t;for(d=3;d<f;++d)e+=y[d]*Math.pow(t,d);return e};return{coef:kt(f,y,-a,s),predict:v,rSquared:xt(t,e,n,s,v)}}};function WM(t){ns.call(this,null,t)}WM.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(IM)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Se(WM,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=UM(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Ft),o=t.method||"linear",a=null==t.order?3:t.order,s=((t,e)=>"poly"===t?e:"quad"===t?2:1)(o,a),l=t.as||[Ft(t.x),Ft(t.y)],u=IM[o],c=[];let f=t.extent;Ee(IM,o)||Rt("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=s)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,t.x,t.y,a);if(t.params)return void c.push(Ma({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=f||ke(n,t.x),h=t=>{const e={};for(let r=0;r<i.length;++r)e[i[r]]=n.dims[r];e[l[0]]=t[0],e[l[1]]=t[1],c.push(Ma(e))};"linear"===o||"constant"===o?d.forEach((t=>h([t,r.predict(t)]))):Ct(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});const $M=134217729;function HM(t,e,n,r,i){let o,a,s,l,u=e[0],c=r[0],f=0,d=0;c>u==c>-u?(o=u,u=e[++f]):(o=c,c=r[++d]);let h=0;if(f<t&&d<n)for(c>u==c>-u?(a=u+o,s=o-(a-u),u=e[++f]):(a=c+o,s=o-(a-c),c=r[++d]),o=a,0!==s&&(i[h++]=s);f<t&&d<n;)c>u==c>-u?(a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f]):(a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d]),o=a,0!==s&&(i[h++]=s);for(;f<t;)a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f],o=a,0!==s&&(i[h++]=s);for(;d<n;)a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d],o=a,0!==s&&(i[h++]=s);return 0===o&&0!==h||(i[h++]=o),h}function ZM(t){return new Float64Array(t)}const YM=ZM(4),VM=ZM(8),GM=ZM(12),XM=ZM(16),QM=ZM(4);function JM(t,e,n,r,i,o){const a=(e-o)*(n-i),s=(t-i)*(r-o),l=a-s,u=Math.abs(a+s);return Math.abs(l)>=33306690738754716e-32*u?l:-function(t,e,n,r,i,o,a){let s,l,u,c,f,d,h,p,m,g,y,v,b,x,_,w,k,A;const E=t-i,M=n-i,C=e-o,S=r-o;x=E*S,d=$M*E,h=d-(d-E),p=E-h,d=$M*S,m=d-(d-S),g=S-m,_=p*g-(x-h*m-p*m-h*g),w=C*M,d=$M*C,h=d-(d-C),p=C-h,d=$M*M,m=d-(d-M),g=M-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,YM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,YM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,YM[2]=v-(A-f)+(y-f),YM[3]=A;let D=function(t,e){let n=e[0];for(let r=1;r<4;r++)n+=e[r];return n}(0,YM),F=22204460492503146e-32*a;if(D>=F||-D>=F)return D;if(f=t-E,s=t-(E+f)+(f-i),f=n-M,u=n-(M+f)+(f-i),f=e-C,l=e-(C+f)+(f-o),f=r-S,c=r-(S+f)+(f-o),0===s&&0===l&&0===u&&0===c)return D;if(F=11093356479670487e-47*a+33306690738754706e-32*Math.abs(D),D+=E*c+S*s-(C*u+M*l),D>=F||-D>=F)return D;x=s*S,d=$M*s,h=d-(d-s),p=s-h,d=$M*S,m=d-(d-S),g=S-m,_=p*g-(x-h*m-p*m-h*g),w=l*M,d=$M*l,h=d-(d-l),p=l-h,d=$M*M,m=d-(d-M),g=M-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,QM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,QM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,QM[2]=v-(A-f)+(y-f),QM[3]=A;const T=HM(4,YM,4,QM,VM);x=E*c,d=$M*E,h=d-(d-E),p=E-h,d=$M*c,m=d-(d-c),g=c-m,_=p*g-(x-h*m-p*m-h*g),w=C*u,d=$M*C,h=d-(d-C),p=C-h,d=$M*u,m=d-(d-u),g=u-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,QM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,QM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,QM[2]=v-(A-f)+(y-f),QM[3]=A;const N=HM(T,VM,4,QM,GM);x=s*c,d=$M*s,h=d-(d-s),p=s-h,d=$M*c,m=d-(d-c),g=c-m,_=p*g-(x-h*m-p*m-h*g),w=l*u,d=$M*l,h=d-(d-l),p=l-h,d=$M*u,m=d-(d-u),g=u-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,QM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,QM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,QM[2]=v-(A-f)+(y-f),QM[3]=A;const O=HM(N,GM,4,QM,XM);return XM[O-1]}(t,e,n,r,i,o,u)}ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(8),ZM(8),ZM(8),ZM(4),ZM(8),ZM(8),ZM(8),ZM(12),ZM(192),ZM(192),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(4),ZM(4),ZM(4),ZM(8),ZM(16),ZM(16),ZM(16),ZM(32),ZM(32),ZM(48),ZM(64),ZM(1152),ZM(1152),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(1152),ZM(1152),ZM(1152),ZM(1152),ZM(1152),ZM(2304),ZM(2304),ZM(3456),ZM(5760),ZM(8),ZM(8),ZM(8),ZM(16),ZM(24),ZM(48),ZM(48),ZM(96),ZM(192),ZM(384),ZM(384),ZM(384),ZM(768),ZM(96),ZM(96),ZM(96),ZM(1152);const KM=Math.pow(2,-52),tC=new Uint32Array(512);class eC{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sC,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lC;const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new eC(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let a=1/0,s=1/0,l=-1/0,u=-1/0;for(let E=0;E<o;E++){const e=t[2*E],n=t[2*E+1];e<a&&(a=e),n<s&&(s=n),e>l&&(l=e),n>u&&(u=n),this._ids[E]=E}const c=(a+l)/2,f=(s+u)/2;let d,h,p,m=1/0;for(let E=0;E<o;E++){const e=nC(c,f,t[2*E],t[2*E+1]);e<m&&(d=E,m=e)}const g=t[2*d],y=t[2*d+1];m=1/0;for(let E=0;E<o;E++){if(E===d)continue;const e=nC(g,y,t[2*E],t[2*E+1]);e<m&&e>0&&(h=E,m=e)}let v=t[2*h],b=t[2*h+1],x=1/0;for(let E=0;E<o;E++){if(E===d||E===h)continue;const e=iC(g,y,v,b,t[2*E],t[2*E+1]);e<x&&(p=E,x=e)}let _=t[2*p],w=t[2*p+1];if(x===1/0){for(let r=0;r<o;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];oC(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(JM(g,y,v,b,_,w)<0){const t=h,e=v,n=b;h=p,v=_,b=w,p=t,_=e,w=n}const k=function(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l);return{x:t+(u*c-s*f)*d,y:e+(a*f-l*c)*d}}(g,y,v,b,_,w);this._cx=k.x,this._cy=k.y;for(let E=0;E<o;E++)this._dists[E]=nC(t[2*E],t[2*E+1],k.x,k.y);oC(this._ids,this._dists,0,o-1),this._hullStart=d;let A=3;n[d]=e[p]=h,n[h]=e[d]=p,n[p]=e[h]=d,r[d]=0,r[h]=1,r[p]=2,i.fill(-1),i[this._hashKey(g,y)]=d,i[this._hashKey(v,b)]=h,i[this._hashKey(_,w)]=p,this.trianglesLen=0,this._addTriangle(d,h,p,-1,-1,-1);for(let E,M,C=0;C<this._ids.length;C++){const o=this._ids[C],a=t[2*o],s=t[2*o+1];if(C>0&&Math.abs(a-E)<=KM&&Math.abs(s-M)<=KM)continue;if(E=a,M=s,o===d||o===h||o===p)continue;let l=0;for(let t=0,e=this._hashKey(a,s);t<this._hashSize&&(l=i[(e+t)%this._hashSize],-1===l||l===n[l]);t++);l=e[l];let u,c=l;for(;u=n[c],JM(a,s,t[2*c],t[2*c+1],t[2*u],t[2*u+1])>=0;)if(c=u,c===l){c=-1;break}if(-1===c)continue;let f=this._addTriangle(c,o,n[c],-1,-1,r[c]);r[o]=this._legalize(f+2),r[c]=f,A++;let m=n[c];for(;u=n[m],JM(a,s,t[2*m],t[2*m+1],t[2*u],t[2*u+1])<0;)f=this._addTriangle(m,o,u,r[o],-1,r[m]),r[o]=this._legalize(f+2),n[m]=m,A--,m=u;if(c===l)for(;u=e[c],JM(a,s,t[2*u],t[2*u+1],t[2*c],t[2*c+1])<0;)f=this._addTriangle(u,o,c,-1,r[c],r[u]),this._legalize(f+2),r[u]=f,n[c]=c,A--,c=u;this._hullStart=e[o]=c,n[c]=e[m]=o,n[o]=m,i[this._hashKey(a,s)]=o,i[this._hashKey(t[2*c],t[2*c+1])]=c}this.hull=new Uint32Array(A);for(let E=0,M=this._hullStart;E<A;E++)this.hull[E]=M,M=n[M];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[t],s=t-t%3;if(o=s+(t+2)%3,-1===a){if(0===i)break;t=tC[--i];continue}const l=a-a%3,u=s+(t+1)%3,c=l+(a+2)%3,f=e[o],d=e[t],h=e[u],p=e[c];if(rC(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){e[t]=p,e[a]=f;const r=n[c];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(a,n[o]),this._link(o,c);const s=l+(a+1)%3;i<tC.length&&(tC[i++]=s)}else{if(0===i)break;t=tC[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function nC(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function rC(t,e,n,r,i,o,a,s){const l=t-a,u=e-s,c=n-a,f=r-s,d=i-a,h=o-s,p=c*c+f*f,m=d*d+h*h;return l*(f*m-p*h)-u*(c*m-p*d)+(l*l+u*u)*(c*h-f*d)<0}function iC(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=(u*c-s*f)*d,p=(a*f-l*c)*d;return h*h+p*p}function oC(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=n&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=n+1,o=r;aC(t,n+r>>1,i),e[t[n]]>e[t[r]]&&aC(t,n,r),e[t[i]]>e[t[r]]&&aC(t,i,r),e[t[n]]>e[t[i]]&&aC(t,n,i);const a=t[i],s=e[a];for(;;){do{i++}while(e[t[i]]<s);do{o--}while(e[t[o]]>s);if(o<i)break;aC(t,i,o)}t[n+1]=t[o],t[o]=a,r-i+1>=o-n?(oC(t,e,i,r),oC(t,e,n,o-1)):(oC(t,e,n,o-1),oC(t,e,i,r))}}function aC(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function sC(t){return t[0]}function lC(t){return t[1]}const uC=1e-6;class cC{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>uC||Math.abs(this._y1-i)>uC)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}rect(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class fC{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class dC{constructor(t){let[e,n,r,i]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(e=+e)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this;let i,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,y=0,v=n.length;g<v;g+=3,y+=2){const r=2*n[g],s=2*n[g+1],l=2*n[g+2],u=t[r],c=t[r+1],f=t[s],d=t[s+1],h=t[l],v=t[l+1],b=f-u,x=d-c,_=h-u,w=v-c,k=2*(b*w-x*_);if(Math.abs(k)<1e-9){if(void 0===i){i=o=0;for(const n of e)i+=t[2*n],o+=t[2*n+1];i/=e.length,o/=e.length}const n=1e9*Math.sign((i-u)*w-(o-c)*_);p=(u+h)/2-n*w,m=(c+v)/2+n*_}else{const t=1/k,e=b*b+x*x,n=_*_+w*w;p=u+(w*e-x*n)*t,m=c+(b*n-_*e)*t}a[y]=p,a[y+1]=m}let s,l,u,c=e[e.length-1],f=4*c,d=t[2*c],h=t[2*c+1];r.fill(0);for(let p=0;p<e.length;++p)c=e[p],s=f,l=d,u=h,f=4*c,d=t[2*c],h=t[2*c+1],r[s+2]=r[f]=u-h,r[s+3]=r[f+1]=d-l}render(t){const e=null==t?t=new cC:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let u=0,c=n.length;u<c;++u){const e=n[u];if(e<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(e/3),a=o[r],s=o[r+1],l=o[i],c=o[i+1];this._renderSegment(a,s,l,c,t)}let s,l=i[i.length-1];for(let u=0;u<i.length;++u){s=l,l=i[u];const e=2*Math.floor(r[l]/3),n=o[e],c=o[e+1],f=4*s,d=this._project(n,c,a[f+2],a[f+3]);d&&this._renderSegment(n,c,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new cC:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new cC:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||e.lineTo(r[o],r[o+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new fC;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const a=this._regioncode(t,e),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,a=t.length;o<a;o+=2)if(e[r]===t[o]&&e[r+1]===t[o+1]&&e[(r+2)%i]===t[(o+a-2)%a]&&e[(r+3)%i]===t[(o+a-1)%a]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(e[2*n],e[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return this._simplify(n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e))}_clipFinite(t,e){const n=e.length;let r,i,o,a,s=null,l=e[n-2],u=e[n-1],c=this._regioncode(l,u),f=0;for(let d=0;d<n;d+=2)if(r=l,i=u,l=e[d],u=e[d+1],o=c,c=this._regioncode(l,u),0===o&&0===c)a=f,f=0,s?s.push(l,u):s=[l,u];else{let e,n,d,h,p;if(0===o){if(null===(e=this._clipSegment(r,i,l,u,o,c)))continue;[n,d,h,p]=e}else{if(null===(e=this._clipSegment(l,u,r,i,c,o)))continue;[h,p,n,d]=e,a=f,f=this._edgecode(n,d),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(n,d):s=[n,d]}a=f,f=this._edgecode(h,p),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(h,p):s=[h,p]}if(s)a=f,f=this._edgecode(s[0],s[1]),a&&f&&this._edge(t,a,f,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,e,n,r,i,o){const a=i<o;for(a&&([t,e,n,r,i,o]=[n,r,t,e,o,i]);;){if(0===i&&0===o)return a?[n,r,t,e]:[t,e,n,r];if(i&o)return null;let s,l,u=i||o;8&u?(s=t+(n-t)*(this.ymax-e)/(r-e),l=this.ymax):4&u?(s=t+(n-t)*(this.ymin-e)/(r-e),l=this.ymin):2&u?(l=e+(r-e)*(this.xmax-t)/(n-t),s=this.xmax):(l=e+(r-e)*(this.xmin-t)/(n-t),s=this.xmin),i?(t=s,e=l,i=this._regioncode(t,e)):(n=s,r=l,o=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,o){let a,s=Array.from(e);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(t,s))for(let l,u=0,c=s.length,f=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)l=f,f=this._edgecode(s[u],s[u+1]),l&&f&&(u=this._edge(t,l,f,s,u),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}return i}_project(t,e,n,r){let i,o,a,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(a=this.ymin,o=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(a=this.ymax,o=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(o=this.xmax,a=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(o=this.xmin,a=e+(s=i)*r)}return[o,a]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const n=(e+2)%t.length,r=(e+4)%t.length;(t[e]===t[n]&&t[n]===t[r]||t[e+1]===t[n+1]&&t[n+1]===t[r+1])&&(t.splice(n,2),e-=2)}t.length||(t=null)}return t}}const hC=2*Math.PI,pC=Math.pow;function mC(t){return t[0]}function gC(t){return t[1]}function yC(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class vC{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mC,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gC,r=arguments.length>3?arguments[3]:void 0;return new vC("length"in t?function(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=t[a];o[2*a]=e.call(r,i,a,t),o[2*a+1]=n.call(r,i,a,t)}return o}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new eC(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],o=2*e[r+2];if((n[o]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[o+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,a=e.length/2;o<a;++o){const t=yC(e[2*o],e[2*o+1],i);e[2*o]=t[0],e[2*o+1]=t[1]}this._delaunator=new eC(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,l=n.length;s<l;++s){const t=i[s%3==2?s-2:s+1];-1!==n[s]&&-1!==o[t]||(o[t]=s)}for(let s=0,l=r.length;s<l;++s)a[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new dC(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const e=a.indexOf(t);return e>0&&(yield a[e-1]),void(e<a.length-1&&(yield a[e+1]))}const s=e[t];if(-1===s)return;let l=s,u=-1;do{if(yield u=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=i[l],-1===l){const e=n[(r[t]+1)%n.length];return void(e!==u&&(yield e))}}while(l!==s)}find(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:l}=this;if(-1===r[t]||!l.length)return(t+1)%(l.length>>1);let u=t,c=pC(e-l[2*t],2)+pC(n-l[2*t+1],2);const f=r[t];let d=f;do{let r=s[d];const f=pC(e-l[2*r],2)+pC(n-l[2*r+1],2);if(f<c&&(c=f,u=r),d=d%3==2?d-2:d+1,s[d]!==t)break;if(d=a[d],-1===d){if(d=i[(o[t]+1)%i.length],d!==r&&pC(e-l[2*d],2)+pC(n-l[2*d+1],2)<c)return d;break}}while(d!==f);return u}render(t){const e=null==t?t=new cC:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,a=r.length;o<a;++o){const e=r[o];if(e<o)continue;const a=2*i[o],s=2*i[e];t.moveTo(n[a],n[a+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"==typeof t.moveTo||(e=t,t=null),e=null==e?2:+e;const n=null==t?t=new cC:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];t.moveTo(n+e,o),t.arc(n,o,e,0,hC)}return n&&n.value()}renderHull(t){const e=null==t?t=new cC:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let a=1;a<o;++a){const e=2*n[a];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new fC;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new cC:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],a=2*i[t+1],s=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[a],r[a+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new fC;return this.renderTriangle(t,e),e.value()}}function bC(t){ns.call(this,null,t)}bC.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const xC=[-1e5,-1e5,1e5,1e5];function _C(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}Se(bC,ns,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:xC;const o=this.value=vC.from(r,t.x,t.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const t=o.cellPolygon(a);r[a][n]=t?_C(t):null}return e.reflow(t.modified()).modifies(n)}});var wC=Math.PI/180,kC=64,AC=2048;function EC(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,(kC<<5)/o,AC/o);var a,s,l,u,c,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,a=i.measureText(e.text+"m").width*o,l=e.size<<1,e.rotate){var m=Math.sin(e.rotate*wC),g=Math.cos(e.rotate*wC),y=a*g,v=a*m,b=l*g,x=l*m;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,l=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(l>h&&(h=l),f+a>=kC<<5&&(f=0,d+=h,h=0),d+l>=AC)break;i.translate((f+(a>>1))/o,(d+(l>>1))/o),e.rotate&&i.rotate(e.rotate*wC),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=a,e.height=l,e.xoff=f,e.yoff=d,e.x1=a>>1,e.y1=l>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=a}for(var _=i.getImageData(0,0,(kC<<5)/o,AC/o).data,w=[];--r>=0;)if((e=n[r]).hasText){for(s=(a=e.width)>>5,l=e.y1-e.y0,u=0;u<l*s;u++)w[u]=0;if(null==(f=e.xoff))return;d=e.yoff;var k=0,A=-1;for(c=0;c<l;c++){for(u=0;u<a;u++){var E=s*c+(u>>5),M=_[(d+c)*(kC<<5)+(f+u)<<2]?1<<31-u%32:0;w[E]|=M,k|=M}k?A=c:(e.y0++,l--,c--,d++)}e.y1=e.y0+A,e.sprite=w.slice(0,(e.y1-e.y0)*s)}}}function MC(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,a=t.x-(o<<4),s=127&a,l=32-s,u=t.y1-t.y0,c=(t.y+t.y0)*n+(a>>5),f=0;f<u;f++){r=0;for(var d=0;d<=o;d++)if((r<<l|(d<o?(r=i[f*o+d])>>>s:0))&e[c+d])return!0;c+=n}return!1}function CC(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function SC(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function DC(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function FC(t){return"function"==typeof t?t:function(){return t}}var TC={archimedean:DC,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const NC=["x","y","font","fontSize","fontStyle","fontWeight","angle"],OC=["text","font","rotate","fontSize","fontStyle","fontWeight"];function zC(t){ns.call(this,function(){var t,e,n,r,i,o,a,s=[256,256],l=DC,u=[],c=Math.random,f={};function d(t,e,n){for(var r,i,o,a=e.x,u=e.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=l(s),h=c()<.5?1:-1,p=-h;(r=d(p+=h))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(e.x=a+i,e.y=u+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1])&&(!n||!MC(e,t,s[0]))&&(!n||SC(e,n))){for(var m,g=e.sprite,y=e.width>>5,v=s[0]>>5,b=e.x-(y<<4),x=127&b,_=32-x,w=e.y1-e.y0,k=(e.y+e.y0)*v+(b>>5),A=0;A<w;A++){m=0;for(var E=0;E<=y;E++)t[k+E]|=m<<_|(E<y?(m=g[A*y+E])>>>x:0);k+=v}return e.sprite=null,!0}return!1}return f.layout=function(){for(var l=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(kC<<5)/e,t.height=AC/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}($u()),f=function(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),h=null,p=u.length,m=-1,g=[],y=u.map((s=>({text:t(s),font:e(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((t,e)=>e.size-t.size));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,EC(l,v,y,m),v.hasText&&d(f,v,h)&&(g.push(v),h?CC(h,v):h=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},f.words=function(t){return arguments.length?(u=t,f):u},f.size=function(t){return arguments.length?(s=[+t[0],+t[1]],f):s},f.font=function(t){return arguments.length?(e=FC(t),f):e},f.fontStyle=function(t){return arguments.length?(r=FC(t),f):r},f.fontWeight=function(t){return arguments.length?(i=FC(t),f):i},f.rotate=function(t){return arguments.length?(o=FC(t),f):o},f.text=function(e){return arguments.length?(t=FC(e),f):t},f.spiral=function(t){return arguments.length?(l=TC[t]||t,f):l},f.fontSize=function(t){return arguments.length?(n=FC(t),f):n},f.padding=function(t){return arguments.length?(a=FC(t),f):a},f.random=function(t){return arguments.length?(c=t,f):c},f}(),t)}zC.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:NC}]},Se(zC,ns,{transform(t,e){!t.size||t.size[0]&&t.size[1]||Rt("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||OC.some((function(n){const r=t[n];return he(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,o=t.as||NC;let a,s=t.fontSize||14;if(he(s)?a=t.fontSizeRange:s=xe(s),a){const t=s,e=Mh("sqrt")().domain(ke(r,t)).range(a);s=n=>e(t(n))}r.forEach((t=>{t[o[0]]=NaN,t[o[1]]=NaN,t[o[3]]=0}));const l=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random(Q).layout(),u=i.size(),c=u[0]>>1,f=u[1]>>1,d=l.length;for(let h,p,m=0;m<d;++m)h=l[m],p=h.datum,p[o[0]]=h.x+c,p[o[1]]=h.y+f,p[o[2]]=h.font,p[o[3]]=h.size,p[o[4]]=h.style,p[o[5]]=h.weight,p[o[6]]=h.rotate;return e.reflow(n).modifies(o)}});const RC=t=>new Uint8Array(t),PC=t=>new Uint16Array(t),BC=t=>new Uint32Array(t);function LC(t,e,n){const r=(e<257?RC:e<65537?PC:BC)(t);return n&&r.set(n),r}function jC(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),o=t.index,a=i[0],s=i[1],l=o.length;let u;for(u=0;u<a;++u)e[o[u]]|=r;for(u=s;u<l;++u)e[o[u]]|=r;return n}}}function UC(){let t=BC(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,l=BC(s);let u,c,f,d=Array(s);for(f=0;f<s;++f)d[f]=r(i[f]),l[f]=f;if(d=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),n=t,r=e,Array.from(r,(t=>n[t]));var n,r}(d,l),a)u=e,c=t,e=Array(a+s),t=BC(a+s),function(t,e,n,r,i,o,a,s,l){let u,c=0,f=0;for(u=0;c<r&&f<a;++u)e[c]<i[f]?(s[u]=e[c],l[u]=n[c++]):(s[u]=i[f],l[u]=o[f++]+t);for(;c<r;++c,++u)s[u]=e[c],l[u]=n[c];for(;f<a;++f,++u)s[u]=i[f],l[u]=o[f]+t}(o,u,c,a,d,l,s,e,t);else{if(o>0)for(f=0;f<s;++f)l[f]+=o;e=d,t=l}return n=a+s,{index:l,value:d}},remove:function(r,i){const o=n;let a,s,l;for(s=0;!i[t[s]]&&s<o;++s);for(l=s;s<o;++s)i[a=t[s]]||(t[l]=a,e[l]=e[s],++l);n=o-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[Yu(r,t[0],0,i),Zu(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function qC(t){ns.call(this,function(){let t=8,e=[],n=BC(0),r=LC(0,t),i=LC(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const o=e.length,a=Array(o-t),s=e;let l,u,c;for(u=0;!n[u]&&u<o;++u)a[u]=e[u],s[u]=u;for(c=u;u<o;++u)l=e[u],n[u]?s[u]=-1:(s[u]=c,r[c]=r[u],i[c]=i[u],a[c]=l,l._index=c++),r[u]=0;return e=a,s},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=LC(e,t,r),i=LC(e,t))}}}(),t),this._indices=null,this._dims=null}function IC(t){ns.call(this,null,t)}qC.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Se(qC,ns,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},o=this._dims=[],a=r.length;let s,l,u=0;for(;u<a;++u)s=n[u].fname,l=i[s]||(i[s]=UC()),o.push(jC(l,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,o=this._indices,a=this._dims,s=this.value,l=s.curr(),u=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,g,y,v,b,x,_,w,k;if(u.set(l),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&s.add(e.add),e.mod.length)for(x={},v=e.mod,_=0,w=v.length;_<w;++_)x[v[_]._index]=1;for(_=0;_<h;++_)k=r[_],(!a[_]||t.modified("fields",_)||e.modified(k.fields))&&(y=k.fname,(m=p[y])||(o[y]=g=UC(),p[y]=m=g.insert(k,e.source,0)),a[_]=jC(g,_,i[_]).onAdd(m,l));for(_=0,w=s.data().length;_<w;++_)b[_]||(u[_]!==l[_]?f.push(_):x[_]&&l[_]!==c&&d.push(_));return s.mask=(1<<h)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,o=this._dims,a=this._indices,s=t.fields,l={},u=n.add,c=i.size()+r.length,f=o.length;let d,h,p,m=i.size();i.resize(c,f),i.add(r);const g=i.curr(),y=i.prev(),v=i.all();for(d=0;d<f;++d)h=s[d].fname,p=l[h]||(l[h]=a[h].insert(s[d],r,m)),o[d].onAdd(p,g);for(;m<c;++m)y[m]=v,g[m]!==v&&u.push(m)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),o=r.all(),a=t.mod;let s,l,u;for(s=0,l=a.length;s<l;++s)u=a[s]._index,i[u]!==o&&n.push(u)},remove(t,e,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),l={},u=n.rem,c=e.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,a[h]=p=o[h],o[h]=s,p!==s&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(e,d,l),l},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,o=e.stamp,a=r.length;let s,l,u=0;for(n.filters=0,l=0;l<a;++l)t.modified("query",l)&&(s=l,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(l=0,u=0;l<a;++l)t.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),l=t.index(),u=t.bisect(t.range),c=t.bisect(e),f=c[0],d=c[1],h=u[0],p=u[1],m=t.one;let g,y,v;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),o=t.index(),a=t.bisect(t.range),s=t.bisect(e),l=s[0],u=s[1],c=a[0],f=a[1],d=t.one;let h,p,m;if(l<c)for(h=l,p=Math.min(c,u);h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(l>c)for(h=c,p=Math.min(l,f);h<p;++h)m=o[h],i[m]^=d,r.push(m);if(u>f)for(h=Math.max(l,f),p=u;h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(u<f)for(h=Math.max(c,u),p=f;h<p;++h)m=o[h],i[m]^=d,r.push(m);t.range=e.slice()}}),IC.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Se(IC,ns,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0==(i&n))return e.StopPropagation;const o=e.fork(e.ALL),a=r.data(),s=r.curr(),l=r.prev(),u=t=>s[t]&n?null:a[t];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,(t=>{const e=s[t]&n;return!e&&e^l[t]&n?a[t]:null})),o.filter(o.REM,(t=>{const e=s[t]&n;return!e||e^e^l[t]&n?null:a[t]}))):(o.filter(o.ADD,u),o.filter(o.REM,(t=>(s[t]&n)===i?a[t]:null))),o.filter(o.SOURCE,(t=>u(t._index)))}});const WC="Literal",$C="CallExpression";function HC(t){this.type=t}var ZC,YC,VC,GC,XC;HC.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case $C:return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var QC=1,JC=2,KC=3,tS=4,eS=5,nS=6,rS=7,iS=8;(ZC={})[QC]="Boolean",ZC[JC]="<end>",ZC[KC]="Identifier",ZC[tS]="Keyword",ZC[eS]="Null",ZC[nS]="Numeric",ZC[rS]="Punctuator",ZC[iS]="String",ZC[9]="RegularExpression";var oS="ArrayExpression",aS="BinaryExpression",sS="CallExpression",lS="ConditionalExpression",uS="Identifier",cS="Literal",fS="LogicalExpression",dS="MemberExpression",hS="ObjectExpression",pS="Property",mS="UnaryExpression",gS="Unexpected token %0",yS="Unexpected number",vS="Unexpected string",bS="Unexpected identifier",xS="Unexpected reserved word",_S="Unexpected end of input",wS="Invalid regular expression",kS="Invalid regular expression: missing /",AS="Octal literals are not allowed in strict mode.",ES="Duplicate data property in object literal not allowed in strict mode",MS="ILLEGAL",CS="Disabled.",SS=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),DS=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function FS(t,e){if(!t)throw new Error("ASSERT: "+e)}function TS(t){return t>=48&&t<=57}function NS(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function OS(t){return"01234567".indexOf(t)>=0}function zS(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function RS(t){return 10===t||13===t||8232===t||8233===t}function PS(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&SS.test(String.fromCharCode(t))}function BS(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&DS.test(String.fromCharCode(t))}const LS={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function jS(){for(;VC<GC;){const t=YC.charCodeAt(VC);if(!zS(t)&&!RS(t))break;++VC}}function US(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)VC<GC&&NS(YC[VC])?(r=YC[VC++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):tD({},gS,MS);return String.fromCharCode(i)}function qS(){var t,e,n,r;for(e=0,"}"===(t=YC[VC])&&tD({},gS,MS);VC<GC&&NS(t=YC[VC++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&tD({},gS,MS),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function IS(){var t,e;for(t=YC.charCodeAt(VC++),e=String.fromCharCode(t),92===t&&(117!==YC.charCodeAt(VC)&&tD({},gS,MS),++VC,(t=US("u"))&&"\\"!==t&&PS(t.charCodeAt(0))||tD({},gS,MS),e=t);VC<GC&&BS(t=YC.charCodeAt(VC));)++VC,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==YC.charCodeAt(VC)&&tD({},gS,MS),++VC,(t=US("u"))&&"\\"!==t&&BS(t.charCodeAt(0))||tD({},gS,MS),e+=t);return e}function WS(){var t,e,n,r,i=VC,o=YC.charCodeAt(VC),a=YC[VC];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++VC,{type:rS,value:String.fromCharCode(o),start:i,end:VC};default:if(61===(t=YC.charCodeAt(VC+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return VC+=2,{type:rS,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:VC};case 33:case 61:return VC+=2,61===YC.charCodeAt(VC)&&++VC,{type:rS,value:YC.slice(i,VC),start:i,end:VC}}}return">>>="===(r=YC.substr(VC,4))?{type:rS,value:r,start:i,end:VC+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:rS,value:n,start:i,end:VC+=3}:a===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===e?{type:rS,value:e,start:i,end:VC+=2}:("//"===e&&tD({},gS,MS),"<>=!+-*%&|^/".indexOf(a)>=0?(++VC,{type:rS,value:a,start:i,end:VC}):void tD({},gS,MS))}function $S(){var t,e,n;if(FS(TS((n=YC[VC]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=VC,t="","."!==n){if(t=YC[VC++],n=YC[VC],"0"===t){if("x"===n||"X"===n)return++VC,function(t){let e="";for(;VC<GC&&NS(YC[VC]);)e+=YC[VC++];return 0===e.length&&tD({},gS,MS),PS(YC.charCodeAt(VC))&&tD({},gS,MS),{type:nS,value:parseInt("0x"+e,16),start:t,end:VC}}(e);if(OS(n))return function(t){let e="0"+YC[VC++];for(;VC<GC&&OS(YC[VC]);)e+=YC[VC++];return(PS(YC.charCodeAt(VC))||TS(YC.charCodeAt(VC)))&&tD({},gS,MS),{type:nS,value:parseInt(e,8),octal:!0,start:t,end:VC}}(e);n&&TS(n.charCodeAt(0))&&tD({},gS,MS)}for(;TS(YC.charCodeAt(VC));)t+=YC[VC++];n=YC[VC]}if("."===n){for(t+=YC[VC++];TS(YC.charCodeAt(VC));)t+=YC[VC++];n=YC[VC]}if("e"===n||"E"===n)if(t+=YC[VC++],"+"!==(n=YC[VC])&&"-"!==n||(t+=YC[VC++]),TS(YC.charCodeAt(VC)))for(;TS(YC.charCodeAt(VC));)t+=YC[VC++];else tD({},gS,MS);return PS(YC.charCodeAt(VC))&&tD({},gS,MS),{type:nS,value:parseFloat(t),start:e,end:VC}}function HS(){if(jS(),VC>=GC)return{type:JC,start:VC,end:VC};const t=YC.charCodeAt(VC);return PS(t)?function(){var t,e;return t=VC,e=92===YC.charCodeAt(VC)?IS():function(){var t,e;for(t=VC++;VC<GC;){if(92===(e=YC.charCodeAt(VC)))return VC=t,IS();if(!BS(e))break;++VC}return YC.slice(t,VC)}(),{type:1===e.length?KC:LS.hasOwnProperty(e)?tS:"null"===e?eS:"true"===e||"false"===e?QC:KC,value:e,start:t,end:VC}}():40===t||41===t||59===t?WS():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(FS("'"===(t=YC[VC])||'"'===t,"String literal must starts with a quote"),e=VC,++VC;VC<GC;){if((n=YC[VC++])===t){t="";break}if("\\"===n)if((n=YC[VC++])&&RS(n.charCodeAt(0)))"\r"===n&&"\n"===YC[VC]&&++VC;else switch(n){case"u":case"x":"{"===YC[VC]?(++VC,i+=qS()):i+=US(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:OS(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),VC<GC&&OS(YC[VC])&&(o=!0,r=8*r+"01234567".indexOf(YC[VC++]),"0123".indexOf(n)>=0&&VC<GC&&OS(YC[VC])&&(r=8*r+"01234567".indexOf(YC[VC++]))),i+=String.fromCharCode(r)):i+=n}else{if(RS(n.charCodeAt(0)))break;i+=n}}return""!==t&&tD({},gS,MS),{type:iS,value:i,octal:o,start:e,end:VC}}():46===t?TS(YC.charCodeAt(VC+1))?$S():WS():TS(t)?$S():WS()}function ZS(){const t=XC;return VC=t.end,XC=HS(),VC=t.end,t}function YS(){const t=VC;XC=HS(),VC=t}function VS(t,e,n){const r=new HC("||"===t||"&&"===t?fS:aS);return r.operator=t,r.left=e,r.right=n,r}function GS(t,e){const n=new HC(sS);return n.callee=t,n.arguments=e,n}function XS(t){const e=new HC(uS);return e.name=t,e}function QS(t){const e=new HC(cS);return e.value=t.value,e.raw=YC.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function JS(t,e,n){const r=new HC(dS);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function KS(t,e,n){const r=new HC(pS);return r.key=e,r.value=n,r.kind=t,r}function tD(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(FS(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=VC,n.description=i,n}function eD(t){t.type===JC&&tD(t,_S),t.type===nS&&tD(t,yS),t.type===iS&&tD(t,vS),t.type===KC&&tD(t,bS),t.type===tS&&tD(t,xS),tD(t,gS,t.value)}function nD(t){const e=ZS();e.type===rS&&e.value===t||eD(e)}function rD(t){return XC.type===rS&&XC.value===t}function iD(t){return XC.type===tS&&XC.value===t}function oD(){VC=XC.start;const t=ZS();return t.type===iS||t.type===nS?(t.octal&&tD(t,AS),QS(t)):XS(t.value)}function aD(){var t,e,n;return VC=XC.start,(t=XC).type===KC?(n=oD(),nD(":"),KS("init",n,pD())):t.type!==JC&&t.type!==rS?(e=oD(),nD(":"),KS("init",e,pD())):void eD(t)}const sD={if:1};function lD(){const t=[];if(nD("("),!rD(")"))for(;VC<GC&&(t.push(pD()),!rD(")"));)nD(",");return nD(")"),t}function uD(){VC=XC.start;const t=ZS();return function(t){return t.type===KC||t.type===tS||t.type===QC||t.type===eS}(t)||eD(t),XS(t.value)}function cD(){nD("[");const t=mD();return nD("]"),t}function fD(){const t=function(){var t;for(t=function(){var t,e,n;if(rD("("))return function(){nD("(");const t=mD();return nD(")"),t}();if(rD("["))return function(){const t=[];for(VC=XC.start,nD("[");!rD("]");)rD(",")?(ZS(),t.push(null)):(t.push(pD()),rD("]")||nD(","));return ZS(),function(t){const e=new HC(oS);return e.elements=t,e}(t)}();if(rD("{"))return function(){var t,e,n=[],r={},i=String;for(VC=XC.start,nD("{");!rD("}");)e="$"+((t=aD()).key.type===uS?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?tD({},ES):r[e]=!0,n.push(t),rD("}")||nD(",");return nD("}"),function(t){const e=new HC(hS);return e.properties=t,e}(n)}();if(t=XC.type,VC=XC.start,t===KC||sD[XC.value])n=XS(ZS().value);else if(t===iS||t===nS)XC.octal&&tD(XC,AS),n=QS(ZS());else{if(t===tS)throw new Error(CS);t===QC?((e=ZS()).value="true"===e.value,n=QS(e)):t===eS?((e=ZS()).value=null,n=QS(e)):rD("/")||rD("/=")?(n=QS(function(){var t,e,n,r;return XC=null,jS(),t=VC,e=function(){var t,e,n,r;for(FS("/"===(t=YC[VC]),"Regular expression literal must start with a slash"),e=YC[VC++],n=!1,r=!1;VC<GC;)if(e+=t=YC[VC++],"\\"===t)RS((t=YC[VC++]).charCodeAt(0))&&tD({},kS),e+=t;else if(RS(t.charCodeAt(0)))tD({},kS);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||tD({},kS),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";VC<GC&&BS((t=YC[VC]).charCodeAt(0));)++VC,"\\"===t&&VC<GC?tD({},gS,MS):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&tD({},wS,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";tD({},wS)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){tD({},wS)}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:VC}}()),YS()):eD(ZS())}return n}();;)if(rD("."))nD("."),t=JS(".",t,uD());else if(rD("("))t=GS(t,lD());else{if(!rD("["))break;t=JS("[",t,cD())}return t}();if(XC.type===rS&&(rD("++")||rD("--")))throw new Error(CS);return t}function dD(){var t,e;if(XC.type!==rS&&XC.type!==tS)e=fD();else{if(rD("++")||rD("--"))throw new Error(CS);if(rD("+")||rD("-")||rD("~")||rD("!"))t=ZS(),e=dD(),e=function(t,e){const n=new HC(mS);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(iD("delete")||iD("void")||iD("typeof"))throw new Error(CS);e=fD()}}return e}function hD(t){let e=0;if(t.type!==rS&&t.type!==tS)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function pD(){var t,e;return t=function(){var t,e,n,r,i,o,a,s,l,u;if(t=XC,l=dD(),0===(i=hD(r=XC)))return l;for(r.prec=i,ZS(),e=[t,XC],o=[l,r,a=dD()];(i=hD(XC))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,l=o.pop(),e.pop(),n=VS(s,l,a),o.push(n);(r=ZS()).prec=i,o.push(r),e.push(XC),n=dD(),o.push(n)}for(n=o[u=o.length-1],e.pop();u>1;)e.pop(),n=VS(o[u-1].value,o[u-2],n),u-=2;return n}(),rD("?")&&(ZS(),e=pD(),nD(":"),t=function(t,e,n){const r=new HC(lS);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,pD())),t}function mD(){const t=pD();if(rD(","))throw new Error(CS);return t}var gD={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function yD(t){function e(e,n,r){return i=>function(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&Rt("Missing arguments to clamp function."),e.length>3&&Rt("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&Rt("Missing arguments to if function."),e.length>3&&Rt("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var vD,bD,xD,_D,wD,kD,AD,ED,MD,CD,SD,DD,FD,TD,ND,OD,zD=new Ex,RD=new Ex,PD={point:Gx,lineStart:Gx,lineEnd:Gx,polygonStart:function(){zD=new Ex,PD.lineStart=BD,PD.lineEnd=LD},polygonEnd:function(){var t=+zD;RD.add(t<0?Tx+t:t),this.lineStart=this.lineEnd=this.point=Gx},sphere:function(){RD.add(Tx)}};function BD(){PD.point=jD}function LD(){UD(vD,bD)}function jD(t,e){PD.point=UD,vD=t,bD=e,xD=t*=Ox,_D=Bx(e=(e*=Ox)/2+Fx),wD=Wx(e)}function UD(t,e){var n=(t*=Ox)-xD,r=n>=0?1:-1,i=r*n,o=Bx(e=(e*=Ox)/2+Fx),a=Wx(e),s=wD*a,l=_D*o+s*Bx(i),u=s*r*Wx(i);zD.add(Px(u,l)),xD=t,_D=o,wD=a}var qD,ID,WD,$D,HD,ZD,YD,VD,GD,XD,QD,JD,KD,tF,eF,nF,rF={point:iF,lineStart:aF,lineEnd:sF,polygonStart:function(){rF.point=lF,rF.lineStart=uF,rF.lineEnd=cF,TD=new Ex,PD.polygonStart()},polygonEnd:function(){PD.polygonEnd(),rF.point=iF,rF.lineStart=aF,rF.lineEnd=sF,zD<0?(kD=-(ED=180),AD=-(MD=90)):TD>Mx?MD=90:TD<-Mx&&(AD=-90),OD[0]=kD,OD[1]=ED},sphere:function(){kD=-(ED=180),AD=-(MD=90)}};function iF(t,e){ND.push(OD=[kD=t,ED=t]),e<AD&&(AD=e),e>MD&&(MD=e)}function oF(t,e){var n=lw([t*Ox,e*Ox]);if(FD){var r=cw(FD,n),i=cw([r[1],-r[0],0],r);hw(i),i=sw(i);var o,a=t-CD,s=a>0?1:-1,l=i[0]*Nx*s,u=zx(a)>180;u^(s*CD<l&&l<s*t)?(o=i[1]*Nx)>MD&&(MD=o):u^(s*CD<(l=(l+360)%360-180)&&l<s*t)?(o=-i[1]*Nx)<AD&&(AD=o):(e<AD&&(AD=e),e>MD&&(MD=e)),u?t<CD?fF(kD,t)>fF(kD,ED)&&(ED=t):fF(t,ED)>fF(kD,ED)&&(kD=t):ED>=kD?(t<kD&&(kD=t),t>ED&&(ED=t)):t>CD?fF(kD,t)>fF(kD,ED)&&(ED=t):fF(t,ED)>fF(kD,ED)&&(kD=t)}else ND.push(OD=[kD=t,ED=t]);e<AD&&(AD=e),e>MD&&(MD=e),FD=n,CD=t}function aF(){rF.point=oF}function sF(){OD[0]=kD,OD[1]=ED,rF.point=iF,FD=null}function lF(t,e){if(FD){var n=t-CD;TD.add(zx(n)>180?n+(n>0?360:-360):n)}else SD=t,DD=e;PD.point(t,e),oF(t,e)}function uF(){PD.lineStart()}function cF(){lF(SD,DD),PD.lineEnd(),zx(TD)>Mx&&(kD=-(ED=180)),OD[0]=kD,OD[1]=ED,FD=null}function fF(t,e){return(e-=t)<0?e+360:e}function dF(t,e){return t[0]-e[0]}function hF(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var pF={sphere:Gx,point:mF,lineStart:yF,lineEnd:xF,polygonStart:function(){pF.lineStart=_F,pF.lineEnd=wF},polygonEnd:function(){pF.lineStart=yF,pF.lineEnd=xF}};function mF(t,e){t*=Ox;var n=Bx(e*=Ox);gF(n*Bx(t),n*Wx(t),Wx(e))}function gF(t,e,n){++qD,WD+=(t-WD)/qD,$D+=(e-$D)/qD,HD+=(n-HD)/qD}function yF(){pF.point=vF}function vF(t,e){t*=Ox;var n=Bx(e*=Ox);tF=n*Bx(t),eF=n*Wx(t),nF=Wx(e),pF.point=bF,gF(tF,eF,nF)}function bF(t,e){t*=Ox;var n=Bx(e*=Ox),r=n*Bx(t),i=n*Wx(t),o=Wx(e),a=Px(Hx((a=eF*o-nF*i)*a+(a=nF*r-tF*o)*a+(a=tF*i-eF*r)*a),tF*r+eF*i+nF*o);ID+=a,ZD+=a*(tF+(tF=r)),YD+=a*(eF+(eF=i)),VD+=a*(nF+(nF=o)),gF(tF,eF,nF)}function xF(){pF.point=mF}function _F(){pF.point=kF}function wF(){AF(JD,KD),pF.point=mF}function kF(t,e){JD=t,KD=e,t*=Ox,e*=Ox,pF.point=AF;var n=Bx(e);tF=n*Bx(t),eF=n*Wx(t),nF=Wx(e),gF(tF,eF,nF)}function AF(t,e){t*=Ox;var n=Bx(e*=Ox),r=n*Bx(t),i=n*Wx(t),o=Wx(e),a=eF*o-nF*i,s=nF*r-tF*o,l=tF*i-eF*r,u=Ux(a,s,l),c=Vx(u),f=u&&-c/u;GD.add(f*a),XD.add(f*s),QD.add(f*l),ID+=c,ZD+=c*(tF+(tF=r)),YD+=c*(eF+(eF=i)),VD+=c*(nF+(nF=o)),gF(tF,eF,nF)}function EF(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function MF(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function CF(){return 0}function SF(t){return t instanceof Yf?t:new Yf(t)}const DF="intersect",FF="union",TF="_vgsid_",NF=Bt(TF),OF="index:unit";function zF(t,e){for(var n,r,i=e.fields,o=e.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=Bt.getter||Bt(r.field),Te(n=r.getter(t))&&(n=te(n)),Te(o[s])&&(o[s]=te(o[s])),Te(o[s][0])&&(o[s]=o[s].map(te)),"E"===r.type){if(Qt(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if("R"===r.type){if(!De(n,o[s]))return!1}else if("R-RE"===r.type){if(!De(n,o[s],!0,!1))return!1}else if("R-E"===r.type){if(!De(n,o[s],!1,!1))return!1}else if("R-LE"===r.type&&!De(n,o[s],!1,!0))return!1;return!0}const RF=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=EF,n=(e,n)=>EF(t(e),n),r=(e,n)=>t(e)-n):(e=t===EF||t===MF?t:CF,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}(NF),PF=RF.left,BF=RF.right;var LF={["".concat(TF,"_union")]:function(){const t=new Yf;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)for(const e of i)t.add(e);return t},["".concat(TF,"_intersect")]:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t=new Yf(t),n=n.map(SF);t:for(const i of t)for(const e of n)if(!e.has(i)){t.delete(i);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=te(e[0]),r=te(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=te(e[0]),r=te(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function jF(t,e,n,r){e[0].type!==WC&&Rt("First argument to selection functions must be a string literal.");const i=e[0].value,o="unit",a="@"+o,s=":"+i;(e.length>=2&&Kt(e).value)!==DF||Ee(r,a)||(r[a]=n.getData(i).indataRef(n,o)),Ee(r,s)||(r[s]=n.getData(i).tuplesRef())}function UF(t){const e=this.context.data[t];return e?e.values.value:[]}const qF=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},IF=qF("format"),WF=qF("timeFormat"),$F=qF("utcFormat"),HF=qF("timeParse"),ZF=qF("utcParse"),YF=new Date(2e3,0,1);function VF(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(YF.setYear(2e3),YF.setMonth(t),YF.setDate(e),WF.call(this,YF,n)):""}const GF="%",XF="$";function QF(t,e,n,r){e[0].type!==WC&&Rt("First argument to data functions must be a string literal.");const i=e[0].value,o=":"+i;if(!Ee(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(t){}}function JF(t,e,n,r){if(e[0].type===WC)KF(n,r,e[0].value);else for(t in n.scales)KF(n,r,t)}function KF(t,e,n){const r=GF+n;if(!Ee(e,r))try{e[r]=t.scaleRef(n)}catch(t){}}function tT(t,e){if(he(t))return t;if(Oe(t)){const r=e.scales[t];return r&&(n=r.value)&&!0===n[Ah]?r.value:void 0}var n}function eT(t,e){return function(n,r,i){if(n){const e=tT(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const nT=eT("area",(function(t){return RD=new Ex,Ax(t,PD),2*RD})),rT=eT("bounds",(function(t){var e,n,r,i,o,a,s;if(MD=ED=-(kD=AD=1/0),ND=[],Ax(t,rF),n=ND.length){for(ND.sort(dF),e=1,o=[r=ND[0]];e<n;++e)hF(r,(i=ND[e])[0])||hF(r,i[1])?(fF(r[0],i[1])>fF(r[0],r[1])&&(r[1]=i[1]),fF(i[0],r[1])>fF(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(s=fF(r[1],i[0]))>a&&(a=s,kD=i[0],ED=r[1])}return ND=OD=null,kD===1/0||AD===1/0?[[NaN,NaN],[NaN,NaN]]:[[kD,AD],[ED,MD]]})),iT=eT("centroid",(function(t){qD=ID=WD=$D=HD=ZD=YD=VD=0,GD=new Ex,XD=new Ex,QD=new Ex,Ax(t,pF);var e=+GD,n=+XD,r=+QD,i=Ux(e,n,r);return i<Cx&&(e=ZD,n=YD,r=VD,ID<Mx&&(e=WD,n=$D,r=HD),(i=Ux(e,n,r))<Cx)?[NaN,NaN]:[Px(n,e)*Nx,Vx(r/i)*Nx]}));function oT(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(e){t.warn(e)}return n[n.length-1]}function aT(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function sT(t){const e=yc(t);return.2126*aT(e.r)+.7152*aT(e.g)+.0722*aT(e.b)}function lT(t,e){return t===e||t!=t&&e!=e||(Qt(t)?!(!Qt(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!lT(t[n],e[n]))return!1;return!0}(t,e):!(!Jt(t)||!Jt(e))&&uT(t,e))}function uT(t,e){for(const n in t)if(!lT(t[n],e[n]))return!1;return!0}function cT(t){return e=>uT(t,e)}const fT={};function dT(t){return Qt(t)||ArrayBuffer.isView(t)?t:null}function hT(t){return dT(t)||(Oe(t)?t:null)}const pT=t=>t.data;function mT(t,e){const n=UF.call(e,t);return n.root&&n.root.lookup||{}}const gT=()=>"undefined"!=typeof window&&window||null;function yT(t,e,n){if(!t)return[];const[r,i]=t,o=(new am).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new am).union(e),o=t.marktype;return o?Nv(t,i,n,r):"group"===o?Ov(t,i,n,r):Rt("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,o,function(t){let e=null;if(t){const n=de(t.marktype),r=de(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))}const vT={random:()=>Q(),cumulativeNormal:it,cumulativeLogNormal:ct,cumulativeUniform:pt,densityNormal:rt,densityLogNormal:ut,densityUniform:ht,quantileNormal:ot,quantileLogNormal:ft,quantileUniform:mt,sampleNormal:nt,sampleLogNormal:lt,sampleUniform:dt,isArray:Qt,isBoolean:Fe,isDate:Te,isDefined:t=>void 0!==t,isNumber:Ne,isObject:Jt,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:Oe,isTuple:ka,isValid:t=>null!=t&&t==t,toBoolean:Le,toDate:t=>Ue(t),toNumber:te,toString:qe,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return hT(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return dT(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return hT(t).lastIndexOf(...n)},replace:function(t,e,n){return he(n)&&Rt("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return dT(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return hT(t).slice(...n)},flush:function(t,e,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,l=t[0],u=Kt(t);u<l&&(s=l,l=u,u=s),s=Math.abs(e-l);const c=Math.abs(u-e);return s<c&&s<=a?r:c<=a?i:o},lerp:function(t,e){const n=t[0],r=Kt(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),we(...t)},pad:function(t,e,n,r){const i=n||" ",o=t+"",a=e-o.length;return a<=0?o:"left"===r?Re(i,a)+o:"center"===r?Re(i,~~(a/2))+o+Re(i,Math.ceil(a/2)):o+Re(i,a)},peek:Kt,pluck:function(t,e){const n=fT[e]||(fT[e]=Bt(e));return Qt(t)?t.map(n):n(t)},span:Pe,inrange:De,truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",o=t+"",a=o.length,s=Math.max(0,e-i.length);return a<=e?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},rgb:yc,lab:Ad,hcl:Fd,hsl:Mc,luminance:sT,contrast:function(t,e){const n=sT(t),r=sT(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:is,format:IF,utcFormat:$F,utcParse:ZF,utcOffset:function(t,e,n){return ei(ti(t),e,n)},utcSequence:function(t,e,n,r){return ni(ti(t),e,n,r)},timeFormat:WF,timeParse:HF,timeOffset:function(t,e,n){return ei(Kr(t),e,n)},timeSequence:function(t,e,n,r){return ni(Kr(t),e,n,r)},timeUnitSpecifier:function(t,e){const n=we({},Nr,e),r=Tr(t),i=r.length;let o,a,s="",l=0;for(l=0;l<i;)for(o=r.length;o>l;--o)if(a=r.slice(l,o).join("-"),null!=n[a]){s+=n[a],l=o;break}return s.trim()},monthFormat:function(t){return VF.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return VF.call(this,t,1,"%b")},dayFormat:function(t){return VF.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return VF.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return Pr(new Date(t))},utcweek:function(t){return Ur(new Date(t))},dayofyear:function(t){return Rr(new Date(t))},utcdayofyear:function(t){return jr(new Date(t))},warn:function(){return oT(this.context.dataflow,"warn",arguments)},info:function(){return oT(this.context.dataflow,"info",arguments)},debug:function(){return oT(this.context.dataflow,"debug",arguments)},extent:t=>ke(t),inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:yT,clampRange:function(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=gT();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=gT();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return Qd(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(It).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?Op(n,e=e||wp(t)):t}},panLinear:function(t,e){return ae(t,e,te,jt)},panLog:function(t,e){var n=Math.sign(t[0]);return ae(t,e,ne(n),ee(n))},panPow:function(t,e,n){return ae(t,e,oe(n),oe(1/n))},panSymlog:function(t,e,n){return ae(t,e,re(n),ie(n))},zoomLinear:le,zoomLog:ue,zoomPow:ce,zoomSymlog:fe,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){const a=this.context.dataflow,s=this.context.data[t],l=s.input,u=a.stamp();let c,f,d=s.changes;if(!1===a._trigger||!(l.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=a.changeset(),d.stamp=u,a.runAfter((()=>{s.modified=!0,a.pulse(l,d).run()}),!0,1)),n&&(c=!0===n?It:Qt(n)||ka(n)?n:cT(n),d.remove(c)),e&&d.insert(e),r&&(c=cT(r),l.value.some(c)?d.remove(c):d.insert(r)),i)for(f in o)d.modify(i,f,o[f]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(t=de(t))[t.length-1];return void 0===i||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return de(t).reduce(((e,n,r)=>{let[i,o]=n;return e+(0==r?"M ".concat(i,",").concat(o," "):r===t.length-1?" Z":"L ".concat(i,",").concat(o," "))}),"")},intersectLasso:function(t,e,n){const{x:r,y:i,mark:o}=n,a=(new am).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of e)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);return a.translate(r,i),yT([[a.x1,a.y1],[a.x2,a.y2]],t,o).filter((t=>function(t,e,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,s]=n[o],[l,u]=n[i];u>e!=s>e&&t<(a-l)*(e-u)/(s-u)+l&&r++}return 1&r}(t.x,t.y,e)))}},bT=["view","item","group","xy","x","y"],xT="this.",_T={},wT={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(Be(XF+t),"]"),functions:function(t){const e=yD(t);bT.forEach((t=>e[t]="event.vega."+t));for(const n in vT)e[n]=xT+n;return we(e,function(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=JF,n._range=JF,n._scale=JF;const r=e=>"_["+(e.type===WC?Be(GF+e.value):Be(GF)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}(t,vT,_T)),e},constants:gD,visitors:_T},kT=function(t){const e=(t=t||{}).allowed?Ie(t.allowed):{},n=t.forbidden?Ie(t.forbidden):{},r=t.constants||gD,i=(t.functions||yD)(f),o=t.globalvar,a=t.fieldvar,s=he(o)?o:t=>"".concat(o,'["').concat(t,'"]');let l={},u={},c=0;function f(t){if(Oe(t))return t;const e=d[t.type];return null==e&&Rt("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return c>0?i:Ee(n,i)?Rt("Illegal identifier: "+i):Ee(r,i)?r[i]:Ee(e,i)?i:(l[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=f(t.object);e&&(c+=1);const r=f(t.property);return n===a&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&Rt("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Ee(i,e)&&i[e];return r||Rt("Unrecognized function: "+e),he(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(f).join(",")+"]",BinaryExpression:t=>"("+f(t.left)+" "+t.operator+" "+f(t.right)+")",UnaryExpression:t=>"("+t.operator+f(t.argument)+")",ConditionalExpression:t=>"("+f(t.test)+"?"+f(t.consequent)+":"+f(t.alternate)+")",LogicalExpression:t=>"("+f(t.left)+t.operator+f(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(f).join(",")+"}",Property:t=>{c+=1;const e=f(t.key);return c-=1,e+":"+f(t.value)}};function h(t){const e={code:f(t),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},e}return h.functions=i,h.constants=r,h}(wT);function AT(t,e,n){return 1===arguments.length?vT[t]:(vT[t]=e,n&&(_T[t]=n),kT&&(kT.functions[t]=xT+t),this)}function ET(t,e){const n={};let r;try{r=function(t){VC=0,GC=(YC=t).length,XC=null,YS();const e=mD();if(XC.type!==JC)throw new Error("Unexpect token after expression.");return e}(t=Oe(t)?t:Be(t)+"")}catch(e){Rt("Expression parse error: "+t)}r.visit((t=>{if(t.type!==$C)return;const r=t.callee.name,i=wT.visitors[r];i&&i(r,t.arguments,e,n)}));const i=kT(r);return i.globals.forEach((t=>{const r=XF+t;!Ee(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:we({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}AT("bandwidth",(function(t,e){const n=tT(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),JF),AT("copy",(function(t,e){const n=tT(t,(e||this).context);return n?n.copy():void 0}),JF),AT("domain",(function(t,e){const n=tT(t,(e||this).context);return n?n.domain():[]}),JF),AT("range",(function(t,e){const n=tT(t,(e||this).context);return n&&n.range?n.range():[]}),JF),AT("invert",(function(t,e,n){const r=tT(t,(n||this).context);return r?Qt(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),JF),AT("scale",(function(t,e,n){const r=tT(t,(n||this).context);return r?r(e):void 0}),JF),AT("gradient",(function(t,e,n,r,i){t=tT(t,(i||this).context);const o=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let a=t.domain(),s=a[0],l=Kt(a),u=jt;return l-s?u=Bh(t,s,l):t=(t.interpolator?Mh("sequential")().interpolator(t.interpolator()):Mh("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,l=1]),t.ticks&&(a=t.ticks(+r||15),s!==a[0]&&a.unshift(s),l!==Kt(a)&&a.push(l)),a.forEach((e=>o.stop(u(e),t(e)))),o}),JF),AT("geoArea",nT,JF),AT("geoBounds",rT,JF),AT("geoCentroid",iT,JF),AT("geoShape",(function(t,e,n){const r=tT(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),JF),AT("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==WC&&Rt("First argument to indata must be a string literal."),e[1].type!==WC&&Rt("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,a="@"+o;Ee(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),AT("data",UF,QF),AT("treePath",(function(t,e,n){const r=mT(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(pT):void 0}),QF),AT("treeAncestors",(function(t,e){const n=mT(t,this)[e];return n?n.ancestors().map(pT):void 0}),QF),AT("vlSelectionTest",(function(t,e,n){for(var r,i,o,a,s,l=this.context.data[t],u=l?l.values.value:[],c=l?l[OF]&&l[OF].value:void 0,f=n===DF,d=u.length,h=0;h<d;++h)if(r=u[h],c&&f){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=zF(e,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(f^(s=zF(e,r)))return s;return d&&f}),jF),AT("vlSelectionIdTest",(function(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],o=r?r[OF]&&r[OF].value:void 0,a=n===DF,s=NF(e),l=PF(i,s);if(l===i.length)return!1;if(NF(i[l])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(BF(i,s)-l<o.size)return!1}return!0}),jF),AT("vlSelectionResolve",(function(t,e,n,r){for(var i,o,a,s,l,u,c,f,d,h,p,m,g=this.context.data[t],y=g?g.values.value:[],v={},b={},x={},_=y.length,w=0;w<_;++w)if(s=(i=y[w]).unit,o=i.fields,a=i.values,o&&a){for(p=0,m=o.length;p<m;++p)l=o[p],f=(c=v[l.field]||(v[l.field]={}))[s]||(c[s]=[]),x[l.field]=d=l.type.charAt(0),h=LF["".concat(d,"_union")],c[s]=h(f,de(a[p]));n&&(f=b[s]||(b[s]=[])).push(de(a).reduce(((t,e,n)=>(t[o[n].field]=e,t)),{}))}else l=TF,u=NF(i),(f=(c=v[l]||(v[l]={}))[s]||(c[s]=[])).push(u),n&&(f=b[s]||(b[s]=[])).push({[TF]:u});return e=e||FF,v[TF]?v[TF]=LF["".concat(TF,"_").concat(e)](...Object.values(v[TF])):Object.keys(v).forEach((t=>{v[t]=Object.keys(v[t]).map((e=>v[t][e])).reduce(((n,r)=>void 0===n?r:LF["".concat(x[t],"_").concat(e)](n,r)))})),y=Object.keys(b),n&&y.length&&(v[r?"vlPoint":"vlMulti"]=e===FF?{or:y.reduce(((t,e)=>(t.push(...b[e]),t)),[])}:{and:y.map((t=>({or:b[t]})))}),v}),jF),AT("vlSelectionTuples",(function(t,e){return t.map((t=>we(e.fields?{values:e.fields.map((e=>(e.getter||(e.getter=Bt(e.field)))(t.datum)))}:{[TF]:NF(t.datum)},e)))}));const MT=Ie(["rule"]),CT=Ie(["group","image","rect"]);function ST(t){return(t+"").toLowerCase()}function DT(t,e,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var FT={operator:(t,e)=>DT(t,["_"],e.code),parameter:(t,e)=>DT(t,["datum","_"],e.code),event:(t,e)=>DT(t,["event"],e.code),handler:(t,e)=>DT(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const t="o["+Be(o)+"]";i+="$=".concat(r[o].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(t,e){let n="";return MT[e]||(t.x2&&(t.x?(CT[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(CT[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",DT(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(Be).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let o,a;return t.path?(o="a".concat(t.path),a="b".concat(t.path)):((n=n||{})["f"+r]=t,o="this.f".concat(r,"(a)"),a="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function TT(t,e,n){if(!t||!Jt(t))return t;for(let r,i=0,o=NT.length;i<o;++i)if(r=NT[i],Ee(t,r.key))return r.parse(t,e,n);return t}var NT=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||Rt("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=ze(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=Dt(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=Bt(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=Dt(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=de(t.$compare).map((t=>t&&t.$tupleid?Aa:t));return e.fn[n]||(e.fn[n]=me(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>e.detach(o),a}}},{key:"$tupleid",parse:function(){return Aa}}];const OT={skip:!0};function zT(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||FT,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function RT(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function PT(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}zT.prototype=RT.prototype={fork(){const t=new RT(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),"collect"===ST(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const o in t.data){const r=n.data[o]||(n.data[o]={});t.data[o].forEach((t=>r[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[ST(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;"operator"!==ST(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||Rt("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=Qt(i)?i.map((t=>TT(t,n,e))):TT(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&Rt("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=Jt(r=t.source)?r.$ref:r,i=n.get(r),o=t.update,a=void 0;i||Rt("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(t,i,e,o,a)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],OT)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(It).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const BT="default";function LT(t,e){const n=t.globalCursor()?"undefined"!=typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function jT(t,e){var n=t._runtime.data;return Ee(n,e)||Rt("Unrecognized data set: "+e),n[e]}function UT(t,e){Ta(e)||Rt("Second argument to changes must be a changeset.");const n=jT(this,t);return n.modified=!0,this.pulse(n.input,e)}function qT(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function IT(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function WT(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}const $T="view",HT={trap:!1};function ZT(t,e,n,r){t._eventListeners.push({type:n,sources:de(e),handler:r})}function YT(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||Jt(r)&&!r[n])||(t.warn("Blocked ".concat(e," ").concat(n," event listener.")),!1)}function VT(t){return t.item}function GT(t){return t.item.mark.source}function XT(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function QT(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}const JT="vega-bind-radio";function KT(t,e,n,r){const i=n.event||"input",o=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,o),ZT(r,e,i,o),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!=typeof Event?new Event(t):{type:t}}(i))}}function tN(t,e,n,r){const i=r.signal(n.signal),o=QT("div",{class:"vega-bind"}),a="radio"===n.input?o:o.appendChild(QT("label"));a.appendChild(QT("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(o);let s=eN;switch(n.input){case"checkbox":s=nN;break;case"select":s=rN;break;case"radio":s=iN;break;case"range":s=oN}s(t,a,n,i)}function eN(t,e,n,r){const i=QT("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function nN(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=QT("input",i);e.appendChild(o),o.addEventListener("change",(()=>t.update(o.checked))),t.elements=[o],t.set=t=>o.checked=!!t||null}function rN(t,e,n,r){const i=QT("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};aN(t,r)&&(n.selected=!0),i.appendChild(QT("option",n,(o[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(aN(n.options[e],t))return void(i.selectedIndex=e)}}function iN(t,e,n,r){const i=QT("span",{class:JT}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,a)=>{const s={type:"radio",name:n.signal,value:e};aN(e,r)&&(s.checked=!0);const l=QT("input",s);l.addEventListener("change",(()=>t.update(e)));const u=QT("label",{},(o[a]||e)+"");return u.prepend(l),i.appendChild(u),l})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)aN(n[t].value,e)&&(n[t].checked=!0)}}function oN(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||dn(o,i,100),s=QT("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const l=QT("span",{},+r);e.appendChild(s),e.appendChild(l);const u=()=>{l.textContent=s.value,t.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),t.elements=[s],t.set=t=>{s.value=t,l.textContent=t}}function aN(t,e){return t===e||t+""==e+""}function sN(t,e,n,r,i,o){return(e=e||new r(t.loader())).initialize(n,qT(t),IT(t),WT(t),i,o).background(t.background())}function lN(t,e){return e?function(){try{e.apply(this,arguments)}catch(e){t.error(e)}}:null}function uN(t,e,n){if("string"==typeof e){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.textContent=""}catch(n){e=null,t.error(n)}return e}const cN=t=>+t||0;function fN(t){return Jt(t)?{top:cN(t.top),bottom:cN(t.bottom),left:cN(t.left),right:cN(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(cN(t))}async function dN(t,e,n,r){const i=Tv(e),o=i&&i.headless;return o||Rt("Unrecognized renderer type: "+e),await t.runAsync(),sN(t,null,null,o,n,r).renderAsync(t._scenegraph.root)}var hN="width",pN="height",mN="padding",gN={skip:!0};function yN(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===mN?r.left+r.right:0)}function vN(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===mN?r.top+r.bottom:0)}function bN(t,e){return e.modified&&Qt(e.input.value)&&t.indexOf("_:vega:_")}function xN(t,e){return!("parent"===t||e instanceof rs.proxy)}function _N(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":Qt(t)?wN(t):Jt(t)&&!Te(t)?(e=t,Object.keys(e).map((t=>{const n=e[t];return t+": "+(Qt(n)?wN(n):kN(n))})).join("\n")):t+"";var e}(r))}function wN(t){return"["+t.map(kN).join(", ")+"]"}function kN(t){return Qt(t)?"[\u2026]":Jt(t)&&!Te(t)?"{\u2026}":t}function AN(t,e){return Ee(t._signals,e)?t._signals[e]:Rt("Unrecognized signal name: "+Be(e))}function EN(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function MN(t,e,n,r){let i=EN(n,r);return i||(i=lN(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function CN(t,e,n){const r=EN(e,n);return r&&e._targets.remove(r),t}Se((function(t,e){const n=this;if(e=e||{},ts.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=we({},t.locale,e.locale);n.locale(function(t,e){const n=t?Wo(t):$o(),r=e?Yo(e):Vo();return Go(n,r)}(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||Sv,n._scenegraph=new ly;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||_N,n._redraw=!0,n._handler=(new zy).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=we({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{Qt(t[e])&&(t[e]=Ie(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return function(t,e,n,r){return new zT(t,e,n,r)}(t,rs,vT,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:we({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=yN(n,n._width),n._viewHeight=vN(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e[hN],r=e[pN],i=e[mN];function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=yN(t,e.size),o()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=vN(t,e.size),o()}),{size:r});const a=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:BT,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const r=e.value,i=r?Oe(r)?r:r.user:BT,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return Oe(n)||(r=n.item,n=n.user),LT(t,n&&n!==BT?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}),ts,{async evaluate(t,e,n){if(await ts.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=WT(r=this),o=qT(r),a=IT(r),r._renderer.background(r.background()),r._renderer.resize(o,a,i),r._handler.origin(i),r._resizeListeners.forEach((t=>{try{t(o,a)}catch(t){r.error(t)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(t){this.error(t)}var r,i,o,a;return n&&xa(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&PT(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=AN(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",fN(t)):fN(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(Tv(t)||Rt("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(ts.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(AN(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(hN,n,gN),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(pN,r,gN),a._resizeHeight.skip(!0)),a._viewWidth!==t&&(a._resize=1,a._viewWidth=t),a._viewHeight!==e&&(a._resize=1,a._viewHeight=e),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=lN(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return MN(this,t,AN(this,t),e)},removeSignalListener(t,e){return CN(this,AN(this,t),e)},addDataListener(t,e){return MN(this,t,jT(this,t).values,e)},removeDataListener(t,e){return CN(this,jT(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=LT(this,null);this._globalCursor=!!t,e&&LT(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new jA,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?BA():+n,r._restart((function o(a){a+=i,r._restart(o,i+=e,n),t(a)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,o=new Ua(n),a=function(n,r){i.runAsync(null,(()=>{t===$T&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),o.receive(function(t,e,n){var r,i,o=t._renderer,a=o&&o.canvas();return a&&(i=WT(t),(r=my(e.changedTouches?e.changedTouches[0]:e,a))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;Oe(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:xe(t),item:xe(e||{}),group:i,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}(t,n,r),e}(i,n,r))}))};if("timer"===t)YT(i,"timer",e)&&i.timer(a,e);else if(t===$T)YT(i,"view",e)&&i.addEventListener(e,a,HT);else if("window"===t?YT(i,"window",e)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&YT(i,"selector",e)&&(r=Array.from(document.querySelectorAll(t))),r){for(var s=0,l=r.length;s<l;++s)r[s].addEventListener(e,a);ZT(i,r,e,a)}else i.warn("Can not resolve event source: "+t);return o},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=o.length;--t>=0;)for(e=(n=o[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",VT),GT,XT(t)),this.on(this.events("view","mouseout",VT),GT,XT(e)),this},data:function(t,e){return arguments.length<2?jT(this,t).values.value:UT.call(this,t,Na().remove(It).insert(e))},change:UT,insert:function(t,e){return UT.call(this,t,Na().insert(e))},remove:function(t,e){return UT.call(this,t,Na().remove(e))},scale:function(t){var e=this._runtime.scales;return Ee(e,t)||Rt("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Tv(r);t=n._el=t?uN(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),PT(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||zy,s=t?o.renderer:o.headless;return n._renderer=s?sN(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),lN(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,WT(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,a),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=uN(n,e,!0):t.appendChild(QT("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=uN(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=_e(r.debounce,i.update))),(null==r.input&&r.element?KT:tN)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==Sv&&t!==Dv&&"png"!==t&&Rt("Unrecognized image type: "+t);const n=await dN(this,t,e);return t===Dv?function(t,e){const n=new Blob([t],{type:"image/svg+xml"});return window.URL.createObjectURL(n)}(n.svg()):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await dN(this,Sv,t,e)).canvas()},toSVG:async function(t){return(await dN(this,Dv,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:bN,signals:xN,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this}});const SN="[",DN="]",FN="{",TN="}",NN=":",ON=",",zN="@",RN=">",PN=/[[\]{}]/,BN={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let LN,jN;function UN(t,e,n,r,i){const o=t.length;let a,s=0;for(;e<o;++e){if(a=t[e],!s&&a===n)return e;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return e}function qN(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=UN(t,i,ON,SN+FN,DN+TN),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function IN(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=UN(t,r,DN,SN,DN),r===e)throw"Empty between selector: "+t;if(n=qN(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if((t=t.slice(r+1).trim())[0]!==RN)throw"Expected '>' after between selector: "+t;n=n.map(IN);const i=IN(t.slice(1).trim());return i.between?{between:n,stream:i}:(i.between=n,i)}(t):function(t){const e={source:LN},n=[];let r,i,o=[0,0],a=0,s=0,l=t.length,u=0;if(t[l-1]===TN){if(u=t.lastIndexOf(FN),!(u>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(ON);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!=n)throw t;return n}))}(t.substring(u+1,l-1))}catch(e){throw"Invalid throttle specification: "+t}l=(t=t.slice(0,u).trim()).length,u=0}if(!l)throw t;if(t[0]===zN&&(a=++u),r=UN(t,u,NN),r<l&&(n.push(t.substring(s,r).trim()),s=u=++r),u=UN(t,u,SN),u===l)n.push(t.substring(s,l).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===l)throw"Unmatched left bracket: "+t;for(;u<l;){if(u=UN(t,u,DN),u===l)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<l-1&&t[++u]!==SN)throw"Expected left bracket: "+t;s=++u}if(!(l=n.length)||PN.test(n[l-1]))throw"Invalid event selector: "+t;var c;return l>1?(e.type=n[1],a?e.markname=n[0].slice(1):(c=n[0],jN[c]?e.marktype=n[0]:e.source=n[0])):e.type=n[0],"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1)),null!=i&&(e.filter=i),o[0]&&(e.throttle=o[0]),o[1]&&(e.debounce=o[1]),e}(t)}const WN=t=>Jt(t)&&!Qt(t)?we({},t):{value:t};function $N(t,e,n,r){return null!=n?(Jt(n)&&!Qt(n)||Qt(n)&&n.length&&Jt(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1):0}function HN(t,e,n){for(const r in e)$N(t,r,e[r]);for(const r in n)$N(t,r,n[r],"update")}function ZN(t,e,n){for(const r in e)n&&Ee(n,r)||(t[r]=we(t[r]||{},e[r]));return t}function YN(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const VN="mark",GN="frame",XN="scope",QN="legend-band",JN="legend-gradient",KN="legend-label",tO="legend-symbol";function eO(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const nO=t=>Oe(t)?Be(t):t.signal?"(".concat(t.signal,")"):aO(t);function rO(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:Be(t)));for(;e.length&&null==Kt(e);)e.pop();return e.unshift(nO(t.gradient)),"gradient(".concat(e.join(","),")")}(t);let e=t.signal?"(".concat(t.signal,")"):t.color?function(t){return t.c?iO("hcl",t.h,t.c,t.l):t.h||t.s?iO("hsl",t.h,t.s,t.l):t.l||t.a?iO("lab",t.l,t.a,t.b):t.r||t.g||t.b?iO("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?aO(t.field):void 0!==t.value?Be(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=nO(t.scale);return null!=t.range?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(void 0!==e&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(1==+t.band?"":"*"+oO(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),null==e&&(e="0")),e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e="pow(".concat(e,",").concat(oO(t.exponent),")")),null!=t.mult&&(e+="*".concat(oO(t.mult))),null!=t.offset&&(e+="+".concat(oO(t.offset))),t.round&&(e="round(".concat(e,")")),e}const iO=(t,e,n,r)=>"(".concat(t,"(").concat([e,n,r].map(rO).join(","),")+'')");function oO(t){return Jt(t)?"("+rO(t)+")":t}function aO(t){return sO(Jt(t)?t:{datum:t})}function sO(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):Rt("Invalid field reference: "+Be(t));return t.signal||(r=Oe(r)?Pt(r).map(Be).join("]["):sO(r)),e+"["+r+"]"}function lO(t,e,n,r){const i={},o={};for(const s in t)null!=t[s]&&(i[s]=uO((a=t[s],Qt(a)?function(t){let e="";return t.forEach((t=>{const n=rO(t);e+=t.test?"(".concat(t.test,")?").concat(n,":"):n})),":"===Kt(e)&&(e+="null"),e}(a):rO(a)),r,n,o));var a;return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function uO(t,e,n,r){const i=ET(t,e);return i.$fields.forEach((t=>r[t]=1)),we(n,i.$params),i.$expr}const cO=["value","update","init","react","bind"];function fO(t,e){Rt(t+' for "outer" push: '+Be(e))}function dO(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function hO(t,e,n,r){return new dO(t,e,n,r)}function pO(t,e){return hO("operator",t,e)}function mO(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function gO(t,e){return e?{$field:t,$name:e}:{$field:t}}const yO=gO("key");function vO(t,e){return{$compare:t,$order:e}}function bO(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const xO="scope",_O="view";function wO(t){return t&&t.signal}function kO(t){if(wO(t))return!0;if(Jt(t))for(const e in t)if(kO(t[e]))return!0;return!1}function AO(t,e){return null!=t?t:e}function EO(t){return t&&t.signal||t}const MO="timer";function CO(t,e){return(t.merge?SO:t.stream?DO:t.type?FO:Rt("Invalid stream specification: "+Be(t)))(t,e)}function SO(t,e){const n=TO({merge:t.merge.map((t=>CO(t,e)))},t,e);return e.addStream(n).id}function DO(t,e){const n=TO({stream:CO(t.stream,e)},t,e);return e.addStream(n).id}function FO(t,e){let n;var r;t.type===MO?(n=e.event(MO,t.throttle),t={between:t.between,filter:t.filter}):n=e.event((r=t.source)===xO?_O:r||_O,t.type);const i=TO({stream:n},t,e);return 1===Object.keys(i).length?n:e.addStream(i).id}function TO(t,e,n){let r=e.between;return r&&(2!==r.length&&Rt('Stream "between" parameter must have 2 entries: '+Be(e)),t.between=[CO(r[0],n),CO(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===xO&&r.push("inScope(event.item)"),r.length&&(t.filter=ET("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const NO={code:"_.$value",ast:{type:"Identifier",value:"value"}};function OO(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const zO=t=>(e,n,r)=>hO(t,n,e||void 0,r),RO=zO("aggregate"),PO=zO("axisticks"),BO=zO("bound"),LO=zO("collect"),jO=zO("compare"),UO=zO("datajoin"),qO=zO("encode"),IO=zO("expression"),WO=zO("facet"),$O=zO("field"),HO=zO("key"),ZO=zO("legendentries"),YO=zO("load"),VO=zO("mark"),GO=zO("multiextent"),XO=zO("multivalues"),QO=zO("overlap"),JO=zO("params"),KO=zO("prefacet"),tz=zO("projection"),ez=zO("proxy"),nz=zO("relay"),rz=zO("render"),iz=zO("scale"),oz=zO("sieve"),az=zO("sortitems"),sz=zO("viewlayout"),lz=zO("values");let uz=0;const cz={min:"min",max:"max",count:"sum"};function fz(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=mz(t.domain,t,e),null!=t.range&&(n.range=kz(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=dz(t.type||t),null!=t.gamma&&(e.interpolateGamma=dz(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=function(t){return Jt(t)?{interval:dz(t.interval),step:dz(t.step)}:dz(t)}(t.nice)),null!=t.bins&&(n.bins=function(t,e){return t.signal||Qt(t)?hz(t,e):e.objectProperty(t)}(t.bins,e)),t)Ee(n,r)||"name"===r||(n[r]=dz(t[r],e))}function dz(t,e){return Jt(t)?t.signal?e.signalRef(t.signal):Rt("Unsupported object: "+Be(t)):t}function hz(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>dz(t,e)))}function pz(t){Rt("Can not find data set: "+Be(t))}function mz(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(Qt(t)?gz:t.fields?vz:yz)(t,e,n);null==e.domainMin&&null==e.domainMax||Rt("No scale domain defined for domainMin/domainMax to override.")}function gz(t,e,n){return t.map((t=>dz(t,n)))}function yz(t,e,n){const r=n.getData(t.data);return r||pz(t.data),Fh(e.type)?r.valuesRef(n,t.field,xz(t.sort,!1)):zh(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function vz(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=Oe(e)?{data:r,field:e}:Qt(e)||e.signal?function(t,e){const n="_:vega:_"+uz++,r=LO({});if(Qt(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+Be(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,oz({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(Fh(e.type)?bz:zh(e.type)?_z:wz)(t,n,i)}function bz(t,e,n){const r=xz(t.sort,!0);let i,o;const a=n.map((t=>{const n=e.getData(t.data);return n||pz(t.data),n.countsRef(e,t.field,r)})),s={groupby:yO,pulse:a};r&&(i=r.op||"count",o=r.field?bO(i,r.field):"count",s.ops=[cz[i]],s.fields=[e.fieldRef(o)],s.as=[o]),i=e.add(RO(s));const l=e.add(LO({pulse:mO(i)}));return o=e.add(lz({field:yO,sort:e.sortRef(r),pulse:mO(l)})),mO(o)}function xz(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!cz[t.op]&&Rt("Multiple domain scales can not be sorted using "+t.op):Rt("No field provided for sort aggregate op: "+t.op):Jt(t)?t.field="key":t={field:"key"}),t}function _z(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||pz(t.data),n.domainRef(e,t.field)}));return mO(e.add(XO({values:r})))}function wz(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||pz(t.data),n.extentRef(e,t.field)}));return mO(e.add(GO({extents:r})))}function kz(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(Oe(i)){if(r&&Ee(r,i))return kz(t=we({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Fh(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Rt("Unrecognized scale range value: "+Be(i))}else{if(i.scheme)return n.scheme=Qt(i.scheme)?hz(i.scheme,e):dz(i.scheme,e),i.extent&&(n.schemeExtent=hz(i.extent,e)),void(i.count&&(n.schemeCount=dz(i.count,e)));if(i.step)return void(n.rangeStep=dz(i.step,e));if(Fh(t.type)&&!Qt(i))return mz(i,t,e);Qt(i)||Rt("Unsupported range type: "+Be(i))}return i.map((t=>(Qt(t)?hz:dz)(t,e)))}function Az(t,e,n){return Qt(t)?t.map((t=>Az(t,e,n))):Jt(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:Rt("Unsupported parameter object: "+Be(t)):t}const Ez="top",Mz="left",Cz="right",Sz="bottom",Dz="center",Fz="vertical",Tz="start",Nz="end",Oz="index",zz="label",Rz="offset",Pz="perc",Bz="perc2",Lz="value",jz="guide-label",Uz="guide-title",qz="symbol",Iz="gradient",Wz="discrete",$z="size",Hz=[$z,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],Zz={name:1,style:1,interactive:1},Yz={value:0},Vz={value:1},Gz="group",Xz="rect",Qz="rule",Jz="symbol",Kz="text";function tR(t){return t.type=Gz,t.interactive=t.interactive||!1,t}function eR(t,e){const n=(n,r)=>AO(t[n],AO(e[n],r));return n.isVertical=n=>Fz===AO(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>AO(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>AO(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>AO(t.columns,AO(e.columns,+n.isVertical(!0))),n}function nR(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function rR(t,e,n){return"item.anchor === '".concat(Tz,"' ? ").concat(t," : item.anchor === '").concat(Nz,"' ? ").concat(e," : ").concat(n)}const iR=rR(Be(Mz),Be(Cz),Be(Dz));function oR(t,e){return e?t?Jt(t)?Object.assign({},t,{offset:oR(t.offset,e)}):{value:t,offset:e}:e:t}function aR(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=ZN(t.encode,e,Zz)):t.interactive=!1,t}function sR(t,e,n,r){const i=eR(t,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let l,u,c,f,d;o?(u=[0,1],c=[0,0],f=a,d=s):(u=[0,0],c=[1,0],f=s,d=a);const h={enter:l={opacity:Yz,x:Yz,y:Yz,width:WN(f),height:WN(d)},update:we({},l,{opacity:Vz,fill:{gradient:e,start:u,stop:c}}),exit:{opacity:Yz}};return HN(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),aR({type:Xz,role:JN,encode:h},r)}function lR(t,e,n,r,i){const o=eR(t,n),a=o.isVertical(),s=o.gradientThickness(),l=o.gradientLength();let u,c,f,d,h="";a?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:Yz,fill:{scale:e,field:Lz}};p[u]={signal:h+"datum."+Pz,mult:l},p[c]=Yz,p[f]={signal:h+"datum."+Bz,mult:l},p[d]=WN(s);const m={enter:p,update:we({},p,{opacity:Vz}),exit:{opacity:Yz}};return HN(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),aR({type:Xz,role:QN,key:Lz,from:i,encode:m},r)}const uR="datum.".concat(Pz,'<=0?"').concat(Mz,'":datum.').concat(Pz,'>=1?"').concat(Cz,'":"').concat(Dz,'"'),cR="datum.".concat(Pz,'<=0?"').concat(Sz,'":datum.').concat(Pz,'>=1?"').concat(Ez,'":"middle"');function fR(t,e,n,r){const i=eR(t,e),o=i.isVertical(),a=WN(i.gradientThickness()),s=i.gradientLength();let l,u,c,f,d=i("labelOverlap"),h="";const p={enter:l={opacity:Yz},update:u={opacity:Vz,text:{field:zz}},exit:{opacity:Yz}};return HN(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:AO(t.labelLimit,e.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=u.baseline={signal:cR},c="y",f="x",h="1-"):(l.align=u.align={signal:uR},l.baseline={value:"top"},c="x",f="y"),l[c]=u[c]={signal:h+"datum."+Pz,mult:s},l[f]=u[f]=a,a.offset=AO(t.labelOffset,e.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+Oz}:void 0,aR({type:Kz,role:KN,style:jz,key:Lz,from:r,encode:p,overlap:d},n)}function dR(t,e,n,r,i){const o=eR(t,e),a=n.entries,s=!(!a||!a.interactive),l=a?a.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(Rz," : datum.").concat($z),h=u?WN(u):{field:$z},p="datum.".concat(Oz),m="max(1, ".concat(i,")");let g,y,v,b,x;h.mult=.5,g={enter:y={opacity:Yz,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Vz,x:y.x,y:y.y},exit:{opacity:Yz}};let _=null,w=null;t.fill||(_=e.symbolBaseFillColor,w=e.symbolBaseStrokeColor),HN(g,{fill:o("symbolFillColor",_),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",w),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),Hz.forEach((e=>{t[e]&&(v[e]=y[e]={scale:t[e],field:Lz})}));const k=aR({type:Jz,role:tO,key:Lz,from:f,clip:!!u||void 0,encode:g},n.symbols),A=WN(c);A.offset=o("labelOffset"),g={enter:y={opacity:Yz,x:{signal:d,offset:A},y:h},update:v={opacity:Vz,text:{field:zz},x:y.x,y:y.y},exit:{opacity:Yz}},HN(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const E=aR({type:Kz,role:KN,style:jz,key:Lz,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:Yz,height:u?WN(u):Yz,opacity:Yz},exit:{opacity:Yz},update:v={opacity:Vz,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(m,")"),v.row.signal="".concat(p,"%").concat(b),v.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(v.row.signal="floor(".concat(p," / ").concat(m,")"),v.column.signal="".concat(p," % ").concat(m),x={field:p}),v.column.signal="(".concat(i,")?").concat(v.column.signal,":").concat(p),tR({role:XN,from:r={facet:{data:r,name:"value",groupby:Oz}},encode:ZN(g,a,Zz),marks:[k,E],name:l,interactive:s,sort:x})}const hR='item.orient === "left"',pR='item.orient === "right"',mR="(".concat(hR," || ").concat(pR,")"),gR="datum.vgrad && ".concat(mR),yR=rR('"top"','"bottom"','"middle"'),vR="datum.vgrad && ".concat(pR," ? (").concat(rR('"right"','"left"','"center"'),") : (").concat(mR," && !(datum.vgrad && ").concat(hR,')) ? "left" : ').concat(iR),bR="item._anchor || (".concat(mR,' ? "middle" : "start")'),xR="".concat(gR," ? (").concat(hR," ? -90 : 90) : 0"),_R="".concat(mR," ? (datum.vgrad ? (").concat(pR,' ? "bottom" : "top") : ').concat(yR,') : "top"');function wR(t,e){let n;return Jt(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+kR(t.path)+")":t.sphere&&(n="geoShape("+kR(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function kR(t){return Jt(t)&&t.signal?t.signal:Be(t)}function AR(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===Gz?XN:e||VN:e}function ER(t){return{marktype:t.type,name:t.name||void 0,role:t.role||AR(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function MR(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function CR(t,e){const n=function(t){const e=function(t){return t=t&&t.toLowerCase(),Ee(rs,t)?rs[t]:null}(t);return e&&e.Definition||null}(t.type);n||Rt("Unrecognized transform type: "+Be(t.type));const r=hO(n.type.toLowerCase(),null,SR(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function SR(t,e,n){const r={},i=t.params.length;for(let o=0;o<i;++o){const i=t.params[o];r[i.name]=DR(i,e,n)}return r}function DR(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){return Oe(e.from)||Rt('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(Qt(r)||Rt("Expected an array of sub-parameters. Instead: "+Be(r)),r.map((e=>TR(t,e,n)))):TR(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!wO(i)?i.map((e=>FR(t,e,n))):FR(t,i,n):void(t.required&&Rt("Missing required "+Be(e.type)+" parameter: "+Be(t.name)))}function FR(t,e,n){const r=t.type;if(wO(e))return RR(r)?Rt("Expression references can not be signals."):PR(r)?n.fieldRef(e):BR(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||PR(r);return i&&NR(e)?n.exprRef(e.expr,e.as):i&&OR(e)?gO(e.field,e.as):RR(r)?ET(e,n):zR(r)?mO(n.getData(e).values):PR(r)?gO(e):BR(r)?n.compareRef(e):e}}function TR(t,e,n){const r=t.params.length;let i;for(let a=0;a<r;++a){i=t.params[a];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||Rt("Unsupported parameter: "+Be(e));const o=we(SR(i,e,n),i.key);return mO(n.add(JO(o)))}const NR=t=>t&&t.expr,OR=t=>t&&t.field,zR=t=>"data"===t,RR=t=>"expr"===t,PR=t=>"field"===t,BR=t=>"compare"===t;function LR(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:mO(e.getData(t.data).output)}function jR(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function UR(t){return Oe(t)?t:null}function qR(t,e,n){const r=bO(n.op,n.field);let i;if(e.ops){for(let o=0,a=e.as.length;o<a;++o)if(e.as[o]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function IR(t,e,n,r,i,o,a){const s=e[n]||(e[n]={}),l=function(t){return Jt(t)?("descending"===t.order?"-":"+")+bO(t.op,t.field):""}(o);let u,c,f=UR(i);if(null!=f&&(t=e.scope,f+=l?"|"+l:"",u=s[f]),!u){const n=o?{field:yO,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:mO(e.output)};l&&(n.sort=t.sortRef(o)),c=t.add(hO(r,void 0,n)),a&&(e.index[i]=c),u=mO(c),null!=f&&(s[f]=u)}return u}function WR(t,e,n){const r=t.remove,i=t.insert,o=t.toggle,a=t.modify,s=t.values,l=e.add(pO()),u=ET("if("+t.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((t=>null==t?"null":t)).join(",")+"),0)",e);l.update=u.$expr,l.params=u.$params}function $R(t,e){const n=AR(t),r=t.type===Gz,i=t.from&&t.from.facet,o=t.overlap;let a,s,l,u,c,f,d,h=t.layout||n===XN||n===GN;const p=n===VN||h||i,m=function(t,e,n){let r,i,o,a,s;return t?(r=t.facet)&&(e||Rt("Only group marks can be faceted."),null!=r.field?a=s=LR(r,n):(t.data?s=mO(n.getData(t.data).aggregate):(o=CR(we({type:"aggregate",groupby:de(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=LR(r,n),a=s=mO(n.add(o))),i=n.keyRef(r.groupby,!0))):a=mO(n.add(LO(null,[{}]))),a||(a=LR(t,n)),{key:i,pulse:a,parent:s}}(t.from,r,e);s=e.add(UO({key:m.key||(t.key?gO(t.key):void 0),pulse:m.pulse,clean:!r}));const g=mO(s);s=l=e.add(LO({pulse:g})),s=e.add(VO({markdef:ER(t),interactive:MR(t.interactive,e),clip:wR(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:mO(s)}));const y=mO(s);s=u=e.add(qO(function(t,e,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},t=function(t,e,n,r,i){const o={},a={};let s,l,u,c;for(l in l="lineBreak","text"!==e||null==i[l]||YN(l,t)||eO(o,l,i[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===GN?i.group:n===VN?we({},i.mark,i[e]):null,c)u=YN(l,t)||("fill"===l||"stroke"===l)&&(YN("fill",t)||YN("stroke",t)),u||eO(o,l,c[l]);for(l in de(r).forEach((e=>{const n=i.style&&i.style[e];for(const r in n)YN(r,t)||eO(o,r,n[r])})),t=we({},t),o)c=o[l],c.signal?(s=s||{})[l]=c:a[l]=c;return t.enter=we(a,t.enter),s&&(t.update=we(s,t.update)),t}(t,e,n,r,i.config);for(const s in t)a[s]=lO(t[s],e,o,i);return o}(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=CR(t,e),r=n.metadata;(r.generates||r.changes)&&Rt("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=mO(s),e.add(s=n)})),t.sort&&(s=e.add(az({sort:e.compareRef(t.sort),pulse:mO(s)})));const v=mO(s);(i||h)&&(h=e.add(sz({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),f=mO(h));const b=e.add(BO({mark:y,pulse:f||v}));d=mO(b),r&&(p&&(a=e.operators,a.pop(),h&&a.pop()),e.pushState(v,f||d,g),i?function(t,e,n){const r=t.from.facet,i=r.name,o=LR(r,e);let a;r.name||Rt("Facet must have a name: "+Be(r)),r.data||Rt("Facet must reference a data set: "+Be(r)),r.field?a=e.add(KO({field:e.fieldRef(r.field),pulse:o})):r.groupby?a=e.add(WO({key:e.keyRef(r.groupby),group:mO(e.proxy(n.parent)),pulse:o})):Rt("Facet must specify groupby or field: "+Be(r));const s=e.fork(),l=s.add(LO()),u=s.add(oz({pulse:mO(l)}));s.addData(i,new jR(s,l,l,u)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(t).toRuntime()}}(t,e,m):p?function(t,e,n){const r=e.add(KO({pulse:n.pulse})),i=e.fork();i.add(oz()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,m):e.parse(t),e.popState(),p&&(h&&a.push(h),a.push(b))),o&&(d=function(t,e,n){const r=t.method,i=t.bound,o=t.separation,a={separation:wO(o)?n.signalRef(o.signal):o,method:wO(r)?n.signalRef(r.signal):r,pulse:e};if(t.order&&(a.sort=n.compareRef({field:t.order})),i){const t=i.tolerance;a.boundTolerance=wO(t)?n.signalRef(t.signal):+t,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return mO(n.add(QO(a)))}(o,d,e));const x=e.add(rz({pulse:d})),_=e.add(oz({pulse:mO(x)},void 0,e.parent()));null!=t.name&&(c=t.name,e.addData(c,new jR(e,l,x,_)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&Rt("Marks only support modify triggers."),WR(t,e,c)})))}function HR(t,e,n){const r={enter:{},update:{}};return HN(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function ZR(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):nR(t,n[0].encode)}jR.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let o=e[0],a=null,s=1;for(o&&"load"===o.type&&(o=e[1]),t.add(e[0]);s<n;++s)e[s].params.pulse=mO(e[s-1]),t.add(e[s]),"aggregate"===e[s].type&&(a=e[s]);return new jR(t,o,i,r,a)},jR.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),o=UR(e);let a,s,l;return null!=o&&(t=r.scope,a=i[o]),a?n&&n.field&&qR(t,a.agg.params,n):(l={groupby:t.fieldRef(e,"key"),pulse:mO(r.output)},n&&n.field&&qR(t,l,n),s=t.add(RO(l)),a=t.add(LO({pulse:mO(s)})),a={agg:s,ref:mO(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef(){return mO(this.values)},extentRef(t,e){return IR(t,this,"extent","extent",e,!1)},domainRef(t,e){return IR(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return IR(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return IR(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return IR(t,this,"indata","tupleindex",e,!0,!0)}};const YR='item.orient==="'.concat(Mz,'"?-90:item.orient==="').concat(Cz,'"?90:0');function VR(t,e){const n={enter:{},update:{}};return HN(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:iR},angle:{signal:YR},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),ZN(n,e,Zz)}function GR(t){const e=LO({},t);return e.metadata={source:!0},e}function XR(t,e){return YO({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const QR=t=>t===Sz||t===Ez,JR=(t,e,n)=>wO(t)?iP(t.signal,e,n):t===Mz||t===Ez?e:n,KR=(t,e,n)=>wO(t)?nP(t.signal,e,n):QR(t)?e:n,tP=(t,e,n)=>wO(t)?rP(t.signal,e,n):QR(t)?n:e,eP=(t,e,n)=>wO(t)?oP(t.signal,e,n):t===Ez?{value:e}:{value:n},nP=(t,e,n)=>aP("".concat(t," === '").concat(Ez,"' || ").concat(t," === '").concat(Sz,"'"),e,n),rP=(t,e,n)=>aP("".concat(t," !== '").concat(Ez,"' && ").concat(t," !== '").concat(Sz,"'"),e,n),iP=(t,e,n)=>lP("".concat(t," === '").concat(Mz,"' || ").concat(t," === '").concat(Ez,"'"),e,n),oP=(t,e,n)=>lP("".concat(t," === '").concat(Ez,"'"),e,n),aP=(t,e,n)=>(e=null!=e?WN(e):e,n=null!=n?WN(n):n,sP(e)&&sP(n)?{signal:"".concat(t," ? (").concat(e=e?e.signal||Be(e.value):null,") : (").concat(n=n?n.signal||Be(n.value):null,")")}:[we({test:t},e)].concat(n||[])),sP=t=>null==t||1===Object.keys(t).length,lP=(t,e,n)=>({signal:"".concat(t," ? (").concat(cP(e),") : (").concat(cP(n),")")}),uP=(t,e,n,r,i)=>({signal:(null!=r?"".concat(t," === '").concat(Mz,"' ? (").concat(cP(r),") : "):"")+(null!=n?"".concat(t," === '").concat(Sz,"' ? (").concat(cP(n),") : "):"")+(null!=i?"".concat(t," === '").concat(Cz,"' ? (").concat(cP(i),") : "):"")+(null!=e?"".concat(t," === '").concat(Ez,"' ? (").concat(cP(e),") : "):"")+"(null)"}),cP=t=>wO(t)?t.signal:null==t?null:Be(t),fP=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function dP(t,e,n,r){let i;if(e&&Ee(e,t))return e[t];if(Ee(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[Uz][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[jz][i]}return null}function hP(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function pP(t,e){return{scale:t.scale,range:e}}function mP(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function gP(t,e){const n={enter:{},update:{}};return HN(n,{orient:t("orient"),offset:t("offset")||0,position:AO(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function yP(t,e,n){const r=de(t.signals),i=de(t.scales);return n||r.forEach((t=>function(t,e){const n=t.name;if("outer"===t.push)e.signals[n]||fO("No prior signal definition",n),cO.forEach((e=>{void 0!==t[e]&&fO("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}(t,e))),de(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=Az(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=Az(n[i],i,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";Ch(n)||Rt("Unrecognized scale type: "+Be(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),de(t.data).forEach((t=>function(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(CR(t,e))})),t.on&&t.on.forEach((n=>{WR(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,o,a,s,l,u=null,c=!1,f=!1;for(t.values?wO(t.values)||kO(t.format)?(r.push(XR(e,t)),r.push(u=GR())):r.push(u=GR({$ingest:t.values,$format:t.format})):t.url?kO(t.url)||kO(t.format)?(r.push(XR(e,t)),r.push(u=GR())):r.push(u=GR({$request:t.url,$format:t.format})):t.source&&(u=i=de(t.source).map((t=>mO(e.getData(t).output))),r.push(null)),o=0,a=n.length;o<a;++o)s=n[o],l=s.metadata,u||l.source||r.push(u=GR()),r.push(s),l.generates&&(f=!0),l.modifies&&!f&&(c=!0),l.source?u=s:l.changes&&(u=null);return i&&(a=i.length-1,r[0]=nz({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,GR())),u||r.push(GR()),r.push(oz({})),r}(t,e,n))}(t,e))),i.forEach((t=>fz(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?Rt("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=ET(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>function(t,e,n){const r=t.encode,i={target:n};let o=t.events,a=t.update,s=[];o||Rt("Signal update missing events specification."),Oe(o)&&(o=function(t,e,n){return LN=e||"view",jN=BN,qN(t.trim()).map(IN)}(o,e.isSubscope()?xO:_O)),o=de(o).filter((t=>t.signal||t.scale?(s.push(t),0):1)),s.length>1&&(s=[OO(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&Rt("Signal encode and update are mutually exclusive."),a="encode(item(),"+Be(r)+")"),i.update=Oe(a)?ET(a,e):null!=a.expr?ET(a.expr,e):null!=a.value?a.value:null!=a.signal?{$expr:NO,$params:{$value:e.signalRef(a.signal)}}:Rt("Invalid signal update specification."),t.force&&(i.options={force:!0}),s.forEach((t=>e.addUpdate(we(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):CO(t,e)}}(t,e),i))))}(t,e,n.id)))}(t,e))),de(t.axes).forEach((t=>function(t,e){const n=function(t,e){var n,r,i,o=e.config,a=o.style,s=o.axis,l="band"===e.scaleType(t.scale)&&o.axisBand,u=t.orient;if(wO(u)){const t=hP([o.axisX,o.axisY]),e=hP([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},t))n[i]=KR(u,dP(i,o.axisX,s,a),dP(i,o.axisY,s,a));for(i of(r={},e))r[i]=uP(u.signal,dP(i,o.axisTop,s,a),dP(i,o.axisBottom,s,a),dP(i,o.axisLeft,s,a),dP(i,o.axisRight,s,a))}else n=u===Ez||u===Sz?o.axisX:o.axisY,r=o["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||l?we({},s,n,r,l):s}(t,e),r=t.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,l=eR(t,n),u=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(e.signal,") === 'extent'")},Jt(i)||(i={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(l),c={scale:t.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=t.title},f=mO(e.add(LO({},[c]))),d=mO(e.add(PO({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),h=[];let p;return c.grid&&h.push(function(t,e,n,r,i){const o=eR(t,e),a=t.orient,s=t.gridScale,l=JR(a,1,-1),u=function(t,e){if(1===e);else if(Jt(t)){let n=t=we({},t);for(;null!=n.mult;){if(!Jt(n.mult))return n.mult=wO(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n=n.mult=we({},n.mult)}n.mult=e}else t=wO(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);return t}(t.offset,l);let c,f,d;const h={enter:c={opacity:Yz},update:d={opacity:Vz},exit:f={opacity:Yz}};HN(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:Lz,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=KR(a,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:l,offset:u}:{value:0,offset:u},y=s?{scale:s,range:1,mult:l,offset:u}:we(m,{mult:l,offset:u});return c.x=d.x=KR(a,p,g),c.y=d.y=tP(a,p,g),c.x2=d.x2=tP(a,y),c.y2=d.y2=KR(a,y),f.x=KR(a,p),f.y=tP(a,p),aR({type:Qz,role:"axis-grid",key:Lz,from:r,encode:h},n)}(t,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(function(t,e,n,r,i,o){const a=eR(t,e),s=t.orient,l=JR(s,-1,1);let u,c,f;const d={enter:u={opacity:Yz},update:f={opacity:Vz},exit:c={opacity:Yz}};HN(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=WN(i);h.mult=l;const p={scale:t.scale,field:Lz,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=u.y=KR(s,Yz,p),f.y2=u.y2=KR(s,h),c.x=KR(s,p),f.x=u.x=tP(s,Yz,p),f.x2=u.x2=tP(s,h),c.y=tP(s,p),aR({type:Qz,role:"axis-tick",key:Lz,from:r,encode:d},n)}(t,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(function(t,e,n,r,i,o){const a=eR(t,e),s=t.orient,l=t.scale,u=JR(s,-1,1),c=EO(a("labelFlush")),f=EO(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p,m=0===c||!!c;const g=WN(i);g.mult=u,g.offset=WN(a("labelPadding")||0),g.offset.mult=u;const y={scale:l,field:Lz,band:.5,offset:oR(o.offset,a("labelOffset"))},v=KR(s,m?mP(l,c,'"left"','"right"','"center"'):{value:"center"},((t,e,n)=>wO(t)?((t,e,n)=>lP("".concat(t," === '").concat(Cz,"'"),e,n))(t.signal,e,n):t===Cz?{value:e}:{value:n})(s,"left","right")),b=KR(s,eP(s,"bottom","top"),m?mP(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=mP(l,c,"-(".concat(f,")"),f,0);m=m&&f;const _={opacity:Yz,x:KR(s,y,g),y:tP(s,y,g)},w={enter:_,update:p={opacity:Vz,text:{field:zz},x:_.x,y:_.y,align:v,baseline:b},exit:{opacity:Yz,x:_.x,y:_.y}};HN(w,{dx:!d&&m?KR(s,x):null,dy:!h&&m?tP(s,x):null}),HN(w,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const k=a("labelBound");let A=a("labelOverlap");return A=A||k?{separation:a("labelSeparation"),method:A,order:"datum.index",bound:k?{scale:l,orient:s,tolerance:k}:null}:void 0,p.align!==v&&(p.align=fP(p.align,v)),p.baseline!==b&&(p.baseline=fP(p.baseline,b)),aR({type:Kz,role:"axis-label",style:jz,key:Lz,from:r,encode:w,overlap:A},n)}(t,n,r.labels,d,p,u))),c.domain&&h.push(function(t,e,n,r){const i=eR(t,e),o=t.orient;let a,s;const l={enter:a={opacity:Yz},update:s={opacity:Vz},exit:{opacity:Yz}};HN(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=pP(t,0),c=pP(t,1);return a.x=s.x=KR(o,u,Yz),a.x2=s.x2=KR(o,c),a.y=s.y=tP(o,u,Yz),a.y2=s.y2=tP(o,c),aR({type:Qz,role:"axis-domain",from:r,encode:l},n)}(t,n,r.domain,f)),c.title&&h.push(function(t,e,n,r){const i=eR(t,e),o=t.orient,a=JR(o,-1,1);let s,l;const u={enter:s={opacity:Yz,anchor:WN(i("titleAnchor",null)),align:{signal:iR}},update:l=we({},s,{opacity:Vz,text:WN(t.title)}),exit:{opacity:Yz}},c={signal:'lerp(range("'.concat(t.scale,'"), ').concat(rR(0,1,.5),")")};return l.x=KR(o,c),l.y=tP(o,c),s.angle=KR(o,Yz,((t,e)=>wO(t)?{signal:"(".concat(t.signal,") * ").concat(90)}:{value:90*t})(a)),s.baseline=KR(o,eP(o,Sz,Ez),{value:Sz}),l.angle=s.angle,l.baseline=s.baseline,HN(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=fP(WN(t),n.update[e]),!1):!YN(e,r),o=i(t("titleX"),"x"),a=i(t("titleY"),"y");n.enter.auto=a===o?WN(a):KR(e,WN(a),WN(o))}(i,o,u,n),u.update.align=fP(u.update.align,s.align),u.update.angle=fP(u.update.angle,s.angle),u.update.baseline=fP(u.update.baseline,s.baseline),aR({type:Kz,role:"axis-title",style:Uz,from:r,encode:u},n)}(t,n,r.title,f)),$R(tR({role:"axis",from:f,encode:ZN(gP(l,t),i,Zz),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:a,style:s}),e)}(t,e))),de(t.marks).forEach((t=>$R(t,e))),de(t.legends).forEach((t=>function(t,e){const n=e.config.legend,r=t.encode||{},i=eR(t,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,l=o.style,u={};let c,f,d,h=0;Hz.forEach((e=>t[e]?(u[e]=t[e],h=h||t[e]):0)),h||Rt("Missing valid scale for legend.");const p=function(t,e){let n=t.type||qz;return t.type||1!==function(t){return Hz.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=Dh(e)?Iz:Th(e)?Wz:qz),n!==Iz?n:Th(e)?Wz:Iz}(t,e.scaleType(h)),m={title:null!=t.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=mO(e.add(LO(null,[m]))),y=mO(e.add(ZO(f={type:p,scale:e.scaleRef(h),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===Iz?(d=[sR(t,h,n,r.gradient),fR(t,n,r.labels,y)],f.count=f.count||e.signalRef("max(2,2*floor((".concat(EO(i.gradientLength()),")/100))"))):p===Wz?d=[lR(t,h,n,r.gradient,y),fR(t,n,r.labels,y)]:(c=function(t,e){const n=eR(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),d=[dR(t,n,r,y,EO(c.columns))],f.size=function(t,e,n){const r=EO(ZR("size",t,n)),i=EO(ZR("strokeWidth",t,n)),o=EO(function(t,e,n){return nR("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r.fontSize}(0,e,n)}(n[1].encode,e,jz));return ET("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(o,")"),e)}(t,e,d[0].marks)),d=[tR({role:"legend-entry",from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],m.title&&d.push(function(t,e,n,r){const i=eR(t,e),o={enter:{opacity:Yz},update:{opacity:Vz,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Yz}};return HN(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:bR},angle:{signal:xR},align:{signal:vR},baseline:{signal:_R},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),aR({type:Kz,role:"legend-title",style:Uz,from:r,encode:o},n)}(t,n,r.title,g)),$R(tR({role:"legend",from:g,encode:ZN(HR(i,t,n),o,Zz),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:l}),e)}(t,e))),t.title&&function(t,e){const n=eR(t=Oe(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,l=[],u=mO(e.add(LO(null,[{}])));l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return HN(o,{text:t.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),aR({type:Kz,role:"title-text",style:"group-title",from:r,encode:o},n)}(t,n,function(t){const e=t.encode;return e&&e.title||we({name:t.name,interactive:t.interactive,style:t.style},e)}(t),u)),t.subtitle&&l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return HN(o,{text:t.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),aR({type:Kz,role:"title-subtitle",style:"group-subtitle",from:r,encode:o},n)}(t,n,r.subtitle,u)),$R(tR({role:"title",from:u,encode:VR(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),e)}(t.title,e),e.parseLambdas(),e}function vP(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function bP(t){return(Qt(t)?xP:_P)(t)}function xP(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(Jt(e)?e.signal||bP(e):Be(e))}return n+"]"}function _P(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+Be(e)+":"+(Jt(n)?n.signal||bP(n):Be(n));return r+"}"}vP.prototype={parse(t){return yP(t,this)},fork(){return new vP(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof dO?mO(t):t;return this.add(ez({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(mO(this.add(oz({pulse:t})))),this._parent.push(e),this._lookup.push(n?mO(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Kt(this._parent)},encode(){return Kt(this._encode)},lookup(){return Kt(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(Oe(t))return gO(t,e);t.signal||Rt("Unsupported field reference: "+Be(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=mO(this.add($O(t)))}return r},compareRef(t){let e=!1;const n=t=>wO(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=de(t.field).map(n),i=de(t.order).map(n);return e?mO(this.add(jO({fields:r,orders:i}))):vO(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=de(t).map((t=>wO(t)?(n=!0,mO(r[t.signal])):t)),n?mO(this.add(HO({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=bO(t.op,t.field),n=t.order||"ascending";return n.signal?mO(this.add(jO({fields:e,orders:this.signalRef(n.signal)}))):vO(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return Ee(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&Rt("Duplicate signal name: "+Be(t));const n=e instanceof dO?e:this.add(pO(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||Rt("Unrecognized signal name: "+Be(t)),this.signals[t]},signalRef(t){return this.signals[t]?mO(this.signals[t]):(Ee(this.lambdas,t)||(this.lambdas[t]=this.add(pO(null))),mO(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=ET(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&Jt(t)?this.signalRef(t.signal||bP(t)):t},exprRef(t,e){const n={expr:ET(t,this)};return e&&(n.expr.$name=e),mO(this.add(IO(n)))},addBinding(t,e){this.bindings||Rt("Nested signals do not support binding: "+Be(t)),this.bindings.push(we({signal:t},e))},addScaleProj(t,e){Ee(this.scales,t)&&Rt("Duplicate scale or projection name: "+Be(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,iz(e))},addProjection(t,e){this.addScaleProj(t,tz(e))},getScale(t){return this.scales[t]||Rt("Unrecognized scale name: "+Be(t)),this.scales[t]},scaleRef(t){return mO(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return Ee(this.data,t)&&Rt("Duplicate data set name: "+Be(t)),this.data[t]=e},getData(t){return this.data[t]||Rt("Undefined data set name: "+Be(t)),this.data[t]},addDataPipeline(t,e){return Ee(this.data,t)&&Rt("Duplicate data set name: "+Be(t)),this.addData(t,jR.fromEntries(this,e))}},we(rs,t,w,k,A,E,C,M,S,D,F,T);var wP=n(138),kP=n.n(wP),AP=n(378),EP=n.n(AP),MP=n(695),CP=n.n(MP);function SP(t,e){return function(t){return!!t.not}(t)?{not:SP(t.not,e)}:function(t){return!!t.and}(t)?{and:t.and.map((t=>SP(t,e)))}:function(t){return!!t.or}(t)?{or:t.or.map((t=>SP(t,e)))}:e(t)}EP();const DP=kP();function FP(t,e){const n={};for(const r of e)Ee(t,r)&&(n[r]=t[r]);return n}function TP(t,e){const n={...t};for(const r of e)delete n[r];return n}Set.prototype.toJSON=function(){return"Set(".concat([...this].map((t=>CP()(t))).join(","),")")};const NP=CP();function OP(t){if(Ne(t))return t;const e=Oe(t)?t:CP()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n&=n;return n}function zP(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function RP(t,e){const n=[],r={};let i;for(const o of t)i=e(o),i in r||(r[i]=1,n.push(o));return n}function PP(t){return 0===BP(t).length}const BP=Object.keys,LP=Object.values,jP=Object.entries;function UP(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function qP(t){return t.charAt(0).toUpperCase()+t.substr(1)}function IP(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function WP(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function $P(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)if(void 0!==r)return r}const HP="row",ZP="column",YP="facet",VP="x",GP="y",XP="x2",QP="y2",JP="xOffset",KP="yOffset",tB="radius",eB="radius2",nB="theta",rB="theta2",iB="latitude",oB="longitude",aB="latitude2",sB="longitude2",lB="color",uB="fill",cB="stroke",fB="shape",dB="size",hB="angle",pB="opacity",mB="fillOpacity",gB="strokeOpacity",yB="strokeWidth",vB="strokeDash",bB="text",xB="order",_B="detail",wB="key",kB="tooltip",AB="href",EB="url",MB="description",CB={longitude:1,longitude2:1,latitude:1,latitude2:1};BP(CB);const SB={x:1,y:1,x2:1,y2:1,theta:1,theta2:1,radius:1,radius2:1,...CB,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1},DB={row:1,column:1,facet:1},FB=(BP(DB),{...SB,...DB}),TB=BP(FB),{order:NB,detail:OB,tooltip:zB,...RB}=FB,{row:PB,column:BB,facet:LB,...jB}=RB;BP(RB),BP(jB);const UB=[XP,QP,aB,sB,rB,eB];function qB(t){return IB(t)!==t}function IB(t){switch(t){case XP:return VP;case QP:return GP;case aB:return iB;case sB:return oB;case rB:return nB;case eB:return tB}return t}BP(SB);const{x:WB,y:$B,x2:HB,y2:ZB,xOffset:YB,yOffset:VB,latitude:GB,longitude:XB,latitude2:QB,longitude2:JB,theta:KB,theta2:tL,radius:eL,radius2:nL,...rL}=SB,iL=BP(rL),oL={x:1,y:1};function aL(t){return t in oL}BP(oL);const sL={theta:1,radius:1};BP(sL);const lL={xOffset:1,yOffset:1};BP(lL);const{text:uL,tooltip:cL,href:fL,url:dL,description:hL,detail:pL,key:mL,order:gL,...yL}=rL;BP(yL);const vL={...oL,...sL,...lL,...yL};BP(vL);const{geoshape:bL,...xL}={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},_L={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};function wL(t){return!!t&&!!t.argmin}function kL(t){return!!t&&!!t.argmax}const AL=new Set(["count","valid","missing","distinct"]),EL=new Set(["count","sum","distinct","valid","missing"]);function ML(t){return!0===t||SL(t)&&!t.binned}function CL(t){return"binned"===t||SL(t)&&!0===t.binned}function SL(t){return Jt(t)}function DL(t){switch(t){case HP:case ZP:case dB:case lB:case uB:case cB:case yB:case pB:case mB:case gB:case fB:return 6;case vB:return 4;default:return 10}}function FL(t){return!(null===t||void 0===t||!t.signal)}function TL(t,e,n){return function(t,e,n){let r;e=de(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}(t,function(t,e){return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}(e),n)}function NL(t){return"Selection not supported for ".concat(t," yet.")}function OL(t){return'The "columns" property cannot be used when "'.concat(t,'" has nested row/column.')}function zL(t){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(t," are dropped.")}function RL(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned).")}function PL(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).")}function BL(t){return"1D error band does not support ".concat(t,".")}new Set(["mean","average","median","q1","q3","min","max"]),BP({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1});let LL=Xt(Yt);function jL(){LL.warn(...arguments)}new WeakMap;const UL=(["january","february","march","april","may","june","july","august","september","october","november","december"].map((t=>t.substr(0,3))),["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]);UL.map((t=>t.substr(0,3)));const qL=BP({year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1});function IL(t){if(!t)return;let e;return Oe(t)?e={unit:t}:Jt(t)&&(e={...t,...t.unit?{unit:t.unit}:{}}),e.unit.startsWith("utc")&&(e.utc=!0,e.unit=e.unit.substr(3)),e}const WL={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},$L=WL.quantitative,HL=WL.ordinal,ZL=WL.temporal,YL=WL.nominal,VL=WL.geojson;BP(WL);const GL={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};BP(GL);const XL=new Set(["linear","log","pow","sqrt","symlog"]),QL=new Set([...XL,"time","utc"]),JL=new Set(["quantile","quantize","threshold"]);new Set([...QL,...JL,"sequential","identity"]),new Set(["ordinal","bin-ordinal","point","band"]),new Set(["time","utc"]);const KL={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:tj,domain:ej,range:nj,rangeMax:rj,rangeMin:ij,scheme:oj,...aj}=(BP(KL),KL);BP(aj);const sj={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},lj=sj.arc,uj=sj.area,cj=sj.bar,fj=sj.line,dj=sj.point,hj=sj.rule,pj=sj.text,mj=sj.tick,gj=sj.circle,yj=sj.square;function vj(t){return["line","area","trail"].includes(t)}const bj=new Set(BP(sj));function xj(t){return t.type}function _j(t){return t&&"number"!==t&&"time"!==t}BP({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),BP({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});const wj={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function kj(t){return t in wj}function Aj(t){return"row"in t||"column"in t}function Ej(t){return!!t&&"header"in t}function Mj(t){return"sort"in t}function Cj(t){return t&&"condition"in t}function Sj(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!Qt(e)&&Fj(e)}function Dj(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!Qt(e)&&Oj(e)}function Fj(t){return t&&(!!t.field||"count"===t.aggregate)}function Tj(t){return t&&"datum"in t}function Nj(t){return zj(t)&&!Ij(t)||function(t){return Tj(t)&&Ne(t.datum)}(t)}function Oj(t){return Fj(t)||Tj(t)}function zj(t){return t&&("field"in t||"count"===t.aggregate)&&"type"in t}function Rj(t){return t&&"value"in t&&"value"in t}function Pj(t){return t&&("scale"in t||"sort"in t)}function Bj(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function Lj(t){return t&&"legend"in t}function jj(t){return t&&("format"in t||"formatType"in t)}function Uj(t){return TP(t,["legend","axis","header","scale"])}function qj(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.field;const r=e.prefix;let i=e.suffix,o="";if(function(t){return"count"===t.aggregate}(t))n=function(t){return t.startsWith("__")}(u="count")?u:"__".concat(u);else{let r;if(!e.nofn)if(function(t){return"op"in t}(t))r=t.op;else{var a,s,l;const{bin:u,aggregate:c,timeUnit:f}=t;ML(u)?(r=function(t){return Fe(t)&&(t=Gj(t,void 0)),"bin"+BP(t).map((e=>function(t){return null===t||void 0===t?void 0:t.param}(t[e])?UP("_".concat(e,"_").concat(jP(t[e]))):UP("_".concat(e,"_").concat(t[e])))).join("")}(u),i=(null!==(a=e.binSuffix)&&void 0!==a?a:"")+(null!==(s=e.suffix)&&void 0!==s?s:"")):c?kL(c)?(o='["'.concat(n,'"]'),n="argmax_".concat(c.argmax)):wL(c)?(o='["'.concat(n,'"]'),n="argmin_".concat(c.argmin)):r=String(c):f&&(r=function(t){const{utc:e,...n}=IL(t);return n.unit?(e?"utc":"")+BP(n).map((t=>UP("".concat("unit"===t?"":"_".concat(t,"_")).concat(n[t])))).join(""):(e?"utc":"")+"timeunit"+BP(n).map((t=>UP("_".concat(t,"_").concat(n[t])))).join("")}(f),i=(!["range","mid"].includes(e.binSuffix)&&e.binSuffix||"")+(null!==(l=e.suffix)&&void 0!==l?l:""))}r&&(n=n?"".concat(r,"_").concat(n):r)}var u;return i&&(n="".concat(n,"_").concat(i)),r&&(n="".concat(r,"_").concat(n)),e.forAs?function(t){return"".concat(Pt(t).join("."))}(n):e.expr?function(t){return"".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum","[").concat(Be(Pt(t).join(".")),"]")}(n,e.expr)+o:function(t){return"".concat(Pt(t).map(IP).join("\\."))}(n)+o}function Ij(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Fj(t)&&!!t.bin;case"temporal":return!1}throw new Error('Invalid field type "'.concat(t.type,'".'))}let Wj=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(kL(e))return"".concat(i," for argmax(").concat(e.argmax,")");if(wL(e))return"".concat(i," for argmin(").concat(e.argmin,")");const o=IL(r),a=e||(null===o||void 0===o?void 0:o.unit)||(null===o||void 0===o?void 0:o.maxbins)&&"timeunit"||ML(n)&&"bin";return a?"".concat(a.toUpperCase(),"(").concat(i,")"):i}(t);default:return function(t,e){const{field:n,bin:r,timeUnit:i,aggregate:o}=t;if("count"===o)return e.countTitle;if(ML(r))return"".concat(n," (binned)");if(i){var a;const t=null===(a=IL(i))||void 0===a?void 0:a.unit;if(t)return"".concat(n," (").concat(function(t){return qL.filter((e=>function(t,e){const n=t.indexOf(e);return!(n<0||n>0&&"seconds"===e&&"i"===t.charAt(n-1)||t.length>n+3&&"day"===e&&"o"===t.charAt(n+3)||n>0&&"year"===e&&"f"===t.charAt(n-1))}(t,e)))}(t).join("-"),")")}else if(o)return kL(o)?"".concat(n," for max ").concat(o.argmax):wL(o)?"".concat(n," for min ").concat(o.argmin):"".concat(qP(o)," of ").concat(n);return n}(t,e)}};function $j(t,e,n){var r,i;let{allowDisabling:o,includeDefault:a=!0}=n;const s=null===(r=Hj(t))||void 0===r?void 0:r.title;if(!Fj(t))return null!==s&&void 0!==s?s:t.title;const l=t,u=a?function(t,e){return Wj(t,e)}(l,e):void 0;return o?$P(s,l.title,u):null!==(i=null!==s&&void 0!==s?s:l.title)&&void 0!==i?i:u}function Hj(t){return Bj(t)&&t.axis?t.axis:Lj(t)&&t.legend?t.legend:Ej(t)&&t.header?t.header:void 0}function Zj(t){return Fj(t)?t:Sj(t)?t.condition:void 0}function Yj(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Oe(t)||Ne(t)||Fe(t)?(jL(function(t,e,n){return"Channel ".concat(t," is a ").concat(e,". Converted to {value: ").concat(NP(n),"}.")}(e,Oe(t)?"string":Ne(t)?"number":"boolean",t)),{value:t}):Oj(t)?Vj(t,e,n,r):Dj(t)?{...t,condition:Vj(t.condition,e,n,r)}:t}function Vj(t,e,n,r){if(jj(t)){const{format:i,formatType:o,...a}=t;if(_j(o)&&!n.customFormatTypes)return jL(zL(e)),Vj(a,e,n,r)}else{const i=Bj(t)?"axis":Lj(t)?"legend":Ej(t)?"header":null;if(i&&t[i]){const{format:o,formatType:a,...s}=t[i];if(_j(a)&&!n.customFormatTypes)return jL(zL(e)),Vj({...t,[i]:s},e,n,r)}}return Fj(t)?function(t,e){let{compositeMark:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{aggregate:r,timeUnit:i,bin:o,field:a}=t,s={...t};var l;if(n||!r||Oe(l=r)&&_L[l]||kL(r)||wL(r)||(jL(function(t){return'Invalid aggregation operator "'.concat(t,'".')}(r)),delete s.aggregate),i&&(s.timeUnit=IL(i)),a&&(s.field="".concat(a)),ML(o)&&(s.bin=Gj(o,e)),CL(o)&&!aL(e)&&jL(function(t){return"Channel ".concat(t,' should not be used with "binned" bin.')}(e)),zj(s)){const{type:t}=s,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case $L:return"quantitative";case"t":case ZL:return"temporal";case"o":case HL:return"ordinal";case"n":case YL:return"nominal";case VL:return"geojson"}}(t);t!==e&&(s.type=e),"quantitative"!==t&&function(t){return Oe(t)&&AL.has(t)}(r)&&(jL(function(t,e){return'Invalid field type "'.concat(t,'" for aggregate: "').concat(e,'", using "quantitative" instead.')}(t,r)),s.type="quantitative")}else if(!qB(e)){const t=function(t,e,n){switch(e){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(Mj(t)&&Qt(t.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=t;if(o)return"temporal";if(i||r&&!kL(r)&&!wL(r))return"quantitative";if(Pj(t)&&null!==(n=t.scale)&&void 0!==n&&n.type)switch(GL[t.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(s,e);s.type=t}if(zj(s)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:"Channel ".concat(e," should not be used with a geojson data.")};switch(e){case HP:case ZP:case YP:return Ij(t)?Xj:{compatible:!1,warning:RL(e)};case VP:case GP:case JP:case KP:case lB:case uB:case cB:case bB:case _B:case wB:case kB:case AB:case EB:case hB:case nB:case tB:case MB:return Xj;case oB:case sB:case iB:case aB:return n!==$L?{compatible:!1,warning:"Channel ".concat(e," should be used with a quantitative field only, not ").concat(t.type," field.")}:Xj;case pB:case mB:case gB:case yB:case dB:case rB:case eB:case XP:case QP:return"nominal"!==n||t.sort?Xj:{compatible:!1,warning:"Channel ".concat(e," should not be used with an unsorted discrete field.")};case fB:case vB:return Ij(t)||function(t,e){return Pj(t)&&function(t){return JL.has(t)}(null===(e=t.scale)||void 0===e?void 0:e.type)}(t)?Xj:{compatible:!1,warning:PL(e)};case xB:return"nominal"!==t.type||"sort"in t?Xj:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(s,e)||{};!1===t&&jL(n)}if(Mj(s)&&Oe(s.sort)){const{sort:t}=s;if(kj(t))return{...s,sort:{encoding:t}};const e=t.substr(1);if("-"===t.charAt(0)&&kj(e))return{...s,sort:{encoding:e,order:"descending"}}}if(Ej(s)){const{header:t}=s;if(t){const{orient:e,...n}=t;if(e)return{...s,header:{...n,labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e}}}}return s}(t,e,r):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=Ne(n)?"quantitative":Oe(n)?"nominal":function(t){if(t&&Jt(t))for(const e of qL)if(e in t)return!0;return!1}(n)?"temporal":void 0,{...t,type:e}}(t)}function Gj(t,e){return Fe(t)?{maxbins:DL(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:{...t,maxbins:DL(e)}}const Xj={compatible:!0};function Qj(t){const{formatType:e}=function(t){if(jj(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{var e;const n=null!==(e=Hj(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}(t);return"time"===e||!e&&function(t){return t&&("temporal"===t.type||Fj(t)&&!!t.timeUnit)}(t)}const Jj={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Kj={...Jj,style:1,labelExpr:1,encoding:1};function tU(t){return"mark"in t}BP(Kj),BP({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});class eU{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!tU(t)&&function(t){return xj(t)?t.type:t}(t.mark)===this.name}}function nU(t,e){const n=t&&t[e];return!!n&&(Qt(n)?zP(n,(t=>!!t.field)):Fj(n)||Sj(n))}function rU(t,e){const n=[],r=[],i=[],o=[],a={};return function(t,e,n){if(t)for(const r of BP(t)){const i=t[r];if(Qt(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}(t,((s,l)=>{if(Fj(s)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=s;if(c||d||f){const t=Hj(s),p=null===t||void 0===t?void 0:t.title;let m=qj(s,{forAs:!0});const g={...p?[]:{title:$j(s,e,{allowDisabling:!0})},...h,field:m};if(c){let t;if(kL(c)?(t="argmax",m=qj({op:"argmax",field:c.argmax},{forAs:!0}),g.field="".concat(m,".").concat(u)):wL(c)?(t="argmin",m=qj({op:"argmin",field:c.argmin},{forAs:!0}),g.field="".concat(m,".").concat(u)):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(t=c),t){const e={op:t,as:m};u&&(e.field=u),o.push(e)}}else if(n.push(m),zj(s)&&ML(f)){if(r.push({bin:f,field:u,as:m}),n.push(qj(s,{binSuffix:"end"})),function(t,e){return ML(t.bin)?function(t){return!!vL[t]}(e)&&["ordinal","nominal"].includes(t.type):(console.warn("Only call this method for binned field defs."),!1)}(s,l)&&n.push(qj(s,{binSuffix:"range"})),aL(l)){const t={field:"".concat(m,"_end")};a["".concat(l,"2")]=t}g.bin="binned",qB(l)||(g.type=$L)}else if(d){i.push({timeUnit:d,field:u,as:m});const t=zj(s)&&s.type!==ZL&&"time";t&&(l===bB||l===kB?g.formatType=t:function(t){return!!rL[t]}(l)?g.legend={formatType:t,...g.legend}:aL(l)&&(g.axis={formatType:t,...g.axis}))}a[l]=g}else n.push(u),a[l]=t[l]}else a[l]=t[l]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function iU(t,e){const n={};for(const r of BP(t)){const i=Yj(t[r],r,e,{compositeMark:!0});n[r]=i}return n}function oU(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};const i=t.map((t=>{let{fieldPrefix:n,titlePrefix:i}=t;const o=r?" of ".concat(aU(e)):"";return{field:n+e.field,type:e.type,title:FL(i)?{signal:"".concat(i,'"').concat(escape(o),'"')}:i+o}})),o=function(t){const e=[];for(const n of BP(t))if(nU(t,n)){const r=de(t[n]);for(const t of r)Fj(t)?e.push(t):Sj(t)&&e.push(t.condition)}return e}(n).map(Uj);return{tooltip:[...i,...RP(o,OP)]}}function aU(t){const{title:e,field:n}=t;return $P(e,n)}function sU(t,e,n,r,i){const{scale:o,axis:a}=n;return s=>{let{partName:l,mark:u,positionPrefix:c,endPositionPrefix:f,extraEncoding:d={}}=s;const h=aU(n);return lU(t,l,i,{mark:u,encoding:{[e]:{field:"".concat(c,"_").concat(n.field),type:n.type,...void 0!==h?{title:h}:{},...void 0!==o?{scale:o}:{},...void 0!==a?{axis:a}:{}},...Oe(f)?{["".concat(e,"2")]:{field:"".concat(f,"_").concat(n.field)}}:{},...r,...d}})}}function lU(t,e,n,r){const{clip:i,color:o,opacity:a}=t,s=t.type;return t[e]||void 0===t[e]&&n[e]?[{...r,mark:{...n[e],...i?{clip:i}:{},...o?{color:o}:{},...a?{opacity:a}:{},...xj(r.mark)?r.mark:{type:r.mark},style:"".concat(s,"-").concat(String(e)),...Fe(t[e])?{}:t[e]}}]:[]}function uU(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",o=r[i],a=r["".concat(i,"2")],s=r["".concat(i,"Error")],l=r["".concat(i,"Error2")];return{continuousAxisChannelDef:cU(o,n),continuousAxisChannelDef2:cU(a,n),continuousAxisChannelDefError:cU(s,n),continuousAxisChannelDefError2:cU(l,n),continuousAxis:i}}function cU(t,e){if(null!==t&&void 0!==t&&t.aggregate){const{aggregate:n,...r}=t;return n!==e&&jL(function(t,e){return"Continuous axis should not have customized aggregation function ".concat(t,"; ").concat(e," already agregates the axis.")}(n,e)),r}return t}function fU(t,e){const{mark:n,encoding:r}=t,{x:i,y:o}=r;if(xj(n)&&n.orient)return n.orient;if(Nj(i)){if(Nj(o)){const t=Fj(i)&&i.aggregate,n=Fj(o)&&o.aggregate;if(t||n!==e){if(n||t!==e){if(t===e&&n===e)throw new Error("Both x and y cannot have aggregate");return Qj(o)&&!Qj(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(Nj(o))return"vertical";throw new Error("Need a valid continuous axis for ".concat(e,"s"))}const dU="boxplot",hU=new eU(dU,mU);function pU(t){return Ne(t)?"tukey":t}function mU(t,e){var n,r;let{config:i}=e;t={...t,encoding:iU(t.encoding,i)};const{mark:o,encoding:a,params:s,projection:l,...u}=t,c=xj(o)?o:{type:o};s&&jL(NL("boxplot"));const f=null!==(n=c.extent)&&void 0!==n?n:i.boxplot.extent,d=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!o||i&&i!==t?function(t,e,n){let{vgChannel:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return $P(r?TL(t,e,n.style):void 0,TL(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}(t,e,n,r):void 0}("size",c,i),h=c.invalid,p=pU(f),{bins:m,timeUnits:g,transform:y,continuousAxisChannelDef:v,continuousAxis:b,groupby:x,aggregate:_,encodingWithoutContinuousAxis:w,ticksOrient:k,boxOrient:A,customTooltipWithoutAggregatedField:E}=function(t,e,n){const r=fU(t,dU),{continuousAxisChannelDef:i,continuousAxis:o}=uU(t,r,dU),a=i.field,s=pU(e),l=[...gU(a),{op:"median",field:a,as:"mid_box_".concat(a)},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],u="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(a,'"] - datum["lower_box_').concat(a,'"]'),as:"iqr_".concat(a)},{calculate:'min(datum["upper_box_'.concat(a,'"] + datum["iqr_').concat(a,'"] * ').concat(e,', datum["max_').concat(a,'"])'),as:"upper_whisker_".concat(a)},{calculate:'max(datum["lower_box_'.concat(a,'"] - datum["iqr_').concat(a,'"] * ').concat(e,', datum["min_').concat(a,'"])'),as:"lower_whisker_".concat(a)}],{[o]:c,...f}=t.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=function(t){const{tooltip:e,...n}=t;if(!e)return{filteredEncoding:n};let r,i;if(Qt(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return Qt(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:p,timeUnits:m,aggregate:g,groupby:y,encoding:v}=rU(h,n),b="vertical"===r?"horizontal":"vertical",x=r;return{bins:p,timeUnits:m,transform:[...p,...m,{aggregate:[...g,...l],groupby:y},...u],groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:d}}(t,f,i),{color:M,size:C,...S}=w,D=t=>sU(c,b,v,t,i.boxplot),F=D(S),T=D(w),N=D({...S,...C?{size:C}:{}}),O=oU([{fieldPrefix:"min-max"===p?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===p?"lower_whisker_":"min_",titlePrefix:"Min"}],v,w),z={type:"tick",color:"black",opacity:1,orient:k,invalid:h,aria:!1},R="min-max"===p?O:oU([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,w),P=[...F({partName:"rule",mark:{type:"rule",invalid:h,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:R}),...F({partName:"rule",mark:{type:"rule",invalid:h,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:R}),...F({partName:"ticks",mark:z,positionPrefix:"lower_whisker",extraEncoding:R}),...F({partName:"ticks",mark:z,positionPrefix:"upper_whisker",extraEncoding:R})],B=[..."tukey"!==p?P:[],...T({partName:"box",mark:{type:"bar",...d?{size:d}:{},orient:A,invalid:h,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:O}),...N({partName:"median",mark:{type:"tick",invalid:h,...Jt(i.boxplot.median)&&i.boxplot.median.color?{color:i.boxplot.median.color}:{},...d?{size:d}:{},orient:k,aria:!1},positionPrefix:"mid_box",extraEncoding:O})];if("min-max"===p)return{...u,transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(y),layer:B};const L='datum["lower_box_'.concat(v.field,'"]'),j='datum["upper_box_'.concat(v.field,'"]'),U="(".concat(j," - ").concat(L,")"),q="".concat(L," - ").concat(f," * ").concat(U),I="".concat(j," + ").concat(f," * ").concat(U),W='datum["'.concat(v.field,'"]'),$={joinaggregate:gU(v.field),groupby:x},H={transform:[{filter:"(".concat(q," <= ").concat(W,") && (").concat(W," <= ").concat(I,")")},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_".concat(v.field)},{op:"max",field:v.field,as:"upper_whisker_".concat(v.field)},{op:"min",field:"lower_box_".concat(v.field),as:"lower_box_".concat(v.field)},{op:"max",field:"upper_box_".concat(v.field),as:"upper_box_".concat(v.field)},..._],groupby:x}],layer:P},{tooltip:Z,...Y}=S,{scale:V,axis:G}=v,X=aU(v),Q=TP(G,["title"]),J=lU(c,"outliers",i.boxplot,{transform:[{filter:"(".concat(W," < ").concat(q,") || (").concat(W," > ").concat(I,")")}],mark:"point",encoding:{[b]:{field:v.field,type:v.type,...void 0!==X?{title:X}:{},...void 0!==V?{scale:V}:{},...PP(Q)?{}:{axis:Q}},...Y,...M?{color:M}:{},...E?{tooltip:E}:{}}})[0];let K;const tt=[...m,...g,$];return J?K={transform:tt,layer:[J,H]}:(K=H,K.transform.unshift(...tt)),{...u,layer:[K,{transform:y,layer:B}]}}function gU(t){return[{op:"q1",field:t,as:"lower_box_".concat(t)},{op:"q3",field:t,as:"upper_box_".concat(t)}]}const yU="errorbar",vU=new eU(yU,bU);function bU(t,e){let{config:n}=e;t={...t,encoding:iU(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,ticksOrient:s,markDef:l,outerSpec:u,tooltipEncoding:c}=xU(t,yU,n);delete a.size;const f=sU(l,o,i,a,n.errorbar),d=l.thickness,h=l.size,p={type:"tick",orient:s,aria:!1,...void 0!==d?{thickness:d}:{},...void 0!==h?{size:h}:{}},m=[...f({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:c}),...f({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:c}),...f({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==d?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return{...u,transform:r,...m.length>1?{layer:m}:{...m[0]}}}function xU(t,e,n){var r;const{mark:i,encoding:o,params:a,projection:s,...l}=t,u=xj(i)?i:{type:i};a&&jL(NL(e));const{orient:c,inputType:f}=function(t,e){const{encoding:n}=t;if(function(t){return(Oj(t.x)||Oj(t.y))&&!Oj(t.x2)&&!Oj(t.y2)&&!Oj(t.xError)&&!Oj(t.xError2)&&!Oj(t.yError)&&!Oj(t.yError2)}(n))return{orient:fU(t,e),inputType:"raw"};const r=function(t){return Oj(t.x2)||Oj(t.y2)}(n),i=function(t){return Oj(t.xError)||Oj(t.xError2)||Oj(t.yError)||Oj(t.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error("".concat(e," cannot be both type aggregated-upper-lower and aggregated-error"));const t=n.x2,r=n.y2;if(Oj(t)&&Oj(r))throw new Error("".concat(e," cannot have both x2 and y2"));if(Oj(t)){if(Nj(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(e))}if(Oj(r)){if(Nj(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(e))}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(Oj(r)&&!Oj(t))throw new Error("".concat(e," cannot have xError2 without xError"));if(Oj(s)&&!Oj(i))throw new Error("".concat(e," cannot have yError2 without yError"));if(Oj(t)&&Oj(i))throw new Error("".concat(e," cannot have both xError and yError with both are quantiative"));if(Oj(t)){if(Nj(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Oj(i)){if(Nj(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(t,e),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:g}=uU(t,c,e),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=function(t,e,n,r,i,o,a,s){let l=[],u=[];const c=e.field;let f,d=!1;if("raw"===o){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!=("iqr"===n)&&jL(function(t,e,n){return"".concat(t," is not usually used with ").concat(e," for ").concat(n,".")}(e,n,a)),"stderr"===n||"stdev"===n)l=[{op:n,field:c,as:"extent_".concat(c)},{op:e,field:c,as:"center_".concat(c)}],u=[{calculate:'datum["center_'.concat(c,'"] + datum["extent_').concat(c,'"]'),as:"upper_".concat(c)},{calculate:'datum["center_'.concat(c,'"] - datum["extent_').concat(c,'"]'),as:"lower_".concat(c)}],f=[{fieldPrefix:"center_",titlePrefix:qP(e)},{fieldPrefix:"upper_",titlePrefix:_U(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:_U(e,n,"-")}],d=!0;else{let t,e,r;"ci"===n?(t="mean",e="ci0",r="ci1"):(t="median",e="q1",r="q3"),l=[{op:e,field:c,as:"lower_".concat(c)},{op:r,field:c,as:"upper_".concat(c)},{op:t,field:c,as:"center_".concat(c)}],f=[{fieldPrefix:"upper_",titlePrefix:$j({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:$j({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:$j({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&jL(function(t,e){return"".concat(e?"extent ":"").concat(e&&t?"and ":"").concat(t?"center ":"").concat(e&&t?"are ":"is ","not needed when data are aggregated.")}(t.center,t.extent)),"aggregated-upper-lower"===o?(f=[],u=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_".concat(c)},{calculate:'datum["'.concat(c,'"]'),as:"lower_".concat(c)}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:'datum["'.concat(c,'"] + datum["').concat(r.field,'"]'),as:"upper_".concat(c)}],i?u.push({calculate:'datum["'.concat(c,'"] + datum["').concat(i.field,'"]'),as:"lower_".concat(c)}):u.push({calculate:'datum["'.concat(c,'"] - datum["').concat(r.field,'"]'),as:"lower_".concat(c)}));for(const t of u)f.push({fieldPrefix:t.as.substring(0,6),titlePrefix:WP(WP(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}(u,d,h,p,m,f,e,n),{[g]:_,["x"===g?"x2":"y2"]:w,["x"===g?"xError":"yError"]:k,["x"===g?"xError2":"yError2"]:A,...E}=o,{bins:M,timeUnits:C,aggregate:S,groupby:D,encoding:F}=rU(E,n),T=[...S,...y],N="raw"!==f?[]:D,O=oU(b,d,F,x);return{transform:[...null!==(r=l.transform)&&void 0!==r?r:[],...M,...C,...0===T.length?[]:[{aggregate:T,groupby:N}],...v],groupby:N,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:F,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:O}}function _U(t,e,n){return"".concat(qP(t)," ").concat(n," ").concat(e)}const wU="errorband",kU=new eU(wU,AU);function AU(t,e){let{config:n}=e;t={...t,encoding:iU(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:l,tooltipEncoding:u}=xU(t,wU,n),c=s,f=sU(c,o,i,a,n.errorband),d=void 0!==t.encoding.x&&void 0!==t.encoding.y;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const m={...c.interpolate?{interpolate:c.interpolate}:{},...c.tension&&c.interpolate?{tension:c.tension}:{}};return d?(h={...h,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):c.interpolate?jL(BL("interpolate")):c.tension&&jL(BL("tension")),{...l,transform:r,layer:[...f({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}const EU={};function MU(t,e,n){const r=new eU(t,e);EU[t]={normalizer:r,parts:n}}MU(dU,mU,["box","median","outliers","rule","ticks"]),MU(yU,bU,["ticks","rule"]),MU(wU,AU,["band","borders"]),BP({titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"}),BP({labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"}),BP({header:1,headerRow:1,headerColumn:1,headerFacet:1});const CU={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1};function SU(t){return!(null===t||void 0===t||!t.select)}BP(CU),BP({align:1,bounds:1,center:1,columns:1,spacing:1}),new Set(["view",...bj]);class DU{map(t,e){return function(t){return"facet"in t}(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):function(t){return"hconcat"in t}(t)?this.mapHConcat(t,e):function(t){return"vconcat"in t}(t)?this.mapVConcat(t,e):function(t){return"concat"in t}(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(function(t){return"layer"in t}(t))return this.mapLayer(t,e);if(tU(t))return this.mapUnit(t,e);throw new Error(function(t){return"Invalid specification ".concat(NP(t),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}(t))}mapLayer(t,e){return{...t,layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))}}mapHConcat(t,e){return{...t,hconcat:t.hconcat.map((t=>this.map(t,e)))}}mapVConcat(t,e){return{...t,vconcat:t.vconcat.map((t=>this.map(t,e)))}}mapConcat(t,e){const{concat:n,...r}=t;return{...r,concat:n.map((t=>this.map(t,e)))}}mapFacet(t,e){return{...t,spec:this.map(t.spec,e)}}mapRepeat(t,e){return{...t,spec:this.map(t.spec,e)}}}const FU={zero:1,center:1,normalize:1},TU=new Set([lj,cj,uj,hj,dj,gj,yj,fj,pj,mj]),NU=new Set([cj,uj,lj]);function OU(t){return Fj(t)&&"quantitative"===function(t){return null===t||void 0===t?void 0:t.type}(t)&&!t.bin}function zU(t,e,n){let{orient:r,type:i}=n;const o="x"===e?"y":"radius",a="x"===e,s=t[e],l=t[o];if(Fj(s)&&Fj(l))if(OU(s)&&OU(l)){if(s.stack)return e;if(l.stack)return o;const t=Fj(s)&&!!s.aggregate;if(t!==(Fj(l)&&!!l.aggregate))return t?e:o;if(a&&"bar"===i){if("vertical"===r)return o;if("horizontal"===r)return e}}else{if(OU(s))return e;if(OU(l))return o}else{if(OU(s))return e;if(OU(l))return o}}function RU(t){const{point:e,line:n,...r}=t;return BP(r).length>1?r:r.type}function PU(t){for(const e of["line","area","rule","trail"])t[e]&&(t={...t,[e]:TP(t[e],["point","line"])});return t}function BU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===t.point?{opacity:0}:t.point?Jt(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?Jt(e.point)?e.point:{}:void 0}function LU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class jU{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(tU(t)){const{mark:n,encoding:r}=t,i=xj(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!BU(i,e[i.type],r);case"area":return!!BU(i,e[i.type],r)||!!LU(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{params:i,projection:o,mark:a,name:s,encoding:l,...u}=t,c=iU(l,r),f=xj(a)?a:{type:a},d=BU(f,r[f.type],c),h="area"===f.type&&LU(f,r[f.type]),p=[{name:s,...i?{params:i}:{},mark:RU({..."area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:TP(c,["shape"])}],m=function(t,e,n,r){const i=xj(t)?t:{type:t},o=i.type;if(!TU.has(o))return null;const a=zU(e,"x",i)||zU(e,"theta",i);if(!a)return null;const s=e[a],l=Fj(s)?qj(s,{}):void 0,u=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(a),c=[],f=new Set;if(e[u]){const t=e[u],n=Fj(t)?qj(t,{}):void 0;n&&n!==l&&(c.push(u),f.add(n));const r="x"===u?"xOffset":"yOffset",i=e[r],o=Fj(i)?qj(i,{}):void 0;o&&o!==l&&(c.push(r),f.add(o))}const d=iL.reduce(((t,n)=>{if("tooltip"!==n&&nU(e,n)){const r=e[n];for(const e of de(r)){const r=Zj(e);if(r.aggregate)continue;const i=qj(r,{});i&&f.has(i)||t.push({channel:n,fieldDef:r})}}return t}),[]);let h;return void 0!==s.stack?h=Fe(s.stack)?s.stack?"zero":null:s.stack:NU.has(o)&&(h="zero"),h&&h in FU?function(t){return zP(TB,(e=>{if(nU(t,e)){const n=t[e];if(Qt(n))return zP(n,(t=>!!t.aggregate));{const t=Zj(n);return t&&!!t.aggregate}}return!1}))}(e)&&0===d.length?null:null!==s&&void 0!==s&&null!==(n=s.scale)&&void 0!==n&&n.type&&"linear"!==(null===s||void 0===s||null===(r=s.scale)||void 0===r?void 0:r.type)?(null!==s&&void 0!==s&&s.stack&&jL("Cannot stack non-linear scale (".concat(s.scale.type,").")),null):Oj(e[function(t){switch(t){case VP:return XP;case GP:return QP;case iB:return aB;case oB:return sB;case nB:return rB;case tB:return eB}}(a)])?(void 0!==s.stack&&jL('Cannot stack "'.concat(p=a,'" if there is already "').concat(p,'2".')),null):(Fj(s)&&s.aggregate&&!EL.has(s.aggregate)&&jL('Stacking is applied even though the aggregate function is non-summative ("'.concat(s.aggregate,'").')),{groupbyChannels:c,groupbyFields:f,fieldChannel:a,impute:null!==s.impute&&vj(o),stackBy:d,offset:h}):null;var p}(f,c);let g=c;if(m){const{fieldChannel:t,offset:e}=m;g={...c,[t]:{...c[t],...e?{stack:e}:{}}}}return g=TP(g,["y2","x2"]),h&&p.push({...o?{projection:o}:{},mark:{type:"line",...FP(f,["clip","interpolate","tension","tooltip"]),...h},encoding:g}),d&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...FP(f,["clip","tooltip"]),...d},encoding:g}),n({...u,layer:p},{...e,config:PU(r)})}}function UU(t,e){return e?Aj(t)?ZU(t,e):WU(t,e):t}function qU(t,e){return e?ZU(t,e):t}function IU(t,e,n){const r=e[t];return function(t){return t&&!Oe(t)&&"repeat"in t}(r)?r.repeat in n?{...e,[t]:n[r.repeat]}:void jL(function(t){return'Unknown repeated value "'.concat(t,'".')}(r.repeat)):e}function WU(t,e){if(void 0!==(t=IU("field",t,e))){if(null===t)return null;if(Mj(t)&&(n=t.sort)&&("count"===n.op||n.field)){const n=IU("field",t.sort,e);t={...t,...n?{sort:n}:{}}}return t}var n}function $U(t,e){if(Fj(t))return WU(t,e);{const n=IU("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function HU(t,e){if(!Oj(t)){if(Dj(t)){const n=$U(t.condition,e);if(n)return{...t,condition:n};{const{condition:e,...n}=t;return n}}return t}{const n=$U(t,e);if(n)return n;if(Cj(t))return{condition:t.condition}}}function ZU(t,e){const n={};for(const r in t)if(Ee(t,r)){const i=t[r];if(Qt(i))n[r]=i.map((t=>HU(t,e))).filter((t=>t));else{const t=HU(i,e);void 0!==t&&(n[r]=t)}}return n}class YU{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(tU(t)){const{encoding:e,mark:n}=t;if("line"===n||xj(n)&&"line"===n.type)for(const t of UB){const n=e[IB(t)];if(e[t]&&(Fj(n)&&!CL(n.bin)||Tj(n)))return!0}}return!1}run(t,e,n){const{encoding:r,mark:i}=t;var o,a;return jL((o=!!r.x2,a=!!r.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(o&&a?"x2 and y2":o?"x2":"y2",". We will use the rule mark (line segments) instead."))),n({...t,mark:Jt(i)?{...i,type:"rule"}:"rule"},e)}}function VU(t){let{parentEncoding:e,encoding:n={},layer:r}=t,i={};if(e){const t=new Set([...BP(e),...BP(n)]);for(const o of t){const t=n[o],a=e[o];if(Oj(t)){const e={...a,...t};i[o]=e}else Dj(t)?i[o]={...t,condition:{...a,...t.condition}}:t||null===t?i[o]=t:(r||Rj(a)||FL(a)||Oj(a)||Qt(a))&&(i[o]=a)}}else i=n;return!i||PP(i)?void 0:i}function GU(t){const{parentProjection:e,projection:n}=t;return e&&n&&jL(function(t){const{parentProjection:e,projection:n}=t;return"Layer's shared projection ".concat(NP(e)," is overridden by a child projection ").concat(NP(n),".")}({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function XU(t,e){const{transform:n,...r}=t;if(n){const t=n.map((t=>{if(function(t){return"filter"in t}(t))return{filter:KU(t,e)};if(function(t){return"bin"in t}(t)&&SL(t.bin))return{...t,bin:JU(t.bin)};if(function(t){return"lookup"in t}(t)){const{selection:e,...n}=t.from;return e?{...t,from:{param:e,...n}}:t}return t}));return{...r,transform:t}}return t}function QU(t,e){var n;const r=DP(t);if(Fj(r)&&SL(r.bin)&&(r.bin=JU(r.bin)),Pj(r)&&null!==(n=r.scale)&&void 0!==n&&null!==(n=n.domain)&&void 0!==n&&n.selection){const{selection:t,...e}=r.scale.domain;r.scale.domain={...e,...t?{param:t}:{}}}if(Cj(r))if(Qt(r.condition))r.condition=r.condition.map((t=>{const{selection:n,param:r,test:i,...o}=t;return r?t:{...o,test:KU(t,e)}}));else{const{selection:t,param:n,test:i,...o}=QU(r.condition,e);r.condition=n?r.condition:{...o,test:KU(r.condition,e)}}return r}function JU(t){const e=t.extent;if(null!==e&&void 0!==e&&e.selection){const{selection:n,...r}=e;return{...t,extent:{...r,param:n}}}return t}function KU(t,e){const n=t=>SP(t,(t=>{var n,r,i;const o={param:t,empty:null===(n=e.emptySelections[t])||void 0===n||n};return null!==(r=(i=e.selectionPredicates)[t])&&void 0!==r||(i[t]=[]),e.selectionPredicates[t].push(o),o}));return t.selection?n(t.selection):SP(t.test||t.filter,(t=>t.selection?n(t.selection):t))}class tq extends DU{map(t,e){var n;const r=null!==(n=e.selections)&&void 0!==n?n:[];if(t.params&&!tU(t)){const e=[];for(const n of t.params)SU(n)?r.push(n):e.push(n);t.params=e}return e.selections=r,super.map(t,e)}mapUnit(t,e){var n;const r=e.selections;if(!r||!r.length)return t;const i=(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name),o=[];for(const a of r)if(a.views&&a.views.length)for(const e of a.views)(Oe(e)&&(e===t.name||i.includes(e))||Qt(e)&&e.map((t=>i.indexOf(t))).every(((t,e,n)=>-1!==t&&(0===e||t>n[e-1]))))&&o.push(a);else o.push(a);return o.length&&(t.params=o),t}}for(const n of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=tq.prototype[n];tq.prototype[n]=function(e,n){return t.call(this,e,eq(e,n))}}function eq(t,e){var n;return t.name?{...e,path:(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name)}:e}var nq,rq;new class extends DU{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[hU,vU,kU,new jU,new YU]}map(t,e){if(tU(t)){const n=nU(t.encoding,HP),r=nU(t.encoding,ZP),i=nU(t.encoding,YP);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=qU(t.encoding,e.repeater),o={...t,...t.name?{name:[e.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{},...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,e);const a=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(o,e.config))return s.run(o,e,a);return o}mapRepeat(t,e){return function(t){return!Qt(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r,...i}=t,{row:o,column:a,layer:s}=n,{repeater:l={},repeaterPrefix:u=""}=e;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:r}},e):{...i,layer:s.map((t=>{const n={...l,layer:t},i="".concat((r.name?"".concat(r.name,"_"):"")+u,"child__layer_").concat(UP(t)),o=this.mapLayerOrUnit(r,{...e,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:o,...a}=t;!Qt(r)&&t.columns&&(t=TP(t,["columns"]),jL(OL("repeat")));const s=[],{repeater:l={},repeaterPrefix:u=""}=e,c=!Qt(r)&&r.row||[l?l.row:null],f=!Qt(r)&&r.column||[l?l.column:null],d=Qt(r)&&r||[l?l.repeat:null];for(const p of d)for(const t of c)for(const n of f){const o={repeat:p,row:t,column:n,layer:l.layer},a=(i.name?"".concat(i.name,"_"):"")+u+"child__"+(Qt(r)?"".concat(UP(p)):(r.row?"row_".concat(UP(t)):"")+(r.column?"column_".concat(UP(n)):"")),c=this.map(i,{...e,repeater:o,repeaterPrefix:a});c.name=a,s.push(TP(c,["data"]))}const h=Qt(r)?t.columns:r.column?r.column.length:1;return{data:null!==(n=i.data)&&void 0!==n?n:o,align:"all",...a,columns:h,concat:s}}mapFacet(t,e){const{facet:n}=t;return Aj(n)&&t.columns&&(t=TP(t,["columns"]),jL(OL("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:o,config:a}=e,s=GU({parentProjection:o,projection:r}),l=VU({parentEncoding:i,encoding:qU(n,e.repeater)});return this.mapUnit({...t,...s?{projection:s}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,e){const{row:n,column:r,facet:i,...o}=t.encoding,{mark:a,width:s,projection:l,height:u,view:c,params:f,encoding:d,...h}=t,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},e),g=qU(o,e.repeater);return this.mapFacet({...h,...m,facet:p,spec:{...s?{width:s}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:a,encoding:g,...f?{params:f}:{}}},e)}getFacetMappingAndLayout(t,e){const{row:n,column:r,facet:i}=t;if(n||r){i&&jL("Facet encoding dropped as ".concat((a=[...n?[HP]:[],...r?[ZP]:[]]).join(" and ")," ").concat(a.length>1?"are":"is"," also specified."));const e={},s={};for(const n of[HP,ZP]){const r=t[n];if(r){const{align:t,center:i,spacing:a,columns:l,...u}=r;e[n]=u;for(const e of["align","center","spacing"]){var o;void 0!==r[e]&&(null!==(o=s[e])&&void 0!==o||(s[e]={}),s[e][n]=r[e])}}}return{facetMapping:e,layout:s}}{const{align:t,center:n,spacing:r,columns:o,...a}=i;return{facetMapping:UU(a,e.repeater),layout:{...t?{align:t}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}var a}mapLayer(t,e){let{parentEncoding:n,parentProjection:r,...i}=e;const{encoding:o,projection:a,...s}=t,l={...i,parentEncoding:VU({parentEncoding:n,encoding:o,layer:!0}),parentProjection:GU({parentProjection:r,projection:a})};return super.mapLayer({...s,...t.name?{name:[l.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{}},l)}},new class extends DU{map(t,e){var n,r;return null!==(n=e.emptySelections)&&void 0!==n||(e.emptySelections={}),null!==(r=e.selectionPredicates)&&void 0!==r||(e.selectionPredicates={}),t=XU(t,e),super.map(t,e)}mapLayerOrUnit(t,e){if((t=XU(t,e)).encoding){const n={};for(const[r,i]of jP(t.encoding))n[r]=QU(i,e);t={...t,encoding:n}}return super.mapLayerOrUnit(t,e)}mapUnit(t,e){const{selection:n,...r}=t;return n?{...r,params:jP(n).map((t=>{let[n,r]=t;const{init:i,bind:o,empty:a,...s}=r;"single"===s.type?(s.type="point",s.toggle=!1):"multi"===s.type&&(s.type="point"),e.emptySelections[n]="none"!==a;for(const u of LP(null!==(l=e.selectionPredicates[n])&&void 0!==l?l:{})){var l;u.empty="none"!==a}return{name:n,value:i,select:s,bind:o}}))}:t}},new tq,(rq=nq||(nq={}))[rq.Raw=0]="Raw",rq[rq.Main=1]="Main",rq[rq.Row=2]="Row",rq[rq.Column=3]="Column",rq[rq.Lookup=4]="Lookup",new Set(["aria","width","height"]);const iq={...CU,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1};BP(iq),new WeakMap;const oq={disable:1,gridScale:1,scale:1,...Jj,labelExpr:1,encode:1};BP(oq),new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);const aq=(t,e)=>("temporal"!==e.type||t instanceof Date?"quantitative"===e.type&&lq(String(t))&&(t=Number(String(t))):t=new Date(t),t instanceof Date?uq(t,e.timeUnit):"string"==typeof t||isNaN(t)||t%1==0?String(t):Number(t).toFixed(2));function sq(t,e){var n;return"temporal"===e.type?(n=t,t=Array.isArray(n)?n.map((t=>new Date(t).getTime())):new Date(n).getTime()):Oe(t)&&lq(t)&&(t=Number(t)),t}function lq(t){return function(t){return!!Ne(t)||!isNaN(t)&&!isNaN(parseFloat(t))}(t.replaceAll(",",""))}function uq(t,e){if(!e)return t.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"});const n={};return e.includes("year")&&(n.year="numeric"),e.includes("month")&&(n.month="short"),e.includes("day")&&(n.weekday="short"),e.includes("date")&&(n.day="numeric"),e.includes("hours")&&(n.hour="numeric"),e.includes("minutes")&&(n.minute="numeric"),e.includes("seconds")&&(n.second="numeric"),Object.keys(n).length?t.toLocaleString("en-US",n):t.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}const cq="E",fq="R",dq="R-E",hq="R-LE",pq="R-RE",mq="LT",gq="LTE",yq="GT",vq="GTE",bq="VALID",xq=t=>"equal"in t?cq:"lt"in t?mq:"gt"in t?yq:"lte"in t?gq:"gte"in t?vq:"range"in t?t.inclusive?fq:pq:"oneOf"in t?"ONE":"valid"in t?bq:"E";function _q(t){if(t){const e=t=>t[Object.keys(t).find((t=>"field"!==t))];if("and"in t){const e=t.and.map((t=>_q(t)));return{unit:"",fields:e.flatMap((t=>(null==t?void 0:t.fields)||[])),values:e.flatMap((t=>(null==t?void 0:t.values)||[]))}}if("or"in t)t.or;else{if(!("not"in t)){const n=[{type:xq(t),field:t.field}],r=[e(t)];return n.length||r.length?{unit:"",fields:n,values:r}:null}t.not}}}function wq(t,e){try{const n=_q(e);return n?t.filter((t=>function(t,e){var n,r=e.fields,i=e.values;return r.every(((e,r)=>{switch(Te(n=t[e.field])&&(n=te(n)),Te(i[r])&&(i[r]=te(i[r])),Te(i[r][0])&&(i[r]=i[r].map(te)),e.type){case cq:return!(Qt(i[r])?i[r].indexOf(n)<0:n!==i[r]);case fq:return De(n,i[r],!0,!0);case pq:return De(n,i[r],!0,!1);case dq:return De(n,i[r],!1,!1);case hq:return De(n,i[r],!1,!0);case mq:return n<i[r];case yq:return n>i[r];case gq:return n<=i[r];case vq:return n>=i[r];case bq:return!(null===n||isNaN(n));default:return!0}}))}(t,n))):t}catch(e){return console.error(e),t}}function kq(t,e,n){const r=new Set,i=n?wq(e,n):e;if(t.timeUnit){const e=new Set;i.map((e=>e[t.field])).forEach((n=>{if(n instanceof Date){const i=uq(n,t.timeUnit);e.has(i)||(e.add(i),r.add(n))}}))}else{const e=new Set;i.map((e=>e[t.field])).forEach((t=>{if(t instanceof Date){const n=t.getTime();e.has(n)||(e.add(n),r.add(t))}else r.add(t)}))}return[...r].filter((t=>null!=t)).sort(((t,e)=>t instanceof Date&&e instanceof Date?t.getTime()-e.getTime():"string"==typeof t&&"string"==typeof e?t.localeCompare(e):t-e))}function Aq(t,e){return e.find((e=>e.field===t))}function Eq(){}function Mq(t){return null==t?Eq:function(){return this.querySelector(t)}}function Cq(){return[]}function Sq(t){return null==t?Cq:function(){return this.querySelectorAll(t)}}function Dq(t){return function(){return this.matches(t)}}function Fq(t){return function(e){return e.matches(t)}}var Tq=Array.prototype.find;function Nq(){return this.firstElementChild}var Oq=Array.prototype.filter;function zq(){return Array.from(this.children)}function Rq(t){return new Array(t.length)}function Pq(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Bq(t,e,n,r,i,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Pq(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function Lq(t,e,n,r,i,o,a){var s,l,u,c=new Map,f=e.length,d=o.length,h=new Array(f);for(s=0;s<f;++s)(l=e[s])&&(h[s]=u=a.call(l,l.__data__,s,e)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<d;++s)u=a.call(t,o[s],s,o)+"",(l=c.get(u))?(r[s]=l,l.__data__=o[s],c.delete(u)):n[s]=new Pq(t,o[s]);for(s=0;s<f;++s)(l=e[s])&&c.get(h[s])===l&&(i[s]=l)}function jq(t){return t.__data__}function Uq(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function qq(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Pq.prototype={constructor:Pq,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Iq="http://www.w3.org/1999/xhtml";const Wq={svg:"http://www.w3.org/2000/svg",xhtml:Iq,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $q(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Wq.hasOwnProperty(e)?{space:Wq[e],local:t}:t}function Hq(t){return function(){this.removeAttribute(t)}}function Zq(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Yq(t,e){return function(){this.setAttribute(t,e)}}function Vq(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Gq(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Xq(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Qq(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Jq(t){return function(){this.style.removeProperty(t)}}function Kq(t,e,n){return function(){this.style.setProperty(t,e,n)}}function tI(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function eI(t,e){return t.style.getPropertyValue(e)||Qq(t).getComputedStyle(t,null).getPropertyValue(e)}function nI(t){return function(){delete this[t]}}function rI(t,e){return function(){this[t]=e}}function iI(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function oI(t){return t.trim().split(/^|\s+/)}function aI(t){return t.classList||new sI(t)}function sI(t){this._node=t,this._names=oI(t.getAttribute("class")||"")}function lI(t,e){for(var n=aI(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function uI(t,e){for(var n=aI(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function cI(t){return function(){lI(this,t)}}function fI(t){return function(){uI(this,t)}}function dI(t,e){return function(){(e.apply(this,arguments)?lI:uI)(this,t)}}function hI(){this.textContent=""}function pI(t){return function(){this.textContent=t}}function mI(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function gI(){this.innerHTML=""}function yI(t){return function(){this.innerHTML=t}}function vI(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function bI(){this.nextSibling&&this.parentNode.appendChild(this)}function xI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _I(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Iq&&e.documentElement.namespaceURI===Iq?e.createElement(t):e.createElementNS(n,t)}}function wI(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function kI(t){var e=$q(t);return(e.local?wI:_I)(e)}function AI(){return null}function EI(){var t=this.parentNode;t&&t.removeChild(this)}function MI(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function CI(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function SI(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function DI(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function FI(t,e,n){var r=Qq(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function TI(t,e){return function(){return FI(this,t,e)}}function NI(t,e){return function(){return FI(this,t,e.apply(this,arguments))}}sI.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var OI=[null];function zI(t,e){this._groups=t,this._parents=e}function RI(){return new zI([[document.documentElement]],OI)}zI.prototype=RI.prototype={constructor:zI,select:function(t){"function"!=typeof t&&(t=Mq(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new zI(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return function(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):Sq(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(t.call(a,a.__data__,u,s)),i.push(a));return new zI(r,i)},selectChild:function(t){return this.select(null==t?Nq:function(t){return function(){return Tq.call(this.children,t)}}("function"==typeof t?t:Fq(t)))},selectChildren:function(t){return this.selectAll(null==t?zq:function(t){return function(){return Oq.call(this.children,t)}}("function"==typeof t?t:Fq(t)))},filter:function(t){"function"!=typeof t&&(t=Dq(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new zI(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,jq);var n=e?Lq:Bq,r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],f=i[u],d=f.length,h=Uq(t.call(c,c&&c.__data__,u,r)),p=h.length,m=s[u]=new Array(p),g=a[u]=new Array(p);n(c,f,m,g,l[u]=new Array(d),h,e);for(var y,v,b=0,x=0;b<p;++b)if(y=m[b]){for(b>=x&&(x=b+1);!(v=g[x])&&++x<p;);y._next=v||null}}return(a=new zI(a,r))._enter=s,a._exit=l,a},enter:function(){return new zI(this._enter||this._groups.map(Rq),this._parents)},exit:function(){return new zI(this._exit||this._groups.map(Rq),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,c=n[l],f=r[l],d=c.length,h=s[l]=new Array(d),p=0;p<d;++p)(u=c[p]||f[p])&&(h[p]=u);for(;l<i;++l)s[l]=n[l];return new zI(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=qq);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(e)}return new zI(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=$q(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Zq:Hq:"function"==typeof e?n.local?Xq:Gq:n.local?Vq:Yq)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Jq:"function"==typeof e?tI:Kq)(t,e,null==n?"":n)):eI(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?nI:"function"==typeof e?iI:rI)(t,e)):this.node()[t]},classed:function(t,e){var n=oI(t+"");if(arguments.length<2){for(var r=aI(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?dI:e?cI:fI)(n,e))},text:function(t){return arguments.length?this.each(null==t?hI:("function"==typeof t?mI:pI)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?gI:("function"==typeof t?vI:yI)(t)):this.node().innerHTML},raise:function(){return this.each(bI)},lower:function(){return this.each(xI)},append:function(t){var e="function"==typeof t?t:kI(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:kI(t),r=null==e?AI:"function"==typeof e?e:Mq(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(EI)},clone:function(t){return this.select(t?CI:MI)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?DI:SI,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?NI:TI)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};const PI=RI;function BI(t,e,n){var r=new jA;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}var LI=EA("start","end","cancel","interrupt"),jI=[],UI=0,qI=3;function II(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var u,c,f,d;if(1!==n.state)return s();for(u in i)if((d=i[u]).name===n.name){if(d.state===qI)return BI(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(BI((function(){n.state===qI&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=qI,r=new Array(f=n.tween.length),u=0,c=-1;u<f;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=UA((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:LI,tween:jI,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:UI})}function WI(t,e){var n=HI(t,e);if(n.state>UI)throw new Error("too late; already scheduled");return n}function $I(t,e){var n=HI(t,e);if(n.state>qI)throw new Error("too late; already running");return n}function HI(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ZI(t,e){var n,r;return function(){var i=$I(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function YI(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=$I(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function VI(t,e,n){var r=t._id;return t.each((function(){var t=$I(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return HI(t,r).value[e]}}function GI(t,e){var n;return("number"==typeof e?Yc:e instanceof hc?Lc:(n=hc(e))?(e=n,Lc):Qc)(t,e)}function XI(t){return function(){this.removeAttribute(t)}}function QI(t){return function(){this.removeAttributeNS(t.space,t.local)}}function JI(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function KI(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function tW(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function eW(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function nW(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function rW(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function iW(t,e){return function(){WI(this,t).delay=+e.apply(this,arguments)}}function oW(t,e){return e=+e,function(){WI(this,t).delay=e}}function aW(t,e){return function(){$I(this,t).duration=+e.apply(this,arguments)}}function sW(t,e){return e=+e,function(){$I(this,t).duration=e}}var lW=PI.prototype.constructor;function uW(t){return function(){this.style.removeProperty(t)}}var cW=0;function fW(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function dW(){return++cW}var hW=PI.prototype;fW.prototype=function(t){return PI().transition(t)}.prototype={constructor:fW,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Mq(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=r[a],c=u.length,f=o[a]=new Array(c),d=0;d<c;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),f[d]=l,II(f[d],e,n,d,f,HI(s,n)));return new fW(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Sq(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,f=0;f<c;++f)if(l=u[f]){for(var d,h=t.call(l,l.__data__,f,u),p=HI(l,n),m=0,g=h.length;m<g;++m)(d=h[m])&&II(d,e,n,m,h,p);o.push(h),a.push(l)}return new fW(o,a,e,n)},selectChild:hW.selectChild,selectChildren:hW.selectChildren,filter:function(t){"function"!=typeof t&&(t=Dq(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new fW(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=e[s],c=n[s],f=u.length,d=a[s]=new Array(f),h=0;h<f;++h)(l=u[h]||c[h])&&(d[h]=l);for(;s<r;++s)a[s]=e[s];return new fW(a,this._parents,this._name,this._id)},selection:function(){return new lW(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=dW(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=HI(a,e);II(a,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new fW(r,this._parents,t,n)},call:hW.call,nodes:hW.nodes,node:hW.node,size:hW.size,empty:hW.empty,each:hW.each,on:function(t,e){var n=this._id;return arguments.length<2?HI(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?WI:$I;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}(n,t,e))},attr:function(t,e){var n=$q(t),r="transform"===n?ld:GI;return this.attrTween(t,"function"==typeof e?(n.local?eW:tW)(n,r,VI(this,"attr."+t,e)):null==e?(n.local?QI:XI)(n):(n.local?KI:JI)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=$q(t);return this.tween(n,(r.local?nW:rW)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?sd:GI;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=eI(this,t),a=(this.style.removeProperty(t),eI(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,uW(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=eI(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=eI(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,VI(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=$I(this,t),u=l.on,c=null==l.value[a]?o||(o=uW(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=eI(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(VI(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=HI(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?ZI:YI)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?iW:oW)(e,t)):HI(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?aW:sW)(e,t)):HI(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){$I(this,t).ease=e}}(e,t)):HI(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;$I(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--i&&o()}};n.each((function(){var n=$I(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:hW[Symbol.iterator]};var pW={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function mW(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error("transition ".concat(e," not found"));return n}PI.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},PI.prototype.transition=function(t){var e,n;t instanceof fW?(e=t._id,t=t._name):(e=dW(),(n=pW).time=BA(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&II(a,t,e,u,s,n||mW(a,e));return new fW(r,this._parents,t,e)};const{abs:gW,max:yW,min:vW}=Math;function bW(t){return{type:t}}function xW(t,e,n){this.k=t,this.x=e,this.y=n}function _W(t,e,n,r,i){const o=Aq(t,n),a=kq(o,e,i),s=[];let l=r;if(!l)if("temporal"===o.type)l=Lf().domain([a[0],a[a.length-1]]).ticks(6);else{if(o.bin&&t.startsWith("bin_"))return a.map((n=>{const r=e.find((e=>e[t]===n))[t+"_end"];return[Number(n),Number(r)]}));{const t=X({maxbins:10,extent:[a[0],a[a.length-1]]});l=[];for(let e=t.start;e<=t.stop;e+=t.step)l.push(e)}}l=l.filter((t=>t>=a[0]&&t<=a[a.length-1])),a[0]<l[0]&&s.push([a[0],l[0]]);for(let u=0;u<l.length-1;u++)s.push([l[u],l[u+1]]);return a[a.length-1]>l[l.length-1]&&s.push([l[l.length-1],a[a.length-1]]),s}function wW(t){return t.slice(0,1).toUpperCase()+t.slice(1)}function kW(t){return t.endsWith(".")?t.slice(0,-1):t}["w","e"].map(bW),["n","s"].map(bW),["n","w","e","s","nw","ne","sw","se"].map(bW),xW.prototype={constructor:xW,scale:function(t){return 1===t?this:new xW(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new xW(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new xW(1,0,0),xW.prototype;const AW=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return"".concat(t," ").concat(e).concat(1!==t?n:"")},EW=(t,e)=>Math.round(t.reduce(((t,n)=>t+Number(n[e])),0)/t.length);let MW={name:!0,index:!0,type:!0,children:!0,data:!0,size:!0,level:!1,parent:!0,quartile:!1,aggregate:!0,instructions:!0};var CW=n(925),SW=n.n(CW);function DW(t){const e=function(){let t;try{throw t=new(SW())("settingsData"),t.version,new Error("Incompatible legacy storage schema")}catch(e){t=new(SW())("settingsData",1),t.write(MW)}return t}().read();return Array.from(t.description).filter((t=>{let[n,r]=t;return e[n]})).map((t=>{let[e,n]=t;return n})).filter((t=>t.length>0)).map(wW).map(kW).join(". ")+"."}function FW(t,e){return"and"in t?t.and.map((t=>FW(t,e))).join(" and "):"or"in t?t.or.map((t=>FW(t,e))).join(" or "):"not"in t?"not ".concat(FW(t.not,e)):function(t,e){const n=Aq(t.field,e),r=n.label||n.field;return"equal"in t?"".concat(r," equals ").concat(aq(t.equal,n)):"range"in t?"".concat(r," is between ").concat(aq(t.range[0],n)," and ").concat(aq(t.range[1],n)):"lt"in t?"".concat(r," is less than ").concat(aq(t.lt,n)):"lte"in t?"".concat(r," is less than or equal to ").concat(aq(t.lte,n)):"gt"in t?"".concat(r," is greater than ").concat(aq(t.gt,n)):"gte"in t?"".concat(r," is greater than or equal to ").concat(aq(t.gte,n)):""}(t,e)}var TW=n(62),NW=n.n(TW),OW=n(36),zW=n.n(OW),RW=n(793),PW=n.n(RW),BW=n(892),LW=n.n(BW),jW=n(173),UW=n.n(jW),qW=n(464),IW=n.n(qW),WW=n(914),$W={};function HW(t){switch(t){case"=":return"equal";case"between":return"range";case"<":return"lt";case"<=":return"lte";case">":return"gt";case">=":return"gte"}}function ZW(t,e,n,r){const i=document.createElement("div"),o=document.createElement("select");o.classList.add("olli-field-select"),o.setAttribute("name","olli-field-select");const a=document.createElement("select");a.classList.add("olli-op-select"),a.setAttribute("name","olli-op-select");const s=document.createElement("span");s.classList.add("olli-value-container");const l=e.fields.map((t=>{const e=document.createElement("option");return e.setAttribute("value",t.field),e.innerText=t.field,e}));function u(e){const o=r.indexOf(i);n[o]=e,t.setAttribute("data-state",JSON.stringify(n))}o.replaceChildren(...l),o.onchange=()=>{const t=Aq(o.value,e.fields);let n=["="];"quantitative"!==t.type&&"temporal"!==t.type||(n=["between","<","<=",">",">=","="]);const r=n.map((t=>{const e=document.createElement("option");return e.setAttribute("value",t),e.innerText=t,e}));a.replaceChildren(...r),a.onchange(null)},a.onchange=()=>{const t=o.value,n=a.value,r=Aq(t,e.fields);if("="!==n||"nominal"!==r.type&&"ordinal"!==r.type){if("between"===n){if("quantitative"===r.type){const e=document.createElement("input");e.setAttribute("type","number");const n=document.createElement("input");n.setAttribute("type","number"),s.replaceChildren(e,n),e.onchange=n.onchange=()=>{const r=Number(e.value),i=Number(n.value);u({field:t,range:[r,i]})}}else if("temporal"===r.type){const e=document.createElement("input");e.setAttribute("type","datetime-local");const n=document.createElement("input");n.setAttribute("type","datetime-local"),s.replaceChildren(e,n),e.onchange=n.onchange=()=>{const i=sq(new Date(e.value),r),o=sq(new Date(n.value),r);u({field:t,range:[i,o]})}}}else if("quantitative"===r.type){const e=document.createElement("input");e.setAttribute("type","number"),s.replaceChildren(e),e.onchange=()=>{const r=Number(e.value),i=HW(n);u({field:t,[i]:r})}}else if("temporal"===r.type){const e=document.createElement("input");e.setAttribute("type","datetime-local"),s.replaceChildren(e),e.onchange=()=>{const i=sq(new Date(e.value),r),o=HW(n);u({field:t,[o]:i})}}}else{const n=kq(r,e.data),i=document.createElement("select"),o=n.map((t=>{const e=document.createElement("option");return e.setAttribute("value",sq(t,r)),e.innerText=String(t),e}));i.replaceChildren(...o),s.replaceChildren(i),i.onchange=()=>{const e=i.value;u({field:t,equal:e})}}},i.replaceChildren(o,a,s);const c=document.createElement("button");return c.innerText="Remove condition",c.onclick=()=>{const e=r.indexOf(i);r.splice(e,1),n.splice(e,1),t.setAttribute("data-state",JSON.stringify(n)),i.remove(),0===r.length&&t.querySelector(".olli-clear-button").classList.add("olli-hidden"),document.querySelector(".olli-status-text").innerHTML=AW(r.length,"condition")},i.appendChild(c),o.onchange(null),i}$W.styleTagTransform=IW(),$W.setAttributes=LW(),$W.insert=PW().bind(null,"head"),$W.domAPI=zW(),$W.insertStyleElement=UW(),NW()(WW.Z,$W),WW.Z&&WW.Z.locals&&WW.Z.locals;const YW=t=>"operator"in t;function VW(t,e){function n(t){t.children.forEach((e=>{e.parent=t}));const n=GW(t,e)||(YW(e)?{data:e.units.flatMap((t=>t.data)),selection:null,fields:e.units.flatMap((t=>t.fields)).filter((t=>void 0!==t)),axes:e.units.flatMap((t=>t.axes)).filter((t=>void 0!==t)),legends:e.units.flatMap((t=>t.legends)).filter((t=>void 0!==t))}:e),r=n.selection?wq(n.data,n.selection):n.data;t.description=function(t,e,n){var r,i,o;const a="".concat(((null===(r=t.parent)||void 0===r?void 0:r.children.indexOf(t))||0)+1," of ").concat(((null===(i=t.parent)||void 0===i?void 0:i.children)||[]).length),s=n.description||"",l=function(t){var e,n,r;if(t.mark){if("point"===t.mark&&2===(null===(e=t.axes)||void 0===e?void 0:e.length)){if(t.axes.every((e=>"quantitative"===Aq(e.field,t.fields).type)))return"scatterplot";if(t.axes.find((e=>"quantitative"===Aq(e.field,t.fields).type))&&!t.axes.find((e=>"temporal"===Aq(e.field,t.fields).type)))return"dotplot"}return"line"===t.mark&&2===(null===(n=t.axes)||void 0===n?void 0:n.length)&&1===(null===(r=t.guides)||void 0===r?void 0:r.length)&&t.axes.every((e=>"quantitative"===Aq(e.field,t.fields).type))&&"order"===t.guides[0].channel?"connected scatterplot":"".concat(t.mark," chart")}return"dataset"}(n),u=null===(o=n.axes)||void 0===o?void 0:o.map((t=>{const e=Aq(t.field,n.fields);return t.title||e.label||t.field})).join(" and "),c=new Map([["root",["name","type","size","children","level"]],["view",["index","type","name","children","level"]],["xAxis",["name","type","data","parent","aggregate","level"]],["yAxis",["name","type","data","parent","aggregate","level"]],["legend",["name","type","data","parent","aggregate","level"]],["guide",["name","type","data","parent","level"]],["filteredData",["index","data","size","parent","aggregate","quartile","level","instructions"]],["annotations",["size","level"]],["other",["index","data","size","level","instructions"]]]),f=new Map([["name",function(t){var e,r,i;switch(t.nodeType){case"root":return"groupby"in t?s:n.mark&&n.description||"";case"view":return"predicate"in t&&"equal"in t.predicate?"titled ".concat(aq(t.predicate.equal,Aq(t.predicate.field,n.fields))):"";case"xAxis":case"yAxis":case"legend":case"guide":const o=Aq(t.groupby,n.fields),a=(null===(e=n.axes)||void 0===e?void 0:e.find((e=>e.field===t.groupby)))||(null===(r=n.legends)||void 0===r?void 0:r.find((e=>e.field===t.groupby)))||(null===(i=n.guides)||void 0===i?void 0:i.find((e=>e.field===t.groupby)));return"".concat("xAxis"===t.nodeType?"x-axis":"yAxis"===t.nodeType?"y-axis":"legend"===t.nodeType?"legend":a.channel?a.channel:"guide"," titled ").concat(a.title||o.label||o.field);default:throw"Node type ".concat(t.nodeType," does not have the 'name' token.")}}],["index",function(t){switch(t.nodeType){case"view":case"filteredData":case"other":return a;default:throw"Node type ".concat(t.nodeType," does not have the 'index' token.")}}],["type",function(t){var r,i,o;switch(t.nodeType){case"root":if("groupby"in t)return"a ".concat(((t,e)=>t&&"groupby"in t&&"root"===t.nodeType?"line"===e.mark?"multi-series ":"multi-view ":"")(t,n)).concat(l);if(n.mark)return"a ".concat(l);if(t.children.length){if("layer"===t.children[0].viewType)return"a layered chart";if("concat"===t.children[0].viewType)return"a multi-view chart"}return"a dataset";case"view":return"a ".concat("line"===n.mark?"line":n.mark?l:t.viewType?t.viewType:"view");case"xAxis":case"yAxis":case"legend":case"guide":if("groupby"in t){const a=Aq(t.groupby,n.fields);if("quantitative"!==a.type&&"temporal"!==a.type)return"for a ".concat(a.type," scale");{const s=(null===(r=n.axes)||void 0===r?void 0:r.find((e=>e.field===t.groupby)))||(null===(i=n.legends)||void 0===i?void 0:i.find((e=>e.field===t.groupby)))||(null===(o=n.guides)||void 0===o?void 0:o.find((e=>e.field===t.groupby)));if(_W(t.groupby,e,n.fields,"ticks"in s&&Array.isArray(s.ticks)?s.ticks:void 0).length)return"for a ".concat("scaleType"in s&&s.scaleType||a.type," scale")}}return"";default:throw"Node type ".concat(t.nodeType," does not have the 'type' token.")}}],["children",function(t){var e,r;switch(t.nodeType){case"root":if("groupby"in t||n.mark&&(null===(e=n.axes)||void 0===e?void 0:e.length))return"with ".concat(n.axes.length>1?"axes":"axis"," ").concat(u);const i=n.fields.map((t=>t.label||t.field));return i.length<=3?" "+[...i].join(", "):"";case"view":return(null===(r=n.axes)||void 0===r?void 0:r.length)?"with ".concat(n.axes.length>1?"axes":"axis"," ").concat(u):"";default:throw"Node type ".concat(t.nodeType," does not have the 'children' token.")}}],["data",function(t){var r;switch(t.nodeType){case"xAxis":case"yAxis":case"legend":case"guide":if("groupby"in t){const i=Aq(t.groupby,n.fields);let o,a;if("quantitative"===i.type||"temporal"===i.type){const s=null===(r=n.axes)||void 0===r?void 0:r.find((e=>e.field===t.groupby)),l=_W(t.groupby,e,n.fields,s?s.ticks:void 0);if(l.length)return o=aq(l[0][0],i),a=aq(l[l.length-1][1],i),"with values from ".concat(o," to ").concat(a)}else{const t=kq(i,e);if(t.length)return o=aq(t[0],i),a=aq(t[t.length-1],i),"with ".concat(AW(t.length,"value")," from ").concat(o," to ").concat(a)}}return"";case"filteredData":return"predicate"in t?FW(t.predicate,n.fields):"";case"other":if("groupby"in t)return"grouped by ".concat(t.groupby);if("predicate"in t)return FW(t.predicate,n.fields);default:throw"Node type ".concat(t.nodeType," does not have the 'data' token.")}}],["size",function(t){var r;switch(t.nodeType){case"root":return"groupby"in t?"with ".concat(t.children.length," views for ").concat(t.groupby):n.mark&&(null===(r=n.axes)||void 0===r?void 0:r.length)||n.mark?"":"with ".concat(n.fields.length," fields");case"filteredData":if("predicate"in t){const n=wq(e,t.fullPredicate);return"".concat(AW(n.length,"value"))}return"";case"annotations":return"".concat(t.children.length," annotations");case"other":if("groupby"in t)return"".concat(t.children.length," groups");if("predicate"in t){const n=wq(e,t.fullPredicate);return"".concat(AW(n.length,"value"))}return"";default:throw"Node type ".concat(t.nodeType," does not have the 'size' token.")}}],["level",function(t){return"level ".concat(t.level)}],["parent",function(t){switch(t.nodeType){case"xAxis":case"yAxis":case"legend":case"guide":case"filteredData":let e=t;for(;e.parent&&"view"!=e.nodeType;)e=e.parent;return"predicate"in e&&"equal"in e.predicate?"".concat(aq(e.predicate.equal,Aq(e.predicate.field,n.fields))):"";default:throw"Node type ".concat(t.nodeType," does not have the 'parent' token.")}}],["quartile",function(t){var r,i,o,a;if("filteredData"===t.nodeType){const s="xAxis"===t.parent.nodeType?"x":"y",l=null===(r=n.axes)||void 0===r?void 0:r.find((t=>t.axisType!==s));if(!l)return"";const u=Aq(l.field,n.fields);if("quantitative"!==u.type)return"";const c=u.label||u.field,f=u.field,d=[];t.parent.children.forEach((t=>{const n=wq(e,t.fullPredicate);0!=n.length?d.push(Number(EW(n,f))):d.push(0)})),d.sort((function(t,e){return t-e}));const h=wq(e,t.fullPredicate),p=0==h.length?0:EW(h,f),m=d.indexOf(Number(p))/d.length;return"this section's average ".concat(c," is in the ").concat((a=(i=Math.max(1,Math.ceil(4*m)))%100,1==(o=i%10)&&11!=a?i+"st":2==o&&12!=a?i+"nd":3==o&&13!=a?i+"rd":i+"th")," quartile  of all sections")}throw"Node type ".concat(t.nodeType," does not have the 'quartile' token.")}],["aggregate",function(t){var r;let i;switch(t.nodeType){case"xAxis":case"yAxis":case"legend":i="xAxis"===t.nodeType?"x":"y";case"filteredData":i||(i="xAxis"===t.parent.nodeType?"x":"y");let o=Aq(t.groupby,n.fields);if(!o||"quantitative"!==o.type){const t=null===(r=n.axes)||void 0===r?void 0:r.find((t=>t.axisType!==i));if(!t)return"";const e=Aq(t.field,n.fields);if("quantitative"!==e.type)return"";o=e}const a=o.label||o.field,s=o.field,l=wq(e,t.fullPredicate);if(0===l.length)return"";if(1===l.length)return"the ".concat(a," value is ").concat(aq(l[0][s],o));const u=EW(l,s),c=l.reduce(((t,e)=>Math.max(t,Number(e[s]))),Number(l[0][s])),f=l.reduce(((t,e)=>Math.min(t,Number(e[s]))),Number(l[0][s]));return"the average value for the ".concat(a," field is ").concat(aq(u,o),", the maximum is ").concat(aq(c,o),", and the minimum is ").concat(aq(f,o));default:throw"Node type ".concat(t.nodeType," does not have the 'aggregate' token.")}}],["instructions",function(t){switch(t.nodeType){case"filteredData":case"other":return"predicate"in t&&wq(e,t.fullPredicate).length?"press t to open table":"";default:throw"Node type ".concat(t.nodeType," does not have the 'instructions' token.")}}]]),d=new Map,h=c.get(t.nodeType);if(void 0!==h)for(const p of h){const e=f.get(p);void 0!==e&&d.set(p,e(t))}return d}(t,r,n)}const r=[t];for(;r.length>0;){const t=r.shift();n(t),r.push(...t.children)}}function GW(t,e){return YW(e)?e.units[t.specIndex]:e}function XW(t,e,n,r,i){const o=document.createElement("div");o.setAttribute("class","olli-dialog"),o.setAttribute("role","dialog"),o.setAttribute("aria-labelledby","overlay-title"),o.setAttribute("aria-describedby","overlay-instructions");const a=document.createElement("div");a.setAttribute("role","document");const s=document.createElement("h2");s.setAttribute("id","overlay-title"),s.innerText=e;const l=document.createElement("p");l.setAttribute("id","overlay-instructions"),l.innerText=n;const u=()=>{o.remove(),t.setFocusToItem(t.lastFocusedTreeItem),(null==i?void 0:i.onClose)&&(null==i||i.onClose())};o.addEventListener("keydown",(t=>{"Escape"===t.key&&u()}));const c=document.createElement("button");c.innerText="Close "+e,c.addEventListener("click",u);const f=document.createElement("div");if(f.setAttribute("id","olli-dialog-content"),f.appendChild(r),a.appendChild(c),a.appendChild(s),a.appendChild(l),a.appendChild(f),null==i?void 0:i.onOk){const t=document.createElement("button");t.innerText="Cancel",t.addEventListener("click",u),a.appendChild(t);const e=document.createElement("button");e.innerText="Ok",e.addEventListener("click",(()=>{u(),null==i||i.onOk()})),a.appendChild(e)}return o.appendChild(a),o}function QW(t,e){e.querySelectorAll(".olli-dialog").forEach((t=>{t.remove()})),e.appendChild(t),window.requestAnimationFrame((()=>{t.querySelector("button").focus()}))}class JW{constructor(t,e,n,r){t.tabIndex=-1,this.tree=e,this.domNode=t,this.olliNode=n,this.isExpandable=!1,this.inGroup=!1,r&&(this.inGroup=!0),this.parent=r,this.children=[];let i=t.firstElementChild;for(;i;){if("ul"==i.tagName.toLowerCase()){this.isExpandable=!0;break}i=i.nextElementSibling}}init(){this.domNode.tabIndex=-1,this.domNode.addEventListener("keydown",this.handleKeydown.bind(this)),this.domNode.addEventListener("click",this.handleClick.bind(this)),this.domNode.addEventListener("focus",this.handleFocus.bind(this)),this.domNode.addEventListener("blur",this.handleBlur.bind(this)),this.isExpandable||(this.domNode.addEventListener("mouseover",this.handleMouseOver.bind(this)),this.domNode.addEventListener("mouseout",this.handleMouseOut.bind(this)))}isExpanded(){return!!this.isExpandable&&this.domNode.classList.contains("expanded")}handleKeydown(t){t.altKey||t.ctrlKey||t.metaKey||this.checkBaseKeys(t)}checkBaseKeys(t){switch(t.key){case"Enter":case" ":this.isExpandable&&(this.isExpanded()?this.tree.collapseTreeItem(this):this.tree.expandTreeItem(this));break;case"ArrowDown":this.children.length>0&&this.isExpandable&&this.tree.setFocusToNextLayer(this);break;case"Escape":case"ArrowUp":this.inGroup&&this.tree.setFocusToParentItem(this);break;case"ArrowLeft":t.shiftKey?this.tree.isLateralPossible()&&this.tree.setFocusToLateralItem(this,"left"):this.tree.setFocusToPreviousItem(this);break;case"ArrowRight":t.shiftKey?this.tree.isLateralPossible()&&this.tree.setFocusToLateralItem(this,"right"):this.tree.setFocusToNextItem(this);break;case"Home":this.parent&&this.tree.setFocusToFirstInLayer(this);break;case"End":this.parent&&this.tree.setFocusToLastInLayer(this);break;case"x":this.tree.focusOnNodeType("xAxis",this);break;case"y":this.tree.focusOnNodeType("yAxis",this);break;case"l":this.tree.focusOnNodeType("legend",this);break;case"t":!function(t,e){const n=GW(t,e.olliSpec),r=function(t,e){const n=document.createElement("table"),r=document.createElement("thead"),i=document.createElement("tr");e.forEach((t=>{const e=document.createElement("th");e.setAttribute("scope","col"),e.innerText=t.label||t.field,i.appendChild(e)})),r.appendChild(i),n.appendChild(r);const o=document.createElement("tbody");return t.forEach((t=>{const n=document.createElement("tr");e.forEach((e=>{const r=document.createElement("td");r.innerText=aq(t[e.field],e),n.appendChild(r)})),o.appendChild(n)})),n.appendChild(o),n}(wq(n.data,t.fullPredicate),n.fields);QW(XW(e,"Table View",FW(t.fullPredicate,n.fields),r),e.renderContainer)}(this.olliNode,this.tree);break;case"f":!function(t,e){const n=function(t){const e=t.selection?"and"in t.selection?t.selection.and:[t.selection]:[],n=document.createElement("div"),r=document.createElement("div"),i=[];e.length&&e.forEach(((r,o)=>{i.length<=o&&i.push(ZW(n,t,e,i)),function(t,e,n){const r=t.querySelector(".olli-field-select"),i=t.querySelector(".olli-op-select"),o=t.querySelector(".olli-value-container"),a=e.field,s=Aq(a,n.fields),l=Object.keys(e).find((t=>"field"!==t)),u=e[l];if(r.value=a,r.onchange(null),i.value=function(t){switch(t){case"equal":return"=";case"range":return"between";case"lt":return"<";case"lte":return"<=";case"gt":return">";case"gte":return">="}}(l),i.onchange(null),"range"===l){const t=u[0],e=u[1],n=o.querySelectorAll("input");if("temporal"===s.type){const t=new Date(u[0]);t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),n[0].value=t.toISOString().slice(0,16);const e=new Date(u[1]);e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),n[1].value=e.toISOString().slice(0,16)}else n[0].value=t,n[1].value=e}else if("equal"===l&&o.querySelector("select"))o.querySelector("select").value=u;else{const t=o.querySelector("input");if("temporal"===s.type){const e=new Date(u);e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),t.value=e.toISOString().slice(0,16)}else t.value=u}}(i[o],r,t)})),r.replaceChildren(...i);const o=document.createElement("button");o.innerText="Add condition",o.onclick=()=>{i.push(ZW(n,t,e,i)),r.replaceChildren(...i),i.length>0&&(n.querySelector(".olli-clear-button").classList.remove("olli-hidden"),document.querySelector(".olli-status-text").innerHTML=AW(i.length,"condition"))};const a=document.createElement("button");a.classList.add("olli-clear-button"),a.innerText="Clear conditions",0===i.length&&a.classList.add("olli-hidden"),a.onclick=()=>{i.forEach((t=>{t.remove()})),i.splice(0,i.length),r.replaceChildren(...i),e.splice(0,e.length),n.setAttribute("data-state",JSON.stringify(e)),document.querySelector(".olli-status-text").innerHTML=AW(i.length,"condition")};const s=document.createElement("div");return s.setAttribute("role","status"),s.classList.add("olli-status-text"),s.innerHTML=AW(i.length,"condition"),n.replaceChildren(s,o,r,a),n.setAttribute("data-state",JSON.stringify(e)),n}(GW(t,e.olliSpec));QW(XW(e,"Filter Menu","Define a custom filter.",n,{onOk:()=>{var t,r;const i={and:JSON.parse(n.getAttribute("data-state"))};e.setSelection(i),(null===(t=e.callbacks)||void 0===t?void 0:t.onSelection)&&(null===(r=e.callbacks)||void 0===r||r.onSelection(i))}}),e.renderContainer)}(this.olliNode,this.tree);break;case"r":!function(t){const e=function(t){const e=document.createElement("div");let n=t.rootTreeItem.olliNode.id;const r=function r(i){if(!i.children||!i.children.length)return null;const o=GW(i,t.olliSpec),a=document.createElement("div"),s=document.createElement("div"),l=document.createElement("select"),u=[...i.children].sort(((t,e)=>{const n=wq(o.data,t.fullPredicate).length;return wq(o.data,e.fullPredicate).length-n})),c=u.map((e=>{var n;const r=document.createElement("option");return r.setAttribute("value",e.id),r.innerText=DW(e),(null===(n=t.lastFocusedTreeItem)||void 0===n?void 0:n.olliNode.id.startsWith(e.id))&&r.setAttribute("selected","selected"),r}));return l.replaceChildren(...c),l.onchange=()=>{n=l.value,e.setAttribute("data-state",n);const i=r(t.olliNodeLookup[n]);i?s.replaceChildren(i):s.replaceChildren()},l.onchange(null),a.replaceChildren(l,s),a}(t.rootTreeItem.olliNode);return e.replaceChildren(r),e}(t);QW(XW(t,"Targeted Navigation Menu","Jump to a location in this chart.",e,{onOk:()=>{const n=e.getAttribute("data-state"),r=t.treeItems.find((t=>t.olliNode.id===n));r&&t.setFocusToItem(r)}}),t.renderContainer)}(this.tree);break;default:return}t.stopPropagation(),t.preventDefault()}handleClick(t){this.isExpandable?(this.isExpanded()?this.tree.collapseTreeItem(this):this.tree.expandTreeItem(this),t.stopPropagation()):(this.tree.setFocusToItem(this),t.stopPropagation())}handleFocus(){let t=this.domNode;this.isExpandable&&(t=t.firstElementChild),t.classList.add("focus")}handleBlur(){let t=this.domNode;this.isExpandable&&(t=t.firstElementChild),t.classList.remove("focus")}handleMouseOver(t){t.currentTarget.classList.add("hover")}handleMouseOut(t){t.currentTarget.classList.remove("hover")}}var KW=n(370),t$={};t$.styleTagTransform=IW(),t$.setAttributes=LW(),t$.insert=PW().bind(null,"head"),t$.domAPI=zW(),t$.insertStyleElement=UW(),NW()(KW.Z,t$),KW.Z&&KW.Z.locals&&KW.Z.locals;class e${constructor(t,e,n){this.olliSpec=t,this.renderContainer=e,this.callbacks=n,this.treeItems=[]}init(){var t;const e=null===(t=this.lastFocusedTreeItem)||void 0===t?void 0:t.olliNode,n=function(t){const e=(Math.random()+1).toString(36).substring(7);function n(t){return 1!==t.length||["xAxis","yAxis"].includes(t[0].nodeType)?(t.forEach((function t(e){e.level=e.level+1,e.children.forEach(t)})),{id:e,nodeType:"root",fullPredicate:{and:[]},description:new Map,children:t,level:1}):t[0]}function r(t,e,n,i,o,a,s){return n?n.map(((n,l)=>{var u;if("groupby"in n){const c=function(t,e){var n,r,i;if(t===e.facet)return"root";const o=null===(n=e.axes)||void 0===n?void 0:n.find((e=>e.field===t));if(o)switch(o.axisType){case"x":return"xAxis";case"y":return"yAxis"}return(null===(r=e.legends)||void 0===r?void 0:r.find((e=>e.field===t)))?"legend":(null===(i=e.guides)||void 0===i?void 0:i.find((e=>e.field===t)))?"guide":"other"}(n.groupby,t),f=null===(u=t.axes)||void 0===u?void 0:u.find((t=>t.field===n.groupby)),d=function(t,e,n,r){const i=Aq(t,n);if("nominal"===i.type||"ordinal"===i.type||i.timeUnit)return kq(i,e).map((e=>({field:t,equal:sq(e,i)})));{const i=function(t,e,n,r,i){const o=_W(t,e,n,r,void 0);return o.map(((e,n)=>({field:t,range:e,inclusive:n===o.length-1})))}(t,e,n,r);return i}}(n.groupby,i,t.fields,f?f.ticks:void 0);return{id:"".concat(a,"-").concat(l),fullPredicate:o,nodeType:c,specIndex:e,groupby:n.groupby,description:new Map,children:d.map(((u,f)=>{const d={and:[...o.and,u]},h="".concat(a,"-").concat(l,"-").concat(f);return{id:h,nodeType:"root"===c?"view":"filteredData",viewType:"root"===c?"facet":void 0,specIndex:e,predicate:u,fullPredicate:d,description:new Map,children:r(t,e,n.children,i,d,h,s+2),level:s+2}})),level:s+1}}if("predicate"in n){const u=n.predicate,c={and:[...o.and,u]},f="".concat(a,"-").concat(l);return{id:f,nodeType:"filteredData",specIndex:e,fullPredicate:c,predicate:u,description:new Map,children:r(t,e,n.children,i,c,f,s+1),level:s+1}}if("annotations"in n){const u="".concat(a,"-").concat(l);return{id:u,fullPredicate:o,nodeType:"annotations",specIndex:e,description:new Map,children:r(t,e,n.annotations,i,o,u,s+1),level:s+1}}throw new Error("Invalid node type")})):[]}if(YW(t)){const i=n(t.units.map(((n,i)=>{const o=r(n,i,Array.isArray(n.structure)?n.structure:[n.structure],n.selection?wq(n.data,n.selection):n.data,{and:[]},"".concat(e,"-").concat(i),1);return{id:"".concat(e,"-").concat(i),nodeType:"view",viewType:t.operator,specIndex:i,fullPredicate:{and:[]},description:new Map,children:o,level:1}})));return VW(i,t),i}{const i=Array.isArray(t.structure)?t.structure:[t.structure],o=t.selection?wq(t.data,t.selection):t.data,a=n(r(t,void 0,i,o,{and:[]},e,0));return VW(a,t),a}}(this.olliSpec);this.olliNodeLookup=function(t){const e={},n=[t];for(;n.length>0;){const t=n.shift();e[t.id]=t,n.push(...t.children)}return e}(n);const r=function(t){var e;const n=document.createElement("ul"),r="".concat(t.id,"-label");return n.setAttribute("role","tree"),n.setAttribute("aria-labelledby",r),n.appendChild(function t(e,n,r,i){const o=document.createElement("li");o.setAttribute("role","treeitem"),o.setAttribute("aria-level",String(n)),o.setAttribute("aria-setsize",String(i)),o.setAttribute("aria-posinset",String(r)),o.setAttribute("id",e.id);const a=document.createElement("span");if(a.innerText=DW(e),o.appendChild(a),e.children.length){const r=document.createElement("ul");r.setAttribute("role","group"),e.children.forEach(((e,i,o)=>{r.appendChild(t(e,n+1,i+1,o.length))})),o.appendChild(r)}return o}(t,1,1,1)),null===(e=n.querySelector("span"))||void 0===e||e.setAttribute("id",r),n}(n);if(this.rootDomNode=r,this.renderContainer.replaceChildren(r),this.treeItems=[],function t(e,n,r,i){let o=e.firstElementChild,a=i;for(;o;)"li"===o.tagName.toLowerCase()&&(a=new JW(o,n,r[o.id],i),a.init(),i&&i.children.push(a),n.treeItems.push(a)),o.firstElementChild&&t(o,n,r,a),o=o.nextElementSibling}(this.rootDomNode,this,this.olliNodeLookup,void 0),this.rootTreeItem=this.treeItems[0],this.rootTreeItem.domNode.tabIndex=0,e)if("root"===e.nodeType)this.setFocusToItem(this.rootTreeItem);else{const t=this.treeItems.filter((t=>t.olliNode.nodeType===e.nodeType));if("groupby"in e){const n=t.find((t=>t.olliNode.groupby===e.groupby));this.setFocusToItem(n||this.rootTreeItem)}else if("predicate"in e){const n=GW(e,this.olliSpec),r=t.filter((t=>"predicate"in t.olliNode)),i=wq(n.data,{and:[n.selection,e.predicate]}),o=r.find((t=>wq(n.data,{and:[n.selection,t.olliNode.predicate]}).some((t=>i.includes(t)))));this.setFocusToItem(o||this.rootTreeItem)}else this.setFocusToItem(this.rootTreeItem)}}renderTreeDescription(){!function t(e,n){if(e.children.length)for(const r of e.children){const e=r.firstElementChild;n[r.id]&&(e.innerText=DW(n[r.id]),r.children[1]&&t(r.children[1],n))}}(this.rootDomNode,this.olliNodeLookup)}setSelection(t){var e;GW(null===(e=this.lastFocusedTreeItem)||void 0===e?void 0:e.olliNode,this.olliSpec).selection=t,this.init()}setFocusToItem(t){for(var e=0;e<this.treeItems.length;e++){var n=this.treeItems[e];n===t?(this.expandParents(n),this.collapseChildren(n),n.domNode.tabIndex=0,n.domNode.focus(),this.lastFocusedTreeItem=n,this.callbacks.onFocus&&this.callbacks.onFocus(n.domNode,n.olliNode),O({lastVisitedInstance:this})):(this.collapseTreeItem(n),n.domNode.tabIndex=-1)}}setFocusToNextItem(t){if(t.parent){const e=t.parent.children.indexOf(t);e<t.parent.children.length-1&&this.setFocusToItem(t.parent.children[e+1])}}setFocusToPreviousItem(t){if(t.parent){let e=t.parent.children.indexOf(t);e>0&&this.setFocusToItem(t.parent.children[e-1])}}getPathFromView(t){if(t.viewType&&("facet"===t.viewType||"layer"===t.viewType))return{view:t,path:""};const e=t.parent.children.indexOf(t),n=this.getPathFromView(t.parent);return Object.assign(Object.assign({},n),{path:n.path+"/"+e})}getNodeForPathFromView(t,e){const n=e.split("/").filter((t=>t.length)).map((t=>parseInt(t,10)));let r=t;for(let i of n)r.children[i]&&(r=r.children[i]);return r}isLateralPossible(){return this.rootTreeItem.children.map((t=>t.olliNode.viewType)).every((t=>"facet"===t||"layer"===t))}setFocusToLateralItem(t,e){const{view:n,path:r}=this.getPathFromView(t.olliNode),i=n.parent.children.indexOf(n),o="left"===e?i-1:i+1;if(o>=0&&o<n.parent.children.length){const e=n.parent.children[o],i=this.getNodeForPathFromView(e,r),a=t.tree.treeItems.find((t=>t.olliNode===i));this.setFocusToItem(a)}}setFocusToNextLayer(t){t.lastVisitedChild?this.setFocusToItem(t.lastVisitedChild):this.setFocusToItem(t.children[0])}setFocusToParentItem(t){t.parent&&(t.parent.lastVisitedChild=t,this.setFocusToItem(t.parent))}setFocusToFirstInLayer(t){t.parent&&this.setFocusToItem(t.parent.children[0])}setFocusToLastInLayer(t){t.parent&&this.setFocusToItem(t.parent.children[t.parent.children.length-1])}expandTreeItem(t){t.isExpandable&&(t.parent&&t.parent.children.forEach((e=>{e!==t&&e.domNode.classList.remove("expanded")})),t.domNode.classList.add("expanded"))}collapseTreeItem(t){t&&t.isExpanded()&&t.domNode.classList.remove("expanded")}expandParents(t){t.parent&&t.parent.isExpandable&&!t.parent.isExpanded()&&(this.expandParents(t.parent),this.expandTreeItem(t.parent))}collapseChildren(t){var e;null===(e=null==t?void 0:t.children)||void 0===e||e.forEach((t=>{t.isExpandable&&t.isExpanded()&&(this.collapseChildren(t),this.collapseTreeItem(t))})),this.collapseTreeItem(t)}focusOnNodeType(t,e){let n=e;for(;n;){if(n.olliNode.nodeType===t){this.setFocusToItem(n);break}n=n.parent}}}var n$=n(879),r$=n.n(n$);function i$(t,e){const n=t.map((t=>t[e]));var r,i={boolean:function(t){return"true"===t||"false"===t||!0===(e=t)||!1===e||"[object Boolean]"==toString.call(e);var e},integer:function(t){return i.number(t)&&(t=+t)==~~t},number:function(t){return!(isNaN(+t)||(e=t,"[object Date]"===toString.call(e)));var e},date:function(t){return r$()(t).isValid()}},o=["boolean","integer","number","date"];for(let a=0;a<n.length;++a){const t=n[a];for(let e=0;e<o.length;++e)null==(r=t)||r!=r||i[o[e]](t)||(o.splice(e,1),e-=1);if(0===o.length)break}switch(o.length?o[0]:"string"){case"boolean":case"string":return"nominal";case"integer":const t=.05,e=40,r=new Set(n).size;return r<e&&r/n.length<t?"nominal":"quantitative";case"number":return"quantitative";case"date":return"temporal"}}function o$(t){return t.fields=t.fields||Object.keys(t.data[0]).map((t=>({field:t}))),t.fields=t.fields.map((e=>Object.assign(Object.assign({},e),{type:e.type||i$(t.data,e.field)}))),t.structure&&0!==[t.structure].flat().length||(t.structure=function(t){var e,n,r,i,o,a,s;function l(t,e,n){let r=[];return t&&(r=r.concat(t.map((t=>({groupby:t.field,children:[]}))))),e&&(r=r.concat(e.map((t=>({groupby:t.field,children:[]}))))),n&&(r=r.concat(n.map((t=>({groupby:t.field,children:[]}))))),r.filter(((t,e,n)=>!("groupby"in t)||n.findIndex((e=>"groupby"in e&&e.groupby===t.groupby))===e))}if(t.facet)return(null===(e=t.axes)||void 0===e?void 0:e.length)||(null===(n=t.legends)||void 0===n?void 0:n.length)?{groupby:t.facet,children:l(t.axes,t.legends,t.guides)}:{groupby:t.facet,children:t.fields.filter((e=>e.field!==t.facet)).map((t=>({groupby:t.field})))};if("line"!==t.mark||!(null===(r=t.legends)||void 0===r?void 0:r.length)){if("bar"===t.mark){if(null===(i=t.axes)||void 0===i?void 0:i.length){const e=null===(o=t.axes)||void 0===o?void 0:o.find((e=>{const n=Aq(e.field,t.fields);return"quantitative"===n.type&&!n.bin}));return l(t.axes.filter((t=>t!==e)),t.legends)}{const e=t.fields.find((t=>"quantitative"===t.type));return t.fields.filter((t=>t!==e)).map((t=>({groupby:t.field,children:[]})))}}return(null===(a=t.axes)||void 0===a?void 0:a.length)||(null===(s=t.legends)||void 0===s?void 0:s.length)?l(t.axes,t.legends):t.fields.map((t=>({groupby:t.field,children:[]})))}{const e=t.legends.find((t=>"color"===t.channel));if(e)return{groupby:e.field,children:l(t.axes,t.legends.filter((t=>t!==e)),t.guides)}}}(t)),t}function a$(t,e){t=function(t){return YW(t)?Object.assign(Object.assign({},t),{units:t.units.map((t=>o$(t)))}):o$(t)}(t);const n=document.createElement("div");n.classList.add("olli-vis");const r={onFocus:null==e?void 0:e.onFocus,onSelection:null==e?void 0:e.onSelection},i=new e$(t,n,r);return i.init(),z(i),n}})(),_})(),t.exports=e()},550:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Area:()=>af,Arrow:()=>Ef,BarX:()=>Ff,BarY:()=>Tf,Cell:()=>pd,Density:()=>Bd,Dot:()=>If,Frame:()=>Id,Hexgrid:()=>Xd,Image:()=>Jd,Line:()=>eh,Link:()=>_f,Mark:()=>ic,Rect:()=>vh,RuleX:()=>Gf,RuleY:()=>Xf,Text:()=>kh,TickX:()=>nd,TickY:()=>rd,Vector:()=>op,area:()=>sf,areaX:()=>lf,areaY:()=>uf,arrow:()=>Cf,barX:()=>Nf,barY:()=>Of,bin:()=>vc,binX:()=>gc,binY:()=>yc,boxX:()=>ad,boxY:()=>sd,cell:()=>md,cellX:()=>gd,cellY:()=>yd,circle:()=>Zf,cluster:()=>rp,column:()=>ra,delaunayLink:()=>Td,delaunayMesh:()=>Nd,density:()=>Ld,dodgeX:()=>yp,dodgeY:()=>vp,dot:()=>Wf,dotX:()=>$f,dotY:()=>Hf,filter:()=>iu,formatIsoDate:()=>Ca,formatMonth:()=>Ea,formatWeekday:()=>Ma,frame:()=>Wd,group:()=>gu,groupX:()=>pu,groupY:()=>mu,groupZ:()=>hu,hexagon:()=>Yf,hexbin:()=>Zd,hexgrid:()=>Gd,hull:()=>Od,image:()=>Kd,initializer:()=>tu,legend:()=>Ku,line:()=>nh,lineX:()=>rh,lineY:()=>ih,linearRegressionX:()=>hh,linearRegressionY:()=>ph,link:()=>wf,map:()=>Pf,mapX:()=>zf,mapY:()=>Rf,marks:()=>oc,normalize:()=>Ep,normalizeX:()=>kp,normalizeY:()=>Ap,plot:()=>rc,rect:()=>bh,rectX:()=>xh,rectY:()=>_h,reverse:()=>au,ruleX:()=>Qf,ruleY:()=>Jf,scale:()=>Hl,select:()=>Yp,selectFirst:()=>Gp,selectLast:()=>Xp,selectMaxX:()=>Kp,selectMaxY:()=>tm,selectMinX:()=>Qp,selectMinY:()=>Jp,shuffle:()=>lu,sort:()=>uu,stackX:()=>zc,stackX1:()=>Rc,stackX2:()=>Pc,stackY:()=>Bc,stackY1:()=>Lc,stackY2:()=>jc,text:()=>Eh,textX:()=>Mh,textY:()=>Ch,tickX:()=>id,tickY:()=>od,transform:()=>Kl,tree:()=>np,treeLink:()=>Rh,treeNode:()=>zh,valueof:()=>Ao,vector:()=>ap,vectorX:()=>sp,vectorY:()=>lp,voronoi:()=>zd,voronoiMesh:()=>Rd,window:()=>jp,windowX:()=>Bp,windowY:()=>Lp});var r=n(6801);function i(t,e){let n=0;if(void 0===e)for(let r of t)null!=r&&(r=+r)>=r&&++n;else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(i=+i)>=i&&++n}return n}function o(t){return 0|t.length}function a(t){return!(t>0)}function s(t){return"object"!=typeof t||"length"in t?t:Array.from(t)}function l(t,e){var n=0,r=0;return Float64Array.from(t,void 0===e?t=>n+=+t||0:i=>n+=+e(i,r++,t)||0)}var u=n(4304),c=n(2233);function f(t,e){let n,r;if(void 0===e)for(const i of t)null!=i&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}var d=n(6332);function h(t){return t}function p(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return y(t,h,h,n)}function m(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return y(t,Array.from,h,n)}function g(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return y(t,h,e,r)}function y(t,e,n,r){return function t(i,o){if(o>=r.length)return n(i);const a=new d.L,s=r[o++];let l=-1;for(const e of i){const t=s(e,++l,i),n=a.get(t);n?n.push(e):a.set(t,[e])}for(const[e,n]of a)a.set(e,t(n,o));return e(a)}(t,0)}var v=n(4657);function b(t,e,n){return(2!==e.length?(0,v.ZP)(g(t,e,n),((t,e)=>{let[n,i]=t,[o,a]=e;return(0,r.Z)(i,a)||(0,r.Z)(n,o)})):(0,v.ZP)(p(t,n),((t,n)=>{let[i,o]=t,[a,s]=n;return e(o,s)||(0,r.Z)(i,a)}))).map((t=>{let[e]=t;return e}))}var x=Array.prototype,_=x.slice,w=(x.map,n(940));function k(t){return()=>t}var A=n(2497);function E(t,e,n){let r;for(;;){const i=(0,A.G9)(t,e,n);if(i===r||0===i||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}function M(t){return Math.max(1,Math.ceil(Math.log(i(t))/Math.LN2)+1)}var C=n(1787);function S(t,e,n){const r=i(t),o=(0,C.ZP)(t,.75)-(0,C.ZP)(t,.25);return r&&o?Math.ceil((n-e)/(2*o*Math.pow(r,-1/3))):1}function D(t,e,n){const r=i(t),o=(0,c.Z)(t);return r&&o?Math.ceil((n-e)*Math.cbrt(r)/(3.49*o)):1}var F=n(1649);function T(t,e){let n,r=-1,i=-1;if(void 0===e)for(const o of t)++i,null!=o&&(n<o||void 0===n&&o>=o)&&(n=o,r=i);else for(let o of t)null!=(o=e(o,++i,t))&&(n<o||void 0===n&&o>=o)&&(n=o,r=i);return r}var N=n(2403),O=n(3309),z=n(396);function R(t,e){let n,r=-1,i=-1;if(void 0===e)for(const o of t)++i,null!=o&&(n>o||void 0===n&&o>=o)&&(n=o,r=i);else for(let o of t)null!=(o=e(o,++i,t))&&(n>o||void 0===n&&o>=o)&&(n=o,r=i);return r}function P(t,e){const n=new d.L;if(void 0===e)for(let o of t)null!=o&&o>=o&&n.set(o,(n.get(o)||0)+1);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&i>=i&&n.set(i,(n.get(i)||0)+1)}let r,i=0;for(const[o,a]of n)a>i&&(i=a,r=o);return r}function B(t,e){return[t,e]}var L=n(6273);function j(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Z;if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");let n=Array.from(t);const i=new Float64Array(n.length);2!==e.length&&(n=n.map(e),e=r.Z);const o=(t,r)=>e(n[t],n[r]);let a,s;return(t=Uint32Array.from(n,((t,e)=>e))).sort(e===r.Z?(t,e)=>(0,v.Wv)(n[t],n[e]):(0,v.di)(o)),t.forEach(((t,e)=>{const n=o(t,void 0===a?t:a);n>=0?((void 0===a||n>0)&&(a=t,s=e),i[t]=s):i[t]=NaN})),i}function U(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Z,i=!1;if(1===n.length){let o;for(const a of t){const t=n(a);(i?(0,r.Z)(t,o)>0:0===(0,r.Z)(t,t))&&(e=a,o=t,i=!0)}}else for(const r of t)(i?n(r,e)>0:0===n(r,r))&&(e=r,i=!0);return e}var q=n(9199),I=n(6620);function W(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()}function $(t){t=new d.H(t);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)for(const e of i)t.delete(e);return t}function H(t){return t}var Z=1,Y=2,V=3,G=4,X=1e-6;function Q(t){return"translate("+t+",0)"}function J(t){return"translate(0,"+t+")"}function K(t){return e=>+t(e)}function tt(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function et(){return!this.__axis}function nt(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,u=t===Z||t===G?-1:1,c=t===G||t===Y?"x":"y",f=t===Z||t===V?Q:J;function d(d){var h=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,p=null==i?e.tickFormat?e.tickFormat.apply(e,n):H:i,m=Math.max(o,0)+s,g=e.range(),y=+g[0]+l,v=+g[g.length-1]+l,b=(e.bandwidth?tt:K)(e.copy(),l),x=d.selection?d.selection():d,_=x.selectAll(".domain").data([null]),w=x.selectAll(".tick").data(h,e).order(),k=w.exit(),A=w.enter().append("g").attr("class","tick"),E=w.select("line"),M=w.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(A),E=E.merge(A.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),M=M.merge(A.append("text").attr("fill","currentColor").attr(c,u*m).attr("dy",t===Z?"0em":t===V?"0.71em":"0.32em")),d!==x&&(_=_.transition(d),w=w.transition(d),E=E.transition(d),M=M.transition(d),k=k.transition(d).attr("opacity",X).attr("transform",(function(t){return isFinite(t=b(t))?f(t+l):this.getAttribute("transform")})),A.attr("opacity",X).attr("transform",(function(t){var e=this.parentNode.__axis;return f((e&&isFinite(e=e(t))?e:b(t))+l)}))),k.remove(),_.attr("d",t===G||t===Y?a?"M"+u*a+","+y+"H"+l+"V"+v+"H"+u*a:"M"+l+","+y+"V"+v:a?"M"+y+","+u*a+"V"+l+"H"+v+"V"+u*a:"M"+y+","+l+"H"+v),w.attr("opacity",1).attr("transform",(function(t){return f(b(t)+l)})),E.attr(c+"2",u*o),M.attr(c,u*m).text(p),x.filter(et).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Y?"start":t===G?"end":"middle"),x.each((function(){this.__axis=b}))}return d.scale=function(t){return arguments.length?(e=t,d):e},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),d):n.slice()},d.tickValues=function(t){return arguments.length?(r=null==t?null:Array.from(t),d):r&&r.slice()},d.tickFormat=function(t){return arguments.length?(i=t,d):i},d.tickSize=function(t){return arguments.length?(o=a=+t,d):o},d.tickSizeInner=function(t){return arguments.length?(o=+t,d):o},d.tickSizeOuter=function(t){return arguments.length?(a=+t,d):a},d.tickPadding=function(t){return arguments.length?(s=+t,d):s},d.offset=function(t){return arguments.length?(l=+t,d):l},d}function rt(t){return nt(Z,t)}function it(t){return nt(Y,t)}function ot(t){return nt(V,t)}function at(t){return nt(G,t)}function st(){}function lt(t){return null==t?st:function(){return this.querySelector(t)}}function ut(){return[]}function ct(t){return null==t?ut:function(){return this.querySelectorAll(t)}}function ft(t){return function(){return this.matches(t)}}function dt(t){return function(e){return e.matches(t)}}var ht=Array.prototype.find;function pt(){return this.firstElementChild}var mt=Array.prototype.filter;function gt(){return Array.from(this.children)}function yt(t){return new Array(t.length)}function vt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function bt(t,e,n,r,i,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new vt(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function xt(t,e,n,r,i,o,a){var s,l,u,c=new Map,f=e.length,d=o.length,h=new Array(f);for(s=0;s<f;++s)(l=e[s])&&(h[s]=u=a.call(l,l.__data__,s,e)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<d;++s)u=a.call(t,o[s],s,o)+"",(l=c.get(u))?(r[s]=l,l.__data__=o[s],c.delete(u)):n[s]=new vt(t,o[s]);for(s=0;s<f;++s)(l=e[s])&&c.get(h[s])===l&&(i[s]=l)}function _t(t){return t.__data__}function wt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function kt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}vt.prototype={constructor:vt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var At="http://www.w3.org/1999/xhtml";const Et={svg:"http://www.w3.org/2000/svg",xhtml:At,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mt(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Et.hasOwnProperty(e)?{space:Et[e],local:t}:t}function Ct(t){return function(){this.removeAttribute(t)}}function St(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Dt(t,e){return function(){this.setAttribute(t,e)}}function Ft(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Tt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Nt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ot(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function zt(t){return function(){this.style.removeProperty(t)}}function Rt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Pt(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Bt(t,e){return t.style.getPropertyValue(e)||Ot(t).getComputedStyle(t,null).getPropertyValue(e)}function Lt(t){return function(){delete this[t]}}function jt(t,e){return function(){this[t]=e}}function Ut(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function qt(t){return t.trim().split(/^|\s+/)}function It(t){return t.classList||new Wt(t)}function Wt(t){this._node=t,this._names=qt(t.getAttribute("class")||"")}function $t(t,e){for(var n=It(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Ht(t,e){for(var n=It(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Zt(t){return function(){$t(this,t)}}function Yt(t){return function(){Ht(this,t)}}function Vt(t,e){return function(){(e.apply(this,arguments)?$t:Ht)(this,t)}}function Gt(){this.textContent=""}function Xt(t){return function(){this.textContent=t}}function Qt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Jt(){this.innerHTML=""}function Kt(t){return function(){this.innerHTML=t}}function te(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ee(){this.nextSibling&&this.parentNode.appendChild(this)}function ne(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function re(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===At&&e.documentElement.namespaceURI===At?e.createElement(t):e.createElementNS(n,t)}}function ie(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function oe(t){var e=Mt(t);return(e.local?ie:re)(e)}function ae(){return null}function se(){var t=this.parentNode;t&&t.removeChild(this)}function le(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ue(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ce(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function fe(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function de(t,e,n){var r=Ot(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function he(t,e){return function(){return de(this,t,e)}}function pe(t,e){return function(){return de(this,t,e.apply(this,arguments))}}Wt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var me=[null];function ge(t,e){this._groups=t,this._parents=e}function ye(){return new ge([[document.documentElement]],me)}ge.prototype=ye.prototype={constructor:ge,select:function(t){"function"!=typeof t&&(t=lt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new ge(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):ct(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(t.call(a,a.__data__,u,s)),i.push(a));return new ge(r,i)},selectChild:function(t){return this.select(null==t?pt:function(t){return function(){return ht.call(this.children,t)}}("function"==typeof t?t:dt(t)))},selectChildren:function(t){return this.selectAll(null==t?gt:function(t){return function(){return mt.call(this.children,t)}}("function"==typeof t?t:dt(t)))},filter:function(t){"function"!=typeof t&&(t=ft(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new ge(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,_t);var n,r=e?xt:bt,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var f=i[c],d=o[c],h=d.length,p=wt(t.call(f,f&&f.__data__,c,i)),m=p.length,g=l[c]=new Array(m),y=s[c]=new Array(m);r(f,d,g,y,u[c]=new Array(h),p,e);for(var v,b,x=0,_=0;x<m;++x)if(v=g[x]){for(x>=_&&(_=x+1);!(b=y[_])&&++_<m;);v._next=b||null}}return(s=new ge(s,i))._enter=l,s._exit=u,s},enter:function(){return new ge(this._enter||this._groups.map(yt),this._parents)},exit:function(){return new ge(this._exit||this._groups.map(yt),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,c=n[l],f=r[l],d=c.length,h=s[l]=new Array(d),p=0;p<d;++p)(u=c[p]||f[p])&&(h[p]=u);for(;l<i;++l)s[l]=n[l];return new ge(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=kt);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(e)}return new ge(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=Mt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?St:Ct:"function"==typeof e?n.local?Nt:Tt:n.local?Ft:Dt)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?zt:"function"==typeof e?Pt:Rt)(t,e,null==n?"":n)):Bt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Lt:"function"==typeof e?Ut:jt)(t,e)):this.node()[t]},classed:function(t,e){var n=qt(t+"");if(arguments.length<2){for(var r=It(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Vt:e?Zt:Yt)(n,e))},text:function(t){return arguments.length?this.each(null==t?Gt:("function"==typeof t?Qt:Xt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Jt:("function"==typeof t?te:Kt)(t)):this.node().innerHTML},raise:function(){return this.each(ee)},lower:function(){return this.each(ne)},append:function(t){var e="function"==typeof t?t:oe(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:oe(t),r=null==e?ae:"function"==typeof e?e:lt(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(se)},clone:function(t){return this.select(t?ue:le)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?fe:ce,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?pe:he)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};const ve=ye;var be=n(3844),xe=n(3452);function _e(t,e,n){var r=new xe.B7;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}var we=(0,be.Z)("start","end","cancel","interrupt"),ke=[],Ae=0,Ee=3;function Me(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var u,c,f,d;if(1!==n.state)return s();for(u in i)if((d=i[u]).name===n.name){if(d.state===Ee)return _e(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(_e((function(){n.state===Ee&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=Ee,r=new Array(f=n.tween.length),u=0,c=-1;u<f;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=(0,xe.HT)((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:we,tween:ke,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Ae})}function Ce(t,e){var n=De(t,e);if(n.state>Ae)throw new Error("too late; already scheduled");return n}function Se(t,e){var n=De(t,e);if(n.state>Ee)throw new Error("too late; already running");return n}function De(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var Fe=n(7275);function Te(t,e){var n,r;return function(){var i=Se(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function Ne(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Se(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function Oe(t,e,n){var r=t._id;return t.each((function(){var t=Se(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return De(t,r).value[e]}}var ze=n(5141),Re=n(5549),Pe=n(1775),Be=n(7087);function Le(t,e){var n;return("number"==typeof e?Re.Z:e instanceof ze.ZP?Pe.ZP:(n=(0,ze.ZP)(e))?(e=n,Pe.ZP):Be.Z)(t,e)}function je(t){return function(){this.removeAttribute(t)}}function Ue(t){return function(){this.removeAttributeNS(t.space,t.local)}}function qe(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function Ie(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function We(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function $e(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function He(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function Ze(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function Ye(t,e){return function(){Ce(this,t).delay=+e.apply(this,arguments)}}function Ve(t,e){return e=+e,function(){Ce(this,t).delay=e}}function Ge(t,e){return function(){Se(this,t).duration=+e.apply(this,arguments)}}function Xe(t,e){return e=+e,function(){Se(this,t).duration=e}}var Qe=ve.prototype.constructor;function Je(t){return function(){this.style.removeProperty(t)}}var Ke=0;function tn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function en(){return++Ke}var nn=ve.prototype;tn.prototype=function(t){return ve().transition(t)}.prototype={constructor:tn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=lt(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=r[a],c=u.length,f=o[a]=new Array(c),d=0;d<c;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),f[d]=l,Me(f[d],e,n,d,f,De(s,n)));return new tn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ct(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,f=0;f<c;++f)if(l=u[f]){for(var d,h=t.call(l,l.__data__,f,u),p=De(l,n),m=0,g=h.length;m<g;++m)(d=h[m])&&Me(d,e,n,m,h,p);o.push(h),a.push(l)}return new tn(o,a,e,n)},selectChild:nn.selectChild,selectChildren:nn.selectChildren,filter:function(t){"function"!=typeof t&&(t=ft(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new tn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=e[s],c=n[s],f=u.length,d=a[s]=new Array(f),h=0;h<f;++h)(l=u[h]||c[h])&&(d[h]=l);for(;s<r;++s)a[s]=e[s];return new tn(a,this._parents,this._name,this._id)},selection:function(){return new Qe(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=en(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=De(a,e);Me(a,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new tn(r,this._parents,t,n)},call:nn.call,nodes:nn.nodes,node:nn.node,size:nn.size,empty:nn.empty,each:nn.each,on:function(t,e){var n=this._id;return arguments.length<2?De(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Ce:Se;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}(n,t,e))},attr:function(t,e){var n=Mt(t),r="transform"===n?Fe.w:Le;return this.attrTween(t,"function"==typeof e?(n.local?$e:We)(n,r,Oe(this,"attr."+t,e)):null==e?(n.local?Ue:je)(n):(n.local?Ie:qe)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Mt(t);return this.tween(n,(r.local?He:Ze)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Fe.Y:Le;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=Bt(this,t),a=(this.style.removeProperty(t),Bt(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,Je(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=Bt(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=Bt(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,Oe(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=Se(this,t),u=l.on,c=null==l.value[a]?o||(o=Je(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=Bt(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Oe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=De(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?Te:Ne)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ye:Ve)(e,t)):De(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ge:Xe)(e,t)):De(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Se(this,t).ease=e}}(e,t)):De(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Se(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--i&&o()}};n.each((function(){var n=Se(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:nn[Symbol.iterator]};var rn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function on(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error("transition ".concat(e," not found"));return n}ve.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},ve.prototype.transition=function(t){var e,n;t instanceof tn?(e=t._id,t=t._name):(e=en(),(n=rn).time=(0,xe.zO)(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&Me(a,t,e,u,s,n||on(a,e));return new tn(r,this._parents,t,e)};const{abs:an,max:sn,min:ln}=Math;function un(t){return{type:t}}["w","e"].map(un),["n","s"].map(un),["n","w","e","s","nw","ne","sw","se"].map(un);const cn=fn(pn);function fn(t){return function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:i,width:o,height:a}=e;if(!((o=Math.floor(o))>=0))throw new RangeError("invalid width");if(!((a=Math.floor(void 0!==a?a:i.length/o))>=0))throw new RangeError("invalid height");if(!o||!a||!n&&!r)return e;const s=n&&t(n),l=r&&t(r),u=i.slice();return s&&l?(dn(s,u,i,o,a),dn(s,i,u,o,a),dn(s,u,i,o,a),hn(l,i,u,o,a),hn(l,u,i,o,a),hn(l,i,u,o,a)):s?(dn(s,i,u,o,a),dn(s,u,i,o,a),dn(s,i,u,o,a)):l&&(hn(l,i,u,o,a),hn(l,u,i,o,a),hn(l,i,u,o,a)),e}}function dn(t,e,n,r,i){for(let o=0,a=r*i;o<a;)t(e,n,o,o+=r,1)}function hn(t,e,n,r,i){for(let o=0,a=r*i;o<r;++o)t(e,n,o,o+a,r)}function pn(t){const e=Math.floor(t);if(e===t)return function(t){const e=2*t+1;return(n,r,i,o,a)=>{if(!((o-=a)>=i))return;let s=t*r[i];const l=a*t;for(let t=i,e=i+l;t<e;t+=a)s+=r[Math.min(o,t)];for(let t=i,u=o;t<=u;t+=a)s+=r[Math.min(o,t+l)],n[t]=s/e,s-=r[Math.max(i,t-l)]}}(t);const n=t-e,r=2*t+1;return(t,i,o,a,s)=>{if(!((a-=s)>=o))return;let l=e*i[o];const u=s*e,c=u+s;for(let e=o,n=o+u;e<n;e+=s)l+=i[Math.min(a,e)];for(let e=o,f=a;e<=f;e+=s)l+=i[Math.min(a,e+u)],t[e]=(l+n*(i[Math.max(o,e-c)]+i[Math.min(a,e+c)]))/r,l-=i[Math.max(o,e-u)]}}fn((function(t){const e=pn(t);return(t,n,r,i,o)=>{e(t,n,0+(r<<=2),0+(i<<=2),o<<=2),e(t,n,r+1,i+1,o),e(t,n,r+2,i+2,o),e(t,n,r+3,i+3,o)}}));var mn=Array.prototype.slice;const gn=t=>()=>t;function yn(t,e){return t-e}function vn(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=bn(t,e[r]))return n;return 0}function bn(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var l=t[o],u=l[0],c=l[1],f=t[s],d=f[0],h=f[1];if(xn(l,f,e))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function xn(t,e,n){var r,i,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],a=e[r],i<=o&&o<=a||a<=o&&o<=i)}function _n(){}var wn=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function kn(){var t=1,e=1,n=M,r=s;function i(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(yn);else{const n=f(t,An);for(e=(0,A.ZP)(...E(n[0],n[1],e),e);e[e.length-1]>=n[1];)e.pop();for(;e[1]<n[0];)e.shift()}return e.map((e=>o(t,e)))}function o(n,i){const o=null==i?NaN:+i;if(isNaN(o))throw new Error("invalid value: ".concat(i));var s=[],l=[];return function(n,r,i){var o,s,l,u,c,f,d=new Array,h=new Array;for(o=s=-1,u=En(n[0],r),wn[u<<1].forEach(p);++o<t-1;)l=u,u=En(n[o+1],r),wn[l|u<<1].forEach(p);for(wn[u<<0].forEach(p);++s<e-1;){for(o=-1,u=En(n[s*t+t],r),c=En(n[s*t],r),wn[u<<1|c<<2].forEach(p);++o<t-1;)l=u,u=En(n[s*t+t+o+1],r),f=c,c=En(n[s*t+o+1],r),wn[l|u<<1|c<<2|f<<3].forEach(p);wn[u|c<<3].forEach(p)}for(o=-1,c=n[s*t]>=r,wn[c<<2].forEach(p);++o<t-1;)f=c,c=En(n[s*t+o+1],r),wn[c<<2|f<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+o,t[0][1]+s],l=[t[1][0]+o,t[1][1]+s],u=a(r),c=a(l);(e=h[u])?(n=d[c])?(delete h[e.end],delete d[n.start],e===n?(e.ring.push(l),i(e.ring)):d[e.start]=h[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[e.end],e.ring.push(l),h[e.end=c]=e):(e=d[c])?(n=h[u])?(delete d[e.start],delete h[n.end],e===n?(e.ring.push(l),i(e.ring)):d[n.start]=h[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=u]=e):d[u]=h[c]={start:u,end:c,ring:[r,l]}}wn[c<<3].forEach(p)}(n,o,(function(t){r(t,n,o),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?s.push([t]):l.push(t)})),l.forEach((function(t){for(var e,n=0,r=s.length;n<r;++n)if(-1!==vn((e=s[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:s}}function a(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,r,i){n.forEach((function(n){var o=n[0],a=n[1],s=0|o,l=0|a,u=Mn(r[l*t+s]);o>0&&o<t&&s===o&&(n[0]=Cn(o,Mn(r[l*t+s-1]),u,i)),a>0&&a<e&&l===a&&(n[1]=Cn(a,Mn(r[(l-1)*t+s]),u,i))}))}return i.contour=o,i.size=function(n){if(!arguments.length)return[t,e];var r=Math.floor(n[0]),o=Math.floor(n[1]);if(!(r>=0&&o>=0))throw new Error("invalid size");return t=r,e=o,i},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?gn(mn.call(t)):gn(t),i):n},i.smooth=function(t){return arguments.length?(r=t?s:_n,i):r===s},i}function An(t){return isFinite(t)?t:NaN}function En(t,e){return null!=t&&+t>=e}function Mn(t){return null==t||isNaN(t=+t)?-1/0:t}function Cn(t,e,n,r){const i=r-e,o=n-e,a=isFinite(i)||isFinite(o)?i/o:Math.sign(i)/Math.sign(o);return isNaN(a)?t:t+a-.5}function Sn(t){return t[0]}function Dn(t){return t[1]}function Fn(){return 1}var Tn=n(9218),Nn=n(2157),On=n(6049),zn=n(9247),Rn=n(8330),Pn=n(2324),Bn=n(1440),Ln=n(9205);const jn=1664525,Un=1013904223,qn=1/4294967296;function In(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random(),e=0|(0<=t&&t<1?t/qn:Math.abs(t));return()=>(e=jn*e+Un|0,qn*(e>>>0))}var Wn=n(8753),$n=n(8928);function Hn(){var t,e,n=(0,$n.Z)().unknown(void 0),r=n.domain,i=n.range,o=0,a=1,s=!1,l=0,u=0,c=.5;function f(){var n=r().length,f=a<o,d=f?a:o,h=f?o:a;t=(h-d)/Math.max(1,n-l+2*u),s&&(t=Math.floor(t)),d+=(h-d-t*(n-l))*c,e=t*(1-l),s&&(d=Math.round(d),e=Math.round(e));var p=(0,L.Z)(n).map((function(e){return d+t*e}));return i(f?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),f()):r()},n.range=function(t){return arguments.length?([o,a]=t,o=+o,a=+a,f()):[o,a]},n.rangeRound=function(t){return[o,a]=t,o=+o,a=+a,s=!0,f()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,f()):s},n.padding=function(t){return arguments.length?(l=Math.min(1,u=+t),f()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),f()):l},n.paddingOuter=function(t){return arguments.length?(u=+t,f()):u},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),f()):c},n.copy=function(){return Hn(r(),[o,a]).round(s).paddingInner(l).paddingOuter(u).align(c)},Wn.o.apply(f(),arguments)}function Zn(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Zn(e())},t}function Yn(){return Zn(Hn.apply(null,arguments).paddingInner(1))}var Vn=n(2948),Gn=n(8622),Xn=n(4201),Qn=n(3486),Jn=n(9069),Kn=n(8757),tr=n(220),er=n(2684),nr=n(1802),rr=n(6194);function ir(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}const or=ir("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),ar=ir("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),sr=ir("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),lr=ir("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),ur=ir("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),cr=ir("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),fr=ir("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),dr=ir("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),hr=ir("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),pr=ir("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),mr=t=>(0,Pe.hD)(t[t.length-1]);var gr=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(ir);const yr=mr(gr);var vr=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(ir);const br=mr(vr);var xr=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(ir);const _r=mr(xr);var wr=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(ir);const kr=mr(wr);var Ar=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(ir);const Er=mr(Ar);var Mr=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(ir);const Cr=mr(Mr);var Sr=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(ir);const Dr=mr(Sr);var Fr=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(ir);const Tr=mr(Fr);var Nr=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(ir);const Or=mr(Nr);var zr=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(ir);const Rr=mr(zr);var Pr=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(ir);const Br=mr(Pr);var Lr=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(ir);const jr=mr(Lr);var Ur=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(ir);const qr=mr(Ur);var Ir=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(ir);const Wr=mr(Ir);var $r=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(ir);const Hr=mr($r);var Zr=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(ir);const Yr=mr(Zr);var Vr=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(ir);const Gr=mr(Vr);var Xr=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(ir);const Qr=mr(Xr);var Jr=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(ir);const Kr=mr(Jr);var ti=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(ir);const ei=mr(ti);var ni=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(ir);const ri=mr(ni);var ii=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(ir);const oi=mr(ii);var ai=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(ir);const si=mr(ai);var li=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(ir);const ui=mr(li);var ci=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(ir);const fi=mr(ci);var di=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(ir);const hi=mr(di);var pi=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(ir);const mi=mr(pi);function gi(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"}var yi=n(1461),vi=n(7090);const bi=(0,vi.B)((0,yi.Z)(300,.5,0),(0,yi.Z)(-240,.5,1));var xi=(0,vi.B)((0,yi.Z)(-100,.75,.35),(0,yi.Z)(80,1.5,.8)),_i=(0,vi.B)((0,yi.Z)(260,.75,.35),(0,yi.Z)(80,1.5,.8)),wi=(0,yi.Z)();function ki(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return wi.h=360*t-100,wi.s=1.5-1.5*e,wi.l=.8-.9*e,wi+""}var Ai=(0,ze.B8)(),Ei=Math.PI/3,Mi=2*Math.PI/3;function Ci(t){var e;return t=(.5-t)*Math.PI,Ai.r=255*(e=Math.sin(t))*e,Ai.g=255*(e=Math.sin(t+Ei))*e,Ai.b=255*(e=Math.sin(t+Mi))*e,Ai+""}function Si(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"}function Di(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const Fi=Di(ir("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var Ti=Di(ir("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Ni=Di(ir("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Oi=Di(ir("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function zi(t){return"string"==typeof t?new ge([[document.querySelector(t)]],[document.documentElement]):new ge([[t]],me)}var Ri=n(3073),Pi=n(6985),Bi=n(9148),Li=n(6609),ji=n(281),Ui=n(6709),qi=n(5019),Ii=n(6358),Wi=n(9451),$i=n(7609),Hi=n(7189),Zi=n(5174),Yi=n(4610),Vi=n(7810),Gi=n(9012),Xi=n(8031),Qi=n(7694),Ji=n(7238),Ki=n(3698);class to{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}var eo=n(6545),no=n(7388),ro=n(2411),io=n(7256),oo=n(6491),ao=n(6052),so=n(6360),lo=n(2977),uo=n(8282),co=n(6481),fo=n(9389),ho=n(3729),po=n(2736),mo=n(867);function go(t,e,n){this.k=t,this.x=e,this.y=n}function yo(){let{document:t=window.document}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{document:t}}function vo(t,e){let{document:n}=e;return zi(oe(t).call(n.documentElement))}function bo(t,e){return"".concat(t).padStart(e,"0")}go.prototype={constructor:go,scale:function(t){return 1===t?this:new go(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new go(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new go(1,0,0),go.prototype;const xo=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function _o(t,e){return xo.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const wo=Object.getPrototypeOf(Uint8Array),ko=Object.prototype.toString;function Ao(t,e,n){const r=typeof e;return"string"===r?Io(t,Eo(e),n):"function"===r?Io(t,e,n):"number"===r||e instanceof Date||"boolean"===r?Io(t,Ro(e),n):e&&"function"==typeof e.transform?qo(e.transform(t),n):qo(e,n)}const Eo=t=>e=>e[t],Mo=(t,e)=>e,Co={transform:t=>t},So=()=>1,Do=()=>!0,Fo=t=>null==t?t:"".concat(t),To=t=>null==t?t:+t,No=t=>null==t?t:!!t,Oo=t=>t?t[0]:void 0,zo=t=>t?t[1]:void 0,Ro=t=>()=>t;function Po(t){const e=+"".concat(t).slice(1)/100;return(t,n)=>(0,C.ZP)(t,e,n)}function Bo(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:ga(t)?[void 0,t]:[t,void 0]}function Lo(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function jo(t,e,n){if(null!=t)return Uo(t,e,n)}function Uo(t,e,n){const r="".concat(t).toLowerCase();if(!n.includes(r))throw new Error("invalid ".concat(e,": ").concat(t));return r}function qo(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof wo?t:Array.from(t):t instanceof e?t:e.from(t)}function Io(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Array;return t instanceof n?t.map(e):n.from(t,e)}function Wo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Array;return t instanceof e?t.slice():e.from(t)}function $o(t){return t instanceof wo}function Ho(t){return(null===t||void 0===t?void 0:t.toString)===ko}function Zo(t){return Ho(t)&&(void 0!==t.type||void 0!==t.domain)}function Yo(t){return Ho(t)&&"function"!=typeof t.transform}function Vo(t){return Yo(t)&&void 0===t.value&&void 0===t.channel}function Go(t,e,n){return void 0===e&&void 0===n?(e=0,n=void 0===t?arguments.length>3&&void 0!==arguments[3]?arguments[3]:Co:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function Xo(t,e){return void 0===t&&void 0===e?[Oo,zo]:[t,e]}function Qo(){let{z:t,fill:e,stroke:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t&&([t]=Bo(e)),void 0===t&&([t]=Bo(n)),t}function Jo(t){const e=t.length,n=new Uint32Array(e);for(let r=0;r<e;++r)n[r]=r;return n}function Ko(t,e){return Jo(t).filter((n=>e(t[n],n,t)))}function ta(t,e){return Io(e,(e=>t[e]))}function ea(t){return null!==t&&"object"==typeof t?t.valueOf():t}function na(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function ra(t){let e;return[{transform:()=>e,label:oa(t)},t=>e=t]}function ia(t){return null==t?[t]:ra(t)}function oa(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function aa(t,e){return{transform(n){const r=t.transform(n),i=e.transform(n);return fa(r)||fa(i)?Io(r,((t,e)=>new Date((+r[e]+ +i[e])/2))):Io(r,((t,e)=>(+r[e]+ +i[e])/2),Float64Array)},label:t.label}}function sa(t){return void 0===t||Yo(t)?t:{value:t}}function la(t){return t&&"function"==typeof t[Symbol.iterator]}function ua(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function ca(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function fa(t){for(const e of t)if(null!=e)return e instanceof Date}function da(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&_o(e)}function ha(t){for(const e of t)if(null!=e&&""!==e)return"string"==typeof e&&!isNaN(e)}function pa(t,e){for(const n of t)if(null!=n)return e(n)}function ma(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function ga(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==(0,ze.ZP)(t))}function ya(t){return null==t||va(t)}function va(t){return/^\s*none\s*$/i.test(t)}function ba(){return Uo(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"middle","frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function xa(t){if(null==t)return;const e=t[0],n=t[t.length-1];return(0,u.Z)(e,n)}function _a(t){let e,n;return function(){for(var r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return((null===(r=n)||void 0===r?void 0:r.length)!==o.length||n.some(((t,e)=>t!==o[e])))&&(n=o,e=t(...o)),e}}const wa=_a((t=>new Intl.NumberFormat(t))),ka=_a(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",month:e}))),Aa=_a(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",weekday:e})));function Ea(){const t=ka(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short");return e=>null==e||isNaN(e=+new Date(Date.UTC(2e3,+e)))?void 0:t.format(e)}function Ma(){const t=Aa(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short");return e=>null==e||isNaN(e=+new Date(Date.UTC(2001,0,+e)))?void 0:t.format(e)}function Ca(t){return function(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return e;const n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return"".concat((a=t.getUTCFullYear(),a<0?"-".concat(bo(-a,6)):a>9999?"+".concat(bo(a,6)):bo(a,4)),"-").concat(bo(t.getUTCMonth()+1,2),"-").concat(bo(t.getUTCDate(),2)).concat(n||r||i||o?"T".concat(bo(n,2),":").concat(bo(r,2)).concat(i||o?":".concat(bo(i,2)).concat(o?".".concat(bo(o,3)):""):"","Z"):"");var a}(t,"Invalid Date")}const Sa=function(){const t=function(){const t=wa(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US");return e=>null==e||isNaN(e)?void 0:t.format(e)}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US");return e=>(e instanceof Date?Ca:"number"==typeof e?t:Fo)(e)}(),Da=Math.PI/180;function Fa(t){return null!=t&&!Number.isNaN(t)}function Ta(t,e){return+Fa(e)-+Fa(t)||(0,r.Z)(t,e)}function Na(t,e){return+Fa(e)-+Fa(t)||(0,u.Z)(t,e)}function Oa(t){return null!=t&&""!="".concat(t)}function za(t){return isFinite(t)?t:NaN}function Ra(t){return t>0&&isFinite(t)?t:NaN}function Pa(t){return t<0&&isFinite(t)?t:NaN}let Ba=0;function La(t){console.warn(t),++Ba}const ja="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5;let Ua=0;function qa(t,e,n){let{title:r,href:i,ariaLabel:o,ariaDescription:a,ariaHidden:s,target:l,fill:u,fillOpacity:c,stroke:f,strokeWidth:d,strokeOpacity:h,strokeLinejoin:p,strokeLinecap:m,strokeMiterlimit:g,strokeDasharray:y,strokeDashoffset:v,opacity:b,mixBlendMode:x,paintOrder:_,pointerEvents:w,shapeRendering:k}=e,{ariaLabel:A,fill:E="currentColor",fillOpacity:M,stroke:C="none",strokeOpacity:S,strokeWidth:D,strokeLinecap:F,strokeLinejoin:T,strokeMiterlimit:N,paintOrder:O}=n;null===E&&(u=null,c=null),null===C&&(f=null,h=null),ya(E)?ya(C)||ya(u)||(C="none"):ya(C)&&!ya(f)&&(E="none");const[z,R]=Bo(u,E),[P,B]=Lo(c,M),[L,j]=Bo(f,C),[U,q]=Lo(h,S),[I,W]=Lo(b);va(j)||(void 0===d&&(d=D),void 0===m&&(m=F),void 0===p&&(p=T),void 0!==g||/^\s*round\s*$/i.test(p)||(g=N),va(R)||void 0!==_||(_=O));const[$,H]=Lo(d);return null!==E&&(t.fill=Ka(R,"currentColor"),t.fillOpacity=ts(B,1)),null!==C&&(t.stroke=Ka(j,"none"),t.strokeWidth=ts(H,1),t.strokeOpacity=ts(q,1),t.strokeLinejoin=Ka(p,"miter"),t.strokeLinecap=Ka(m,"butt"),t.strokeMiterlimit=ts(g,4),t.strokeDasharray=Ka(y,"none"),t.strokeDashoffset=Ka(v,"0")),t.target=Fo(l),t.ariaLabel=Fo(A),t.ariaDescription=Fo(a),t.ariaHidden=Fo(s),t.opacity=ts(W,1),t.mixBlendMode=Ka(x,"normal"),t.paintOrder=Ka(_,"normal"),t.pointerEvents=Ka(w,"auto"),t.shapeRendering=Ka(k,"auto"),[{name:"title",value:r,optional:!0},{name:"href",value:i,optional:!0},{name:"ariaLabel",value:o,optional:!0},{name:"fill",value:z,scale:"color",optional:!0},{name:"fillOpacity",value:P,scale:"opacity",optional:!0},{name:"stroke",value:L,scale:"color",optional:!0},{name:"strokeOpacity",value:U,scale:"opacity",optional:!0},{name:"strokeWidth",value:$,optional:!0},{name:"opacity",value:I,scale:"opacity",optional:!0}]}function Ia(t,e){e&&t.text((t=>Sa(e[t])))}function Wa(t,e){e&&t.text((t=>{let[n]=t;return Sa(e[n])}))}function $a(t,e,n){let{target:r}=e,{ariaLabel:i,title:o,fill:a,fillOpacity:s,stroke:l,strokeOpacity:u,strokeWidth:c,opacity:f,href:d}=n;i&&Qa(t,"aria-label",(t=>i[t])),a&&Qa(t,"fill",(t=>a[t])),s&&Qa(t,"fill-opacity",(t=>s[t])),l&&Qa(t,"stroke",(t=>l[t])),u&&Qa(t,"stroke-opacity",(t=>u[t])),c&&Qa(t,"stroke-width",(t=>c[t])),f&&Qa(t,"opacity",(t=>f[t])),d&&Xa(t,(t=>d[t]),r),function(t,e){e&&t.filter((t=>Oa(e[t]))).append("title").call(Ia,e)}(t,o)}function Ha(t,e,n){let{target:r}=e,{ariaLabel:i,title:o,fill:a,fillOpacity:s,stroke:l,strokeOpacity:u,strokeWidth:c,opacity:f,href:d}=n;i&&Qa(t,"aria-label",(t=>{let[e]=t;return i[e]})),a&&Qa(t,"fill",(t=>{let[e]=t;return a[e]})),s&&Qa(t,"fill-opacity",(t=>{let[e]=t;return s[e]})),l&&Qa(t,"stroke",(t=>{let[e]=t;return l[e]})),u&&Qa(t,"stroke-opacity",(t=>{let[e]=t;return u[e]})),c&&Qa(t,"stroke-width",(t=>{let[e]=t;return c[e]})),f&&Qa(t,"opacity",(t=>{let[e]=t;return f[e]})),d&&Xa(t,(t=>{let[e]=t;return d[e]}),r),function(t,e){e&&t.filter((t=>{let[n]=t;return Oa(e[n])})).append("title").call(Wa,e)}(t,o)}function Za(t,e,n){const r=p(t,(t=>e[t]));return void 0===n&&r.size>t.length>>1&&La("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function Ya(t,e,n,r){let{z:i}=n;return function*(){const{z:n}=r,o=function(t){let{ariaLabel:e,title:n,fill:r,fillOpacity:i,stroke:o,strokeOpacity:a,strokeWidth:s,opacity:l,href:u}=t;return[e,n,r,i,o,a,s,l,u].filter((t=>void 0!==t))}(r),a=[...e,...o];for(const e of n?Za(t,n,i):[t]){let t,n;t:for(const r of e){for(const t of a)if(!Fa(t[r])){n&&n.push(-1);continue t}if(void 0!==t){n.push(r);for(let e=0;e<o.length;++e)if(ea(o[e][r])!==t[e]){yield n,t=o.map((t=>ea(t[r]))),n=[r];continue t}}else n&&(yield n),t=o.map((t=>ea(t[r]))),n=[r]}n&&(yield n)}}()}function Va(t,e,n,r){if(Qa(t,"aria-label",e.ariaLabel),Qa(t,"aria-description",e.ariaDescription),Qa(t,"aria-hidden",e.ariaHidden),Qa(t,"fill",e.fill),Qa(t,"fill-opacity",e.fillOpacity),Qa(t,"stroke",e.stroke),Qa(t,"stroke-width",e.strokeWidth),Qa(t,"stroke-opacity",e.strokeOpacity),Qa(t,"stroke-linejoin",e.strokeLinejoin),Qa(t,"stroke-linecap",e.strokeLinecap),Qa(t,"stroke-miterlimit",e.strokeMiterlimit),Qa(t,"stroke-dasharray",e.strokeDasharray),Qa(t,"stroke-dashoffset",e.strokeDashoffset),Qa(t,"shape-rendering",e.shapeRendering),Qa(t,"paint-order",e.paintOrder),Qa(t,"pointer-events",e.pointerEvents),"frame"===e.clip){const{x:e,y:i}=n,{width:o,height:a,marginLeft:s,marginRight:l,marginTop:u,marginBottom:c}=r,f="plot-clip-"+ ++Ua;t.attr("clip-path","url(#".concat(f,")")).append("clipPath").attr("id",f).append("rect").attr("x",s-(null!==e&&void 0!==e&&e.bandwidth?e.bandwidth()/2:0)).attr("y",u-(null!==i&&void 0!==i&&i.bandwidth?i.bandwidth()/2:0)).attr("width",o-l-s).attr("height",a-u-c)}}function Ga(t,e){!function(t,e,n){null!=n&&t.style("mix-blend-mode",n)}(t,0,e.mixBlendMode),Qa(t,"opacity",e.opacity)}function Xa(t,e,n){t.each((function(t){const r=e(t);if(null!=r){const t=this.ownerDocument.createElementNS(Et.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(Et.xlink,"href",r),null!=n&&t.setAttribute("target",n),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Qa(t,e,n){null!=n&&t.attr(e,n)}function Ja(t,e,n){let{x:r,y:i}=n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ja,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ja;o+=e.dx,a+=e.dy,null!==r&&void 0!==r&&r.bandwidth&&(o+=r.bandwidth()/2),null!==i&&void 0!==i&&i.bandwidth&&(a+=i.bandwidth()/2),(o||a)&&t.attr("transform","translate(".concat(o,",").concat(a,")"))}function Ka(t,e){if((t=Fo(t))!==e)return t}function ts(t,e){if((t=To(t))!==e)return t}const es=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function ns(t){if(void 0===t)return"plot-".concat(Math.random().toString(16).slice(2));if(t="".concat(t),!es.test(t))throw new Error("invalid class name: ".concat(t));return t}function rs(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function is(t,e){let{frameAnchor:n}=t,{width:r,height:i,marginTop:o,marginRight:a,marginBottom:s,marginLeft:l}=e;return[/left$/.test(n)?l:/right$/.test(n)?r-a:(l+r-a)/2,/^top/.test(n)?o:/^bottom/.test(n)?i-s:(o+i-s)/2]}class os{constructor(){let{name:t="x",axis:e,ticks:n,tickSize:r=("fx"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:u,labelOffset:c,line:f,tickRotate:d,ariaLabel:h,ariaDescription:p}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.name=t,this.axis=Uo(e,"axis",["top","bottom"]),this.ticks=ls(n),this.tickSize=To(r),this.tickPadding=To(i),this.tickFormat=us(o),this.fontVariant=Ka(a,"normal"),this.grid=No(s),this.label=Fo(l),this.labelAnchor=jo(u,"labelAnchor",["center","left","right"]),this.labelOffset=To(c),this.line=No(f),this.tickRotate=To(d),this.ariaLabel=Fo(h),this.ariaDescription=Fo(p)}render(t,e,n,r){let{[this.name]:i,fy:o}=e,{width:a,height:s,marginTop:l,marginRight:u,marginBottom:c,marginLeft:f,offsetLeft:d=0,facetMarginTop:h,facetMarginBottom:p,labelMarginLeft:m=0,labelMarginRight:g=0}=n;const{axis:y,fontVariant:v,grid:b,label:x,labelAnchor:_,labelOffset:w,line:k,name:A,tickRotate:E}=this,M="top"===y?-1:1,C=M*("x"===A?0:"top"===y?l-h:c-p)+("top"===y?l:s-c);return vo("svg:g",r).call(ss,this).attr("transform","translate(".concat(d,",").concat(C,")")).call(fs("top"===y?rt:ot,i,this)).call(ds,E).attr("font-size",null).attr("font-family",null).attr("font-variant",v).call(k?()=>{}:t=>t.select(".domain").remove()).call(b?o?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?ta(i,t):i).map((t=>"M0,".concat(e(t)+n,"v").concat(r))).join(""))}(t,o,-C):(S=M*(c+l-s),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("y2",S)):()=>{}).call(x?t=>t.append("text").attr("fill","currentColor").attr("transform","translate(".concat("center"===_?(a+f-u)/2:"right"===_?a+g:-m,",").concat(w*M,")")).attr("dy","top"===y?"1em":"-0.32em").attr("text-anchor","center"===_?"middle":"right"===_?"end":"start").text(x):()=>{}).node();var S}}class as{constructor(){let{name:t="y",axis:e,ticks:n,tickSize:r=("fy"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:u,labelOffset:c,line:f,tickRotate:d,ariaLabel:h,ariaDescription:p}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.name=t,this.axis=Uo(e,"axis",["left","right"]),this.ticks=ls(n),this.tickSize=To(r),this.tickPadding=To(i),this.tickFormat=us(o),this.fontVariant=Ka(a,"normal"),this.grid=No(s),this.label=Fo(l),this.labelAnchor=jo(u,"labelAnchor",["center","top","bottom"]),this.labelOffset=To(c),this.line=No(f),this.tickRotate=To(d),this.ariaLabel=Fo(h),this.ariaDescription=Fo(p)}render(t,e,n,r){let{[this.name]:i,fx:o}=e,{width:a,height:s,marginTop:l,marginRight:u,marginBottom:c,marginLeft:f,offsetTop:d=0,facetMarginLeft:h,facetMarginRight:p}=n;const{axis:m,fontVariant:g,grid:y,label:v,labelAnchor:b,labelOffset:x,line:_,name:w,tickRotate:k}=this,A="left"===m?-1:1,E=A*("y"===w?0:"left"===m?f-h:u-p)+("right"===m?a-u:f);return vo("svg:g",r).call(ss,this).attr("transform","translate(".concat(E,",").concat(d,")")).call(fs("right"===m?it:at,i,this)).call(ds,k).attr("font-size",null).attr("font-family",null).attr("font-variant",g).call(_?()=>{}:t=>t.select(".domain").remove()).call(y?o?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?ta(i,t):i).map((t=>"M".concat(e(t)+n,",0h").concat(r))).join(""))}(t,o,-E):(M=A*(f+u-a),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("x2",M)):()=>{}).call(v?t=>t.append("text").attr("fill","currentColor").attr("font-variant",null==g?null:"normal").attr("transform","translate(".concat(x*A,",").concat("center"===b?(s+l-c)/2:"bottom"===b?s-c:l,")").concat("center"===b?" rotate(-90)":"")).attr("dy","center"===b?"right"===m?"-0.32em":"0.75em":"bottom"===b?"1.4em":"-1em").attr("text-anchor","center"===b?"middle":"right"===m?"end":"start").text(v):()=>{}).node();var M}}function ss(t,e){let{name:n,label:r,ariaLabel:i="".concat(n,"-axis"),ariaDescription:o=r}=e;Qa(t,"aria-label",i),Qa(t,"aria-description",o)}function ls(t){return null===t?[]:t}function us(t){return null===t?()=>null:t}function cs(t,e){return void 0===t?fa(e)?Ca:Fo:"function"==typeof t?t:("string"==typeof t?fa(e)?mo.g0:Nn.WU:Ro)(t)}function fs(t,e,n){let{ticks:r,tickSize:i,tickPadding:o,tickFormat:a}=n;return e.tickFormat||(a=cs(a,e.domain())),t(e).ticks(Array.isArray(r)?null:r,"function"==typeof a?null:a).tickFormat("function"==typeof a?a:null).tickSizeInner(i).tickSizeOuter(0).tickPadding(o).tickValues(Array.isArray(r)?r:null)}function ds(t,e){if(e=+e)for(const n of t.selectAll("text")){const t=+n.getAttribute("x"),r=+n.getAttribute("y");if(Math.abs(r)>Math.abs(t)){const t=Math.sign(r);n.setAttribute("transform","translate(0, ".concat(r+4*t*Math.cos(e*Da),") rotate(").concat(e,")")),n.setAttribute("text-anchor",Math.abs(e)<10?"middle":e<0^t>0?"start":"end")}else{const r=Math.sign(t);n.setAttribute("transform","translate(".concat(t+4*r*Math.abs(Math.sin(e*Da)),", 0) rotate(").concat(e,")")),n.setAttribute("text-anchor",Math.abs(e)>60?"middle":r>0?"start":"end")}n.removeAttribute("x"),n.removeAttribute("y"),n.setAttribute("dy","0.32em")}}const hs=Symbol("position"),ps=Symbol("color"),ms=Symbol("radius"),gs=Symbol("length"),ys=Symbol("opacity"),vs=Symbol("symbol"),bs=new Map([["x",hs],["y",hs],["fx",hs],["fy",hs],["r",ms],["color",ps],["opacity",ys],["symbol",vs],["length",gs]]),xs=new Map([["accent",ar],["category10",or],["dark2",sr],["paired",lr],["pastel1",ur],["pastel2",cr],["set1",fr],["set2",dr],["set3",hr],["tableau10",pr],["brbg",ws(gr,yr)],["prgn",ws(vr,br)],["piyg",ws(xr,_r)],["puor",ws(wr,kr)],["rdbu",ws(Ar,Er)],["rdgy",ws(Mr,Cr)],["rdylbu",ws(Sr,Dr)],["rdylgn",ws(Fr,Tr)],["spectral",ws(Nr,Or)],["burd",ks(Ar,Er)],["buylrd",ks(Sr,Dr)],["blues",_s(ii,oi)],["greens",_s(ai,si)],["greys",_s(li,ui)],["oranges",_s(pi,mi)],["purples",_s(ci,fi)],["reds",_s(di,hi)],["turbo",As(Si)],["viridis",As(Fi)],["magma",As(Ti)],["inferno",As(Ni)],["plasma",As(Oi)],["cividis",As(gi)],["cubehelix",As(bi)],["warm",As(xi)],["cool",As(_i)],["bugn",_s(zr,Rr)],["bupu",_s(Pr,Br)],["gnbu",_s(Lr,jr)],["orrd",_s(Ur,qr)],["pubu",_s($r,Hr)],["pubugn",_s(Ir,Wr)],["purd",_s(Zr,Yr)],["rdpu",_s(Vr,Gr)],["ylgn",_s(Jr,Kr)],["ylgnbu",_s(Xr,Qr)],["ylorbr",_s(ti,ei)],["ylorrd",_s(ni,ri)],["rainbow",Es(ki)],["sinebow",Es(Ci)]]);function _s(t,e){return n=>{let{length:r}=n;return 1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?(0,Bn.quantize)(e,r):t[r]}}function ws(t,e){return n=>{let{length:r}=n;return 2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?(0,Bn.quantize)(e,r):t[r]}}function ks(t,e){return n=>{let{length:r}=n;return 2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?(0,Bn.quantize)((t=>e(1-t)),r):t[r].slice().reverse()}}function As(t){return e=>{let{length:n}=e;return(0,Bn.quantize)(t,Math.max(2,Math.floor(n)))}}function Es(t){return e=>{let{length:n}=e;return(0,Bn.quantize)(t,Math.floor(n)+1).slice(0,-1)}}function Ms(t){const e="".concat(t).toLowerCase();if(!xs.has(e))throw new Error("unknown scheme: ".concat(e));return xs.get(e)}function Cs(t,e){const n=Ms(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const Ss=new Map([["brbg",yr],["prgn",br],["piyg",_r],["puor",kr],["rdbu",Er],["rdgy",Cr],["rdylbu",Dr],["rdylgn",Tr],["spectral",Or],["burd",t=>Er(1-t)],["buylrd",t=>Dr(1-t)],["blues",oi],["greens",si],["greys",ui],["purples",fi],["reds",hi],["oranges",mi],["turbo",Si],["viridis",Fi],["magma",Ti],["inferno",Ni],["plasma",Oi],["cividis",gi],["cubehelix",bi],["warm",xi],["cool",_i],["bugn",Rr],["bupu",Br],["gnbu",jr],["orrd",qr],["pubugn",Wr],["pubu",Hr],["purd",Yr],["rdpu",Gr],["ylgnbu",Qr],["ylgn",Kr],["ylorbr",ei],["ylorrd",ri],["rainbow",ki],["sinebow",Ci]]);function Ds(t){const e="".concat(t).toLowerCase();if(!Ss.has(e))throw new Error("unknown scheme: ".concat(e));return Ss.get(e)}const Fs=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Ts(t){return null!=t&&Fs.has("".concat(t).toLowerCase())}function Ns(){let{inset:t,insetLeft:e,insetRight:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[e,n]=zs(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function Os(){let{inset:t,insetTop:e,insetBottom:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[e,n]=zs(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function zs(t,e,n){return void 0===t&&void 0===e&&void 0===n?ja?[1,0]:[.5,.5]:[e,n]}function Rs(t){if(null!=t){if("number"==typeof t){const e=t;return{floor:t=>e*Math.floor(t/e),offset:t=>t+e,range:(t,n)=>(0,L.Z)(Math.ceil(t/e),n/e).map((t=>e*t))}}if("function"!=typeof t.floor||"function"!=typeof t.offset)throw new Error("invalid interval; missing floor or offset function");return t}}function Ps(t,e){let{interval:n}=e;return(t={...sa(t)}).interval=Rs(void 0===t.interval?n:t.interval),t}function Bs(t,e,n,r){const{[t]:i,["".concat(t,"1")]:o,["".concat(t,"2")]:a}=n,{value:s,interval:l}=Ps(i,n);if(null==s||null==l&&!r)return n;const u=oa(i);if(null==l){let e;const r={transform:t=>e||(e=Ao(t,s)),label:u};return{...n,[t]:void 0,["".concat(t,"1")]:void 0===o?r:o,["".concat(t,"2")]:void 0===a?r:a}}let c,f;function d(t){return void 0!==f&&t===c?f:f=Io(Ao(c=t,s),(t=>l.floor(t)))}return e({...n,[t]:void 0,["".concat(t,"1")]:void 0===o?{transform:d,label:u}:o,["".concat(t,"2")]:void 0===a?{transform:t=>d(t).map((t=>l.offset(t))),label:u}:a})}function Ls(t,e,n){const{[t]:r}=n,{value:i,interval:o}=Ps(r,n);return null==i||null==o?n:e({...n,[t]:{label:oa(r),transform:t=>{const e=Io(Ao(t,i),(t=>o.floor(t))),n=e.map((t=>o.offset(t)));return e.map(fa(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function js(){return Bs("x",Ns,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},!0)}function Us(){return Bs("y",Os,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},!0)}function qs(){return Bs("x",Ns,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function Is(){return Bs("y",Os,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function Ws(){return Ls("x",Ns,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function $s(){return Ls("y",Os,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}const Hs=t=>e=>t(1-e),Zs=[0,1],Ys=new Map([["number",Bn.interpolateNumber],["rgb",Bn.interpolateRgb],["hsl",Bn.interpolateHsl],["hcl",Bn.interpolateHcl],["lab",Bn.interpolateLab]]);function Vs(t){const e="".concat(t).toLowerCase();if(!Ys.has(e))throw new Error("unknown interpolator: ".concat(e));return Ys.get(e)}function Gs(t,e,n,r){let{type:i,nice:o,clamp:a,zero:s,domain:l=Ks(t,n),unknown:u,round:c,scheme:d,interval:h,range:p=(bs.get(t)===ms?el(n,l):bs.get(t)===gs?nl(n,l):bs.get(t)===ys?Zs:void 0),interpolate:m=(bs.get(t)===ps?null==d&&void 0!==p?Bn.interpolateRgb:Ds(void 0!==d?d:"cyclical"===i?"rainbow":"turbo"):c?Bn.interpolateRound:Bn.interpolateNumber),reverse:g}=r;if(h=Rs(h),"cyclical"!==i&&"sequential"!==i||(i="linear"),g=!!g,"function"!=typeof m&&(m=Vs(m)),1===m.length?(g&&(m=Hs(m),g=!1),void 0===p&&2===(p=Float64Array.from(l,((t,e)=>e/(l.length-1)))).length&&(p=Zs),e.interpolate((p===Zs?Ro:ol)(m))):e.interpolate(m),s){const[t,e]=f(l);(t>0||e<0)&&(xa(l=Wo(l))!==Math.sign(t)?l[l.length-1]=0:l[0]=0)}return g&&(l=W(l)),e.domain(l).unknown(u),o&&(e.nice(!0===o?void 0:o),l=e.domain()),void 0!==p&&e.range(p),a&&e.clamp(a),{type:i,domain:l,range:p,scale:e,interpolate:m,interval:h}}function Xs(t,e,n){let{exponent:r=1,...i}=n;return Gs(t,(0,Jn.ZP)().exponent(r),e,{...i,type:"pow"})}function Qs(t,e,n){let{domain:r=[0],unknown:i,scheme:o="rdylbu",interpolate:a,range:s=(void 0!==a?(0,Bn.quantize)(a,r.length+1):bs.get(t)===ps?Cs(o,r.length+1):void 0),reverse:l}=n;const c=xa(qo(r));if(!function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B;const n=[];let r,i=!1;for(const o of t)i&&n.push(e(r,o)),r=o,i=!0;return n}(r).every((t=>{let[e,n]=t;return function(t,e,n){const r=(0,u.Z)(t,e);return 0===r||r===n}(e,n,c)})))throw new Error("the ".concat(t," scale has a non-monotonic domain"));return l&&(s=W(s)),{type:"threshold",scale:(0,tr.Z)(c<0?W(r):r,void 0===s?[]:s).unknown(i),domain:r,range:s}}function Js(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:za;return t.length?[(0,z.Z)(t,(t=>{let{value:n}=t;return void 0===n?n:(0,z.Z)(n,e)})),(0,F.Z)(t,(t=>{let{value:n}=t;return void 0===n?n:(0,F.Z)(n,e)}))]:[0,1]}function Ks(t,e){const n=bs.get(t);return(n===ms||n===ys||n===gs?tl:Js)(e)}function tl(t){return[0,t.length?(0,F.Z)(t,(t=>{let{value:e}=t;return void 0===e?e:(0,F.Z)(e,za)})):1]}function el(t,e){const n=t.find((t=>{let{radius:e}=t;return void 0!==e}));if(void 0!==n)return[0,n.radius];const r=(0,C.ZP)(t,.5,(t=>{let{value:e}=t;return void 0===e?NaN:(0,C.ZP)(e,.25,Ra)})),i=e.map((t=>3*Math.sqrt(t/r))),o=30/(0,F.Z)(i);return o<1?i.map((t=>t*o)):i}function nl(t,e){const n=(0,O.Z)(t,(t=>{let{value:e}=t;return void 0===e?NaN:(0,O.Z)(e,Math.abs)})),r=e.map((t=>12*t/n)),i=60/(0,F.Z)(r);return i<1?r.map((t=>t*i)):r}function rl(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return Js(t,Ra);if(n<0)return Js(t,Pa)}return[1,10]}function il(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function ol(t){return(e,n)=>r=>t(e+r*(n-e))}function al(t,e,n,r,i){let{type:o,nice:a,clamp:s,domain:l=Js(r),unknown:u,pivot:c=0,scheme:f,range:d,symmetric:h=!0,interpolate:p=(bs.get(t)===ps?null==f&&void 0!==d?Bn.interpolateRgb:Ds(void 0!==f?f:"rdbu"):Bn.interpolateNumber),reverse:m}=i;c=+c;let[g,y]=l;if(g=Math.min(g,c),y=Math.max(y,c),"function"!=typeof p&&(p=Vs(p)),void 0!==d&&(p=1===p.length?ol(p)(...d):(0,Bn.piecewise)(p,d)),m&&(p=Hs(p)),h){const t=n.apply(c),e=t-n.apply(g),r=n.apply(y)-t;e<r?g=n.invert(t-r):e>r&&(y=n.invert(t+e))}return e.domain([g,c,y]).unknown(u).interpolator(p),s&&e.clamp(s),a&&e.nice(a),{type:o,domain:[g,y],pivot:c,interpolate:p,scale:e}}function sl(t,e,n){let{exponent:r=1,...i}=n;return al(t,(0,rr.ld)().exponent(r=+r),function(t){return.5===t?cl:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),e,{...i,type:"diverging-pow"})}const ll={apply:t=>t,invert:t=>t},ul={apply:Math.log,invert:Math.exp},cl={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function fl(t,e,n,r){return Gs(t,e,n,r)}const dl=Math.sqrt(3),hl=2/dl,pl={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*hl,i=r/2;t.moveTo(0,r),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(0,-r),t.lineTo(-n,-i),t.lineTo(-n,i),t.closePath()}},ml=new Map([["asterisk",Li.Z],["circle",ji.Z],["cross",Ui.Z],["diamond",qi.Z],["diamond2",Ii.Z],["hexagon",pl],["plus",Wi.Z],["square",$i.Z],["square2",Hi.Z],["star",Zi.Z],["times",Xi.Z],["triangle",Yi.Z],["triangle2",Vi.Z],["wye",Gi.Z]]);function gl(t){return t&&"function"==typeof t.draw}function yl(t){return!!gl(t)||"string"==typeof t&&ml.has(t.toLowerCase())}function vl(t){if(null==t||gl(t))return t;const e=ml.get("".concat(t).toLowerCase());if(e)return e;throw new Error("invalid symbol: ".concat(t))}const bl=Symbol("ordinal");function xl(t,e,n,r){let{type:i,interval:o,domain:a,range:s,reverse:l,hint:u}=r;return o=Rs(o),void 0===a&&(a=wl(n,o,t)),"categorical"!==i&&i!==bl||(i="ordinal"),l&&(a=W(a)),e.domain(a),void 0!==s&&("function"==typeof s&&(s=s(a)),e.range(s)),{type:i,domain:a,range:s,scale:e,hint:u,interval:o}}function _l(t,e,n,r){let{round:i}=n;return void 0!==i&&t.round(i=!!i),(t=xl(r,t,e,n)).round=i,t}function wl(t,e,n){const r=new d.H;for(const{value:i,domain:o}of t){if(void 0!==o)return o();if(void 0!==i)for(const t of i)r.add(t)}if(void 0!==e){const[t,n]=f(r).map(e.floor,e);return e.range(t,e.offset(n))}if(r.size>1e4&&bs.get(n)===hs)throw new Error("implicit ordinal position domain has more than 10,000 values");return(0,v.ZP)(r,Ta)}function kl(t,e){let n;for(const{hint:r}of t){const t=null===r||void 0===r?void 0:r[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Al(t){let{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,round:a,nice:s,clamp:l,zero:u,align:c,padding:f,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const h={};for(const[p,m]of t){const t=d[p],e=Tl(p,m,{round:bs.get(p)===hs?a:void 0,nice:s,clamp:l,zero:u,align:c,padding:f,...t});if(e){let{percent:a,transform:s,inset:l,insetTop:u=(void 0!==l?l:"y"===p?n:0),insetRight:c=(void 0!==l?l:"x"===p?r:0),insetBottom:f=(void 0!==l?l:"y"===p?i:0),insetLeft:d=(void 0!==l?l:"x"===p?o:0)}=t||{};if(null==s)s=void 0;else if("function"!=typeof s)throw new Error("invalid scale transform; not a function");e.percent=!!a,e.transform=s,"x"===p||"fx"===p?(e.insetLeft=+d,e.insetRight=+c):"y"!==p&&"fy"!==p||(e.insetTop=+u,e.insetBottom=+f),h[p]=e}}return h}function El(t){return Object.fromEntries(Object.entries(t).map((t=>{let[e,{scale:n}]=t;return[e,n]})))}function Ml(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:i,marginLeft:o=0,marginRight:a=0}=e,s=o+n,l=i-a-r;t.range=[s,Math.max(s,l)],Rl(t)||(t.range=Dl(t)),t.scale.range(t.range)}Sl(t)}function Cl(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:i,marginTop:o=0,marginBottom:a=0}=e,s=o+n,l=i-a-r;t.range=[Math.max(s,l),s],Rl(t)?t.range.reverse():t.range=Dl(t),t.scale.range(t.range)}Sl(t)}function Sl(t){void 0===t.round&&function(t){let{type:e}=t;return"point"===e||"band"===e}(t)&&function(t){let{scale:e}=t;const n=e.domain().length,[r,i]=e.range(),o=e.paddingInner?e.paddingInner():1,a=e.paddingOuter?e.paddingOuter():e.padding(),s=n-o,l=Math.abs(i-r)/Math.max(1,s+2*a);return(l-Math.floor(l))*s}(t)<=30&&t.scale.round(!0)}function Dl(t){const e=t.scale.domain().length+Pl(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,i)=>n+i/(e-1)*(r-n)))}function Fl(t,e,n){return Tl(t,void 0===n?void 0:[{hint:n}],{...e})}function Tl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=function(t,e,n){let{type:r,domain:i,range:o,scheme:a,pivot:s}=n;if("fx"===t||"fy"===t)return"band";for(const{type:c}of e)if(void 0!==c)if(void 0===r)r=c;else if(r!==c)throw new Error("scale incompatible with channel: ".concat(r," !== ").concat(c));if(void 0!==r)return r;if(void 0===i&&!e.some((t=>{let{value:e}=t;return void 0!==e})))return;const l=bs.get(t);if(l===ps&&void 0===o&&void 0===a&&zl(i,e,ga))return"identity";if(l===vs&&void 0===o&&zl(i,e,yl))return"identity";if(l===ms)return"sqrt";if(l===ys||l===gs)return"linear";if(l===vs)return"ordinal";if((i||o||[]).length>2)return Ol(l);if(void 0!==i)return ca(i)?Ol(l):fa(i)?"utc":l!==ps||null==s&&!Ts(a)?"linear":"diverging";const u=e.map((t=>{let{value:e}=t;return e})).filter((t=>void 0!==t));return u.some(ca)?Ol(l):u.some(fa)?"utc":l!==ps||null==s&&!Ts(a)?"linear":"diverging"}(t,e,n);if(void 0===n.type&&void 0===n.domain&&void 0===n.range&&null==n.interval&&"fx"!==t&&"fy"!==t&&Rl({type:r})){const n=e.map((t=>{let{value:e}=t;return e})).filter((t=>void 0!==t));n.some(fa)?La("Warning: some data associated with the ".concat(t,' scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "').concat(Nl(r),'" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ').concat(t," scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ").concat(t,' scale to "').concat(Nl(r),'".')):n.some(da)?La("Warning: some data associated with the ".concat(t,' scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "').concat(Nl(r),'" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ').concat(t,' scale to "').concat(Nl(r),'".')):n.some(ha)&&La("Warning: some data associated with the ".concat(t,' scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "').concat(Nl(r),'" scale. If you want to treat this data as ordinal, you can specify the interval of the ').concat(t," scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ").concat(t,' scale to "').concat(Nl(r),'".'))}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=jl(e,n,Il);break;case"identity":switch(bs.get(t)){case hs:n=jl(e,n,Il);break;case vs:n=jl(e,n,Ul)}break;case"utc":case"time":n=jl(e,n,ql)}switch(r){case"diverging":return function(t,e,n){return al(t,(0,rr.ZP)(),ll,e,n)}(t,e,n);case"diverging-sqrt":return function(t,e,n){return sl(t,e,{...n,exponent:.5})}(t,e,n);case"diverging-pow":return sl(t,e,n);case"diverging-log":return function(t,e,n){let{base:r=10,pivot:i=1,domain:o=Js(e,i<0?Pa:Ra),...a}=n;return al(t,(0,rr.QA)().base(r=+r),ul,e,{domain:o,pivot:i,...a})}(t,e,n);case"diverging-symlog":return function(t,e,n){let{constant:r=1,...i}=n;return al(t,(0,rr.UM)().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),e,i)}(t,e,n);case"categorical":case"ordinal":case bl:return function(t,e,n){let r,{type:i,interval:o,domain:a,range:s,scheme:l,unknown:u,...c}=n;if(o=Rs(o),void 0===a&&(a=wl(e,o,t)),bs.get(t)===vs)r=function(t){return{fill:kl(t,"fill"),stroke:kl(t,"stroke")}}(e),s=void 0===s?function(t){return ya(t.fill)?Bi.WY:Bi.Hl}(r):Io(s,vl);else if(bs.get(t)===ps&&(void 0!==s||"ordinal"!==i&&i!==bl||(s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"greys";const n=new Set,[r,i]=Cs(e,2);for(const o of t)if(null!=o)if(!0===o)n.add(i);else{if(!1!==o)return;n.add(r)}return[...n]}(a,l),void 0!==s&&(l=void 0)),void 0===l&&void 0===s&&(l="ordinal"===i?"turbo":"tableau10"),void 0!==l))if(void 0!==s){const t=Ds(l),e=s[0],n=s[1]-s[0];s=r=>{let{length:i}=r;return(0,Bn.quantize)((r=>t(e+n*r)),i)}}else s=Ms(l);if(u===$n.O)throw new Error("implicit unknown is not supported");return xl(t,(0,$n.Z)().unknown(u),e,{...c,type:i,domain:a,range:s,hint:r})}(t,e,n);case"cyclical":case"sequential":case"linear":return function(t,e,n){return Gs(t,(0,Gn.Z)(),e,n)}(t,e,n);case"sqrt":return function(t,e,n){return Xs(t,e,{...n,exponent:.5})}(t,e,n);case"threshold":return Qs(t,0,n);case"quantile":return function(t,e,n){let{range:r,quantiles:i=(void 0===r?5:(r=[...r]).length),n:o=i,scheme:a="rdylbu",domain:s=il(e),interpolate:l,reverse:u}=n;return void 0===r&&(r=void 0!==l?(0,Bn.quantize)(l,o):bs.get(t)===ps?Cs(a,o):void 0),Qs(t,0,{domain:(0,Kn.Z)(s,void 0===r?{length:o}:r).quantiles(),range:r,reverse:u})}(t,e,n);case"quantize":return function(t,e,n){let{range:r,n:i=(void 0===r?5:(r=[...r]).length),scheme:o="rdylbu",domain:a=Ks(t,e),interpolate:s,reverse:l}=n;const[u,c]=f(a);let d;return void 0===r?(d=(0,A.ZP)(u,c,i),d[0]<=u&&d.splice(0,1),d[d.length-1]>=c&&d.pop(),i=d.length+1,r=void 0!==s?(0,Bn.quantize)(s,i):bs.get(t)===ps?Cs(o,i):void 0):(d=(0,Bn.quantize)((0,Bn.interpolateNumber)(u,c),i+1).slice(1,-1),u instanceof Date&&(d=d.map((t=>new Date(t))))),xa(qo(a))<0&&d.reverse(),Qs(t,0,{domain:d,range:r,reverse:l})}(t,e,n);case"pow":return Xs(t,e,n);case"log":return function(t,e,n){let{base:r=10,domain:i=rl(e),...o}=n;return Gs(t,(0,Xn.Z)().base(r),e,{...o,domain:i})}(t,e,n);case"symlog":return function(t,e,n){let{constant:r=1,...i}=n;return Gs(t,(0,Qn.Z)().constant(r),e,i)}(t,e,n);case"utc":return function(t,e,n){return fl(t,(0,nr.Z)(),e,n)}(t,e,n);case"time":return function(t,e,n){return fl(t,(0,er.Z)(),e,n)}(t,e,n);case"point":return function(t,e,n){let{align:r=.5,padding:i=.5,...o}=n;return _l(Yn().align(r).padding(i),e,o,t)}(t,e,n);case"band":return function(t,e,n){let{align:r=.5,padding:i=.1,paddingInner:o=i,paddingOuter:a=("fx"===t||"fy"===t?0:i),...s}=n;return _l(Hn().align(r).paddingInner(o).paddingOuter(a),e,s,t)}(t,e,n);case"identity":return bs.get(t)===hs?{type:"identity",scale:(0,Vn.Z)()}:{type:"identity"};case void 0:return;default:throw new Error("unknown scale type: ".concat(r))}}function Nl(t){return"symbol"==typeof t?t.description:t}function Ol(t){switch(t){case hs:return"point";case ps:return bl;default:return"ordinal"}}function zl(t,e,n){return void 0!==t?pa(t,n)&&ma(t,n):e.some((t=>{let{value:e}=t;return void 0!==e&&pa(e,n)}))&&e.every((t=>{let{value:e}=t;return void 0===e||ma(e,n)}))}function Rl(t){let{type:e}=t;return"ordinal"===e||"point"===e||"band"===e||e===bl}function Pl(t){let{type:e}=t;return"threshold"===e}function Bl(t){let{range:e,domain:n=e}=t;return Math.sign(xa(n))*Math.sign(xa(e))}function Ll(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,i=e.length;r<i;++r)if(t(e[r])-n)return!1;return!0}function jl(t,e,n){let{domain:r,...i}=e;for(const o of t)void 0!==o.value&&(o.value=n(o.value));return{domain:void 0===r?r:n(r),...i}}function Ul(t){return Io(t,vl)}function ql(t){return Io(t,$l)}function Il(t){return $o(t)?t:Io(t,Wl,Float64Array)}function Wl(t){return null==t?NaN:+t}function $l(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?_o(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function Hl(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(const n in e)if(bs.has(n)&&Zo(e[n])){if(void 0!==t)throw new Error("ambiguous scale definition; multiple scales found");t=Zl(Fl(n,e[n]))}if(void 0===t)throw new Error("invalid scale definition; no scale found");return t}function Zl(t){let{scale:e,type:n,domain:r,range:i,label:o,interpolate:a,interval:s,transform:l,percent:u,pivot:c}=t;if("identity"===n)return{type:"identity",apply:t=>t,invert:t=>t};const f=e.unknown?e.unknown():void 0;return{type:n,domain:Wo(r),...void 0!==i&&{range:Wo(i)},...void 0!==l&&{transform:l},...u&&{percent:u},...void 0!==o&&{label:o},...void 0!==f&&{unknown:f},...void 0!==s&&{interval:s},...void 0!==a&&{interpolate:a},...e.clamp&&{clamp:e.clamp()},...void 0!==c&&{pivot:c,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:t=>e(t),...e.invert&&{invert:t=>e.invert(t)}}}function Yl(t,e,n){if(void 0===e.ticks){const r=t.interval;if(void 0!==r){const[n,i]=f(t.scale.domain());e.ticks=r.range(r.floor(n),r.offset(r.floor(i)))}else{const[r,i]=f(t.scale.range());e.ticks=(i-r)/n}}void 0===e.tickFormat&&Rl(t)&&(e.tickFormat=Sa)}function Vl(t,e,n){void 0===t.labelAnchor&&(t.labelAnchor=Rl(e)?"center":Bl(e)<0?"left":"right"),void 0===t.label&&(t.label=Ql(n,e,t,"x")),e.label=t.label}function Gl(t,e,n,r){void 0===t.labelAnchor&&(t.labelAnchor=Rl(n)?"center":e&&"top"===e.axis?"bottom":"top"),void 0===t.label&&(t.label=Ql(r,n,t,"y")),n.label=t.label}function Xl(t,e,n,r){r&&(e.label=r.label),void 0===e.label&&(e.label=Ql(n,e,null,t))}function Ql(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;for(const{label:o}of e)if(void 0!==o)if(void 0===t)t=o;else if(t!==o)return;if(void 0!==t){if(function(t){let{type:e}=t;return"time"===e||"utc"===e}(n)&&/^(date|time|year)$/i.test(t))return;if(!Rl(n)&&(n.percent&&(t="".concat(t," (%)")),"x"===i||"y"===i)){const e=Bl(n);e&&(t="x"===i||r&&"center"===r.labelAnchor?"x"===i==e<0?"\u2190 ".concat(t):"".concat(t," \u2192"):"".concat(e<0?"\u2191 ":"\u2193 ").concat(t))}}return t}function Jl(t){return Rl(t)&&void 0===t.interval?void 0:"tabular-nums"}function Kl(){let{filter:t,sort:e,reverse:n,transform:r,initializer:i,...o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if(void 0===r&&(null!=t&&(r=ou(t)),null==e||Vo(e)||(r=eu(r,cu(e))),n&&(r=eu(r,su))),null!=a&&null!=i)throw new Error("transforms cannot be applied after initializers");return{...o,...(null===e||Vo(e))&&{sort:e},transform:eu(r,a)}}function tu(){let{filter:t,sort:e,reverse:n,initializer:r,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;return void 0===r&&(null!=t&&(r=ou(t)),null==e||Vo(e)||(r=nu(r,cu(e))),n&&(r=nu(r,su))),{...i,initializer:nu(r,o)}}function eu(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r){return({data:n,facets:r}=t.call(this,n,r)),e.call(this,qo(n),r)}}function nu(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,i,o,a){let s,l,u,c,f,d;return({data:l=n,facets:u=r,channels:s}=t.call(this,n,r,i,o,a)),({data:f=l,facets:d=u,channels:c}=e.call(this,l,u,{...i,...s},o,a)),{data:f,facets:d,channels:{...s,...c}}}}function ru(t,e){return(null!=t.initializer?tu:Kl)(t,e)}function iu(t,e){return ru(e,ou(t))}function ou(t){return(e,n)=>{const r=Ao(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function au(t){return{...ru(t,su),sort:null}}function su(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function lu(){let{seed:t,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...ru(e,du(null==t?Math.random:In(t))),sort:null}}function uu(t,e){return{...(Yo(t)&&void 0!==t.channel?tu:ru)(e,cu(t)),sort:null}}function cu(t){return("function"==typeof t&&1!==t.length?fu:du)(t)}function fu(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function du(t){let e,n;if(({channel:e,value:t,order:n=Ta}={...sa(t)}),"function"!=typeof n)switch("".concat(n).toLowerCase()){case"ascending":n=Ta;break;case"descending":n=Na;break;default:throw new Error("invalid order: ".concat(n))}return(r,i,o)=>{let a;if(void 0===e)a=Ao(r,t);else{if(void 0===o)throw new Error("channel sort requires an initializer");if(a=o[e],!a)return{};a=a.value}const s=(t,e)=>n(a[t],a[e]);return{data:r,facets:i.map((t=>t.slice().sort(s)))}}}function hu(t,e){return yu(null,null,t,e)}function pu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{y:"count"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n=Co}=e;if(null==n)throw new Error("missing channel: x");return yu(n,null,t,e)}function mu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:"count"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{y:n=Co}=e;if(null==n)throw new Error("missing channel: y");return yu(null,n,t,e)}function gu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fill:"count"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{x:n,y:r}=e;if([n,r]=Xo(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return yu(n,r,t,e)}function yu(t,e){let{data:n=Cu,filter:r,sort:i,reverse:o,...a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};a=bu(a,s),n=ku(n,Co),i=null==i?void 0:xu("sort",i,s),r=null==r?void 0:_u("filter",r,s);const[l,u]=ia(t),[c,f]=ia(e),{z:d,fill:h,stroke:p,x1:m,x2:g,y1:y,y2:v,...b}=s,[x,_]=ia(d),[w]=Bo(h),[k]=Bo(p),[A,E]=ia(w),[M,C]=ia(k);return{..."z"in s&&{z:x||d},..."fill"in s&&{fill:A||h},..."stroke"in s&&{stroke:M||p},...Kl(b,((s,l)=>{const c=Ao(s,t),h=Ao(s,e),p=Ao(s,d),m=Ao(s,w),g=Ao(s,k),y=Au(a,{z:p,fill:m,stroke:g}),v=[],b=[],x=c&&u([]),A=h&&f([]),M=p&&_([]),S=m&&E([]),D=g&&C([]);let F=0;for(const t of a)t.initialize(s);i&&i.initialize(s),r&&r.initialize(s);for(const t of l){const e=[];for(const n of a)n.scope("facet",t);i&&i.scope("facet",t),r&&r.scope("facet",t);for(const[o,l]of wu(t,y))for(const[t,u]of wu(l,h))for(const[l,f]of wu(u,c))if(!r||r.reduce(f)){e.push(F++),b.push(n.reduce(f,s)),c&&x.push(l),h&&A.push(t),p&&M.push(y===p?o:p[f[0]]),m&&S.push(y===m?o:m[f[0]]),g&&D.push(y===g?o:g[f[0]]);for(const t of a)t.reduce(f);i&&i.reduce(f)}v.push(e)}return Eu(v,i,o),{data:b,facets:v}})),...!vu(a,"x")&&(l?{x:l}:{x1:m,x2:g}),...!vu(a,"y")&&(c?{y:c}:{y1:y,y2:v}),...Object.fromEntries(a.map((t=>{let{name:e,output:n}=t;return[e,n]})))}}function vu(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const{name:i}of t)if(n.includes(i))return!0;return!1}function bu(t,e){const n=Object.entries(t);return null!=e.title&&void 0===t.title&&n.push(["title",Du]),null!=e.href&&void 0===t.href&&n.push(["href",Su]),n.map((t=>{let[n,r]=t;return null==r?{name:n,initialize(){},scope(){},reduce(){}}:xu(n,r,e)}))}function xu(t,e,n){const r=_u(t,e,n),[i,o]=ra(r.label);let a;return{name:t,output:i,initialize(t){r.initialize(t),a=o([])},scope(t,e){r.scope(t,e)},reduce(t,e){a.push(r.reduce(t,e))}}}function _u(t,e,n){const r=na(t,n),i=ku(e,r);let o,a;return{label:oa(i===Tu?null:r,i.label),initialize(t){o=void 0===r?t:Ao(t,r),"data"===i.scope&&(a=i.reduce(Jo(t),o))},scope(t,e){i.scope===t&&(a=i.reduce(e,o))},reduce:(t,e)=>null==i.scope?i.reduce(t,o,e):i.reduce(t,o,a,e)}}function wu(t,e){return e?(0,v.ZP)(p(t,(t=>e[t])),Oo):[[,t]]}function ku(t,e){if(t&&"function"==typeof t.reduce)return t;if("function"==typeof t)return n=t,{reduce:(t,e,r)=>n(ta(e,t),r)};var n;if(/^p\d{2}$/i.test(t))return Mu(Po(t));switch("".concat(t).toLowerCase()){case"first":return Su;case"last":return Fu;case"count":return Tu;case"distinct":return Nu;case"sum":return null==e?Tu:Ou;case"proportion":return zu(e,"data");case"proportion-facet":return zu(e,"facet");case"deviation":return Mu(c.Z);case"min":return Mu(z.Z);case"min-index":return Mu(R);case"max":return Mu(F.Z);case"max-index":return Mu(T);case"mean":return Mu(N.Z);case"median":return Mu(O.Z);case"variance":return Mu(I.Z);case"mode":return Mu(P);case"x":return Pu;case"x1":return Lu;case"x2":return ju;case"y":return Bu;case"y1":return Uu;case"y2":return qu}throw new Error("invalid reduce: ".concat(t))}function Au(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function Eu(t,e,n){if(e){const n=e.output.transform(),r=(t,e)=>Ta(n[t],n[e]);t.forEach((t=>t.sort(r)))}n&&t.forEach((t=>t.reverse()))}function Mu(t){return{reduce:(e,n)=>t(e,(t=>n[t]))}}const Cu={reduce:(t,e)=>ta(e,t)},Su={reduce:(t,e)=>e[t[0]]},Du={reduce(t,e){const n=(0,v.ZP)(g(t,(t=>t.length),(t=>e[t])),zo),r=n.slice(-5).reverse();if(r.length<n.length){const t=n.slice(0,-4);r[4]=["\u2026 ".concat(t.length.toLocaleString("en-US")," more"),(0,q.Z)(t,zo)]}return r.map((t=>{let[e,n]=t;return"".concat(e," (").concat(n.toLocaleString("en-US"),")")})).join("\n")}},Fu={reduce:(t,e)=>e[t[t.length-1]]},Tu={label:"Frequency",reduce:t=>t.length},Nu={label:"Distinct",reduce:(t,e)=>{const n=new d.H;for(const r of t)n.add(e[r]);return n.size}},Ou=Mu(q.Z);function zu(t,e){return null==t?{scope:e,label:"Frequency",reduce:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t.length/n}}:{scope:e,reduce:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,q.Z)(t,(t=>e[t]))/n}}}function Ru(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const Pu={reduce:(t,e,n)=>{let{x1:r,x2:i}=n;return Ru(r,i)}},Bu={reduce:(t,e,n)=>{let{y1:r,y2:i}=n;return Ru(r,i)}},Lu={reduce:(t,e,n)=>{let{x1:r}=n;return r}},ju={reduce:(t,e,n)=>{let{x2:r}=n;return r}},Uu={reduce:(t,e,n)=>{let{y1:r}=n;return r}},qu={reduce:(t,e,n)=>{let{y2:r}=n;return r}};function Iu(t,e){let{scale:n,type:r,value:i,filter:o,hint:a}=e;return{scale:n,type:r,value:Ao(t,i),label:oa(i),filter:o,hint:a}}function Wu(t,e){const n={};for(const r in t){const{scale:i,value:o}=t[r],a=e[i];n[r]=void 0===a?o:Io(o,a)}return n}function $u(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function Hu(t,e,n){const r=Zu(t,e);return Io(Zu(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function Zu(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error("missing channel: ".concat(e))}function Yu(t,e){let[n,i]=t,[o,a]=e;return(0,r.Z)(i,a)||(0,r.Z)(n,o)}function Vu(t,e){let[n,i]=t,[o,a]=e;return(0,u.Z)(i,a)||(0,r.Z)(n,o)}function Gu(t){let{y:e,fy:n,fx:r}=t;const i=n?n.scale.domain().length:1,o=e?Rl(e)?e.scale.domain().length:Math.max(7,17/i):1;return!(!e&&!n)*Math.max(1,Math.min(60,o*i))*20+30*!!r+60}function Xu(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error("scale not found: ".concat(e));return n}function Qu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,{columns:i,tickFormat:o,fontVariant:a=Jl(t),swatchSize:s=15,swatchWidth:l=s,swatchHeight:u=s,marginLeft:c=0,className:f,style:d,width:h}=e;const p=yo(e);f=ns(f),o=cs(o,t.domain);const m=vo("div",p).attr("class",f).attr("style","\n        --swatchWidth: ".concat(+l,"px;\n        --swatchHeight: ").concat(+u,"px;\n      "));let g;return null!=i?(g="\n      .".concat(f,"-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .").concat(f,"-swatch::before {\n        flex-shrink: 0;\n      }\n      .").concat(f,"-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    "),m.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class","".concat(f,"-swatch")).call(n,t).call((t=>t.append("div").attr("class","".concat(f,"-label")).attr("title",o).text(o)))):(g="\n      .".concat(f," {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .").concat(f,"-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    "),m.selectAll().data(t.domain).enter().append("span").attr("class","".concat(f,"-swatch")).call(n,t).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text("\n        .".concat(f," {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;").concat(void 0===c?"":"\n          margin-left: ".concat(+c,"px;")).concat(void 0===h?"":"\n          width: ".concat(h,"px;"),"\n        }\n        ").concat(r(f),"\n        ").concat(g,"\n      ")))).style("font-variant",Ka(a,"normal")).call(rs,d).node()}const Ju=new Map([["symbol",function(t){var e,n;let{fill:r=(void 0!==(null===(e=t.hint)||void 0===e?void 0:e.fill)?t.hint.fill:"none"),fillOpacity:i=1,stroke:o=(void 0!==(null===(n=t.hint)||void 0===n?void 0:n.stroke)?t.hint.stroke:ya(r)?"currentColor":"none"),strokeOpacity:a=1,strokeWidth:s=1.5,r:l=4.5,...u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2?arguments[2]:void 0;const[f,d]=Bo(r),[h,p]=Bo(o),m=Xu(c,f),g=Xu(c,h),y=l*l*Math.PI;return i=Lo(i)[1],a=Lo(a)[1],s=Lo(s)[1],Qu(t,u,(e=>e.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===f?t=>m.scale(t):null).attr("stroke","color"===h?t=>g.scale(t):null).append("path").attr("d",(e=>{const n=(0,Ln.ET)();return t.scale(e).draw(n,y),n}))),(t=>".".concat(t,"-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ").concat(d,";\n        fill-opacity: ").concat(i,";\n        stroke: ").concat(p,";\n        stroke-width: ").concat(s,"px;\n        stroke-opacity: ").concat(a,";\n      }")))}],["color",ec],["opacity",function(t,e){let{type:n,interpolate:r,...i}=t,{legend:o=!0,color:a=(0,ze.B8)(0,0,0),...s}=e;if(!r)throw new Error("".concat(n," opacity scales are not supported"));if(!0===o&&(o="ramp"),"ramp"!=="".concat(o).toLowerCase())throw new Error("".concat(o," opacity legends are not supported"));return ec({type:n,...i,interpolate:nc(a)},{legend:o,...s})}]]);function Ku(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(const[e,n]of Ju){const r=t[e];if(Zo(r)){const i=yo(t);let o;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&Zo(t.color)?"color":void 0)}=t;o={fill:e,stroke:n}}return n(Fl(e,r,o),tc(i,r,t),(e=>Zo(t[e])?Fl(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")}function tc(t){let{label:e,ticks:n,tickFormat:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(const o of r)for(const n in o)if(void 0===e[n]){const r=o[n];e===t?e={...e,[n]:r}:e[n]=r}return e}(arguments.length>2?arguments[2]:void 0,t,{label:e,ticks:n,tickFormat:r})}function ec(t,e){let{legend:n=!0,...r}=e;if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch("".concat(n).toLowerCase()){case"swatches":return function(t,e){if(!Rl(t)&&!Pl(t))throw new Error("swatches legend requires ordinal or threshold color scale (not ".concat(t.type,")"));return Qu(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>".".concat(t,"-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }")))}(t,r);case"ramp":return function(t,e){let{label:n=t.label,tickSize:r=6,width:i=240,height:o=44+r,marginTop:a=18,marginRight:s=0,marginBottom:l=16+r,marginLeft:u=0,style:c,ticks:f=(i-u-s)/64,tickFormat:d,fontVariant:h=Jl(t),round:p=!0,className:m}=e;const g=yo(e);m=ns(m),null===d&&(d=()=>null);const y=vo("svg",g).attr("class",m).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",o).attr("viewBox","0 0 ".concat(i," ").concat(o)).call((t=>t.append("style").text("\n        .".concat(m," {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .").concat(m," text {\n          white-space: pre;\n        }\n      ")))).call(rs,c);let v,b=t=>t.selectAll(".tick line").attr("y1",a+l-o);const x=p?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:_,domain:w,range:k,interpolate:A,scale:E,pivot:M}=t;if(A){const t=void 0===k?A:(0,Bn.piecewise)(1===A.length?ol(A):A,k);v=x(E.copy(),(0,Bn.quantize)((0,Bn.interpolateNumber)(u,i-s),Math.min(w.length+(void 0!==M),void 0===k?1/0:k.length)));const e=256,n=g.document.createElement("canvas");n.width=e,n.height=1;const r=n.getContext("2d");for(let i=0,o=e-1;i<e;++i)r.fillStyle=t(i/o),r.fillRect(i,0,1,1);y.append("image").attr("x",u).attr("y",a).attr("width",i-u-s).attr("height",o-a-l).attr("preserveAspectRatio","none").attr("xlink:href",n.toDataURL())}else if("threshold"===_){const t=w,e=void 0===d?t=>t:"string"==typeof d?(0,Nn.WU)(d):d;v=x((0,Gn.Z)().domain([-1,k.length-1]),[u,i-s]),y.append("g").selectAll().data(k).enter().append("rect").attr("x",((t,e)=>v(e-1))).attr("y",a).attr("width",((t,e)=>v(e)-v(e-1))).attr("height",o-a-l).attr("fill",(t=>t)),f=Io(t,((t,e)=>e)),d=n=>e(t[n],n)}else v=x(Hn().domain(w),[u,i-s]),y.append("g").selectAll().data(w).enter().append("rect").attr("x",v).attr("y",a).attr("width",Math.max(0,v.bandwidth()-1)).attr("height",o-a-l).attr("fill",E),b=()=>{};return y.append("g").attr("transform","translate(0,".concat(o-l,")")).call(ot(v).ticks(Array.isArray(f)?null:f,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Ka(h,"normal")).call(b).call((t=>t.select(".domain").remove())),void 0!==n&&y.append("text").attr("x",u).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(n),y.node()}(t,r);default:throw new Error("unknown legend type: ".concat(n))}}function nc(t){const{r:e,g:n,b:r}=(0,ze.B8)(t)||(0,ze.B8)(0,0,0);return t=>"rgba(".concat(e,",").concat(n,",").concat(r,",").concat(t,")")}function rc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{facet:e,style:n,caption:r,ariaLabel:i,ariaDescription:l}=t,u=ns(t.className),c=void 0===t.marks?[]:t.marks.flat(1/0).map(ac),f=new Map,d=new Map;for(const o of bs.keys())Zo(t[o])&&"fx"!==o&&"fy"!==o&&d.set(o,[]);let h,p,g,y,v;if(void 0!==e){const{x:t,y:n}=e;if(null!=t||null!=n){const r=qo(e.data);if(null==r)throw new Error("missing facet data");if(g={},null!=t){const e=Iu(r,{value:t,scale:"fx"});g.fx=e,d.set("fx",[e])}if(null!=n){const t=Iu(r,{value:n,scale:"fy"});g.fy=t,d.set("fy",[t])}p=Jo(r),h=function(t,e){let{fx:n,fy:r}=e;return n&&r?function(t,e,n){let{value:r}=e,{value:i}=n;return m(t,(t=>r[t]),(t=>i[t])).flatMap((t=>{let[e,n]=t;return n.map((t=>{let[n,r]=t;return[[e,n],r]}))}))}(t,n,r):function(t,e){let{value:n}=e;return m(t,(t=>n[t]))}(t,n||r)}(p,g),y=h.map(zo)}}for(const o of c){if(f.has(o))throw new Error("duplicate mark; each mark must be unique");const n=void 0===y?void 0:"auto"===o.facet?o.data===e.data?y:void 0:"include"===o.facet?y:"exclude"===o.facet?v||(v=y.map((t=>Uint32Array.from($(p,t))))):void 0,{data:r,facets:i,channels:a}=o.initialize(n,g);lc(a,t),f.set(o,{data:r,facets:i,channels:a})}const b=Al(cc(d,f),t),x=El(b),_=function(t){let{x:e,y:n,fx:r,fy:i}=t,{x:o={},y:a={},fx:s={},fy:l={},axis:u=!0,grid:c,line:f,label:d,facet:{axis:h=u,grid:p,label:m=d}={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{axis:g=u}=o,{axis:y=u}=a,{axis:v=h}=s,{axis:b=h}=l;return e?!0===g&&(g="bottom"):g=null,n?!0===y&&(y="left"):y=null,r?!0===v&&(v="bottom"===g?"top":"bottom"):v=null,i?!0===b&&(b="left"===y?"right":"left"):b=null,{...g&&{x:new os({grid:c,line:f,label:d,fontVariant:Jl(e),...o,axis:g})},...y&&{y:new as({grid:c,line:f,label:d,fontVariant:Jl(n),...a,axis:y})},...v&&{fx:new os({name:"fx",grid:p,label:m,fontVariant:Jl(r),...s,axis:v})},...b&&{fy:new as({name:"fy",grid:p,label:m,fontVariant:Jl(i),...l,axis:b})}}}(b,t),w=function(t,e){let{x:{axis:n}={},y:{axis:r}={},fx:{axis:i}={},fy:{axis:o}={}}=e,{width:a=640,height:s=Gu(t),facet:{margin:l,marginTop:u=(void 0!==l?l:"top"===i?30:0),marginRight:c=(void 0!==l?l:"right"===o?40:0),marginBottom:f=(void 0!==l?l:"bottom"===i?30:0),marginLeft:d=(void 0!==l?l:"left"===o?40:0)}={},margin:h,marginTop:p=(void 0!==h?h:Math.max(("top"===n?30:0)+u,r||o?20:.5-ja)),marginRight:m=(void 0!==h?h:Math.max(("right"===r?40:0)+c,n||i?20:.5+ja)),marginBottom:g=(void 0!==h?h:Math.max(("bottom"===n?30:0)+f,r||o?20:.5+ja)),marginLeft:y=(void 0!==h?h:Math.max(("left"===r?40:0)+d,n||i?20:.5-ja))}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{width:a,height:s,marginTop:p,marginRight:m,marginBottom:g,marginLeft:y,facetMarginTop:u,facetMarginRight:c,facetMarginBottom:f,facetMarginLeft:d}}(b,_,t),k=yo(t);!function(t,e){let{x:n,y:r,fx:i,fy:o}=t;i&&Ml(i,e),o&&Cl(o,e),n&&Ml(n,i?{width:i.scale.bandwidth()}:e),r&&Cl(r,o?{height:o.scale.bandwidth()}:e)}(b,w),function(t,e){let{x:n,y:r,fx:i,fy:o}=t,{x:a,y:s,fx:l,fy:u}=e;l&&Yl(i,l,80),u&&Yl(o,u,35),a&&Yl(n,a,80),s&&Yl(r,s,35)}(b,_);const{fx:A,fy:E}=x,M=E&&{marginTop:0,marginBottom:0,height:E.bandwidth()},C=A&&{marginRight:0,marginLeft:0,width:A.bandwidth()},S={...w,...C,...M},D=new Set;for(const[o,a]of f)if(null!=o.initializer){const{facets:e,channels:n}=o.initializer(a.data,a.facets,a.channels,x,S);if(void 0!==e&&(a.facets=e),void 0!==n){uc(n),lc(n,t),Object.assign(a.channels,n);for(const{scale:t}of Object.values(n))null!=t&&D.add(t)}}if(D.size){for(const t of D)if(bs.get(t)===hs)throw new Error("initializers cannot declare position scales: ".concat(t));const e=Al(cc(new Map,f,(t=>D.has(t))),t),n=El(e);Object.assign(b,e),Object.assign(x,n)}!function(t,e,n,r,i){let{x:o,y:a,fx:s,fy:l}=n;if(s&&(Vl(s,e.fx,t.get("fx")),void 0===s.labelOffset)){const{facetMarginTop:t,facetMarginBottom:e}=r;s.labelOffset="top"===s.axis?t:e}if(l&&(Gl(l,s,e.fy,t.get("fy")),void 0===l.labelOffset)){const{facetMarginLeft:t,facetMarginRight:e}=r;l.labelOffset="left"===l.axis?t:e}if(o&&(Vl(o,e.x,t.get("x")),void 0===o.labelOffset)){const{marginTop:t,marginBottom:e,facetMarginTop:n,facetMarginBottom:i}=r;o.labelOffset="top"===o.axis?t-n:e-i}if(a&&(Gl(a,o,e.y,t.get("y")),void 0===a.labelOffset)){const{marginRight:t,marginLeft:e,facetMarginLeft:n,facetMarginRight:i}=r;a.labelOffset="left"===a.axis?e-n:t-i}for(const[u,c]of bs)c!==hs&&e[u]&&Xl(u,e[u],t.get(u),i[u])}(d,b,_,w,t);for(const o of f.values())o.values=Wu(o.channels,x);const{width:F,height:T}=w,N=vo("svg",k).attr("class",u).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",F).attr("height",T).attr("viewBox","0 0 ".concat(F," ").concat(T)).attr("aria-label",i).attr("aria-description",l).call((t=>t.append("style").text("\n        .".concat(u," {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n        }\n        .").concat(u," text,\n        .").concat(u," tspan {\n          white-space: pre;\n        }\n      ")))).call(rs,n).node(),O=_[void 0!==h&&E?"fy":"y"],z=_[void 0!==h&&A?"fx":"x"];if(O&&N.appendChild(O.render(null,x,w,k)),z&&N.appendChild(z.render(null,x,w,k)),void 0!==h){const t=E&&E.domain(),e=A&&A.domain(),n=function(t){let{fx:e,fy:n}=t;return new(e&&n?hc:dc)}(g);h.forEach(((t,e)=>{let[r]=t;return n.set(r,e)}));const r=zi(N);if(E&&_.y){const i=_.y,o=fc(i),a="bottom"===i.labelAnchor?t.length-1:"center"===i.labelAnchor?t.length>>1:0;r.selectAll().data(t).enter().append(((t,r)=>(r===a?i:o).render(A&&Ko(e,(e=>n.has([e,t]))),x,{...w,...M,offsetTop:E(t)},k)))}if(A&&_.x){const i=_.x,o=fc(i),a="right"===i.labelAnchor?e.length-1:"center"===i.labelAnchor?e.length>>1:0,{marginLeft:s,marginRight:l}=w;r.selectAll().data(e).enter().append(((e,r)=>(r===a?i:o).render(E&&Ko(t,(t=>n.has([e,t]))),x,{...w,...C,labelMarginLeft:s,labelMarginRight:l,offsetLeft:A(e)},k)))}r.selectAll().data(function(t){let{fx:e,fy:n}=t;return e&&n?function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r="function"==typeof e[e.length-1]&&function(t){return e=>t(...e)}(e.pop()),i=(e=e.map(s)).map(o),l=e.length-1,u=new Array(l+1).fill(0),c=[];if(l<0||i.some(a))return c;for(;;){c.push(u.map(((t,n)=>e[n][t])));let t=l;for(;++u[t]===i[t];){if(0===t)return r?c.map(r):c;u[t--]=0}}}(e.domain(),n.domain()):e?e.domain():n.domain()}(x).filter(n.has,n)).enter().append("g").attr("aria-label","facet").attr("transform",function(t,e){return t&&e?n=>{let[r,i]=n;return"translate(".concat(t(r),",").concat(e(i),")")}:t?e=>"translate(".concat(t(e),",0)"):t=>"translate(0,".concat(e(t),")")}(A,E)).each((function(t){const e=n.get(t);for(const[n,{channels:i,values:o,facets:a}]of f){var r;const t=a?n.filter(null!==(r=a[e])&&void 0!==r?r:a[0],i,o):null,s=n.render(t,x,o,S,k);null!=s&&this.appendChild(s)}}))}else for(const[o,{channels:a,values:s,facets:m}]of f){const t=m?o.filter(m[0],a,s):null,e=o.render(t,x,s,w,k);null!=e&&N.appendChild(e)}let R=N;const P=function(t,e,n){const r=[];for(const[i,o]of Ju){const a=n[i];if(null!==a&&void 0!==a&&a.legend&&i in t){const n=o(t[i],tc(e,t[i],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(b,k,t);if(null!=r||P.length>0){const{document:t}=k;R=t.createElement("figure"),R.style.maxWidth="initial";for(const e of P)R.appendChild(e);if(R.appendChild(N),null!=r){const e=t.createElement("figcaption");e.appendChild(r instanceof Node?r:t.createTextNode(r)),R.appendChild(e)}}R.scale=function(t){return e=>{if(!bs.has(e="".concat(e)))throw new Error("unknown scale: ".concat(e));return e in t?Zl(t[e]):void 0}}(b),R.legend=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(r,i)=>{if(!Ju.has(r))throw new Error("unknown legend type: ".concat(r));if(r in t)return Ju.get(r)(t[r],tc(e,n[r],i),(e=>t[e]))}}(b,k,t);const B=function(){const t=Ba;return Ba=0,t}();return B>0&&zi(N).append("text").attr("x",F).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("\u26a0\ufe0f").append("title").text("".concat(B.toLocaleString("en-US")," warning").concat(1===B?"":"s",". Please check the console.")),R}class ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const{facet:i="auto",sort:o,dx:a,dy:s,clip:l,channels:u}=n,c=new Set;this.data=t,this.sort=Vo(o)?o:null,this.initializer=tu(n).initializer,this.transform=this.initializer?n.transform:Kl(n).transform,this.facet=null==i||!1===i?null:Uo(!0===i?"include":i,"facet",["auto","include","exclude"]),void 0!==u&&(e=[...e,...u.filter((t=>!e.some((e=>e.name===t.name))))]),void 0!==r&&(e=[...e,...qa(this,n,r)]),this.channels=e.filter((t=>{const{name:e,value:n,optional:r}=t;if(null==n){if(r)return!1;throw new Error("missing channel value: ".concat(e))}if(null==e)throw new Error("missing channel name");const i="".concat(e);if("__proto__"===i)throw new Error("illegal channel name: ".concat(i));if(c.has(i))throw new Error("duplicate channel: ".concat(i));return c.add(i),!0})),this.dx=+a||0,this.dy=+s||0,this.clip=function(t){if(!0===t)return"frame";if(null==t||!1===t)return!1;throw new Error("invalid clip method: ".concat(t))}(l)}initialize(t,e){let n=qo(this.data);void 0===t&&null!=n&&(t=[Jo(n)]),null!=this.transform&&(({facets:t,data:n}=this.transform(n,t)),n=qo(n));const r=function(t,e){const n={};for(const r of t)n[r.name]=Iu(e,r);return n}(this.channels,n);return null!=this.sort&&function(t,e,n,r){const{reverse:i,reduce:o=!0,limit:a}=r;for(const s in r){if(!bs.has(s))continue;let{value:l,reverse:u=i,reduce:c=o,limit:f=a}=sa(r[s]);if(void 0===u&&(u="width"===l||"height"===l),null==c||!1===c)continue;const d=$u(t,s)||e&&$u(e,s);if(!d)throw new Error("missing channel for scale: ".concat(s));const h=d.value,[p=0,m=1/0]=la(f)?f:f<0?[f]:[0,f];if(null==l)d.domain=()=>{let t=h;return u&&(t=t.slice().reverse()),0===p&&m===1/0||(t=t.slice(p,m)),t};else{const e="data"===l?n:"height"===l?Hu(t,"y1","y2"):"width"===l?Hu(t,"x1","x2"):Zu(t,l,"y"===l?"y2":"x"===l?"x2":void 0),r=ku(!0===c?"max":c,e);d.domain=()=>{let t=g(Jo(h),(t=>r.reduce(t,e)),(t=>h[t]));return t=(0,v.ZP)(t,u?Vu:Yu),0===p&&m===1/0||(t=t.slice(p,m)),t.map(Oo)}}}}(r,e,n,this.sort),{data:n,facets:t,channels:r}}filter(t,e,n){for(const r in e){const{filter:i=Fa}=e[r];if(null!==i){const e=n[r];t=t.filter((t=>i(e[t])))}}return t}plot(){let{marks:t=[],...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rc({...e,marks:[...t,this]})}}function oc(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.plot=ic.prototype.plot,e}function ac(t){return"function"==typeof(null===t||void 0===t?void 0:t.render)?t:new sc(t)}class sc extends ic{constructor(t){if(super(),null!=t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");this.render=t}}render(){}}function lc(t,e){for(const r in t){const i=t[r],{scale:o}=i;if(null!=o){var n;const{percent:t,interval:r,transform:a=(t?t=>100*t:null===(n=Rs(r))||void 0===n?void 0:n.floor)}=e[o]||{};null!=a&&(i.value=Io(i.value,a))}}return t}function uc(t){for(const e in t){const n=t[e];let{scale:r}=n;if(!0===r){switch(e){case"fill":case"stroke":r="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":r="opacity";break;default:r=bs.has(e)?e:null}n.scale=r}}}function cc(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Do;for(const{channels:r}of e.values())for(const e in r){const i=r[e],{scale:o}=i;if(null!=o&&n(o)){const e=t.get(o);void 0!==e?e.push(i):t.set(o,[i])}}return t}function fc(t){return void 0===t||void 0===t.label?t:Object.assign(Object.create(t),{label:void 0})}class dc{constructor(){this._=new d.L}has(t){return this._.has(t)}get(t){return this._.get(t)}set(t,e){return this._.set(t,e),this}}class hc extends dc{has(t){let[e,n]=t;const r=super.get(e);return!!r&&r.has(n)}get(t){let[e,n]=t;const r=super.get(e);return r&&r.get(n)}set(t,e){let[n,r]=t;const i=super.get(n);return i?i.set(r,e):super.set(n,new d.L([[r,e]])),this}}const pc=new Map([["basis",Ki.ZP],["basis-closed",Qi.Z],["basis-open",Ji.Z],["bundle",eo.Z],["bump-x",function(t){return new to(t,!0)}],["bump-y",function(t){return new to(t,!1)}],["cardinal",io.ZP],["cardinal-closed",no.Z],["cardinal-open",ro.Z],["catmull-rom",so.Z],["catmull-rom-closed",oo.Z],["catmull-rom-open",ao.Z],["linear",uo.Z],["linear-closed",lo.Z],["monotone-x",co.Z],["monotone-y",co.s],["natural",fo.Z],["step",ho.ZP],["step-after",ho.cD],["step-before",ho.RN]]);function mc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uo.Z,e=arguments.length>1?arguments[1]:void 0;if("function"==typeof t)return t;const n=pc.get("".concat(t).toLowerCase());if(!n)throw new Error("unknown curve: ".concat(t));if(void 0!==e){if("beta"in n)return n.beta(e);if("tension"in n)return n.tension(e);if("alpha"in n)return n.alpha(e)}return n}function gc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{y:"count"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};[t,e]=kc(t,e);const{x:n,y:r}=e;return wc(Ac(n,e,Co),null,null,r,t,Ns(e))}function yc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:"count"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};[t,e]=kc(t,e);const{x:n,y:r}=e;return wc(null,Ac(r,e,Co),n,null,t,Os(e))}function vc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fill:"count"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};[t,e]=kc(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=Ac(e,t),n=Ac(n,t),[e.value,n.value]=Xo(e.value,n.value),{x:e,y:n}}(e);return wc(n,r,null,null,t,Ns(Os(e)))}function bc(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return null==(null===n||void 0===n?void 0:n.interval)?n:t({[e]:void 0===(null===n||void 0===n?void 0:n.reduce)?Su:n.reduce,filter:null},n)}function xc(t){return bc(gc,"y",t)}function _c(t){return bc(yc,"x",t)}function wc(t,e,n,r){let{data:i=Cu,filter:o=Tu,sort:a,reverse:s,...l}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};t=Ec(t),e=Ec(e),l=bu(l,u),i=ku(i,Co),a=null==a?void 0:xu("sort",a,u),o=null==o?void 0:_u("filter",o,u),null!=n&&vu(l,"x","x1","x2")&&(n=null),null!=r&&vu(l,"y","y1","y2")&&(r=null);const[c,f]=ia(t),[d,h]=ia(t),[p,m]=ia(e),[g,y]=ia(e),[v,b]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[x,_]=ia(v),{x:w,y:k,z:A,fill:E,stroke:M,x1:C,x2:S,y1:D,y2:F,domain:T,cumulative:N,thresholds:O,interval:z,...R}=u,[P,B]=ia(A),[L]=Bo(E),[j]=Bo(M),[U,q]=ia(L),[I,W]=ia(j);return{..."z"in u&&{z:P||A},..."fill"in u&&{fill:U||E},..."stroke"in u&&{stroke:I||M},...Kl(R,((n,r)=>{const u=Ao(n,v),c=Ao(n,A),d=Ao(n,L),p=Ao(n,j),g=Au(l,{z:c,fill:d,stroke:p}),b=[],x=[],w=u&&_([]),k=c&&B([]),E=d&&q([]),M=p&&W([]),C=t?t(n):[[,,t=>t]],S=e?e(n):[[,,t=>t]],D=t&&f([]),F=t&&h([]),T=e&&m([]),N=e&&y([]);let O=0;for(const t of l)t.initialize(n);a&&a.initialize(n),o&&o.initialize(n);for(const t of r){const e=[];for(const n of l)n.scope("facet",t);a&&a.scope("facet",t),o&&o.scope("facet",t);for(const[r,s]of wu(t,g))for(const[t,f]of wu(s,u))for(const[s,h,m]of C){const y=m(f);for(const[f,m,v]of S){const b={x1:s,x2:h,y1:f,y2:m},_=v(y);if(!o||o.reduce(_,b)){e.push(O++),x.push(i.reduce(_,n,b)),u&&w.push(t),c&&k.push(g===c?r:c[_[0]]),d&&E.push(g===d?r:d[_[0]]),p&&M.push(g===p?r:p[_[0]]),D&&(D.push(s),F.push(h)),T&&(T.push(f),N.push(m));for(const t of l)t.reduce(_,b);a&&a.reduce(_)}}}b.push(e)}return Eu(b,a,s),{data:x,facets:b}})),...!vu(l,"x")&&(c?{x1:c,x2:d,x:aa(c,d)}:{x:w,x1:C,x2:S}),...!vu(l,"y")&&(p?{y1:p,y2:g,y:aa(p,g)}:{y:k,y1:D,y2:F}),...x&&{[b]:x},...Object.fromEntries(l.map((t=>{let{name:e,output:n}=t;return[e,n]})))}}function kc(t,e){let{cumulative:n,domain:r,thresholds:i,interval:o,...a}=t;return[a,{cumulative:n,domain:r,thresholds:i,interval:o,...e}]}function Ac(t,e,n){let{cumulative:r,domain:i,thresholds:o,interval:a}=e;return void 0===(t={...sa(t)}).domain&&(t.domain=i),void 0===t.cumulative&&(t.cumulative=r),void 0===t.thresholds&&(t.thresholds=o),void 0===t.interval&&(t.interval=a),void 0===t.value&&(t.value=n),t.thresholds=function(t,e){if(void 0===t)return void 0===e?Mc:function(t){if(!Cc(t=Rs(t)))throw new Error("invalid interval: ".concat(t));return t}(e);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return S;case"scott":return D;case"sturges":return M;case"auto":return Mc}throw new Error("invalid thresholds: ".concat(t))}return t}(t.thresholds,t.interval),t}function Ec(t){if(null==t)return;const{value:e,cumulative:n,domain:r=f,thresholds:i}=t,o=t=>{let o=Ao(t,e,Array);const a=function(){var t=h,e=f,n=M;function r(r){Array.isArray(r)||(r=Array.from(r));var i,o,a,s=r.length,l=new Array(s);for(i=0;i<s;++i)l[i]=t(r[i],i,r);var u=e(l),c=u[0],d=u[1],h=n(l,c,d);if(!Array.isArray(h)){const t=d,n=+h;if(e===f&&([c,d]=E(c,d,n)),(h=(0,A.ZP)(c,d,n))[0]<=c&&(a=(0,A.G9)(c,d,n)),h[h.length-1]>=d)if(t>=d&&e===f){const t=(0,A.G9)(c,d,n);isFinite(t)&&(t>0?d=(Math.floor(d/t)+1)*t:t<0&&(d=(Math.ceil(d*-t)+1)/-t))}else h.pop()}for(var p=h.length,m=0,g=p;h[m]<=c;)++m;for(;h[g-1]>d;)--g;(m||g<p)&&(h=h.slice(m,g),p=g-m);var y,v=new Array(p+1);for(i=0;i<=p;++i)(y=v[i]=[]).x0=i>0?h[i-1]:c,y.x1=i<p?h[i]:d;if(isFinite(a)){if(a>0)for(i=0;i<s;++i)null!=(o=l[i])&&c<=o&&o<=d&&v[Math.min(p,Math.floor((o-c)/a))].push(r[i]);else if(a<0)for(i=0;i<s;++i)if(null!=(o=l[i])&&c<=o&&o<=d){const t=Math.floor((c-o)*a);v[Math.min(p,t+(h[t]<=o))].push(r[i])}}else for(i=0;i<s;++i)null!=(o=l[i])&&c<=o&&o<=d&&v[(0,w.ZP)(h,o,0,p)].push(r[i]);return v}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:k(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:k([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:k(Array.isArray(t)?_.call(t):t),r):n},r}().value((t=>o[t]));if(fa(o)||function(t){return Cc(t)&&"function"==typeof t&&t()instanceof Date}(s=i)||la(s)&&fa(s)){o=o.map($l);let[t,e]="function"==typeof r?r(o):r,n="function"!=typeof i||Cc(i)?i:i(o,t,e);"number"==typeof n&&(n=(0,po.jo)(t,e,n)),Cc(n)&&(r===f&&(t=n.floor(t),e=n.ceil(new Date(+e+1))),n=n.range(t,e)),a.thresholds(n).domain([t,e])}else{o=o.map(Wl);let t=r,e=i;if(Cc(e)){let[n,r]="function"==typeof t?t(o):t;t===f&&(n=e.floor(n),r=e.offset(e.floor(r)),t=[n,r]),e=e.range(n,r)}a.thresholds(e).domain(t)}var s;let l=a(Jo(t)).map(Sc);return n&&(l=(n<0?l.reverse():l).map(Dc)),l.map(Fc)};return o.label=oa(e),o}function Mc(t,e,n){return Math.min(200,D(t,e,n))}function Cc(t){return!!t&&"function"==typeof t.range}function Sc(t){return[t,new Set(t)]}function Dc(t,e,n){let[r]=t;return[r,{get size(){for(let t=0;t<=e;++t)if(n[t][1].size)return 1;return 0},has(t){for(let r=0;r<=e;++r)if(n[r][1].has(t))return!0;return!1}}]}function Fc(t){let[{x0:e,x1:n},r]=t;return[e,n,r.size?t=>t.filter(r.has,r):Tc]}function Tc(){return new Uint32Array(0)}function Nc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{x:e,x1:n,x2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,x:Co}:t}function Oc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{y:e,y1:n,y2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,y:Co}:t}function zc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=Ic(t));const{y1:n,y:r=n,x:i,...o}=e,[a,s,l,u]=Wc(r,i,"x",t,o);return{...a,y1:n,y:s,x1:l,x2:u,x:aa(l,u)}}function Rc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=Ic(t));const{y1:n,y:r=n,x:i}=e,[o,a,s]=Wc(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}}function Pc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=Ic(t));const{y1:n,y:r=n,x:i}=e,[o,a,,s]=Wc(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}}function Bc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=Ic(t));const{x1:n,x:r=n,y:i,...o}=e,[a,s,l,u]=Wc(r,i,"y",t,o);return{...a,x1:n,x:s,y1:l,y2:u,y:aa(l,u)}}function Lc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=Ic(t));const{x1:n,x:r=n,y:i}=e,[o,a,s]=Wc(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}}function jc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=Ic(t));const{x1:n,x:r=n,y:i}=e,[o,a,,s]=Wc(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}}function Uc(){let{x:t,x1:e,x2:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===e&&void 0===n?zc({x:t,...r}):([e,n]=Go(t,e,n),{...r,x1:e,x2:n})}function qc(){let{y:t,y1:e,y2:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===e&&void 0===n?Bc({y:t,...r}):([e,n]=Go(t,e,n),{...r,y1:e,y2:n})}function Ic(t){const{offset:e,order:n,reverse:r,...i}=t;return[{offset:e,order:n,reverse:r},i]}function Wc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:So,n=arguments.length>2?arguments[2]:void 0,{offset:r,order:i,reverse:o}=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const s=Qo(a),[l,u]=ia(t),[c,f]=ra(e),[d,h]=ra(e);return r=function(t){if(null!=t){if("function"==typeof t)return t;switch("".concat(t).toLowerCase()){case"expand":case"normalize":return Hc;case"center":case"silhouette":return Zc;case"wiggle":return Yc}throw new Error("unknown offset: ".concat(t))}}(r),i=function(t,e,n){if(void 0===t&&e===Yc)return tf;if(null!=t){if("string"==typeof t){switch(t.toLowerCase()){case"value":case n:return Xc;case"z":return Qc;case"sum":return Jc;case"appearance":return Kc;case"inside-out":return tf}return ef(Eo(t))}if("function"==typeof t)return ef(t);if(Array.isArray(t))return r=t,(t,e,n,i)=>nf(i,r);var r;throw new Error("invalid order: ".concat(t))}}(i,r,n),[Kl(a,((n,a)=>{const l=null==t?void 0:u(Ao(n,t)),c=Ao(n,e,Float64Array),d=Ao(n,s),m=i&&i(n,l,c,d),g=n.length,y=f(new Float64Array(g)),v=h(new Float64Array(g)),b=[];for(const t of a){const e=l?Array.from(p(t,(t=>l[t])).values()):[t];m&&rf(e,m);for(const t of e){let e=0,n=0;o&&t.reverse();for(const r of t){const t=c[r];t<0?e=v[r]=(y[r]=e)+t:t>0?n=v[r]=(y[r]=n)+t:v[r]=y[r]=n}}b.push(e)}return r&&r(b,y,v,d),{data:n,facets:a}})),l,c,d]}function $c(t,e){let n=0,r=0;for(const i of t){const t=e[i];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function Hc(t,e,n){for(const r of t)for(const t of r){const[r,i]=$c(t,n);for(const o of t){const t=1/(i-r||1);e[o]=t*(e[o]-r),n[o]=t*(n[o]-r)}}}function Zc(t,e,n){for(const r of t){for(const t of r){const[r,i]=$c(t,n);for(const o of t){const t=(i+r)/2;e[o]-=t,n[o]-=t}}Vc(r,e,n)}Gc(t,e,n)}function Yc(t,e,n,r){for(const i of t){const t=new d.L;let o=0;for(const a of i){let i=-1;const s=a.map((t=>Math.abs(n[t]-e[t]))),u=a.map((o=>{i=r?r[o]:++i;const a=n[o]-e[o],s=t.has(i)?a-t.get(i):0;return t.set(i,a),s})),c=[0,...l(u)];for(const t of a)e[t]+=o,n[t]+=o;const f=(0,q.Z)(s);f&&(o-=(0,q.Z)(s,((t,e)=>(u[e]/2+c[e])*t))/f)}Vc(i,e,n)}Gc(t,e,n)}function Vc(t,e,n){const r=(0,z.Z)(t,(t=>(0,z.Z)(t,(t=>e[t]))));for(const i of t)for(const t of i)e[t]-=r,n[t]-=r}function Gc(t,e,n){const r=t.length;if(1===r)return;const i=t.map((t=>t.flat())),o=i.map((t=>((0,z.Z)(t,(t=>e[t]))+(0,F.Z)(t,(t=>n[t])))/2)),a=(0,z.Z)(o);for(let s=0;s<r;s++){const t=a-o[s];for(const r of i[s])e[r]+=t,n[r]+=t}}function Xc(t,e,n){return n}function Qc(t,e,n,r){return r}function Jc(t,e,n,r){return nf(r,b(Jo(t),(t=>(0,q.Z)(t,(t=>n[t]))),(t=>r[t])))}function Kc(t,e,n,r){return nf(r,b(Jo(t),(t=>e[U(t,(t=>n[t]))]),(t=>r[t])))}function tf(t,e,n,r){const i=Jo(t),o=b(i,(t=>e[U(t,(t=>n[t]))]),(t=>r[t])),a=g(i,(t=>(0,q.Z)(t,(t=>n[t]))),(t=>r[t])),s=[],l=[];let u=0;for(const c of o)u<0?(u+=a.get(c),s.push(c)):(u-=a.get(c),l.push(c));return nf(r,l.reverse().concat(s))}function ef(t){return e=>Ao(e,t)}function nf(t,e){return e=new d.L(e.map(((t,e)=>[t,e]))),t.map((t=>e.get(t)))}function rf(t,e){for(const n of t)n.sort(((t,n)=>Ta(e[t],e[n])))}const of={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class af extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x1:n,y1:r,x2:i,y2:o,z:a,curve:s,tension:l}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"y1",value:r,scale:"y"},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0},{name:"z",value:Qo(e),optional:!0}],e,of),this.z=a,this.curve=mc(s,l)}filter(t){return t}render(t,e,n,r,i){const{x1:o,y1:a,x2:s=o,y2:l=a}=n;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e,0,0).call((e=>e.selectAll().data(Ya(t,[o,a,s,l],this,n)).enter().append("path").call(Ga,this).call(Ha,this,n).attr("d",(0,Ri.Z)().curve(this.curve).defined((t=>t>=0)).x0((t=>o[t])).y0((t=>a[t])).x1((t=>s[t])).y1((t=>l[t]))))).node()}}function sf(t,e){return void 0===e?uf(t,{x:Oo,y:zo}):new af(t,e)}function lf(t,e){const{y:n=Mo,...r}=_c(e);return new af(t,Uc(Nc({...r,y1:n,y2:void 0})))}function uf(t,e){const{x:n=Mo,...r}=xc(e);return new af(t,qc(Oc({...r,x1:n,x2:void 0})))}function cf(t){let{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:i=e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.markerStart=ff(n),t.markerMid=ff(r),t.markerEnd=ff(i)}function ff(t){if(null==t||!1===t)return null;if(!0===t)return pf;if("function"==typeof t)return t;switch("".concat(t).toLowerCase()){case"none":return null;case"arrow":return df;case"dot":return hf;case"circle":case"circle-fill":return pf;case"circle-stroke":return mf}throw new Error("invalid marker: ".concat(t))}function df(t,e){return vo("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function hf(t,e){return vo("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function pf(t,e){return vo("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function mf(t,e){return vo("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let gf=0;function yf(t,e){let{stroke:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return bf(t,e,n&&(t=>n[t]))}function vf(t,e){let{stroke:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return bf(t,e,n&&(t=>{let[e]=t;return n[e]}))}function bf(t,e){let{markerStart:n,markerMid:r,markerEnd:i,stroke:o}=e,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>o;const s=new Map;function l(t){return function(e){const n=a(e);let r=s.get(t);r||s.set(t,r=new Map);let i=r.get(n);if(!i){const e={document:this.ownerDocument},o=this.parentNode.insertBefore(t(n,e),this),a="plot-marker-"+ ++gf;o.setAttribute("id",a),r.set(n,i="url(#".concat(a,")"))}return i}}n&&t.attr("marker-start",l(n)),r&&t.attr("marker-mid",l(r)),i&&t.attr("marker-end",l(i))}const xf={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class _f extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x1:n,y1:r,x2:i,y2:o,curve:a,tension:s}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"y1",value:r,scale:"y"},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0}],e,xf),this.curve=mc(a,s),cf(this,e)}render(t,e,n,r,i){const{x1:o,y1:a,x2:s=o,y2:l=a}=n,{curve:u}=this;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(Ga,this).attr("d",(t=>{const e=(0,Ln.ET)(),n=u(e);return n.lineStart(),n.point(o[t],a[t]),n.point(s[t],l[t]),n.lineEnd(),e})).call($a,this,n).call(yf,this,n))).node()}}function wf(t){let{x:e,x1:n,x2:r,y:i,y1:o,y2:a,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[n,r]=kf(e,n,r),[o,a]=kf(i,o,a),new _f(t,{...s,x1:n,x2:r,y1:o,y2:a})}function kf(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Af={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class Ef extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x1:n,y1:r,x2:i,y2:o,bend:a=0,headAngle:s=60,headLength:l=8,inset:u=0,insetStart:c=u,insetEnd:f=u}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"y1",value:r,scale:"y"},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0}],e,Af),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+s,this.headLength=+l,this.insetStart=+c,this.insetEnd=+f}render(t,e,n,r,i){const{x1:o,y1:a,x2:s=o,y2:l=a,SW:u}=n,{strokeWidth:c,bend:f,headAngle:d,headLength:h,insetStart:p,insetEnd:m}=this,g=u?t=>u[t]:Ro(void 0===c?1:c),y=f*Da,v=d*Da/2,b=h/1.5;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(Ga,this).attr("d",(t=>{let e=o[t],n=a[t],r=s[t],i=l[t];const u=Math.hypot(r-e,i-n);if(u<=p+m)return null;let c=Math.atan2(i-n,r-e);const f=Math.min(b*g(t),u/3),d=Math.hypot(u/Math.tan(y),u)/2;if(p||m)if(d<1e5){const t=Math.sign(y),[o,a]=function(t,e,n,r){let[i,o]=t,[a,s]=e;const l=a-i,u=s-o,c=Math.hypot(l,u),f=r*Math.sqrt(n*n-c*c/4)/c;return[(i+a)/2-u*f,(o+s)/2+l*f]}([e,n],[r,i],d,t);if(p&&([e,n]=Mf([o,a,d],[e,n,p],-t*Math.sign(p))),m){const[e,n]=Mf([o,a,d],[r,i,m],t*Math.sign(m));c+=Math.atan2(n-a,e-o)-Math.atan2(i-a,r-o),r=e,i=n}}else{const t=r-e,o=i-n,a=Math.hypot(t,o);p&&(e+=t/a*p,n+=o/a*p),m&&(r-=t/a*m,i-=o/a*m)}const h=c+y,x=h+v,_=h-v,w=r-f*Math.cos(x),k=i-f*Math.sin(x),A=r-f*Math.cos(_),E=i-f*Math.sin(_);return"M".concat(e,",").concat(n).concat(d<1e5?"A".concat(d,",").concat(d," 0,0,").concat(y>0?1:0," "):"L").concat(r,",").concat(i,"M").concat(w,",").concat(k,"L").concat(r,",").concat(i,"L").concat(A,",").concat(E)})).call($a,this,n))).node()}}function Mf(t,e,n){let[r,i,o]=t,[a,s,l]=e;const u=a-r,c=s-i,f=Math.hypot(u,c),d=(u*u+c*c-l*l+o*o)/(2*f),h=n*Math.sqrt(o*o-d*d);return[r+(u*d+c*h)/f,i+(c*d-u*h)/f]}function Cf(t){let{x:e,x1:n,x2:r,y:i,y1:o,y2:a,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[n,r]=kf(e,n,r),[o,a]=kf(i,o,a),new Ef(t,{...s,x1:n,x2:r,y1:o,y2:a})}class Sf extends ic{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(t,e,n,arguments.length>3?arguments[3]:void 0);const{inset:r=0,insetTop:i=r,insetRight:o=r,insetBottom:a=r,insetLeft:s=r,rx:l,ry:u}=n;this.insetTop=To(i),this.insetRight=To(o),this.insetBottom=To(a),this.insetLeft=To(s),this.rx=Ka(l,"auto"),this.ry=Ka(u,"auto")}render(t,e,n,r,i){const{rx:o,ry:a}=this;return vo("svg:g",i).call(Va,this,e,r).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("rect").call(Ga,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(Qa,"rx",o).call(Qa,"ry",a).call($a,this,n))).node()}_x(t,e,n){let{x:r}=e,{marginLeft:i}=n;const{insetLeft:o}=this;return r?t=>r[t]+o:i+o}_y(t,e,n){let{y:r}=e,{marginTop:i}=n;const{insetTop:o}=this;return r?t=>r[t]+o:i+o}_width(t,e,n){let{x:r}=t,{x:i}=e,{marginRight:o,marginLeft:a,width:s}=n;const{insetLeft:l,insetRight:u}=this,c=i&&r?r.bandwidth():s-o-a;return Math.max(0,c-l-u)}_height(t,e,n){let{y:r}=t,{y:i}=e,{marginTop:o,marginBottom:a,height:s}=n;const{insetTop:l,insetBottom:u}=this,c=i&&r?r.bandwidth():s-o-a;return Math.max(0,c-l-u)}}const Df={ariaLabel:"bar"};class Ff extends Sf{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x1:n,x2:r,y:i}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"x2",value:r,scale:"x"},{name:"y",value:i,scale:"y",type:"band",optional:!0}],e,Df)}_transform(t,e,n){let{x:r}=n;t.call(Ja,e,{x:r},0,0)}_x(t,e,n){let{x:r}=t,{x1:i,x2:o}=e,{marginLeft:a}=n;const{insetLeft:s}=this;return Ll(r)?a+s:t=>Math.min(i[t],o[t])+s}_width(t,e,n){let{x:r}=t,{x1:i,x2:o}=e,{marginRight:a,marginLeft:s,width:l}=n;const{insetLeft:u,insetRight:c}=this;return Ll(r)?l-a-s-u-c:t=>Math.max(0,Math.abs(o[t]-i[t])-u-c)}}class Tf extends Sf{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y1:r,y2:i}=e;super(t,[{name:"y1",value:r,scale:"y"},{name:"y2",value:i,scale:"y"},{name:"x",value:n,scale:"x",type:"band",optional:!0}],e,Df)}_transform(t,e,n){let{y:r}=n;t.call(Ja,e,{y:r},0,0)}_y(t,e,n){let{y:r}=t,{y1:i,y2:o}=e,{marginTop:a}=n;const{insetTop:s}=this;return Ll(r)?a+s:t=>Math.min(i[t],o[t])+s}_height(t,e,n){let{y:r}=t,{y1:i,y2:o}=e,{marginTop:a,marginBottom:s,height:l}=n;const{insetTop:u,insetBottom:c}=this;return Ll(r)?l-a-s-u-c:t=>Math.max(0,Math.abs(o[t]-i[t])-u-c)}}function Nf(t){return new Ff(t,Uc(qs(Nc(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{y:Mo,x2:Co}))))}function Of(t){return new Tf(t,qc(Is(Oc(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:Mo,y2:Co}))))}function zf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Pf(Object.fromEntries(["x","x1","x2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Rf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Pf(Object.fromEntries(["y","y1","y2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Pf(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Qo(e),r=Object.entries(t).map((t=>{let[n,r]=t;const i=na(n,e);if(null==i)throw new Error("missing channel: ".concat(n));const[o,a]=ra(i);return{key:n,input:i,output:o,setOutput:a,map:Bf(r)}}));return{...Kl(e,((t,e)=>{const i=Ao(t,n),o=r.map((e=>{let{input:n}=e;return Ao(t,n)})),a=r.map((e=>{let{setOutput:n}=e;return n(new Array(t.length))}));for(const n of e)for(const t of i?p(n,(t=>i[t])).values():[n])r.forEach(((e,n)=>{let{map:r}=e;return r.map(t,o[n],a[n])}));return{data:t,facets:e}})),...Object.fromEntries(r.map((t=>{let{key:e,output:n}=t;return[e,n]})))}}function Bf(t){if(t&&"function"==typeof t.map)return t;if("function"==typeof t)return jf(t);switch("".concat(t).toLowerCase()){case"cumsum":return Uf;case"rank":return jf(j);case"quantile":return jf(Lf)}throw new Error("invalid map: ".concat(t))}function Lf(t){const e=i(t)-1;return j(t).map((t=>t/e))}function jf(t){return{map(e,n,r){const i=t(ta(n,e));if(i.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,o=e.length;t<o;++t)r[e[t]]=i[t]}}}const Uf={map(t,e,n){let r=0;for(const i of t)n[i]=r+=e[i]}},qf={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};class If extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,r:i,rotate:o,symbol:a=ji.Z,frameAnchor:s}=e,[l,u]=Lo(o,0),[c,f]=function(t){if(null==t||gl(t))return[void 0,t];if("string"==typeof t){const e=ml.get("".concat(t).toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(a),[d,h]=Lo(i,null==c?3:4.5);super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"r",value:d,scale:"r",filter:Ra,optional:!0},{name:"rotate",value:l,optional:!0},{name:"symbol",value:c,scale:"symbol",optional:!0}],void 0===e.sort&&void 0===e.reverse?uu({channel:"r",order:"descending"},e):e,qf),this.r=h,this.rotate=u,this.symbol=f,this.frameAnchor=ba(s);const{channels:p}=this,m=p.find((t=>{let{scale:e}=t;return"symbol"===e}));if(m){const t=p.find((t=>{let{name:e}=t;return"fill"===e})),e=p.find((t=>{let{name:e}=t;return"stroke"===e}));m.hint={fill:t?t.value===m.value?"color":"currentColor":this.fill,stroke:e?e.value===m.value?"color":"currentColor":this.stroke}}}render(t,e,n,r,i){const{x:o,y:a,r:s,rotate:l,symbol:u}=n,[c,f]=is(this,r),d=this.symbol===ji.Z;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(t).enter().append(d?"circle":"path").call(Ga,this).call(d?t=>{t.attr("cx",o?t=>o[t]:c).attr("cy",a?t=>a[t]:f).attr("r",s?t=>s[t]:this.r)}:t=>{const e=o&&a?t=>"translate(".concat(o[t],",").concat(a[t],")"):o?t=>"translate(".concat(o[t],",").concat(f,")"):a?t=>"translate(".concat(c,",").concat(a[t],")"):()=>"translate(".concat(c,",").concat(f,")");t.attr("transform",l?t=>"".concat(e(t)," rotate(").concat(l[t],")"):this.rotate?t=>"".concat(e(t)," rotate(").concat(this.rotate,")"):e).attr("d",(t=>{const e=(0,Ln.ET)(),n=s?s[t]:this.r;return(u?u[t]:this.symbol).draw(e,n*n*Math.PI),e}))}).call($a,this,n))).node()}}function Wf(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===r.frameAnchor&&([e,n]=Xo(e,n)),new If(t,{...r,x:e,y:n})}function $f(t){let{x:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new If(t,$s({...n,x:e}))}function Hf(t){let{y:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new If(t,Ws({...n,y:e}))}function Zf(t,e){return Wf(t,{...e,symbol:"circle"})}function Yf(t,e){return Wf(t,{...e,symbol:"hexagon"})}const Vf={ariaLabel:"rule",fill:null,stroke:"currentColor"};class Gf extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y1:r,y2:i,inset:o=0,insetTop:a=o,insetBottom:s=o}=e;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y1",value:r,scale:"y",optional:!0},{name:"y2",value:i,scale:"y",optional:!0}],e,Vf),this.insetTop=To(a),this.insetBottom=To(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y1:l,y2:u}=n,{width:c,height:f,marginTop:d,marginRight:h,marginLeft:p,marginBottom:m}=r,{insetTop:g,insetBottom:y}=this;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,{x:s&&o},ja,0).call((e=>e.selectAll().data(t).enter().append("line").call(Ga,this).attr("x1",s?t=>s[t]:(p+c-h)/2).attr("x2",s?t=>s[t]:(p+c-h)/2).attr("y1",l&&!Ll(a)?t=>l[t]+g:d+g).attr("y2",u&&!Ll(a)?a.bandwidth?t=>u[t]+a.bandwidth()-y:t=>u[t]-y:f-m-y).call($a,this,n))).node()}}class Xf extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x1:n,x2:r,y:i,inset:o=0,insetRight:a=o,insetLeft:s=o}=e;super(t,[{name:"y",value:i,scale:"y",optional:!0},{name:"x1",value:n,scale:"x",optional:!0},{name:"x2",value:r,scale:"x",optional:!0}],e,Vf),this.insetRight=To(a),this.insetLeft=To(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{y:s,x1:l,x2:u}=n,{width:c,height:f,marginTop:d,marginRight:h,marginLeft:p,marginBottom:m}=r,{insetLeft:g,insetRight:y}=this;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,{y:s&&a},0,ja).call((e=>e.selectAll().data(t).enter().append("line").call(Ga,this).attr("x1",l&&!Ll(o)?t=>l[t]+g:p+g).attr("x2",u&&!Ll(o)?o.bandwidth?t=>u[t]+o.bandwidth()-y:t=>u[t]-y:c-h-y).attr("y1",s?t=>s[t]:(d+f-m)/2).attr("y2",s?t=>s[t]:(d+f-m)/2).call($a,this,n))).node()}}function Qf(t,e){let{x:n=Co,y:r,y1:i,y2:o,...a}=Is(e);return[i,o]=Kf(r,i,o),new Gf(t,{...a,x:n,y1:i,y2:o})}function Jf(t,e){let{y:n=Co,x:r,x1:i,x2:o,...a}=qs(e);return[i,o]=Kf(r,i,o),new Xf(t,{...a,y:n,x1:i,x2:o})}function Kf(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const td={ariaLabel:"tick",fill:null,stroke:"currentColor"};class ed extends ic{constructor(t,e,n){super(t,e,n,td)}render(t,e,n,r,i){return vo("svg:g",i).call(Va,this,e,r).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("line").call(Ga,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call($a,this,n))).node()}}class nd extends ed{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,inset:i=0,insetTop:o=i,insetBottom:a=i}=e;super(t,[{name:"x",value:n,scale:"x"},{name:"y",value:r,scale:"y",type:"band",optional:!0}],e),this.insetTop=To(o),this.insetBottom=To(a)}_transform(t,e,n){let{x:r}=n;t.call(Ja,e,{x:r},ja,0)}_x1(t,e){let{x:n}=e;return t=>n[t]}_x2(t,e){let{x:n}=e;return t=>n[t]}_y1(t,e,n){let{y:r}=t,{y:i}=e,{marginTop:o}=n;const{insetTop:a}=this;return i&&r?t=>i[t]+a:o+a}_y2(t,e,n){let{y:r}=t,{y:i}=e,{height:o,marginBottom:a}=n;const{insetBottom:s}=this;return i&&r?t=>i[t]+r.bandwidth()-s:o-a-s}}class rd extends ed{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,inset:i=0,insetRight:o=i,insetLeft:a=i}=e;super(t,[{name:"y",value:r,scale:"y"},{name:"x",value:n,scale:"x",type:"band",optional:!0}],e),this.insetRight=To(o),this.insetLeft=To(a)}_transform(t,e,n){let{y:r}=n;t.call(Ja,e,{y:r},0,ja)}_x1(t,e,n){let{x:r}=t,{x:i}=e,{marginLeft:o}=n;const{insetLeft:a}=this;return i&&r?t=>i[t]+a:o+a}_x2(t,e,n){let{x:r}=t,{x:i}=e,{width:o,marginRight:a}=n;const{insetRight:s}=this;return i&&r?t=>i[t]+r.bandwidth()-s:o-a-s}_y1(t,e){let{y:n}=e;return t=>n[t]}_y2(t,e){let{y:n}=e;return t=>n[t]}}function id(t){let{x:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new nd(t,{...n,x:e})}function od(t){let{y:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new rd(t,{...n,y:e})}function ad(t){let{x:e={transform:t=>t},y:n=null,fill:r="#ccc",fillOpacity:i,stroke:o="currentColor",strokeOpacity:a,strokeWidth:s=2,sort:l,...u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const c=null!=n?mu:hu;return oc(Jf(t,c({x1:ud,x2:cd},{x:e,y:n,stroke:o,strokeOpacity:a,...u})),Nf(t,c({x1:"p25",x2:"p75"},{x:e,y:n,fill:r,fillOpacity:i,...u})),id(t,c({x:"p50"},{x:e,y:n,stroke:o,strokeOpacity:a,strokeWidth:s,sort:l,...u})),Wf(t,Pf({x:ld},{x:e,y:n,z:n,stroke:o,strokeOpacity:a,...u})))}function sd(t){let{y:e={transform:t=>t},x:n=null,fill:r="#ccc",fillOpacity:i,stroke:o="currentColor",strokeOpacity:a,strokeWidth:s=2,sort:l,...u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const c=null!=n?pu:hu;return oc(Qf(t,c({y1:ud,y2:cd},{x:n,y:e,stroke:o,strokeOpacity:a,...u})),Of(t,c({y1:"p25",y2:"p75"},{x:n,y:e,fill:r,fillOpacity:i,...u})),od(t,c({y:"p50"},{x:n,y:e,stroke:o,strokeOpacity:a,strokeWidth:s,sort:l,...u})),Wf(t,Pf({y:ld},{x:n,y:e,z:n,stroke:o,strokeOpacity:a,...u})))}function ld(t){const e=ud(t),n=cd(t);return t.map((t=>t<e||t>n?t:NaN))}function ud(t,e){const n=2.5*fd(t,e)-1.5*dd(t,e);return(0,z.Z)(t,(t=>t>=n?t:NaN))}function cd(t,e){const n=2.5*dd(t,e)-1.5*fd(t,e);return(0,F.Z)(t,(t=>t<=n?t:NaN))}function fd(t,e){return(0,C.ZP)(t,.25,e)}function dd(t,e){return(0,C.ZP)(t,.75,e)}const hd={ariaLabel:"cell"};class pd extends Sf{constructor(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,[{name:"x",value:e,scale:"x",type:"band",optional:!0},{name:"y",value:n,scale:"y",type:"band",optional:!0}],r,hd)}_transform(t,e){t.call(Ja,e,{},0,0)}}function md(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[e,n]=Xo(e,n),new pd(t,{...r,x:e,y:n})}function gd(t){let{x:e=Mo,fill:n,stroke:r,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===n&&void 0===Bo(r)[0]&&(n=Co),new pd(t,{...i,x:e,fill:n,stroke:r})}function yd(t){let{y:e=Mo,fill:n,stroke:r,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===n&&void 0===Bo(r)[0]&&(n=Co),new pd(t,{...i,y:e,fill:n,stroke:r})}const vd={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},bd={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},xd={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},_d={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},wd={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class kd extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,z:i,curve:o,tension:a}=e;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"z",value:i,optional:!0}],e,vd),this.curve=mc(o,a),cf(this,e)}render(t,e,n,r,i){const{x:o,y:a,z:s}=n,{curve:l}=this,[u,c]=is(this,r),f=o?t=>o[t]:Ro(u),d=a?t=>a[t]:Ro(c),h=this;function m(t){let e=-1;const r=[],i={};for(const l in n)i[l]=[];const o=[],a=[],s=[],u=[];function c(l,c){l=t[l],c=t[c],r.push(++e),o[e]=f(l),s[e]=d(l),a[e]=f(c),u[e]=d(c);for(const t in n)i[t].push(n[t][c])}const{halfedges:p,hull:m,triangles:g}=Tn.Z.from(t,f,d);for(let n=0;n<p.length;++n){const t=p[n];t>n&&c(g[n],g[t])}for(let n=0;n<m.length;++n)c(m[n],m[(n+1)%m.length]);zi(this).selectAll().data(r).join("path").call(Ga,h).attr("d",(t=>{const e=(0,Ln.ET)(),n=l(e);return n.lineStart(),n.point(o[t],s[t]),n.point(a[t],u[t]),n.lineEnd(),e})).call($a,h,i).call(yf,h,i)}return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call(s?e=>e.selectAll().data(p(t,(t=>s[t])).values()).enter().append("g").each(m):e=>e.datum(t).each(m)).node()}}class Ad extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t=>{let{z:e}=t;return e};const{x:i,y:o}=e;super(t,[{name:"x",value:i,scale:"x",optional:!0},{name:"y",value:o,scale:"y",optional:!0},{name:"z",value:r(e),optional:!0}],e,n)}render(t,e,n,r,i){const{x:o,y:a,z:s}=n,[l,u]=is(this,r),c=o?t=>o[t]:Ro(l),f=a?t=>a[t]:Ro(u),d=this;function h(t){const e=Tn.Z.from(t,c,f);zi(this).append("path").datum(t[0]).call(Ga,d).attr("d",d._render(e,r)).call($a,d,n)}return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call(s?e=>e.selectAll().data(p(t,(t=>s[t])).values()).enter().append("g").each(h):e=>e.datum(t).each(h)).node()}}class Ed extends Ad{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},bd),this.fill="none"}_render(t){return t.render()}}class Md extends Ad{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},xd,Qo)}_render(t){return t.renderHull()}}class Cd extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,z:i}=e;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"z",value:i,optional:!0}],e,_d)}render(t,e,n,r,i){const{x:o,y:a,z:s}=n,[l,u]=is(this,r),c=o?t=>o[t]:Ro(l),f=a?t=>a[t]:Ro(u);function d(t){const e=Dd(Tn.Z.from(t,c,f),r);zi(this).selectAll().data(t).enter().append("path").call(Ga,this).attr("d",((t,n)=>e.renderCell(n))).call($a,this,n)}return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call(s?e=>e.selectAll().data(p(t,(t=>s[t])).values()).enter().append("g").each(d):e=>e.datum(t).each(d)).node()}}class Sd extends Ad{constructor(t,e){super(t,e,wd),this.fill="none"}_render(t,e){return Dd(t,e).render()}}function Dd(t,e){const{width:n,height:r,marginTop:i,marginRight:o,marginBottom:a,marginLeft:s}=e;return t.voronoi([s,i,n-o,r-a])}function Fd(t,e){let{x:n,y:r,...i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return[n,r]=Xo(n,r),new t(e,{...i,x:n,y:r})}function Td(t,e){return Fd(kd,t,e)}function Nd(t,e){return Fd(Ed,t,e)}function Od(t,e){return Fd(Md,t,e)}function zd(t,e){return Fd(Cd,t,e)}function Rd(t,e){return Fd(Sd,t,e)}const Pd={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Bd extends ic{constructor(t){let{x:e,y:n,z:r,weight:i,fill:o,stroke:a,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const l=Ud(o)&&(o="currentColor",!0),u=Ud(a)&&(a="currentColor",!0);super(t,[{name:"x",value:e,scale:"x",optional:!0},{name:"y",value:n,scale:"y",optional:!0},{name:"z",value:Qo({z:r,fill:o,stroke:a}),optional:!0},{name:"weight",value:i,optional:!0}],function(t,e,n,r){let{bandwidth:i,thresholds:o}=t;return i=void 0===i?20:+i,o=void 0===o?20:"function"==typeof(null===(r=o)||void 0===r?void 0:r[Symbol.iterator])?Il(o):+o,tu(t,(function(t,r,a,s,l){var u;const c=a.x?Il(Ao(a.x.value,s[a.x.scale]||Co)):null,f=a.y?Il(Ao(a.y.value,s[a.y.scale]||Co)):null,d=a.weight?Il(a.weight.value):null,h=null===(u=a.z)||void 0===u?void 0:u.value,{z:p}=this,[m,g]=is(this,l),{width:y,height:v}=l,b=Object.fromEntries(Object.entries(a).filter((t=>{let[e]=t;return!jd.has(e)})).map((t=>{let[e,n]=t;return[e,{...n,value:[]}]}))),x=e&&[],_=n&&[],w=function(){var t=Sn,e=Dn,n=Fn,r=960,i=500,o=20,a=2,s=3*o,l=r+2*s>>a,u=i+2*s>>a,c=gn(20);function f(r){var i=new Float32Array(l*u),c=Math.pow(2,-a),f=-1;for(const o of r){var d=(t(o,++f,r)+s)*c,h=(e(o,f,r)+s)*c,p=+n(o,f,r);if(p&&d>=0&&d<l&&h>=0&&h<u){var m=Math.floor(d),g=Math.floor(h),y=d-m-.5,v=h-g-.5;i[m+g*l]+=(1-y)*(1-v)*p,i[m+1+g*l]+=y*(1-v)*p,i[m+1+(g+1)*l]+=y*v*p,i[m+(g+1)*l]+=(1-y)*v*p}}return cn({data:i,width:l,height:u},o*c),i}function d(t){var e=f(t),n=c(e),r=Math.pow(2,2*a);return Array.isArray(n)||(n=(0,A.ZP)(Number.MIN_VALUE,(0,F.Z)(e)/r,n)),kn().size([l,u]).thresholds(n.map((t=>t*r)))(e).map(((t,e)=>(t.value=+n[e],h(t))))}function h(t){return t.coordinates.forEach(p),t}function p(t){t.forEach(m)}function m(t){t.forEach(g)}function g(t){t[0]=t[0]*Math.pow(2,a)-s,t[1]=t[1]*Math.pow(2,a)-s}function y(){return l=r+2*(s=3*o)>>a,u=i+2*s>>a,d}return d.contours=function(t){var e=f(t),n=kn().size([l,u]),r=Math.pow(2,2*a),i=t=>{t=+t;var i=h(n.contour(e,t*r));return i.value=t,i};return Object.defineProperty(i,"max",{get:()=>(0,F.Z)(e)/r}),i},d.x=function(e){return arguments.length?(t="function"==typeof e?e:gn(+e),d):t},d.y=function(t){return arguments.length?(e="function"==typeof t?t:gn(+t),d):e},d.weight=function(t){return arguments.length?(n="function"==typeof t?t:gn(+t),d):n},d.size=function(t){if(!arguments.length)return[r,i];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))throw new Error("invalid size");return r=e,i=n,y()},d.cellSize=function(t){if(!arguments.length)return 1<<a;if(!((t=+t)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(t)/Math.LN2),y()},d.thresholds=function(t){return arguments.length?(c="function"==typeof t?t:Array.isArray(t)?gn(mn.call(t)):gn(t),d):c},d.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=(Math.sqrt(4*t*t+1)-1)/2,y()},d}().x(c?t=>c[t]:m).y(f?t=>f[t]:g).weight(d?t=>d[t]:1).size([y,v]).bandwidth(i),k=[];for(const e of r){const t=[];k.push(t);for(const n of h?Za(e,h,p):[e]){const e=w.contours(n);t.push([n,e])}}let E=o;if(!$o(E)){let t=0;for(const e of k)for(const[,n]of e){const e=n.max;e>t&&(t=e)}E=Float64Array.from({length:o-1},((e,n)=>100*t*(n+1)/o))}const M=[],C=[];for(const e of k){const t=[];M.push(t);for(const[n,r]of e)for(const e of E){t.push(C.length),C.push(r(e/100)),x&&x.push(e),_&&_.push(e);for(const t in b)b[t].value.push(a[t].value[n[0]])}}return x&&x.push(0),_&&_.push(0),{data:t,facets:M,channels:{...b,...x&&{fill:{value:x,scale:"color"}},..._&&{stroke:{value:_,scale:"color"}},contours:{value:C}}}}))}({...s,fill:o,stroke:a},l,u),Pd),l&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=r}filter(t){return t}render(t,e,n,r,i){const{contours:o}=n,a=(0,On.Z)();return zi(oe("svg:g").call(document.documentElement)).call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(Ga,this).call($a,this,n).attr("d",(t=>a(o[t]))))).node()}}function Ld(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[e,n]=Xo(e,n),new Bd(t,{...r,x:e,y:n})}const jd=new Set(["x","y","z","weight"]);function Ud(t){return/^density$/i.test(t)}const qd={ariaLabel:"frame",fill:"none",stroke:"currentColor"};class Id extends ic{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,rx:a,ry:s}=t;super(void 0,void 0,t,qd),this.insetTop=To(n),this.insetRight=To(r),this.insetBottom=To(i),this.insetLeft=To(o),this.rx=To(a),this.ry=To(s)}render(t,e,n,r,i){const{marginTop:o,marginRight:a,marginBottom:s,marginLeft:l,width:u,height:c}=r,{insetTop:f,insetRight:d,insetBottom:h,insetLeft:p,rx:m,ry:g}=this;return vo("svg:rect",i).call(Va,this,e,r).call(Ga,this).call(Ja,this,{}).attr("x",l+p).attr("y",o+f).attr("width",u-l-a-p-d).attr("height",c-o-s-f-h).attr("rx",m).attr("ry",g).node()}}function Wd(t){return new Id(t)}const $d=.5,Hd=0;function Zd(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fill:"count"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{binWidth:n,...r}=e;n=void 0===n?20:To(n),t=bu(t,r);const{z:i,fill:o,stroke:a}=r;return void 0===a&&ya(o)&&vu(t,"fill")&&(r.stroke="none"),void 0===r.symbol&&(r.symbol="hexagon"),void 0!==r.r||vu(t,"r")||(r.r=n/2),tu(r,((e,r,o,a)=>{var s,l,u;let{x:c,y:f,z:d,fill:h,stroke:p,symbol:m}=o;if(void 0===c)throw new Error("missing channel: x");if(void 0===f)throw new Error("missing channel: y");c=Il(Ao(c.value,a[c.scale]||Co)),f=Il(Ao(f.value,a[f.scale]||Co)),d=d?d.value:Ao(e,i),h=null===(s=h)||void 0===s?void 0:s.value,p=null===(l=p)||void 0===l?void 0:l.value,m=null===(u=m)||void 0===u?void 0:u.value;const g=Au(t,{z:d,fill:h,stroke:p,symbol:m}),y=d&&[],v=h&&[],b=p&&[],x=m&&[],_=[],w=[],k=[];let A=-1;for(const n of t)n.initialize(e);for(const i of r){const e=[];for(const n of t)n.scope("facet",i);for(const[r,o]of wu(i,g))for(const i of Yd(o,c,f,n)){e.push(++A),w.push(i.x),k.push(i.y),d&&y.push(g===d?r:d[i[0]]),h&&v.push(g===h?r:h[i[0]]),p&&b.push(g===p?r:p[i[0]]),m&&x.push(g===m?r:m[i[0]]);for(const e of t)e.reduce(i)}_.push(e)}return{data:e,facets:_,channels:{x:{value:w},y:{value:k},...d&&{z:{value:y}},...h&&{fill:{value:v,scale:!0}},...p&&{stroke:{value:b,scale:!0}},...m&&{symbol:{value:x,scale:!0}},...Object.fromEntries(t.map((t=>{let{name:e,output:r}=t;return[e,{scale:!0,radius:"r"===e?n/2:void 0,value:r.transform()}]})))}}}))}function Yd(t,e,n,r){const i=r*(1.5/dl),o=new Map;for(const a of t){let t=e[a],s=n[a];if(isNaN(t)||isNaN(s))continue;let l=Math.round(s=(s-Hd)/i),u=Math.round(t=(t-$d)/r-(1&l)/2),c=s-l;if(3*Math.abs(c)>1){let e=t-u,n=u+(t<u?-1:1)/2,r=l+(s<l?-1:1),i=t-n,o=s-r;e*e+c*c>i*i+o*o&&(u=n+(1&l?1:-1)/2,l=r)}const f="".concat(u,",").concat(l);let d=o.get(f);void 0===d&&(o.set(f,d=[]),d.x=(u+(1&l)/2)*r+$d,d.y=l*i+Hd),d.push(a)}return o.values()}const Vd={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function Gd(t){return new Xd(t)}class Xd extends ic{constructor(){let{binWidth:t=20,clip:e=!0,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(void 0,void 0,{clip:e,...n},Vd),this.binWidth=To(t)}render(t,e,n,r,i){const{binWidth:o}=this,{marginTop:a,marginRight:s,marginBottom:l,marginLeft:u,width:c,height:f}=r,d=u-$d,h=c-s-$d,p=a-Hd,m=f-l-Hd,g=o/2,y=g*hl,v=y/2,b=2*g,x=1.5*y,_="m0,".concat(-y,"l").concat(g,",").concat(v,"v").concat(y,"l").concat(-g,",").concat(v),w=Math.floor(d/b),k=Math.ceil(h/b),A=Math.floor((p+v)/x),E=Math.ceil((m-v)/x)+1,M=[];for(let C=A;C<E;++C)for(let t=w;t<k;++t)M.push("M".concat(t*b+(1&C)*g,",").concat(C*x).concat(_));return vo("svg:g",i).call(Va,this,e,r).call((t=>t.append("path").call(Ga,this).call(Ja,this,{},ja+$d,ja+Hd).attr("d",M.join("")))).node()}}const Qd={ariaLabel:"image",fill:null,stroke:null};class Jd extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{x:n,y:r,width:i,height:o,src:a,preserveAspectRatio:s,crossOrigin:l,frameAnchor:u}=e;void 0===i&&void 0!==o?i=o:void 0===o&&void 0!==i&&(o=i);const[c,f]="string"==typeof(d=a)&&(function(t){return/^\.*\//.test(t)}(d)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(d))?[void 0,d]:[d,void 0];var d;const[h,p]=Lo(i,16),[m,g]=Lo(o,16);super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"width",value:h,filter:Ra,optional:!0},{name:"height",value:m,filter:Ra,optional:!0},{name:"src",value:c,optional:!0}],e,Qd),this.src=f,this.width=p,this.height=g,this.preserveAspectRatio=Ka(s,"xMidYMid"),this.crossOrigin=Fo(l),this.frameAnchor=ba(u)}render(t,e,n,r,i){const{x:o,y:a,width:s,height:l,src:u}=n,[c,f]=is(this,r);return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(t).enter().append("image").call(Ga,this).attr("x",s&&o?t=>o[t]-s[t]/2:s?t=>c-s[t]/2:o?t=>o[t]-this.width/2:c-this.width/2).attr("y",l&&a?t=>a[t]-l[t]/2:l?t=>f-l[t]/2:a?t=>a[t]-this.height/2:f-this.height/2).attr("width",s?t=>s[t]:this.width).attr("height",l?t=>l[t]:this.height).call(Qa,"href",u?t=>u[t]:this.src).call(Qa,"preserveAspectRatio",this.preserveAspectRatio).call(Qa,"crossorigin",this.crossOrigin).call($a,this,n))).node()}}function Kd(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===r.frameAnchor&&([e,n]=Xo(e,n)),new Jd(t,{...r,x:e,y:n})}const th={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class eh extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,z:i,curve:o,tension:a}=e;super(t,[{name:"x",value:n,scale:"x"},{name:"y",value:r,scale:"y"},{name:"z",value:Qo(e),optional:!0}],e,th),this.z=i,this.curve=mc(o,a),cf(this,e)}filter(t){return t}render(t,e,n,r,i){const{x:o,y:a}=n;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(Ya(t,[o,a],this,n)).enter().append("path").call(Ga,this).call(Ha,this,n).call(vf,this,n).attr("d",(0,Pi.Z)().curve(this.curve).defined((t=>t>=0)).x((t=>o[t])).y((t=>a[t]))))).node()}}function nh(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[e,n]=Xo(e,n),new eh(t,{...r,x:e,y:n})}function rh(t){let{x:e=Co,y:n=Mo,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new eh(t,_c({...r,x:e,y:n}))}function ih(t){let{x:e=Mo,y:n=Co,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new eh(t,xc({...r,x:e,y:n}))}function oh(t,e,n){var r=0===t||1===t?0:Math.exp(sh(e+n)-sh(e)-sh(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*ah(t,e,n)/e:1-r*ah(1-t,n,e)/n)}function ah(t,e,n){var r,i,o,a,s=1e-30,l=1,u=e+n,c=e+1,f=e-1,d=1,h=1-u*t/c;for(Math.abs(h)<s&&(h=s),a=h=1/h;l<=100&&(h=1+(i=l*(n-l)*t/((f+(r=2*l))*(e+r)))*h,Math.abs(h)<s&&(h=s),d=1+i/d,Math.abs(d)<s&&(d=s),a*=(h=1/h)*d,h=1+(i=-(e+l)*(u+l)*t/((e+r)*(c+r)))*h,Math.abs(h)<s&&(h=s),d=1+i/d,Math.abs(d)<s&&(d=s),a*=o=(h=1/h)*d,!(Math.abs(o-1)<3e-7));l++);return a}function sh(t){var e,n,r,i=0,o=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);i<6;i++)a+=o[i]/++n;return Math.log(2.506628274631*a/e)-r}const lh={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class uh extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,z:i,ci:o=.95,precision:a=4}=e;if(super(t,[{name:"x",value:n,scale:"x"},{name:"y",value:r,scale:"y"},{name:"z",value:Qo(e),optional:!0}],e,lh),this.z=i,this.ci=+o,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error("invalid ci; not in [0, 1): ".concat(o));if(!(this.precision>0))throw new Error("invalid precision: ".concat(a))}render(t,e,n,r,i){const{x:o,y:a,z:s}=n,{ci:l}=this;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(s?Za(t,s,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(Ga,this).call(Ha,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,o,a))).call(l&&!va(this.fill)?t=>t.select(ch).attr("stroke","none").call(Ga,this).call(Ha,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,o,a))):()=>{}))))).node()}}function ch(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Et.svg,"path"),this)}class fh extends uh{constructor(t,e){super(t,e)}_renderBand(t,e,n){const{ci:r,precision:i}=this,[o,a]=f(t,(t=>n[t])),s=mh(t,n,e),l=gh(t,n,e,(1-r)/2,s);return(0,Ri.Z)().y((t=>t)).x0((t=>l(t,-1))).x1((t=>l(t,1)))((0,L.Z)(o,a-i/2,i).concat(a))}_renderLine(t,e,n){const[r,i]=f(t,(t=>n[t])),o=mh(t,n,e);return"M".concat(o(r),",").concat(r,"L").concat(o(i),",").concat(i)}}class dh extends uh{constructor(t,e){super(t,e)}_renderBand(t,e,n){const{ci:r,precision:i}=this,[o,a]=f(t,(t=>e[t])),s=mh(t,e,n),l=gh(t,e,n,(1-r)/2,s);return(0,Ri.Z)().x((t=>t)).y0((t=>l(t,-1))).y1((t=>l(t,1)))((0,L.Z)(o,a-i/2,i).concat(a))}_renderLine(t,e,n){const[r,i]=f(t,(t=>e[t])),o=mh(t,e,n);return"M".concat(r,",").concat(o(r),"L").concat(i,",").concat(o(i))}}function hh(t){let{y:e=Mo,x:n=Co,stroke:r,fill:i=(ya(r)?"currentColor":r),...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new fh(t,_c({...o,x:n,y:e,fill:i,stroke:r}))}function ph(t){let{x:e=Mo,y:n=Co,stroke:r,fill:i=(ya(r)?"currentColor":r),...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new dh(t,xc({...o,x:e,y:n,fill:i,stroke:r}))}function mh(t,e,n){let r=0,i=0,o=0,a=0;for(const c of t){const t=e[c],s=n[c];r+=t,i+=s,o+=t*s,a+=t*t}const s=t.length,l=(s*o-r*i)/(s*a-r*r),u=(i-l*r)/s;return t=>l*t+u}function gh(t,e,n,r,i){const o=(0,q.Z)(t,(t=>e[t]))/t.length;let a=0,s=0;for(const c of t)a+=(e[c]-o)**2,s+=(n[c]-i(e[c]))**2;const l=Math.sqrt(s/(t.length-2)),u=function(t,e){var n=function(t,e,n){var r,i,o,a,s,l,u,c=e-1,f=0;if(t<=0)return 0;if(t>=1)return 1;for(r=Math.log(e/(e+n)),i=Math.log(n/(e+n)),s=t<(o=Math.exp(e*r)/e)/(l=o+(a=Math.exp(n*i)/n))?Math.pow(e*l*t,1/e):1-Math.pow(n*l*(1-t),2),u=-sh(e)-sh(n)+sh(e+n);f<10;f++){if(0===s||1===s)return s;if((s-=o=(a=(oh(s,e,n)-t)/(o=Math.exp(c*Math.log(s)+-.5*Math.log(1-s)+u)))/(1-.5*Math.min(1,a*(c/s- -.5/(1-s)))))<=0&&(s=.5*(s+o)),s>=1&&(s=.5*(s+o+1)),Math.abs(o)<1e-8*s&&f>0)break}return s}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}(r,t.length-2);return(e,n)=>{const r=i(e),s=l*Math.sqrt(1/t.length+(e-o)**2/a);return r+n*u*s}}const yh={ariaLabel:"rect"};class vh extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x1:n,y1:r,x2:i,y2:o,inset:a=0,insetTop:s=a,insetRight:l=a,insetBottom:u=a,insetLeft:c=a,rx:f,ry:d}=e;super(t,[{name:"x1",value:n,scale:"x",optional:!0},{name:"y1",value:r,scale:"y",optional:!0},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0}],e,yh),this.insetTop=To(s),this.insetRight=To(l),this.insetBottom=To(u),this.insetLeft=To(c),this.rx=Ka(f,"auto"),this.ry=Ka(d,"auto")}render(t,e,n,r,i){const{x:o,y:a}=e,{x1:s,y1:l,x2:u,y2:c}=n,{marginTop:f,marginRight:d,marginBottom:h,marginLeft:p,width:m,height:g}=r,{insetTop:y,insetRight:v,insetBottom:b,insetLeft:x,rx:_,ry:w}=this;return vo("svg:g",i).call(Va,this,e,r).call(Ja,this,{x:s&&u?o:null,y:l&&c?a:null},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(Ga,this).attr("x",s&&u&&!Ll(o)?t=>Math.min(s[t],u[t])+x:p+x).attr("y",l&&c&&!Ll(a)?t=>Math.min(l[t],c[t])+y:f+y).attr("width",s&&u&&!Ll(o)?t=>Math.max(0,Math.abs(u[t]-s[t])-x-v):m-d-p-v-x).attr("height",l&&c&&!Ll(a)?t=>Math.max(0,Math.abs(l[t]-c[t])-y-b):g-f-h-y-b).call(Qa,"rx",_).call(Qa,"ry",w).call($a,this,n))).node()}}function bh(t,e){return new vh(t,js(Us(e)))}function xh(t){return new vh(t,Uc(Us(Nc(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{y:Mo,interval:1,x2:Co}))))}function _h(t){return new vh(t,qc(js(Oc(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:Mo,interval:1,y2:Co}))))}const wh={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"};class kh extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,text:i=(la(t)&&ua(t)?Co:Mo),frameAnchor:o,textAnchor:a=(/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle"),lineAnchor:s=(/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle"),lineHeight:l=1,lineWidth:u=1/0,monospace:c,fontFamily:f=(c?"ui-monospace, monospace":void 0),fontSize:d,fontStyle:h,fontVariant:p,fontWeight:m,rotate:g}=e,[y,v]=Lo(g,0),[b,x]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),Dh.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(d);var _;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"fontSize",value:b,optional:!0},{name:"rotate",value:(_=y,null==_?null:{transform:t=>Ao(t,_,Float64Array),label:oa(_)}),optional:!0},{name:"text",value:i,filter:Oa}],e,wh),this.rotate=v,this.textAnchor=Ka(a,"middle"),this.lineAnchor=Uo(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+l,this.lineWidth=+u,this.monospace=!!c,this.fontFamily=Fo(f),this.fontSize=x,this.fontStyle=Fo(h),this.fontVariant=Fo(p),this.fontWeight=Fo(m),this.frameAnchor=ba(o)}render(t,e,n,r,i){const{x:o,y:a,rotate:s,text:l,fontSize:u}=n,{rotate:c}=this,[f,d]=is(this,r);return vo("svg:g",i).call(Va,this,e,r).call(Sh,this,l,r).call(Ja,this,e).call((e=>e.selectAll().data(t).enter().append("text").call(Ga,this).call(Ah,this,l).attr("transform",s?o&&a?t=>"translate(".concat(o[t],",").concat(a[t],") rotate(").concat(s[t],")"):o?t=>"translate(".concat(o[t],",").concat(d,") rotate(").concat(s[t],")"):a?t=>"translate(".concat(f,",").concat(a[t],") rotate(").concat(s[t],")"):t=>"translate(".concat(f,",").concat(d,") rotate(").concat(s[t],")"):c?o&&a?t=>"translate(".concat(o[t],",").concat(a[t],") rotate(").concat(c,")"):o?t=>"translate(".concat(o[t],",").concat(d,") rotate(").concat(c,")"):a?t=>"translate(".concat(f,",").concat(a[t],") rotate(").concat(c,")"):"translate(".concat(f,",").concat(d,") rotate(").concat(c,")"):o&&a?t=>"translate(".concat(o[t],",").concat(a[t],")"):o?t=>"translate(".concat(o[t],",").concat(d,")"):a?t=>"translate(".concat(f,",").concat(a[t],")"):"translate(".concat(f,",").concat(d,")")).call(Qa,"font-size",u&&(t=>u[t])).call($a,this,n))).node()}}function Ah(t,e,n){let{monospace:r,lineAnchor:i,lineHeight:o,lineWidth:a}=e;if(!n)return;const s=isFinite(a)?r?t=>Fh(t,a,Oh):t=>Fh(t,100*a,Nh):t=>t.split(/\r\n?|\n/g);t.each((function(t){const e=s(Sa(n[t])),r=e.length,a="top"===i?.71:"bottom"===i?1-r:(164-100*r)/200;if(r>1)for(let n=0;n<r;++n){if(!e[n])continue;const t=this.ownerDocument.createElementNS(Et.svg,"tspan");t.setAttribute("x",0),t.setAttribute("y",(a+n)*o+"em"),t.textContent=e[n],this.appendChild(t)}else a&&this.setAttribute("y",a*o+"em"),this.textContent=e[0]}))}function Eh(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===r.frameAnchor&&([e,n]=Xo(e,n)),new kh(t,{...r,x:e,y:n})}function Mh(t){let{x:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new kh(t,$s({...n,x:e}))}function Ch(t){let{y:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new kh(t,Ws({...n,y:e}))}function Sh(t,e,n){Qa(t,"text-anchor",e.textAnchor),Qa(t,"font-family",e.fontFamily),Qa(t,"font-size",e.fontSize),Qa(t,"font-style",e.fontStyle),Qa(t,"font-variant",void 0===e.fontVariant&&(function(t){for(const e of t)if(null!=e)return"number"==typeof e}(n)||fa(n))?"tabular-nums":e.fontVariant),Qa(t,"font-weight",e.fontWeight)}const Dh=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Fh(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(t,e,n)=>n-e;const r=[];let i,o=0;for(const[a,s,l]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===i&&(i=a),o>i&&n(t,i,s)>e&&(r.push(t.slice(i,o)),i=a),l?(r.push(t.slice(i,s)),i=void 0):o=s;return r}const Th={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"\u2018":31,"\u2019":31,"\u201c":47,"\u201d":47};function Nh(t,e,n){let r=0;for(let i=e;i<n;++i){r+=Th[t[i]]||Th.e;const e=t.charCodeAt(i);if(e>=55296&&e<=56319){const e=t.charCodeAt(i+1);e>=56320&&e<=57343&&++i}}return r}function Oh(t,e,n){return n-e}function zh(){let{path:t=Co,delimiter:e,frameAnchor:n,treeLayout:r=Pn.Z,treeSort:i,treeSeparation:o,treeAnchor:a,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a=Ph(a),i=jh(i),void 0===n&&(n=a.frameAnchor);const l=qh(e),u=ep(s,Wh),[c,f]=ra(),[d,h]=ra();return{x:c,y:d,frameAnchor:n,...Kl(s,((e,n)=>{const s=l(Ao(e,t)),c=f([]),d=h([]);let p=-1;const m=[],g=[],y=(0,Rn.Z)().path((t=>s[t])),v=r();v.nodeSize&&v.nodeSize([1,1]),v.separation&&void 0!==o&&v.separation(null!==o&&void 0!==o?o:So);for(const t of u)t[tp]=t[Jh]([]);for(const t of n){const n=[],r=y(t.filter((t=>null!=s[t]))).each((t=>t.data=e[t.data]));null!=i&&r.sort(i),v(r);for(const t of r.descendants()){n.push(++p),m[p]=t.data,a.position(t,p,c,d);for(const e of u)e[tp][p]=e[Kh](t)}g.push(n)}return{data:m,facets:g}})),...Object.fromEntries(u)}}function Rh(){let{path:t=Co,delimiter:e,curve:n="bump-x",stroke:r="#555",strokeWidth:i=1.5,strokeOpacity:o=.5,treeLayout:a=Pn.Z,treeSort:s,treeSeparation:l,treeAnchor:u,...c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u=Ph(u),s=jh(s),c={curve:n,stroke:r,strokeWidth:i,strokeOpacity:o,...c};const f=qh(e),d=ep(c,$h),[h,p]=ra(),[m,g]=ra(),[y,v]=ra(),[b,x]=ra();return{x1:h,x2:m,y1:y,y2:b,...Kl(c,((e,n)=>{const r=f(Ao(e,t)),i=p([]),o=g([]),c=v([]),h=x([]);let m=-1;const y=[],b=[],_=(0,Rn.Z)().path((t=>r[t])),w=a();w.nodeSize&&w.nodeSize([1,1]),w.separation&&void 0!==l&&w.separation(null!==l&&void 0!==l?l:So);for(const t of d)t[tp]=t[Jh]([]);for(const t of n){const n=[],a=_(t.filter((t=>null!=r[t]))).each((t=>t.data=e[t.data]));null!=s&&a.sort(s),w(a);for(const{source:t,target:e}of a.links()){n.push(++m),y[m]=e.data,u.position(t,m,i,c),u.position(e,m,o,h);for(const n of d)n[tp][m]=n[Kh](e,t)}b.push(n)}return{data:y,facets:b}})),...Object.fromEntries(d)}}function Ph(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left";switch("".concat(t).trim().toLowerCase()){case"left":return Bh;case"right":return Lh}throw new Error("invalid tree anchor: ".concat(t))}const Bh={frameAnchor:"left",dx:6,position(t,e,n,r){let{x:i,y:o}=t;n[e]=o,r[e]=-i}},Lh={frameAnchor:"right",dx:-6,position(t,e,n,r){let{x:i,y:o}=t;n[e]=-o,r[e]=-i}};function jh(t){return null==t||"function"==typeof t?t:"".concat(t).trim().toLowerCase().startsWith("node:")?Uh(Wh(t)):Uh(function(t){return e=>{var n;return null===(n=e.data)||void 0===n?void 0:n[t]}}(t))}function Uh(t){return(e,n)=>Ta(t(e),t(n))}function qh(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";return"/"=="".concat(t)?t=>t:e=>{return e.map((n=t,n=new RegExp(function(t){return"".concat(t).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:"".concat(t).replace(n,"/")));var n}}function Ih(t){return Ho(t)&&"function"==typeof t.node}function Wh(t){if(Ih(t))return t.node;if((t="".concat(t).trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return Zh;case"node:path":return Hh;case"node:internal":return Gh;case"node:depth":return Yh;case"node:height":return Vh}throw new Error("invalid node value: ".concat(t))}}function $h(t){if(Ih(t))return t.node;if(Ho(e=t)&&"function"==typeof e.link)return t.link;var e;if((t="".concat(t).trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return Xh(Zh);case"parent:path":return Xh(Hh);case"parent:depth":return Xh(Yh);case"parent:height":return Xh(Vh);case"node:name":return Zh;case"node:path":return Hh;case"node:internal":return Gh;case"node:depth":return Yh;case"node:height":return Vh}throw new Error("invalid link value: ".concat(t))}}function Hh(t){return t.id}function Zh(t){return function(t){let e=t.length;for(;--e>0&&!Qh(t,e););return t.slice(e+1)}(t.id)}function Yh(t){return t.depth}function Vh(t){return t.height}function Gh(t){return!!t.children}function Xh(t){return(e,n)=>null==n?void 0:t(n)}function Qh(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const Jh=2,Kh=3,tp=4;function ep(t,e){const n=[];for(const r in t){const i=t[r],o=e(i);void 0!==o&&n.push([r,...ra(i),o])}return n}function np(t){let{fill:e,stroke:n,strokeWidth:r,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:a,strokeMiterlimit:s,strokeDasharray:l,strokeDashoffset:u,marker:c,markerStart:f=c,markerEnd:d=c,dot:h=ya(f)&&ya(d),text:p="node:name",textStroke:m="white",title:g="node:path",dx:y,dy:v,...b}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===y&&(y=Ph(b.treeAnchor).dx),oc(wf(t,Rh({markerStart:f,markerEnd:d,stroke:void 0!==n?n:void 0===e?"node:internal":e,strokeWidth:r,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:a,strokeMiterlimit:s,strokeDasharray:l,strokeDashoffset:u,...b})),h?Wf(t,zh({fill:void 0===e?"node:internal":e,title:g,...b})):null,null!=p?Eh(t,zh({text:p,fill:void 0===e?"currentColor":e,stroke:m,dx:y,dy:v,title:g,...b})):null)}function rp(t,e){return np(t,{...e,treeLayout:zn.Z})}const ip={ariaLabel:"vector",fill:null,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round"};class op extends ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{x:n,y:r,length:i,rotate:o,anchor:a="middle",frameAnchor:s}=e,[l,u]=Lo(i,12),[c,f]=Lo(o,0);super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"length",value:l,scale:"length",optional:!0},{name:"rotate",value:c,optional:!0}],e,ip),this.length=u,this.rotate=f,this.anchor=Uo(a,"anchor",["start","middle","end"]),this.frameAnchor=ba(s)}render(t,e,n,r,i){const{x:o,y:a,length:s,rotate:l}=n,{length:u,rotate:c,anchor:f}=this,[d,h]=is(this,r),p=s?t=>s[t]:()=>u,m=l?t=>l[t]:()=>c,g=o?t=>o[t]:()=>d,y=a?t=>a[t]:()=>h,v="start"===f?0:"end"===f?1:.5;return vo("svg:g",i).attr("fill","none").call(Va,this,e,r).call(Ja,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(Ga,this).attr("d",(t=>{const e=p(t),n=m(t)*Da,r=Math.sin(n)*e,i=-Math.cos(n)*e,o=(r+i)/5,a=(r-i)/5;return"M".concat(g(t)-r*v,",").concat(y(t)-i*v,"l").concat(r,",").concat(i,"m").concat(-a,",").concat(-o,"l").concat(a,",").concat(o,"l").concat(-o,",").concat(a)})).call($a,this,n))).node()}}function ap(t){let{x:e,y:n,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===r.frameAnchor&&([e,n]=Xo(e,n)),new op(t,{...r,x:e,y:n})}function sp(t){let{x:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new op(t,{...n,x:e})}function lp(t){let{y:e=Co,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new op(t,{...n,y:e})}var up=n(2636);const cp=t=>{let{marginLeft:e}=t;return[1,e]},fp=t=>{let{width:e,marginRight:n}=t;return[-1,e-n]},dp=t=>{let{width:e,marginLeft:n,marginRight:r}=t;return[0,(n+e-r)/2]},hp=t=>{let{marginTop:e}=t;return[1,e]},pp=t=>{let{height:e,marginBottom:n}=t;return[-1,e-n]},mp=t=>{let{height:e,marginTop:n,marginBottom:r}=t;return[0,(n+e-r)/2]};function gp(t){return"string"==typeof t?{anchor:t}:t}function yp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=bp(t));let{anchor:n="left",padding:r=1}=gp(t);switch("".concat(n).toLowerCase()){case"left":n=cp;break;case"right":n=fp;break;case"middle":n=dp;break;default:throw new Error("unknown dodge anchor: ".concat(n))}return xp("x","y",n,To(r),e)}function vp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};1===arguments.length&&([t,e]=bp(t));let{anchor:n="bottom",padding:r=1}=gp(t);switch("".concat(n).toLowerCase()){case"top":n=hp;break;case"bottom":n=pp;break;case"middle":n=mp;break;default:throw new Error("unknown dodge anchor: ".concat(n))}return xp("y","x",n,To(r),e)}function bp(t){const{anchor:e,padding:n,...r}=t;return[{anchor:e,padding:n},r]}function xp(t,e,n,r,i){const{r:o}=i;if(null!=o&&"number"!=typeof o){const{channels:t,sort:e,reverse:n}=i;i={...i,channels:[...null!==t&&void 0!==t?t:[],{name:"r",value:o,scale:"r"}]},void 0===e&&void 0===n&&(i.sort={channel:"r",order:"descending"})}return tu(i,(function(o,a,s,l,u){let{[e]:c,r:f}=s;if(!c)throw new Error("missing channel: ".concat(e));c=Il(Ao(c.value,l[c.scale]||Co));const d=f?void 0:void 0!==this.r?this.r:void 0!==i.r?To(i.r):3;f&&(f=Il(Ao(f.value,l[f.scale]||Co)));let[h,p]=n(u);const m=h?wp:_p,g=new Float64Array(c.length),y=f?t=>f[t]:()=>d;for(let t of a){const e=up();t=t.filter(f?t=>za(c[t])&&Ra(f[t]):t=>za(c[t]));const n=new Float64Array(2*t.length+2);for(const i of t){const t=y(i),o=h?t+r:0,a=c[i]-t,s=c[i]+t;let l=2;e.queryInterval(a-r,s+r,(t=>{let[,,e]=t;const a=g[e]-o,s=c[i]-c[e],u=r+(f?f[i]+f[e]:2*d),h=Math.sqrt(u*u-s*s);n[l++]=a-h,n[l++]=a+h}));let u=n.slice(0,l);h&&(u=u.filter((t=>t>=0)));t:for(const e of u.sort(m)){for(let t=0;t<l;t+=2)if(n[t]+1e-6<e&&e<n[t+1]-1e-6)continue t;g[i]=e+o;break}e.insert([a,s,i])}}h||(h=1);for(const t of a)for(const e of t)g[e]=g[e]*h+p;return{data:o,facets:a,channels:{[e]:{value:c},[t]:{value:g},...f&&{r:{value:f}}}}}))}function _p(t,e){return Math.abs(t)-Math.abs(e)}function wp(t,e){return t-e}function kp(t,e){return 1===arguments.length&&({basis:t,...e}=t),zf(Ep(t),e)}function Ap(t,e){return 1===arguments.length&&({basis:t,...e}=t),Rf(Ep(t),e)}function Ep(t){if(void 0===t)return Dp;if("function"==typeof t)return Mp(((e,n)=>t(ta(n,e))));if(/^p\d{2}$/i.test(t))return Cp(Po(t));switch("".concat(t).toLowerCase()){case"deviation":return Tp;case"first":return Dp;case"last":return Fp;case"max":return Np;case"mean":return Op;case"median":return zp;case"min":return Rp;case"sum":return Pp;case"extent":return Sp}throw new Error("invalid basis: ".concat(t))}function Mp(t){return{map(e,n,r){const i=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/i}}}function Cp(t){return Mp(((e,n)=>t(e,(t=>n[t]))))}const Sp={map(t,e,n){const[r,i]=f(t,(t=>e[t])),o=i-r;for(const a of t)n[a]=null===e[a]?NaN:(e[a]-r)/o}},Dp=Mp(((t,e)=>{for(let n=0;n<t.length;++n){const r=e[t[n]];if(Fa(r))return r}})),Fp=Mp(((t,e)=>{for(let n=t.length-1;n>=0;--n){const r=e[t[n]];if(Fa(r))return r}})),Tp={map(t,e,n){const r=(0,N.Z)(t,(t=>e[t])),i=(0,c.Z)(t,(t=>e[t]));for(const o of t)n[o]=null===e[o]?NaN:i?(e[o]-r)/i:0}},Np=Cp(F.Z),Op=Cp(N.Z),zp=Cp(O.Z),Rp=Cp(z.Z),Pp=Cp(q.Z);function Bp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return 1===arguments.length&&(e=t),zf(jp(t),e)}function Lp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return 1===arguments.length&&(e=t),Rf(jp(t),e)}function jp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"number"==typeof t&&(t={k:t});let{k:e,reduce:n,shift:r,anchor:i}=t;if(void 0===i&&void 0!==r&&(i=function(t){switch("".concat(t).toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error("invalid shift: ".concat(t))}(r),La('Warning: the shift option is deprecated; please use anchor "'.concat(i,'" instead.'))),!((e=Math.floor(e))>0))throw new Error("invalid k: ".concat(e));return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mean";if("string"==typeof t){if(/^p\d{2}$/i.test(t))return Up(Po(t));switch(t.toLowerCase()){case"deviation":return Up(c.Z);case"max":return Up(F.Z);case"mean":return Ip;case"median":return Up(O.Z);case"min":return Up(z.Z);case"mode":return Up(P);case"sum":return qp;case"variance":return Up(I.Z);case"difference":return Wp;case"ratio":return $p;case"first":return Hp;case"last":return Zp}}if("function"!=typeof t)throw new Error("invalid reduce: ".concat(t));return Up(t)}(n)(e,function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"middle",e=arguments.length>1?arguments[1]:void 0;switch("".concat(t).toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error("invalid anchor: ".concat(t))}(i,e))}function Up(t){return(e,n)=>({map(r,i,o){const a=Float64Array.from(r,(t=>null===i[t]?NaN:i[t]));let s=0;for(let t=0;t<e-1;++t)isNaN(a[t])&&++s;for(let l=0,u=r.length-e+1;l<u;++l)isNaN(a[l+e-1])&&++s,o[r[l+n]]=0===s?t(a.subarray(l,l+e)):NaN,isNaN(a[l])&&--s}})}function qp(t,e){return{map(n,r,i){let o=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++o:a+=+t}for(let s=0,l=n.length-t+1;s<l;++s){const l=r[n[s]],u=r[n[s+t-1]];null===u||isNaN(u)?++o:a+=+u,i[n[s+e]]=0===o?a:NaN,null===l||isNaN(l)?--o:a-=+l}}}}function Ip(t,e){const n=qp(t,e);return{map(r,i,o){n.map(r,i,o);for(let n=0,a=r.length-t+1;n<a;++n)o[r[n+e]]/=t}}}function Wp(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s-a}}}}function $p(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s/a}}}}function Hp(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o]]}}}function Zp(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o+t-1]]}}}function Yp(t){let e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t)switch(t.toLowerCase()){case"first":return Gp(r);case"last":return Xp(r)}if("function"==typeof t)return om(null,t,r);for(e in t){if(void 0!==n)throw new Error("ambiguous selector; multiple inputs");n=Vp(t[e])}if(void 0===n)throw new Error("invalid selector: ".concat(t));return om(e,n,r)}function Vp(t){if("function"==typeof t)return t;switch("".concat(t).toLowerCase()){case"min":return rm;case"max":return im}throw new Error("unknown selector: ".concat(t))}function Gp(t){return om(null,em,t)}function Xp(t){return om(null,nm,t)}function Qp(t){return om("x",rm,t)}function Jp(t){return om("y",rm,t)}function Kp(t){return om("x",im,t)}function tm(t){return om("y",im,t)}function*em(t){yield t[0]}function*nm(t){yield t[t.length-1]}function*rm(t,e){yield function(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Z,i=!1;if(1===n.length){let o;for(const a of t){const t=n(a);(i?(0,r.Z)(t,o)<0:0===(0,r.Z)(t,t))&&(e=a,o=t,i=!0)}}else for(const r of t)(i?n(r,e)<0:0===n(r,r))&&(e=r,i=!0);return e}(t,(t=>e[t]))}function*im(t,e){yield U(t,(t=>e[t]))}function om(t,e,n){if(null!=t){if(null==n[t])throw new Error("missing channel: ".concat(t));t=n[t]}const r=Qo(n);return Kl(n,((n,i)=>{const o=Ao(n,r),a=Ao(n,t),s=[];for(const t of i){const n=[];for(const r of o?p(t,(t=>o[t])).values():[t])for(const t of e(r,a))n.push(t);s.push(n)}return{data:n,facets:s}}))}},6801:(t,e,n)=>{"use strict";function r(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}n.d(e,{Z:()=>r})},940:(t,e,n)=>{"use strict";n.d(e,{Nw:()=>l,ZP:()=>u,ml:()=>s});var r=n(6801),i=n(2108),o=n(9480);const a=(0,i.Z)(r.Z),s=a.right,l=a.left,u=((0,i.Z)(o.Z).center,s)},2108:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(6801),i=n(4304);function o(t){let e,n,o;function s(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=r.Z,n=(e,n)=>(0,r.Z)(t(e),n),o=(e,n)=>t(e)-n):(e=t===r.Z||t===i.Z?t:a,n=t,o=t),{left:s,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=s(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return r>n&&o(t[r-1],e)>-o(t[r],e)?r-1:r},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function a(){return 0}},4304:(t,e,n)=>{"use strict";function r(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}n.d(e,{Z:()=>r})},2233:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6620);function i(t,e){const n=(0,r.Z)(t,e);return n?Math.sqrt(n):n}},5852:(t,e,n)=>{"use strict";n.d(e,{dU:()=>r});class r{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[n++]=a),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}},1649:(t,e,n)=>{"use strict";function r(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}n.d(e,{Z:()=>r})},2403:(t,e,n)=>{"use strict";function r(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}n.d(e,{Z:()=>r})},3309:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(1787);function i(t,e){return(0,r.ZP)(t,.5,e)}},396:(t,e,n)=>{"use strict";function r(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}n.d(e,{Z:()=>r})},9480:(t,e,n)=>{"use strict";function r(t){return null===t?NaN:+t}function*i(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}n.d(e,{K:()=>i,Z:()=>r})},6788:(t,e,n)=>{"use strict";function r(t,e){return Array.from(e,(e=>t[e]))}n.d(e,{Z:()=>r})},1787:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>u,s7:()=>c});var r=n(1649),i=n(396),o=n(4657);function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?o.Wv:(0,o.di)(i);r>n;){if(r-n>600){const o=r-n+1,s=e-n+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);a(t,e,Math.max(n,Math.floor(e-s*u/o+c)),Math.min(r,Math.floor(e+(o-s)*u/o+c)),i)}const o=t[e];let l=n,u=r;for(s(t,n,e),i(t[r],o)>0&&s(t,n,r);l<u;){for(s(t,l,u),++l,--u;i(t[l],o)<0;)++l;for(;i(t[u],o)>0;)--u}0===i(t[n],o)?s(t,n,u):(++u,s(t,u,r)),u<=e&&(n=u+1),e<=u&&(r=u-1)}return t}function s(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}var l=n(9480);function u(t,e,n){if((o=(t=Float64Array.from((0,l.K)(t,n))).length)&&!isNaN(e=+e)){if(e<=0||o<2)return(0,i.Z)(t);if(e>=1)return(0,r.Z)(t);var o,s=(o-1)*e,u=Math.floor(s),c=(0,r.Z)(a(t,u).subarray(0,u+1));return c+((0,i.Z)(t.subarray(u+1))-c)*(s-u)}}function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.Z;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}}},6273:(t,e,n)=>{"use strict";function r(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}n.d(e,{Z:()=>r})},4657:(t,e,n)=>{"use strict";n.d(e,{Wv:()=>s,ZP:()=>o,di:()=>a});var r=n(6801),i=n(6788);function o(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);let[o]=n;if(o&&2!==o.length||n.length>1){const e=Uint32Array.from(t,((t,e)=>e));return n.length>1?(n=n.map((e=>t.map(e))),e.sort(((t,e)=>{for(const r of n){const n=s(r[t],r[e]);if(n)return n}}))):(o=t.map(o),e.sort(((t,e)=>s(o[t],o[e])))),(0,i.Z)(t,e)}return t.sort(a(o))}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.Z;if(t===r.Z)return s;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}function s(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}},9199:(t,e,n)=>{"use strict";function r(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}n.d(e,{Z:()=>r})},2497:(t,e,n)=>{"use strict";n.d(e,{G9:()=>l,ZP:()=>s,ly:()=>u});const r=Math.sqrt(50),i=Math.sqrt(10),o=Math.sqrt(2);function a(t,e,n){const s=(e-t)/Math.max(0,n),l=Math.floor(Math.log10(s)),u=s/Math.pow(10,l),c=u>=r?10:u>=i?5:u>=o?2:1;let f,d,h;return l<0?(h=Math.pow(10,-l)/c,f=Math.round(t*h),d=Math.round(e*h),f/h<t&&++f,d/h>e&&--d,h=-h):(h=Math.pow(10,l)*c,f=Math.round(t/h),d=Math.round(e/h),f*h<t&&++f,d*h>e&&--d),d<f&&.5<=n&&n<2?a(t,e,2*n):[f,d,h]}function s(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];const r=e<t,[i,o,s]=r?a(e,t,n):a(t,e,n);if(!(o>=i))return[];const l=o-i+1,u=new Array(l);if(r)if(s<0)for(let a=0;a<l;++a)u[a]=(o-a)/-s;else for(let a=0;a<l;++a)u[a]=(o-a)*s;else if(s<0)for(let a=0;a<l;++a)u[a]=(i+a)/-s;else for(let a=0;a<l;++a)u[a]=(i+a)*s;return u}function l(t,e,n){return a(t=+t,e=+e,n=+n)[2]}function u(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?l(e,t,n):l(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}},6620:(t,e,n)=>{"use strict";function r(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let a of t)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of t)null!=(s=e(s,++a,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}n.d(e,{Z:()=>r})},5141:(t,e,n)=>{"use strict";n.d(e,{B8:()=>A,Il:()=>i,J5:()=>a,SU:()=>k,Ss:()=>E,Ym:()=>O,ZP:()=>x,xV:()=>o});var r=n(4258);function i(){}var o=.7,a=1/o,s="\\s*([+-]?\\d+)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,f=new RegExp("^rgb\\(".concat(s,",").concat(s,",").concat(s,"\\)$")),d=new RegExp("^rgb\\(".concat(u,",").concat(u,",").concat(u,"\\)$")),h=new RegExp("^rgba\\(".concat(s,",").concat(s,",").concat(s,",").concat(l,"\\)$")),p=new RegExp("^rgba\\(".concat(u,",").concat(u,",").concat(u,",").concat(l,"\\)$")),m=new RegExp("^hsl\\(".concat(l,",").concat(u,",").concat(u,"\\)$")),g=new RegExp("^hsla\\(".concat(l,",").concat(u,",").concat(u,",").concat(l,"\\)$")),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v(){return this.rgb().formatHex()}function b(){return this.rgb().formatRgb()}function x(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=c.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?_(e):3===n?new E(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?w(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?w(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=f.exec(t))?new E(e[1],e[2],e[3],1):(e=d.exec(t))?new E(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=h.exec(t))?w(e[1],e[2],e[3],e[4]):(e=p.exec(t))?w(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=m.exec(t))?T(e[1],e[2]/100,e[3]/100,1):(e=g.exec(t))?T(e[1],e[2]/100,e[3]/100,e[4]):y.hasOwnProperty(t)?_(y[t]):"transparent"===t?new E(NaN,NaN,NaN,0):null}function _(t){return new E(t>>16&255,t>>8&255,255&t,1)}function w(t,e,n,r){return r<=0&&(t=e=n=NaN),new E(t,e,n,r)}function k(t){return t instanceof i||(t=x(t)),t?new E((t=t.rgb()).r,t.g,t.b,t.opacity):new E}function A(t,e,n,r){return 1===arguments.length?k(t):new E(t,e,n,null==r?1:r)}function E(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function M(){return"#".concat(F(this.r)).concat(F(this.g)).concat(F(this.b))}function C(){const t=S(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(D(this.r),", ").concat(D(this.g),", ").concat(D(this.b)).concat(1===t?")":", ".concat(t,")"))}function S(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function D(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function F(t){return((t=D(t))<16?"0":"")+t.toString(16)}function T(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new z(t,e,n,r)}function N(t){if(t instanceof z)return new z(t.h,t.s,t.l,t.opacity);if(t instanceof i||(t=x(t)),!t)return new z;if(t instanceof z)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,l=a-o,u=(a+o)/2;return l?(s=e===a?(n-r)/l+6*(n<r):n===a?(r-e)/l+2:(e-n)/l+4,l/=u<.5?a+o:2-a-o,s*=60):l=u>0&&u<1?0:s,new z(s,l,u,t.opacity)}function O(t,e,n,r){return 1===arguments.length?N(t):new z(t,e,n,null==r?1:r)}function z(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function R(t){return(t=(t||0)%360)<0?t+360:t}function P(t){return Math.max(0,Math.min(1,t||0))}function B(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}(0,r.Z)(i,x,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:v,formatHex:v,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return N(this).formatHsl()},formatRgb:b,toString:b}),(0,r.Z)(E,A,(0,r.l)(i,{brighter(t){return t=null==t?a:Math.pow(a,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?o:Math.pow(o,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new E(D(this.r),D(this.g),D(this.b),S(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M,formatHex:M,formatHex8:function(){return"#".concat(F(this.r)).concat(F(this.g)).concat(F(this.b)).concat(F(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:C,toString:C})),(0,r.Z)(z,O,(0,r.l)(i,{brighter(t){return t=null==t?a:Math.pow(a,t),new z(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?o:Math.pow(o,t),new z(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new E(B(t>=240?t-240:t+120,i,r),B(t,i,r),B(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new z(R(this.h),P(this.s),P(this.l),S(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=S(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(R(this.h),", ").concat(100*P(this.s),"%, ").concat(100*P(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}))},1461:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(4258),i=n(5141),o=n(4214),a=-.14861,s=1.78277,l=-.29227,u=-.90649,c=1.97294,f=c*u,d=c*s,h=s*l-u*a;function p(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof m)return new m(t.h,t.s,t.l,t.opacity);t instanceof i.Ss||(t=(0,i.SU)(t));var e=t.r/255,n=t.g/255,r=t.b/255,a=(h*r+f*e-d*n)/(h+f-d),s=r-a,p=(c*(n-a)-l*s)/u,g=Math.sqrt(p*p+s*s)/(c*a*(1-a)),y=g?Math.atan2(p,s)*o.R-120:NaN;return new m(y<0?y+360:y,g,a,t.opacity)}(t):new m(t,e,n,null==r?1:r)}function m(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}(0,r.Z)(m,p,(0,r.l)(i.Il,{brighter(t){return t=null==t?i.J5:Math.pow(i.J5,t),new m(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?i.xV:Math.pow(i.xV,t),new m(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*o.u,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),f=Math.sin(t);return new i.Ss(255*(e+n*(a*r+s*f)),255*(e+n*(l*r+u*f)),255*(e+n*(c*r)),this.opacity)}}))},4258:(t,e,n)=>{"use strict";function r(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function i(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}n.d(e,{Z:()=>r,l:()=>i})},6993:(t,e,n)=>{"use strict";n.d(e,{Uc:()=>x,ZP:()=>p});var r=n(4258),i=n(5141),o=n(4214);const a=.96422,s=1,l=.82521,u=4/29,c=6/29,f=3*c*c,d=c*c*c;function h(t){if(t instanceof m)return new m(t.l,t.a,t.b,t.opacity);if(t instanceof _)return w(t);t instanceof i.Ss||(t=(0,i.SU)(t));var e,n,r=b(t.r),o=b(t.g),u=b(t.b),c=g((.2225045*r+.7168786*o+.0606169*u)/s);return r===o&&o===u?e=n=c:(e=g((.4360747*r+.3850649*o+.1430804*u)/a),n=g((.0139322*r+.0971045*o+.7141733*u)/l)),new m(116*c-16,500*(e-c),200*(c-n),t.opacity)}function p(t,e,n,r){return 1===arguments.length?h(t):new m(t,e,n,null==r?1:r)}function m(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function g(t){return t>d?Math.pow(t,1/3):t/f+u}function y(t){return t>c?t*t*t:f*(t-u)}function v(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function b(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function x(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof _)return new _(t.h,t.c,t.l,t.opacity);if(t instanceof m||(t=h(t)),0===t.a&&0===t.b)return new _(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*o.R;return new _(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new _(t,e,n,null==r?1:r)}function _(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function w(t){if(isNaN(t.h))return new m(t.l,0,0,t.opacity);var e=t.h*o.u;return new m(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}(0,r.Z)(m,p,(0,r.l)(i.Il,{brighter(t){return new m(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new m(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=a*y(e),t=s*y(t),n=l*y(n),new i.Ss(v(3.1338561*e-1.6168667*t-.4906146*n),v(-.9787684*e+1.9161415*t+.033454*n),v(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),(0,r.Z)(_,x,(0,r.l)(i.Il,{brighter(t){return new _(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new _(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return w(this).rgb()}}))},4214:(t,e,n)=>{"use strict";n.d(e,{R:()=>i,u:()=>r});const r=Math.PI/180,i=180/Math.PI},9218:(t,e,n)=>{"use strict";n.d(e,{Z:()=>T});const r=134217729;function i(t,e,n,r,i){let o,a,s,l,u=e[0],c=r[0],f=0,d=0;c>u==c>-u?(o=u,u=e[++f]):(o=c,c=r[++d]);let h=0;if(f<t&&d<n)for(c>u==c>-u?(a=u+o,s=o-(a-u),u=e[++f]):(a=c+o,s=o-(a-c),c=r[++d]),o=a,0!==s&&(i[h++]=s);f<t&&d<n;)c>u==c>-u?(a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f]):(a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d]),o=a,0!==s&&(i[h++]=s);for(;f<t;)a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f],o=a,0!==s&&(i[h++]=s);for(;d<n;)a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d],o=a,0!==s&&(i[h++]=s);return 0===o&&0!==h||(i[h++]=o),h}function o(t){return new Float64Array(t)}const a=o(4),s=o(8),l=o(12),u=o(16),c=o(4);function f(t,e,n,o,f,d){const h=(e-d)*(n-f),p=(t-f)*(o-d),m=h-p,g=Math.abs(h+p);return Math.abs(m)>=33306690738754716e-32*g?m:-function(t,e,n,o,f,d,h){let p,m,g,y,v,b,x,_,w,k,A,E,M,C,S,D,F,T;const N=t-f,O=n-f,z=e-d,R=o-d;C=N*R,b=r*N,x=b-(b-N),_=N-x,b=r*R,w=b-(b-R),k=R-w,S=_*k-(C-x*w-_*w-x*k),D=z*O,b=r*z,x=b-(b-z),_=z-x,b=r*O,w=b-(b-O),k=O-w,F=_*k-(D-x*w-_*w-x*k),A=S-F,v=S-A,a[0]=S-(A+v)+(v-F),E=C+A,v=E-C,M=C-(E-v)+(A-v),A=M-D,v=M-A,a[1]=M-(A+v)+(v-D),T=E+A,v=T-E,a[2]=E-(T-v)+(A-v),a[3]=T;let P=function(t,e){let n=e[0];for(let r=1;r<4;r++)n+=e[r];return n}(0,a),B=22204460492503146e-32*h;if(P>=B||-P>=B)return P;if(v=t-N,p=t-(N+v)+(v-f),v=n-O,g=n-(O+v)+(v-f),v=e-z,m=e-(z+v)+(v-d),v=o-R,y=o-(R+v)+(v-d),0===p&&0===m&&0===g&&0===y)return P;if(B=11093356479670487e-47*h+33306690738754706e-32*Math.abs(P),P+=N*y+R*p-(z*g+O*m),P>=B||-P>=B)return P;C=p*R,b=r*p,x=b-(b-p),_=p-x,b=r*R,w=b-(b-R),k=R-w,S=_*k-(C-x*w-_*w-x*k),D=m*O,b=r*m,x=b-(b-m),_=m-x,b=r*O,w=b-(b-O),k=O-w,F=_*k-(D-x*w-_*w-x*k),A=S-F,v=S-A,c[0]=S-(A+v)+(v-F),E=C+A,v=E-C,M=C-(E-v)+(A-v),A=M-D,v=M-A,c[1]=M-(A+v)+(v-D),T=E+A,v=T-E,c[2]=E-(T-v)+(A-v),c[3]=T;const L=i(4,a,4,c,s);C=N*y,b=r*N,x=b-(b-N),_=N-x,b=r*y,w=b-(b-y),k=y-w,S=_*k-(C-x*w-_*w-x*k),D=z*g,b=r*z,x=b-(b-z),_=z-x,b=r*g,w=b-(b-g),k=g-w,F=_*k-(D-x*w-_*w-x*k),A=S-F,v=S-A,c[0]=S-(A+v)+(v-F),E=C+A,v=E-C,M=C-(E-v)+(A-v),A=M-D,v=M-A,c[1]=M-(A+v)+(v-D),T=E+A,v=T-E,c[2]=E-(T-v)+(A-v),c[3]=T;const j=i(L,s,4,c,l);C=p*y,b=r*p,x=b-(b-p),_=p-x,b=r*y,w=b-(b-y),k=y-w,S=_*k-(C-x*w-_*w-x*k),D=m*g,b=r*m,x=b-(b-m),_=m-x,b=r*g,w=b-(b-g),k=g-w,F=_*k-(D-x*w-_*w-x*k),A=S-F,v=S-A,c[0]=S-(A+v)+(v-F),E=C+A,v=E-C,M=C-(E-v)+(A-v),A=M-D,v=M-A,c[1]=M-(A+v)+(v-D),T=E+A,v=T-E,c[2]=E-(T-v)+(A-v),c[3]=T;const U=i(j,l,4,c,u);return u[U-1]}(t,e,n,o,f,d,g)}o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(8),o(8),o(8),o(4),o(8),o(8),o(8),o(12),o(192),o(192),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(8),o(8),o(8),o(8),o(8),o(8),o(8),o(8),o(8),o(4),o(4),o(4),o(8),o(16),o(16),o(16),o(32),o(32),o(48),o(64),o(1152),o(1152),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(4),o(24),o(24),o(24),o(24),o(24),o(24),o(24),o(24),o(24),o(24),o(1152),o(1152),o(1152),o(1152),o(1152),o(2304),o(2304),o(3456),o(5760),o(8),o(8),o(8),o(16),o(24),o(48),o(48),o(96),o(192),o(384),o(384),o(384),o(768),o(96),o(96),o(96),o(1152);const d=Math.pow(2,-52),h=new Uint32Array(512);class p{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_;const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new p(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let a=1/0,s=1/0,l=-1/0,u=-1/0;for(let f=0;f<o;f++){const e=t[2*f],n=t[2*f+1];e<a&&(a=e),n<s&&(s=n),e>l&&(l=e),n>u&&(u=n),this._ids[f]=f}const c=(a+l)/2,h=(s+u)/2;let p,g,b,x=1/0;for(let f=0;f<o;f++){const e=m(c,h,t[2*f],t[2*f+1]);e<x&&(p=f,x=e)}const _=t[2*p],w=t[2*p+1];x=1/0;for(let f=0;f<o;f++){if(f===p)continue;const e=m(_,w,t[2*f],t[2*f+1]);e<x&&e>0&&(g=f,x=e)}let k=t[2*g],A=t[2*g+1],E=1/0;for(let f=0;f<o;f++){if(f===p||f===g)continue;const e=y(_,w,k,A,t[2*f],t[2*f+1]);e<E&&(b=f,E=e)}let M=t[2*b],C=t[2*b+1];if(E===1/0){for(let r=0;r<o;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];v(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(f(_,w,k,A,M,C)<0){const t=g,e=k,n=A;g=b,k=M,A=C,b=t,M=e,C=n}const S=function(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l);return{x:t+(u*c-s*f)*d,y:e+(a*f-l*c)*d}}(_,w,k,A,M,C);this._cx=S.x,this._cy=S.y;for(let f=0;f<o;f++)this._dists[f]=m(t[2*f],t[2*f+1],S.x,S.y);v(this._ids,this._dists,0,o-1),this._hullStart=p;let D=3;n[p]=e[b]=g,n[g]=e[p]=b,n[b]=e[g]=p,r[p]=0,r[g]=1,r[b]=2,i.fill(-1),i[this._hashKey(_,w)]=p,i[this._hashKey(k,A)]=g,i[this._hashKey(M,C)]=b,this.trianglesLen=0,this._addTriangle(p,g,b,-1,-1,-1);for(let m,y,v=0;v<this._ids.length;v++){const o=this._ids[v],a=t[2*o],s=t[2*o+1];if(v>0&&Math.abs(a-m)<=d&&Math.abs(s-y)<=d)continue;if(m=a,y=s,o===p||o===g||o===b)continue;let l=0;for(let t=0,e=this._hashKey(a,s);t<this._hashSize&&(l=i[(e+t)%this._hashSize],-1===l||l===n[l]);t++);l=e[l];let u,c=l;for(;u=n[c],f(a,s,t[2*c],t[2*c+1],t[2*u],t[2*u+1])>=0;)if(c=u,c===l){c=-1;break}if(-1===c)continue;let h=this._addTriangle(c,o,n[c],-1,-1,r[c]);r[o]=this._legalize(h+2),r[c]=h,D++;let x=n[c];for(;u=n[x],f(a,s,t[2*x],t[2*x+1],t[2*u],t[2*u+1])<0;)h=this._addTriangle(x,o,u,r[o],-1,r[x]),r[o]=this._legalize(h+2),n[x]=x,D--,x=u;if(c===l)for(;u=e[c],f(a,s,t[2*u],t[2*u+1],t[2*c],t[2*c+1])<0;)h=this._addTriangle(u,o,c,-1,r[c],r[u]),this._legalize(h+2),r[u]=h,n[c]=c,D--,c=u;this._hullStart=e[o]=c,n[c]=e[x]=o,n[o]=x,i[this._hashKey(a,s)]=o,i[this._hashKey(t[2*c],t[2*c+1])]=c}this.hull=new Uint32Array(D);for(let f=0,d=this._hullStart;f<D;f++)this.hull[f]=d,d=n[d];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[t],s=t-t%3;if(o=s+(t+2)%3,-1===a){if(0===i)break;t=h[--i];continue}const l=a-a%3,u=s+(t+1)%3,c=l+(a+2)%3,f=e[o],d=e[t],p=e[u],m=e[c];if(g(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*p],r[2*p+1],r[2*m],r[2*m+1])){e[t]=m,e[a]=f;const r=n[c];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(a,n[o]),this._link(o,c);const s=l+(a+1)%3;i<h.length&&(h[i++]=s)}else{if(0===i)break;t=h[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function m(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function g(t,e,n,r,i,o,a,s){const l=t-a,u=e-s,c=n-a,f=r-s,d=i-a,h=o-s,p=c*c+f*f,m=d*d+h*h;return l*(f*m-p*h)-u*(c*m-p*d)+(l*l+u*u)*(c*h-f*d)<0}function y(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=(u*c-s*f)*d,p=(a*f-l*c)*d;return h*h+p*p}function v(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=n&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=n+1,o=r;b(t,n+r>>1,i),e[t[n]]>e[t[r]]&&b(t,n,r),e[t[i]]>e[t[r]]&&b(t,i,r),e[t[n]]>e[t[i]]&&b(t,n,i);const a=t[i],s=e[a];for(;;){do{i++}while(e[t[i]]<s);do{o--}while(e[t[o]]>s);if(o<i)break;b(t,i,o)}t[n+1]=t[o],t[o]=a,r-i+1>=o-n?(v(t,e,i,r),v(t,e,n,o-1)):(v(t,e,n,o-1),v(t,e,i,r))}}function b(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function x(t){return t[0]}function _(t){return t[1]}const w=1e-6;class k{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>w||Math.abs(this._y1-i)>w)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}rect(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class A{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class E{constructor(t){let[e,n,r,i]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(e=+e)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this;let i,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,y=0,v=n.length;g<v;g+=3,y+=2){const r=2*n[g],s=2*n[g+1],l=2*n[g+2],u=t[r],c=t[r+1],f=t[s],d=t[s+1],h=t[l],v=t[l+1],b=f-u,x=d-c,_=h-u,w=v-c,k=2*(b*w-x*_);if(Math.abs(k)<1e-9){if(void 0===i){i=o=0;for(const n of e)i+=t[2*n],o+=t[2*n+1];i/=e.length,o/=e.length}const n=1e9*Math.sign((i-u)*w-(o-c)*_);p=(u+h)/2-n*w,m=(c+v)/2+n*_}else{const t=1/k,e=b*b+x*x,n=_*_+w*w;p=u+(w*e-x*n)*t,m=c+(b*n-_*e)*t}a[y]=p,a[y+1]=m}let s,l,u,c=e[e.length-1],f=4*c,d=t[2*c],h=t[2*c+1];r.fill(0);for(let p=0;p<e.length;++p)c=e[p],s=f,l=d,u=h,f=4*c,d=t[2*c],h=t[2*c+1],r[s+2]=r[f]=u-h,r[s+3]=r[f+1]=d-l}render(t){const e=null==t?t=new k:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let u=0,c=n.length;u<c;++u){const e=n[u];if(e<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(e/3),a=o[r],s=o[r+1],l=o[i],c=o[i+1];this._renderSegment(a,s,l,c,t)}let s,l=i[i.length-1];for(let u=0;u<i.length;++u){s=l,l=i[u];const e=2*Math.floor(r[l]/3),n=o[e],c=o[e+1],f=4*s,d=this._project(n,c,a[f+2],a[f+3]);d&&this._renderSegment(n,c,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new k:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new k:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||e.lineTo(r[o],r[o+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new A;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const a=this._regioncode(t,e),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,a=t.length;o<a;o+=2)if(e[r]===t[o]&&e[r+1]===t[o+1]&&e[(r+2)%i]===t[(o+a-2)%a]&&e[(r+3)%i]===t[(o+a-1)%a]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(e[2*n],e[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return this._simplify(n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e))}_clipFinite(t,e){const n=e.length;let r,i,o,a,s=null,l=e[n-2],u=e[n-1],c=this._regioncode(l,u),f=0;for(let d=0;d<n;d+=2)if(r=l,i=u,l=e[d],u=e[d+1],o=c,c=this._regioncode(l,u),0===o&&0===c)a=f,f=0,s?s.push(l,u):s=[l,u];else{let e,n,d,h,p;if(0===o){if(null===(e=this._clipSegment(r,i,l,u,o,c)))continue;[n,d,h,p]=e}else{if(null===(e=this._clipSegment(l,u,r,i,c,o)))continue;[h,p,n,d]=e,a=f,f=this._edgecode(n,d),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(n,d):s=[n,d]}a=f,f=this._edgecode(h,p),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(h,p):s=[h,p]}if(s)a=f,f=this._edgecode(s[0],s[1]),a&&f&&this._edge(t,a,f,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,e,n,r,i,o){const a=i<o;for(a&&([t,e,n,r,i,o]=[n,r,t,e,o,i]);;){if(0===i&&0===o)return a?[n,r,t,e]:[t,e,n,r];if(i&o)return null;let s,l,u=i||o;8&u?(s=t+(n-t)*(this.ymax-e)/(r-e),l=this.ymax):4&u?(s=t+(n-t)*(this.ymin-e)/(r-e),l=this.ymin):2&u?(l=e+(r-e)*(this.xmax-t)/(n-t),s=this.xmax):(l=e+(r-e)*(this.xmin-t)/(n-t),s=this.xmin),i?(t=s,e=l,i=this._regioncode(t,e)):(n=s,r=l,o=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,o){let a,s=Array.from(e);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(t,s))for(let l,u=0,c=s.length,f=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)l=f,f=this._edgecode(s[u],s[u+1]),l&&f&&(u=this._edge(t,l,f,s,u),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}return i}_project(t,e,n,r){let i,o,a,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(a=this.ymin,o=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(a=this.ymax,o=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(o=this.xmax,a=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(o=this.xmin,a=e+(s=i)*r)}return[o,a]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const n=(e+2)%t.length,r=(e+4)%t.length;(t[e]===t[n]&&t[n]===t[r]||t[e+1]===t[n+1]&&t[n+1]===t[r+1])&&(t.splice(n,2),e-=2)}t.length||(t=null)}return t}}const M=2*Math.PI,C=Math.pow;function S(t){return t[0]}function D(t){return t[1]}function F(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class T{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D,r=arguments.length>3?arguments[3]:void 0;return new T("length"in t?function(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=t[a];o[2*a]=e.call(r,i,a,t),o[2*a+1]=n.call(r,i,a,t)}return o}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new p(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],o=2*e[r+2];if((n[o]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[o+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,a=e.length/2;o<a;++o){const t=F(e[2*o],e[2*o+1],i);e[2*o]=t[0],e[2*o+1]=t[1]}this._delaunator=new p(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,l=n.length;s<l;++s){const t=i[s%3==2?s-2:s+1];-1!==n[s]&&-1!==o[t]||(o[t]=s)}for(let s=0,l=r.length;s<l;++s)a[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new E(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const e=a.indexOf(t);return e>0&&(yield a[e-1]),void(e<a.length-1&&(yield a[e+1]))}const s=e[t];if(-1===s)return;let l=s,u=-1;do{if(yield u=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=i[l],-1===l){const e=n[(r[t]+1)%n.length];return void(e!==u&&(yield e))}}while(l!==s)}find(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:l}=this;if(-1===r[t]||!l.length)return(t+1)%(l.length>>1);let u=t,c=C(e-l[2*t],2)+C(n-l[2*t+1],2);const f=r[t];let d=f;do{let r=s[d];const f=C(e-l[2*r],2)+C(n-l[2*r+1],2);if(f<c&&(c=f,u=r),d=d%3==2?d-2:d+1,s[d]!==t)break;if(d=a[d],-1===d){if(d=i[(o[t]+1)%i.length],d!==r&&C(e-l[2*d],2)+C(n-l[2*d+1],2)<c)return d;break}}while(d!==f);return u}render(t){const e=null==t?t=new k:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,a=r.length;o<a;++o){const e=r[o];if(e<o)continue;const a=2*i[o],s=2*i[e];t.moveTo(n[a],n[a+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"==typeof t.moveTo||(e=t,t=null),e=null==e?2:+e;const n=null==t?t=new k:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];t.moveTo(n+e,o),t.arc(n,o,e,0,M)}return n&&n.value()}renderHull(t){const e=null==t?t=new k:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let a=1;a<o;++a){const e=2*n[a];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new A;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new k:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],a=2*i[t+1],s=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[a],r[a+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new A;return this.renderTriangle(t,e),e.value()}}},3844:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r={value:()=>{}};function i(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new o(r)}function o(t){this._=t}function a(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function s(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=r,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}o.prototype=i.prototype={constructor:o,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),l=-1,u=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++l<u;)if(n=(t=o[l]).type)i[n]=s(i[n],t.name,e);else if(null==e)for(n in i)i[n]=s(i[n],t.name,null);return this}for(;++l<u;)if((n=(t=o[l]).type)&&(n=a(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new o(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const l=i},2157:(t,e,n)=>{"use strict";var r,i,o,a;n.d(e,{WU:()=>i,jH:()=>o}),a={thousands:",",grouping:[3],currency:["$",""]},r=(0,n(7474).Z)(a),i=r.format,o=r.formatPrefix},3857:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(4380);function i(t){return(t=(0,r.V)(Math.abs(t)))?t[1]:NaN}},4380:(t,e,n)=>{"use strict";function r(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function i(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}n.d(e,{V:()=>i,Z:()=>r})},9255:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i(t){if(!(e=r.exec(t)))throw new Error("invalid format: "+t);var e;return new o({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function o(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}i.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}},7474:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var r,i=n(3857),o=n(9255),a=n(4380);function s(t,e){var n=(0,a.V)(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const l={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:a.Z,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>s(100*t,e),r:s,s:function(t,e){var n=(0,a.V)(t,e);if(!n)return t+"";var i=n[0],o=n[1],s=o-(r=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=i.length;return s===l?i:s>l?i+new Array(s-l+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+(0,a.V)(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function u(t){return t}var c=Array.prototype.map,f=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function d(t){var e,n,a=void 0===t.grouping||void 0===t.thousands?u:(e=c.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),s=void 0===t.currency?"":t.currency[0]+"",d=void 0===t.currency?"":t.currency[1]+"",h=void 0===t.decimal?".":t.decimal+"",p=void 0===t.numerals?u:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(c.call(t.numerals,String)),m=void 0===t.percent?"%":t.percent+"",g=void 0===t.minus?"\u2212":t.minus+"",y=void 0===t.nan?"NaN":t.nan+"";function v(t){var e=(t=(0,o.Z)(t)).fill,n=t.align,i=t.sign,u=t.symbol,c=t.zero,v=t.width,b=t.comma,x=t.precision,_=t.trim,w=t.type;"n"===w?(b=!0,w="g"):l[w]||(void 0===x&&(x=12),_=!0,w="g"),(c||"0"===e&&"="===n)&&(c=!0,e="0",n="=");var k="$"===u?s:"#"===u&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",A="$"===u?d:/[%p]/.test(w)?m:"",E=l[w],M=/[defgprs%]/.test(w);function C(t){var o,s,l,u=k,d=A;if("c"===w)d=E(t)+d,t="";else{var m=(t=+t)<0||1/t<0;if(t=isNaN(t)?y:E(Math.abs(t),x),_&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),m&&0==+t&&"+"!==i&&(m=!1),u=(m?"("===i?i:g:"-"===i||"("===i?"":i)+u,d=("s"===w?f[8+r/3]:"")+d+(m&&"("===i?")":""),M)for(o=-1,s=t.length;++o<s;)if(48>(l=t.charCodeAt(o))||l>57){d=(46===l?h+t.slice(o+1):t.slice(o))+d,t=t.slice(0,o);break}}b&&!c&&(t=a(t,1/0));var C=u.length+t.length+d.length,S=C<v?new Array(v-C+1).join(e):"";switch(b&&c&&(t=a(S+t,S.length?v-d.length:1/0),S=""),n){case"<":t=u+t+d+S;break;case"=":t=u+S+t+d;break;case"^":t=S.slice(0,C=S.length>>1)+u+t+d+S.slice(C);break;default:t=S+u+t+d}return p(t)}return x=void 0===x?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x)),C.toString=function(){return t+""},C}return{format:v,formatPrefix:function(t,e){var n=v(((t=(0,o.Z)(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor((0,i.Z)(e)/3))),a=Math.pow(10,-r),s=f[8+r/3];return function(t){return n(a*t)+s}}}}},7332:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(3857);function i(t){return Math.max(0,-(0,r.Z)(Math.abs(t)))}},8419:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(3857);function i(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor((0,r.Z)(e)/3)))-(0,r.Z)(Math.abs(t)))}},8728:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(3857);function i(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,(0,r.Z)(e)-(0,r.Z)(t))+1}},8246:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=t=>t},3909:(t,e,n)=>{"use strict";n.d(e,{BZ:()=>l,Ho:()=>r,Kh:()=>A,O$:()=>x,OR:()=>k,Qq:()=>g,RW:()=>u,Wn:()=>f,Xx:()=>_,ZR:()=>E,_b:()=>w,_m:()=>y,aW:()=>i,cM:()=>v,fv:()=>h,mC:()=>p,mD:()=>m,ou:()=>a,pi:()=>o,pu:()=>s,sQ:()=>b,uR:()=>c,z4:()=>d});var r=1e-6,i=1e-12,o=Math.PI,a=o/2,s=o/4,l=2*o,u=180/o,c=o/180,f=Math.abs,d=Math.atan,h=Math.atan2,p=Math.cos,m=Math.ceil,g=Math.exp,y=(Math.floor,Math.hypot),v=Math.log,b=Math.pow,x=Math.sin,_=Math.sign||function(t){return t>0?1:t<0?-1:0},w=Math.sqrt,k=Math.tan;function A(t){return t>1?0:t<-1?o:Math.acos(t)}function E(t){return t>1?a:t<-1?-a:Math.asin(t)}},858:(t,e,n)=>{"use strict";function r(){}n.d(e,{Z:()=>r})},8555:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(858),i=1/0,o=i,a=-i,s=a;const l={point:function(t,e){t<i&&(i=t),t>a&&(a=t),e<o&&(o=e),e>s&&(s=e)},lineStart:r.Z,lineEnd:r.Z,polygonStart:r.Z,polygonEnd:r.Z,result:function(){var t=[[i,o],[a,s]];return a=s=-(o=i=1/0),t}}},6049:(t,e,n)=>{"use strict";n.d(e,{Z:()=>ht});var r,i,o,a,s=n(8246),l=n(2708),u=n(5852),c=n(3909),f=n(858),d=new u.dU,h=new u.dU,p={point:f.Z,lineStart:f.Z,lineEnd:f.Z,polygonStart:function(){p.lineStart=m,p.lineEnd=v},polygonEnd:function(){p.lineStart=p.lineEnd=p.point=f.Z,d.add((0,c.Wn)(h)),h=new u.dU},result:function(){var t=d/2;return d=new u.dU,t}};function m(){p.point=g}function g(t,e){p.point=y,r=o=t,i=a=e}function y(t,e){h.add(a*t-o*e),o=t,a=e}function v(){y(r,i)}const b=p;var x,E,M,C,S=n(8555),D=0,F=0,T=0,N=0,O=0,z=0,R=0,P=0,B=0,L={point:j,lineStart:q,lineEnd:$,polygonStart:function(){L.lineStart=H,L.lineEnd=Z},polygonEnd:function(){L.point=j,L.lineStart=q,L.lineEnd=$},result:function(){var t=B?[R/B,P/B]:z?[N/z,O/z]:T?[D/T,F/T]:[NaN,NaN];return D=F=T=N=O=z=R=P=B=0,t}};function j(t,e){D+=t,F+=e,++T}function q(){L.point=I}function I(t,e){L.point=W,j(M=t,C=e)}function W(t,e){var n=t-M,r=e-C,i=(0,c._b)(n*n+r*r);N+=i*(M+t)/2,O+=i*(C+e)/2,z+=i,j(M=t,C=e)}function $(){L.point=j}function H(){L.point=Y}function Z(){V(x,E)}function Y(t,e){L.point=V,j(x=M=t,E=C=e)}function V(t,e){var n=t-M,r=e-C,i=(0,c._b)(n*n+r*r);N+=i*(M+t)/2,O+=i*(C+e)/2,z+=i,R+=(i=C*t-M*e)*(M+t),P+=i*(C+e),B+=3*i,j(M=t,C=e)}const G=L;function X(t){this._context=t}X.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,c.BZ)}},result:f.Z};var Q,J,K,tt,et,nt=new u.dU,rt={point:f.Z,lineStart:function(){rt.point=it},lineEnd:function(){Q&&ot(J,K),rt.point=f.Z},polygonStart:function(){Q=!0},polygonEnd:function(){Q=null},result:function(){var t=+nt;return nt=new u.dU,t}};function it(t,e){rt.point=ot,J=tt=t,K=et=e}function ot(t,e){tt-=t,et-=e,nt.add((0,c._b)(tt*tt+et*et)),tt=t,et=e}const at=rt;let st,lt,ut,ct;class ft{constructor(t){this._append=null==t?dt:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));if(e>15)return dt;if(e!==st){const t=10**e;st=e,lt=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return lt}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append(_||(_=U(["M",",",""])),t,e),this._point=1;break;case 1:this._append(w||(w=U(["L",",",""])),t,e);break;default:if(this._append(k||(k=U(["M",",",""])),t,e),this._radius!==ut||this._append!==lt){const t=this._radius,e=this._;this._="",this._append(A||(A=U(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),t,t,t,-2*t,t,t,2*t),ut=t,lt=this._append,ct=this._,this._=e}this._+=ct}}result(){const t=this._;return this._="",t.length?t:null}}function dt(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function ht(t,e){let n,r,i=3,o=4.5;function a(t){return t&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),(0,l.Z)(t,n(r))),r.result()}return a.area=function(t){return(0,l.Z)(t,n(b)),b.result()},a.measure=function(t){return(0,l.Z)(t,n(at)),at.result()},a.bounds=function(t){return(0,l.Z)(t,n(S.Z)),S.Z.result()},a.centroid=function(t){return(0,l.Z)(t,n(G)),G.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,s.Z):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new ft(i)):new X(e=t),"function"!=typeof o&&r.pointRadius(o),a):e},a.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(r.pointRadius(+t),+t),a):o},a.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));i=e}return null===e&&(r=new ft(i)),a},a.projection(t).digits(i).context(e)}},2708:(t,e,n)=>{"use strict";function r(t,e){t&&o.hasOwnProperty(t.type)&&o[t.type](t,e)}n.d(e,{Z:()=>l});var i={Feature:function(t,e){r(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,o=n.length;++i<o;)r(n[i].geometry,e)}},o={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){a(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)a(n[r],e,0)},Polygon:function(t,e){s(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)s(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,o=n.length;++i<o;)r(n[i],e)}};function a(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function s(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)a(t[n],e,1);e.polygonEnd()}function l(t,e){t&&i.hasOwnProperty(t.type)?i[t.type](t,e):r(t,e)}},7353:(t,e,n)=>{"use strict";function r(t){return null==t?null:i(t)}function i(t){if("function"!=typeof t)throw new Error;return t}n.d(e,{C:()=>i,j:()=>r})},9247:(t,e,n)=>{"use strict";function r(t,e){return t.parent===e.parent?1:2}function i(t,e){return t+e.x}function o(t,e){return Math.max(t,e.y)}function a(){var t=r,e=1,n=1,a=!1;function s(r){var s,l=0;r.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(i,0)/t.length}(n),e.y=function(t){return 1+t.reduce(o,0)}(n)):(e.x=s?l+=t(e,s):0,e.y=0,s=e)}));var u=function(t){for(var e;e=t.children;)t=e[0];return t}(r),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(r),f=u.x-t(u,c)/2,d=c.x+t(c,u)/2;return r.eachAfter(a?function(t){t.x=(t.x-r.x)*e,t.y=(r.y-t.y)*n}:function(t){t.x=(t.x-f)/(d-f)*e,t.y=(1-(r.y?t.y/r.y:1))*n})}return s.separation=function(e){return arguments.length?(t=e,s):t},s.size=function(t){return arguments.length?(a=!1,e=+t[0],n=+t[1],s):a?null:[e,n]},s.nodeSize=function(t){return arguments.length?(a=!0,e=+t[0],n=+t[1],s):a?[e,n]:null},s}n.d(e,{Z:()=>a})},470:(t,e,n)=>{"use strict";function r(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function i(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=a)):void 0===e&&(e=o);for(var n,r,i,s,c,f=new u(t),d=[f];n=d.pop();)if((i=e(n.data))&&(c=(i=Array.from(i)).length))for(n.children=i,s=c-1;s>=0;--s)d.push(r=i[s]=new u(i[s])),r.parent=n,r.depth=n.depth+1;return f.eachBefore(l)}function o(t){return t.children}function a(t){return Array.isArray(t)?t[1]:null}function s(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function l(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function u(t){this.data=t,this.depth=this.height=0,this.parent=null}n.d(e,{NB:()=>u,le:()=>l,ZP:()=>i}),u.prototype=i.prototype={constructor:u,count:function(){return this.eachAfter(r)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(e,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return i(this).eachBefore(s)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}}},8330:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(7353),i=n(470),o={depth:-1},a={},s={};function l(t){return t.id}function u(t){return t.parentId}function c(){var t,e=l,n=u;function c(r){var l,u,c,h,p,m,g,y,v=Array.from(r),b=e,x=n,_=new Map;if(null!=t){const e=v.map(((e,n)=>function(t){let e=(t="".concat(t)).length;return d(t,e-1)&&!d(t,e-2)&&(t=t.slice(0,-1)),"/"===t[0]?t:"/".concat(t)}(t(e,n,r)))),n=e.map(f),i=new Set(e).add("");for(const t of n)i.has(t)||(i.add(t),e.push(t),n.push(f(t)),v.push(s));b=(t,n)=>e[n],x=(t,e)=>n[e]}for(c=0,l=v.length;c<l;++c)u=v[c],m=v[c]=new i.NB(u),null!=(g=b(u,c,r))&&(g+="")&&(y=m.id=g,_.set(y,_.has(y)?a:m)),null!=(g=x(u,c,r))&&(g+="")&&(m.parent=g);for(c=0;c<l;++c)if(g=(m=v[c]).parent){if(!(p=_.get(g)))throw new Error("missing: "+g);if(p===a)throw new Error("ambiguous: "+g);p.children?p.children.push(m):p.children=[m],m.parent=p}else{if(h)throw new Error("multiple roots");h=m}if(!h)throw new Error("no root");if(null!=t){for(;h.data===s&&1===h.children.length;)h=h.children[0],--l;for(let t=v.length-1;t>=0&&(m=v[t]).data===s;--t)m.data=null}if(h.parent=o,h.eachBefore((function(t){t.depth=t.parent.depth+1,--l})).eachBefore(i.le),h.parent=null,l>0)throw new Error("cycle");return h}return c.id=function(t){return arguments.length?(e=(0,r.j)(t),c):e},c.parentId=function(t){return arguments.length?(n=(0,r.j)(t),c):n},c.path=function(e){return arguments.length?(t=(0,r.j)(e),c):t},c}function f(t){let e=t.length;if(e<2)return"";for(;--e>1&&!d(t,e););return t.slice(0,e)}function d(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}},2324:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(470);function i(t,e){return t.parent===e.parent?1:2}function o(t){var e=t.children;return e?e[0]:t.t}function a(t){var e=t.children;return e?e[e.length-1]:t.t}function s(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function l(t,e,n){return t.a.parent===e.parent?t.a:n}function u(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function c(){var t=i,e=1,n=1,r=null;function c(i){var o=function(t){for(var e,n,r,i,o,a=new u(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new u(r[i],i)),n.parent=e;return(a.parent=new u(null,0)).children=[a],a}(i);if(o.eachAfter(f),o.parent.m=-o.z,o.eachBefore(d),r)i.eachBefore(h);else{var a=i,s=i,l=i;i.eachBefore((function(t){t.x<a.x&&(a=t),t.x>s.x&&(s=t),t.depth>l.depth&&(l=t)}));var c=a===s?1:t(a,s)/2,p=c-a.x,m=e/(s.x+c+p),g=n/(l.depth||1);i.eachBefore((function(t){t.x=(t.x+p)*m,t.y=t.depth*g}))}return i}function f(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var u=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-u):e.z=u}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,u=e,c=e,f=n,d=u.parent.children[0],h=u.m,p=c.m,m=f.m,g=d.m;f=a(f),u=o(u),f&&u;)d=o(d),(c=a(c)).a=e,(i=f.z+m-u.z-h+t(f._,u._))>0&&(s(l(f,e,r),e,i),h+=i,p+=i),m+=f.m,h+=u.m,g+=d.m,p+=c.m;f&&!a(c)&&(c.t=f,c.m+=m-p),u&&!o(d)&&(d.t=u,d.m+=h-g,r=e)}return r}(e,i,e.parent.A||r[0])}function d(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function h(t){t.x*=e,t.y=t.depth*n}return c.separation=function(e){return arguments.length?(t=e,c):t},c.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],c):r?null:[e,n]},c.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],c):r?[e,n]:null},c}u.prototype=Object.create(r.NB.prototype)},1366:(t,e,n)=>{"use strict";n.d(e,{M:()=>a,Z:()=>o});var r=n(120),i=n(645);function o(t,e){return((0,i.v)(e)?i.Z:a)(t,e)}function a(t,e){var n,i=e?e.length:0,o=t?Math.min(i,t.length):0,a=new Array(o),s=new Array(i);for(n=0;n<o;++n)a[n]=(0,r.Z)(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<o;++n)s[n]=a[n](t);return s}}},311:(t,e,n)=>{"use strict";function r(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function i(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[i],a=t[i+1],s=i>0?t[i-1]:2*o-a,l=i<e-1?t[i+2]:2*a-o;return r((n-i/e)*e,s,o,a,l)}}n.d(e,{Z:()=>i,t:()=>r})},4861:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(311);function i(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),o=t[(i+e-1)%e],a=t[i%e],s=t[(i+1)%e],l=t[(i+2)%e];return(0,r.t)((n-i/e)*e,o,a,s,l)}}},7814:(t,e,n)=>{"use strict";n.d(e,{ZP:()=>s,wx:()=>o,yi:()=>a});var r=n(653);function i(t,e){return function(n){return t+n*e}}function o(t,e){var n=e-t;return n?i(t,n>180||n<-180?n-360*Math.round(n/360):n):(0,r.Z)(isNaN(t)?e:t)}function a(t){return 1==(t=+t)?s:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):(0,r.Z)(isNaN(e)?n:e)}}function s(t,e){var n=e-t;return n?i(t,n):(0,r.Z)(isNaN(t)?e:t)}},653:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=t=>()=>t},7090:(t,e,n)=>{"use strict";n.d(e,{B:()=>s,Z:()=>a});var r=n(1461),i=n(7814);function o(t){return function e(n){function o(e,o){var a=t((e=(0,r.Z)(e)).h,(o=(0,r.Z)(o)).h),s=(0,i.ZP)(e.s,o.s),l=(0,i.ZP)(e.l,o.l),u=(0,i.ZP)(e.opacity,o.opacity);return function(t){return e.h=a(t),e.s=s(t),e.l=l(Math.pow(t,n)),e.opacity=u(t),e+""}}return n=+n,o.gamma=e,o}(1)}const a=o(i.wx);var s=o(i.ZP)},1229:(t,e,n)=>{"use strict";function r(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}n.d(e,{Z:()=>r})},1440:(t,e,n)=>{"use strict";n.r(e),n.d(e,{interpolate:()=>r.Z,interpolateArray:()=>i.Z,interpolateBasis:()=>o.Z,interpolateBasisClosed:()=>a.Z,interpolateCubehelix:()=>D.Z,interpolateCubehelixLong:()=>D.B,interpolateDate:()=>s.Z,interpolateDiscrete:()=>l,interpolateHcl:()=>C,interpolateHclLong:()=>S,interpolateHsl:()=>w,interpolateHslLong:()=>k,interpolateHue:()=>c,interpolateLab:()=>E,interpolateNumber:()=>f.Z,interpolateNumberArray:()=>d.Z,interpolateObject:()=>h.Z,interpolateRgb:()=>b.ZP,interpolateRgbBasis:()=>b.hD,interpolateRgbBasisClosed:()=>b.YD,interpolateRound:()=>p.Z,interpolateString:()=>m.Z,interpolateTransformCss:()=>g.Y,interpolateTransformSvg:()=>g.w,interpolateZoom:()=>v,piecewise:()=>F.Z,quantize:()=>T});var r=n(120),i=n(1366),o=n(311),a=n(4861),s=n(1229);function l(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var u=n(7814);function c(t,e){var n=(0,u.wx)(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}var f=n(5549),d=n(645),h=n(1644),p=n(6677),m=n(7087),g=n(7275);function y(t){return((t=Math.exp(t))+1/t)/2}const v=function t(e,n,r){function i(t,i){var o,a,s=t[0],l=t[1],u=t[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-l,m=h*h+p*p;if(m<1e-12)a=Math.log(d/u)/e,o=function(t){return[s+t*h,l+t*p,u*Math.exp(e*t*a)]};else{var g=Math.sqrt(m),v=(d*d-u*u+r*m)/(2*u*n*g),b=(d*d-u*u-r*m)/(2*d*n*g),x=Math.log(Math.sqrt(v*v+1)-v),_=Math.log(Math.sqrt(b*b+1)-b);a=(_-x)/e,o=function(t){var r,i=t*a,o=y(x),c=u/(n*g)*(o*(r=e*i+x,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(x));return[s+c*h,l+c*p,u*o/y(e*i+x)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);var b=n(1775),x=n(5141);function _(t){return function(e,n){var r=t((e=(0,x.Ym)(e)).h,(n=(0,x.Ym)(n)).h),i=(0,u.ZP)(e.s,n.s),o=(0,u.ZP)(e.l,n.l),a=(0,u.ZP)(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}const w=_(u.wx);var k=_(u.ZP),A=n(6993);function E(t,e){var n=(0,u.ZP)((t=(0,A.ZP)(t)).l,(e=(0,A.ZP)(e)).l),r=(0,u.ZP)(t.a,e.a),i=(0,u.ZP)(t.b,e.b),o=(0,u.ZP)(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function M(t){return function(e,n){var r=t((e=(0,A.Uc)(e)).h,(n=(0,A.Uc)(n)).h),i=(0,u.ZP)(e.c,n.c),o=(0,u.ZP)(e.l,n.l),a=(0,u.ZP)(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}const C=M(u.wx);var S=M(u.ZP),D=n(7090),F=n(5626);function T(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}},5549:(t,e,n)=>{"use strict";function r(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}n.d(e,{Z:()=>r})},645:(t,e,n)=>{"use strict";function r(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function i(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}n.d(e,{Z:()=>r,v:()=>i})},1644:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(120);function i(t,e){var n,i={},o={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=(0,r.Z)(t[n],e[n]):o[n]=e[n];return function(t){for(n in i)o[n]=i[n](t);return o}}},5626:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(120);function i(t,e){void 0===e&&(e=t,t=r.Z);for(var n=0,i=e.length-1,o=e[0],a=new Array(i<0?0:i);n<i;)a[n]=t(o,o=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return a[e](t-e)}}},1775:(t,e,n)=>{"use strict";n.d(e,{YD:()=>c,ZP:()=>s,hD:()=>u});var r=n(5141),i=n(311),o=n(4861),a=n(7814);const s=function t(e){var n=(0,a.yi)(e);function i(t,e){var i=n((t=(0,r.B8)(t)).r,(e=(0,r.B8)(e)).r),o=n(t.g,e.g),s=n(t.b,e.b),l=(0,a.ZP)(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=o(e),t.b=s(e),t.opacity=l(e),t+""}}return i.gamma=t,i}(1);function l(t){return function(e){var n,i,o=e.length,a=new Array(o),s=new Array(o),l=new Array(o);for(n=0;n<o;++n)i=(0,r.B8)(e[n]),a[n]=i.r||0,s[n]=i.g||0,l[n]=i.b||0;return a=t(a),s=t(s),l=t(l),i.opacity=1,function(t){return i.r=a(t),i.g=s(t),i.b=l(t),i+""}}}var u=l(i.Z),c=l(o.Z)},6677:(t,e,n)=>{"use strict";function r(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}n.d(e,{Z:()=>r})},7087:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(5549),i=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,o=new RegExp(i.source,"g");function a(t,e){var n,a,s,l=i.lastIndex=o.lastIndex=0,u=-1,c=[],f=[];for(t+="",e+="";(n=i.exec(t))&&(a=o.exec(e));)(s=a.index)>l&&(s=e.slice(l,s),c[u]?c[u]+=s:c[++u]=s),(n=n[0])===(a=a[0])?c[u]?c[u]+=a:c[++u]=a:(c[++u]=null,f.push({i:u,x:(0,r.Z)(n,a)})),l=o.lastIndex;return l<e.length&&(s=e.slice(l),c[u]?c[u]+=s:c[++u]=s),c.length<2?f[0]?function(t){return function(e){return t(e)+""}}(f[0].x):function(t){return function(){return t}}(e):(e=f.length,function(t){for(var n,r=0;r<e;++r)c[(n=f[r]).i]=n.x(t);return c.join("")})}},7275:(t,e,n)=>{"use strict";n.d(e,{Y:()=>u,w:()=>c});var r,i=n(5549),o=180/Math.PI,a={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function s(t,e,n,r,i,a){var s,l,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,u/=l),t*r<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*o,skewX:Math.atan(u)*o,scaleX:s,scaleY:l}}function l(t,e,n,r){function o(t){return t.length?t.pop()+" ":""}return function(a,s){var l=[],u=[];return a=t(a),s=t(s),function(t,r,o,a,s,l){if(t!==o||r!==a){var u=s.push("translate(",null,e,null,n);l.push({i:u-4,x:(0,i.Z)(t,o)},{i:u-2,x:(0,i.Z)(r,a)})}else(o||a)&&s.push("translate("+o+e+a+n)}(a.translateX,a.translateY,s.translateX,s.translateY,l,u),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(o(n)+"rotate(",null,r)-2,x:(0,i.Z)(t,e)})):e&&n.push(o(n)+"rotate("+e+r)}(a.rotate,s.rotate,l,u),function(t,e,n,a){t!==e?a.push({i:n.push(o(n)+"skewX(",null,r)-2,x:(0,i.Z)(t,e)}):e&&n.push(o(n)+"skewX("+e+r)}(a.skewX,s.skewX,l,u),function(t,e,n,r,a,s){if(t!==n||e!==r){var l=a.push(o(a)+"scale(",null,",",null,")");s.push({i:l-4,x:(0,i.Z)(t,n)},{i:l-2,x:(0,i.Z)(e,r)})}else 1===n&&1===r||a.push(o(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,s.scaleX,s.scaleY,l,u),a=s=null,function(t){for(var e,n=-1,r=u.length;++n<r;)l[(e=u[n]).i]=e.x(t);return l.join("")}}}var u=l((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?a:s(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),c=l((function(t){return null==t?a:(r||(r=document.createElementNS("http://www.w3.org/2000/svg","g")),r.setAttribute("transform",t),(t=r.transform.baseVal.consolidate())?s((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):a)}),", ",")",")")},120:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var r=n(5141),i=n(1775),o=n(1366),a=n(1229),s=n(5549),l=n(1644),u=n(7087),c=n(653),f=n(645);function d(t,e){var n,d=typeof e;return null==e||"boolean"===d?(0,c.Z)(e):("number"===d?s.Z:"string"===d?(n=(0,r.ZP)(e))?(e=n,i.ZP):u.Z:e instanceof r.ZP?i.ZP:e instanceof Date?a.Z:(0,f.v)(e)?f.Z:Array.isArray(e)?o.M:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?l.Z:s.Z)(t,e)}},9205:(t,e,n)=>{"use strict";n.d(e,{ET:()=>u,y$:()=>l});const r=Math.PI,i=2*r,o=1e-6,a=i-o;function s(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class l{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?s:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: ".concat(t));if(e>15)return s;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append(E||(E=U(["M",",",""])),this._x0=this._x1=+t,this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(M||(M=U(["Z"]))))}lineTo(t,e){this._append(C||(C=U(["L",",",""])),this._x1=+t,this._y1=+e)}quadraticCurveTo(t,e,n,r){this._append(S||(S=U(["Q",",",",",",",""])),+t,+e,this._x1=+n,this._y1=+r)}bezierCurveTo(t,e,n,r,i,o){this._append(D||(D=U(["C",",",",",",",",",",",""])),+t,+e,+n,+r,this._x1=+i,this._y1=+o)}arcTo(t,e,n,i,a){if(t=+t,e=+e,n=+n,i=+i,(a=+a)<0)throw new Error("negative radius: ".concat(a));let s=this._x1,l=this._y1,u=n-t,c=i-e,f=s-t,d=l-e,h=f*f+d*d;if(null===this._x1)this._append(F||(F=U(["M",",",""])),this._x1=t,this._y1=e);else if(h>o)if(Math.abs(d*u-c*f)>o&&a){let p=n-s,m=i-l,g=u*u+c*c,y=p*p+m*m,v=Math.sqrt(g),b=Math.sqrt(h),x=a*Math.tan((r-Math.acos((g+h-y)/(2*v*b)))/2),_=x/b,w=x/v;Math.abs(_-1)>o&&this._append(T||(T=U(["L",",",""])),t+_*f,e+_*d),this._append(N||(N=U(["A",",",",0,0,",",",",",""])),a,a,+(d*p>f*m),this._x1=t+w*u,this._y1=e+w*c)}else this._append(O||(O=U(["L",",",""])),this._x1=t,this._y1=e)}arc(t,e,n,s,l,u){if(t=+t,e=+e,u=!!u,(n=+n)<0)throw new Error("negative radius: ".concat(n));let c=n*Math.cos(s),f=n*Math.sin(s),d=t+c,h=e+f,p=1^u,m=u?s-l:l-s;null===this._x1?this._append(z||(z=U(["M",",",""])),d,h):(Math.abs(this._x1-d)>o||Math.abs(this._y1-h)>o)&&this._append(R||(R=U(["L",",",""])),d,h),n&&(m<0&&(m=m%i+i),m>a?this._append(P||(P=U(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,p,t-c,e-f,n,n,p,this._x1=d,this._y1=h):m>o&&this._append(B||(B=U(["A",",",",0,",",",",",",",""])),n,n,+(m>=r),p,this._x1=t+n*Math.cos(l),this._y1=e+n*Math.sin(l)))}rect(t,e,n,r){this._append(L||(L=U(["M",",","h","v","h","Z"])),this._x0=this._x1=+t,this._y0=this._y1=+e,n=+n,+r,-n)}toString(){return this._}}function u(){return new l}u.prototype=l.prototype},4716:(t,e,n)=>{"use strict";n.d(e,{JG:()=>h,ZP:()=>m,yR:()=>u,l4:()=>p});var r=n(940),i=n(120),o=n(5549),a=n(6677),s=n(8724),l=[0,1];function u(t){return t}function c(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function f(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=c(i,r),o=n(a,o)):(r=c(r,i),o=n(o,a)),function(t){return o(r(t))}}function d(t,e,n){var i=Math.min(t.length,e.length)-1,o=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)o[s]=c(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(e){var n=(0,r.ZP)(t,e,1,i)-1;return a[n](o[n](e))}}function h(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function p(){var t,e,n,r,c,h,p=l,m=l,g=i.Z,y=u;function v(){var t,e,n,i=Math.min(p.length,m.length);return y!==u&&(t=p[0],e=p[i-1],t>e&&(n=t,t=e,e=n),y=function(n){return Math.max(t,Math.min(e,n))}),r=i>2?d:f,c=h=null,b}function b(e){return null==e||isNaN(e=+e)?n:(c||(c=r(p.map(t),m,g)))(t(y(e)))}return b.invert=function(n){return y(e((h||(h=r(m,p.map(t),o.Z)))(n)))},b.domain=function(t){return arguments.length?(p=Array.from(t,s.Z),v()):p.slice()},b.range=function(t){return arguments.length?(m=Array.from(t),v()):m.slice()},b.rangeRound=function(t){return m=Array.from(t),g=a.Z,v()},b.clamp=function(t){return arguments.length?(y=!!t||u,v()):y!==u},b.interpolate=function(t){return arguments.length?(g=t,v()):g},b.unknown=function(t){return arguments.length?(n=t,b):n},function(n,r){return t=n,e=r,v()}}function m(){return p()(u,u)}},6194:(t,e,n)=>{"use strict";n.d(e,{Km:()=>v,QA:()=>m,UM:()=>g,ZP:()=>p,ld:()=>y});var r=n(5626),i=n(120),o=n(6677),a=n(4716),s=n(8753),l=n(8622),u=n(4201),c=n(3582),f=n(3486),d=n(9069);function h(){var t,e,n,s,l,u,c,f=0,d=.5,h=1,p=1,m=a.yR,g=!1;function y(t){return isNaN(t=+t)?c:(t=.5+((t=+u(t))-e)*(p*t<p*e?s:l),m(g?Math.max(0,Math.min(1,t)):t))}function v(t){return function(e){var n,i,o;return arguments.length?([n,i,o]=e,m=(0,r.Z)(t,[n,i,o]),y):[m(0),m(.5),m(1)]}}return y.domain=function(r){return arguments.length?([f,d,h]=r,t=u(f=+f),e=u(d=+d),n=u(h=+h),s=t===e?0:.5/(e-t),l=e===n?0:.5/(n-e),p=e<t?-1:1,y):[f,d,h]},y.clamp=function(t){return arguments.length?(g=!!t,y):g},y.interpolator=function(t){return arguments.length?(m=t,y):m},y.range=v(i.Z),y.rangeRound=v(o.Z),y.unknown=function(t){return arguments.length?(c=t,y):c},function(r){return u=r,t=r(f),e=r(d),n=r(h),s=t===e?0:.5/(e-t),l=e===n?0:.5/(n-e),p=e<t?-1:1,y}}function p(){var t=(0,l.Q)(h()(a.yR));return t.copy=function(){return(0,c.JG)(t,p())},s.O.apply(t,arguments)}function m(){var t=(0,u.Q)(h()).domain([.1,1,10]);return t.copy=function(){return(0,c.JG)(t,m()).base(t.base())},s.O.apply(t,arguments)}function g(){var t=(0,f.P)(h());return t.copy=function(){return(0,c.JG)(t,g()).constant(t.constant())},s.O.apply(t,arguments)}function y(){var t=(0,d.Hh)(h());return t.copy=function(){return(0,c.JG)(t,y()).exponent(t.exponent())},s.O.apply(t,arguments)}function v(){return y.apply(null,arguments).exponent(.5)}},2948:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(8622),i=n(8724);function o(t){var e;function n(t){return null==t||isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,i.Z),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return o(t).unknown(e)},t=arguments.length?Array.from(t,i.Z):[0,1],(0,r.Q)(n)}},8753:(t,e,n)=>{"use strict";function r(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function i(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}n.d(e,{O:()=>i,o:()=>r})},8622:(t,e,n)=>{"use strict";n.d(e,{Q:()=>s,Z:()=>l});var r=n(2497),i=n(4716),o=n(8753),a=n(3901);function s(t){var e=t.domain;return t.ticks=function(t){var n=e();return(0,r.ZP)(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return(0,a.Z)(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,o,a=e(),s=0,l=a.length-1,u=a[s],c=a[l],f=10;for(c<u&&(o=u,u=c,c=o,o=s,s=l,l=o);f-- >0;){if((o=(0,r.G9)(u,c,n))===i)return a[s]=u,a[l]=c,e(a);if(o>0)u=Math.floor(u/o)*o,c=Math.ceil(c/o)*o;else{if(!(o<0))break;u=Math.ceil(u*o)/o,c=Math.floor(c*o)/o}i=o}return t},t}function l(){var t=(0,i.ZP)();return t.copy=function(){return(0,i.JG)(t,l())},o.o.apply(t,arguments),s(t)}},4201:(t,e,n)=>{"use strict";n.d(e,{Q:()=>m,Z:()=>g});var r=n(2497),i=n(9255),o=n(2157),a=n(4792),s=n(4716),l=n(8753);function u(t){return Math.log(t)}function c(t){return Math.exp(t)}function f(t){return-Math.log(-t)}function d(t){return-Math.exp(-t)}function h(t){return isFinite(t)?+("1e"+t):t<0?0:t}function p(t){return(e,n)=>-t(-e,n)}function m(t){const e=t(u,c),n=e.domain;let s,l,m=10;function g(){return s=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(m),l=function(t){return 10===t?h:t===Math.E?Math.exp:e=>Math.pow(t,e)}(m),n()[0]<0?(s=p(s),l=p(l),t(f,d)):t(u,c),e}return e.base=function(t){return arguments.length?(m=+t,g()):m},e.domain=function(t){return arguments.length?(n(t),g()):n()},e.ticks=t=>{const e=n();let i=e[0],o=e[e.length-1];const a=o<i;a&&([i,o]=[o,i]);let u,c,f=s(i),d=s(o);const h=null==t?10:+t;let p=[];if(!(m%1)&&d-f<h){if(f=Math.floor(f),d=Math.ceil(d),i>0){for(;f<=d;++f)for(u=1;u<m;++u)if(c=f<0?u/l(-f):u*l(f),!(c<i)){if(c>o)break;p.push(c)}}else for(;f<=d;++f)for(u=m-1;u>=1;--u)if(c=f>0?u/l(-f):u*l(f),!(c<i)){if(c>o)break;p.push(c)}2*p.length<h&&(p=(0,r.ZP)(i,o,h))}else p=(0,r.ZP)(f,d,Math.min(d-f,h)).map(l);return a?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===m?"s":","),"function"!=typeof n&&(m%1||null!=(n=(0,i.Z)(n)).precision||(n.trim=!0),n=(0,o.WU)(n)),t===1/0)return n;const r=Math.max(1,m*t/e.ticks().length);return t=>{let e=t/l(Math.round(s(t)));return e*m<m-.5&&(e*=m),e<=r?n(t):""}},e.nice=()=>n((0,a.Z)(n(),{floor:t=>l(Math.floor(s(t))),ceil:t=>l(Math.ceil(s(t)))})),e}function g(){const t=m((0,s.l4)()).domain([1,10]);return t.copy=()=>(0,s.JG)(t,g()).base(t.base()),l.o.apply(t,arguments),t}},4792:(t,e,n)=>{"use strict";function r(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}n.d(e,{Z:()=>r})},8724:(t,e,n)=>{"use strict";function r(t){return+t}n.d(e,{Z:()=>r})},8928:(t,e,n)=>{"use strict";n.d(e,{O:()=>o,Z:()=>a});var r=n(6332),i=n(8753);const o=Symbol("implicit");function a(){var t=new r.L,e=[],n=[],s=o;function l(r){let i=t.get(r);if(void 0===i){if(s!==o)return s;t.set(r,i=e.push(r)-1)}return n[i%n.length]}return l.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new r.L;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return l},l.range=function(t){return arguments.length?(n=Array.from(t),l):n.slice()},l.unknown=function(t){return arguments.length?(s=t,l):s},l.copy=function(){return a(e,n).unknown(s)},i.o.apply(l,arguments),l}},9069:(t,e,n)=>{"use strict";n.d(e,{Hh:()=>u,ZP:()=>c,_b:()=>f});var r=n(8622),i=n(4716),o=n(8753);function a(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function s(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function l(t){return t<0?-t*t:t*t}function u(t){var e=t(i.yR,i.yR),n=1;return e.exponent=function(e){return arguments.length?1==(n=+e)?t(i.yR,i.yR):.5===n?t(s,l):t(a(n),a(1/n)):n},(0,r.Q)(e)}function c(){var t=u((0,i.l4)());return t.copy=function(){return(0,i.JG)(t,c()).exponent(t.exponent())},o.o.apply(t,arguments),t}function f(){return c.apply(null,arguments).exponent(.5)}},8757:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(1787),i=n(940),o=n(6801),a=n(8753);function s(){var t,e=[],n=[],l=[];function u(){var t=0,i=Math.max(1,n.length);for(l=new Array(i-1);++t<i;)l[t-1]=(0,r.s7)(e,t/i);return c}function c(e){return null==e||isNaN(e=+e)?t:n[(0,i.ZP)(l,e)]}return c.invertExtent=function(t){var r=n.indexOf(t);return r<0?[NaN,NaN]:[r>0?l[r-1]:e[0],r<l.length?l[r]:e[e.length-1]]},c.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(o.Z),u()},c.range=function(t){return arguments.length?(n=Array.from(t),u()):n.slice()},c.unknown=function(e){return arguments.length?(t=e,c):t},c.quantiles=function(){return l.slice()},c.copy=function(){return s().domain(e).range(n).unknown(t)},a.o.apply(c,arguments)}},3582:(t,e,n)=>{"use strict";n.d(e,{JG:()=>d,L2:()=>y,S5:()=>p,UN:()=>g,ZP:()=>h,cV:()=>m});var r=n(120),i=n(6677),o=n(4716),a=n(8753),s=n(8622),l=n(4201),u=n(3486),c=n(9069);function f(){var t,e,n,a,s,l=0,u=1,c=o.yR,f=!1;function d(e){return null==e||isNaN(e=+e)?s:c(0===n?.5:(e=(a(e)-t)*n,f?Math.max(0,Math.min(1,e)):e))}function h(t){return function(e){var n,r;return arguments.length?([n,r]=e,c=t(n,r),d):[c(0),c(1)]}}return d.domain=function(r){return arguments.length?([l,u]=r,t=a(l=+l),e=a(u=+u),n=t===e?0:1/(e-t),d):[l,u]},d.clamp=function(t){return arguments.length?(f=!!t,d):f},d.interpolator=function(t){return arguments.length?(c=t,d):c},d.range=h(r.Z),d.rangeRound=h(i.Z),d.unknown=function(t){return arguments.length?(s=t,d):s},function(r){return a=r,t=r(l),e=r(u),n=t===e?0:1/(e-t),d}}function d(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function h(){var t=(0,s.Q)(f()(o.yR));return t.copy=function(){return d(t,h())},a.O.apply(t,arguments)}function p(){var t=(0,l.Q)(f()).domain([1,10]);return t.copy=function(){return d(t,p()).base(t.base())},a.O.apply(t,arguments)}function m(){var t=(0,u.P)(f());return t.copy=function(){return d(t,m()).constant(t.constant())},a.O.apply(t,arguments)}function g(){var t=(0,c.Hh)(f());return t.copy=function(){return d(t,g()).exponent(t.exponent())},a.O.apply(t,arguments)}function y(){return g.apply(null,arguments).exponent(.5)}},3486:(t,e,n)=>{"use strict";n.d(e,{P:()=>l,Z:()=>u});var r=n(8622),i=n(4716),o=n(8753);function a(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function s(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function l(t){var e=1,n=t(a(e),s(e));return n.constant=function(n){return arguments.length?t(a(e=+n),s(e)):e},(0,r.Q)(n)}function u(){var t=l((0,i.l4)());return t.copy=function(){return(0,i.JG)(t,u()).constant(t.constant())},o.o.apply(t,arguments)}},220:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(940),i=n(8753);function o(){var t,e=[.5],n=[0,1],a=1;function s(i){return null!=i&&i<=i?n[(0,r.ZP)(e,i,0,a)]:t}return s.domain=function(t){return arguments.length?(e=Array.from(t),a=Math.min(e.length,n.length-1),s):e.slice()},s.range=function(t){return arguments.length?(n=Array.from(t),a=Math.min(e.length,n.length-1),s):n.slice()},s.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},s.unknown=function(e){return arguments.length?(t=e,s):t},s.copy=function(){return o().domain(e).range(n).unknown(t)},i.o.apply(s,arguments)}},3901:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(2497),i=n(9255),o=n(8419),a=n(2157),s=n(8728),l=n(7332);function u(t,e,n,u){var c,f=(0,r.ly)(t,e,n);switch((u=(0,i.Z)(null==u?",f":u)).type){case"s":var d=Math.max(Math.abs(t),Math.abs(e));return null!=u.precision||isNaN(c=(0,o.Z)(f,d))||(u.precision=c),(0,a.jH)(u,d);case"":case"e":case"g":case"p":case"r":null!=u.precision||isNaN(c=(0,s.Z)(f,Math.max(Math.abs(t),Math.abs(e))))||(u.precision=c-("e"===u.type));break;case"f":case"%":null!=u.precision||isNaN(c=(0,l.Z)(f))||(u.precision=c-2*("%"===u.type))}return(0,a.WU)(u)}},2684:(t,e,n)=>{"use strict";n.d(e,{Y:()=>y,Z:()=>v});var r=n(2736),i=n(8171),o=n(4420),a=n(9979),s=n(9650),l=n(7956),u=n(3832),c=n(8392),f=n(867),d=n(4716),h=n(8753),p=n(4792);function m(t){return new Date(t)}function g(t){return t instanceof Date?+t:+new Date(+t)}function y(t,e,n,r,i,o,a,s,l,u){var c=(0,d.ZP)(),f=c.invert,h=c.domain,v=u(".%L"),b=u(":%S"),x=u("%I:%M"),_=u("%I %p"),w=u("%a %d"),k=u("%b %d"),A=u("%B"),E=u("%Y");function M(t){return(l(t)<t?v:s(t)<t?b:a(t)<t?x:o(t)<t?_:r(t)<t?i(t)<t?w:k:n(t)<t?A:E)(t)}return c.invert=function(t){return new Date(f(t))},c.domain=function(t){return arguments.length?h(Array.from(t,g)):h().map(m)},c.ticks=function(e){var n=h();return t(n[0],n[n.length-1],null==e?10:e)},c.tickFormat=function(t,e){return null==e?M:u(e)},c.nice=function(t){var n=h();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?h((0,p.Z)(n,t)):c},c.copy=function(){return(0,d.JG)(c,y(t,e,n,r,i,o,a,s,l,u))},c}function v(){return h.o.apply(y(r.jK,r._g,i.jB,o.F0,a.Zy,s.rr,l.WQ,u.Z_,c.E,f.i$).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}},1802:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(2736),i=n(8171),o=n(4420),a=n(9979),s=n(9650),l=n(7956),u=n(3832),c=n(8392),f=n(867),d=n(2684),h=n(8753);function p(){return h.o.apply((0,d.Y)(r.WG,r.jo,i.ol,o.me,a.pI,s.AN,l.lM,u.rz,c.E,f.g0).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}},3073:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(6426),i=n(8883),o=n(8282),a=n(6985),s=n(9086),l=n(3353);function u(t,e,n){var u=null,c=(0,i.Z)(!0),f=null,d=o.Z,h=null,p=(0,s.d)(m);function m(i){var o,a,s,l,m,g=(i=(0,r.Z)(i)).length,y=!1,v=new Array(g),b=new Array(g);for(null==f&&(h=d(m=p())),o=0;o<=g;++o){if(!(o<g&&c(l=i[o],o,i))===y)if(y=!y)a=o,h.areaStart(),h.lineStart();else{for(h.lineEnd(),h.lineStart(),s=o-1;s>=a;--s)h.point(v[s],b[s]);h.lineEnd(),h.areaEnd()}y&&(v[o]=+t(l,o,i),b[o]=+e(l,o,i),h.point(u?+u(l,o,i):v[o],n?+n(l,o,i):b[o]))}if(m)return h=null,m+""||null}function g(){return(0,a.Z)().defined(c).curve(d).context(f)}return t="function"==typeof t?t:void 0===t?l.x:(0,i.Z)(+t),e="function"==typeof e?e:void 0===e?(0,i.Z)(0):(0,i.Z)(+e),n="function"==typeof n?n:void 0===n?l.y:(0,i.Z)(+n),m.x=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(+e),u=null,m):t},m.x0=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(+e),m):t},m.x1=function(t){return arguments.length?(u=null==t?null:"function"==typeof t?t:(0,i.Z)(+t),m):u},m.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(+t),n=null,m):e},m.y0=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(+t),m):e},m.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:(0,i.Z)(+t),m):n},m.lineX0=m.lineY0=function(){return g().x(t).y(e)},m.lineY1=function(){return g().x(t).y(n)},m.lineX1=function(){return g().x(u).y(e)},m.defined=function(t){return arguments.length?(c="function"==typeof t?t:(0,i.Z)(!!t),m):c},m.curve=function(t){return arguments.length?(d=t,null!=f&&(h=d(f)),m):d},m.context=function(t){return arguments.length?(null==t?f=h=null:h=d(f=t),m):f},m}},6426:(t,e,n)=>{"use strict";function r(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}n.d(e,{Z:()=>r}),Array.prototype.slice},8883:(t,e,n)=>{"use strict";function r(t){return function(){return t}}n.d(e,{Z:()=>r})},3698:(t,e,n)=>{"use strict";function r(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function i(t){this._context=t}function o(t){return new i(t)}n.d(e,{ZP:()=>o,fE:()=>i,xm:()=>r}),i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:r(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:r(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}}},7694:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(6004),i=n(3698);function o(t){this._context=t}function a(t){return new o(t)}o.prototype={areaStart:r.Z,areaEnd:r.Z,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:(0,i.xm)(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}}},7238:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(3698);function i(t){this._context=t}function o(t){return new i(t)}i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:(0,r.xm)(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}}},6545:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(3698);function i(t,e){this._basis=new r.fE(t),this._beta=e}i.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*a),this._beta*e[l]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const o=function t(e){function n(t){return 1===e?new r.fE(t):new i(t,e)}return n.beta=function(e){return t(+e)},n}(.85)},7256:(t,e,n)=>{"use strict";function r(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function i(t,e){this._context=t,this._k=(1-e)/6}n.d(e,{ZP:()=>o,pC:()=>i,xm:()=>r}),i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:r(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:r(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const o=function t(e){function n(t){return new i(t,e)}return n.tension=function(e){return t(+e)},n}(0)},7388:(t,e,n)=>{"use strict";n.d(e,{U:()=>o,Z:()=>a});var r=n(6004),i=n(7256);function o(t,e){this._context=t,this._k=(1-e)/6}o.prototype={areaStart:r.Z,areaEnd:r.Z,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:(0,i.xm)(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const a=function t(e){function n(t){return new o(t,e)}return n.tension=function(e){return t(+e)},n}(0)},2411:(t,e,n)=>{"use strict";n.d(e,{T:()=>i,Z:()=>o});var r=n(7256);function i(t,e){this._context=t,this._k=(1-e)/6}i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:(0,r.xm)(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const o=function t(e){function n(t){return new i(t,e)}return n.tension=function(e){return t(+e)},n}(0)},6360:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s,x:()=>o});var r=n(6333),i=n(7256);function o(t,e,n){var i=t._x1,o=t._y1,a=t._x2,s=t._y2;if(t._l01_a>r.Ho){var l=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*l-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,o=(o*l-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>r.Ho){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*c+t._x1*t._l23_2a-e*t._l12_2a)/f,s=(s*c+t._y1*t._l23_2a-n*t._l12_2a)/f}t._context.bezierCurveTo(i,o,a,s,t._x2,t._y2)}function a(t,e){this._context=t,this._alpha=e}a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:o(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const s=function t(e){function n(t){return e?new a(t,e):new i.pC(t,0)}return n.alpha=function(e){return t(+e)},n}(.5)},6491:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(7388),i=n(6004),o=n(6360);function a(t,e){this._context=t,this._alpha=e}a.prototype={areaStart:i.Z,areaEnd:i.Z,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:(0,o.x)(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const s=function t(e){function n(t){return e?new a(t,e):new r.U(t,0)}return n.alpha=function(e){return t(+e)},n}(.5)},6052:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(2411),i=n(6360);function o(t,e){this._context=t,this._alpha=e}o.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:(0,i.x)(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const a=function t(e){function n(t){return e?new o(t,e):new r.T(t,0)}return n.alpha=function(e){return t(+e)},n}(.5)},8282:(t,e,n)=>{"use strict";function r(t){this._context=t}function i(t){return new r(t)}n.d(e,{Z:()=>i}),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}}},2977:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(6004);function i(t){this._context=t}function o(t){return new i(t)}i.prototype={areaStart:r.Z,areaEnd:r.Z,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}}},6481:(t,e,n)=>{"use strict";function r(t){return t<0?-1:1}function i(t,e,n){var i=t._x1-t._x0,o=e-t._x1,a=(t._y1-t._y0)/(i||o<0&&-0),s=(n-t._y1)/(o||i<0&&-0),l=(a*o+s*i)/(i+o);return(r(a)+r(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(l))||0}function o(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function a(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function s(t){this._context=t}function l(t){this._context=new u(t)}function u(t){this._context=t}function c(t){return new s(t)}function f(t){return new l(t)}n.d(e,{Z:()=>c,s:()=>f}),s.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:a(this,this._t0,o(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,a(this,o(this,n=i(this,t,e)),n);break;default:a(this,this._t0,n=i(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(l.prototype=Object.create(s.prototype)).point=function(t,e){s.prototype.point.call(this,e,t)},u.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}}},9389:(t,e,n)=>{"use strict";function r(t){this._context=t}function i(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function o(t){return new r(t)}n.d(e,{Z:()=>o}),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=i(t),o=i(e),a=0,s=1;s<n;++a,++s)this._context.bezierCurveTo(r[0][a],o[0][a],r[1][a],o[1][a],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}}},3729:(t,e,n)=>{"use strict";function r(t,e){this._context=t,this._t=e}function i(t){return new r(t,.5)}function o(t){return new r(t,0)}function a(t){return new r(t,1)}n.d(e,{RN:()=>o,ZP:()=>i,cD:()=>a}),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}}},6985:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(6426),i=n(8883),o=n(8282),a=n(9086),s=n(3353);function l(t,e){var n=(0,i.Z)(!0),l=null,u=o.Z,c=null,f=(0,a.d)(d);function d(i){var o,a,s,d=(i=(0,r.Z)(i)).length,h=!1;for(null==l&&(c=u(s=f())),o=0;o<=d;++o)!(o<d&&n(a=i[o],o,i))===h&&((h=!h)?c.lineStart():c.lineEnd()),h&&c.point(+t(a,o,i),+e(a,o,i));if(s)return c=null,s+""||null}return t="function"==typeof t?t:void 0===t?s.x:(0,i.Z)(t),e="function"==typeof e?e:void 0===e?s.y:(0,i.Z)(e),d.x=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(+e),d):t},d.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(+t),d):e},d.defined=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.Z)(!!t),d):n},d.curve=function(t){return arguments.length?(u=t,null!=l&&(c=u(l)),d):u},d.context=function(t){return arguments.length?(null==t?l=c=null:c=u(l=t),d):l},d}},6333:(t,e,n)=>{"use strict";n.d(e,{BZ:()=>h,Fp:()=>a,Ho:()=>c,Kh:()=>p,O$:()=>l,VV:()=>s,Wn:()=>r,ZR:()=>m,_b:()=>u,fv:()=>i,mC:()=>o,ou:()=>d,pi:()=>f});const r=Math.abs,i=Math.atan2,o=Math.cos,a=Math.max,s=Math.min,l=Math.sin,u=Math.sqrt,c=1e-12,f=Math.PI,d=f/2,h=2*f;function p(t){return t>1?0:t<-1?f:Math.acos(t)}function m(t){return t>=1?d:t<=-1?-d:Math.asin(t)}},6004:(t,e,n)=>{"use strict";function r(){}n.d(e,{Z:()=>r})},9086:(t,e,n)=>{"use strict";n.d(e,{d:()=>i});var r=n(9205);function i(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: ".concat(n));e=t}return t},()=>new r.y$(e)}},3353:(t,e,n)=>{"use strict";function r(t){return t[0]}function i(t){return t[1]}n.d(e,{x:()=>r,y:()=>i})},9148:(t,e,n)=>{"use strict";n.d(e,{Hl:()=>v,WY:()=>b,ZP:()=>x});var r=n(8883),i=n(9086),o=n(6609),a=n(281),s=n(6709),l=n(5019),u=n(6358),c=n(9451),f=n(7609),d=n(7189),h=n(5174),p=n(4610),m=n(7810),g=n(9012),y=n(8031);const v=[a.Z,s.Z,l.Z,f.Z,h.Z,p.Z,g.Z],b=[a.Z,c.Z,y.Z,m.Z,o.Z,d.Z,u.Z];function x(t,e){let n=null,o=(0,i.d)(s);function s(){let r;if(n||(n=r=o()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"==typeof t?t:(0,r.Z)(t||a.Z),e="function"==typeof e?e:(0,r.Z)(void 0===e?64:+e),s.type=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.Z)(e),s):t},s.size=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.Z)(+t),s):e},s.context=function(t){return arguments.length?(n=null==t?null:t,s):n},s}},6609:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(6333);const i=(0,r._b)(3),o={draw(t,e){const n=.59436*(0,r._b)(e+(0,r.VV)(e/28,.75)),o=n/2,a=o*i;t.moveTo(0,n),t.lineTo(0,-n),t.moveTo(-a,-o),t.lineTo(a,o),t.moveTo(-a,o),t.lineTo(a,-o)}}},281:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6333);const i={draw(t,e){const n=(0,r._b)(e/r.pi);t.moveTo(n,0),t.arc(0,0,n,0,r.BZ)}}},6709:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6333);const i={draw(t,e){const n=(0,r._b)(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}}},5019:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(6333);const i=(0,r._b)(1/3),o=2*i,a={draw(t,e){const n=(0,r._b)(e/o),a=n*i;t.moveTo(0,-n),t.lineTo(a,0),t.lineTo(0,n),t.lineTo(-a,0),t.closePath()}}},6358:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6333);const i={draw(t,e){const n=.62625*(0,r._b)(e);t.moveTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.lineTo(-n,0),t.closePath()}}},9451:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6333);const i={draw(t,e){const n=.87559*(0,r._b)(e-(0,r.VV)(e/7,2));t.moveTo(-n,0),t.lineTo(n,0),t.moveTo(0,n),t.lineTo(0,-n)}}},7609:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6333);const i={draw(t,e){const n=(0,r._b)(e),i=-n/2;t.rect(i,i,n,n)}}},7189:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6333);const i={draw(t,e){const n=.4431*(0,r._b)(e);t.moveTo(n,n),t.lineTo(n,-n),t.lineTo(-n,-n),t.lineTo(-n,n),t.closePath()}}},5174:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(6333);const i=(0,r.O$)(r.pi/10)/(0,r.O$)(7*r.pi/10),o=(0,r.O$)(r.BZ/10)*i,a=-(0,r.mC)(r.BZ/10)*i,s={draw(t,e){const n=(0,r._b)(.8908130915292852*e),i=o*n,s=a*n;t.moveTo(0,-n),t.lineTo(i,s);for(let o=1;o<5;++o){const e=r.BZ*o/5,a=(0,r.mC)(e),l=(0,r.O$)(e);t.lineTo(l*n,-a*n),t.lineTo(a*i-l*s,l*i+a*s)}t.closePath()}}},8031:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6333);const i={draw(t,e){const n=.6189*(0,r._b)(e-(0,r.VV)(e/6,1.7));t.moveTo(-n,-n),t.lineTo(n,n),t.moveTo(-n,n),t.lineTo(n,-n)}}},4610:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(6333);const i=(0,r._b)(3),o={draw(t,e){const n=-(0,r._b)(e/(3*i));t.moveTo(0,2*n),t.lineTo(-i*n,-n),t.lineTo(i*n,-n),t.closePath()}}},7810:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(6333);const i=(0,r._b)(3),o={draw(t,e){const n=.6824*(0,r._b)(e),o=n/2,a=n*i/2;t.moveTo(0,-n),t.lineTo(a,o),t.lineTo(-a,o),t.closePath()}}},9012:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(6333);const i=-.5,o=(0,r._b)(3)/2,a=1/(0,r._b)(12),s=3*(a/2+1),l={draw(t,e){const n=(0,r._b)(e/s),l=n/2,u=n*a,c=l,f=n*a+n,d=-c,h=f;t.moveTo(l,u),t.lineTo(c,f),t.lineTo(d,h),t.lineTo(i*l-o*u,o*l+i*u),t.lineTo(i*c-o*f,o*c+i*f),t.lineTo(i*d-o*h,o*d+i*h),t.lineTo(i*l+o*u,i*u-o*l),t.lineTo(i*c+o*f,i*f-o*c),t.lineTo(i*d+o*h,i*h-o*d),t.closePath()}}},867:(t,e,n)=>{"use strict";var r,i,o,a,s,l;n.d(e,{Z1:()=>o,g0:()=>a,i$:()=>i,wp:()=>s}),l={dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},r=(0,n(6316).Z)(l),i=r.format,o=r.parse,a=r.utcFormat,s=r.utcParse},6316:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(9979),i=n(9650),o=n(8171);function a(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function s(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function l(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function u(t){var e=t.dateTime,n=t.date,o=t.time,u=t.periods,f=t.days,d=t.shortDays,h=t.months,p=t.shortMonths,m=g(u),G=y(u),mt=g(f),Ct=y(f),St=g(d),Dt=y(d),Ft=g(h),Tt=y(h),Nt=g(p),Ot=y(p),zt={a:function(t){return d[t.getDay()]},A:function(t){return f[t.getDay()]},b:function(t){return p[t.getMonth()]},B:function(t){return h[t.getMonth()]},c:null,d:L,e:L,f:W,g:tt,G:nt,H:j,I:U,j:q,L:I,m:$,M:H,p:function(t){return u[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Et,s:Mt,S:Z,u:Y,U:V,V:X,w:Q,W:J,x:null,X:null,y:K,Y:et,Z:rt,"%":At},Rt={a:function(t){return d[t.getUTCDay()]},A:function(t){return f[t.getUTCDay()]},b:function(t){return p[t.getUTCMonth()]},B:function(t){return h[t.getUTCMonth()]},c:null,d:it,e:it,f:ut,g:xt,G:wt,H:ot,I:at,j:st,L:lt,m:ct,M:ft,p:function(t){return u[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Et,s:Mt,S:dt,u:ht,U:pt,V:gt,w:yt,W:vt,x:null,X:null,y:bt,Y:_t,Z:kt,"%":At},Pt={a:function(t,e,n){var r=St.exec(e.slice(n));return r?(t.w=Dt.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=mt.exec(e.slice(n));return r?(t.w=Ct.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=Nt.exec(e.slice(n));return r?(t.m=Ot.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=Ft.exec(e.slice(n));return r?(t.m=Tt.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return jt(t,e,n,r)},d:S,e:S,f:z,g:A,G:k,H:F,I:F,j:D,L:O,m:C,M:T,p:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.p=G.get(r[0].toLowerCase()),n+r[0].length):-1},q:M,Q:P,s:B,S:N,u:b,U:x,V:_,w:v,W:w,x:function(t,e,r){return jt(t,n,e,r)},X:function(t,e,n){return jt(t,o,e,n)},y:A,Y:k,Z:E,"%":R};function Bt(t,e){return function(n){var r,i,o,a=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(i=c[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}}function Lt(t,e){return function(n){var o,u,c=l(1900,void 0,1);if(jt(c,t,n+="",0)!=n.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(e&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(u=(o=s(l(c.y,0,1))).getUTCDay(),o=u>4||0===u?r.l6.ceil(o):(0,r.l6)(o),o=i.AN.offset(o,7*(c.V-1)),c.y=o.getUTCFullYear(),c.m=o.getUTCMonth(),c.d=o.getUTCDate()+(c.w+6)%7):(u=(o=a(l(c.y,0,1))).getDay(),o=u>4||0===u?r.Ox.ceil(o):(0,r.Ox)(o),o=i.rr.offset(o,7*(c.V-1)),c.y=o.getFullYear(),c.m=o.getMonth(),c.d=o.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),u="Z"in c?s(l(c.y,0,1)).getUTCDay():a(l(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(u+5)%7:c.w+7*c.U-(u+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,s(c)):a(c)}}function jt(t,e,n,r){for(var i,o,a=0,s=e.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=Pt[i in c?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return zt.x=Bt(n,zt),zt.X=Bt(o,zt),zt.c=Bt(e,zt),Rt.x=Bt(n,Rt),Rt.X=Bt(o,Rt),Rt.c=Bt(e,Rt),{format:function(t){var e=Bt(t+="",zt);return e.toString=function(){return t},e},parse:function(t){var e=Lt(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=Bt(t+="",Rt);return e.toString=function(){return t},e},utcParse:function(t){var e=Lt(t+="",!0);return e.toString=function(){return t},e}}}var c={"-":"",_:" ",0:"0"},f=/^\s*\d+/,d=/^%/,h=/[\\^$*+?|[\]().{}]/g;function p(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function m(t){return t.replace(h,"\\$&")}function g(t){return new RegExp("^(?:"+t.map(m).join("|")+")","i")}function y(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function v(t,e,n){var r=f.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function b(t,e,n){var r=f.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function x(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function _(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function w(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function k(t,e,n){var r=f.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function A(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function E(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function M(t,e,n){var r=f.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function C(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function S(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function D(t,e,n){var r=f.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function F(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function T(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function N(t,e,n){var r=f.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function O(t,e,n){var r=f.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function z(t,e,n){var r=f.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function R(t,e,n){var r=d.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function P(t,e,n){var r=f.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function B(t,e,n){var r=f.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function L(t,e){return p(t.getDate(),e,2)}function j(t,e){return p(t.getHours(),e,2)}function U(t,e){return p(t.getHours()%12||12,e,2)}function q(t,e){return p(1+i.rr.count((0,o.jB)(t),t),e,3)}function I(t,e){return p(t.getMilliseconds(),e,3)}function W(t,e){return I(t,e)+"000"}function $(t,e){return p(t.getMonth()+1,e,2)}function H(t,e){return p(t.getMinutes(),e,2)}function Z(t,e){return p(t.getSeconds(),e,2)}function Y(t){var e=t.getDay();return 0===e?7:e}function V(t,e){return p(r.Zy.count((0,o.jB)(t)-1,t),e,2)}function G(t){var e=t.getDay();return e>=4||0===e?(0,r.Ig)(t):r.Ig.ceil(t)}function X(t,e){return t=G(t),p(r.Ig.count((0,o.jB)(t),t)+(4===(0,o.jB)(t).getDay()),e,2)}function Q(t){return t.getDay()}function J(t,e){return p(r.Ox.count((0,o.jB)(t)-1,t),e,2)}function K(t,e){return p(t.getFullYear()%100,e,2)}function tt(t,e){return p((t=G(t)).getFullYear()%100,e,2)}function et(t,e){return p(t.getFullYear()%1e4,e,4)}function nt(t,e){var n=t.getDay();return p((t=n>=4||0===n?(0,r.Ig)(t):r.Ig.ceil(t)).getFullYear()%1e4,e,4)}function rt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+p(e/60|0,"0",2)+p(e%60,"0",2)}function it(t,e){return p(t.getUTCDate(),e,2)}function ot(t,e){return p(t.getUTCHours(),e,2)}function at(t,e){return p(t.getUTCHours()%12||12,e,2)}function st(t,e){return p(1+i.AN.count((0,o.ol)(t),t),e,3)}function lt(t,e){return p(t.getUTCMilliseconds(),e,3)}function ut(t,e){return lt(t,e)+"000"}function ct(t,e){return p(t.getUTCMonth()+1,e,2)}function ft(t,e){return p(t.getUTCMinutes(),e,2)}function dt(t,e){return p(t.getUTCSeconds(),e,2)}function ht(t){var e=t.getUTCDay();return 0===e?7:e}function pt(t,e){return p(r.pI.count((0,o.ol)(t)-1,t),e,2)}function mt(t){var e=t.getUTCDay();return e>=4||0===e?(0,r.hB)(t):r.hB.ceil(t)}function gt(t,e){return t=mt(t),p(r.hB.count((0,o.ol)(t),t)+(4===(0,o.ol)(t).getUTCDay()),e,2)}function yt(t){return t.getUTCDay()}function vt(t,e){return p(r.l6.count((0,o.ol)(t)-1,t),e,2)}function bt(t,e){return p(t.getUTCFullYear()%100,e,2)}function xt(t,e){return p((t=mt(t)).getUTCFullYear()%100,e,2)}function _t(t,e){return p(t.getUTCFullYear()%1e4,e,4)}function wt(t,e){var n=t.getUTCDay();return p((t=n>=4||0===n?(0,r.hB)(t):r.hB.ceil(t)).getUTCFullYear()%1e4,e,4)}function kt(){return"+0000"}function At(){return"%"}function Et(t){return+t}function Mt(t){return Math.floor(+t/1e3)}},9650:(t,e,n)=>{"use strict";n.d(e,{AN:()=>a,KB:()=>s,rr:()=>o});var r=n(3998),i=n(7231);const o=(0,r.J)((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*i.yB)/i.UD),(t=>t.getDate()-1)),a=(o.range,(0,r.J)((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/i.UD),(t=>t.getUTCDate()-1))),s=(a.range,(0,r.J)((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/i.UD),(t=>Math.floor(t/i.UD))));s.range},7231:(t,e,n)=>{"use strict";n.d(e,{UD:()=>a,Y2:()=>o,Ym:()=>r,iM:()=>s,jz:()=>l,qz:()=>u,yB:()=>i});const r=1e3,i=60*r,o=60*i,a=24*o,s=7*a,l=30*a,u=365*a},7956:(t,e,n)=>{"use strict";n.d(e,{WQ:()=>o,lM:()=>a});var r=n(3998),i=n(7231);const o=(0,r.J)((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*i.Ym-t.getMinutes()*i.yB)}),((t,e)=>{t.setTime(+t+e*i.Y2)}),((t,e)=>(e-t)/i.Y2),(t=>t.getHours())),a=(o.range,(0,r.J)((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*i.Y2)}),((t,e)=>(e-t)/i.Y2),(t=>t.getUTCHours())));a.range},3998:(t,e,n)=>{"use strict";n.d(e,{J:()=>o});const r=new Date,i=new Date;function o(t,e,n,a){function s(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=e=>(t(e=new Date(+e)),e),s.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),s.round=t=>{const e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),s.range=(n,r,i)=>{const o=[];if(n=s.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return o;let a;do{o.push(a=new Date(+n)),e(n,i),t(n)}while(a<n&&n<r);return o},s.filter=n=>o((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})),n&&(s.count=(e,o)=>(r.setTime(+e),i.setTime(+o),t(r),t(i),Math.floor(n(r,i))),s.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?s.filter(a?e=>a(e)%t==0:e=>s.count(0,e)%t==0):s:null)),s}},1439:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(3998);const i=(0,r.J)((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t));i.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?(0,r.J)((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):i:null),i.range},3832:(t,e,n)=>{"use strict";n.d(e,{Z_:()=>o,rz:()=>a});var r=n(3998),i=n(7231);const o=(0,r.J)((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*i.Ym)}),((t,e)=>{t.setTime(+t+e*i.yB)}),((t,e)=>(e-t)/i.yB),(t=>t.getMinutes())),a=(o.range,(0,r.J)((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*i.yB)}),((t,e)=>(e-t)/i.yB),(t=>t.getUTCMinutes())));a.range},4420:(t,e,n)=>{"use strict";n.d(e,{F0:()=>i,me:()=>o});var r=n(3998);const i=(0,r.J)((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth())),o=(i.range,(0,r.J)((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth())));o.range},8392:(t,e,n)=>{"use strict";n.d(e,{E:()=>o});var r=n(3998),i=n(7231);const o=(0,r.J)((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*i.Ym)}),((t,e)=>(e-t)/i.Ym),(t=>t.getUTCSeconds()));o.range},2736:(t,e,n)=>{"use strict";n.d(e,{WG:()=>m,_g:()=>v,jK:()=>y,jo:()=>g});var r=n(2108),i=n(2497),o=n(7231),a=n(1439),s=n(8392),l=n(3832),u=n(7956),c=n(9650),f=n(9979),d=n(4420),h=n(8171);function p(t,e,n,l,u,c){const f=[[s.E,1,o.Ym],[s.E,5,5*o.Ym],[s.E,15,15*o.Ym],[s.E,30,30*o.Ym],[c,1,o.yB],[c,5,5*o.yB],[c,15,15*o.yB],[c,30,30*o.yB],[u,1,o.Y2],[u,3,3*o.Y2],[u,6,6*o.Y2],[u,12,12*o.Y2],[l,1,o.UD],[l,2,2*o.UD],[n,1,o.iM],[e,1,o.jz],[e,3,3*o.jz],[t,1,o.qz]];function d(e,n,s){const l=Math.abs(n-e)/s,u=(0,r.Z)((t=>{let[,,e]=t;return e})).right(f,l);if(u===f.length)return t.every((0,i.ly)(e/o.qz,n/o.qz,s));if(0===u)return a.A.every(Math.max((0,i.ly)(e,n,s),1));const[c,d]=f[l/f[u-1][2]<f[u][2]/l?u-1:u];return c.every(d)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"==typeof n.range?n:d(t,e,n),o=i?i.range(t,+e+1):[];return r?o.reverse():o},d]}const[m,g]=p(h.ol,d.me,f.pI,c.KB,u.lM,l.rz),[y,v]=p(h.jB,d.F0,f.Zy,c.rr,u.WQ,l.Z_)},9979:(t,e,n)=>{"use strict";n.d(e,{Ig:()=>c,Ox:()=>s,Zy:()=>a,hB:()=>v,l6:()=>m,pI:()=>p});var r=n(3998),i=n(7231);function o(t){return(0,r.J)((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*i.yB)/i.iM))}const a=o(0),s=o(1),l=o(2),u=o(3),c=o(4),f=o(5),d=o(6);function h(t){return(0,r.J)((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/i.iM))}a.range,s.range,l.range,u.range,c.range,f.range,d.range;const p=h(0),m=h(1),g=h(2),y=h(3),v=h(4),b=h(5),x=h(6);p.range,m.range,g.range,y.range,v.range,b.range,x.range},8171:(t,e,n)=>{"use strict";n.d(e,{jB:()=>i,ol:()=>o});var r=n(3998);const i=(0,r.J)((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear()));i.every=t=>isFinite(t=Math.floor(t))&&t>0?(0,r.J)((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null,i.range;const o=(0,r.J)((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));o.every=t=>isFinite(t=Math.floor(t))&&t>0?(0,r.J)((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null,o.range},3452:(t,e,n)=>{"use strict";n.d(e,{B7:()=>g,HT:()=>y,zO:()=>p});var r,i,o=0,a=0,s=0,l=1e3,u=0,c=0,f=0,d="object"==typeof performance&&performance.now?performance:Date,h="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function p(){return c||(h(m),c=d.now()+f)}function m(){c=0}function g(){this._call=this._time=this._next=null}function y(t,e,n){var r=new g;return r.restart(t,e,n),r}function v(){c=(u=d.now())+f,o=a=0;try{!function(){p(),++o;for(var t,e=r;e;)(t=c-e._time)>=0&&e._call.call(void 0,t),e=e._next;--o}()}finally{o=0,function(){for(var t,e,n=r,o=1/0;n;)n._call?(o>n._time&&(o=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:r=e);i=t,x(o)}(),c=0}}function b(){var t=d.now(),e=t-u;e>l&&(f-=e,u=t)}function x(t){o||(a&&(a=clearTimeout(a)),t-c>24?(t<1/0&&(a=setTimeout(v,t-d.now()-f)),s&&(s=clearInterval(s))):(s||(u=d.now(),s=setInterval(b,l)),o=1,h(v)))}g.prototype=y.prototype={constructor:g,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?p():+n)+(null==e?0:+e),this._next||i===this||(i?i._next=this:r=this,i=this),this._call=t,this._time=n,x()},stop:function(){this._call&&(this._call=null,this._time=1/0,x())}}},6332:(t,e,n)=>{"use strict";n.d(e,{H:()=>i,L:()=>r});class r extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(o(this,t))}has(t){return super.has(o(this,t))}set(t,e){return super.set(a(this,t),e)}delete(t){return super.delete(s(this,t))}}class i extends Set{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const n of t)this.add(n)}has(t){return super.has(o(this,t))}add(t){return super.add(a(this,t))}delete(t){return super.delete(s(this,t))}}function o(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function a(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function s(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function l(t){return null!==t&&"object"==typeof t?t.valueOf():t}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var j={};return(()=>{"use strict";n.r(j),n.d(j,{ObservablePlotAdapter:()=>h,VegaAdapter:()=>aS,VegaLiteAdapter:()=>tW});var t={};n.r(t),n.d(t,{aggregate:()=>zi,bin:()=>Ri,collect:()=>Bi,compare:()=>Li,countpattern:()=>Ui,cross:()=>qi,density:()=>Hi,dotbin:()=>Xi,expression:()=>Qi,extent:()=>Ki,facet:()=>eo,field:()=>no,filter:()=>io,flatten:()=>oo,fold:()=>ao,formula:()=>so,generate:()=>lo,impute:()=>fo,joinaggregate:()=>ho,kde:()=>po,key:()=>mo,load:()=>yo,lookup:()=>bo,multiextent:()=>xo,multivalues:()=>wo,params:()=>Ao,pivot:()=>Eo,prefacet:()=>Mo,project:()=>Co,proxy:()=>So,quantile:()=>Do,relay:()=>Fo,sample:()=>To,sequence:()=>No,sieve:()=>Oo,subflow:()=>to,timeunit:()=>zo,tupleindex:()=>Po,values:()=>Bo,window:()=>Io});var e={};n.r(e),n.d(e,{bound:()=>Gd,identifier:()=>Jd,mark:()=>Kd,overlap:()=>th,render:()=>sh,viewlayout:()=>Sh});var r={};n.r(r),n.d(r,{axisticks:()=>Nh,datajoin:()=>Oh,encode:()=>Rh,legendentries:()=>Ph,linkpath:()=>qh,pie:()=>Zh,scale:()=>Gh,sortitems:()=>Kh,stack:()=>ip});var i={};n.r(i),n.d(i,{contour:()=>cg,geojson:()=>hg,geopath:()=>pg,geopoint:()=>mg,geoshape:()=>gg,graticule:()=>yg,heatmap:()=>vg,isocontour:()=>tg,kde2d:()=>sg,projection:()=>xg});var o={};n.r(o),n.d(o,{force:()=>Yg});var a={};n.r(a),n.d(a,{nest:()=>Dy,pack:()=>Ry,partition:()=>By,stratify:()=>Ly,tree:()=>qy,treelinks:()=>Iy,treemap:()=>Hy});var s={};n.r(s),n.d(s,{label:()=>cv});var l={};n.r(l),n.d(l,{loess:()=>dv,regression:()=>pv});var u={};n.r(u),n.d(u,{voronoi:()=>gv});var c={};n.r(c),n.d(c,{wordcloud:()=>Tv});var f={};n.r(f),n.d(f,{crossfilter:()=>jv,resolvefilter:()=>Uv});const d=n(550),h=t=>{return n=function*(){const e=yield d.plot(t),n=t.ariaDescription;return function(t,e,n){var r;const i="svg"!==e.tagName?Object.values(e.children).find((t=>"svg"===t.tagName)):e,o=["x-axis","y-axis"].reduce(((e,n)=>{let r=function(t,e){let n;return Object.keys(t.children).forEach((r=>{let i=t.children[parseInt(r)];i.getAttribute("aria-label")===e&&(n=i)})),n}(i,n);return r&&e.push(function(t,e){const n="y-axis"===(null==e?void 0:e.getAttribute("aria-label"))?"y":"x",r=m(t.marks.filter((t=>"rule"!==t.ariaLabel))[0].channels).find((t=>t.scale===n)),i={field:"object"==typeof r.value?r.value.label:r.value,axisType:n};return r.type&&(i.scaleType=r.type),i}(t,r)),e}),[]);let a=[];t.color&&t.color.legend&&a.push(function(t,e){const n=["fill"],r=m(t.marks.filter((t=>"rule"!==t.ariaLabel))[0].channels).find((t=>n.includes(t.name)));return{field:"object"==typeof r.value?r.value.label:r.value,channel:r.name}}(t,e.children[0]));const s=t.marks.filter((t=>"rule"!==t.ariaLabel))[0];let l;return t.facet?l=t.facet.y?t.facet.y:t.facet.x:s&&"line"===s.ariaLabel&&(l=null===(r=m(t.marks.find((t=>"line"===t.ariaLabel)).channels).find((t=>"stroke"===t.name)))||void 0===r?void 0:r.value),{data:s.data,facet:l,mark:p(s.ariaLabel),axes:o,legends:a,description:n}}(t,e,n)},new((e=void 0)||(e=Promise))((function(t,r){function i(t){try{a(n.next(t))}catch(t){r(t)}}function o(t){try{a(n.throw(t))}catch(t){r(t)}}function a(n){n.done?t(n.value):function(t){return t instanceof e?t:new e((function(e){e(t)}))}(n.value).then(i,o)}a((n=n.apply(void 0,[])).next())}));var e,n};function p(t){switch(t){case"dot":return"point";case"bar":return"bar";case"line":return"line";default:return}}function m(t){return t.find?t:Object.entries(t).map((t=>{let[e,n]=t;return Object.assign(Object.assign({},n),{name:e})}))}function g(t,e,n){return t.fields=e||[],t.fname=n,t}function y(t){return null==t?null:t.fname}function v(t){return null==t?null:t.fields}function b(t){return 1===t.length?x(t[0]):_(t)}const x=t=>function(e){return e[t]},_=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function w(t){throw Error(t)}function k(t){const e=[],n=t.length;let r,i,o,a=null,s=0,l="";function u(){e.push(l+t.substring(r,i)),l="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)l+=t.substring(r,i++),r=i;else if(o===a)u(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&u(),s=r=i+1):"]"===o&&(s||w("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&w("Access path missing closing bracket: "+t),a&&w("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function A(t,e,n){const r=k(t);return t=1===r.length?r[0]:t,g((n&&n.get||b)(r),[t],e||t)}const E=A("id"),M=g((t=>t),[],"identity"),C=g((()=>0),[],"zero"),S=g((()=>1),[],"one"),D=g((()=>!0),[],"true"),F=g((()=>!1),[],"false");function T(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const N=0,O=1,z=2,R=3,P=4;function B(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T,r=t||N;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=O&&n(e||"error","ERROR",arguments),this},warn(){return r>=z&&n(e||"warn","WARN",arguments),this},info(){return r>=R&&n(e||"log","INFO",arguments),this},debug(){return r>=P&&n(e||"log","DEBUG",arguments),this}}}var L=Array.isArray;function U(t){return t===Object(t)}const q=t=>"__proto__"!==t;function I(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=$(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;W(t,n,e[n],r)}return t}),{})}function W(t,e,n,r){if(!q(e))return;let i,o;if(U(n)&&!L(n))for(i in o=U(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?W(o,i,n[i]):q(i)&&(o[i]=n[i]);else t[e]=n}function $(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function H(t){return t[t.length-1]}function Z(t){return null==t||""===t?null:+t}const Y=t=>e=>t*Math.exp(e),V=t=>e=>Math.log(t*e),G=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),X=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,Q=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function J(t,e,n,r){const i=n(t[0]),o=n(H(t)),a=(o-i)*e;return[r(i-a),r(o-a)]}function K(t,e,n,r,i){const o=r(t[0]),a=r(H(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function tt(t,e,n){return K(t,e,n,Z,M)}function et(t,e,n){const r=Math.sign(t[0]);return K(t,e,n,V(r),Y(r))}function nt(t,e,n,r){return K(t,e,n,Q(r),Q(1/r))}function rt(t,e,n,r){return K(t,e,n,G(r),X(r))}function it(t){return null!=t?L(t)?t:[t]:[]}function ot(t){return"function"==typeof t}const at="descending";function st(t,e,n){n=n||{},e=it(e)||[];const r=[],i=[],o={},a=n.comparator||ut;return it(t).forEach(((t,a)=>{null!=t&&(r.push(e[a]===at?-1:1),i.push(t=ot(t)?t:A(t,null,n)),(v(t)||[]).forEach((t=>o[t]=1)))})),0===i.length?null:g(a(i,r),Object.keys(o))}const lt=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),ut=(t,e)=>1===t.length?ct(t[0],e[0]):ft(t,e,t.length),ct=(t,e)=>function(n,r){return lt(t(n),t(r))*e},ft=(t,e,n)=>(e.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=t[s],a=lt(o(r),o(i));return a*e[s]});function dt(t){return ot(t)?t:()=>t}function ht(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function pt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function mt(t,e){let n,r,i,o,a=0;if(t&&(n=t.length))if(null==e){for(r=t[a];a<n&&(null==r||r!=r);r=t[++a]);for(i=o=r;a<n;++a)r=t[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[a]);a<n&&(null==r||r!=r);r=e(t[++a]));for(i=o=r;a<n;++a)r=e(t[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}const gt=Object.prototype.hasOwnProperty;function yt(t,e){return gt.call(t,e)}const vt={};function bt(t){let e,n={};function r(t){return yt(n,t)&&n[t]!==vt}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===vt&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=vt),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===vt||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function xt(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),pt(r,n)}function _t(t,e,n,r){let i,o=e[0],a=e[e.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=a:t<a)}function wt(t){return"boolean"==typeof t}function kt(t){return"[object Date]"===Object.prototype.toString.call(t)}function At(t){return"number"==typeof t}function Et(t){return"string"==typeof t}function Mt(t,e,n){t&&(t=e?it(t).map((t=>t.replace(/\\(.)/g,"$1"))):it(t));const r=t&&t.length,i=n&&n.get||b,o=t=>i(e?[t]:k(t));let a;if(r)if(1===r){const e=o(t[0]);a=function(t){return""+e(t)}}else{const e=t.map(o);a=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else a=function(){return""};return g(a,t,"key")}function Ct(t,e){let n="";for(;--e>=0;)n+=t;return n}function St(t){return t&&H(t)-t[0]||0}function Dt(t){return L(t)?"["+t.map(Dt)+"]":U(t)||Et(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Ft(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t||!t)}const Tt=t=>At(t)||kt(t)?t:Date.parse(t);function Nt(t,e){return e=e||Tt,null==t||""===t?null:e(t)}function Ot(t){return null==t||""===t?null:t+""}function zt(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function Rt(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var Pt={},Bt={},Lt=34,jt=10,Ut=13;function qt(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function It(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Wt(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function $t(t){return t}function Ht(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return Zt(t,e)}))}:Zt(t,e)}function Zt(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=Yt(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function Yt(t,e){var n=function(t){if(null==t)return $t;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+a;l<u;)c[l]=t[l],++l;return c}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,a)}function o(t){return n(t)}function a(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=a(e.arcs);break;case"MultiLineString":n=e.arcs.map(a);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function Vt(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)})),e.forEach((function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),s=a[0],l=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=l]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o}function Gt(t){return Yt(t,Xt.apply(this,arguments))}function Xt(t,e,n){var r,i,o;if(arguments.length>1)r=function(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function l(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(l)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:Vt(t,r)}}var Qt=n(2497),Jt=n(9255),Kt=n(8419),te=n(8728),ee=n(7332),ne=n(2157),re=n(7474),ie=n(9650),oe=n(9979),ae=n(8171),se=n(4420),le=n(7956),ue=n(3832),ce=n(8392),fe=n(1439),de=n(2108);const he="year",pe="quarter",me="month",ge="week",ye="date",ve="day",be="dayofyear",xe="hours",_e="minutes",we="seconds",ke="milliseconds",Ae=[he,pe,me,ge,ye,ve,be,xe,_e,we,ke],Ee=Ae.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function Me(t){const e=it(t).slice(),n={};return e.length||w("Missing time unit."),e.forEach((t=>{yt(Ee,t)?n[t]=1:w("Invalid time unit: ".concat(t,"."))})),(n[ge]||n[ve]?1:0)+(n[pe]||n[me]||n[ye]?1:0)+(n[be]?1:0)>1&&w("Incompatible time units: ".concat(t)),e.sort(((t,e)=>Ee[t]-Ee[e])),e}const Ce={[he]:"%Y ",[pe]:"Q%q ",[me]:"%b ",[ye]:"%d ",[ge]:"W%U ",[ve]:"%a ",[be]:"%j ",[xe]:"%H:00",[_e]:"00:%M",[we]:":%S",[ke]:".%L",["".concat(he,"-").concat(me)]:"%Y-%m ",["".concat(he,"-").concat(me,"-").concat(ye)]:"%Y-%m-%d ",["".concat(xe,"-").concat(_e)]:"%H:%M"},Se=new Date;function De(t){return Se.setFullYear(t),Se.setMonth(0),Se.setDate(1),Se.setHours(0,0,0,0),Se}function Fe(t){return ie.rr.count(De(t.getFullYear())-1,t)}function Te(t){return oe.Zy.count(De(t.getFullYear())-1,t)}function Ne(t){return De(t).getDay()}function Oe(t,e,n,r,i,o,a){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,o,a);return s.setFullYear(t),s}return new Date(t,e,n,r,i,o,a)}function ze(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return ie.AN.count(e-1,t)}function Re(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return oe.pI.count(e-1,t)}function Pe(t){return Se.setTime(Date.UTC(t,0,1)),Se.getUTCDay()}function Be(t,e,n,r,i,o,a){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,a));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,a))}function Le(t,e,n,r,i){const o=e||1,a=H(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===a&&o,e),l=new Date,u=zt(t),c=u[he]?s(he):dt(2012),f=u[me]?s(me):u[pe]?s(pe):C,d=u[ge]&&u[ve]?s(ve,1,ge+ve):u[ge]?s(ge,1):u[ve]?s(ve,1):u[ye]?s(ye,1):u[be]?s(be,1):S,h=u[xe]?s(xe):C,p=u[_e]?s(_e):C,m=u[we]?s(we):C,g=u[ke]?s(ke):C;return function(t){l.setTime(+t);const e=c(l);return i(e,f(l),d(l,e),h(l),p(l),m(l),g(l))}}function je(t,e,n){return e+7*t-(n+6)%7}const Ue={[he]:t=>t.getFullYear(),[pe]:t=>Math.floor(t.getMonth()/3),[me]:t=>t.getMonth(),[ye]:t=>t.getDate(),[xe]:t=>t.getHours(),[_e]:t=>t.getMinutes(),[we]:t=>t.getSeconds(),[ke]:t=>t.getMilliseconds(),[be]:t=>Fe(t),[ge]:t=>Te(t),[ge+ve]:(t,e)=>je(Te(t),t.getDay(),Ne(e)),[ve]:(t,e)=>je(1,t.getDay(),Ne(e))},qe={[pe]:t=>3*t,[ge]:(t,e)=>je(t,0,Ne(e))};function Ie(t,e){return Le(t,e||1,Ue,qe,Oe)}const We={[he]:t=>t.getUTCFullYear(),[pe]:t=>Math.floor(t.getUTCMonth()/3),[me]:t=>t.getUTCMonth(),[ye]:t=>t.getUTCDate(),[xe]:t=>t.getUTCHours(),[_e]:t=>t.getUTCMinutes(),[we]:t=>t.getUTCSeconds(),[ke]:t=>t.getUTCMilliseconds(),[be]:t=>ze(t),[ge]:t=>Re(t),[ve]:(t,e)=>je(1,t.getUTCDay(),Pe(e)),[ge+ve]:(t,e)=>je(Re(t),t.getUTCDay(),Pe(e))},$e={[pe]:t=>3*t,[ge]:(t,e)=>je(t,0,Pe(e))};function He(t,e){return Le(t,e||1,We,$e,Be)}const Ze={[he]:ae.jB,[pe]:se.F0.every(3),[me]:se.F0,[ge]:oe.Zy,[ye]:ie.rr,[ve]:ie.rr,[be]:ie.rr,[xe]:le.WQ,[_e]:ue.Z_,[we]:ce.E,[ke]:fe.A},Ye={[he]:ae.ol,[pe]:se.me.every(3),[me]:se.me,[ge]:oe.pI,[ye]:ie.AN,[ve]:ie.AN,[be]:ie.AN,[xe]:le.lM,[_e]:ue.rz,[we]:ce.E,[ke]:fe.A};function Ve(t){return Ze[t]}function Ge(t){return Ye[t]}function Xe(t,e,n){return t?t.offset(e,n):void 0}function Qe(t,e,n,r){return t?t.range(e,n,r):void 0}const Je=31536e6,Ke=[he,me,ye,xe,_e,we,ke],tn=Ke.slice(0,-1),en=tn.slice(0,-1),nn=en.slice(0,-1),rn=nn.slice(0,-1),on=[he,me],an=[he],sn=[[tn,1,1e3],[tn,5,5e3],[tn,15,15e3],[tn,30,3e4],[en,1,6e4],[en,5,3e5],[en,15,9e5],[en,30,18e5],[nn,1,36e5],[nn,3,108e5],[nn,6,216e5],[nn,12,432e5],[rn,1,864e5],[[he,ge],1,6048e5],[on,1,2592e6],[on,3,7776e6],[an,1,Je]];var ln=n(867),un=n(6316);function cn(t){const e={};return n=>e[n]||(e[n]=t(n))}function fn(t){const e=cn(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=(0,Jt.Z)(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let o=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,o){o=(0,Jt.Z)(null==o?",f":o);const a=(0,Qt.ly)(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=(0,Kt.Z)(a,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(l=(0,te.Z)(a,s))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=(0,ee.Z)(a))||(o.precision=l-2*("%"===o.type))}return e(o)}}}let dn,hn;function pn(t){return fn((0,re.Z)(t))}function mn(t){return arguments.length?dn=pn(t):dn}function gn(t,e,n){U(n=n||{})||w("Invalid time multi-format specifier: ".concat(n));const r=e(we),i=e(_e),o=e(xe),a=e(ye),s=e(ge),l=e(me),u=e(pe),c=e(he),f=t(n[ke]||".%L"),d=t(n[we]||":%S"),h=t(n[_e]||"%I:%M"),p=t(n[xe]||"%I %p"),m=t(n[ye]||n[ve]||"%a %d"),g=t(n[ge]||"%b %d"),y=t(n[me]||"%B"),v=t(n[pe]||"%B"),b=t(n[he]||"%Y");return t=>(r(t)<t?f:i(t)<t?d:o(t)<t?h:a(t)<t?p:l(t)<t?s(t)<t?m:g:c(t)<t?u(t)<t?y:v:b)(t)}function yn(t){const e=cn(t.format),n=cn(t.utcFormat);return{timeFormat:t=>Et(t)?e(t):gn(e,Ve,t),utcFormat:t=>Et(t)?n(t):gn(n,Ge,t),timeParse:cn(t.parse),utcParse:cn(t.utcParse)}}function vn(t){return yn((0,un.Z)(t))}function bn(t){return arguments.length?hn=vn(t):hn}dn=fn({format:ne.WU,formatPrefix:ne.jH}),hn=yn({format:ln.i$,parse:ln.Z1,utcFormat:ln.g0,utcParse:ln.wp});const xn=(t,e)=>pt({},t,e),_n=/^(data:|([A-Za-z]+:)?\/\/)/,wn=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,kn=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function An(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function En(t,e){e=pt({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,a;const s=wn.test(t.replace(kn,""));null!=t&&"string"==typeof t&&s||w("Sanitize failure, invalid URI: "+Dt(t));const l=_n.test(t);return(a=e.baseURL)&&!l&&(t.startsWith("/")||a.endsWith("/")||(t="/"+t),t=a+t),o=(i=t.startsWith("file://"))||"file"===e.mode||"http"!==e.mode&&!l&&n,i?t=t.slice(7):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function Mn(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):Cn}async function Cn(){w("No file system access.")}function Sn(t){return t?async function(e,n){const r=pt({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?ot(o[i])?o[i]():o.text():w(o.status+""+o.statusText)}:Dn}async function Dn(){w("No HTTP fetch method available.")}const Fn=t=>null!=t&&t==t,Tn=t=>!(Number.isNaN(+t)||t instanceof Date),Nn={boolean:Ft,integer:Z,number:Z,date:Nt,string:Ot,unknown:M},On=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>Tn(t)&&Number.isInteger(+t),Tn,t=>!Number.isNaN(Date.parse(t))],zn=["boolean","integer","number","date"];function Rn(t){const e=function(e,n){const r={delimiter:t};return Pn(e,n?pt(n,r):r)};return e.responseType="text",e}function Pn(t,e){return e.header&&(t=e.header.map(Dt).join(e.delimiter)+"\n"+t),function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return Bt;if(u)return u=!1,Pt;var e,r,i=a;if(t.charCodeAt(i)===Lt){for(;a++<o&&t.charCodeAt(a)!==Lt||t.charCodeAt(++a)===Lt;);return(e=a)>=o?l=!0:(r=t.charCodeAt(a++))===jt?u=!0:r===Ut&&(u=!0,t.charCodeAt(a)===jt&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===jt)u=!0;else if(r===Ut)u=!0,t.charCodeAt(a)===jt&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===jt&&--o,t.charCodeAt(o-1)===Ut&&--o;(r=c())!==Bt;){for(var f=[];r!==Pt&&r!==Bt;)f.push(r),r=c();e&&null==(f=e(f,s++))||i.push(f)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?(r=(n=t).getUTCHours(),i=n.getUTCMinutes(),o=n.getUTCSeconds(),a=n.getUTCMilliseconds(),isNaN(n)?"Invalid Date":function(t){return t<0?"-"+Wt(-t,6):t>9999?"+"+Wt(t,6):Wt(t,4)}(n.getUTCFullYear())+"-"+Wt(n.getUTCMonth()+1,2)+"-"+Wt(n.getUTCDate(),2)+(a?"T"+Wt(r,2)+":"+Wt(i,2)+":"+Wt(o,2)+"."+Wt(a,3)+"Z":o?"T"+Wt(r,2)+":"+Wt(i,2)+":"+Wt(o,2)+"Z":i||r?"T"+Wt(r,2)+":"+Wt(i,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t;var n,r,i,o,a}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=qt(t);return function(r,i){return e(n(r),i,t)}}(t,e):qt(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=It(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=It(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}(e.delimiter).parse(t+"")}function Bn(t,e){const n=e&&e.property?A(e.property):M;return!U(t)||(r=t,"function"==typeof Buffer&&ot(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){return!L(t)&&function(t){return t&&ot(t[Symbol.iterator])}(t)&&(t=[...t]),e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}Pn.responseType="text",Bn.responseType="json";const Ln={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function jn(t,e){let n,r,i,o;return t=Bn(t,e),e&&e.feature?(n=Ht,i=e.feature):e&&e.mesh?(n=Gt,i=e.mesh,o=Ln[e.filter]):w("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):w("Invalid TopoJSON object: "+i),r&&r.features||[r]}jn.responseType="json";const Un={dsv:Pn,csv:Rn(","),tsv:Rn("\t"),json:Bn,topojson:jn};function qn(t,e){return arguments.length>1?(Un[t]=e,this):yt(Un,t)?Un[t]:null}function In(t){const e=qn(t);return e&&e.responseType||"text"}const Wn=function(t,e){return e=>({options:e||{},sanitize:En,load:An,fileAccess:!1,file:Mn(null),http:Sn(t)})}("undefined"!=typeof fetch&&fetch);function $n(t){const e=t||M,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function Hn(t,e){try{await e(t)}catch(e){t.error(e)}}const Zn=Symbol("vega_id");let Yn=1;function Vn(t){return!(!t||!Gn(t))}function Gn(t){return t[Zn]}function Xn(t,e){return t[Zn]=e,t}function Qn(t){const e=t===Object(t)?t:{data:t};return Gn(e)?e:Xn(e,Yn++)}function Jn(t){return Kn(t,Qn({}))}function Kn(t,e){for(const n in t)e[n]=t[n];return e}function tr(t,e){return Xn(e,Gn(t))}function er(t,e){return t?e?(n,r)=>t(n,r)||Gn(e(n))-Gn(e(r)):(e,n)=>t(e,n)||Gn(e)-Gn(n):null}function nr(t){return t&&t.constructor===rr}function rr(){const t=[],e=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:rr,insert(e){const n=it(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=ot(t)?r:e,i=it(t),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify(t,e,r){const o={field:e,value:dt(r)};return ot(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return ot(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return a=!0,this},pulse(s,l){const u={},c={};let f,d,h,p,m,g;for(f=0,d=l.length;f<d;++f)u[Gn(l[f])]=1;for(f=0,d=e.length;f<d;++f)m=e[f],u[Gn(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach((t=>{p(t)&&(u[Gn(t)]=-1)}));for(f=0,d=t.length;f<d;++f)m=t[f],g=Gn(m),u[g]?u[g]=1:s.add.push(Qn(t[f]));for(f=0,d=l.length;f<d;++f)m=l[f],u[Gn(m)]<0&&s.rem.push(m);function y(t,e,n){n?t[e]=n(t):s.encode=e,a||(c[Gn(t)]=t)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,g=u[Gn(m)],g>0&&(y(m,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach((t=>{p(t)&&u[Gn(t)]>0&&y(t,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=e.length||r.length?l.filter((t=>u[Gn(t)]>0)):l.slice();else for(g in c)s.mod.push(c[g]);return(o||null==o&&(e.length||r.length))&&s.clean(!0),s}}}const ir="_:mod:_";function or(){Object.defineProperty(this,ir,{writable:!0,value:{}})}or.prototype={set(t,e,n,r){const i=this,o=i[t],a=i[ir];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,a[e+":"+t]=-1,a[t]=-1):(o!==n||r)&&(i[t]=n,a[t]=L(n)?1+n.length:-1),i},modified(t,e){const n=this[ir];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(L(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[ir]={},this}};let ar=0;const sr=new or;function lr(t,e,n,r){this.id=++ar,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function ur(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}lr.prototype={targets(){return this._targets||(this._targets=$n(E))},set(t){return this.value!==t?(this.value=t,1):0},skip:ur(1),modified:ur(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new or,i=this._argops=this._argops||[],o=[];let a,s,l,u;const c=(t,n,a)=>{a instanceof lr?(a!==this&&(e&&a.targets().add(this),o.push(a)),i.push({op:a,name:t,index:n})):r.set(t,n,a)};for(a in t)if(s=t[a],"pulse"===a)it(s).forEach((t=>{t instanceof lr?t!==this&&(t.targets().add(this),o.push(t)):w("Pulse parameters must be operator instances.")})),this.source=s;else if(L(s))for(r.set(a,-1,Array(l=s.length)),u=0;u<l;++u)c(a,u,s[u]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(t){const e=this._argval||sr,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===t,e.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let cr=0;function fr(t,e,n){this.id=++cr,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function dr(t,e,n){return new fr(t,e,n)}fr.prototype={_filter:D,_apply:M,targets(){return this._targets||(this._targets=$n(E))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=dr(t);return this.targets().add(e),e},apply(t){const e=dr(null,t);return this.targets().add(e),e},merge(){const t=dr();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=dr();return this.targets().add(dr(null,null,ht(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(dr(null,null,(()=>n=!0))),e.targets().add(dr(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=D,this._targets=null}};const hr={skip:!0};function pr(t,e,n,r,i,o){const a=pt({},o,hr);let s,l;ot(n)||(n=dt(n)),void 0===r?s=e=>t.touch(n(e)):ot(r)?(l=new lr(null,r,i,!1),s=e=>{l.evaluate(e);const r=n(e),i=l.value;nr(i)?t.pulse(r,i,o):t.update(r,i,a)}):s=e=>t.update(n(e),r,a),e.apply(s)}function mr(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const a=o||{},s=new lr(null,function(t,e){return e=ot(e)?e:dt(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(a.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const gr={};function yr(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function vr(t,e){const n=[];return Rt(t,e,(t=>n.push(t))),n}function br(t,e){const n={};return t.visit(e,(t=>{n[Gn(t)]=1})),t=>n[Gn(t)]?null:t}function xr(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function _r(t,e,n,r){const i=this;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===e){if(a.fields){const t=i.fields||(i.fields={});for(const e in a.fields)t[e]=1}a.changed(i.ADD)&&(o|=i.ADD),a.changed(i.REM)&&(o|=i.REM),a.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function wr(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}yr.prototype={StopPropagation:gr,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new yr(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new yr(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,br(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return L(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?L(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=xr(n.addF,e)),2&t&&(n.remF=xr(n.remF,e)),4&t&&(n.modF=xr(n.modF,e)),16&t&&(n.srcF=xr(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=vr(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=vr(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=vr(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return Rt(n.source,n.srcF,r),n;1&t&&Rt(n.add,n.addF,r),2&t&&Rt(n.rem,n.remF,r),4&t&&Rt(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||Rt(i,t?br(n,5):n.srcF,r)}return n}},xt(_r,yr,{fork(t){const e=new yr(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?L(t)?t.some((t=>n[t])):n[t]:0},filter(){w("MultiPulse does not support filtering.")},materialize(){w("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const kr={skip:!1,force:!1};function Ar(t,e,n,r){let i,o;const a=t[n];for(;n>e&&(o=n-1>>1,i=t[o],r(a,i)<0);)t[n]=i,n=o;return t[n]=a}function Er(){this.logger(B()),this.logLevel(O),this._clock=0,this._rank=0,this._locale=function(t,e){const n=arguments.length;return n&&2!==n&&w("defaultLocale expects either zero or two arguments."),n?xn(mn(t),bn(e)):xn(mn(),bn())}();try{this._loader=Wn()}catch(t){}this._touched=$n(E),this._input={},this._pulse=null,this._heap=function(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Ar(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,o=t[e];let a,s=1+(e<<1);for(;s<i;)a=s+1,a<i&&n(t[s],t[a])>=0&&(s=a),t[e]=t[s],s=1+((e=s)<<1);t[e]=o,Ar(t,r,e,n)}(e,0,t)):r=n,r}}}(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function Mr(t){return function(){return this._log[t].apply(this,arguments)}}function Cr(t,e){lr.call(this,t,null,e)}Er.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:Mr("error"),warn:Mr("warn"),info:Mr("info"),debug:Mr("debug"),logLevel:Mr("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,o=1;return t instanceof lr?i=t:t&&t.prototype instanceof lr?i=new t:ot(t)?i=new lr(null,t):(o=0,i=new lr(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&w("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||kr);const r=new yr(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||kr;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||kr;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:rr,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return function(t,e,n,r){const i=qn((e=e||{}).type||"json");return i||w("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=bn();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,l,u,c,f=t.columns||Object.keys(t[0]);"auto"===e&&(e=function(t,e){return e.reduce(((e,n)=>(e[n]=function(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=On.length,i=On.map(((t,e)=>e+1));for(let o,a,s=0,l=0;s<n;++s)for(a=e?t[s][e]:t[s],o=0;o<r;++o)if(i[o]&&Fn(a)&&!On[o](a)&&(i[o]=0,++l,l===On.length))return"string";return zn[i.reduce(((t,e)=>0===t?e:t),0)-1]}(t,n),e)),{})}(t,f)),f=Object.keys(e);const d=f.map((t=>{const i=e[t];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:")))return o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1)),("utc"===o[0]?r:n)(a);if(!Nn[i])throw Error("Illegal format pattern: "+t+":"+i);return Nn[i]}));for(s=0,u=t.length,c=f.length;s<u;++s)for(o=t[s],l=0;l<c;++l)a=f[l],o[a]=d[l](o[a])}(t,e.parse,n,r),yt(t,"columns")&&delete t.columns,t}(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0==--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(D).insert(o.data||[])),i.done(),o},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:In(e&&e.type)});try{r=n.parse(r,e)}catch(e){i=-2,n.warn("Data ingestion failed",t,e)}}catch(e){i=-1,n.warn("Loading failed",t,e)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,o=dr(n,r),a=function(t){t.dataflow=i;try{o.receive(t)}catch(t){i.error(t)}finally{i.run()}};let s;s="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):it(t);const l=s.length;for(let u=0;u<l;++u)s[u].addEventListener(e,a);return o},on:function(t,e,n,r,i){return(t instanceof lr?mr:pr)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return wr(r);if(r._pending&&await r._pending,e&&await Hn(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new yr(r,o,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=$n(E);let a,s,l,u=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,t)),s.then?s=await s:s.async&&(i.push(s.async),s=gr),s!==gr&&a._targets&&a._targets.forEach((t=>r._enqueue(t))),++u):r._enqueue(a,!0)}catch(t){r._heap.clear(),l=t}if(r._input={},r._pulse=null,r.debug("Pulse ".concat(o,": ").concat(u," operators")),l&&(r._postrun=[],r.error(l)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await Hn(r,t[e].callback)}return n&&await Hn(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(t){r.error(t)}}))})))),r},run:function(t,e,n){return this._pulse?wr(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(t){this.error(t)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&L(n)?new _r(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==gr&&(t.source=e.source),t)}(this._pulse,n&&n.pulse)}},xt(Cr,lr,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const Sr={};var Dr=n(6801),Fr=n(1787),Tr=n(2233),Nr=n(3309);function*Or(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function zr(t,e,n){const r=Float64Array.from(Or(t,n));return r.sort(Dr.Z),e.map((t=>(0,Fr.s7)(r,t)))}function Rr(t,e){return zr(t,[.25,.5,.75],e)}function Pr(t,e){const n=t.length,r=(0,Tr.Z)(t,e),i=Rr(t,e),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}var Br=Math.random;function Lr(t,e,n,r){r=r||(t=>t);const i=t.length,o=new Float64Array(i);let a,s=0,l=1,u=r(t[0]),c=u,f=u+e;for(;l<i;++l){if(a=r(t[l]),a>=f){for(c=(u+c)/2;s<l;++s)o[s]=c;f=a+e,u=a}c=a}for(c=(u+c)/2;s<l;++s)o[s]=c;return n?function(t,e){const n=t.length;let r,i,o=0,a=1;for(;t[o]===t[a];)++a;for(;a<n;){for(r=a+1;t[a]===t[r];)++r;if(t[a]-t[a-1]<e){for(i=a+(o+r-a-a>>1);i<a;)t[i++]=t[a];for(;i>a;)t[i--]=t[o]}o=a,a=r}return t}(o,e+e/4):o}const jr=Math.sqrt(2*Math.PI),Ur=Math.SQRT2;let qr=NaN;function Ir(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(qr==qr)i=qr,qr=NaN;else{do{i=2*Br()-1,o=2*Br()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,qr=o*r}return t+i*e}function Wr(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*jr)}function $r(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,o=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,o/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,o=t/e/2.506628274631)}return r>0?1-o:o}function Hr(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*Ur*function(t){let e,n=-Math.log((1-t)*(1+t));return n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0,e*t}(2*t-1)}function Zr(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Ir(n,r),pdf:t=>Wr(t,n,r),cdf:t=>$r(t,n,r),icdf:t=>Hr(t,n,r)};return i.mean(t).stdev(e)}function Yr(t,e){const n=Zr();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=Pr(t)),i):e},sample:()=>t[~~(Br()*r)]+e*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-t[a])/e);return o/e/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-t[a])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function Vr(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+Ir()*e)}function Gr(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*jr*t)}function Xr(t,e,n){return $r(Math.log(t),e,n)}function Qr(t,e,n){return Math.exp(Hr(t,e,n))}function Jr(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*Br()}function Kr(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function ti(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function ei(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function ni(t,e,n){let r=0,i=0;for(const o of t){const t=n(o);null==e(o)||null==t||isNaN(t)||(r+=(t-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function ri(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-o*t,o]}function ii(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,o=new Float64Array(i),a=new Float64Array(i);let s,l,u,c=0,f=0,d=0;for(u of t)o[c]=s=+e(u),a[c]=l=+n(u),++c,f+=(s-f)/c,d+=(l-d)/c;for(c=0;c<i;++c)o[c]-=f,a[c]-=d;return[o,a,f,d]}function oi(t,e,n,r){let i,o,a=-1;for(const s of t)i=e(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function ai(t,e,n,r,i){let o=0,a=0;return oi(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;o+=n*n,a+=s*s})),1-o/a}function si(t,e,n){let r=0,i=0,o=0,a=0,s=0;oi(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=ri(r,i,o,a),u=t=>l[0]+l[1]*t;return{coef:l,predict:u,rSquared:ai(t,e,n,i,u)}}function li(t,e,n){const[r,i,o,a]=ii(t,e,n),s=r.length;let l,u,c,f,d=0,h=0,p=0,m=0,g=0;for(l=0;l<s;)u=r[l],c=i[l++],f=u*u,d+=(f-d)/l,h+=(f*u-h)/l,p+=(f*f-p)/l,m+=(u*c-m)/l,g+=(f*c-g)/l;const y=p-d*d,v=d*y-h*h,b=(g*d-m*h)/v,x=(m*y-g*h)/v,_=-b*d,w=t=>b*(t-=o)*t+x*t+_+a;return{coef:[_-x*o+b*o*o+a,x-2*b*o,b],predict:w,rSquared:ai(t,e,n,a,w)}}function ui(t,e,n,r){const i=Array(t);let o,a,s,l;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(s=e[o],l=1,i[o]+=s,a=1;a<=o;++a)l*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*l;return i[0]+=r,i}function ci(t){return(t=1-t*t*t)*t*t}function fi(t,e,n){const r=t[e];let i=n[0],o=n[1]+1;if(!(o>=t.length))for(;e>i&&t[o]-r<=r-t[i];)n[0]=++i,n[1]=o,++o}const di=.5*Math.PI/180;function hi(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],a=e[1],s=a-o,l=s/r,u=[i(o)],c=[];if(n===r){for(let t=1;t<r;++t)u.push(i(o+t/n*s));return u.push(i(a)),u}c.push(i(a));for(let m=n;--m>0;)c.push(i(o+m/n*s));let f=u[0],d=c[c.length-1];const h=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let o=0;o<i;++o){const t=e[o][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(f[1],c);for(;d;){const t=i((f[0]+d[0])/2);t[0]-f[0]>=l&&pi(f,t,d,h,p)>di?c.push(t):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function pi(t,e,n,r,i){const o=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),a=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(o-a)}var mi=n(2403),gi=n(396),yi=n(1649),vi=n(6273);function bi(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function xi(t,e,n){return n||t+(e?"_"+e:"")}const _i=()=>{},wi={init:_i,add:_i,rem:_i,idx:0},ki={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},Ai=Object.keys(ki).filter((t=>"__count__"!==t));function Ei(t,e){return ki[t](e)}function Mi(t,e){return t.idx-e.idx}function Ci(){this.valid=0,this.missing=0,this._ops.forEach((t=>t.init(this)))}function Si(t,e){null!=t&&""!==t?t==t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function Di(t,e){null!=t&&""!==t?t==t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function Fi(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function Ti(t,e){const n=e||M,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=ki[t]())}))};return t.forEach(n),Object.values(e).sort(Mi)}(t),i=t.slice().sort(Mi);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=Ci,o.prototype.add=Si,o.prototype.rem=Di,o.prototype.set=Fi,o.prototype.get=n,o.fields=t.map((t=>t.out)),o}function Ni(t){this._key=t?A(t):Gn,this.reset()}[...Ai,"__count__"].forEach((t=>{ki[t]=function(t,e){return n=>pt({name:t,out:n||t},wi,e)}(t,ki[t])}));const Oi=Ni.prototype;function zi(t){Cr.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function Ri(t){Cr.call(this,null,t)}function Pi(t,e,n){const r=t;let i=e||[],o=n||[],a={},s=0;return{add:t=>o.push(t),remove:t=>a[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter((t=>!a[r(t)])),a={},s=0),e&&t&&i.sort(t),o.length&&(i=t?function(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const a=new e.constructor(i+o);let s=0,l=0,u=0;for(;s<i&&l<o;++u)a[u]=t(e[s],n[l])>0?n[l++]:e[s++];for(;s<i;++s,++u)a[u]=e[s];for(;l<o;++l,++u)a[u]=n[l];return a}(t,i,o.sort(t)):i.concat(o),o=[]),i)}}function Bi(t){Cr.call(this,[],t)}function Li(t){lr.call(this,null,ji,t)}function ji(t){return this.value&&!t.modified()?this.value:st(t.fields,t.orders)}function Ui(t){Cr.call(this,null,t)}function qi(t){Cr.call(this,null,t)}Oi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Oi.add=function(t){this._add.push(t)},Oi.rem=function(t){this._rem.push(t)},Oi.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,o=Array(r-i),a={};let s,l,u;for(s=0;s<i;++s)a[n(e[s])]=1;for(s=0,l=0;s<r;++s)a[n(u=t[s])]?a[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o},Oi.distinct=function(t){const e=this.values(),n={};let r,i=e.length,o=0;for(;--i>=0;)r=t(e[i])+"",yt(n,r)||(n[r]=1,++o);return o},Oi.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=function(t,e){const n=t.length;let r,i,o,a,s,l=-1;if(null==e){for(;++l<n;)if(i=t[l],null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=t[l],null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}else{for(;++l<n;)if(i=e(t[l],l,t),null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=e(t[l],l,t),null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}return[a,s]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},Oi.argmin=function(t){return this.extent(t)[0]||{}},Oi.argmax=function(t){return this.extent(t)[1]||{}},Oi.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},Oi.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},Oi.quartile=function(t){return this._get===t&&this._q||(this._q=Rr(this.values(),t),this._get=t),this._q},Oi.q1=function(t){return this.quartile(t)[0]},Oi.q2=function(t){return this.quartile(t)[1]},Oi.q3=function(t){return this.quartile(t)[2]},Oi.ci=function(t){return this._get===t&&this._ci||(this._ci=function(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(Or(t,r)),o=i.length;let a,s,l,u;for(l=0,u=Array(1e3);l<1e3;++l){for(a=0,s=0;s<o;++s)a+=i[~~(Br()*o)];u[l]=a/o}return u.sort(Dr.Z),[(0,Fr.ZP)(u,.025),(0,Fr.ZP)(u,.975)]}(this.values(),0,0,t),this._get=t),this._ci},Oi.ci0=function(t){return this.ci(t)[0]},Oi.ci1=function(t){return this.ci(t)[1]},zi.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Ai},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},xt(zi,Cr,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):Object.create(null),e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function o(t){let e,o,a,s;for(e in t)for(a=t[e].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(t._prev),o(e),function o(a,s,l){const u=n[l],c=r[l++];for(const n in c){const r=a?a+"|"+n:n;s[u]=c[n],l<i?o(r,s,l):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=it(v(t)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,e.push(o))}this._dims=it(t.groupby),this._dnames=this._dims.map((t=>{const e=y(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:bi(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=t.fields||[null],a=t.ops||["count"],s=t.as||[],l=o.length,u={};let c,f,d,h,p,m;for(l!==a.length&&w("Unmatched number of fields and aggregate ops."),m=0;m<l;++m)c=o[m],f=a[m],null==c&&"count"!==f&&w("Null aggregate field specified."),h=y(c),p=xi(f,h,s[m]),n.push(p),"count"!==f?(d=u[h],d||(i(c),d=u[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(Ei(f,p))):this._counts.push(p);return this._measures=this._measures.map((t=>Ti(t,t.field))),Object.create(null)},cellkey:bi(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new Ni),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](t);return e?tr(e.tuple,o):Qn(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,a=t.rem,s=t.mod;let l,u,c,f;if(r)for(u in r)l=r[u],i&&!l.num||a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(e[c])),e[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(0===l.num&&i?a:s).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,t}}),Ri.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},xt(Ri,Cr,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,a=t.as||["bin0","bin1"],s=a[0],l=a[1];let u;return u=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(v(t.field))?e.ADD_MOD:e.ADD,e.visit(u,n?t=>{const e=r(t);t[s]=e,t[l]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[s]=r(t)),e.modifies(n?a:s)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=function(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let o,a,s,l,u,c,f=t.extent[0],d=t.extent[1];const h=t.span||d-f||Math.abs(f)||1;if(t.step)o=t.step;else if(t.steps){for(l=h/e,u=0,c=t.steps.length;u<c&&t.steps[u]<l;++u);o=t.steps[Math.max(0,u-1)]}else{for(a=Math.ceil(Math.log(e)/r),s=t.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>e;)o*=n;for(u=0,c=i.length;u<c;++u)l=o/i[u],l>=s&&h/l<=e&&(o=l)}l=Math.log(o);const p=l>=0?0:1+~~(-l/r),m=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(l=Math.floor(f/o+m)*o,f=f<l?l-o:l,d=Math.ceil(d/o)*o),{start:f,stop:d===f?f+o:d,step:o}}(t),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=t.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const l=function(t){let n=Z(e(t));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return l.start=a,l.stop=n.stop,l.step=r,this.value=g(l,v(e),t.name||"bin_"+y(e))}}),Bi.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},xt(Bi,Cr,{transform(t,e){const n=e.fork(e.ALL),r=Pi(Gn,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(er(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),xt(Li,lr),Ui.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},xt(Ui,Cr,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,o)||[],l=0,u=i.length;l<u;++l)a.test(r=i[l])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,a=this._stop,s=t.field,l=t.as||["text","count"],u=n((t=>i[t]=1+(i[t]||0))),c=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,u):(e.visit(e.ADD,u),e.visit(e.REM,c)),this._finish(e,l)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],o=e[1],a=t.fork(t.NO_SOURCE|t.NO_FIELDS);let s,l,u;for(s in n)l=r[s],u=n[s]||0,!l&&u?(r[s]=l=Qn({}),l[i]=s,l[o]=u,a.add.push(l)):0===u?(l&&a.rem.push(l),n[s]=null,r[s]=null):l[o]!==u&&(l[o]=u,a.mod.push(l));return a.modifies(e)}}),qi.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},xt(qi,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],o=r[1],a=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,o,a=[],s={},l=t.length,u=0;u<l;++u)for(s[e]=o=t[u],i=0;i<l;++i)s[n]=t[i],r(s)&&(a.push(Qn(s)),(s={})[e]=o);return a}(s,i,o,t.filter||D)):n.mod=s,n.source=this.value,n.modifies(r)}});const Ii={kde:Yr,mixture:function(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=Br();let i=t[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(e<o){i=t[a];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)},normal:Zr,lognormal:function(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Vr(n,r),pdf:t=>Gr(t,n,r),cdf:t=>Xr(t,n,r),icdf:t=>Qr(t,n,r)};return i.mean(t).stdev(e)},uniform:function(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Jr(n,r),pdf:t=>Kr(t,n,r),cdf:t=>ti(t,n,r),icdf:t=>ei(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}},Wi="function";function $i(t,e){const n=t[Wi];yt(Ii,n)||w("Unknown distribution function: "+n);const r=Ii[n]();for(const i in t)"field"===i?r.data((t.from||e()).map(t[i])):"distributions"===i?r[i](t[i].map((t=>$i(t,e)))):typeof r[i]===Wi&&r[i](t[i]);return r}function Hi(t){Cr.call(this,null,t)}const Zi=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Yi={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Zi},{name:"weights",type:"number",array:!0}]};function Vi(t,e){return t?t.map(((t,n)=>e[n]||y(t))):null}function Gi(t,e,n){const r=[],i=t=>t(l);let o,a,s,l,u,c;if(null==e)r.push(t.map(n));else for(o={},a=0,s=t.length;a<s;++a)l=t[a],u=e.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}function Xi(t){Cr.call(this,null,t)}function Qi(t){lr.call(this,null,Ji,t),this.modified(!0)}function Ji(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:g((n=>e(n,t)),v(e),y(e))}function Ki(t){Cr.call(this,[void 0,void 0],t)}function to(t,e){lr.call(this,t),this.parent=e,this.count=0}function eo(t){Cr.call(this,{},t),this._keys=bt();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function no(t){lr.call(this,null,ro,t)}function ro(t){return this.value&&!t.modified()?this.value:L(t.name)?it(t.name).map((t=>A(t))):A(t.name,t.as)}function io(t){Cr.call(this,bt(),t)}function oo(t){Cr.call(this,[],t)}function ao(t){Cr.call(this,[],t)}function so(t){Cr.call(this,null,t)}function lo(t){Cr.call(this,[],t)}Hi.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Zi.concat(Yi)},{name:"as",type:"string",array:!0,default:["value","density"]}]},xt(Hi,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=$i(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let a=t.method||"pdf";"pdf"!==a&&"cdf"!==a&&w("Invalid density method: "+a),t.extent||r.data||w("Missing density extent parameter."),a=r[a];const s=t.as||["value","density"],l=hi(a,t.extent||mt(r.data()),i,o).map((t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],Qn(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),Xi.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},xt(Xi,Cr,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=Gi(e.source,t.groupby,M),i=t.smooth||!1,o=t.field,a=t.step||((t,e)=>St(mt(t,e))/30)(n,o),s=er(((t,e)=>o(t)-o(e))),l=t.as||"bin",u=r.length;let c,f=1/0,d=-1/0,h=0;for(;h<u;++h){const t=r[h].sort(s);c=-1;for(const e of Lr(t,a,i,o))e<f&&(f=e),e>d&&(d=e),t[++c][l]=e}return this.value={start:f,stop:d,step:a},e.reflow(!0).modifies(l)}}),xt(Qi,lr),Ki.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},xt(Ki,Cr,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=Z(r(t));null!=e&&(e<o&&(o=e),e>a&&(a=e))})),!Number.isFinite(o)||!Number.isFinite(a)){let t=y(r);t&&(t=' for field "'.concat(t,'"')),e.dataflow.warn("Infinite extent".concat(t,": [").concat(o,", ").concat(a,"]")),o=a=void 0}this.value=[o,a]}}),xt(to,lr,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),xt(eo,Cr,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let o,a,s=yt(i,t)&&i[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[t])&&a.tuple,o=n.dataflow,s=new to(n.fork(n.NO_SOURCE),this),o.add(s).connect(e(o,t,a)),i[t]=s,this.activate(s)),s},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,a=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=Gn(t),n=o.get(e);void 0!==n&&(o.delete(e),s(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);o.set(Gn(t),e),s(e).add(t)})),a||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=Gn(t),n=o.get(e),i=r(t);n===i?s(i).mod(t):(o.set(e,i),s(n).rem(t),s(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{s(o.get(Gn(t))).mod(t)})),a&&e.visit(e.REFLOW,(t=>{const e=Gn(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),s(n).rem(t),s(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),xt(no,lr),io.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},xt(io,Cr,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),o=i.add,a=i.rem,s=i.mod,l=t.expr;let u=!0;function c(e){const n=Gn(e),i=l(e,t),c=r.get(n);i&&c?(r.delete(n),o.push(e)):i||c?u&&i&&!c&&s.push(e):(r.set(n,1),a.push(e))}return e.visit(e.REM,(t=>{const e=Gn(t);r.has(e)?r.delete(e):a.push(t)})),e.visit(e.ADD,(e=>{l(e,t)?o.push(e):r.set(Gn(e),1)})),e.visit(e.MOD,c),t.modified()&&(u=!1,e.visit(e.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),oo.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},xt(oo,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Vi(r,t.as||[]),o=t.index||null,a=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),s=e.reduce(((t,e)=>Math.max(t,e.length)),0);let l,u,c,f=0;for(;f<s;++f){for(u=Jn(t),l=0;l<a;++l)u[i[l]]=null==(c=e[l][f])?null:c;o&&(u[o]=f),n.add.push(u)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),ao.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},xt(ao,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(y),o=t.as||["key","value"],a=o[0],s=o[1],l=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,o=0;o<l;++o)e=Jn(t),e[a]=i[o],e[s]=r[o](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(o)}}),so.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},xt(so,Cr,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,(e=>e[r]=n(e,t)))}}),xt(lo,Cr,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,o,a,s=this.value,l=t.size-s.length;if(l>0){for(i=[];--l>=0;)i.push(a=Qn(r(t))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-l),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-l);return n.source=this.value=s,n}});const uo={value:"value",median:Nr.Z,mean:mi.Z,min:gi.Z,max:yi.Z},co=[];function fo(t){Cr.call(this,[],t)}function ho(t){zi.call(this,t)}function po(t){Cr.call(this,null,t)}function mo(t){lr.call(this,null,go,t)}function go(t){return this.value&&!t.modified()?this.value:Mt(t.fields,t.flat)}function yo(t){Cr.call(this,[],t),this._pending=null}function vo(t,e,n){n.forEach(Qn);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function bo(t){Cr.call(this,{},t)}function xo(t){lr.call(this,null,_o,t)}function _o(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function wo(t){lr.call(this,null,ko,t)}function ko(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function Ao(t){Cr.call(this,null,t)}function Eo(t){zi.call(this,t)}function Mo(t){eo.call(this,t)}function Co(t){Cr.call(this,null,t)}function So(t){Cr.call(this,null,t)}function Do(t){Cr.call(this,null,t)}function Fo(t){Cr.call(this,null,t)}function To(t){Cr.call(this,[],t),this.count=0}function No(t){Cr.call(this,null,t)}function Oo(t){Cr.call(this,null,t),this.modified(!0)}function zo(t){Cr.call(this,null,t)}fo.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},xt(fo,Cr,{transform(t,e){var n,r,i,o,a,s,l,u,c,f,d=e.fork(e.ALL),h=function(t){var e,n=t.method||uo.value;if(null!=uo[n])return n===uo.value?(e=void 0!==t.value?t.value:0,()=>e):uo[n];w("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),m=y(t.field),g=y(t.key),v=(t.groupby||[]).map(y),b=function(t,e,n,r){var i,o,a,s,l,u,c,f,d=t=>t(f),h=[],p=r?r.slice():[],m={},g={};for(p.forEach(((t,e)=>m[t]=e+1)),s=0,c=t.length;s<c;++s)u=n(f=t[s]),l=m[u]||(m[u]=p.push(u)),(a=g[o=(i=e?e.map(d):co)+""])||(a=g[o]=[],h.push(a),a.values=i),a[l-1]=f;return h.domain=p,h}(e.source,t.groupby,t.key,t.keyvals),x=[],_=this.value,k=b.domain.length;for(a=0,u=b.length;a<u;++a)for(i=(n=b[a]).values,r=NaN,l=0;l<k;++l)if(null==n[l]){for(o=b.domain[l],f={_impute:!0},s=0,c=i.length;s<c;++s)f[v[s]]=i[s];f[g]=o,f[m]=Number.isNaN(r)?r=h(n,p):r,x.push(Qn(f))}return x.length&&(d.add=d.materialize(d.ADD).add.concat(x)),_.length&&(d.rem=d.materialize(d.REM).rem.concat(_)),this.value=x,d}}),ho.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Ai},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},xt(ho,zi,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{pt(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),po.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},xt(po,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=Gi(r,t.groupby,t.field),o=(t.groupby||[]).map(y),a=t.bandwidth,s=t.cumulative?"cdf":"pdf",l=t.as||["value","density"],u=[];let c=t.extent,f=t.steps||t.minsteps||25,d=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&w("Invalid density method: "+s),"shared"===t.resolve&&(c||(c=mt(r,t.field)),f=d=t.steps||d),i.forEach((e=>{const n=Yr(e,a)[s],r=t.counts?e.length:1;hi(n,c||mt(e),f,d).forEach((t=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=e.dims[r];n[l[0]]=t[0],n[l[1]]=t[1]*r,u.push(Qn(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),xt(mo,lr),xt(yo,Cr,{transform(t,e){const n=e.dataflow;if(this._pending)return vo(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return vo(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then((t=>(this._pending=it(t.data),t=>t.touch(this))));return{async:e}}return n.request(t.url,t.format).then((t=>vo(this,e,it(t.data))))}}),bo.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},xt(bo,Cr,{transform(t,e){const n=t.fields,r=t.index,i=t.values,o=null==t.default?null:t.default,a=t.modified(),s=n.length;let l,u,c,f=a?e.SOURCE:e.ADD,d=e,h=t.as;return i?(u=i.length,s>1&&!h&&w('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*u&&w('The "as" parameter has too few output field names.'),h=h||i.map(y),l=function(t){for(var e,a,l=0,c=0;l<s;++l)if(null==(a=r.get(n[l](t))))for(e=0;e<u;++e,++c)t[h[c]]=o;else for(e=0;e<u;++e,++c)t[h[c]]=i[e](a)}):(h||w("Missing output field names."),l=function(t){for(var e,i=0;i<s;++i)e=r.get(n[i](t)),t[h[i]]=null==e?o:e}),a?d=e.reflow(!0):(c=n.some((t=>e.modified(t.fields))),f|=c?e.MOD:0),e.visit(f,l),d.modifies(h)}}),xt(xo,lr),xt(wo,lr),xt(Ao,Cr,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Eo.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Ai,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},xt(Eo,zi,{_transform:zi.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=v(n).concat(v(r)),a=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(lt),e?i.slice(0,e):i}(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:a.map((()=>i)),fields:a.map((t=>function(t,e,n,r){return g((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,o))),as:a.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),xt(Mo,eo,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Gn(t),n,e,t);return(t.modified("field")||r&&e.modified(v(r)))&&w("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(Qn(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),Co.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},xt(Co,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Vi(t.fields,t.as||[]),o=r?(t,e)=>function(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):Kn;let a;return this.value?a=this.value:(e=e.addAll(),a=this.value={}),e.visit(e.REM,(t=>{const e=Gn(t);n.rem.push(a[e]),a[e]=null})),e.visit(e.ADD,(t=>{const e=o(t,Qn({}));a[Gn(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(o(t,a[Gn(t)]))})),n}}),xt(So,Cr,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),Do.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},xt(Do,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=Gi(e.materialize(e.SOURCE).source,t.groupby,t.field),o=(t.groupby||[]).map(y),a=[],s=t.step||.01,l=t.probs||(0,vi.Z)(s/2,1-1e-14,s),u=l.length;return i.forEach((t=>{const e=zr(t,l);for(let n=0;n<u;++n){const i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[r[0]]=l[n],i[r[1]]=e[n],a.push(Qn(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),xt(Fo,Cr,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=Gn(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=Jn(t);r[Gn(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[Gn(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),To.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},xt(To,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value.reduce(((t,e)=>(t[Gn(e)]=1,t)),{});let a=this.value,s=this.count,l=0;function u(t){let e,r;a.length<i?a.push(t):(r=~~((s+1)*Br()),r<a.length&&r>=l&&(e=a[r],o[Gn(e)]&&n.rem.push(e),a[r]=t)),++s}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=Gn(t);o[e]&&(o[e]=-1,n.rem.push(t)),--s})),a=a.filter((t=>-1!==o[Gn(t)]))),(e.rem.length||r)&&a.length<i&&e.source&&(l=s=a.length,e.visit(e.SOURCE,(t=>{o[Gn(t)]||u(t)})),l=-1),r&&a.length>i){const t=a.length-i;for(let e=0;e<t;++e)o[Gn(a[e])]=-1,n.rem.push(a[e]);a=a.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{o[Gn(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,u),(e.add.length||l<0)&&(n.add=a.filter((t=>!o[Gn(t)]))),this.count=s,this.value=n.source=a,n}}),No.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},xt(No,Cr,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=(0,vi.Z)(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,Qn(e)})),n.add=e.add.concat(this.value),n}}),xt(Oo,Cr,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const Ro=["unit0","unit1"];function Po(t){Cr.call(this,bt(),t)}function Bo(t){Cr.call(this,null,t)}zo.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Ae,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Ro}]},xt(zo,Cr,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),a=(i?Ge:Ve)(o.unit).offset,s=t.as||Ro,l=s[0],u=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=e.ADD;return(t.modified()||e.changed(e.REM)||e.modified(v(n)))&&(h=(e=e.reflow(!0)).SOURCE,f=1/0,d=-1/0),e.visit(h,(t=>{const e=n(t);let i,s;null==e?(t[l]=null,r&&(t[u]=null)):(t[l]=i=s=o(e),r&&(t[u]=s=a(i,c)),i<f&&(f=i),s>d&&(d=s))})),o.start=f,o.stop=d,e.modifies(r?s:l)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:function(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(St(e))/n;let i,o,a=(0,de.Z)((t=>t[2])).right(sn,r);return a===sn.length?(i=an,o=(0,Qt.ly)(e[0]/Je,e[1]/Je,n)):a?(a=sn[r/sn[a-1][2]<sn[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=Ke,o=Math.max((0,Qt.ly)(e[0],e[1],n),1)),{units:i,step:o}}({extent:t.extent||mt(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),o=Me(r),a=this.value||{},s=(n?He:Ie)(o,i);return s.unit=H(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),xt(Po,Cr,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let a=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),xt(Bo,Cr,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(er(t.sort)):e.source).map(t.field))}});const Lo={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=Lo.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||w("ntile num must be greater than zero.");const n=Lo.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||w("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n)if(null!=t(e[n]))return n;return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}},jo=Object.keys(Lo);function Uo(t){const e=it(t.ops),n=it(t.fields),r=it(t.params),i=it(t.as),o=this.outputs=[],a=this.windows=[],s={},l={},u=[],c=[];let f=!0;function d(t){it(v(t)).forEach((t=>s[t]=1))}d(t.sort),e.forEach(((t,e)=>{const s=n[e],h=y(s),p=xi(t,h,i[e]);if(d(s),o.push(p),yt(Lo,t))a.push(function(t,e,n,r){const i=Lo[t](e,n);return{init:i.init||C,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==s&&"count"!==t&&w("Null aggregate field specified."),"count"===t)return void u.push(p);f=!1;let e=l[h];e||(e=l[h]=[],e.field=s,c.push(e)),e.push(Ei(t,p))}})),(u.length||c.length)&&(this.cell=function(t,e,n){t=t.map((t=>Ti(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new t[a](r);if(r.store)var s=r.data=new Ni;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,a;for(s&&s.values(),i=0,a=e.length;i<a;++i)t[e[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)o[t].init()},r}(c,u,f)),this.inputs=Object.keys(s)}const qo=Uo.prototype;function Io(t){Cr.call(this,{},t),this._mlen=0,this._mods=[]}function Wo(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=t.data(n),l=s.length,u=o?(0,de.Z)(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||dt(-1)};e.init();for(let f=0;f<l;++f)$o(c,a,f,l),o&&Ho(c,u),e.update(c,s[f])}function $o(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Ho(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}qo.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},qo.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,o=r&&r.length;let a;if(n){for(a=t.p0;a<t.i0;++a)n.rem(i[a]);for(a=t.p1;a<t.i1;++a)n.add(i[a]);n.set(e)}for(a=0;a<o;++a)r[a].update(t,e)},Io.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:jo.concat(Ai)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},xt(Io,Cr,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=er(t.sort),i=bi(t.groupby),o=t=>this.group(i(t));let a=this.state;a&&!n||(a=this.state=new Uo(t)),n||e.modified(a.inputs)?(this.value={},e.visit(e.SOURCE,(t=>o(t).add(t)))):(e.visit(e.REM,(t=>o(t).remove(t))),e.visit(e.ADD,(t=>o(t).add(t))));for(let s=0,l=this._mlen;s<l;++s)Wo(this._mods[s],a,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(a.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=Pi(Gn),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}});var Zo=n(3698),Yo=n(7694),Vo=n(7238),Go=n(6545),Xo=n(7256),Qo=n(2411),Jo=n(7388),Ko=n(6360),ta=n(6491),ea=n(6052),na=n(8282),ra=n(2977),ia=n(6481),oa=n(9389),aa=n(3729),sa=n(8883),la=n(6333),ua=n(9086);function ca(t){return t.innerRadius}function fa(t){return t.outerRadius}function da(t){return t.startAngle}function ha(t){return t.endAngle}function pa(t){return t&&t.padAngle}function ma(t,e,n,r,i,o,a){var s=t-n,l=e-r,u=(a?o:-o)/(0,la._b)(s*s+l*l),c=u*l,f=-u*s,d=t+c,h=e+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,v=p-d,b=m-h,x=v*v+b*b,_=i-o,w=d*m-p*h,k=(b<0?-1:1)*(0,la._b)((0,la.Fp)(0,_*_*x-w*w)),A=(w*b-v*k)/x,E=(-w*v-b*k)/x,M=(w*b+v*k)/x,C=(-w*v+b*k)/x,S=A-g,D=E-y,F=M-g,T=C-y;return S*S+D*D>F*F+T*T&&(A=M,E=C),{cx:A,cy:E,x01:-c,y01:-f,x11:A*(i/_-1),y11:E*(i/_-1)}}var ga=n(3073),ya=n(6985),va=n(9148),ba=n(9205);function xa(t,e){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}var _a=n(940),wa=n(2948),ka=n(8622),Aa=n(4201),Ea=n(9069),Ma=n(3486),Ca=n(2684),Sa=n(1802),Da=n(3582),Fa=n(6194),Ta=n(8757),Na=n(8753),Oa=n(220),za=n(8928),Ra=n(3901),Pa=n(5626),Ba=n(1440);function La(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const ja="linear",Ua="log",qa="pow",Ia="sqrt",Wa="symlog",$a="time",Ha="utc",Za="sequential",Ya="diverging",Va="quantile",Ga="quantize",Xa="threshold",Qa="ordinal",Ja="point",Ka="band",ts="bin-ordinal",es="continuous",ns="discrete",rs="discretizing",is="interpolating",os="temporal";function as(){const t=(0,za.Z)().unknown(void 0),e=t.domain,n=t.range;let r,i,o=[0,1],a=!1,s=0,l=0,u=.5;function c(){const t=e().length,c=o[1]<o[0],f=o[1-c],d=La(t,s,l);let h=o[c-0];r=(f-h)/(d||1),a&&(r=Math.floor(r)),h+=(f-h-r*(t-s))*u,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const p=(0,vi.Z)(t).map((t=>h+r*t));return n(c?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),c()):e()},t.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},t.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,c()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(a=!!t,c()):a},t.padding=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),s=l,c()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),c()):s},t.paddingOuter=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let l,u,c,f=+t[0],d=+t[1];return f!=f||d!=d||(d<f&&(c=f,f=d,d=c),d<a[0]||f>o[1-r])?void 0:(l=Math.max(0,(0,_a.ml)(a,f)-1),u=f===d?l:(0,_a.ml)(a,d)-1,f-a[l]>i+1e-10&&++l,r&&(c=l,l=s-u,u=s-c),l>u?void 0:e().slice(l,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return as().domain(e()).range(o).round(a).paddingInner(s).paddingOuter(l).align(u)},c()}function ss(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return ss(e())},t}var ls=Array.prototype.map;const us=Array.prototype.slice,cs=new Map,fs=Symbol("vega_scale");function ds(t){return t[fs]=!0,t}function hs(t,e,n){return arguments.length>1?(cs.set(t,function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,o,a,s=e[0],l=e[1],u=-1;for(l<s&&(i=s,s=l,l=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=l&&(u<0&&(u=o),r=o);if(!(u<0))return s=t.invertExtent(n[u]),l=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=t,ds(n)};return r.metadata=zt(it(n)),r}(t,e,n)),this):ps(t)?cs.get(t):void 0}function ps(t){return cs.has(t)}function ms(t,e){const n=cs.get(t);return n&&n.metadata[e]}function gs(t){return ms(t,es)}function ys(t){return ms(t,ns)}function vs(t){return ms(t,rs)}function bs(t){return ms(t,Ua)}function xs(t){return ms(t,is)}function _s(t){return ms(t,Va)}hs("identity",wa.Z),hs(ja,ka.Z,es),hs(Ua,Aa.Z,[es,Ua]),hs(qa,Ea.ZP,es),hs(Ia,Ea._b,es),hs(Wa,Ma.Z,es),hs($a,Ca.Z,[es,os]),hs(Ha,Sa.Z,[es,os]),hs(Za,Da.ZP,[es,is]),hs("".concat(Za,"-").concat(ja),Da.ZP,[es,is]),hs("".concat(Za,"-").concat(Ua),Da.S5,[es,is,Ua]),hs("".concat(Za,"-").concat(qa),Da.UN,[es,is]),hs("".concat(Za,"-").concat(Ia),Da.L2,[es,is]),hs("".concat(Za,"-").concat(Wa),Da.cV,[es,is]),hs("".concat(Ya,"-").concat(ja),Fa.ZP,[es,is]),hs("".concat(Ya,"-").concat(Ua),Fa.QA,[es,is,Ua]),hs("".concat(Ya,"-").concat(qa),Fa.ld,[es,is]),hs("".concat(Ya,"-").concat(Ia),Fa.Km,[es,is]),hs("".concat(Ya,"-").concat(Wa),Fa.UM,[es,is]),hs(Va,Ta.Z,[rs,Va]),hs(Ga,(function t(){var e,n=0,r=1,i=1,o=[.5],a=[0,1];function s(t){return null!=t&&t<=t?a[(0,_a.ZP)(o,t,0,i)]:e}function l(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,l()):[n,r]},s.range=function(t){return arguments.length?(i=(a=Array.from(t)).length-1,l()):a.slice()},s.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(a).unknown(e)},Na.o.apply((0,ka.Q)(s),arguments)}),rs),hs(Xa,Oa.Z,rs),hs(ts,(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[((0,_a.ZP)(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return ls.call(t,Z)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=us.call(t),r):n.slice()},r.tickFormat=function(t,n){return(0,Ra.Z)(e[0],H(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[ns,rs]),hs(Qa,za.Z,ns),hs(Ka,as,ns),hs(Ja,(function(){return ss(as().paddingInner(1))}),ns);const ws=["clamp","base","constant","exponent"];function ks(t,e,n){return Pa.Z(Es(e||"rgb",n),t)}function As(t,e,n){const r=n-e;let i,o,a;return r&&Number.isFinite(r)?(i=(o=t.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=hs(o)().domain([e,n]).range([0,1]),ws.forEach((e=>t[e]?a[e](t[e]()):0)),a):dt(.5)}function Es(t,e){const n=Ba[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function Ms(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Cs(t,e){for(const n in t)Ds(n,e(t[n]))}const Ss={};function Ds(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Ss[t]=e,this):Ss[t]}Cs({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Ms),Cs({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>ks(Ms(t))));const Fs="symbol",Ts="discrete",Ns=t=>L(t)?t.map((t=>String(t))):String(t),Os=(t,e)=>t[1]-e[1],zs=(t,e)=>e[1]-t[1];function Rs(t,e,n){let r;return At(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(St(t.domain())/n||1)))),U(e)&&(r=e.step,e=e.interval),Et(e)&&(e=t.type===$a?Ve(e):t.type==Ha?Ge(e):w("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function Ps(t,e,n){let r=t.range(),i=r[0],o=H(r),a=Os;if(i>o&&(r=o,o=i,i=r,a=zs),i=Math.floor(i),o=Math.ceil(o),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=o)).sort(a).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],H(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function Bs(t,e){return t.bins?Ps(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Ls(t,e,n,r,i,o){const a=e.type;let s=Ns;if(a===$a||i===$a)s=t.timeFormat(r);else if(a===Ha||i===Ha)s=t.utcFormat(r);else if(bs(a)){const i=t.formatFloat(r);if(o||e.bins)s=i;else{const t=js(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function js(t,e,n){const r=Bs(t,e),i=t.base(),o=Math.log(i),a=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=a};return n?r.filter(s):s}const Us={[Va]:"quantiles",[Ga]:"thresholds",[Xa]:"domain"},qs={[Va]:"quantiles",[Ga]:"domain"};function Is(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=H(t),e}(t.bins):t.type===Ua?js(t,e,!0):Us[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Us[t.type]]()):Bs(t,e)}const Ws=t=>Us[t.type]||t.bins;function $s(t,e,n,r,i,o,a){const s=qs[e.type]&&o!==$a&&o!==Ha?function(t,e,n){const r=e[qs[e.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return t.formatSpan(0,a,30,n)}(t,e,i):Ls(t,e,n,i,o,a);return r===Fs&&Ws(e)?Hs(s):r===Ts?Ys(s):Vs(s)}const Hs=t=>(e,n,r)=>{const i=Zs(r[n+1],Zs(r.max,1/0)),o=Gs(e,t),a=Gs(i,t);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},Zs=(t,e)=>null!=t?t:e,Ys=t=>(e,n)=>n?t(e):null,Vs=t=>e=>t(e),Gs=(t,e)=>Number.isFinite(t)?e(t):null;function Xs(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(t,e,n,r){const i=r||e.type;return Et(n)&&function(t){return ms(t,os)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==$a?n||i!==Ha?$s(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}(t,e,n.format,n.formatType);if(vs(e.type)){const t=Is(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(ys(e.type)){const t=e.domain(),n=t.length;return"".concat(n," value").concat(1===n?"":"s",": ").concat(n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", "))}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(H(t)))}}let Qs=0;const Js="p_";function Ks(t){return t&&t.gradient}function tl(t,e,n){const r=t.gradient;let i=t.id,o="radial"===r?Js:"";return i||(i=t.id="gradient_"+Qs++,"radial"===r?(t.x1=el(t.x1,.5),t.y1=el(t.y1,.5),t.r1=el(t.r1,0),t.x2=el(t.x2,.5),t.y2=el(t.y2,.5),t.r2=el(t.r2,.5),o=Js):(t.x1=el(t.x1,0),t.y1=el(t.y1,0),t.x2=el(t.x2,1),t.y2=el(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+o+i+")"}function el(t,e){return null!=t?t:e}const nl={basis:{curve:Zo.ZP},"basis-closed":{curve:Yo.Z},"basis-open":{curve:Vo.Z},bundle:{curve:Go.Z,tension:"beta",value:.85},cardinal:{curve:Xo.ZP,tension:"tension",value:0},"cardinal-open":{curve:Qo.Z,tension:"tension",value:0},"cardinal-closed":{curve:Jo.Z,tension:"tension",value:0},"catmull-rom":{curve:Ko.Z,tension:"alpha",value:.5},"catmull-rom-closed":{curve:ta.Z,tension:"alpha",value:.5},"catmull-rom-open":{curve:ea.Z,tension:"alpha",value:.5},linear:{curve:na.Z},"linear-closed":{curve:ra.Z},monotone:{horizontal:ia.s,vertical:ia.Z},natural:{curve:oa.Z},step:{curve:aa.ZP},"step-after":{curve:aa.cD},"step-before":{curve:aa.RN}};function rl(t,e,n){var r=yt(nl,t)&&nl[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const il={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},ol=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,al=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,sl=/^((\s+,?\s*)|(,\s*))/,ll=/^[01]/;function ul(t){const e=[];return(t.match(ol)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=il[r],o=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let o=0;o<e;++o){const e="a"!==t||3!==o&&4!==o?al:ll,a=n.slice(i).match(e);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(sl);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),a=o.length;if(a<i||a&&a%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<a;t+=i)e.push([n,...o.slice(t,t+i)])}})),e}const cl=Math.PI/180,fl=Math.PI/2,dl=2*Math.PI,hl=Math.sqrt(3)/2;var pl={},ml={},gl=[].join;function yl(t){const e=gl.call(t);if(ml[e])return ml[e];var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7];const c=u*a,f=-l*s,d=l*a,h=u*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),_=n+p-x*m,w=r+m+x*p,k=n+g,A=r+y,E=k+x*y,M=A-x*g;return ml[e]=[c*_+f*w,d*_+h*w,c*E+f*M,d*E+h*M,c*k+f*A,d*k+h*A]}const vl=["l",0,0,0,0,0,0,0];function bl(t,e,n){const r=vl[0]=t[0];if("a"===r||"A"===r)vl[1]=e*t[1],vl[2]=n*t[2],vl[3]=t[3],vl[4]=t[4],vl[5]=t[5],vl[6]=e*t[6],vl[7]=n*t[7];else if("h"===r||"H"===r)vl[1]=e*t[1];else if("v"===r||"V"===r)vl[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)vl[i]=(i%2==1?e:n)*t[i];return vl}function xl(t,e,n,r,i,o){var a,s,l,u,c,f=null,d=0,h=0,p=0,m=0,g=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var v=0,b=e.length;v<b;++v){switch(a=e[v],1===i&&1===o||(a=bl(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],t.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],t.lineTo(d+n,h+r);break;case"h":d+=a[1],t.lineTo(d+n,h+r);break;case"H":d=a[1],t.lineTo(d+n,h+r);break;case"v":h+=a[1],t.lineTo(d+n,h+r);break;case"V":h=a[1],t.lineTo(d+n,h+r);break;case"m":g=d+=a[1],y=h+=a[2],t.moveTo(d+n,h+r);break;case"M":g=d=a[1],y=h=a[2],t.moveTo(d+n,h+r);break;case"c":s=d+a[5],l=h+a[6],p=d+a[3],m=h+a[4],t.bezierCurveTo(d+a[1]+n,h+a[2]+r,p+n,m+r,s+n,l+r),d=s,h=l;break;case"C":d=a[5],h=a[6],p=a[3],m=a[4],t.bezierCurveTo(a[1]+n,a[2]+r,p+n,m+r,d+n,h+r);break;case"s":s=d+a[3],l=h+a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,d+a[1]+n,h+a[2]+r,s+n,l+r),p=d+a[1],m=h+a[2],d=s,h=l;break;case"S":s=a[3],l=a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"q":s=d+a[3],l=h+a[4],p=d+a[1],m=h+a[2],t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"Q":s=a[3],l=a[4],t.quadraticCurveTo(a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"t":s=d+a[1],l=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,m=h):"t"===f[0]?(p=2*d-u,m=2*h-c):"q"===f[0]&&(p=2*d-p,m=2*h-m),u=p,c=m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),h=l,p=(d=s)+a[1],m=h+a[2];break;case"T":s=a[1],l=a[2],p=2*d-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"a":_l(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":_l(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=g,h=y,t.closePath()}f=a}}function _l(t,e,n,r){const i=function(t,e,n,r,i,o,a,s,l){const u=gl.call(arguments);if(pl[u])return pl[u];const c=a*cl,f=Math.sin(c),d=Math.cos(c),h=d*(s-t)*.5+f*(l-e)*.5,p=d*(l-e)*.5-f*(s-t)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=d/n,y=f/n,v=-f/r,b=d/r,x=g*s+y*l,_=v*s+b*l,w=g*t+y*e,k=v*t+b*e;let A=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;A<0&&(A=0);let E=Math.sqrt(A);o==i&&(E=-E);const M=.5*(x+w)-E*(k-_),C=.5*(_+k)+E*(w-x),S=Math.atan2(_-C,x-M);let D=Math.atan2(k-C,w-M)-S;D<0&&1===o?D+=dl:D>0&&0===o&&(D-=dl);const F=Math.ceil(Math.abs(D/(fl+.001))),T=[];for(let N=0;N<F;++N){const t=S+N*D/F,e=S+(N+1)*D/F;T[N]=[M,C,t,e,n,r,f,d]}return pl[u]=T}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let o=0;o<i.length;++o){const e=yl(i[o]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const wl=.5773502691896257,kl={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,dl)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=hl*n,i=r-n*wl,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=hl*n,i=r-n*wl;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hl*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hl*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hl*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hl*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};var Al={};const El=.448084975506;function Ml(t){return t.x}function Cl(t){return t.y}function Sl(t){return t.width}function Dl(t){return t.height}function Fl(t){return"function"==typeof t?t:()=>+t}function Tl(t,e,n){return Math.max(e,Math.min(t,n))}function Nl(t,e){return null!=t?t:e}const Ol=t=>t.x||0,zl=t=>t.y||0,Rl=t=>!(!1===t.defined),Pl=function(){var t=ca,e=fa,n=(0,sa.Z)(0),r=null,i=da,o=ha,a=pa,s=null,l=(0,ua.d)(u);function u(){var u,c,f=+t.apply(this,arguments),d=+e.apply(this,arguments),h=i.apply(this,arguments)-la.ou,p=o.apply(this,arguments)-la.ou,m=(0,la.Wn)(p-h),g=p>h;if(s||(s=u=l()),d<f&&(c=d,d=f,f=c),d>la.Ho)if(m>la.BZ-la.Ho)s.moveTo(d*(0,la.mC)(h),d*(0,la.O$)(h)),s.arc(0,0,d,h,p,!g),f>la.Ho&&(s.moveTo(f*(0,la.mC)(p),f*(0,la.O$)(p)),s.arc(0,0,f,p,h,g));else{var y,v,b=h,x=p,_=h,w=p,k=m,A=m,E=a.apply(this,arguments)/2,M=E>la.Ho&&(r?+r.apply(this,arguments):(0,la._b)(f*f+d*d)),C=(0,la.VV)((0,la.Wn)(d-f)/2,+n.apply(this,arguments)),S=C,D=C;if(M>la.Ho){var F=(0,la.ZR)(M/f*(0,la.O$)(E)),T=(0,la.ZR)(M/d*(0,la.O$)(E));(k-=2*F)>la.Ho?(_+=F*=g?1:-1,w-=F):(k=0,_=w=(h+p)/2),(A-=2*T)>la.Ho?(b+=T*=g?1:-1,x-=T):(A=0,b=x=(h+p)/2)}var N=d*(0,la.mC)(b),O=d*(0,la.O$)(b),z=f*(0,la.mC)(w),R=f*(0,la.O$)(w);if(C>la.Ho){var P,B=d*(0,la.mC)(x),L=d*(0,la.O$)(x),j=f*(0,la.mC)(_),U=f*(0,la.O$)(_);if(m<la.pi)if(P=function(t,e,n,r,i,o,a,s){var l=n-t,u=r-e,c=a-i,f=s-o,d=f*l-c*u;if(!(d*d<la.Ho))return[t+(d=(c*(e-o)-f*(t-i))/d)*l,e+d*u]}(N,O,j,U,B,L,z,R)){var q=N-P[0],I=O-P[1],W=B-P[0],$=L-P[1],H=1/(0,la.O$)((0,la.Kh)((q*W+I*$)/((0,la._b)(q*q+I*I)*(0,la._b)(W*W+$*$)))/2),Z=(0,la._b)(P[0]*P[0]+P[1]*P[1]);S=(0,la.VV)(C,(f-Z)/(H-1)),D=(0,la.VV)(C,(d-Z)/(H+1))}else S=D=0}A>la.Ho?D>la.Ho?(y=ma(j,U,N,O,d,D,g),v=ma(B,L,z,R,d,D,g),s.moveTo(y.cx+y.x01,y.cy+y.y01),D<C?s.arc(y.cx,y.cy,D,(0,la.fv)(y.y01,y.x01),(0,la.fv)(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,D,(0,la.fv)(y.y01,y.x01),(0,la.fv)(y.y11,y.x11),!g),s.arc(0,0,d,(0,la.fv)(y.cy+y.y11,y.cx+y.x11),(0,la.fv)(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,D,(0,la.fv)(v.y11,v.x11),(0,la.fv)(v.y01,v.x01),!g))):(s.moveTo(N,O),s.arc(0,0,d,b,x,!g)):s.moveTo(N,O),f>la.Ho&&k>la.Ho?S>la.Ho?(y=ma(z,R,B,L,f,-S,g),v=ma(N,O,j,U,f,-S,g),s.lineTo(y.cx+y.x01,y.cy+y.y01),S<C?s.arc(y.cx,y.cy,S,(0,la.fv)(y.y01,y.x01),(0,la.fv)(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,S,(0,la.fv)(y.y01,y.x01),(0,la.fv)(y.y11,y.x11),!g),s.arc(0,0,f,(0,la.fv)(y.cy+y.y11,y.cx+y.x11),(0,la.fv)(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,S,(0,la.fv)(v.y11,v.x11),(0,la.fv)(v.y01,v.x01),!g))):s.arc(0,0,f,w,_,g):s.lineTo(z,R)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-la.pi/2;return[(0,la.mC)(r)*n,(0,la.O$)(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:(0,sa.Z)(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:(0,sa.Z)(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:(0,sa.Z)(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:(0,sa.Z)(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:(0,sa.Z)(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:(0,sa.Z)(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:(0,sa.Z)(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),Bl=(0,ga.Z)().x(Ol).y1(zl).y0((t=>(t.y||0)+(t.height||0))).defined(Rl),Ll=(0,ga.Z)().y(zl).x1(Ol).x0((t=>(t.x||0)+(t.width||0))).defined(Rl),jl=(0,ya.Z)().x(Ol).y(zl).defined(Rl),Ul=function(){var t=Ml,e=Cl,n=Sl,r=Dl,i=Fl(0),o=i,a=i,s=i,l=null;function u(u,c,f){var d,h=null!=c?c:+t.call(this,u),p=null!=f?f:+e.call(this,u),m=+n.call(this,u),g=+r.call(this,u),y=Math.min(m,g)/2,v=Tl(+i.call(this,u),0,y),b=Tl(+o.call(this,u),0,y),x=Tl(+a.call(this,u),0,y),_=Tl(+s.call(this,u),0,y);if(l||(l=d=(0,ba.ET)()),v<=0&&b<=0&&x<=0&&_<=0)l.rect(h,p,m,g);else{var w=h+m,k=p+g;l.moveTo(h+v,p),l.lineTo(w-b,p),l.bezierCurveTo(w-El*b,p,w,p+El*b,w,p+b),l.lineTo(w,k-_),l.bezierCurveTo(w,k-El*_,w-El*_,k,w-_,k),l.lineTo(h+x,k),l.bezierCurveTo(h+El*x,k,h,k-El*x,h,k-x),l.lineTo(h,p+v),l.bezierCurveTo(h,p+El*v,h+El*v,p,h+v,p),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(e){return arguments.length?(t=Fl(e),u):t},u.y=function(t){return arguments.length?(e=Fl(t),u):e},u.width=function(t){return arguments.length?(n=Fl(t),u):n},u.height=function(t){return arguments.length?(r=Fl(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=Fl(t),o=null!=e?Fl(e):i,s=null!=n?Fl(n):i,a=null!=r?Fl(r):o,u):i},u.context=function(t){return arguments.length?(l=null==t?null:t,u):l},u}().x(Ol).y(zl).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Nl(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Nl(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Nl(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Nl(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),ql=(0,va.ZP)().type((t=>{return e=t.shape||"circle",yt(kl,e)?kl[e]:function(t){if(!yt(Al,t)){const e=ul(t);Al[t]={draw:function(t,n){xl(t,e,0,0,Math.sqrt(n)/2)}}}return Al[t]}(e);var e})).size((t=>Nl(t.size,64))),Il=function(){var t,e,n,r,i,o,a,s,l=null;function u(t,e,n){const r=n/2;if(i){var u=a-e,c=t-o;if(u||c){var f=Math.sqrt(u*u+c*c),d=(u/=f)*s,h=(c/=f)*s,p=Math.atan2(c,u);l.moveTo(o-d,a-h),l.lineTo(t-u*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+d,a+h),l.arc(o,a,s,p,p+Math.PI)}else l.arc(t,e,r,0,dl);l.closePath()}else i=1;o=t,a=e,s=r}function c(o){var a,s,c,f=o.length,d=!1;for(null==l&&(l=c=(0,ba.ET)()),a=0;a<=f;++a)!(a<f&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&u(+t(s,a,o),+e(s,a,o),+n(s,a,o));if(c)return l=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(r=t,c):r},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}().x(Ol).y(zl).defined(Rl).size((t=>t.size||1));function Wl(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function $l(t,e,n,r){return Ul.context(t)(e,n,r)}var Hl=1;function Zl(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+Hl++),a=i.clipping[o]||(i.clipping[o]={id:o});return ot(r)?a.path=r(null):Wl(n)?a.path=$l(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Yl(t){this.clear(),t&&this.union(t)}function Vl(t){this.mark=t,this.bounds=this.bounds||new Yl}function Gl(t){Vl.call(this,t),this.items=this.items||[]}function Xl(t){this._pending=0,this._loader=t||Wn()}function Ql(t){t._pending+=1}function Jl(t){t._pending-=1}function Kl(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}Yl.prototype={clone(){return new Yl(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(t),l=Math.sin(t),u=e-e*s+n*l,c=n-e*l-n*s;return[s*r-l*i+u,l*r+s*i+c,s*r-l*a+u,l*r+s*a+c,s*o-l*i+u,l*o+s*i+c,s*o-l*a+u,l*o+s*a+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},xt(Gl,Vl),Xl.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return Ql(e),e._loader.sanitize(t,{context:"href"}).then((t=>(Jl(e),t))).catch((()=>(Jl(e),null)))},loadImage(t){const e=this,n="undefined"!=typeof Image?Image:null;return Ql(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=yt(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>Jl(e),i.onerror=()=>Jl(e),i.src=r,i})).catch((t=>(Jl(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const tu=dl-1e-8;let eu,nu,ru,iu,ou,au,su,lu;const uu=(t,e)=>eu.add(t,e),cu=(t,e)=>uu(nu=t,ru=e),fu=t=>uu(t,eu.y1),du=t=>uu(eu.x1,t),hu=(t,e)=>ou*t+su*e,pu=(t,e)=>au*t+lu*e,mu=(t,e)=>uu(hu(t,e),pu(t,e)),gu=(t,e)=>cu(hu(t,e),pu(t,e));function yu(t,e){return eu=t,e?(iu=e*cl,ou=lu=Math.cos(iu),au=Math.sin(iu),su=-au):(ou=lu=1,iu=au=su=0),vu}const vu={beginPath(){},closePath(){},moveTo:gu,lineTo:gu,rect(t,e,n,r){iu?(mu(t+n,e),mu(t+n,e+r),mu(t,e+r),gu(t,e)):(uu(t+n,e+r),cu(t,e))},quadraticCurveTo(t,e,n,r){const i=hu(t,e),o=pu(t,e),a=hu(n,r),s=pu(n,r);bu(nu,i,a,fu),bu(ru,o,s,du),cu(a,s)},bezierCurveTo(t,e,n,r,i,o){const a=hu(t,e),s=pu(t,e),l=hu(n,r),u=pu(n,r),c=hu(i,o),f=pu(i,o);xu(nu,a,l,c,fu),xu(ru,s,u,f,du),cu(c,f)},arc(t,e,n,r,i,o){if(r+=iu,i+=iu,nu=n*Math.cos(i)+t,ru=n*Math.sin(i)+e,Math.abs(i-r)>tu)uu(t-n,e-n),uu(t+n,e+n);else{const a=r=>uu(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,l;if(a(r),a(i),i!==r)if((r%=dl)<0&&(r+=dl),(i%=dl)<0&&(i+=dl),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=dl,s=r-r%fl,l=0;l<4&&s>i;++l,s-=fl)a(s);else for(s=r-r%fl+fl,l=0;l<4&&s<i;++l,s+=fl)a(s)}}};function bu(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function xu(t,e,n,r,i){const o=r-t+3*e-3*n,a=t+n-2*e,s=t-e;let l,u=0,c=0;Math.abs(o)>1e-14?(l=a*a+s*o,l>=0&&(l=Math.sqrt(l),u=(-a+l)/o,c=(-a-l)/o)):u=.5*s/a,0<u&&u<1&&i(_u(u,t,e,n,r)),0<c&&c<1&&i(_u(c,t,e,n,r))}function _u(t,e,n,r,i){const o=1-t,a=o*o,s=t*t;return a*o*e+3*a*t*n+3*o*s*r+s*t*i}var wu=(wu=xa(1,1))?wu.getContext("2d"):null;const ku=new Yl;function Au(t){return function(e,n){if(!wu)return!0;t(wu,e),ku.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=ku;for(let t=i;t<=a;++t)for(let e=r;e<=o;++e)if(wu.isPointInPath(e,t))return!0;return!1}}function Eu(t,e){return e.contains(t.x||0,t.y||0)}function Mu(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,o=t.height||0;return e.intersects(ku.set(n,r,n+i,r+o))}function Cu(t,e,n,r,i){const{x1:o,y1:a,x2:s,y2:l}=t,u=r-e,c=i-n;let f,d,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(f=-u,d=-(o-e)),1===p&&(f=u,d=s-e),2===p&&(f=-c,d=-(a-n)),3===p&&(f=c,d=l-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>g)return!1;h>m&&(m=h)}else if(f>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function Su(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Du(t,e){return null==t?e:t}function Fu(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Tu(t,e,n){return Ks(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+Du(e.x1,.5)*r,n.y1+Du(e.y1,.5)*i,Math.max(r,i)*Du(e.r1,0),n.x1+Du(e.x2,.5)*r,n.y1+Du(e.y2,.5)*i,Math.max(r,i)*Du(e.r2,.5));else{const a=Du(e.x1,0),s=Du(e.y1,0),l=Du(e.x2,1),u=Du(e.y2,0);if(a!==l&&s!==u&&r!==i){const n=xa(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=Fu(o.createLinearGradient(a,s,l,u),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+l*r,n.y1+u*i)}return Fu(o,e.stops)}(t,n,e.bounds):n}function Nu(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Tu(t,e,e.fill),!0)}var Ou=[];function zu(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Tu(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Ou),t.lineDashOffset=e.strokeDashOffset||0),!0)}function Ru(t,e){return t.zindex-e.zindex||t.index-e.index}function Pu(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(Ru)}function Bu(t,e){var n,r,i=t.items;if(!i||!i.length)return;const o=Pu(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}function Lu(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const o=Pu(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function ju(t){return function(e,n,r){Bu(n,(n=>{r&&!r.intersects(n.bounds)||qu(t,e,n,n)}))}}function Uu(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||qu(t,e,n.items[0],n.items)}}function qu(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Su(e,n),n.fill&&Nu(e,n,i)&&e.fill(),n.stroke&&zu(e,n,i)&&e.stroke()))}function Iu(t){return t=t||D,function(e,n,r,i,o,a){return r*=e.pixelRatio,i*=e.pixelRatio,Lu(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return t(e,n,r,i,o,a)?n:void 0}))}}function Wu(t,e){return function(n,r,i,o){var a,s,l=Array.isArray(r)?r[0]:r,u=null==e?l.fill:e,c=l.stroke&&n.isPointInStroke;return c&&(a=l.strokeWidth,s=l.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function $u(t){return Iu(Wu(t))}function Hu(t,e){return"translate("+t+","+e+")"}function Zu(t){return"rotate("+t+")"}function Yu(t){return Hu(t.x||0,t.y||0)}function Vu(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=cl),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return Hu(t.x||0,t.y||0)+(t.angle?" "+Zu(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(yu(t,n.angle),n),Kl(t,n).translate(n.x||0,n.y||0)},draw:ju(r),pick:$u(r),isect:n||Au(r)}}var Gu=Vu("arc",(function(t,e){return Pl.context(t)(e)}));function Xu(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=Wu(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(yu(t),r),Kl(t,r[0]))},draw:Uu(r),pick:function(t,e,n,r,o,a){var s=e.items,l=e.bounds;return!s||!s.length||l&&!l.contains(o,a)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Eu,tip:n}}var Qu=Xu("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Ll:Bl).curve(rl(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",a=t.length,s=1/0;--a>=0;)!1!==t[a].defined&&(r=Math.abs(t[a][o]-i))<s&&(s=r,n=t[a]);return n}));function Ju(t,e){t.beginPath(),Wl(e)?$l(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Ku(t){const e=Du(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function tc(t,e){const n=Ku(e);t("d",$l(null,e,n,n))}function ec(t,e,n,r){const i=Ku(e);t.beginPath(),$l(t,e,(n||0)+i,(r||0)+i)}const nc=Wu(ec),rc=Wu(ec,!1),ic=Wu(ec,!0);var oc={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Yu(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Kl(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){Bu(e,(e=>{const r=e.x||0,i=e.y||0,o=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(ec(t,e,r,i),Su(t,e),e.fill&&Nu(t,e,a)&&t.fill(),e.stroke&&!o&&zu(t,e,a)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&Ju(t,e),n&&n.translate(-r,-i),Bu(e,(e=>{this.draw(t,e,n)})),n&&n.translate(r,i),t.restore(),o&&e.stroke&&a&&(ec(t,e,r,i),Su(t,e),zu(t,e,a)&&t.stroke())}))},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const a=n*t.pixelRatio,s=r*t.pixelRatio;return Lu(e,(l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),m=l.clip;if(m&&(i<c||i>h||o<f||o>p))return;if(t.save(),t.translate(c,f),c=i-c,f=o-f,m&&Wl(l)&&!ic(t,l,a,s))return t.restore(),null;const g=l.strokeForeground,y=!1!==e.interactive;return y&&g&&l.stroke&&rc(t,l,a,s)?(t.restore(),l):(u=Lu(l,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,c,f)?this.pick(t,n,r,c,f):null)),!u&&y&&(l.fill||!g&&l.stroke)&&nc(t,l,a,s)&&(u=l),t.restore(),u||null)}))},isect:Mu,content:function(t,e,n){t("clip-path",e.clip?Zl(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),tc(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?tc(t,e):t("d","")}},ac={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function sc(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function lc(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function uc(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function cc(t,e){return"center"===t?e/2:"right"===t?e:0}function fc(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var dc={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=sc(e,n),i=lc(e,r),o=uc(e,r),a=(e.x||0)-cc(e.align,i),s=(e.y||0)-fc(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",ac["xmlns:xlink"],"xlink:href"),t("transform",Hu(a,s)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=lc(e,n),i=uc(e,n),o=(e.x||0)-cc(e.align,r),a=(e.y||0)-fc(e.baseline,i);return t.set(o,a,o+r,a+i)},draw:function(t,e,n){Bu(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=sc(e,this);let i=lc(e,r),o=uc(e,r);if(0===i||0===o)return;let a,s,l,u,c=(e.x||0)-cc(e.align,i),f=(e.y||0)-fc(e.baseline,o);!1!==e.aspect&&(s=r.width/r.height,l=e.width/e.height,s==s&&l==l&&s!==l&&(l<s?(u=i/s,f+=(o-u)/2,o=u):(u=o*s,c+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(Su(t,e),t.globalAlpha=null!=(a=e.opacity)?a:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,c,f,i,o))}))},pick:Iu(),isect:D,get:sc,xOffset:cc,yOffset:fc},hc=Xu("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return jl.curve(rl(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function pc(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,a=e.scaleY||1,s=(e.angle||0)*cl,l=e.pathCache;l&&l.path===n||((e.pathCache=l=ul(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),xl(t,l,0,0,o,a),t.rotate(-s),t.translate(-r,-i)):xl(t,l,r,i,o,a)}var mc={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return Hu(t.x||0,t.y||0)+(t.angle?" "+Zu(t.angle):"")+(t.scaleX||t.scaleY?" scale("+(t.scaleX||1)+","+(t.scaleY||1)+")":"")}(e)),t("d",e.path)},bound:function(t,e){return pc(yu(t,e.angle),e)?t.set(0,0,0,0):Kl(t,e,!0)},draw:ju(pc),pick:$u(pc),isect:Au(pc)};function gc(t,e){t.beginPath(),$l(t,e)}var yc={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",$l(null,e))},bound:function(t,e){var n,r;return Kl(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:ju(gc),pick:$u(gc),isect:Mu};function vc(t,e,n){var r,i,o,a;return!(!e.stroke||!zu(t,e,n)||(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,a=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),0))}var bc={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Yu(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return Kl(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Bu(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&vc(t,e,r)&&(Su(t,e),t.stroke())}}))},pick:Iu((function(t,e,n,r){return!!t.isPointInStroke&&vc(t,e,1)&&t.isPointInStroke(n,r)})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Cu(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},xc=Vu("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),_c=Vu("symbol",(function(t,e){return ql.context(t)(e)}),Eu);const wc=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>yt(e,t)||yt(n,t),get:t=>yt(e,t)?e[t]:yt(n,t)?o(t,n[t]):void 0,set:(t,n)=>yt(e,t)?e[t]=n:o(t,n)}}();var kc={height:Dc,measureWidth:Cc,estimateWidth:Ec,width:Ec,canvas:Ac};function Ac(t){kc.width=t&&wu?Cc:Ec}function Ec(t,e){return Mc(Oc(t,e),Dc(t))}function Mc(t,e){return~~(.8*t.length*e)}function Cc(t,e){return Dc(t)<=0||!(e=Oc(t,e))?0:Sc(e,Rc(t))}function Sc(t,e){const n="(".concat(e,") ").concat(t);let r=wc.get(n);return void 0===r&&(wu.font=e,r=wu.measureText(t).width,wc.set(n,r)),r}function Dc(t){return null!=t.fontSize?+t.fontSize||0:11}function Fc(t){return null!=t.lineHeight?t.lineHeight:Dc(t)+2}function Tc(t){return e=t.lineBreak&&t.text&&!L(t.text)?t.text.split(t.lineBreak):t.text,L(e)?e.length>1?e:e[0]:e;var e}function Nc(t){const e=Tc(t);return(L(e)?e.length-1:0)*Fc(t)}function Oc(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(kc.width===Cc){const e=Rc(t);return t=>Sc(t,e)}{const e=Dc(t);return t=>Mc(t,e)}}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"\u2026",a="rtl"===t.dir,s=0,l=e.length;if(n-=r(o),a){for(;s<l;)i=s+l>>>1,r(e.slice(i))>n?s=i+1:l=i;return o+e.slice(s)}for(;s<l;)i=1+(s+l>>>1),r(e.slice(0,i))<n?s=i:l=i-1;return e.slice(0,s)+o}(t,n):n}function zc(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Rc(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Dc(t)+"px "+zc(t,e)}function Pc(t){var e=t.baseline,n=Dc(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Fc(t):"line-bottom"===e?.29*n-.5*Fc(t):0)}Ac(!0);const Bc={left:"start",center:"middle",right:"end"},Lc=new Yl;function jc(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-fl,n+=i*Math.cos(e),r+=i*Math.sin(e)),Lc.x1=n,Lc.y1=r,Lc}function Uc(t,e,n){var r,i=kc.height(e),o=e.align,a=jc(e),s=a.x1,l=a.y1,u=e.dx||0,c=(e.dy||0)+Pc(e)-Math.round(.8*i),f=Tc(e);if(L(f)?(i+=Fc(e)*(f.length-1),r=f.reduce(((t,n)=>Math.max(t,kc.width(e,n))),0)):r=kc.width(e,f),"center"===o?u-=r/2:"right"===o&&(u-=r),t.set(u+=s,c+=l,u+r,c+i),e.angle&&!n)t.rotate(e.angle*cl,s,l);else if(2===n)return t.rotatedPoints(e.angle*cl,s,l);return t}var qc={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Pc(e),o=jc(e),a=o.x1,s=o.y1,l=e.angle||0;t("text-anchor",Bc[e.align]||"start"),l?(n=Hu(a,s)+" "+Zu(l),(r||i)&&(n+=" "+Hu(r,i))):n=Hu(a+r,s+i),t("transform",n)},bound:Uc,draw:function(t,e,n){Bu(e,(e=>{var r,i,o,a,s,l,u,c=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===c||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Rc(e),t.textAlign=e.align||"left",i=(r=jc(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*cl),i=o=0),i+=e.dx||0,o+=(e.dy||0)+Pc(e),l=Tc(e),Su(t,e),L(l))for(s=Fc(e),a=0;a<l.length;++a)u=Oc(e,l[a]),e.fill&&Nu(t,e,c)&&t.fillText(u,i,o),e.stroke&&zu(t,e,c)&&t.strokeText(u,i,o),o+=s;else u=Oc(e,l),e.fill&&Nu(t,e,c)&&t.fillText(u,i,o),e.stroke&&zu(t,e,c)&&t.strokeText(u,i,o);e.angle&&t.restore()}}))},pick:Iu((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var a=jc(e),s=a.x1,l=a.y1,u=Uc(Lc,e,1),c=-e.angle*cl,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*l),p=d*i+f*o+(l-d*s-f*l);return u.contains(h,p)})),isect:function(t,e){const n=Uc(Lc,t,2);return Cu(e,n[0],n[1],n[2],n[3])||Cu(e,n[0],n[1],n[4],n[5])||Cu(e,n[4],n[5],n[6],n[7])||Cu(e,n[2],n[3],n[6],n[7])}},Ic=Xu("trail",(function(t,e){return Il.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),Wc={arc:Gu,area:Qu,group:oc,image:dc,line:hc,path:mc,rect:yc,rule:bc,shape:xc,symbol:_c,text:qc,trail:Ic};function $c(t,e,n){var r=Wc[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new Yl),t,n)}var Hc={mark:null};const Zc=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Yc(t){return Vc("string"==typeof t?JSON.parse(t):t)}function Vc(t){var e,n,r,i=t.marktype,o=t.items;if(o)for(n=0,r=o.length;n<r;++n)e=i?"mark":"group",o[n][e]=t,o[n].zindex&&(o[n][e].zdirty=!0),"group"===(i||e)&&Vc(o[n]);return i&&function(t,e,n){var r,i,o,a,s=Wc[t.marktype],l=s.bound,u=t.items,c=u&&u.length;if(s.nested)return c?o=u[0]:(Hc.mark=t,o=Hc),a=$c(o,l,n),e&&e.union(a)||a;if(e=e||t.bounds&&t.bounds.clear()||new Yl,c)for(r=0,i=u.length;r<i;++r)e.union($c(u[r],l,n));t.bounds=e}(t),t}function Gc(t){arguments.length?this.root=Yc(t):(this.root=Xc({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Gl(this.root)])}function Xc(t,e){const n={bounds:new Yl,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function Qc(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function Jc(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function Kc(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=Qc(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function tf(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function ef(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function nf(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function rf(t,e){this._active=null,this._handlers={},this._loader=t||Wn(),this._tooltip=e||of}function of(t,e,n,r){t.element().setAttribute("title",r||"")}function af(t){this._el=null,this._bgcolor=null,this._loader=new Xl(t)}Gc.prototype={toJSON(t){return function(t,e){return JSON.stringify(t,Zc,e)}(this.root,t||0)},mark(t,e,n){const r=Xc(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},rf.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=Qc(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,o,a=t&&t.mark;if(a&&(i=Wc[a.marktype]).tip){for((o=nf(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(a.items,o)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,l+=t.y||0;return{x:s,y:l,width:o,height:a,left:s,top:l,right:s+o,bottom:l+a}}},af.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const sf="dragenter",lf="dragleave",uf="dragover",cf="mousedown",ff="mousemove",df="mouseout",hf="mouseover",pf="click",mf="mousewheel",gf="touchstart",yf="touchmove",vf="touchend",bf=ff,xf=df,_f=pf;function wf(t,e){rf.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function kf(t,e){(t=>t===gf||t===yf||t===vf?[gf,yf,vf]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function Af(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r)),this.fire(t,r)}}function Ef(t){return function(e){this.fire(t,e),this._active=null}}xt(wf,rf,{initialize(t,e,n){return this._canvas=t&&Jc(t,"canvas"),[pf,cf,ff,df,lf].forEach((t=>kf(this,t))),rf.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",sf,lf,uf,cf,"mouseup",ff,df,hf,pf,"dblclick","wheel",mf,gf,yf,vf],DOMMouseScroll(t){this.fire(mf,t)},mousemove:Af(ff,hf,df),dragover:Af(uf,sf,lf),mouseout:Ef(df),dragleave:Ef(lf),mousedown(t){this._down=this._active,this.fire(cf,t)},click(t){this._down===this._active&&(this.fire(pf,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(gf,t,!0)},touchmove(t){this.fire(yf,t,!0)},touchend(t){this.fire(vf,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===_f&&r&&r.href?this.handleHref(e,r,r.href):t!==bf&&t!==xf||this.handleTooltip(e,r,t!==xf),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(kf(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=nf(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const o=this.context();return Wc[t.marktype].pick.call(this,o,t,e,n,r,i)}});var Mf="undefined"!=typeof window&&window.devicePixelRatio||1;function Cf(t){af.call(this,t),this._options={},this._redraw=!1,this._dirty=new Yl,this._tempb=new Yl}const Sf=af.prototype;function Df(t,e){rf.call(this,t,e);const n=this;n._hrefHandler=Ff(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=Ff(n,((t,e)=>{n.handleTooltip(t,e,t.type!==xf)}))}xt(Cf,af,{initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:xa(1,1,this._options.type),t&&this._canvas&&(tf(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Sf.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(Sf.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,o){const a="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),l=a?Mf:i;t.width=e*l,t.height=n*l;for(const u in o)s[u]=o[u];a&&1!==l&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||w("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((t,e,n)=>(new Yl).set(0,0,e,n).translate(-t[0],-t[1]))(n,r,i);e.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,s),e.restore(),o.clear(),this},draw(t,e,n){const r=Wc[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),ot(n)?(t.beginPath(),n(t),t.clip()):Ju(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}});const Ff=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};xt(Df,rf,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(_f,this._hrefHandler),r.removeEventListener(bf,this._tooltipHandler),r.removeEventListener(xf,this._tooltipHandler)),this._svg=r=t&&Jc(t,"svg"),r&&(r.addEventListener(_f,this._hrefHandler),r.addEventListener(bf,this._tooltipHandler),r.addEventListener(xf,this._tooltipHandler)),rf.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:Ff(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Tf="aria-hidden",Nf="aria-label",Of="role",zf="aria-roledescription",Rf="graphics-object",Pf="graphics-symbol",Bf=(t,e,n)=>({[Of]:t,[zf]:e,[Nf]:n||void 0}),Lf=zt(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),jf={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?$f(t):null,i=t.context,o=i.scales[e.scale].value,a=i.dataflow.locale(),s=o.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(ys(s)?"discrete":s," scale")+" with ".concat(Xs(a,o,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?$f(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,o=Object.keys(i),a=t.context,s=a.scales[i[o[0]]].value,l=a.dataflow.locale();return((u=r).length?u[0].toUpperCase()+u.slice(1):u)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return(t=t.map((t=>t+("fill"===t||"stroke"===t?" color":"")))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+H(t)}(o))+" with ".concat(Xs(l,s,t));var u}},"title-text":{desc:"title",caption:t=>"Title text '".concat(Wf(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(Wf(t),"'")}},Uf={ariaRole:Of,ariaRoleDescription:zf,description:Nf};function qf(t,e){const n=!1===e.aria;if(t(Tf,n||void 0),n||null==e.description)for(const r in Uf)t(Uf[r],void 0);else{const n=e.mark.marktype;t(Nf,e.description),t(Of,e.ariaRole||("group"===n?Rf:Pf)),t(zf,e.ariaRoleDescription||"".concat(n," mark"))}}function If(t){return!1===t.aria?{[Tf]:!0}:Lf[t.role]?null:jf[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Bf(e.role||Pf,e.desc,n.description||r(n))}catch(t){return null}}(t,jf[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Bf(n?Rf:Pf,"".concat(e," mark container"),t.description)}(t)}function Wf(t){return it(t.text).join(" ")}function $f(t){try{return it(H(t.items).items[0].text).join(" ")}catch(t){return null}}const Hf=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function Zf(){let t="",e="",n="";const r=[],i=()=>e=n="",o=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(Hf(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),a),a={open(s){(o=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(o)})(s),e="<"+s;for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(const t of u)for(const e in t)o(e,t[e]);return a},close(){const o=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(o,">"):"/>"):"</".concat(o,">"),i(),a},attr:o,text:t=>(n+=Hf(t),a),toString:()=>t};return a}const Yf=t=>Vf(Zf(),t)+"";function Vf(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):Vf(t,e)}return t.close()}const Gf={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Xf={blend:"mix-blend-mode"},Qf={fill:"none","stroke-miterlimit":10},Jf="http://www.w3.org/2000/xmlns/",Kf=ac.xmlns;function td(t){af.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const ed=af.prototype;function nd(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function rd(t,e,n){let r,i,o;if("radial"===e.gradient){let r=Kc(t,n++,"pattern",Kf);fd(r,{id:Js+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=Kc(r,0,"rect",Kf),fd(r,{width:1,height:1,fill:"url(".concat(hd(),"#").concat(e.id,")")}),fd(t=Kc(t,n++,"radialGradient",Kf),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else fd(t=Kc(t,n++,"linearGradient",Kf),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=Kc(t,r,"stop",Kf),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return tf(t,r),n}function id(t,e,n){let r;return(t=Kc(t,n,"clipPath",Kf)).setAttribute("id",e.id),e.path?(r=Kc(t,0,"path",Kf),r.setAttribute("d",e.path)):(r=Kc(t,0,"rect",Kf),fd(r,{x:0,y:0,width:e.width,height:e.height})),tf(t,1),n+1}function od(t,e,n,r,i){let o,a=t._svg;if(!a&&(o=e.ownerDocument,a=Qc(o,r,Kf),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},"g"===r))){const e=Qc(o,"path",Kf);a.appendChild(e),e.__data__=t;const n=Qc(o,"g",Kf);a.appendChild(n),n.__data__=t;const r=Qc(o,"path",Kf);a.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}xt(td,af,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=Kc(t,0,"svg",Kf),this._svg.setAttributeNS(Jf,"xmlns",Kf),this._svg.setAttributeNS(Jf,"xmlns:xlink",ac["xmlns:xlink"]),this._svg.setAttribute("version",ac.version),this._svg.setAttribute("class","marks"),tf(t,1),this._root=Kc(this._svg,0,"g",Kf),fd(this._root,Qf),tf(this._svg,1)),this.background(this._bgcolor),ed.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),ed.background.apply(this,arguments)},resize(t,e,n,r){return ed.resize.call(this,t,e,n,r),this._svg&&(fd(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=Kc(t,0,"rect",Kf),fd(n,{width:this._width,height:this._height,fill:e}));const r=Yf(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),tf(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,o,a,s,l;for(a=0,s=t.length;a<s;++a)n=t[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=Wc[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,nd(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,nd(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=Wc[e.marktype],o=!1===e.interactive?"none":null,a="g"===i.tag,s=od(e,t,n,"g",r);s.setAttribute("class",ef(e));const l=If(e);for(const d in l)dd(s,d,l[d]);a||dd(s,"pointer-events",o),dd(s,"clip-path",e.clip?Zl(this,e,e.group):null);let u=null,c=0;const f=t=>{const e=this.isDirty(t),n=od(t,s,u,i.tag,r);e&&(this._update(i,n,t),a&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;Bu(n,(n=>{r=t.mark(e,n,r),++i})),tf(e,1+i)}(this,n,t)),u=n,++c};return i.nested?e.items.length&&f(e.items[0]):Bu(e,f),tf(s,c),s},_update(t,e,n){ad=e,sd=e.__values__,qf(ud,n),t.attr(ud,n,this);const r=ld[t.type];r&&r.call(this,t,e,n),ad&&this.style(ad,n)},style(t,e){if(null!=e){for(const n in Gf){let r="font"===n?zc(e):e[n];if(r===sd[n])continue;const i=Gf[n];null==r?t.removeAttribute(i):(Ks(r)&&(r=tl(r,this._defs.gradient,hd())),t.setAttribute(i,r+"")),sd[n]=r}for(const n in Xf)cd(t,Xf[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=Kc(t,1,"defs",Kf)),r=rd(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=Kc(t,1,"defs",Kf)),r=id(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):tf(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let ad=null,sd=null;const ld={group(t,e,n){const r=ad=e.childNodes[2];sd=r.__values__,t.foreground(ud,n,this),sd=e.__values__,ad=e.childNodes[1],t.content(ud,n,this);const i=ad=e.childNodes[0];t.background(ud,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==sd.events&&(dd(r,"pointer-events",o),dd(i,"pointer-events",o),sd.events=o),n.strokeForeground&&n.stroke){const t=n.fill;dd(r,"display",null),this.style(i,n),dd(i,"stroke",null),t&&(n.fill=null),sd=r.__values__,this.style(r,n),t&&(n.fill=t),ad=null}else dd(r,"display","none")},image(t,e,n){!1===n.smooth?(cd(e,"image-rendering","optimizeSpeed"),cd(e,"image-rendering","pixelated")):cd(e,"image-rendering",null)},text(t,e,n){const r=Tc(n);let i,o,a,s;L(r)?(o=r.map((t=>Oc(n,t))),i=o.join("\n"),i!==sd.text&&(tf(e,0),a=e.ownerDocument,s=Fc(n),o.forEach(((t,r)=>{const i=Qc(a,"tspan",Kf);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),sd.text=i)):(o=Oc(n,r),o!==sd.text&&(e.textContent=o,sd.text=o)),dd(e,"font-family",zc(n)),dd(e,"font-size",Dc(n)+"px"),dd(e,"font-style",n.fontStyle),dd(e,"font-variant",n.fontVariant),dd(e,"font-weight",n.fontWeight)}};function ud(t,e,n){e!==sd[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(ad,t,e,n):dd(ad,t,e),sd[t]=e)}function cd(t,e,n){n!==sd[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),sd[e]=n)}function fd(t,e){for(const n in e)dd(t,n,e[n])}function dd(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function hd(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function pd(t){af.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}xt(pd,af,{svg(){return this._text},_render(t){const e=Zf();e.open("svg",pt({},ac,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",Qf,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Wc[e.marktype],r=n.tag,i=[qf,n.attr];t.open("g",{class:ef(e),"clip-path":e.clip?Zl(this,e,e.group):null},If(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&t.open("a",a),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=Tc(o);if(L(e)){const n={x:0,dy:Fc(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Oc(o,e[r])).close()}else t.text(Oc(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),Bu(o,(e=>this.mark(t,e))),t.close(),r&&a?(i&&(o.fill=null),o.stroke=a,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),a&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):Bu(e,o),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(o,e,this))):n(o,e,this),r&&function(t,e,n,r,i){let o;if(null==e)return t;if("bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===r&&(t["font-family"]=zc(e),t["font-size"]=Dc(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in Gf){let n=e[a];const r=Gf[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(Ks(n)&&(n=tl(n,i.gradient,"")),t[r]=n)}for(const a in Xf){const t=e[a];null!=t&&(o=o||[],o.push("".concat(Xf[a],": ").concat(t,";")))}o&&(t.style=o.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:Js+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const md="canvas",gd="none",yd={Canvas:md,PNG:"png",SVG:"svg",None:gd},vd={};function bd(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(vd[t]=e,this):vd[t]}function xd(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)_d(i[s],e,n,r);else for(const t=Wc[o].isect;s<a;++s){const n=i[s];wd(n,e,t)&&r.push(n)}}return r}function _d(t,e,n,r){n&&n(t.mark)&&wd(t,e,Wc.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const a=t.x||0,s=t.y||0;e.translate(-a,-s);for(let t=0;t<o;++t)xd(i[t],e,n,r);e.translate(a,s)}return r}function wd(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}vd[md]=vd.png={renderer:Cf,headless:Cf,handler:wf},vd.svg={renderer:td,headless:pd,handler:Df},vd[gd]={};const kd=new Yl,Ad="top",Ed="left",Md="right",Cd="bottom",Sd="start",Dd="middle",Fd="end",Td="group",Nd="axis",Od="title",zd="legend",Rd="row-header",Pd="row-footer",Bd="row-title",Ld="column-header",jd="column-footer",Ud="column-title",qd="fit-x",Id="fit-y",Wd="none",$d="all",Hd="each",Zd="flush",Yd="column",Vd="row";function Gd(t){Cr.call(this,null,t)}function Xd(t,e,n){return e(t.bounds.clear(),t,n)}xt(Gd,Cr,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=Wc[i],a=o.bound;let s,l=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),l=Xd(r,a),r.items.forEach((t=>{t.bounds.clear().union(l)}));else if(i===Td||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),l.clear(),r.items.forEach((t=>l.union(Xd(t,a)))),r.role){case Nd:case zd:case Od:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,(t=>{l.union(Xd(t,a))})),e.visit(e.MOD,(t=>{s=s||l.alignsWith(t.bounds),n.dirty(t),l.union(Xd(t,a))})),s&&(l.clear(),r.items.forEach((t=>l.union(t.bounds))));return function(t){const e=t.clip;if(ot(e))e(yu(kd.clear()));else{if(!e)return;kd.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(kd)}(r),e.modifies("bounds")}});const Qd=":vega_identifier:";function Jd(t){Cr.call(this,0,t)}function Kd(t){Cr.call(this,null,t)}function th(t){Cr.call(this,null,t)}Jd.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},xt(Jd,Cr,{transform(t,e){const n=(i=e.dataflow)._signals[Qd]||(i._signals[Qd]=i.add(0)),r=t.as;var i;let o=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++o)),n.set(this.value=o),e}}),xt(Kd,Cr,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===Td?Gl:Vl;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const eh={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&nh(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},nh=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),rh=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(nh(o,n=t[r].bounds,e))return!0},ih=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},oh=t=>(t.forEach((t=>t.opacity=1)),t),ah=(t,e)=>t.reflow(e.modified()).modifies("opacity");function sh(t){Cr.call(this,null,t)}xt(th,Cr,{transform(t,e){const n=eh[t.method]||eh.parity,r=t.separation||0;let i,o,a=e.materialize(e.SOURCE).source;if(!a||!a.length)return;if(!t.method)return t.modified("method")&&(oh(a),e=ah(e,t)),e;if(a=a.filter(ih),!a.length)return;if(t.sort&&(a=a.slice().sort(t.sort)),i=oh(a),e=ah(e,t),i.length>=3&&rh(i,r)){do{i=n(i,r)}while(i.length>=3&&rh(i,r));i.length<3&&!H(a).opacity&&(i.length>1&&(H(i).opacity=0),H(a).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=((t,e,n)=>{var r=t.range(),i=new Yl;return e===Ad||e===Cd?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),a.forEach((t=>{o(t)||(t.opacity=0)})));const s=i[0].mark.bounds.clear();return a.forEach((t=>{t.opacity&&s.union(t.bounds)})),e}}),xt(sh,Cr,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const lh=new Yl;function uh(t,e,n){return t[e]===n?0:(t[e]=n,1)}function ch(t){var e=t.items[0].orient;return e===Ed||e===Md}function fh(t,e,n,r){var i,o,a=e.items[0],s=a.datum,l=null!=a.translate?a.translate:.5,u=a.orient,c=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&Nc(g),x=0,_=0;switch(lh.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),u){case Ad:x=h||0,_=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(f,0),g&&dh(t,g,o,y,b,0,-1,v);break;case Ed:x=-d,_=h||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,f),g&&dh(t,g,o,y,b,1,-1,v);break;case Md:x=n+d,_=h||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,f),g&&dh(t,g,o,y,b,1,1,v);break;case Cd:x=h||0,_=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(f,o),g&&dh(t,g,o,y,0,0,1,v);break;default:x=a.x,_=a.y}return Kl(v.translate(x,_),a),uh(a,"x",x+l)|uh(a,"y",_+l)&&(a.bounds=lh,t.dirty(a),a.bounds=v,t.dirty(a)),a.mark.bounds.clear().union(v)}function dh(t,e,n,r,i,o,a,s){const l=e.bounds;if(e.auto){const s=a*(n+i+r);let u=0,c=0;t.dirty(e),o?u=(e.x||0)-(e.x=s):c=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(l.translate(-u,-c)),t.dirty(e)}s.union(l)}const hh=(t,e)=>Math.floor(Math.min(t,e)),ph=(t,e)=>Math.ceil(Math.max(t,e));function mh(t){return(new Yl).set(0,0,t.width||0,t.height||0)}function gh(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function yh(t,e,n){const r=U(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function vh(t){return t<0?Math.ceil(-t):0}function bh(t,e,n){var r,i,o,a,s,l,u,c,f,d,h,p=!n.nodirty,m=n.bounds===Zd?mh:gh,g=lh.set(0,0,0,0),y=yh(n.align,Yd),v=yh(n.align,Vd),b=yh(n.padding,Yd),x=yh(n.padding,Vd),_=n.columns||e.length,w=_<=0?1:Math.ceil(e.length/_),k=e.length,A=Array(k),E=Array(_),M=0,C=Array(k),S=Array(w),D=0,F=Array(k),T=Array(k),N=Array(k);for(i=0;i<_;++i)E[i]=0;for(i=0;i<w;++i)S[i]=0;for(i=0;i<k;++i)l=e[i],s=N[i]=m(l),l.x=l.x||0,F[i]=0,l.y=l.y||0,T[i]=0,o=i%_,a=~~(i/_),M=Math.max(M,u=Math.ceil(s.x2)),D=Math.max(D,c=Math.ceil(s.y2)),E[o]=Math.max(E[o],u),S[a]=Math.max(S[a],c),A[i]=b+vh(s.x1),C[i]=x+vh(s.y1),p&&t.dirty(e[i]);for(i=0;i<k;++i)i%_==0&&(A[i]=0),i<_&&(C[i]=0);if(y===Hd)for(o=1;o<_;++o){for(h=0,i=o;i<k;i+=_)h<A[i]&&(h=A[i]);for(i=o;i<k;i+=_)A[i]=h+E[o-1]}else if(y===$d){for(h=0,i=0;i<k;++i)i%_&&h<A[i]&&(h=A[i]);for(i=0;i<k;++i)i%_&&(A[i]=h+M)}else for(y=!1,o=1;o<_;++o)for(i=o;i<k;i+=_)A[i]+=E[o-1];if(v===Hd)for(a=1;a<w;++a){for(h=0,r=(i=a*_)+_;i<r;++i)h<C[i]&&(h=C[i]);for(i=a*_;i<r;++i)C[i]=h+S[a-1]}else if(v===$d){for(h=0,i=_;i<k;++i)h<C[i]&&(h=C[i]);for(i=_;i<k;++i)C[i]=h+D}else for(v=!1,a=1;a<w;++a)for(r=(i=a*_)+_;i<r;++i)C[i]+=S[a-1];for(f=0,i=0;i<k;++i)f=A[i]+(i%_?f:0),F[i]+=f-e[i].x;for(o=0;o<_;++o)for(d=0,i=o;i<k;i+=_)d+=C[i],T[i]+=d-e[i].y;if(y&&yh(n.center,Yd)&&w>1)for(i=0;i<k;++i)(f=(s=y===$d?M:E[i%_])-N[i].x2-e[i].x-F[i])>0&&(F[i]+=f/2);if(v&&yh(n.center,Vd)&&1!==_)for(i=0;i<k;++i)(d=(s=v===$d?D:S[~~(i/_)])-N[i].y2-e[i].y-T[i])>0&&(T[i]+=d/2);for(i=0;i<k;++i)g.union(N[i].translate(F[i],T[i]));switch(f=yh(n.anchor,"x"),d=yh(n.anchor,"y"),yh(n.anchor,Yd)){case Fd:f-=g.width();break;case Dd:f-=g.width()/2}switch(yh(n.anchor,Vd)){case Fd:d-=g.height();break;case Dd:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),i=0;i<k;++i)e[i].mark.bounds.clear();for(i=0;i<k;++i)(l=e[i]).x+=F[i]+=f,l.y+=T[i]+=d,g.union(l.mark.bounds.union(l.bounds.translate(F[i],T[i]))),p&&t.dirty(l);return g}function xh(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function _h(t,e){return t.bounds[e]}function wh(t,e,n,r,i,o,a,s,l,u,c,f,d,h){var p,m,g,y,v,b,x,_,w,k=n.length,A=0,E=0;if(!k)return A;for(p=c;p<k;p+=f)n[p]&&(A=a(A,l(n[p],u)));if(!e.length)return A;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),A+=o,m=0,y=e.length;m<y;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=c,m=0,y=e.length;m<y;++m,p+=f){for(v=(b=e[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);s?(_=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),w=A):(_=A,w=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),v.union(b.bounds.translate(_-(b.x||0),w-(b.y||0))),b.x=_,b.y=w,t.dirty(b),E=a(E,v[u])}return E}function kh(t,e,n,r,i,o){if(e){t.dirty(e);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),e.bounds.translate(a-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=a,e.y=s,t.dirty(e)}}function Ah(t,e,n,r,i,o,a){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),l=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,s("offset",0)),u=s("anchor",Sd),c=u===Fd?1:u===Dd?.5:0,f={align:Hd,bounds:s("bounds",Zd),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case Ed:f.anchor={x:Math.floor(r.x1)-l,column:Fd,y:c*(a||r.height()+2*r.y1),row:u};break;case Md:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case Ad:f.anchor={y:Math.floor(i.y1)-l,row:Fd,x:c*(o||i.width()+2*i.x1),column:u};break;case Cd:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case"top-left":f.anchor={x:l,y:l};break;case"top-right":f.anchor={x:o-l,y:l,column:Fd};break;case"bottom-left":f.anchor={x:l,y:a-l,row:Fd};break;case"bottom-right":f.anchor={x:o-l,y:a-l,column:Fd,row:Fd}}return f}function Eh(t,e){var n,r,i=e.items[0],o=i.datum,a=i.orient,s=i.bounds,l=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var a=e.items[1].items[0],s=a.anchor,l=e.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case Ed:i+=Math.ceil(a.bounds.width())+l;break;case Md:case Cd:break;default:o+=a.bounds.height()+l}switch((i||o)&&Ch(t,n,i,o),a.orient){case Ed:c+=Mh(e,n,a,s,1,1);break;case Md:u+=Mh(e,n,a,Fd,0,0)+l,c+=Mh(e,n,a,s,1,1);break;case Cd:u+=Mh(e,n,a,s,0,0),c+=Mh(e,n,a,Fd,-1,0,1)+l;break;default:u+=Mh(e,n,a,s,0,0)}(u||c)&&Ch(t,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(Ch(t,n,-u,0),Ch(t,a,-u,0))}else(i||o)&&Ch(t,n,i,o)}(t,i,i.items[0].items[0]),s=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),"symbol"===o.type&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),a!==Wd&&(i.x=l=0,i.y=u=0),i.width=n,i.height=r,Kl(s.set(l,u,l+n,u+r),i),i.mark.bounds.clear().union(s),i}function Mh(t,e,n,r,i,o,a){const s="symbol"!==t.datum.type,l=n.datum.vgrad,u=(!s||!o&&l||a?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,c=l&&o?u:0,f=l&&o?0:u,d=i<=0?0:Nc(n);return Math.round(r===Sd?c:r===Fd?f-d:.5*(u-d))}function Ch(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function Sh(t){Cr.call(this,null,t)}xt(Sh,Cr,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&function(t,e,n){var r,i,o,a,s,l,u,c=function(t){var e,n,r=t.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(e=r[o]).items,e.marktype===Td)switch(e.role){case Nd:case zd:case Od:break;case Rd:a.rowheaders.push(...n);break;case Pd:a.rowfooters.push(...n);break;case Ld:a.colheaders.push(...n);break;case jd:a.colfooters.push(...n);break;case Bd:a.rowtitle=n[0];break;case Ud:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(e),f=c.marks,d=n.bounds===Zd?xh:_h,h=n.offset,p=n.columns||f.length,m=p<=0?1:Math.ceil(f.length/p),g=m*p;const y=bh(t,f,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(l=yh(n.headerBand,Vd,null),r=wh(t,c.rowheaders,f,0,m,-yh(h,"rowHeader"),hh,0,d,"x1",0,p,1,l)),c.colheaders&&(l=yh(n.headerBand,Yd,null),i=wh(t,c.colheaders,f,0,p,-yh(h,"columnHeader"),hh,1,d,"y1",0,1,p,l)),c.rowfooters&&(l=yh(n.footerBand,Vd,null),o=wh(t,c.rowfooters,f,0,m,yh(h,"rowFooter"),ph,0,d,"x2",p-1,p,1,l)),c.colfooters&&(l=yh(n.footerBand,Yd,null),a=wh(t,c.colfooters,f,0,p,yh(h,"columnFooter"),ph,1,d,"y2",g-p,1,p,l)),c.rowtitle&&(s=yh(n.titleAnchor,Vd),u=yh(h,"rowTitle"),u=s===Fd?o+u:r-u,l=yh(n.titleBand,Vd,.5),kh(t,c.rowtitle,u,0,y,l)),c.coltitle&&(s=yh(n.titleAnchor,Yd),u=yh(h,"columnTitle"),u=s===Fd?a+u:i-u,l=yh(n.titleBand,Yd,.5),kh(t,c.coltitle,u,1,y,l))}(n,e,t.layout),function(t,e,n){var r,i,o,a,s,l=e.items,u=Math.max(0,e.width||0),c=Math.max(0,e.height||0),f=(new Yl).set(0,0,u,c),d=f.clone(),h=f.clone(),p=[];for(a=0,s=l.length;a<s;++a)switch((i=l[a]).role){case Nd:(ch(i)?d:h).union(fh(t,i,u,c));break;case Od:r=i;break;case zd:p.push(Eh(t,i));break;case"frame":case"scope":case Rd:case Pd:case Bd:case Ld:case jd:case Ud:d.union(i.bounds),h.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(o=t.orient||Md)!==Wd&&(e[o]||(e[o]=[])).push(t)}));for(const r in e){const i=e[r];bh(t,i,Ah(i,r,n.legends,d,h,u,c))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),!n.autosize||"fit"!==n.autosize.type&&n.autosize.type!==qd&&n.autosize.type!==Id)f.union(r);else switch(e.orient){case Ed:case Md:f.add(r.x1,0).add(r.x2,0);break;case Ad:case Cd:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(t,e,n,r,i){var o,a=e.items[0],s=a.frame,l=a.orient,u=a.anchor,c=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=l===Ed||l===Md?r:n,m=0,g=0,y=0,v=0,b=0;if(s!==Td?l===Ed?(m=i.y2,p=i.y1):l===Md?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):l===Ed&&(m=r,p=0),o=u===Sd?m:u===Fd?p:(m+p)/2,h&&h.text){switch(l){case Ad:case Cd:b=d.bounds.height()+f;break;case Ed:v=d.bounds.width()+f;break;case Md:v=-d.bounds.width()-f}lh.clear().union(h.bounds),lh.translate(v-(h.x||0),b-(h.y||0)),uh(h,"x",v)|uh(h,"y",b)&&(t.dirty(h),h.bounds.clear().union(lh),h.mark.bounds.clear().union(lh),t.dirty(h)),lh.clear().union(h.bounds)}else lh.clear();switch(lh.union(d.bounds),l){case Ad:g=o,y=i.y1-lh.height()-c;break;case Ed:g=i.x1-lh.width()-c,y=o;break;case Md:g=i.x2+lh.width()+c,y=o;break;case Cd:g=o,y=i.y2+c;break;default:g=a.x,y=a.y}return uh(a,"x",g)|uh(a,"y",y)&&(lh.translate(g,y),t.dirty(a),a.bounds.clear().union(lh),e.bounds.clear().union(lh),t.dirty(a)),a.bounds}(t,r,u,c,f)),e.clip&&f.set(0,0,e.width||0,e.height||0),function(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let a=t._width,s=t._height,l=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,e.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===i.contains){const e=t.padding();a-=e.left+e.right,s-=e.top+e.bottom}o===Wd?(u=0,f=0,l=a,c=s):"fit"===o?(l=Math.max(0,a-u-d),c=Math.max(0,s-f-h)):o===qd?(l=Math.max(0,a-u-d),s=c+f+h):o===Id?(a=l+u+d,c=Math.max(0,s-f-h)):"pad"===o&&(a=l+u+d,s=c+f+h),t._resizeView(a,s,l,c,[u,f],i.resize)}(t,e,f,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}});var Dh=n(9199),Fh=n(6677),Th=n(120);function Nh(t){Cr.call(this,null,t)}function Oh(t){Cr.call(this,null,t)}function zh(){return Qn({})}function Rh(t){Cr.call(this,null,t)}function Ph(t){Cr.call(this,[],t)}xt(Nh,Cr,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,a=Rs(o,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||Ls(n,o,a,t.formatSpecifier,t.formatType,!!t.values),l=t.values?Ps(o,t.values,a):Bs(o,a);return i&&(r.rem=i),i=l.map(((t,e)=>Qn({index:e/(l.length-1||1),value:t,label:s(t)}))),t.extra&&i.length&&i.push(Qn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),xt(Oh,Cr,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||zh,o=t.key||Gn,a=this.value;return L(r.encode)&&(r.encode=null),a&&(t.modified("key")||e.modified(o))&&w("DataJoin does not support modified key function or fields."),a||(e=e.addAll(),this.value=a=function(t){const e=bt().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(o)),e.visit(e.ADD,(t=>{const e=o(t);let n=a.get(e);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),a.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=o(t),n=a.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=o(t),n=a.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),xt(Rh,Cr,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if(L(o)){if(!n.changed()&&!o.every((t=>i[t])))return e.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||F,l=i.enter||F,u=i.exit||F,c=(o&&!a?i[o]:s)||F;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{l(e,t),s(e,t)})),n.modifies(l.output),n.modifies(s.output),c!==F&&c!==s&&(e.visit(e.ADD,(e=>{c(e,t)})),n.modifies(c.output))),e.changed(e.REM)&&u!==F&&(e.visit(e.REM,(e=>{u(e,t)})),n.modifies(u.output)),a||c!==F){const i=e.MOD|(t.modified()?e.REFLOW:0);a?(e.visit(i,(e=>{const i=l(e,t)||r;(c(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)):e.visit(i,(e=>{(c(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:e.StopPropagation}}),xt(Ph,Cr,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,a,s=e.dataflow.locale(),l=e.fork(e.NO_SOURCE|e.NO_FIELDS),u=this.value,c=t.type||Fs,f=t.scale,d=+t.limit,h=Rs(f,null==t.count?5:t.count,t.minstep),p=!!t.values||c===Fs,m=t.format||$s(s,f,h,c,t.formatSpecifier,t.formatType,p),g=t.values||Is(f,h);return u&&(l.rem=u),c===Fs?(d&&g.length>d?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=g.slice(0,d-1),a=!0):u=g,ot(i=t.size)?(t.values||0!==f(u[0])||(u=u.slice(1)),o=u.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=dt(o=i||8),u=u.map(((e,n)=>Qn({index:n,label:m(e,n,u),value:e,offset:o,size:i(e,t)}))),a&&(a=g[u.length],u.push(Qn({index:u.length,label:"\u2026".concat(g.length-u.length," entries"),value:a,offset:o,size:i(a,t)})))):"gradient"===c?(n=f.domain(),r=As(f,n[0],H(n)),g.length<3&&!t.values&&n[0]!==H(n)&&(g=[n[0],H(n)]),u=g.map(((t,e)=>Qn({index:e,label:m(t,e,g),value:t,perc:r(t)})))):(i=g.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+H(e),o=i-r;if(t.type===Xa){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}(f),u=g.map(((t,e)=>Qn({index:e,label:m(t,e,g),value:t,perc:e?r(t):0,perc2:e===i?1:r(g[e+1])})))),l.source=u,l.add=u,this.value=u,l}});const Bh=t=>t.source.x,Lh=t=>t.source.y,jh=t=>t.target.x,Uh=t=>t.target.y;function qh(t){Cr.call(this,{},t)}qh.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},xt(qh,Cr,{transform(t,e){var n=t.sourceX||Bh,r=t.sourceY||Lh,i=t.targetX||jh,o=t.targetY||Uh,a=t.as||"path",s=t.orient||"vertical",l=t.shape||"line",u=Hh.get(l+"-"+s)||Hh.get(l);return u||w("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[a]=u(n(t),r(t),i(t),o(t))})),e.reflow(t.modified()).modifies(a)}});const Ih=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,Wh=(t,e,n,r)=>{var i=n-t,o=r-e,a=Math.hypot(i,o)/2;return"M"+t+","+e+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},$h=(t,e,n,r)=>{const i=n-t,o=r-e,a=.2*(i+o),s=.2*(o-i);return"M"+t+","+e+"C"+(t+a)+","+(e+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},Hh=bt({line:Ih,"line-radial":(t,e,n,r)=>Ih(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:Wh,"arc-radial":(t,e,n,r)=>Wh(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:$h,"curve-radial":(t,e,n,r)=>$h(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*a+","+e*s+"L"+r*a+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n),l=(e+r)/2;return"M"+e*i+","+e*o+"C"+l*i+","+l*o+" "+l*a+","+l*s+" "+r*a+","+r*s}});function Zh(t){Cr.call(this,null,t)}function Yh(t){return gs(t)&&t!==Za}Zh.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},xt(Zh,Cr,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],a=o[0],s=o[1],l=t.field||S,u=t.startAngle||0,c=null!=t.endAngle?t.endAngle:2*Math.PI,f=e.source,d=f.map(l),h=d.length,p=u,m=(c-u)/(0,Dh.Z)(d),g=(0,vi.Z)(h);for(t.sort&&g.sort(((t,e)=>d[t]-d[e])),n=0;n<h;++n)i=d[g[n]],(r=f[g[n]])[a]=p,r[s]=p+=i*m;return this.value=d,e.reflow(t.modified()).modifies(o)}});const Vh=zt(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Gh(t){Cr.call(this,null,t),this.modified(!0)}function Xh(t,e,n){return bs(t)&&Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0))!==e.length&&n.warn("Log scale domain includes zero: "+Dt(e)),e}function Qh(t,e,n){return ot(t)&&(e||n)?function(t,e){const n=e[0],r=H(e)-n;return function(e){return t(n+e*r)}}(t,Jh(e||[0,1],n)):t}function Jh(t,e){return e?t.slice().reverse():t}function Kh(t){Cr.call(this,null,t)}xt(Gh,Cr,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";return n===Za?Za+"-"+ja:(function(t){const e=t.type;return gs(e)&&e!==$a&&e!==Ha&&(t.scheme||t.range&&t.range.length&&t.range.every(Et))}(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?Za+"-":3===e?Ya+"-":""),(r+n||ja).toLowerCase())}(t);for(i in r&&i===r.type||(this.value=r=hs(i)()),t)if(!Vh[i]){if("padding"===i&&Yh(r.type))continue;ot(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){t!==Ka&&t!==Ja&&w("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===Ja?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*La(n,i,r)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i=e.schemeExtent;return L(e.scheme)?r=ks(e.scheme,e.interpolate,e.interpolateGamma):(r=Ds(e.scheme.toLowerCase()))||w("Unrecognized scheme name: ".concat(e.scheme)),n=t===Xa?n+1:t===ts?n-1:t===Va||t===Ga?+e.schemeCount||5:n,xs(t)?Qh(r,i,e.reverse):ot(r)?function(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}(Qh(r,i),n):t===Qa?r:r.slice(0,n)}(r,e,n),ot(o))){if(t.interpolator)return t.interpolator(o);w("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&xs(r))return t.interpolator(ks(Jh(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(Es(e.interpolate,e.interpolateGamma)):ot(t.round)?t.round(i):ot(t.rangeRound)&&t.interpolate(i?Fh.Z:Th.Z),o&&t.range(Jh(o,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!L(r)){const e=t.domain(),n=e[0],i=H(e),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||w("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=(0,vi.Z)(a,s+o/2,o)}return r?t.bins=r:t.bins&&delete t.bins,t.type===ts&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain()),n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(Xh(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,a=e.domain,s=t.type,l=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===ja||e===qa||e===Ia)}(t);if(!a)return 0;if(Yh(s)&&e.padding&&a[0]!==H(a)&&(a=function(t,e,n,r,i,o){var a=Math.abs(H(n)-n[0]),s=a/(a-2*r),l=t===Ua?et(e,null,s):t===Ia?nt(e,null,s,.5):t===qa?nt(e,null,s,i||1):t===Wa?rt(e,null,s,o||1):tt(e,null,s);return(e=e.slice())[0]=l[0],e[e.length-1]=l[1],e}(s,a,e.range,e.padding,e.exponent,e.constant)),(l||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(a=a.slice()).length-1||1,l&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=e.domainMin&&(a[0]=e.domainMin),null!=e.domainMax&&(a[i]=e.domainMax),null!=e.domainMid)){const t=(o=e.domainMid)>a[i]?i+1:o<a[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(t,0,o)}return t.domain(Xh(s,a,n)),s===Qa&&t.unknown(e.domainImplicit?za.O:void 0),e.nice&&t.nice&&t.nice(!0!==e.nice&&Rs(t,e.nice)||null),a.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),xt(Kh,Cr,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(er(t.sort)),this.modified(n),e}});const tp="zero",ep="center",np="normalize",rp=["y0","y1"];function ip(t){Cr.call(this,null,t)}function op(t,e,n,r,i){for(var o,a=(e-t.sum)/2,s=t.length,l=0;l<s;++l)(o=t[l])[r]=a,o[i]=a+=Math.abs(n(o))}function ap(t,e,n,r,i){for(var o,a=1/t.sum,s=0,l=t.length,u=0,c=0;u<l;++u)(o=t[u])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function sp(t,e,n,r,i){for(var o,a,s=0,l=0,u=t.length,c=0;c<u;++c)(o=+n(a=t[c]))<0?(a[r]=l,a[i]=l+=o):(a[r]=s,a[i]=s+=o)}ip.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:tp,values:[tp,ep,np]},{name:"as",type:"string",array:!0,length:2,default:rp}]},xt(ip,Cr,{transform(t,e){var n,r,i,o,a=t.as||rp,s=a[0],l=a[1],u=er(t.sort),c=t.field||S,f=t.offset===ep?op:t.offset===np?ap:sp;for(n=function(t,e,n,r){var i,o,a,s,l,u,c,f,d,h=[],p=t=>t(l);if(null==e)h.push(t.slice());else for(i={},o=0,a=t.length;o<a;++o)l=t[o],(c=i[u=e.map(p)])||(i[u]=c=[],h.push(c)),c.push(l);for(u=0,d=0,s=h.length;u<s;++u){for(o=0,f=0,a=(c=h[u]).length;o<a;++o)f+=Math.abs(r(c[o]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(e.source,t.groupby,u,c),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,c,s,l);return e.reflow(t.modified()).modifies(a)}});var lp=n(6049),up=n(3909),cp=n(858);function fp(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:cp.Z,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function dp(t,e){return(0,up.Wn)(t[0]-e[0])<up.Ho&&(0,up.Wn)(t[1]-e[1])<up.Ho}function hp(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function pp(t,e,n,r,i){var o,a,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(dp(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*up.Ho}s.push(n=new hp(r,t,null,!0)),l.push(n.o=new hp(r,null,n,!1)),s.push(n=new hp(a,t,null,!1)),l.push(n.o=new hp(a,null,n,!0))}})),s.length){for(l.sort(e),mp(s),mp(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function mp(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var gp=n(5852);function yp(t){return[(0,up.fv)(t[1],t[0]),(0,up.ZR)(t[2])]}function vp(t){var e=t[0],n=t[1],r=(0,up.mC)(n);return[r*(0,up.mC)(e),r*(0,up.O$)(e),(0,up.O$)(n)]}function bp(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function xp(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function _p(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function wp(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function kp(t){var e=(0,up._b)(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Ap(t){return(0,up.Wn)(t[0])<=up.pi?t[0]:(0,up.Xx)(t[0])*(((0,up.Wn)(t[0])+up.pi)%up.BZ-up.pi)}function Ep(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function Mp(t,e,n,r){return function(i){var o,a,s,l=e(i),u=fp(),c=e(u),f=!1,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,a=Ep(a);var t=function(t,e){var n=Ap(e),r=e[1],i=(0,up.O$)(r),o=[(0,up.O$)(n),-(0,up.mC)(n),0],a=0,s=0,l=new gp.dU;1===i?r=up.ou+up.Ho:-1===i&&(r=-up.ou-up.Ho);for(var u=0,c=t.length;u<c;++u)if(d=(f=t[u]).length)for(var f,d,h=f[d-1],p=Ap(h),m=h[1]/2+up.pu,g=(0,up.O$)(m),y=(0,up.mC)(m),v=0;v<d;++v,p=x,g=w,y=k,h=b){var b=f[v],x=Ap(b),_=b[1]/2+up.pu,w=(0,up.O$)(_),k=(0,up.mC)(_),A=x-p,E=A>=0?1:-1,M=E*A,C=M>up.pi,S=g*w;if(l.add((0,up.fv)(S*E*(0,up.O$)(M),y*k+S*(0,up.mC)(M))),a+=C?A+E*up.BZ:A,C^p>=n^x>=n){var D=xp(vp(h),vp(b));kp(D);var F=xp(o,D);kp(F);var T=(C^A>=0?-1:1)*(0,up.ZR)(F[2]);(r>T||r===T&&(D[0]||D[1]))&&(s+=C^A>=0?1:-1)}}return(a<-up.Ho||a<up.Ho&&l<-up.aW)^1&s}(o,r);a.length?(f||(i.polygonStart(),f=!0),pp(a,Sp,t,n,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(e,n){t(e,n)&&i.point(e,n)}function p(t,e){l.point(t,e)}function m(){d.point=p,l.lineStart()}function g(){d.point=h,l.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,n,r,l=c.clean(),d=u.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&l){if((e=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else h>1&&2&l&&d.push(d.pop().concat(d.shift())),a.push(d.filter(Cp))}return d}}function Cp(t){return t.length>1}function Sp(t,e){return((t=t.x)[0]<0?t[1]-up.ou-up.Ho:up.ou-t[1])-((e=e.x)[0]<0?e[1]-up.ou-up.Ho:up.ou-e[1])}const Dp=Mp((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?up.pi:-up.pi,l=(0,up.Wn)(o-n);(0,up.Wn)(l-up.pi)<up.Ho?(t.point(n,r=(r+a)/2>0?up.ou:-up.ou),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&l>=up.pi&&((0,up.Wn)(n-i)<up.Ho&&(n-=i*up.Ho),(0,up.Wn)(o-s)<up.Ho&&(o-=s*up.Ho),r=function(t,e,n,r){var i,o,a=(0,up.O$)(t-n);return(0,up.Wn)(a)>up.Ho?(0,up.z4)(((0,up.O$)(e)*(o=(0,up.mC)(r))*(0,up.O$)(n)-(0,up.O$)(r)*(i=(0,up.mC)(e))*(0,up.O$)(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*up.ou,r.point(-up.pi,i),r.point(0,i),r.point(up.pi,i),r.point(up.pi,0),r.point(up.pi,-i),r.point(0,-i),r.point(-up.pi,-i),r.point(-up.pi,0),r.point(-up.pi,i);else if((0,up.Wn)(t[0]-e[0])>up.Ho){var o=t[0]<e[0]?up.pi:-up.pi;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-up.pi,-up.ou]);function Fp(t,e){(e=vp(e))[0]-=t,kp(e);var n=(0,up.Kh)(-e[1]);return((-e[2]<0?-n:n)+up.BZ-up.Ho)%up.BZ}var Tp=1e9,Np=-Tp;function Op(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return(0,up.Wn)(r[0]-t)<up.Ho?i>0?0:3:(0,up.Wn)(r[0]-n)<up.Ho?i>0?2:1:(0,up.Wn)(r[1]-e)<up.Ho?i>0?1:0:i>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var l,u,c,f,d,h,p,m,g,y,v,b=a,x=fp(),_={point:w,lineStart:function(){_.point=k,u&&u.push(c=[]),y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(k(f,d),h&&g&&x.rejoin(),l.push(x.result())),_.point=w,g&&b.lineEnd()},polygonStart:function(){b=x,l=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],l=1,c=s.length,f=s[0],d=f[0],h=f[1];l<c;++l)o=d,a=h,d=(f=s[l])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(t-o)&&++e:h<=r&&(d-o)*(r-a)<(h-a)*(t-o)&&--e;return e}(),n=v&&e,i=(l=Ep(l)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&pp(l,s,e,o,a),a.polygonEnd()),b=a,l=u=c=null}};function w(t,e){i(t,e)&&b.point(t,e)}function k(o,a){var s=i(o,a);if(u&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var l=[p=Math.max(Np,Math.min(Tp,p)),m=Math.max(Np,Math.min(Tp,m))],x=[o=Math.max(Np,Math.min(Tp,o)),a=Math.max(Np,Math.min(Tp,a))];!function(t,e,n,r,i,o){var a,s=t[0],l=t[1],u=0,c=1,f=e[0]-s,d=e[1]-l;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(t[0]=s+u*f,t[1]=l+u*d),c<1&&(e[0]=s+c*f,e[1]=l+c*d),!0}}}}}(l,x,t,e,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(l[0],l[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return _}}function zp(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}var Rp=n(8246);function Pp(t,e){return(0,up.Wn)(t)>up.pi&&(t-=Math.round(t/up.BZ)*up.BZ),[t,e]}function Bp(t,e,n){return(t%=up.BZ)?e||n?zp(jp(t),Up(e,n)):jp(t):e||n?Up(e,n):Pp}function Lp(t){return function(e,n){return e+=t,(0,up.Wn)(e)>up.pi&&(e-=Math.round(e/up.BZ)*up.BZ),[e,n]}}function jp(t){var e=Lp(t);return e.invert=Lp(-t),e}function Up(t,e){var n=(0,up.mC)(t),r=(0,up.O$)(t),i=(0,up.mC)(e),o=(0,up.O$)(e);function a(t,e){var a=(0,up.mC)(e),s=(0,up.mC)(t)*a,l=(0,up.O$)(t)*a,u=(0,up.O$)(e),c=u*n+s*r;return[(0,up.fv)(l*i-c*o,s*n-u*r),(0,up.ZR)(c*i+l*o)]}return a.invert=function(t,e){var a=(0,up.mC)(e),s=(0,up.mC)(t)*a,l=(0,up.O$)(t)*a,u=(0,up.O$)(e),c=u*i-l*o;return[(0,up.fv)(l*i+u*o,s*n+c*r),(0,up.ZR)(c*n-s*r)]},a}function qp(t){return function(e){var n=new Ip;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Ip(){}Pp.invert=Pp,Ip.prototype={constructor:Ip,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Wp=n(2708),$p=n(8555);function Hp(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),(0,Wp.Z)(n,t.stream($p.Z)),e($p.Z.result()),null!=r&&t.clipExtent(r),t}function Zp(t,e,n){return Hp(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function Yp(t,e,n){return Zp(t,[[0,0],e],n)}function Vp(t,e,n){return Hp(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function Gp(t,e,n){return Hp(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}var Xp=16,Qp=(0,up.mC)(30*up.uR);function Jp(t,e){return+e?function(t,e){function n(r,i,o,a,s,l,u,c,f,d,h,p,m,g){var y=u-r,v=c-i,b=y*y+v*v;if(b>4*e&&m--){var x=a+d,_=s+h,w=l+p,k=(0,up._b)(x*x+_*_+w*w),A=(0,up.ZR)(w/=k),E=(0,up.Wn)((0,up.Wn)(w)-1)<up.Ho||(0,up.Wn)(o-f)<up.Ho?(o+f)/2:(0,up.fv)(_,x),M=t(E,A),C=M[0],S=M[1],D=C-r,F=S-i,T=v*D-y*F;(T*T/b>e||(0,up.Wn)((y*D+v*F)/b-.5)>.3||a*d+s*h+l*p<Qp)&&(n(r,i,o,a,s,l,C,S,E,x/=k,_/=k,w,m,g),g.point(C,S),n(C,S,E,x,_,w,u,c,f,d,h,p,m,g))}}return function(e){var r,i,o,a,s,l,u,c,f,d,h,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,m.point=v,e.lineStart()}function v(r,i){var o=vp([r,i]),a=t(r,i);n(c,f,u,d,h,p,c=a[0],f=a[1],u=r,d=o[0],h=o[1],p=o[2],Xp,e),e.point(c,f)}function b(){m.point=g,e.lineEnd()}function x(){y(),m.point=_,m.lineEnd=w}function _(t,e){v(r=t,e),i=c,o=f,a=d,s=h,l=p,m.point=v}function w(){n(c,f,u,d,h,p,i,o,r,a,s,l,Xp,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return qp({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var Kp=qp({point:function(t,e){this.stream.point(t*up.uR,e*up.uR)}});function tm(t,e,n,r,i,o){if(!o)return function(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}(t,e,n,r,i);var a=(0,up.mC)(o),s=(0,up.O$)(o),l=a*t,u=s*t,c=a/t,f=s/t,d=(s*n-a*e)/t,h=(s*e+a*n)/t;function p(t,o){return[l*(t*=r)-u*(o*=i)+e,n-u*t-l*o]}return p.invert=function(t,e){return[r*(c*t-f*e+d),i*(h-f*t-c*e)]},p}function em(t){return nm((function(){return t}))()}function nm(t){var e,n,r,i,o,a,s,l,u,c,f=150,d=480,h=250,p=0,m=0,g=0,y=0,v=0,b=0,x=1,_=1,w=null,k=Dp,A=null,E=Rp.Z,M=.5;function C(t){return l(t[0]*up.uR,t[1]*up.uR)}function S(t){return(t=l.invert(t[0],t[1]))&&[t[0]*up.RW,t[1]*up.RW]}function D(){var t=tm(f,0,0,x,_,b).apply(null,e(p,m)),r=tm(f,d-t[0],h-t[1],x,_,b);return n=Bp(g,y,v),s=zp(e,r),l=zp(n,s),a=Jp(s,M),F()}function F(){return u=c=null,C}return C.stream=function(t){return u&&c===t?u:u=Kp(function(t){return qp({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(E(c=t)))))},C.preclip=function(t){return arguments.length?(k=t,w=void 0,F()):k},C.postclip=function(t){return arguments.length?(E=t,A=r=i=o=null,F()):E},C.clipAngle=function(t){return arguments.length?(k=+t?function(t){var e=(0,up.mC)(t),n=6*up.uR,r=e>0,i=(0,up.Wn)(e)>up.Ho;function o(t,n){return(0,up.mC)(t)*(0,up.mC)(n)>e}function a(t,n,r){var i=[1,0,0],o=xp(vp(t),vp(n)),a=bp(o,o),s=o[0],l=a-s*s;if(!l)return!r&&t;var u=e*a/l,c=-e*s/l,f=xp(i,o),d=wp(i,u);_p(d,wp(o,c));var h=f,p=bp(d,h),m=bp(h,h),g=p*p-m*(bp(d,d)-1);if(!(g<0)){var y=(0,up._b)(g),v=wp(h,(-p-y)/m);if(_p(v,d),v=yp(v),!r)return v;var b,x=t[0],_=n[0],w=t[1],k=n[1];_<x&&(b=x,x=_,_=b);var A=_-x,E=(0,up.Wn)(A-up.pi)<up.Ho;if(!E&&k<w&&(b=w,w=k,k=b),E||A<up.Ho?E?w+k>0^v[1]<((0,up.Wn)(v[0]-x)<up.Ho?w:k):w<=v[1]&&v[1]<=k:A>up.pi^(x<=v[0]&&v[0]<=_)){var M=wp(h,(-p+y)/m);return _p(M,d),[v,yp(M)]}}}function s(e,n){var i=r?t:up.pi-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return Mp(o,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,d){var h,p=[f,d],m=o(f,d),g=r?m?0:s(f,d):m?s(f+(f<0?up.pi:-up.pi),d):0;if(!e&&(u=l=m)&&t.lineStart(),m!==l&&(!(h=a(e,p))||dp(e,h)||dp(p,h))&&(p[2]=1),m!==l)c=0,m?(t.lineStart(),h=a(p,e),t.point(h[0],h[1])):(h=a(e,p),t.point(h[0],h[1],2),t.lineEnd()),e=h;else if(i&&e&&r^m){var y;g&n||!(y=a(p,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!m||e&&dp(e,p)||t.point(p[0],p[1]),e=p,l=m,n=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,r,i,o){!function(t,e,n,r,i,o){if(n){var a=(0,up.mC)(e),s=(0,up.O$)(e),l=r*n;null==i?(i=e+r*up.BZ,o=e-l/2):(i=Fp(a,i),o=Fp(a,o),(r>0?i<o:i>o)&&(i+=r*up.BZ));for(var u,c=i;r>0?c>o:c<o;c-=l)u=yp([a,-s*(0,up.mC)(c),-s*(0,up.O$)(c)]),t.point(u[0],u[1])}}(o,t,n,i,e,r)}),r?[0,-t]:[-up.pi,t-up.pi])}(w=t*up.uR):(w=null,Dp),F()):w*up.RW},C.clipExtent=function(t){return arguments.length?(E=null==t?(A=r=i=o=null,Rp.Z):Op(A=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),F()):null==A?null:[[A,r],[i,o]]},C.scale=function(t){return arguments.length?(f=+t,D()):f},C.translate=function(t){return arguments.length?(d=+t[0],h=+t[1],D()):[d,h]},C.center=function(t){return arguments.length?(p=t[0]%360*up.uR,m=t[1]%360*up.uR,D()):[p*up.RW,m*up.RW]},C.rotate=function(t){return arguments.length?(g=t[0]%360*up.uR,y=t[1]%360*up.uR,v=t.length>2?t[2]%360*up.uR:0,D()):[g*up.RW,y*up.RW,v*up.RW]},C.angle=function(t){return arguments.length?(b=t%360*up.uR,D()):b*up.RW},C.reflectX=function(t){return arguments.length?(x=t?-1:1,D()):x<0},C.reflectY=function(t){return arguments.length?(_=t?-1:1,D()):_<0},C.precision=function(t){return arguments.length?(a=Jp(s,M=t*t),F()):(0,up._b)(M)},C.fitExtent=function(t,e){return Zp(C,t,e)},C.fitSize=function(t,e){return Yp(C,t,e)},C.fitWidth=function(t,e){return Vp(C,t,e)},C.fitHeight=function(t,e){return Gp(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&S,D()}}function rm(t){var e=0,n=up.pi/3,r=nm(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*up.uR,n=t[1]*up.uR):[e*up.RW,n*up.RW]},i}function im(t,e){var n=(0,up.O$)(t),r=(n+(0,up.O$)(e))/2;if((0,up.Wn)(r)<up.Ho)return function(t){var e=(0,up.mC)(t);function n(t,n){return[t*e,(0,up.O$)(n)/e]}return n.invert=function(t,n){return[t/e,(0,up.ZR)(n*e)]},n}(t);var i=1+n*(2*r-n),o=(0,up._b)(i)/r;function a(t,e){var n=(0,up._b)(i-2*r*(0,up.O$)(e))/r;return[n*(0,up.O$)(t*=r),o-n*(0,up.mC)(t)]}return a.invert=function(t,e){var n=o-e,a=(0,up.fv)(t,(0,up.Wn)(n))*(0,up.Xx)(n);return n*r<0&&(a-=up.pi*(0,up.Xx)(t)*(0,up.Xx)(n)),[a/r,(0,up.ZR)((i-(t*t+n*n)*r*r)/(2*r))]},a}function om(){return rm(im).scale(155.424).center([0,33.6442])}function am(){return om().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function sm(t){return function(e,n){var r=(0,up.mC)(e),i=(0,up.mC)(n),o=t(r*i);return o===1/0?[2,0]:[o*i*(0,up.O$)(e),o*(0,up.O$)(n)]}}function lm(t){return function(e,n){var r=(0,up._b)(e*e+n*n),i=t(r),o=(0,up.O$)(i),a=(0,up.mC)(i);return[(0,up.fv)(e*o,r*a),(0,up.ZR)(r&&n*o/r)]}}var um=sm((function(t){return(0,up._b)(2/(1+t))}));um.invert=lm((function(t){return 2*(0,up.ZR)(t/2)}));var cm=sm((function(t){return(t=(0,up.Kh)(t))&&t/(0,up.O$)(t)}));function fm(t,e){return[t,(0,up.cM)((0,up.OR)((up.ou+e)/2))]}function dm(t){var e,n,r,i=em(t),o=i.center,a=i.scale,s=i.translate,l=i.clipExtent,u=null;function c(){var o=up.pi*a(),s=i(function(t){function e(e){return(e=t(e[0]*up.uR,e[1]*up.uR))[0]*=up.RW,e[1]*=up.RW,e}return t=Bp(t[0]*up.uR,t[1]*up.uR,t.length>2?t[2]*up.uR:0),e.invert=function(e){return(e=t.invert(e[0]*up.uR,e[1]*up.uR))[0]*=up.RW,e[1]*=up.RW,e},e}(i.rotate()).invert([0,0]));return l(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===fm?[[Math.max(s[0]-o,u),e],[Math.min(s[0]+o,n),r]]:[[u,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),c()):a()},i.translate=function(t){return arguments.length?(s(t),c()):s()},i.center=function(t){return arguments.length?(o(t),c()):o()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),c()):null==u?null:[[u,e],[n,r]]},c()}function hm(t){return(0,up.OR)((up.ou+t)/2)}function pm(t,e){var n=(0,up.mC)(t),r=t===e?(0,up.O$)(t):(0,up.cM)(n/(0,up.mC)(e))/(0,up.cM)(hm(e)/hm(t)),i=n*(0,up.sQ)(hm(t),r)/r;if(!r)return fm;function o(t,e){i>0?e<-up.ou+up.Ho&&(e=-up.ou+up.Ho):e>up.ou-up.Ho&&(e=up.ou-up.Ho);var n=i/(0,up.sQ)(hm(e),r);return[n*(0,up.O$)(r*t),i-n*(0,up.mC)(r*t)]}return o.invert=function(t,e){var n=i-e,o=(0,up.Xx)(r)*(0,up._b)(t*t+n*n),a=(0,up.fv)(t,(0,up.Wn)(n))*(0,up.Xx)(n);return n*r<0&&(a-=up.pi*(0,up.Xx)(t)*(0,up.Xx)(n)),[a/r,2*(0,up.z4)((0,up.sQ)(i/o,1/r))-up.ou]},o}function mm(t,e){return[t,e]}function gm(t,e){var n=(0,up.mC)(t),r=t===e?(0,up.O$)(t):(n-(0,up.mC)(e))/(e-t),i=n/r+t;if((0,up.Wn)(r)<up.Ho)return mm;function o(t,e){var n=i-e,o=r*t;return[n*(0,up.O$)(o),i-n*(0,up.mC)(o)]}return o.invert=function(t,e){var n=i-e,o=(0,up.fv)(t,(0,up.Wn)(n))*(0,up.Xx)(n);return n*r<0&&(o-=up.pi*(0,up.Xx)(t)*(0,up.Xx)(n)),[o/r,i-(0,up.Xx)(r)*(0,up._b)(t*t+n*n)]},o}cm.invert=lm((function(t){return t})),fm.invert=function(t,e){return[t,2*(0,up.z4)((0,up.Qq)(e))-up.ou]},mm.invert=mm;var ym=1.340264,vm=-.081106,bm=893e-6,xm=.003796,_m=(0,up._b)(3)/2;function wm(t,e){var n=(0,up.ZR)(_m*(0,up.O$)(e)),r=n*n,i=r*r*r;return[t*(0,up.mC)(n)/(_m*(ym+3*vm*r+i*(7*bm+9*xm*r))),n*(ym+vm*r+i*(bm+xm*r))]}function km(t,e){var n=(0,up.mC)(e),r=(0,up.mC)(t)*n;return[n*(0,up.O$)(t)/r,(0,up.O$)(e)/r]}function Am(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Em(t,e){return[(0,up.mC)(e)*(0,up.O$)(t),(0,up.O$)(e)]}function Mm(t,e){var n=(0,up.mC)(e),r=1+(0,up.mC)(t)*n;return[n*(0,up.O$)(t)/r,(0,up.O$)(e)/r]}function Cm(t,e){return[(0,up.cM)((0,up.OR)((up.ou+e)/2)),-t]}wm.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(ym+vm*i+o*(bm+xm*i))-e)/(ym+3*vm*i+o*(7*bm+9*xm*i)))*r)*i*i,!((0,up.Wn)(n)<up.aW));++a);return[_m*t*(ym+3*vm*i+o*(7*bm+9*xm*i))/(0,up.mC)(r),(0,up.ZR)((0,up.O$)(r)/_m)]},km.invert=lm(up.z4),Am.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while((0,up.Wn)(n)>up.Ho&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},Em.invert=lm(up.ZR),Mm.invert=lm((function(t){return 2*(0,up.z4)(t)})),Cm.invert=function(t,e){return[-e,2*(0,up.z4)((0,up.Qq)(t))-up.ou]};var Sm=Math.abs,Dm=(Math.atan,Math.atan2,Math.ceil,Math.cos),Fm=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),Tm=(Math.tan,1e-6),Nm=Math.PI,Om=Nm/2,zm=(Math.SQRT1_2,Pm(2));function Rm(t){return t>1?Om:t<-1?-Om:Math.asin(t)}function Pm(t){return t>0?Math.sqrt(t):0}function Bm(t,e){var n,r=t*Fm(e),i=30;do{e-=n=(e+Fm(e)-r)/(1+Dm(e))}while(Sm(n)>Tm&&--i>0);return e/2}Pm(Nm);var Lm=function(t,e,n){function r(r,i){return[t*r*Dm(i=Bm(n,i)),e*Fm(i)]}return r.invert=function(r,i){return i=Rm(i/e),[r/(t*Dm(i)),Rm((2*i+Fm(2*i))/n)]},r}(zm/Om,zm,Nm);const jm=(0,lp.Z)(),Um=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function qm(t,e){if(!t||"string"!=typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(Wm[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=(0,lp.Z)().projection(r),r.copy=r.copy||function(){const t=n();return Um.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},ds(r)}}(t,e),this):Wm[t]||null}function Im(t){return t&&t.path||jm}const Wm={albers:am,albersusa:function(){var t,e,n,r,i,o,a=am(),s=om().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=om().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){o=[t,e]}};function c(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function f(){return t=e=null,c}return c.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:a).invert(t)},c.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),s.stream(n),l.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},c.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),l.precision(t),f()):a.precision()},c.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),l.scale(t),c.translate(a.translate())):a.scale()},c.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],c=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,c-.238*e],[o+.455*e,c+.238*e]]).stream(u),r=s.translate([o-.307*e,c+.201*e]).clipExtent([[o-.425*e+up.Ho,c+.12*e+up.Ho],[o-.214*e-up.Ho,c+.234*e-up.Ho]]).stream(u),i=l.translate([o-.205*e,c+.212*e]).clipExtent([[o-.214*e+up.Ho,c+.166*e+up.Ho],[o-.115*e-up.Ho,c+.234*e-up.Ho]]).stream(u),f()},c.fitExtent=function(t,e){return Zp(c,t,e)},c.fitSize=function(t,e){return Yp(c,t,e)},c.fitWidth=function(t,e){return Vp(c,t,e)},c.fitHeight=function(t,e){return Gp(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return em(um).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return em(cm).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return rm(pm).scale(109.5).parallels([30,30])},conicequalarea:om,conicequidistant:function(){return rm(gm).scale(131.154).center([0,13.9389])},equalEarth:function(){return em(wm).scale(177.158)},equirectangular:function(){return em(mm).scale(152.63)},gnomonic:function(){return em(km).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,o,a,s=1,l=0,u=0,c=1,f=1,d=0,h=null,p=1,m=1,g=qp({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=Rp.Z;function v(){return p=s*c,m=s*f,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+l,i+u]}return b.invert=function(n){var r=n[0]-l,i=n[1]-u;if(d){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/m]},b.stream=function(t){return o&&a===t?o:o=g(y(a=t))},b.postclip=function(t){return arguments.length?(y=t,h=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(h=n=r=i=null,Rp.Z):Op(h=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==h?null:[[h,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],v()):[l,u]},b.angle=function(n){return arguments.length?(d=n%360*up.uR,e=(0,up.O$)(d),t=(0,up.mC)(d),v()):d*up.RW},b.reflectX=function(t){return arguments.length?(c=t?-1:1,v()):c<0},b.reflectY=function(t){return arguments.length?(f=t?-1:1,v()):f<0},b.fitExtent=function(t,e){return Zp(b,t,e)},b.fitSize=function(t,e){return Yp(b,t,e)},b.fitWidth=function(t,e){return Vp(b,t,e)},b.fitHeight=function(t,e){return Gp(b,t,e)},b},mercator:function(){return dm(fm).scale(961/up.BZ)},mollweide:function(){return em(Lm).scale(169.529)},naturalEarth1:function(){return em(Am).scale(175.295)},orthographic:function(){return em(Em).scale(249.5).clipAngle(90+up.Ho)},stereographic:function(){return em(Mm).scale(250).clipAngle(142)},transversemercator:function(){var t=dm(Cm),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const n in Wm)qm(n,Wm[n]);function $m(t,e,n){var r=(0,vi.Z)(t,e-up.Ho,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Hm(t,e,n){var r=(0,vi.Z)(t,e-up.Ho,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}var Zm=n(5141);function Ym(){}const Vm=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Gm(){var t=1,e=1,n=a;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,l,u,c,f,d=new Array,h=new Array;for(a=s=-1,u=n[0]>=r,Vm[u<<1].forEach(p);++a<t-1;)l=u,u=n[a+1]>=r,Vm[l|u<<1].forEach(p);for(Vm[u<<0].forEach(p);++s<e-1;){for(a=-1,u=n[s*t+t]>=r,c=n[s*t]>=r,Vm[u<<1|c<<2].forEach(p);++a<t-1;)l=u,u=n[s*t+t+a+1]>=r,f=c,c=n[s*t+a+1]>=r,Vm[l|u<<1|c<<2|f<<3].forEach(p);Vm[u|c<<3].forEach(p)}for(a=-1,c=n[s*t]>=r,Vm[c<<2].forEach(p);++a<t-1;)f=c,c=n[s*t+a+1]>=r,Vm[c<<2|f<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+a,t[0][1]+s],l=[t[1][0]+a,t[1][1]+s],u=o(r),c=o(l);(e=h[u])?(n=d[c])?(delete h[e.end],delete d[n.start],e===n?(e.ring.push(l),i(e.ring)):d[e.start]=h[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[e.end],e.ring.push(l),h[e.end=c]=e):(e=d[c])?(n=h[u])?(delete d[e.start],delete h[n.end],e===n?(e.ring.push(l),i(e.ring)):d[n.start]=h[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=u]=e):d[u]=h[c]={start:u,end:c,ring:[r,l]}}Vm[c<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):s.push(t)})),s.forEach((t=>{for(var e,n=0,r=a.length;n<r;++n)if(-1!==Xm((e=a[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],l=0|a,u=0|s,c=r[u*t+l];a>0&&a<t&&l===a&&(o=r[u*t+l-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<e&&u===s&&(o=r[(u-1)*t+l],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||w("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?a:Ym,r):n===a},r}function Xm(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=Qm(t,e[r]))return n;return 0}function Qm(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var l=t[o],u=l[0],c=l[1],f=t[s],d=f[0],h=f[1];if(Jm(l,f,e))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function Jm(t,e,n){var r,i,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],a=e[r],i<=o&&o<=a||a<=o&&o<=i)}function Km(t,e,n){return function(r){var i=mt(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,l=e?(0,Qt.ly)(o,a,t):s/(t+1);return(0,vi.Z)(o+l,a,l)}}function tg(t){Cr.call(this,null,t)}function eg(t,e,n,r,i){const o=t.x1||0,a=t.y1||0,s=e*n<0;function l(t){t.forEach(u)}function u(t){s&&t.reverse(),t.forEach(c)}function c(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-a)*n+i}return function(t){return t.coordinates.forEach(l),t}}function ng(t,e,n){const r=t>=0?t:Pr(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function rg(t){return ot(t)?t:dt(+t)}function ig(){var t=t=>t[0],e=t=>t[1],n=S,r=[-1,-1],i=960,o=500,a=2;function s(s,l){const u=ng(r[0],s,t)>>a,c=ng(r[1],s,e)>>a,f=u?u+2:0,d=c?c+2:0,h=2*f+(i>>a),p=2*d+(o>>a),m=new Float32Array(h*p),g=new Float32Array(h*p);let y=m;s.forEach((r=>{const i=f+(+t(r)>>a),o=d+(+e(r)>>a);i>=0&&i<h&&o>=0&&o<p&&(m[i+o*h]+=+n(r))})),u>0&&c>0?(og(h,p,m,g,u),ag(h,p,g,m,c),og(h,p,m,g,u),ag(h,p,g,m,c),og(h,p,m,g,u),ag(h,p,g,m,c)):u>0?(og(h,p,m,g,u),og(h,p,g,m,u),og(h,p,m,g,u),y=g):c>0&&(ag(h,p,m,g,c),ag(h,p,g,m,c),ag(h,p,m,g,c),y=g);const v=l?Math.pow(2,-2*a):1/(0,Dh.Z)(y);for(let t=0,e=h*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(i>>a),y2:d+(o>>a)}}return s.x=function(e){return arguments.length?(t=rg(e),s):t},s.y=function(t){return arguments.length?(e=rg(t),s):e},s.weight=function(t){return arguments.length?(n=rg(t),s):n},s.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||w("invalid size"),i=e,o=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||w("invalid cell size"),a=Math.floor(Math.log(t)/Math.LN2),s):1<<a},s.bandwidth=function(t){return arguments.length?(1===(t=it(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&w("invalid bandwidth"),r=t,s):r},s}function og(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+a*t]),e>=i&&(e>=o&&(s-=n[e-o+a*t]),r[e-i+a*t]=s/Math.min(e+1,t-1+o-e,o))}function ag(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let s=0,l=0;s<e+i;++s)s<e&&(l+=n[a+s*t]),s>=i&&(s>=o&&(l-=n[a+(s-o)*t]),r[a+(s-i)*t]=l/Math.min(s+1,e-1+o-s,o))}function sg(t){Cr.call(this,null,t)}tg.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},xt(tg,Cr,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||M,o=Gm().smooth(!1!==t.smooth),a=t.thresholds||function(t,e,n){const r=Km(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>(0,yi.Z)(e(t).values))))}(r,i,t),s=null===t.as?null:t.as||"contour",l=[];return r.forEach((e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,L(a)?a:a(n.values));!function(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;if(ot(i)&&(i=i(n,r)),ot(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const a=(At(i)?i:i[0])||1,s=(At(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;t.forEach(eg(e,a,s,l,u))}(r,n,e,t),r.forEach((t=>{l.push(Kn(e,Qn(null!=s?{[s]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),sg.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const lg=["x","y","weight","size","cellSize","bandwidth"];function ug(t,e){return lg.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function cg(t){Cr.call(this,null,t)}xt(sg,Cr,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,o,a,s,l=[],u=t=>t(o);if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}(e.materialize(e.SOURCE).source,t.groupby),o=(t.groupby||[]).map(y),a=ug(ig(),t),s=t.as||"grid";return n=i.map((e=>Qn(function(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}({[s]:a(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),cg.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},xt(cg,Cr,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=Gm().smooth(!1!==t.smooth),a=t.values,s=t.thresholds||Km(t.count||10,t.nice,!!a),l=t.size;return a||(a=e.materialize(e.SOURCE).source,r=eg(n=ug(ig(),t)(a,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],a=n.values),s=L(s)?s:s(a),a=o.size(l)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(Qn),i}});const fg="Feature",dg="FeatureCollection";function hg(t){Cr.call(this,null,t)}function pg(t){Cr.call(this,null,t)}function mg(t){Cr.call(this,null,t)}function gg(t){Cr.call(this,null,t)}function yg(t){Cr.call(this,[],t),this.generator=function(){var t,e,n,r,i,o,a,s,l,u,c,f,d=10,h=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return(0,vi.Z)((0,up.mD)(r/p)*p,n,p).map(c).concat((0,vi.Z)((0,up.mD)(s/m)*m,a,m).map(f)).concat((0,vi.Z)((0,up.mD)(e/d)*d,t,d).filter((function(t){return(0,up.Wn)(t%p)>up.Ho})).map(l)).concat((0,vi.Z)((0,up.mD)(o/h)*h,i,h).filter((function(t){return(0,up.Wn)(t%m)>up.Ho})).map(u))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],y):[p,m]},y.stepMinor=function(t){return arguments.length?(d=+t[0],h=+t[1],y):[d,h]},y.precision=function(d){return arguments.length?(g=+d,l=$m(o,i,90),u=Hm(e,t,g),c=$m(s,a,90),f=Hm(r,n,g),y):g},y.extentMajor([[-180,-90+up.Ho],[180,90-up.Ho]]).extentMinor([[-180,-80-up.Ho],[180,80+up.Ho]])}()}function vg(t){Cr.call(this,null,t)}function bg(t){if(!ot(t))return!1;const e=zt(v(t));return e.$x||e.$y||e.$value||e.$max}function xg(t){Cr.call(this,null,t),this.modified(!0)}function _g(t,e,n){ot(t[e])&&t[e](n)}function wg(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,l,u,c,f,d,h=t._root,p={data:r},m=t._x0,g=t._y0,y=t._x1,v=t._y1;if(!h)return t._root=p,t;for(;h.length;)if((u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=h,!(h=h[f=c<<1|u]))return i[f]=p,t;if(s=+t._x.call(null,h.data),l=+t._y.call(null,h.data),e===s&&n===l)return p.next=h,i?i[f]=p:t._root=p,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|u)==(d=(l>=a)<<1|s>=o));return i[d]=h,i[f]=p,t}function kg(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Ag(t){return t[0]}function Eg(t){return t[1]}function Mg(t,e,n){var r=new Cg(null==e?Ag:e,null==n?Eg:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Cg(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Sg(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}hg.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},xt(hg,Cr,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,a=o&&o[0],s=o&&o[1],l=t.geojson||!o&&M,u=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(v(l))||a&&e.modified(v(a))||s&&e.modified(v(s)),this.value&&!n||(u=e.SOURCE,this._features=r=[],this._points=i=[]),l&&e.visit(u,(t=>r.push(l(t)))),a&&s&&(e.visit(u,(t=>{var e=a(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:fg,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:dg,features:r}}}),pg.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},xt(pg,Cr,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||M,o=t.as||"path",a=n.SOURCE;!r||t.modified()?(this.value=r=Im(t.projection),n.materialize().reflow()):a=i===M||e.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(t,e){const n=t.pointRadius();return t.context(null),null!=e&&t.pointRadius(e),n}(r,t.pointRadius);return n.visit(a,(t=>t[o]=r(i(t)))),r.pointRadius(s),n.modifies(o)}}),mg.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},xt(mg,Cr,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],a=t.as||["x","y"],s=a[0],l=a[1];function u(t){const e=r([i(t),o(t)]);e?(t[s]=e[0],t[l]=e[1]):(t[s]=void 0,t[l]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,u):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,u)),e.modifies(a)}}),gg.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},xt(gg,Cr,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>(t.context(e),r),r}(Im(t.projection),t.field||A("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(t=>t[i]=r)),n.modifies(i)}}),yg.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},xt(yg,Cr,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const o in t)ot(i[o])&&i[o](t[o]);return n=i(),r.length?e.mod.push(tr(r[0],n)):e.add.push(Qn(n)),r[0]=n,e}}),vg.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},xt(vg,Cr,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||M,o=function(t,e){let n;return ot(t)?(n=n=>t(n,e),n.dep=bg(t)):t?n=dt(t):(n=t=>t.$value/t.$max||0,n.dep=!0),n}(t.opacity,t),a=function(t,e){let n;return ot(t)?(n=n=>(0,Zm.B8)(t(n,e)),n.dep=bg(t)):n=dt((0,Zm.B8)(t||"#888")),n}(t.color,t),s=t.as||"image",l={$x:0,$y:0,$value:0,$max:r?(0,yi.Z)(n.map((t=>(0,yi.Z)(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=pt({},t,l);r||(n.$max=(0,yi.Z)(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,o=t.height,a=t.x1||0,s=t.y1||0,l=t.x2||i,u=t.y2||o,c=t.values,f=c?t=>c[t]:C,d=xa(l-a,u-s),h=d.getContext("2d"),p=h.getImageData(0,0,l-a,u-s),m=p.data;for(let g=s,y=0;g<u;++g){e.$y=g-s;for(let t=a,o=g*i;t<l;++t,y+=4){e.$x=t-a,e.$value=f(t+o);const i=n(e);m[y+0]=i.r,m[y+1]=i.g,m[y+2]=i.b,m[y+3]=~~(255*r(e))}}return h.putImageData(p,0,0),d}(e,n,a.dep?a:dt(a(n)),o.dep?o:dt(o(n)))})),e.reflow(!0).modifies(s)}}),xt(xg,Cr,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=qm((t||"mercator").toLowerCase());return e||w("Unrecognized projection type: "+t),e()}(t.type),Um.forEach((e=>{null!=t[e]&&_g(n,e,t[e])}))):Um.forEach((e=>{t.modified(e)&&_g(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return 1===(t=it(t)).length?t[0]:{type:dg,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===dg?t.features:it(t).filter((t=>null!=t)).map((t=>t.type===fg?t:{type:fg,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var Dg=Mg.prototype=Cg.prototype;function Fg(t){return function(){return t}}function Tg(t){return 1e-6*(t()-.5)}function Ng(t){return t.x+t.vx}function Og(t){return t.y+t.vy}Dg.copy=function(){var t,e,n=new Cg(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Sg(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Sg(e));return n},Dg.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return wg(this.cover(e,n),e,n,t)},Dg.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>f&&(f=i));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<o;++n)wg(this,a[n],s[n],t[n]);return this},Dg.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,l=i-n||1,u=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Dg.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Dg.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Dg.find=function(t,e,n){var r,i,o,a,s,l,u,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new kg(m,c,f,d,h)),null==n?n=1/0:(c=t-n,f=e-n,d=t+n,h=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(o=l.y0)>h||(a=l.x1)<c||(s=l.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new kg(m[3],g,y,a,s),new kg(m[2],i,y,g,s),new kg(m[1],g,o,a,y),new kg(m[0],i,o,g,y)),(u=(e>=y)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var v=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=v*v+b*b;if(x<n){var _=Math.sqrt(n=x);c=t-_,f=e-_,d=t+_,h=e+_,r=m.data}}return r},Dg.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,l,u,c,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((u=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(l=(m+y)/2))?m=l:y=l,e=h,!(h=h[f=c<<1|u]))return this;if(!h.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,d=f)}for(;h.data!==t;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(h=e[0]||e[1]||e[2]||e[3])&&h===(e[3]||e[2]||e[1]||e[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},Dg.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Dg.root=function(){return this._root},Dg.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Dg.visit=function(t){var e,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new kg(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&l.length){var u=(r+o)/2,c=(i+a)/2;(n=l[3])&&s.push(new kg(n,u,c,o,a)),(n=l[2])&&s.push(new kg(n,r,c,u,a)),(n=l[1])&&s.push(new kg(n,u,i,o,c)),(n=l[0])&&s.push(new kg(n,r,i,u,c))}return this},Dg.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new kg(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(a+l)/2,f=(s+u)/2;(o=i[0])&&n.push(new kg(o,a,s,c,f)),(o=i[1])&&n.push(new kg(o,c,s,l,f)),(o=i[2])&&n.push(new kg(o,a,f,c,u)),(o=i[3])&&n.push(new kg(o,c,f,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Dg.x=function(t){return arguments.length?(this._x=t,this):this._x},Dg.y=function(t){return arguments.length?(this._y=t,this):this._y};var zg=n(3844),Rg=n(3452);const Pg=4294967296;function Bg(t){return t.x}function Lg(t){return t.y}var jg=Math.PI*(3-Math.sqrt(5));function Ug(t){return t.index}function qg(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const Ig={center:function(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,l=0;for(i=0;i<a;++i)s+=(o=n[i]).x,l+=o.y;for(s=(s/a-t)*r,l=(l/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=l}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,o=1;function a(){for(var t,a,l,u,c,f,d,h=e.length,p=0;p<o;++p)for(a=Mg(e,Ng,Og).visitAfter(s),t=0;t<h;++t)l=e[t],f=n[l.index],d=f*f,u=l.x+l.vx,c=l.y+l.vy,a.visit(m);function m(t,e,n,o,a){var s=t.data,h=t.r,p=f+h;if(!s)return e>u+p||o<u-p||n>c+p||a<c-p;if(s.index>l.index){var m=u-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=Tg(r))*m),0===g&&(y+=(g=Tg(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,l.vx+=(m*=y)*(p=(h*=h)/(d+h)),l.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=Fg(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,l()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:Fg(+e),l(),a):t},a},nbody:function(){var t,e,n,r,i,o=Fg(-30),a=1,s=1/0,l=.81;function u(n){var i,o=t.length,a=Mg(t,Bg,Lg).visitAfter(f);for(r=n,i=0;i<o;++i)e=t[i],a.visit(d)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function f(t){var e,n,r,o,a,s=0,l=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,l+=n,r+=n*e.x,o+=n*e.y);t.x=r/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,o,u,c){if(!t.value)return!0;var f=t.x-e.x,d=t.y-e.y,h=c-o,p=f*f+d*d;if(h*h/l<p)return p<s&&(0===f&&(p+=(f=Tg(n))*f),0===d&&(p+=(d=Tg(n))*d),p<a&&(p=Math.sqrt(a*p)),e.vx+=f*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===f&&(p+=(f=Tg(n))*f),0===d&&(p+=(d=Tg(n))*d),p<a&&(p=Math.sqrt(a*p)));do{t.data!==e&&(h=i[t.data.index]*r/p,e.vx+=f*h,e.vy+=d*h)}while(t=t.next)}}return u.initialize=function(e,r){t=e,n=r,c()},u.strength=function(t){return arguments.length?(o="function"==typeof t?t:Fg(+t),c(),u):o},u.distanceMin=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u},link:function(t){var e,n,r,i,o,a,s=Ug,l=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=Fg(30),c=1;function f(r){for(var i=0,s=t.length;i<c;++i)for(var l,u,f,d,h,p,m,g=0;g<s;++g)u=(l=t[g]).source,d=(f=l.target).x+f.vx-u.x-u.vx||Tg(a),h=f.y+f.vy-u.y-u.vy||Tg(a),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*e[g],h*=p,f.vx-=d*(m=o[g]),f.vy-=h*m,u.vx+=d*(m=1-m),u.vy+=h*m}function d(){if(r){var a,l,u=r.length,c=t.length,f=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(a=0,i=new Array(u);a<c;++a)(l=t[a]).index=a,"object"!=typeof l.source&&(l.source=qg(f,l.source)),"object"!=typeof l.target&&(l.target=qg(f,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)l=t[a],o[a]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);e=new Array(c),h(),n=new Array(c),p()}}function h(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+l(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,a=e,d()},f.links=function(e){return arguments.length?(t=e,d(),f):t},f.id=function(t){return arguments.length?(s=t,f):s},f.iterations=function(t){return arguments.length?(c=+t,f):c},f.strength=function(t){return arguments.length?(l="function"==typeof t?t:Fg(+t),h(),f):l},f.distance=function(t){return arguments.length?(u="function"==typeof t?t:Fg(+t),p(),f):u},f},x:function(t){var e,n,r,i=Fg(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=Fg(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Fg(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:Fg(+e),a(),o):t},o},y:function(t){var e,n,r,i=Fg(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=Fg(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Fg(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:Fg(+e),a(),o):t},o}},Wg="forces",$g=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Hg=["static","iterations"],Zg=["x","y","vx","vy"];function Yg(t){Cr.call(this,null,t)}function Vg(t,e,n,r){var i,o,a,s,l=it(e.forces);for(i=0,o=$g.length;i<o;++i)(a=$g[i])!==Wg&&e.modified(a)&&t[a](e[a]);for(i=0,o=l.length;i<o;++i)s=Wg+i,(a=n||e.modified(Wg,i)?Xg(l[i]):r&&Gg(l[i],r)?t.force(s):null)&&t.force(s,a);for(o=t.numForces||0;i<o;++i)t.force(Wg+i,null);return t.numForces=l.length,t}function Gg(t,e){var n,r;for(n in t)if(ot(r=t[n])&&e.modified(v(r)))return 1;return 0}function Xg(t){var e,n;for(n in yt(Ig,t.force)||w("Unrecognized force: "+t.force),e=Ig[t.force](),t)ot(e[n])&&Qg(e[n],t[n],t);return e}function Qg(t,e,n){t(ot(e)?t=>e(t,n):e)}Yg.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Zg}]},xt(Yg,Cr,{transform(t,e){var n,r,i=this.value,o=e.changed(e.ADD_REM),a=t.modified($g),s=t.iterations||300;if(i?(o&&(e.modifies("index"),i.nodes(e.source)),(a||e.changed(e.MOD))&&Vg(i,t,0,e)):(this.value=i=function(t,e){const n=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=(0,Rg.HT)(f),u=(0,zg.Z)("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Pg)/Pg}();function f(){d(),u.call("tick",e),n<r&&(l.stop(),u.call("end",e))}function d(r){var l,u,c=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),l=0;l<c;++l)null==(u=t[l]).fx?u.x+=u.vx*=a:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=a:(u.y=u.fy,u.vy=0);return e}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*jg;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),h(),e={tick:d,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(c=t,s.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,l,u=0,c=t.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(a=(i=e-(s=t[u]).x)*i+(o=n-s.y)*o)<r&&(l=s,r=a);return l},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),Vg(n,e,!0).on("end",(()=>o=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(o=!0,i.tick()),e.modifies("index")),a||o||t.modified(Hg)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let s,l=this._argops,u=0,c=l.length;u<c;++u)if(s=l[u],s.name===Wg&&"link"===s.op._argval.force)for(var r,i=s.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(Zg)}});var Jg=n(470),Kg=n(7353);function ty(){return 0}function ey(t){return function(){return t}}const ny=4294967296;function ry(t,e){var n,r;if(ay(e,t))return[e];for(n=0;n<t.length;++n)if(iy(e,t[n])&&ay(ly(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(iy(ly(t[n],t[r]),e)&&iy(ly(t[n],e),t[r])&&iy(ly(t[r],e),t[n])&&ay(uy(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function iy(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function oy(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function ay(t,e){for(var n=0;n<e.length;++n)if(!oy(t,e[n]))return!1;return!0}function sy(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return ly(t[0],t[1]);case 3:return uy(t[0],t[1],t[2])}}function ly(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,l=o-n,u=a-r,c=s-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+s)/2}}function uy(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,l=e.r,u=n.x,c=n.y,f=n.r,d=r-a,h=r-u,p=i-s,m=i-c,g=l-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+l*l,x=v-u*u-c*c+f*f,_=h*p-d*m,w=(p*x-m*b)/(2*_)-r,k=(m*g-p*y)/_,A=(h*b-d*x)/(2*_)-i,E=(d*y-h*g)/_,M=k*k+E*E-1,C=2*(o+w*k+A*E),S=w*w+A*A-o*o,D=-(Math.abs(M)>1e-6?(C+Math.sqrt(C*C-4*M*S))/(2*M):S/C);return{x:r+w+k*D,y:i+A+E*D,r:D}}function cy(t,e,n){var r,i,o,a,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(i=e.r+n.r,i*=i,a=t.r+n.r,i>(a*=a)?(r=(u+a-i)/(2*u),o=Math.sqrt(Math.max(0,a/u-r*r)),n.x=t.x-r*s-o*l,n.y=t.y-r*l+o*s):(r=(u+i-a)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*s-o*l,n.y=e.y+r*l+o*s)):(n.x=e.x+n.r,n.y=e.y)}function fy(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function dy(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function hy(t){this._=t,this.next=null,this.previous=null}function py(t){return Math.sqrt(t.value)}function my(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function gy(t,e,n){return function(r){if(i=r.children){var i,o,a,s=i.length,l=t(r)*e||0;if(l)for(o=0;o<s;++o)i[o].r+=l;if(a=function(t,e){if(!(o=(t=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,r,i,o,a,s,l,u,c,f,d;if((n=t[0]).x=0,n.y=0,!(o>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;cy(r,n,i=t[2]),n=new hy(n),r=new hy(r),i=new hy(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(l=3;l<o;++l){cy(n._,r._,i=t[l]),i=new hy(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(fy(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue t}f+=u._.r,u=u.next}else{if(fy(c._,i._)){(n=c).next=r,r.previous=n,--l;continue t}d+=c._.r,c=c.previous}}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=dy(n);(i=i.next)!==r;)(s=dy(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=function(t,e){for(var n,r,i=0,o=(t=function(t,e){let n,r,i=t.length;for(;i;)r=e()*i--|0,n=t[i],t[i]=t[r],t[r]=n;return t}(Array.from(t),e)).length,a=[];i<o;)n=t[i],r&&oy(r,n)?++i:(r=sy(a=ry(a,n)),i=0);return r}(n,e),l=0;l<o;++l)(n=t[l]).x-=i.x,n.y-=i.y;return i.r}(i,n),l)for(o=0;o<s;++o)i[o].r-=l;r.r=a+l}}}function yy(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function vy(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function by(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(r-e)/t.value;++s<l;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*u}var xy=n(8330),_y=n(2324),wy=n(9247);function ky(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(i-n)/t.value;++s<l;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*u}var Ay=(1+Math.sqrt(5))/2;function Ey(t,e,n,r,i,o){for(var a,s,l,u,c,f,d,h,p,m,g,y=[],v=e.children,b=0,x=0,_=v.length,w=e.value;b<_;){l=i-n,u=o-r;do{c=v[x++].value}while(!c&&x<_);for(f=d=c,g=c*c*(m=Math.max(u/l,l/u)/(w*t)),p=Math.max(d/g,g/f);x<_;++x){if(c+=s=v[x].value,s<f&&(f=s),s>d&&(d=s),g=c*c*m,(h=Math.max(d/g,g/f))>p){c-=s;break}p=h}y.push(a={value:c,dice:l<u,children:v.slice(b,x)}),a.dice?by(a,n,r,i,w?r+=u*c/w:o):ky(a,n,r,w?n+=l*c/w:i,o),w-=c,b=x}return y}const My=function t(e){function n(t,n,r,i,o){Ey(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Ay),Cy=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,l,u,c,f=-1,d=a.length,h=t.value;++f<d;){for(l=(s=a[f]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?by(s,n,r,i,h?r+=(o-r)*s.value/h:o):ky(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else t._squarify=a=Ey(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Ay);function Sy(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function Dy(t){Cr.call(this,null,t)}Dy.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Fy=t=>t.values;function Ty(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,o=t[r++],a={},s={};let l,u,c,f=-1;for(;++f<i;)l=o(u=e[f])+"",(c=a[l])?c.push(u):a[l]=[u];for(l in a)s[l]=n(a[l],r);return s}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function Ny(t){Cr.call(this,null,t)}xt(Dy,Cr,{transform(t,e){e.source||w("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each((t=>{t.children&&Vn(t.data)&&i.rem.push(t.data)})),this.value=o=(0,Jg.ZP)({values:it(t.keys).reduce(((t,e)=>(t.key(e),t)),Ty()).entries(i.source)},Fy),n&&o.each((t=>{t.children&&(t=Qn(t.data),i.add.push(t),i.source.push(t))})),Sy(o,Gn,Gn)),i.source.root=o,i}});const Oy=(t,e)=>t.parent===e.parent?1:2;xt(Ny,Cr,{transform(t,e){e.source&&e.source.root||w(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(er(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?Oy:S);try{this.value=n(i)}catch(t){w(t)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}(t,r,o))),e.reflow(t.modified()).modifies(o).modifies("leaf")}});const zy=["x","y","r","depth","children"];function Ry(t){Ny.call(this,t)}Ry.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:zy.length,default:zy}]},xt(Ry,Ny,{layout:function(){var t=null,e=1,n=1,r=ty;function i(i){const o=function(){let t=1;return()=>(t=(1664525*t+1013904223)%ny)/ny}();return i.x=e/2,i.y=n/2,t?i.eachBefore(my(t)).eachAfter(gy(r,.5,o)).eachBefore(yy(1)):i.eachBefore(my(py)).eachAfter(gy(ty,1,o)).eachAfter(gy(r,i.r/Math.min(e,n),o)).eachBefore(yy(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=(0,Kg.j)(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:ey(+t),i):r},i},params:["radius","size","padding"],fields:zy});const Py=["x0","y0","x1","y1","depth","children"];function By(t){Ny.call(this,t)}function Ly(t){Cr.call(this,null,t)}By.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Py.length,default:Py}]},xt(By,Ny,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&by(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(vy),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:Py}),Ly.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},xt(Ly,Cr,{transform(t,e){e.source||w("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?Sy((0,xy.Z)().id(t.key).parentId(t.parentKey)(i.source),t.key,D):Sy((0,xy.Z)()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const jy={tidy:_y.Z,cluster:wy.Z},Uy=["x","y","depth","children"];function qy(t){Ny.call(this,t)}function Iy(t){Cr.call(this,[],t)}qy.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Uy.length,default:Uy}]},xt(qy,Ny,{layout(t){const e=t||"tidy";if(yt(jy,e))return jy[e]();w("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:Uy}),Iy.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},xt(Iy,Cr,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||w("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>o[Gn(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[Gn(e)]&&o[Gn(n)]&&i.add.push(Qn({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>o[Gn(t)]=1)),n.forEach((t=>{(o[Gn(t.source)]||o[Gn(t.target)])&&i.mod.push(t)}))),i}});const Wy={binary:function(t,e,n,r,i){var o,a,s=t.children,l=s.length,u=new Array(l+1);for(u[0]=a=o=0;o<l;++o)u[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,l){if(e>=n-1){var c=s[e];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=l)}for(var f=u[e],d=r/2+f,h=e+1,p=n-1;h<p;){var m=h+p>>>1;u[m]<d?h=m+1:p=m}d-u[h-1]<u[h]-d&&e+1<h&&--h;var g=u[h]-f,y=r-g;if(a-i>l-o){var v=r?(i*y+a*g)/r:a;t(e,h,g,i,o,v,l),t(h,n,y,v,o,a,l)}else{var b=r?(o*y+l*g)/r:l;t(e,h,g,i,o,a,b),t(h,n,y,i,b,a,l)}}(0,l,t.value,e,n,r,i)},dice:by,slice:ky,slicedice:function(t,e,n,r,i){(1&t.depth?ky:by)(t,e,n,r,i)},squarify:My,resquarify:Cy},$y=["x0","y0","x1","y1","depth","children"];function Hy(t){Ny.call(this,t)}Hy.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:$y.length,default:$y}]},xt(Hy,Ny,{layout(){const t=function(){var t=My,e=!1,n=1,r=1,i=[0],o=ty,a=ty,s=ty,l=ty,u=ty;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(f),i=[0],e&&t.eachBefore(vy),t}function f(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,f=e.x1-n,d=e.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),e.x0=r,e.y0=c,e.x1=f,e.y1=d,e.children&&(n=i[e.depth+1]=o(e)/2,r+=u(e)-n,c+=a(e)-n,(f-=s(e)-n)<r&&(r=f=(r+f)/2),(d-=l(e)-n)<c&&(c=d=(c+d)/2),t(e,r,c,f,d))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=(0,Kg.C)(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:ey(+t),c):o},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:ey(+t),c):a},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:ey(+t),c):s},c.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:ey(+t),c):l},c.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:ey(+t),c):u},c}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{yt(Wy,e)?t.tile(Wy[e]):w("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:$y});const Zy=4278190080;function Yy(t,e,n){return new Uint32Array(t.getImageData(0,0,e,n).data.buffer)}function Vy(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>Vy(t,e.items,n)))})):Wc[r].draw(t,{items:n?e.map(Gy):e})}function Gy(t){const e=Kn(t,{});return e.stroke&&0!==e.strokeOpacity||e.fill&&0!==e.fillOpacity?{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}:e}const Xy=31,Qy=new Uint32Array(33),Jy=new Uint32Array(33);Jy[0]=0,Qy[0]=~Jy[0];for(let n=1;n<=32;++n)Jy[n]=Jy[n-1]<<1|1,Qy[n]=~Jy[n];function Ky(t,e,n,r,i,o){let a=n/2;return t-a<0||t+a>i||e-(a=r/2)<0||e+a>o}function tv(t,e,n,r,i,o,a,s){const l=i*o/(2*r),u=t(e-l),c=t(e+l),f=t(n-(o/=2)),d=t(n+o);return a.outOfBounds(u,f,c,d)||a.getRange(u,f,c,d)||s&&s.getRange(u,f,c,d)}const ev=[-1,-1,1,1],nv=[-1,1,-1,1],rv=["right","center","left"],iv=["bottom","middle","top"];function ov(t,e,n,r,i,o,a,s,l,u,c,f){return!(i.outOfBounds(t,n,e,r)||(f&&o||i).getRange(t,n,e,r))}const av={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},sv={naive:function(t,e,n,r){const i=t.width,o=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,a=t.datum.fontSize,s=kc.width(t.datum,t.datum.text);let l,u,c,f,d,h,p,m=0;for(let r=0;r<n;++r)l=e[r].x,c=e[r].y,u=void 0===e[r].x2?l:e[r].x2,f=void 0===e[r].y2?c:e[r].y2,d=(l+u)/2,h=(c+f)/2,p=Math.abs(u-l+f-c),p>=m&&(m=p,t.x=d,t.y=h);return d=s/2,h=a/2,l=t.x-d,u=t.x+d,c=t.y-h,f=t.y+h,t.align="center",l<0&&u<=i?t.align="left":0<=l&&i<u&&(t.align="right"),t.baseline="middle",c<0&&f<=o?t.baseline="top":0<=c&&o<f&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1];function l(e,n,r,l,u){const c=t.invert(e),f=t.invert(n);let d,h=r,p=o;if(!Ky(c,f,l,u,i,o)&&!tv(t,c,f,u,l,h,a,s)&&!tv(t,c,f,u,l,u,a,null)){for(;p-h>=1;)d=(h+p)/2,tv(t,c,f,u,l,d,a,s)?p=d:h=d;if(h>r)return[c,f,h,!0]}}return function(e){const s=e.datum.datum.items[r].items,u=s.length,c=e.datum.fontSize,f=kc.width(e.datum,e.datum.text);let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C,S,D=n?c:0,F=!1,T=!1,N=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,h=void 0===s[r].x2?d:s[r].x2,m=void 0===s[r].y2?p:s[r].y2,d>h&&(S=d,d=h,h=S),p>m&&(S=p,p=m,m=S),x=t(d),w=t(h),_=~~((x+w)/2),k=t(p),E=t(m),A=~~((k+E)/2),v=_;v>=x;--v)for(b=A;b>=k;--b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);for(v=_;v<=w;++v)for(b=A;b<=E;++b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);F||n||(M=Math.abs(h-d+m-p),g=(d+h)/2,y=(p+m)/2,M>=N&&!Ky(g,y,f,c,i,o)&&!tv(t,g,y,c,f,c,a,null)&&(N=M,e.x=g,e.y=y,T=!0))}return!(!F&&!T||(g=f/2,y=c/2,a.setRange(t(e.x-g),t(e.y-y),t(e.x+g),t(e.y+y)),e.align="center",e.baseline="middle",0))}},floodfill:function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=t.bitmap();return function(e){const u=e.datum.datum.items[r].items,c=u.length,f=e.datum.fontSize,d=kc.width(e.datum,e.datum.text),h=[];let p,m,g,y,v,b,x,_,w,k,A,E,M=n?f:0,C=!1,S=!1,D=0;for(let r=0;r<c;++r){for(p=u[r].x,g=u[r].y,m=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?g:u[r].y2,h.push([t((p+m)/2),t((g+y)/2)]);h.length;)if([x,_]=h.pop(),!(a.get(x,_)||s.get(x,_)||l.get(x,_))){l.set(x,_);for(let t=0;t<4;++t)v=x+ev[t],b=_+nv[t],l.outOfBounds(v,b,v,b)||h.push([v,b]);if(v=t.invert(x),b=t.invert(_),w=M,k=o,!Ky(v,b,d,f,i,o)&&!tv(t,v,b,f,d,w,a,s)&&!tv(t,v,b,f,d,f,a,null)){for(;k-w>=1;)A=(w+k)/2,tv(t,v,b,f,d,A,a,s)?k=A:w=A;w>M&&(e.x=v,e.y=b,M=w,C=!0)}}C||n||(E=Math.abs(m-p+y-g),v=(p+m)/2,b=(g+y)/2,E>=D&&!Ky(v,b,d,f,i,o)&&!tv(t,v,b,f,d,f,a,null)&&(D=E,e.x=v,e.y=b,S=!0))}return!(!C&&!S||(v=d/2,b=f/2,a.setRange(t(e.x-v),t(e.y-b),t(e.x+v),t(e.y+b)),e.align="center",e.baseline="middle",0))}}},lv=["x","y","opacity","align","baseline"],uv=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function cv(t){Cr.call(this,null,t)}function fv(t,e){var n,r,i,o,a,s,l=[],u=function(t){return t(o)};if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}function dv(t){Cr.call(this,null,t)}cv.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:uv},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:lv.length,default:lv}]},xt(cv,Cr,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t.sort;return ot(r)&&e.modified(r.fields)}()))return;t.size&&2===t.size.length||w("Size parameter should be specified as a [width, height] array.");const r=t.as||lv;return function(t,e,n,r,i,o,a,s,l,u,c){if(!t.length)return t;const f=Math.max(r.length,i.length),d=function(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}(r,f),h=function(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=av[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}(i,f),p=(x=t[0].datum)&&x.mark&&x.mark.marktype,m="group"===p&&t[0].datum.items[l].marktype,g="area"===m,y=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,m,s,l),v=null===u||u===1/0,b=g&&"naive"===c;var x;let _=-1,w=-1;const k=t.map((t=>{const e=v?kc.width(t,t.text):void 0;return _=Math.max(_,e),w=Math.max(w,t.fontSize),{datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t),textWidth:e}}));u=null===u||u===1/0?Math.max(_,w)+Math.max(...r):u;const A=function(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),a=t=>~~((t+n)/r);return a.invert=t=>t*r-n,a.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+32)/32));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>5]&1<<(i&Xy)},set:(e,n)=>{const i=n*t+e;r(i>>>5,1<<(i&Xy))},clear:(e,n)=>{const r=n*t+e;i(r>>>5,~(1<<(r&Xy)))},getRange:(e,r,i,o)=>{let a,s,l,u,c=o;for(;c>=r;--c)if(a=c*t+e,s=c*t+i,l=a>>>5,u=s>>>5,l===u){if(n[l]&Qy[a&Xy]&Jy[1+(s&Xy)])return!0}else{if(n[l]&Qy[a&Xy])return!0;if(n[u]&Jy[1+(s&Xy)])return!0;for(let t=l+1;t<u;++t)if(n[t])return!0}return!1},setRange:(e,n,i,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+i,l=a>>>5,u=s>>>5,l===u)r(l,Qy[a&Xy]&Jy[1+(s&Xy)]);else for(r(l,Qy[a&Xy]),r(u,Jy[1+(s&Xy)]),c=l+1;c<u;++c)r(c,4294967295)},clearRange:(e,n,r,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+r,l=a>>>5,u=s>>>5,l===u)i(l,Jy[a&Xy]|Qy[1+(s&Xy)]);else for(i(l,Jy[a&Xy]),i(u,Qy[1+(s&Xy)]),c=l+1;c<u;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=e||i>=t}}(i,o),a.ratio=r,a.padding=n,a.width=t,a.height=e,a}(e[0],e[1],u);let E;if(!b){n&&k.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<h.length&&!e;++t)e=5===h[t]||d[t]<0;const r=(p&&a||g)&&t.map((t=>t.datum));E=o.length||r?function(t,e,n,r,i){const o=t.width,a=t.height,s=r||i,l=xa(o,a).getContext("2d"),u=xa(o,a).getContext("2d"),c=s&&xa(o,a).getContext("2d");n.forEach((t=>Vy(l,t,!1))),Vy(u,e,!1),s&&Vy(c,e,!0);const f=Yy(l,o,a),d=Yy(u,o,a),h=s&&Yy(c,o,a),p=t.bitmap(),m=s&&t.bitmap();let g,y,v,b,x,_,w,k;for(y=0;y<a;++y)for(g=0;g<o;++g)x=y*o+g,_=f[x]&Zy,k=d[x]&Zy,w=s&&h[x]&Zy,(_||w||k)&&(v=t(g),b=t(y),i||!_&&!k||p.set(v,b),s&&(_||w)&&m.set(v,b));return[p,m]}(A,r||[],o,e,g):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(A,a&&k)}const M=g?sv[c](A,E,a,l):function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=r.length;return function(e){var u;const c=e.boundary,f=e.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C=null!==(u=e.textWidth)&&void 0!==u?u:0;for(let i=0;i<l;++i){if(d=(3&n[i])-1,h=(n[i]>>>2&3)-1,p=0===d&&0===h||r[i]<0,m=d&&h?Math.SQRT1_2:1,g=r[i]<0?-1:1,y=c[1+d]+r[i]*d*m,w=c[4+h]+g*f*h/2+r[i]*h*m,b=w-f/2,x=w+f/2,k=t(y),E=t(b),M=t(x),!C){if(!ov(k,k,E,M,a,s,0,0,0,0,0,p))continue;C=kc.width(e.datum,e.datum.text)}if(_=y+g*C*d/2,y=_-C/2,v=_+C/2,k=t(y),A=t(v),ov(k,A,E,M,a,s,0,0,0,0,0,p))return e.x=d?d*g<0?v:y:_,e.y=h?h*g<0?x:b:w,e.align=rv[d*g+1],e.baseline=iv[h*g+1],a.setRange(k,E,A,M),!0}return!1}}(A,E,h,d);return k.forEach((t=>t.opacity=+M(t))),k}(e.materialize(e.SOURCE).source||[],t.size,t.sort,it(null==t.offset?1:t.offset),it(t.anchor||uv),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),dv.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},xt(dv,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=fv(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(y),o=i.length,a=t.as||[y(t.x),y(t.y)],s=[];r.forEach((e=>{(function(t,e,n,r){const[i,o,a,s]=ii(t,e,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const t=[0,u-1];for(let n=0;n<l;++n){const e=i[n],r=t[0],a=t[1],s=e-i[r]>i[a]-e?r:a;let l=0,u=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-e||1);for(let t=r;t<=a;++t){const n=i[t],r=o[t],a=ci(Math.abs(e-n)*g)*d[t],s=n*a;l+=a,u+=s,h+=r*a,p+=r*s,m+=n*s}const[y,v]=ri(u/l,h/l,p/l,m/l);c[n]=y+v*e,f[n]=Math.abs(o[n]-c[n]),fi(i,n+1,t)}if(2===h)break;const e=(0,Nr.Z)(f);if(Math.abs(e)<1e-12)break;for(let n,r,i=0;i<l;++i)n=f[i]/(6*e),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,o=[];let a,s=0,l=0,u=[];for(;s<i;++s)a=t[s]+n,u[0]===a?u[1]+=(e[s]-u[1])/++l:(l=0,u[1]+=r,u=[a,e[s]],o.push(u));return u[1]+=r,o}(i,c,a,s)})(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let r=0;r<o;++r)n[i[r]]=e.dims[r];n[a[0]]=t[0],n[a[1]]=t[1],s.push(Qn(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const hv={constant:ni,linear:si,log:function(t,e,n){let r=0,i=0,o=0,a=0,s=0;oi(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=ri(r,i,o,a),u=t=>l[0]+l[1]*Math.log(t);return{coef:l,predict:u,rSquared:ai(t,e,n,i,u)}},exp:function(t,e,n){const[r,i,o,a]=ii(t,e,n);let s,l,u,c=0,f=0,d=0,h=0,p=0;oi(t,e,n,((t,e)=>{s=r[p++],l=Math.log(e),u=s*e,c+=(e*l-c)/p,f+=(u-f)/p,d+=(u*l-d)/p,h+=(s*u-h)/p}));const[m,g]=ri(f/a,c/a,d/a,h/a),y=t=>Math.exp(m+g*(t-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:ai(t,e,n,a,y)}},pow:function(t,e,n){let r=0,i=0,o=0,a=0,s=0,l=0;oi(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++l,r+=(n-r)/l,i+=(u-i)/l,o+=(n*u-o)/l,a+=(n*n-a)/l,s+=(e-s)/l}));const u=ri(r,i,o,a),c=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:ai(t,e,n,s,c)}},quad:li,poly:function(t,e,n,r){if(0===r)return ni(t,e,n);if(1===r)return si(t,e,n);if(2===r)return li(t,e,n);const[i,o,a,s]=ii(t,e,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d)*o[p];for(u.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(u);const y=function(t){const e=t.length-1,n=[];let r,i,o,a,s;for(r=0;r<e;++r){for(a=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][a])&&(a=i);for(o=r;o<e+1;++o)s=t[o][r],t[o][r]=t[o][a],t[o][a]=s;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,o=i+1;o<e;++o)s+=t[o][i]*n[o];n[i]=(t[e][i]-s)/t[i][i]}return n}(c),v=t=>{t-=a;let e=s+y[0]+y[1]*t+y[2]*t*t;for(d=3;d<f;++d)e+=y[d]*Math.pow(t,d);return e};return{coef:ui(f,y,-a,s),predict:v,rSquared:ai(t,e,n,s,v)}}};function pv(t){Cr.call(this,null,t)}pv.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(hv)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},xt(pv,Cr,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=fv(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(y),o=t.method||"linear",a=null==t.order?3:t.order,s=((t,e)=>"poly"===t?e:"quad"===t?2:1)(o,a),l=t.as||[y(t.x),y(t.y)],u=hv[o],c=[];let f=t.extent;yt(hv,o)||w("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=s)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,t.x,t.y,a);if(t.params)return void c.push(Qn({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=f||mt(n,t.x),h=t=>{const e={};for(let r=0;r<i.length;++r)e[i[r]]=n.dims[r];e[l[0]]=t[0],e[l[1]]=t[1],c.push(Qn(e))};"linear"===o||"constant"===o?d.forEach((t=>h([t,r.predict(t)]))):hi(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});var mv=n(9218);function gv(t){Cr.call(this,null,t)}gv.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const yv=[-1e5,-1e5,1e5,1e5];function vv(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}xt(gv,Cr,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:yv;const o=this.value=mv.Z.from(r,t.x,t.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const t=o.cellPolygon(a);r[a][n]=t?vv(t):null}return e.reflow(t.modified()).modifies(n)}});var bv=Math.PI/180,xv=64,_v=2048;function wv(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,(xv<<5)/o,_v/o);var a,s,l,u,c,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,a=i.measureText(e.text+"m").width*o,l=e.size<<1,e.rotate){var m=Math.sin(e.rotate*bv),g=Math.cos(e.rotate*bv),y=a*g,v=a*m,b=l*g,x=l*m;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,l=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(l>h&&(h=l),f+a>=xv<<5&&(f=0,d+=h,h=0),d+l>=_v)break;i.translate((f+(a>>1))/o,(d+(l>>1))/o),e.rotate&&i.rotate(e.rotate*bv),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=a,e.height=l,e.xoff=f,e.yoff=d,e.x1=a>>1,e.y1=l>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=a}for(var _=i.getImageData(0,0,(xv<<5)/o,_v/o).data,w=[];--r>=0;)if((e=n[r]).hasText){for(s=(a=e.width)>>5,l=e.y1-e.y0,u=0;u<l*s;u++)w[u]=0;if(null==(f=e.xoff))return;d=e.yoff;var k=0,A=-1;for(c=0;c<l;c++){for(u=0;u<a;u++){var E=s*c+(u>>5),M=_[(d+c)*(xv<<5)+(f+u)<<2]?1<<31-u%32:0;w[E]|=M,k|=M}k?A=c:(e.y0++,l--,c--,d++)}e.y1=e.y0+A,e.sprite=w.slice(0,(e.y1-e.y0)*s)}}}function kv(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,a=t.x-(o<<4),s=127&a,l=32-s,u=t.y1-t.y0,c=(t.y+t.y0)*n+(a>>5),f=0;f<u;f++){r=0;for(var d=0;d<=o;d++)if((r<<l|(d<o?(r=i[f*o+d])>>>s:0))&e[c+d])return!0;c+=n}return!1}function Av(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function Ev(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function Mv(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function Cv(t){return"function"==typeof t?t:function(){return t}}var Sv={archimedean:Mv,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const Dv=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Fv=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Tv(t){Cr.call(this,function(){var t,e,n,r,i,o,a,s=[256,256],l=Mv,u=[],c=Math.random,f={};function d(t,e,n){for(var r,i,o,a=e.x,u=e.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=l(s),h=c()<.5?1:-1,p=-h;(r=d(p+=h))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(e.x=a+i,e.y=u+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1])&&(!n||!kv(e,t,s[0]))&&(!n||Ev(e,n))){for(var m,g=e.sprite,y=e.width>>5,v=s[0]>>5,b=e.x-(y<<4),x=127&b,_=32-x,w=e.y1-e.y0,k=(e.y+e.y0)*v+(b>>5),A=0;A<w;A++){m=0;for(var E=0;E<=y;E++)t[k+E]|=m<<_|(E<y?(m=g[A*y+E])>>>x:0);k+=v}return e.sprite=null,!0}return!1}return f.layout=function(){for(var l=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(xv<<5)/e,t.height=_v/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(xa()),f=function(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),h=null,p=u.length,m=-1,g=[],y=u.map((s=>({text:t(s),font:e(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((t,e)=>e.size-t.size));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,wv(l,v,y,m),v.hasText&&d(f,v,h)&&(g.push(v),h?Av(h,v):h=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},f.words=function(t){return arguments.length?(u=t,f):u},f.size=function(t){return arguments.length?(s=[+t[0],+t[1]],f):s},f.font=function(t){return arguments.length?(e=Cv(t),f):e},f.fontStyle=function(t){return arguments.length?(r=Cv(t),f):r},f.fontWeight=function(t){return arguments.length?(i=Cv(t),f):i},f.rotate=function(t){return arguments.length?(o=Cv(t),f):o},f.text=function(e){return arguments.length?(t=Cv(e),f):t},f.spiral=function(t){return arguments.length?(l=Sv[t]||t,f):l},f.fontSize=function(t){return arguments.length?(n=Cv(t),f):n},f.padding=function(t){return arguments.length?(a=Cv(t),f):a},f.random=function(t){return arguments.length?(c=t,f):c},f}(),t)}Tv.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Dv}]},xt(Tv,Cr,{transform(t,e){!t.size||t.size[0]&&t.size[1]||w("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||Fv.some((function(n){const r=t[n];return ot(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,o=t.as||Dv;let a,s=t.fontSize||14;if(ot(s)?a=t.fontSizeRange:s=dt(s),a){const t=s,e=hs("sqrt")().domain(mt(r,t)).range(a);s=n=>e(t(n))}r.forEach((t=>{t[o[0]]=NaN,t[o[1]]=NaN,t[o[3]]=0}));const l=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random(Br).layout(),u=i.size(),c=u[0]>>1,f=u[1]>>1,d=l.length;for(let h,p,m=0;m<d;++m)h=l[m],p=h.datum,p[o[0]]=h.x+c,p[o[1]]=h.y+f,p[o[2]]=h.font,p[o[3]]=h.size,p[o[4]]=h.style,p[o[5]]=h.weight,p[o[6]]=h.rotate;return e.reflow(n).modifies(o)}});var Nv=n(6788);const Ov=t=>new Uint8Array(t),zv=t=>new Uint16Array(t),Rv=t=>new Uint32Array(t);function Pv(t,e,n){const r=(e<257?Ov:e<65537?zv:Rv)(t);return n&&r.set(n),r}function Bv(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),o=t.index,a=i[0],s=i[1],l=o.length;let u;for(u=0;u<a;++u)e[o[u]]|=r;for(u=s;u<l;++u)e[o[u]]|=r;return n}}}function Lv(){let t=Rv(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,l=Rv(s);let u,c,f,d=Array(s);for(f=0;f<s;++f)d[f]=r(i[f]),l[f]=f;if(d=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),(0,Nv.Z)(t,e)}(d,l),a)u=e,c=t,e=Array(a+s),t=Rv(a+s),function(t,e,n,r,i,o,a,s,l){let u,c=0,f=0;for(u=0;c<r&&f<a;++u)e[c]<i[f]?(s[u]=e[c],l[u]=n[c++]):(s[u]=i[f],l[u]=o[f++]+t);for(;c<r;++c,++u)s[u]=e[c],l[u]=n[c];for(;f<a;++f,++u)s[u]=i[f],l[u]=o[f]+t}(o,u,c,a,d,l,s,e,t);else{if(o>0)for(f=0;f<s;++f)l[f]+=o;e=d,t=l}return n=a+s,{index:l,value:d}},remove:function(r,i){const o=n;let a,s,l;for(s=0;!i[t[s]]&&s<o;++s);for(l=s;s<o;++s)i[a=t[s]]||(t[l]=a,e[l]=e[s],++l);n=o-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[(0,_a.Nw)(r,t[0],0,i),(0,_a.ml)(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function jv(t){Cr.call(this,function(){let t=8,e=[],n=Rv(0),r=Pv(0,t),i=Pv(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const o=e.length,a=Array(o-t),s=e;let l,u,c;for(u=0;!n[u]&&u<o;++u)a[u]=e[u],s[u]=u;for(c=u;u<o;++u)l=e[u],n[u]?s[u]=-1:(s[u]=c,r[c]=r[u],i[c]=i[u],a[c]=l,l._index=c++),r[u]=0;return e=a,s},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=Pv(e,t,r),i=Pv(e,t))}}}(),t),this._indices=null,this._dims=null}function Uv(t){Cr.call(this,null,t)}jv.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},xt(jv,Cr,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},o=this._dims=[],a=r.length;let s,l,u=0;for(;u<a;++u)s=n[u].fname,l=i[s]||(i[s]=Lv()),o.push(Bv(l,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,o=this._indices,a=this._dims,s=this.value,l=s.curr(),u=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,g,y,v,b,x,_,w,k;if(u.set(l),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&s.add(e.add),e.mod.length)for(x={},v=e.mod,_=0,w=v.length;_<w;++_)x[v[_]._index]=1;for(_=0;_<h;++_)k=r[_],(!a[_]||t.modified("fields",_)||e.modified(k.fields))&&(y=k.fname,(m=p[y])||(o[y]=g=Lv(),p[y]=m=g.insert(k,e.source,0)),a[_]=Bv(g,_,i[_]).onAdd(m,l));for(_=0,w=s.data().length;_<w;++_)b[_]||(u[_]!==l[_]?f.push(_):x[_]&&l[_]!==c&&d.push(_));return s.mask=(1<<h)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,o=this._dims,a=this._indices,s=t.fields,l={},u=n.add,c=i.size()+r.length,f=o.length;let d,h,p,m=i.size();i.resize(c,f),i.add(r);const g=i.curr(),y=i.prev(),v=i.all();for(d=0;d<f;++d)h=s[d].fname,p=l[h]||(l[h]=a[h].insert(s[d],r,m)),o[d].onAdd(p,g);for(;m<c;++m)y[m]=v,g[m]!==v&&u.push(m)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),o=r.all(),a=t.mod;let s,l,u;for(s=0,l=a.length;s<l;++s)u=a[s]._index,i[u]!==o&&n.push(u)},remove(t,e,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),l={},u=n.rem,c=e.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,a[h]=p=o[h],o[h]=s,p!==s&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(e,d,l),l},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,o=e.stamp,a=r.length;let s,l,u=0;for(n.filters=0,l=0;l<a;++l)t.modified("query",l)&&(s=l,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(l=0,u=0;l<a;++l)t.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),l=t.index(),u=t.bisect(t.range),c=t.bisect(e),f=c[0],d=c[1],h=u[0],p=u[1],m=t.one;let g,y,v;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),o=t.index(),a=t.bisect(t.range),s=t.bisect(e),l=s[0],u=s[1],c=a[0],f=a[1],d=t.one;let h,p,m;if(l<c)for(h=l,p=Math.min(c,u);h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(l>c)for(h=c,p=Math.min(l,f);h<p;++h)m=o[h],i[m]^=d,r.push(m);if(u>f)for(h=Math.max(l,f),p=u;h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(u<f)for(h=Math.max(c,u),p=f;h<p;++h)m=o[h],i[m]^=d,r.push(m);t.range=e.slice()}}),Uv.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},xt(Uv,Cr,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0==(i&n))return e.StopPropagation;const o=e.fork(e.ALL),a=r.data(),s=r.curr(),l=r.prev(),u=t=>s[t]&n?null:a[t];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,(t=>{const e=s[t]&n;return!e&&e^l[t]&n?a[t]:null})),o.filter(o.REM,(t=>{const e=s[t]&n;return!e||e^e^l[t]&n?null:a[t]}))):(o.filter(o.ADD,u),o.filter(o.REM,(t=>(s[t]&n)===i?a[t]:null))),o.filter(o.SOURCE,(t=>u(t._index)))}});const qv="Literal",Iv="CallExpression";function Wv(t){this.type=t}var $v,Hv,Zv,Yv,Vv;Wv.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case Iv:return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var Gv=1,Xv=2,Qv=3,Jv=4,Kv=5,tb=6,eb=7,nb=8;($v={})[Gv]="Boolean",$v[Xv]="<end>",$v[Qv]="Identifier",$v[Jv]="Keyword",$v[Kv]="Null",$v[tb]="Numeric",$v[eb]="Punctuator",$v[nb]="String",$v[9]="RegularExpression";var rb="ArrayExpression",ib="BinaryExpression",ob="CallExpression",ab="ConditionalExpression",sb="Identifier",lb="Literal",ub="LogicalExpression",cb="MemberExpression",fb="ObjectExpression",db="Property",hb="UnaryExpression",pb="Unexpected token %0",mb="Unexpected number",gb="Unexpected string",yb="Unexpected identifier",vb="Unexpected reserved word",bb="Unexpected end of input",xb="Invalid regular expression",_b="Invalid regular expression: missing /",wb="Octal literals are not allowed in strict mode.",kb="Duplicate data property in object literal not allowed in strict mode",Ab="ILLEGAL",Eb="Disabled.",Mb=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Cb=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Sb(t,e){if(!t)throw new Error("ASSERT: "+e)}function Db(t){return t>=48&&t<=57}function Fb(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function Tb(t){return"01234567".indexOf(t)>=0}function Nb(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function Ob(t){return 10===t||13===t||8232===t||8233===t}function zb(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&Mb.test(String.fromCharCode(t))}function Rb(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&Cb.test(String.fromCharCode(t))}const Pb={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Bb(){for(;Zv<Yv;){const t=Hv.charCodeAt(Zv);if(!Nb(t)&&!Ob(t))break;++Zv}}function Lb(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)Zv<Yv&&Fb(Hv[Zv])?(r=Hv[Zv++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):Jb({},pb,Ab);return String.fromCharCode(i)}function jb(){var t,e,n,r;for(e=0,"}"===(t=Hv[Zv])&&Jb({},pb,Ab);Zv<Yv&&Fb(t=Hv[Zv++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&Jb({},pb,Ab),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function Ub(){var t,e;for(t=Hv.charCodeAt(Zv++),e=String.fromCharCode(t),92===t&&(117!==Hv.charCodeAt(Zv)&&Jb({},pb,Ab),++Zv,(t=Lb("u"))&&"\\"!==t&&zb(t.charCodeAt(0))||Jb({},pb,Ab),e=t);Zv<Yv&&Rb(t=Hv.charCodeAt(Zv));)++Zv,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==Hv.charCodeAt(Zv)&&Jb({},pb,Ab),++Zv,(t=Lb("u"))&&"\\"!==t&&Rb(t.charCodeAt(0))||Jb({},pb,Ab),e+=t);return e}function qb(){var t,e,n,r,i=Zv,o=Hv.charCodeAt(Zv),a=Hv[Zv];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Zv,{type:eb,value:String.fromCharCode(o),start:i,end:Zv};default:if(61===(t=Hv.charCodeAt(Zv+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Zv+=2,{type:eb,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:Zv};case 33:case 61:return Zv+=2,61===Hv.charCodeAt(Zv)&&++Zv,{type:eb,value:Hv.slice(i,Zv),start:i,end:Zv}}}return">>>="===(r=Hv.substr(Zv,4))?{type:eb,value:r,start:i,end:Zv+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:eb,value:n,start:i,end:Zv+=3}:a===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===e?{type:eb,value:e,start:i,end:Zv+=2}:("//"===e&&Jb({},pb,Ab),"<>=!+-*%&|^/".indexOf(a)>=0?(++Zv,{type:eb,value:a,start:i,end:Zv}):void Jb({},pb,Ab))}function Ib(){var t,e,n;if(Sb(Db((n=Hv[Zv]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=Zv,t="","."!==n){if(t=Hv[Zv++],n=Hv[Zv],"0"===t){if("x"===n||"X"===n)return++Zv,function(t){let e="";for(;Zv<Yv&&Fb(Hv[Zv]);)e+=Hv[Zv++];return 0===e.length&&Jb({},pb,Ab),zb(Hv.charCodeAt(Zv))&&Jb({},pb,Ab),{type:tb,value:parseInt("0x"+e,16),start:t,end:Zv}}(e);if(Tb(n))return function(t){let e="0"+Hv[Zv++];for(;Zv<Yv&&Tb(Hv[Zv]);)e+=Hv[Zv++];return(zb(Hv.charCodeAt(Zv))||Db(Hv.charCodeAt(Zv)))&&Jb({},pb,Ab),{type:tb,value:parseInt(e,8),octal:!0,start:t,end:Zv}}(e);n&&Db(n.charCodeAt(0))&&Jb({},pb,Ab)}for(;Db(Hv.charCodeAt(Zv));)t+=Hv[Zv++];n=Hv[Zv]}if("."===n){for(t+=Hv[Zv++];Db(Hv.charCodeAt(Zv));)t+=Hv[Zv++];n=Hv[Zv]}if("e"===n||"E"===n)if(t+=Hv[Zv++],"+"!==(n=Hv[Zv])&&"-"!==n||(t+=Hv[Zv++]),Db(Hv.charCodeAt(Zv)))for(;Db(Hv.charCodeAt(Zv));)t+=Hv[Zv++];else Jb({},pb,Ab);return zb(Hv.charCodeAt(Zv))&&Jb({},pb,Ab),{type:tb,value:parseFloat(t),start:e,end:Zv}}function Wb(){if(Bb(),Zv>=Yv)return{type:Xv,start:Zv,end:Zv};const t=Hv.charCodeAt(Zv);return zb(t)?function(){var t,e;return t=Zv,e=92===Hv.charCodeAt(Zv)?Ub():function(){var t,e;for(t=Zv++;Zv<Yv;){if(92===(e=Hv.charCodeAt(Zv)))return Zv=t,Ub();if(!Rb(e))break;++Zv}return Hv.slice(t,Zv)}(),{type:1===e.length?Qv:Pb.hasOwnProperty(e)?Jv:"null"===e?Kv:"true"===e||"false"===e?Gv:Qv,value:e,start:t,end:Zv}}():40===t||41===t||59===t?qb():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(Sb("'"===(t=Hv[Zv])||'"'===t,"String literal must starts with a quote"),e=Zv,++Zv;Zv<Yv;){if((n=Hv[Zv++])===t){t="";break}if("\\"===n)if((n=Hv[Zv++])&&Ob(n.charCodeAt(0)))"\r"===n&&"\n"===Hv[Zv]&&++Zv;else switch(n){case"u":case"x":"{"===Hv[Zv]?(++Zv,i+=jb()):i+=Lb(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:Tb(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),Zv<Yv&&Tb(Hv[Zv])&&(o=!0,r=8*r+"01234567".indexOf(Hv[Zv++]),"0123".indexOf(n)>=0&&Zv<Yv&&Tb(Hv[Zv])&&(r=8*r+"01234567".indexOf(Hv[Zv++]))),i+=String.fromCharCode(r)):i+=n}else{if(Ob(n.charCodeAt(0)))break;i+=n}}return""!==t&&Jb({},pb,Ab),{type:nb,value:i,octal:o,start:e,end:Zv}}():46===t?Db(Hv.charCodeAt(Zv+1))?Ib():qb():Db(t)?Ib():qb()}function $b(){const t=Vv;return Zv=t.end,Vv=Wb(),Zv=t.end,t}function Hb(){const t=Zv;Vv=Wb(),Zv=t}function Zb(t,e,n){const r=new Wv("||"===t||"&&"===t?ub:ib);return r.operator=t,r.left=e,r.right=n,r}function Yb(t,e){const n=new Wv(ob);return n.callee=t,n.arguments=e,n}function Vb(t){const e=new Wv(sb);return e.name=t,e}function Gb(t){const e=new Wv(lb);return e.value=t.value,e.raw=Hv.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function Xb(t,e,n){const r=new Wv(cb);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function Qb(t,e,n){const r=new Wv(db);return r.key=e,r.value=n,r.kind=t,r}function Jb(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(Sb(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=Zv,n.description=i,n}function Kb(t){t.type===Xv&&Jb(t,bb),t.type===tb&&Jb(t,mb),t.type===nb&&Jb(t,gb),t.type===Qv&&Jb(t,yb),t.type===Jv&&Jb(t,vb),Jb(t,pb,t.value)}function tx(t){const e=$b();e.type===eb&&e.value===t||Kb(e)}function ex(t){return Vv.type===eb&&Vv.value===t}function nx(t){return Vv.type===Jv&&Vv.value===t}function rx(){Zv=Vv.start;const t=$b();return t.type===nb||t.type===tb?(t.octal&&Jb(t,wb),Gb(t)):Vb(t.value)}function ix(){var t,e,n;return Zv=Vv.start,(t=Vv).type===Qv?(n=rx(),tx(":"),Qb("init",n,dx())):t.type!==Xv&&t.type!==eb?(e=rx(),tx(":"),Qb("init",e,dx())):void Kb(t)}const ox={if:1};function ax(){const t=[];if(tx("("),!ex(")"))for(;Zv<Yv&&(t.push(dx()),!ex(")"));)tx(",");return tx(")"),t}function sx(){Zv=Vv.start;const t=$b();return function(t){return t.type===Qv||t.type===Jv||t.type===Gv||t.type===Kv}(t)||Kb(t),Vb(t.value)}function lx(){tx("[");const t=hx();return tx("]"),t}function ux(){const t=function(){var t;for(t=function(){var t,e,n;if(ex("("))return function(){tx("(");const t=hx();return tx(")"),t}();if(ex("["))return function(){const t=[];for(Zv=Vv.start,tx("[");!ex("]");)ex(",")?($b(),t.push(null)):(t.push(dx()),ex("]")||tx(","));return $b(),function(t){const e=new Wv(rb);return e.elements=t,e}(t)}();if(ex("{"))return function(){var t,e,n=[],r={},i=String;for(Zv=Vv.start,tx("{");!ex("}");)e="$"+((t=ix()).key.type===sb?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?Jb({},kb):r[e]=!0,n.push(t),ex("}")||tx(",");return tx("}"),function(t){const e=new Wv(fb);return e.properties=t,e}(n)}();if(t=Vv.type,Zv=Vv.start,t===Qv||ox[Vv.value])n=Vb($b().value);else if(t===nb||t===tb)Vv.octal&&Jb(Vv,wb),n=Gb($b());else{if(t===Jv)throw new Error(Eb);t===Gv?((e=$b()).value="true"===e.value,n=Gb(e)):t===Kv?((e=$b()).value=null,n=Gb(e)):ex("/")||ex("/=")?(n=Gb(function(){var t,e,n,r;return Vv=null,Bb(),t=Zv,e=function(){var t,e,n,r;for(Sb("/"===(t=Hv[Zv]),"Regular expression literal must start with a slash"),e=Hv[Zv++],n=!1,r=!1;Zv<Yv;)if(e+=t=Hv[Zv++],"\\"===t)Ob((t=Hv[Zv++]).charCodeAt(0))&&Jb({},_b),e+=t;else if(Ob(t.charCodeAt(0)))Jb({},_b);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||Jb({},_b),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";Zv<Yv&&Rb((t=Hv[Zv]).charCodeAt(0));)++Zv,"\\"===t&&Zv<Yv?Jb({},pb,Ab):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&Jb({},xb,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";Jb({},xb)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){Jb({},xb)}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:Zv}}()),Hb()):Kb($b())}return n}();;)if(ex("."))tx("."),t=Xb(".",t,sx());else if(ex("("))t=Yb(t,ax());else{if(!ex("["))break;t=Xb("[",t,lx())}return t}();if(Vv.type===eb&&(ex("++")||ex("--")))throw new Error(Eb);return t}function cx(){var t,e;if(Vv.type!==eb&&Vv.type!==Jv)e=ux();else{if(ex("++")||ex("--"))throw new Error(Eb);if(ex("+")||ex("-")||ex("~")||ex("!"))t=$b(),e=cx(),e=function(t,e){const n=new Wv(hb);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(nx("delete")||nx("void")||nx("typeof"))throw new Error(Eb);e=ux()}}return e}function fx(t){let e=0;if(t.type!==eb&&t.type!==Jv)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function dx(){var t,e;return t=function(){var t,e,n,r,i,o,a,s,l,u;if(t=Vv,l=cx(),0===(i=fx(r=Vv)))return l;for(r.prec=i,$b(),e=[t,Vv],o=[l,r,a=cx()];(i=fx(Vv))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,l=o.pop(),e.pop(),n=Zb(s,l,a),o.push(n);(r=$b()).prec=i,o.push(r),e.push(Vv),n=cx(),o.push(n)}for(n=o[u=o.length-1],e.pop();u>1;)e.pop(),n=Zb(o[u-1].value,o[u-2],n),u-=2;return n}(),ex("?")&&($b(),e=dx(),tx(":"),t=function(t,e,n){const r=new Wv(ab);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,dx())),t}function hx(){const t=dx();if(ex(","))throw new Error(Eb);return t}function px(t){Zv=0,Yv=(Hv=t).length,Vv=null,Hb();const e=hx();if(Vv.type!==Xv)throw new Error("Unexpect token after expression.");return e}var mx={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function gx(t){function e(e,n,r){return i=>function(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&w("Missing arguments to clamp function."),e.length>3&&w("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&w("Missing arguments to if function."),e.length>3&&w("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var yx,vx,bx,xx,_x,wx,kx,Ax,Ex,Mx,Cx,Sx,Dx,Fx,Tx,Nx,Ox=new gp.dU,zx=new gp.dU,Rx={point:cp.Z,lineStart:cp.Z,lineEnd:cp.Z,polygonStart:function(){Ox=new gp.dU,Rx.lineStart=Px,Rx.lineEnd=Bx},polygonEnd:function(){var t=+Ox;zx.add(t<0?up.BZ+t:t),this.lineStart=this.lineEnd=this.point=cp.Z},sphere:function(){zx.add(up.BZ)}};function Px(){Rx.point=Lx}function Bx(){jx(yx,vx)}function Lx(t,e){Rx.point=jx,yx=t,vx=e,t*=up.uR,e*=up.uR,bx=t,xx=(0,up.mC)(e=e/2+up.pu),_x=(0,up.O$)(e)}function jx(t,e){t*=up.uR,e=(e*=up.uR)/2+up.pu;var n=t-bx,r=n>=0?1:-1,i=r*n,o=(0,up.mC)(e),a=(0,up.O$)(e),s=_x*a,l=xx*o+s*(0,up.mC)(i),u=s*r*(0,up.O$)(i);Ox.add((0,up.fv)(u,l)),bx=t,xx=o,_x=a}var Ux,qx,Ix,Wx,$x,Hx,Zx,Yx,Vx,Gx,Xx,Qx,Jx,Kx,t_,e_,n_={point:r_,lineStart:o_,lineEnd:a_,polygonStart:function(){n_.point=s_,n_.lineStart=l_,n_.lineEnd=u_,Fx=new gp.dU,Rx.polygonStart()},polygonEnd:function(){Rx.polygonEnd(),n_.point=r_,n_.lineStart=o_,n_.lineEnd=a_,Ox<0?(wx=-(Ax=180),kx=-(Ex=90)):Fx>up.Ho?Ex=90:Fx<-up.Ho&&(kx=-90),Nx[0]=wx,Nx[1]=Ax},sphere:function(){wx=-(Ax=180),kx=-(Ex=90)}};function r_(t,e){Tx.push(Nx=[wx=t,Ax=t]),e<kx&&(kx=e),e>Ex&&(Ex=e)}function i_(t,e){var n=vp([t*up.uR,e*up.uR]);if(Dx){var r=xp(Dx,n),i=xp([r[1],-r[0],0],r);kp(i),i=yp(i);var o,a=t-Mx,s=a>0?1:-1,l=i[0]*up.RW*s,u=(0,up.Wn)(a)>180;u^(s*Mx<l&&l<s*t)?(o=i[1]*up.RW)>Ex&&(Ex=o):u^(s*Mx<(l=(l+360)%360-180)&&l<s*t)?(o=-i[1]*up.RW)<kx&&(kx=o):(e<kx&&(kx=e),e>Ex&&(Ex=e)),u?t<Mx?c_(wx,t)>c_(wx,Ax)&&(Ax=t):c_(t,Ax)>c_(wx,Ax)&&(wx=t):Ax>=wx?(t<wx&&(wx=t),t>Ax&&(Ax=t)):t>Mx?c_(wx,t)>c_(wx,Ax)&&(Ax=t):c_(t,Ax)>c_(wx,Ax)&&(wx=t)}else Tx.push(Nx=[wx=t,Ax=t]);e<kx&&(kx=e),e>Ex&&(Ex=e),Dx=n,Mx=t}function o_(){n_.point=i_}function a_(){Nx[0]=wx,Nx[1]=Ax,n_.point=r_,Dx=null}function s_(t,e){if(Dx){var n=t-Mx;Fx.add((0,up.Wn)(n)>180?n+(n>0?360:-360):n)}else Cx=t,Sx=e;Rx.point(t,e),i_(t,e)}function l_(){Rx.lineStart()}function u_(){s_(Cx,Sx),Rx.lineEnd(),(0,up.Wn)(Fx)>up.Ho&&(wx=-(Ax=180)),Nx[0]=wx,Nx[1]=Ax,Dx=null}function c_(t,e){return(e-=t)<0?e+360:e}function f_(t,e){return t[0]-e[0]}function d_(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var h_={sphere:cp.Z,point:p_,lineStart:g_,lineEnd:b_,polygonStart:function(){h_.lineStart=x_,h_.lineEnd=__},polygonEnd:function(){h_.lineStart=g_,h_.lineEnd=b_}};function p_(t,e){t*=up.uR,e*=up.uR;var n=(0,up.mC)(e);m_(n*(0,up.mC)(t),n*(0,up.O$)(t),(0,up.O$)(e))}function m_(t,e,n){++Ux,Ix+=(t-Ix)/Ux,Wx+=(e-Wx)/Ux,$x+=(n-$x)/Ux}function g_(){h_.point=y_}function y_(t,e){t*=up.uR,e*=up.uR;var n=(0,up.mC)(e);Kx=n*(0,up.mC)(t),t_=n*(0,up.O$)(t),e_=(0,up.O$)(e),h_.point=v_,m_(Kx,t_,e_)}function v_(t,e){t*=up.uR,e*=up.uR;var n=(0,up.mC)(e),r=n*(0,up.mC)(t),i=n*(0,up.O$)(t),o=(0,up.O$)(e),a=(0,up.fv)((0,up._b)((a=t_*o-e_*i)*a+(a=e_*r-Kx*o)*a+(a=Kx*i-t_*r)*a),Kx*r+t_*i+e_*o);qx+=a,Hx+=a*(Kx+(Kx=r)),Zx+=a*(t_+(t_=i)),Yx+=a*(e_+(e_=o)),m_(Kx,t_,e_)}function b_(){h_.point=p_}function x_(){h_.point=w_}function __(){k_(Qx,Jx),h_.point=p_}function w_(t,e){Qx=t,Jx=e,t*=up.uR,e*=up.uR,h_.point=k_;var n=(0,up.mC)(e);Kx=n*(0,up.mC)(t),t_=n*(0,up.O$)(t),e_=(0,up.O$)(e),m_(Kx,t_,e_)}function k_(t,e){t*=up.uR,e*=up.uR;var n=(0,up.mC)(e),r=n*(0,up.mC)(t),i=n*(0,up.O$)(t),o=(0,up.O$)(e),a=t_*o-e_*i,s=e_*r-Kx*o,l=Kx*i-t_*r,u=(0,up._m)(a,s,l),c=(0,up.ZR)(u),f=u&&-c/u;Vx.add(f*a),Gx.add(f*s),Xx.add(f*l),qx+=c,Hx+=c*(Kx+(Kx=r)),Zx+=c*(t_+(t_=i)),Yx+=c*(e_+(e_=o)),m_(Kx,t_,e_)}var A_=n(6993);function E_(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function M_(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function C_(){return 0}var S_=n(6332);function D_(t){return t instanceof S_.H?t:new S_.H(t)}const F_="intersect",T_="union",N_="_vgsid_",O_=A(N_),z_="index:unit";function R_(t,e){for(var n,r,i=e.fields,o=e.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=A.getter||A(r.field),kt(n=r.getter(t))&&(n=Z(n)),kt(o[s])&&(o[s]=Z(o[s])),kt(o[s][0])&&(o[s]=o[s].map(Z)),"E"===r.type){if(L(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if("R"===r.type){if(!_t(n,o[s]))return!1}else if("R-RE"===r.type){if(!_t(n,o[s],!0,!1))return!1}else if("R-E"===r.type){if(!_t(n,o[s],!1,!1))return!1}else if("R-LE"===r.type&&!_t(n,o[s],!1,!0))return!1;return!0}const P_=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=E_,n=(e,n)=>E_(t(e),n),r=(e,n)=>t(e)-n):(e=t===E_||t===M_?t:C_,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}(O_),B_=P_.left,L_=P_.right;var j_={["".concat(N_,"_union")]:function(){const t=new S_.H;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)for(const e of i)t.add(e);return t},["".concat(N_,"_intersect")]:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t=new S_.H(t),n=n.map(D_);t:for(const i of t)for(const e of n)if(!e.has(i)){t.delete(i);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=Z(e[0]),r=Z(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=Z(e[0]),r=Z(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function U_(t,e,n,r){e[0].type!==qv&&w("First argument to selection functions must be a string literal.");const i=e[0].value,o="unit",a="@"+o,s=":"+i;(e.length>=2&&H(e).value)!==F_||yt(r,a)||(r[a]=n.getData(i).indataRef(n,o)),yt(r,s)||(r[s]=n.getData(i).tuplesRef())}function q_(t){const e=this.context.data[t];return e?e.values.value:[]}const I_=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},W_=I_("format"),$_=I_("timeFormat"),H_=I_("utcFormat"),Z_=I_("timeParse"),Y_=I_("utcParse"),V_=new Date(2e3,0,1);function G_(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(V_.setYear(2e3),V_.setMonth(t),V_.setDate(e),$_.call(this,V_,n)):""}const X_="%",Q_="$";function J_(t,e,n,r){e[0].type!==qv&&w("First argument to data functions must be a string literal.");const i=e[0].value,o=":"+i;if(!yt(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(t){}}function K_(t,e,n,r){if(e[0].type===qv)tw(n,r,e[0].value);else for(t in n.scales)tw(n,r,t)}function tw(t,e,n){const r=X_+n;if(!yt(e,r))try{e[r]=t.scaleRef(n)}catch(t){}}function ew(t,e){if(ot(t))return t;if(Et(t)){const r=e.scales[t];return r&&(n=r.value)&&!0===n[fs]?r.value:void 0}var n}function nw(t,e){return function(n,r,i){if(n){const e=ew(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const rw=nw("area",(function(t){return zx=new gp.dU,(0,Wp.Z)(t,Rx),2*zx})),iw=nw("bounds",(function(t){var e,n,r,i,o,a,s;if(Ex=Ax=-(wx=kx=1/0),Tx=[],(0,Wp.Z)(t,n_),n=Tx.length){for(Tx.sort(f_),e=1,o=[r=Tx[0]];e<n;++e)d_(r,(i=Tx[e])[0])||d_(r,i[1])?(c_(r[0],i[1])>c_(r[0],r[1])&&(r[1]=i[1]),c_(i[0],r[1])>c_(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(s=c_(r[1],i[0]))>a&&(a=s,wx=i[0],Ax=r[1])}return Tx=Nx=null,wx===1/0||kx===1/0?[[NaN,NaN],[NaN,NaN]]:[[wx,kx],[Ax,Ex]]})),ow=nw("centroid",(function(t){Ux=qx=Ix=Wx=$x=Hx=Zx=Yx=0,Vx=new gp.dU,Gx=new gp.dU,Xx=new gp.dU,(0,Wp.Z)(t,h_);var e=+Vx,n=+Gx,r=+Xx,i=(0,up._m)(e,n,r);return i<up.aW&&(e=Hx,n=Zx,r=Yx,qx<up.Ho&&(e=Ix,n=Wx,r=$x),(i=(0,up._m)(e,n,r))<up.aW)?[NaN,NaN]:[(0,up.fv)(n,e)*up.RW,(0,up.ZR)(r/i)*up.RW]}));function aw(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(e){t.warn(e)}return n[n.length-1]}function sw(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function lw(t){const e=(0,Zm.B8)(t);return.2126*sw(e.r)+.7152*sw(e.g)+.0722*sw(e.b)}function uw(t,e){return t===e||t!=t&&e!=e||(L(t)?!(!L(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!uw(t[n],e[n]))return!1;return!0}(t,e):!(!U(t)||!U(e))&&cw(t,e))}function cw(t,e){for(const n in t)if(!uw(t[n],e[n]))return!1;return!0}function fw(t){return e=>cw(t,e)}const dw={};function hw(t){return L(t)||ArrayBuffer.isView(t)?t:null}function pw(t){return hw(t)||(Et(t)?t:null)}const mw=t=>t.data;function gw(t,e){const n=q_.call(e,t);return n.root&&n.root.lookup||{}}const yw=()=>"undefined"!=typeof window&&window||null;function vw(t,e,n){if(!t)return[];const[r,i]=t,o=(new Yl).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new Yl).union(e),o=t.marktype;return o?xd(t,i,n,r):"group"===o?_d(t,i,n,r):w("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,o,function(t){let e=null;if(t){const n=it(t.marktype),r=it(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))}const bw={random:()=>Br(),cumulativeNormal:$r,cumulativeLogNormal:Xr,cumulativeUniform:ti,densityNormal:Wr,densityLogNormal:Gr,densityUniform:Kr,quantileNormal:Hr,quantileLogNormal:Qr,quantileUniform:ei,sampleNormal:Ir,sampleLogNormal:Vr,sampleUniform:Jr,isArray:L,isBoolean:wt,isDate:kt,isDefined:t=>void 0!==t,isNumber:At,isObject:U,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:Et,isTuple:Vn,isValid:t=>null!=t&&t==t,toBoolean:Ft,toDate:t=>Nt(t),toNumber:Z,toString:Ot,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pw(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return hw(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pw(t).lastIndexOf(...n)},replace:function(t,e,n){return ot(n)&&w("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return hw(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pw(t).slice(...n)},flush:function(t,e,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,l=t[0],u=H(t);u<l&&(s=l,l=u,u=s),s=Math.abs(e-l);const c=Math.abs(u-e);return s<c&&s<=a?r:c<=a?i:o},lerp:function(t,e){const n=t[0],r=H(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),pt(...t)},pad:function(t,e,n,r){const i=n||" ",o=t+"",a=e-o.length;return a<=0?o:"left"===r?Ct(i,a)+o:"center"===r?Ct(i,~~(a/2))+o+Ct(i,Math.ceil(a/2)):o+Ct(i,a)},peek:H,pluck:function(t,e){const n=dw[e]||(dw[e]=A(e));return L(t)?t.map(n):n(t)},span:St,inrange:_t,truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",o=t+"",a=o.length,s=Math.max(0,e-i.length);return a<=e?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},rgb:Zm.B8,lab:A_.ZP,hcl:A_.Uc,hsl:Zm.Ym,luminance:lw,contrast:function(t,e){const n=lw(t),r=lw(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:vi.Z,format:W_,utcFormat:H_,utcParse:Y_,utcOffset:function(t,e,n){return Xe(Ge(t),e,n)},utcSequence:function(t,e,n,r){return Qe(Ge(t),e,n,r)},timeFormat:$_,timeParse:Z_,timeOffset:function(t,e,n){return Xe(Ve(t),e,n)},timeSequence:function(t,e,n,r){return Qe(Ve(t),e,n,r)},timeUnitSpecifier:function(t,e){const n=pt({},Ce,e),r=Me(t),i=r.length;let o,a,s="",l=0;for(l=0;l<i;)for(o=r.length;o>l;--o)if(a=r.slice(l,o).join("-"),null!=n[a]){s+=n[a],l=o;break}return s.trim()},monthFormat:function(t){return G_.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return G_.call(this,t,1,"%b")},dayFormat:function(t){return G_.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return G_.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return Te(new Date(t))},utcweek:function(t){return Re(new Date(t))},dayofyear:function(t){return Fe(new Date(t))},utcdayofyear:function(t){return ze(new Date(t))},warn:function(){return aw(this.context.dataflow,"warn",arguments)},info:function(){return aw(this.context.dataflow,"info",arguments)},debug:function(){return aw(this.context.dataflow,"debug",arguments)},extent:t=>mt(t),inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:vw,clampRange:function(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=yw();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=yw();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return La(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(D).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?xl(n,e=e||ul(t)):t}},panLinear:function(t,e){return J(t,e,Z,M)},panLog:function(t,e){var n=Math.sign(t[0]);return J(t,e,V(n),Y(n))},panPow:function(t,e,n){return J(t,e,Q(n),Q(1/n))},panSymlog:function(t,e,n){return J(t,e,G(n),X(n))},zoomLinear:tt,zoomLog:et,zoomPow:nt,zoomSymlog:rt,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){const a=this.context.dataflow,s=this.context.data[t],l=s.input,u=a.stamp();let c,f,d=s.changes;if(!1===a._trigger||!(l.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=a.changeset(),d.stamp=u,a.runAfter((()=>{s.modified=!0,a.pulse(l,d).run()}),!0,1)),n&&(c=!0===n?D:L(n)||Vn(n)?n:fw(n),d.remove(c)),e&&d.insert(e),r&&(c=fw(r),l.value.some(c)?d.remove(c):d.insert(r)),i)for(f in o)d.modify(i,f,o[f]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(t=it(t))[t.length-1];return void 0===i||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return it(t).reduce(((e,n,r)=>{let[i,o]=n;return e+(0==r?"M ".concat(i,",").concat(o," "):r===t.length-1?" Z":"L ".concat(i,",").concat(o," "))}),"")},intersectLasso:function(t,e,n){const{x:r,y:i,mark:o}=n,a=(new Yl).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of e)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);return a.translate(r,i),vw([[a.x1,a.y1],[a.x2,a.y2]],t,o).filter((t=>function(t,e,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,s]=n[o],[l,u]=n[i];u>e!=s>e&&t<(a-l)*(e-u)/(s-u)+l&&r++}return 1&r}(t.x,t.y,e)))}},xw=["view","item","group","xy","x","y"],_w="this.",ww={},kw={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(Dt(Q_+t),"]"),functions:function(t){const e=gx(t);xw.forEach((t=>e[t]="event.vega."+t));for(const n in bw)e[n]=_w+n;return pt(e,function(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=K_,n._range=K_,n._scale=K_;const r=e=>"_["+(e.type===qv?Dt(X_+e.value):Dt(X_)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}(t,bw,ww)),e},constants:mx,visitors:ww},Aw=function(t){const e=(t=t||{}).allowed?zt(t.allowed):{},n=t.forbidden?zt(t.forbidden):{},r=t.constants||mx,i=(t.functions||gx)(f),o=t.globalvar,a=t.fieldvar,s=ot(o)?o:t=>"".concat(o,'["').concat(t,'"]');let l={},u={},c=0;function f(t){if(Et(t))return t;const e=d[t.type];return null==e&&w("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return c>0?i:yt(n,i)?w("Illegal identifier: "+i):yt(r,i)?r[i]:yt(e,i)?i:(l[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=f(t.object);e&&(c+=1);const r=f(t.property);return n===a&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&w("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=yt(i,e)&&i[e];return r||w("Unrecognized function: "+e),ot(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(f).join(",")+"]",BinaryExpression:t=>"("+f(t.left)+" "+t.operator+" "+f(t.right)+")",UnaryExpression:t=>"("+t.operator+f(t.argument)+")",ConditionalExpression:t=>"("+f(t.test)+"?"+f(t.consequent)+":"+f(t.alternate)+")",LogicalExpression:t=>"("+f(t.left)+t.operator+f(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(f).join(",")+"}",Property:t=>{c+=1;const e=f(t.key);return c-=1,e+":"+f(t.value)}};function h(t){const e={code:f(t),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},e}return h.functions=i,h.constants=r,h}(kw);function Ew(t,e,n){return 1===arguments.length?bw[t]:(bw[t]=e,n&&(ww[t]=n),Aw&&(Aw.functions[t]=_w+t),this)}function Mw(t,e){const n={};let r;try{r=px(t=Et(t)?t:Dt(t)+"")}catch(e){w("Expression parse error: "+t)}r.visit((t=>{if(t.type!==Iv)return;const r=t.callee.name,i=kw.visitors[r];i&&i(r,t.arguments,e,n)}));const i=Aw(r);return i.globals.forEach((t=>{const r=Q_+t;!yt(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:pt({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}Ew("bandwidth",(function(t,e){const n=ew(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),K_),Ew("copy",(function(t,e){const n=ew(t,(e||this).context);return n?n.copy():void 0}),K_),Ew("domain",(function(t,e){const n=ew(t,(e||this).context);return n?n.domain():[]}),K_),Ew("range",(function(t,e){const n=ew(t,(e||this).context);return n&&n.range?n.range():[]}),K_),Ew("invert",(function(t,e,n){const r=ew(t,(n||this).context);return r?L(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),K_),Ew("scale",(function(t,e,n){const r=ew(t,(n||this).context);return r?r(e):void 0}),K_),Ew("gradient",(function(t,e,n,r,i){t=ew(t,(i||this).context);const o=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let a=t.domain(),s=a[0],l=H(a),u=M;return l-s?u=As(t,s,l):t=(t.interpolator?hs("sequential")().interpolator(t.interpolator()):hs("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,l=1]),t.ticks&&(a=t.ticks(+r||15),s!==a[0]&&a.unshift(s),l!==H(a)&&a.push(l)),a.forEach((e=>o.stop(u(e),t(e)))),o}),K_),Ew("geoArea",rw,K_),Ew("geoBounds",iw,K_),Ew("geoCentroid",ow,K_),Ew("geoShape",(function(t,e,n){const r=ew(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),K_),Ew("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==qv&&w("First argument to indata must be a string literal."),e[1].type!==qv&&w("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,a="@"+o;yt(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),Ew("data",q_,J_),Ew("treePath",(function(t,e,n){const r=gw(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(mw):void 0}),J_),Ew("treeAncestors",(function(t,e){const n=gw(t,this)[e];return n?n.ancestors().map(mw):void 0}),J_),Ew("vlSelectionTest",(function(t,e,n){for(var r,i,o,a,s,l=this.context.data[t],u=l?l.values.value:[],c=l?l[z_]&&l[z_].value:void 0,f=n===F_,d=u.length,h=0;h<d;++h)if(r=u[h],c&&f){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=R_(e,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(f^(s=R_(e,r)))return s;return d&&f}),U_),Ew("vlSelectionIdTest",(function(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],o=r?r[z_]&&r[z_].value:void 0,a=n===F_,s=O_(e),l=B_(i,s);if(l===i.length)return!1;if(O_(i[l])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(L_(i,s)-l<o.size)return!1}return!0}),U_),Ew("vlSelectionResolve",(function(t,e,n,r){for(var i,o,a,s,l,u,c,f,d,h,p,m,g=this.context.data[t],y=g?g.values.value:[],v={},b={},x={},_=y.length,w=0;w<_;++w)if(s=(i=y[w]).unit,o=i.fields,a=i.values,o&&a){for(p=0,m=o.length;p<m;++p)l=o[p],f=(c=v[l.field]||(v[l.field]={}))[s]||(c[s]=[]),x[l.field]=d=l.type.charAt(0),h=j_["".concat(d,"_union")],c[s]=h(f,it(a[p]));n&&(f=b[s]||(b[s]=[])).push(it(a).reduce(((t,e,n)=>(t[o[n].field]=e,t)),{}))}else l=N_,u=O_(i),(f=(c=v[l]||(v[l]={}))[s]||(c[s]=[])).push(u),n&&(f=b[s]||(b[s]=[])).push({[N_]:u});return e=e||T_,v[N_]?v[N_]=j_["".concat(N_,"_").concat(e)](...Object.values(v[N_])):Object.keys(v).forEach((t=>{v[t]=Object.keys(v[t]).map((e=>v[t][e])).reduce(((n,r)=>void 0===n?r:j_["".concat(x[t],"_").concat(e)](n,r)))})),y=Object.keys(b),n&&y.length&&(v[r?"vlPoint":"vlMulti"]=e===T_?{or:y.reduce(((t,e)=>(t.push(...b[e]),t)),[])}:{and:y.map((t=>({or:b[t]})))}),v}),U_),Ew("vlSelectionTuples",(function(t,e){return t.map((t=>pt(e.fields?{values:e.fields.map((e=>(e.getter||(e.getter=A(e.field)))(t.datum)))}:{[N_]:O_(t.datum)},e)))}));const Cw=zt(["rule"]),Sw=zt(["group","image","rect"]);function Dw(t){return(t+"").toLowerCase()}function Fw(t,e,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var Tw={operator:(t,e)=>Fw(t,["_"],e.code),parameter:(t,e)=>Fw(t,["datum","_"],e.code),event:(t,e)=>Fw(t,["event"],e.code),handler:(t,e)=>Fw(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const t="o["+Dt(o)+"]";i+="$=".concat(r[o].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(t,e){let n="";return Cw[e]||(t.x2&&(t.x?(Sw[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(Sw[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",Fw(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(Dt).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let o,a;return t.path?(o="a".concat(t.path),a="b".concat(t.path)):((n=n||{})["f"+r]=t,o="this.f".concat(r,"(a)"),a="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function Nw(t,e,n){if(!t||!U(t))return t;for(let r,i=0,o=Ow.length;i<o;++i)if(r=Ow[i],yt(t,r.key))return r.parse(t,e,n);return t}var Ow=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||w("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=Mt(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=g(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=A(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=g(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=it(t.$compare).map((t=>t&&t.$tupleid?Gn:t));return e.fn[n]||(e.fn[n]=st(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>e.detach(o),a}}},{key:"$tupleid",parse:function(){return Gn}}];const zw={skip:!0};function Rw(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||Tw,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Pw(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function Bw(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}Rw.prototype=Pw.prototype={fork(){const t=new Pw(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),"collect"===Dw(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const o in t.data){const r=n.data[o]||(n.data[o]={});t.data[o].forEach((t=>r[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[Dw(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;"operator"!==Dw(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||w("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=L(i)?i.map((t=>Nw(t,n,e))):Nw(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&w("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=U(r=t.source)?r.$ref:r,i=n.get(r),o=t.update,a=void 0;i||w("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(t,i,e,o,a)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],zw)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(D).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const Lw="default";function jw(t,e){const n=t.globalCursor()?"undefined"!=typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function Uw(t,e){var n=t._runtime.data;return yt(n,e)||w("Unrecognized data set: "+e),n[e]}function qw(t,e){nr(e)||w("Second argument to changes must be a changeset.");const n=Uw(this,t);return n.modified=!0,this.pulse(n.input,e)}function Iw(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function Ww(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function $w(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}const Hw="view",Zw={trap:!1};function Yw(t,e,n,r){t._eventListeners.push({type:n,sources:it(e),handler:r})}function Vw(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||U(r)&&!r[n])||(t.warn("Blocked ".concat(e," ").concat(n," event listener.")),!1)}function Gw(t){return t.item}function Xw(t){return t.item.mark.source}function Qw(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function Jw(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}const Kw="vega-bind-radio";function tk(t,e,n,r){const i=n.event||"input",o=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,o),Yw(r,e,i,o),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!=typeof Event?new Event(t):{type:t}}(i))}}function ek(t,e,n,r){const i=r.signal(n.signal),o=Jw("div",{class:"vega-bind"}),a="radio"===n.input?o:o.appendChild(Jw("label"));a.appendChild(Jw("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(o);let s=nk;switch(n.input){case"checkbox":s=rk;break;case"select":s=ik;break;case"radio":s=ok;break;case"range":s=ak}s(t,a,n,i)}function nk(t,e,n,r){const i=Jw("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function rk(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=Jw("input",i);e.appendChild(o),o.addEventListener("change",(()=>t.update(o.checked))),t.elements=[o],t.set=t=>o.checked=!!t||null}function ik(t,e,n,r){const i=Jw("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};sk(t,r)&&(n.selected=!0),i.appendChild(Jw("option",n,(o[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(sk(n.options[e],t))return void(i.selectedIndex=e)}}function ok(t,e,n,r){const i=Jw("span",{class:Kw}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,a)=>{const s={type:"radio",name:n.signal,value:e};sk(e,r)&&(s.checked=!0);const l=Jw("input",s);l.addEventListener("change",(()=>t.update(e)));const u=Jw("label",{},(o[a]||e)+"");return u.prepend(l),i.appendChild(u),l})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)sk(n[t].value,e)&&(n[t].checked=!0)}}function ak(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||(0,Qt.ly)(o,i,100),s=Jw("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const l=Jw("span",{},+r);e.appendChild(s),e.appendChild(l);const u=()=>{l.textContent=s.value,t.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),t.elements=[s],t.set=t=>{s.value=t,l.textContent=t}}function sk(t,e){return t===e||t+""==e+""}function lk(t,e,n,r,i,o){return(e=e||new r(t.loader())).initialize(n,Iw(t),Ww(t),$w(t),i,o).background(t.background())}function uk(t,e){return e?function(){try{e.apply(this,arguments)}catch(e){t.error(e)}}:null}function ck(t,e,n){if("string"==typeof e){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.textContent=""}catch(n){e=null,t.error(n)}return e}const fk=t=>+t||0;function dk(t){return U(t)?{top:fk(t.top),bottom:fk(t.bottom),left:fk(t.left),right:fk(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(fk(t))}async function hk(t,e,n,r){const i=bd(e),o=i&&i.headless;return o||w("Unrecognized renderer type: "+e),await t.runAsync(),lk(t,null,null,o,n,r).renderAsync(t._scenegraph.root)}var pk="width",mk="height",gk="padding",yk={skip:!0};function vk(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===gk?r.left+r.right:0)}function bk(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===gk?r.top+r.bottom:0)}function xk(t,e){return e.modified&&L(e.input.value)&&t.indexOf("_:vega:_")}function _k(t,e){return!("parent"===t||e instanceof Sr.proxy)}function wk(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":L(t)?kk(t):U(t)&&!kt(t)?(e=t,Object.keys(e).map((t=>{const n=e[t];return t+": "+(L(n)?kk(n):Ak(n))})).join("\n")):t+"";var e}(r))}function kk(t){return"["+t.map(Ak).join(", ")+"]"}function Ak(t){return L(t)?"[\u2026]":U(t)&&!kt(t)?"{\u2026}":t}function Ek(t,e){const n=this;if(e=e||{},Er.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=pt({},t.locale,e.locale);n.locale(function(t,e){const n=t?pn(t):mn(),r=e?vn(e):bn();return xn(n,r)}(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||yd.Canvas,n._scenegraph=new Gc;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||wk,n._redraw=!0,n._handler=(new wf).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=pt({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{L(t[e])&&(t[e]=zt(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return function(t,e,n,r){return new Rw(t,e,n,r)}(t,Sr,bw,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:pt({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=vk(n,n._width),n._viewHeight=bk(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e[pk],r=e[mk],i=e[gk];function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=vk(t,e.size),o()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=bk(t,e.size),o()}),{size:r});const a=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:Lw,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const r=e.value,i=r?Et(r)?r:r.user:Lw,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return Et(n)||(r=n.item,n=n.user),jw(t,n&&n!==Lw?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function Mk(t,e){return yt(t._signals,e)?t._signals[e]:w("Unrecognized signal name: "+Dt(e))}function Ck(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function Sk(t,e,n,r){let i=Ck(n,r);return i||(i=uk(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function Dk(t,e,n){const r=Ck(e,n);return r&&e._targets.remove(r),t}xt(Ek,Er,{async evaluate(t,e,n){if(await Er.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=$w(r=this),o=Iw(r),a=Ww(r),r._renderer.background(r.background()),r._renderer.resize(o,a,i),r._handler.origin(i),r._resizeListeners.forEach((t=>{try{t(o,a)}catch(t){r.error(t)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(t){this.error(t)}var r,i,o,a;return n&&Hn(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&Bw(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=Mk(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",dk(t)):dk(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(bd(t)||w("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(Er.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Mk(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(pk,n,yk),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(mk,r,yk),a._resizeHeight.skip(!0)),a._viewWidth!==t&&(a._resize=1,a._viewWidth=t),a._viewHeight!==e&&(a._resize=1,a._viewHeight=e),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=uk(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return Sk(this,t,Mk(this,t),e)},removeSignalListener(t,e){return Dk(this,Mk(this,t),e)},addDataListener(t,e){return Sk(this,t,Uw(this,t).values,e)},removeDataListener(t,e){return Dk(this,Uw(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=jw(this,null);this._globalCursor=!!t,e&&jw(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new Rg.B7,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?(0,Rg.zO)():+n,r._restart((function o(a){a+=i,r._restart(o,i+=e,n),t(a)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,o=new fr(n),a=function(n,r){i.runAsync(null,(()=>{t===Hw&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),o.receive(function(t,e,n){var r,i,o=t._renderer,a=o&&o.canvas();return a&&(i=$w(t),(r=nf(e.changedTouches?e.changedTouches[0]:e,a))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;Et(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:dt(t),item:dt(e||{}),group:i,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}(t,n,r),e}(i,n,r))}))};if("timer"===t)Vw(i,"timer",e)&&i.timer(a,e);else if(t===Hw)Vw(i,"view",e)&&i.addEventListener(e,a,Zw);else if("window"===t?Vw(i,"window",e)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&Vw(i,"selector",e)&&(r=Array.from(document.querySelectorAll(t))),r){for(var s=0,l=r.length;s<l;++s)r[s].addEventListener(e,a);Yw(i,r,e,a)}else i.warn("Can not resolve event source: "+t);return o},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=o.length;--t>=0;)for(e=(n=o[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",Gw),Xw,Qw(t)),this.on(this.events("view","mouseout",Gw),Xw,Qw(e)),this},data:function(t,e){return arguments.length<2?Uw(this,t).values.value:qw.call(this,t,rr().remove(D).insert(e))},change:qw,insert:function(t,e){return qw.call(this,t,rr().insert(e))},remove:function(t,e){return qw.call(this,t,rr().remove(e))},scale:function(t){var e=this._runtime.scales;return yt(e,t)||w("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=bd(r);t=n._el=t?ck(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),Bw(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||wf,s=t?o.renderer:o.headless;return n._renderer=s?lk(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),uk(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,$w(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,a),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=ck(n,e,!0):t.appendChild(Jw("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=ck(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=ht(r.debounce,i.update))),(null==r.input&&r.element?tk:ek)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==yd.Canvas&&t!==yd.SVG&&t!==yd.PNG&&w("Unrecognized image type: "+t);const n=await hk(this,t,e);return t===yd.SVG?function(t,e){const n=new Blob([t],{type:"image/svg+xml"});return window.URL.createObjectURL(n)}(n.svg()):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await hk(this,yd.Canvas,t,e)).canvas()},toSVG:async function(t){return(await hk(this,yd.SVG,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:xk,signals:_k,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this}});const Fk="view",Tk="[",Nk="]",Ok="{",zk="}",Rk=":",Pk=",",Bk="@",Lk=">",jk=/[[\]{}]/,Uk={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let qk,Ik;function Wk(t,e,n){return qk=e||Fk,Ik=n||Uk,Hk(t.trim()).map(Zk)}function $k(t,e,n,r,i){const o=t.length;let a,s=0;for(;e<o;++e){if(a=t[e],!s&&a===n)return e;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return e}function Hk(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=$k(t,i,Pk,Tk+Ok,Nk+zk),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function Zk(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=$k(t,r,Nk,Tk,Nk),r===e)throw"Empty between selector: "+t;if(n=Hk(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if((t=t.slice(r+1).trim())[0]!==Lk)throw"Expected '>' after between selector: "+t;n=n.map(Zk);const i=Zk(t.slice(1).trim());return i.between?{between:n,stream:i}:(i.between=n,i)}(t):function(t){const e={source:qk},n=[];let r,i,o=[0,0],a=0,s=0,l=t.length,u=0;if(t[l-1]===zk){if(u=t.lastIndexOf(Ok),!(u>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(Pk);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!=n)throw t;return n}))}(t.substring(u+1,l-1))}catch(e){throw"Invalid throttle specification: "+t}l=(t=t.slice(0,u).trim()).length,u=0}if(!l)throw t;if(t[0]===Bk&&(a=++u),r=$k(t,u,Rk),r<l&&(n.push(t.substring(s,r).trim()),s=u=++r),u=$k(t,u,Tk),u===l)n.push(t.substring(s,l).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===l)throw"Unmatched left bracket: "+t;for(;u<l;){if(u=$k(t,u,Nk),u===l)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<l-1&&t[++u]!==Tk)throw"Expected left bracket: "+t;s=++u}if(!(l=n.length)||jk.test(n[l-1]))throw"Invalid event selector: "+t;var c;return l>1?(e.type=n[1],a?e.markname=n[0].slice(1):(c=n[0],Ik[c]?e.marktype=n[0]:e.source=n[0])):e.type=n[0],"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1)),null!=i&&(e.filter=i),o[0]&&(e.throttle=o[0]),o[1]&&(e.debounce=o[1]),e}(t)}function Yk(t){return U(t)?t:{type:t||"pad"}}const Vk=t=>+t||0,Gk=t=>({top:t,bottom:t,left:t,right:t});function Xk(t){return U(t)?t.signal?t:{top:Vk(t.top),bottom:Vk(t.bottom),left:Vk(t.left),right:Vk(t.right)}:Gk(Vk(t))}const Qk=t=>U(t)&&!L(t)?pt({},t):{value:t};function Jk(t,e,n,r){return null!=n?(U(n)&&!L(n)||L(n)&&n.length&&U(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1):0}function Kk(t,e,n){for(const r in e)Jk(t,r,e[r]);for(const r in n)Jk(t,r,n[r],"update")}function tA(t,e,n){for(const r in e)n&&yt(n,r)||(t[r]=pt(t[r]||{},e[r]));return t}function eA(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const nA="mark",rA="frame",iA="scope",oA="axis",aA="axis-domain",sA="axis-grid",lA="axis-label",uA="axis-tick",cA="axis-title",fA="legend",dA="legend-band",hA="legend-entry",pA="legend-gradient",mA="legend-label",gA="legend-symbol",yA="legend-title",vA="title",bA="title-text",xA="title-subtitle";function _A(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const wA=t=>Et(t)?Dt(t):t.signal?"(".concat(t.signal,")"):MA(t);function kA(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:Dt(t)));for(;e.length&&null==H(e);)e.pop();return e.unshift(wA(t.gradient)),"gradient(".concat(e.join(","),")")}(t);let e=t.signal?"(".concat(t.signal,")"):t.color?function(t){return t.c?AA("hcl",t.h,t.c,t.l):t.h||t.s?AA("hsl",t.h,t.s,t.l):t.l||t.a?AA("lab",t.l,t.a,t.b):t.r||t.g||t.b?AA("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?MA(t.field):void 0!==t.value?Dt(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=wA(t.scale);return null!=t.range?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(void 0!==e&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(1==+t.band?"":"*"+EA(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),null==e&&(e="0")),e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e="pow(".concat(e,",").concat(EA(t.exponent),")")),null!=t.mult&&(e+="*".concat(EA(t.mult))),null!=t.offset&&(e+="+".concat(EA(t.offset))),t.round&&(e="round(".concat(e,")")),e}const AA=(t,e,n,r)=>"(".concat(t,"(").concat([e,n,r].map(kA).join(","),")+'')");function EA(t){return U(t)?"("+kA(t)+")":t}function MA(t){return CA(U(t)?t:{datum:t})}function CA(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):w("Invalid field reference: "+Dt(t));return t.signal||(r=Et(r)?k(r).map(Dt).join("]["):CA(r)),e+"["+r+"]"}function SA(t,e,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},t=function(t,e,n,r,i){const o={},a={};let s,l,u,c;for(l in l="lineBreak","text"!==e||null==i[l]||eA(l,t)||_A(o,l,i[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===rA?i.group:n===nA?pt({},i.mark,i[e]):null,c)u=eA(l,t)||("fill"===l||"stroke"===l)&&(eA("fill",t)||eA("stroke",t)),u||_A(o,l,c[l]);for(l in it(r).forEach((e=>{const n=i.style&&i.style[e];for(const r in n)eA(r,t)||_A(o,r,n[r])})),t=pt({},t),o)c=o[l],c.signal?(s=s||{})[l]=c:a[l]=c;return t.enter=pt(a,t.enter),s&&(t.update=pt(s,t.update)),t}(t,e,n,r,i.config);for(const s in t)a[s]=DA(t[s],e,o,i);return o}function DA(t,e,n,r){const i={},o={};for(const s in t)null!=t[s]&&(i[s]=FA((a=t[s],L(a)?function(t){let e="";return t.forEach((t=>{const n=kA(t);e+=t.test?"(".concat(t.test,")?").concat(n,":"):n})),":"===H(e)&&(e+="null"),e}(a):kA(a)),r,n,o));var a;return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function FA(t,e,n,r){const i=Mw(t,e);return i.$fields.forEach((t=>r[t]=1)),pt(n,i.$params),i.$expr}const TA="outer",NA=["value","update","init","react","bind"];function OA(t,e){w(t+' for "outer" push: '+Dt(e))}function zA(t,e){const n=t.name;if(t.push===TA)e.signals[n]||OA("No prior signal definition",n),NA.forEach((e=>{void 0!==t[e]&&OA("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function RA(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function PA(t,e,n,r){return new RA(t,e,n,r)}function BA(t,e){return PA("operator",t,e)}function LA(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function jA(t,e){return e?{$field:t,$name:e}:{$field:t}}const UA=jA("key");function qA(t,e){return{$compare:t,$order:e}}function IA(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const WA="scope",$A="view";function HA(t){return t&&t.signal}function ZA(t){if(HA(t))return!0;if(U(t))for(const e in t)if(ZA(t[e]))return!0;return!1}function YA(t,e){return null!=t?t:e}function VA(t){return t&&t.signal||t}const GA="timer";function XA(t,e){return(t.merge?QA:t.stream?JA:t.type?KA:w("Invalid stream specification: "+Dt(t)))(t,e)}function QA(t,e){const n=tE({merge:t.merge.map((t=>XA(t,e)))},t,e);return e.addStream(n).id}function JA(t,e){const n=tE({stream:XA(t.stream,e)},t,e);return e.addStream(n).id}function KA(t,e){let n;var r;t.type===GA?(n=e.event(GA,t.throttle),t={between:t.between,filter:t.filter}):n=e.event((r=t.source)===WA?$A:r||$A,t.type);const i=tE({stream:n},t,e);return 1===Object.keys(i).length?n:e.addStream(i).id}function tE(t,e,n){let r=e.between;return r&&(2!==r.length&&w('Stream "between" parameter must have 2 entries: '+Dt(e)),t.between=[XA(r[0],n),XA(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===WA&&r.push("inScope(event.item)"),r.length&&(t.filter=Mw("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const eE={code:"_.$value",ast:{type:"Identifier",value:"value"}};function nE(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const rE=t=>(e,n,r)=>PA(t,n,e||void 0,r),iE=rE("aggregate"),oE=rE("axisticks"),aE=rE("bound"),sE=rE("collect"),lE=rE("compare"),uE=rE("datajoin"),cE=rE("encode"),fE=rE("expression"),dE=rE("facet"),hE=rE("field"),pE=rE("key"),mE=rE("legendentries"),gE=rE("load"),yE=rE("mark"),vE=rE("multiextent"),bE=rE("multivalues"),xE=rE("overlap"),_E=rE("params"),wE=rE("prefacet"),kE=rE("projection"),AE=rE("proxy"),EE=rE("relay"),ME=rE("render"),CE=rE("scale"),SE=rE("sieve"),DE=rE("sortitems"),FE=rE("viewlayout"),TE=rE("values");let NE=0;const OE={min:"min",max:"max",count:"sum"};function zE(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=LE(t.domain,t,e),null!=t.range&&(n.range=ZE(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=RE(t.type||t),null!=t.gamma&&(e.interpolateGamma=RE(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=U(i=t.nice)?{interval:RE(i.interval),step:RE(i.step)}:RE(i)),null!=t.bins&&(n.bins=function(t,e){return t.signal||L(t)?PE(t,e):e.objectProperty(t)}(t.bins,e)),t)yt(n,r)||"name"===r||(n[r]=RE(t[r],e));var i}function RE(t,e){return U(t)?t.signal?e.signalRef(t.signal):w("Unsupported object: "+Dt(t)):t}function PE(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>RE(t,e)))}function BE(t){w("Can not find data set: "+Dt(t))}function LE(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(L(t)?jE:t.fields?qE:UE)(t,e,n);null==e.domainMin&&null==e.domainMax||w("No scale domain defined for domainMin/domainMax to override.")}function jE(t,e,n){return t.map((t=>RE(t,n)))}function UE(t,e,n){const r=n.getData(t.data);return r||BE(t.data),ys(e.type)?r.valuesRef(n,t.field,WE(t.sort,!1)):_s(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function qE(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=Et(e)?{data:r,field:e}:L(e)||e.signal?function(t,e){const n="_:vega:_"+NE++,r=sE({});if(L(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+Dt(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,SE({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(ys(e.type)?IE:_s(e.type)?$E:HE)(t,n,i)}function IE(t,e,n){const r=WE(t.sort,!0);let i,o;const a=n.map((t=>{const n=e.getData(t.data);return n||BE(t.data),n.countsRef(e,t.field,r)})),s={groupby:UA,pulse:a};r&&(i=r.op||"count",o=r.field?IA(i,r.field):"count",s.ops=[OE[i]],s.fields=[e.fieldRef(o)],s.as=[o]),i=e.add(iE(s));const l=e.add(sE({pulse:LA(i)}));return o=e.add(TE({field:UA,sort:e.sortRef(r),pulse:LA(l)})),LA(o)}function WE(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!OE[t.op]&&w("Multiple domain scales can not be sorted using "+t.op):w("No field provided for sort aggregate op: "+t.op):U(t)?t.field="key":t={field:"key"}),t}function $E(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||BE(t.data),n.domainRef(e,t.field)}));return LA(e.add(bE({values:r})))}function HE(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||BE(t.data),n.extentRef(e,t.field)}));return LA(e.add(vE({extents:r})))}function ZE(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(Et(i)){if(r&&yt(r,i))return ZE(t=pt({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=ys(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:w("Unrecognized scale range value: "+Dt(i))}else{if(i.scheme)return n.scheme=L(i.scheme)?PE(i.scheme,e):RE(i.scheme,e),i.extent&&(n.schemeExtent=PE(i.extent,e)),void(i.count&&(n.schemeCount=RE(i.count,e)));if(i.step)return void(n.rangeStep=RE(i.step,e));if(ys(t.type)&&!L(i))return LE(i,t,e);L(i)||w("Unsupported range type: "+Dt(i))}return i.map((t=>(L(t)?PE:RE)(t,e)))}function YE(t,e,n){return L(t)?t.map((t=>YE(t,e,n))):U(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:w("Unsupported parameter object: "+Dt(t)):t}const VE="top",GE="left",XE="right",QE="bottom",JE="center",KE="vertical",tM="start",eM="end",nM="index",rM="label",iM="offset",oM="perc",aM="perc2",sM="value",lM="guide-label",uM="guide-title",cM="group-title",fM="group-subtitle",dM="symbol",hM="gradient",pM="discrete",mM="size",gM=[mM,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],yM={name:1,style:1,interactive:1},vM={value:0},bM={value:1},xM="group",_M="rect",wM="rule",kM="symbol",AM="text";function EM(t){return t.type=xM,t.interactive=t.interactive||!1,t}function MM(t,e){const n=(n,r)=>YA(t[n],YA(e[n],r));return n.isVertical=n=>KE===YA(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>YA(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>YA(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>YA(t.columns,YA(e.columns,+n.isVertical(!0))),n}function CM(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function SM(t,e,n){return"item.anchor === '".concat(tM,"' ? ").concat(t," : item.anchor === '").concat(eM,"' ? ").concat(e," : ").concat(n)}const DM=SM(Dt(GE),Dt(XE),Dt(JE));function FM(t,e){return e?t?U(t)?Object.assign({},t,{offset:FM(t.offset,e)}):{value:t,offset:e}:e:t}function TM(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=tA(t.encode,e,yM)):t.interactive=!1,t}function NM(t,e,n,r){const i=MM(t,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let l,u,c,f,d;o?(u=[0,1],c=[0,0],f=a,d=s):(u=[0,0],c=[1,0],f=s,d=a);const h={enter:l={opacity:vM,x:vM,y:vM,width:Qk(f),height:Qk(d)},update:pt({},l,{opacity:bM,fill:{gradient:e,start:u,stop:c}}),exit:{opacity:vM}};return Kk(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),TM({type:_M,role:pA,encode:h},r)}function OM(t,e,n,r,i){const o=MM(t,n),a=o.isVertical(),s=o.gradientThickness(),l=o.gradientLength();let u,c,f,d,h="";a?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:vM,fill:{scale:e,field:sM}};p[u]={signal:h+"datum."+oM,mult:l},p[c]=vM,p[f]={signal:h+"datum."+aM,mult:l},p[d]=Qk(s);const m={enter:p,update:pt({},p,{opacity:bM}),exit:{opacity:vM}};return Kk(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),TM({type:_M,role:dA,key:sM,from:i,encode:m},r)}const zM="datum.".concat(oM,'<=0?"').concat(GE,'":datum.').concat(oM,'>=1?"').concat(XE,'":"').concat(JE,'"'),RM="datum.".concat(oM,'<=0?"').concat(QE,'":datum.').concat(oM,'>=1?"').concat(VE,'":"middle"');function PM(t,e,n,r){const i=MM(t,e),o=i.isVertical(),a=Qk(i.gradientThickness()),s=i.gradientLength();let l,u,c,f,d=i("labelOverlap"),h="";const p={enter:l={opacity:vM},update:u={opacity:bM,text:{field:rM}},exit:{opacity:vM}};return Kk(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:YA(t.labelLimit,e.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=u.baseline={signal:RM},c="y",f="x",h="1-"):(l.align=u.align={signal:zM},l.baseline={value:"top"},c="x",f="y"),l[c]=u[c]={signal:h+"datum."+oM,mult:s},l[f]=u[f]=a,a.offset=YA(t.labelOffset,e.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+nM}:void 0,TM({type:AM,role:mA,style:lM,key:sM,from:r,encode:p,overlap:d},n)}function BM(t,e,n,r,i){const o=MM(t,e),a=n.entries,s=!(!a||!a.interactive),l=a?a.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(iM," : datum.").concat(mM),h=u?Qk(u):{field:mM},p="datum.".concat(nM),m="max(1, ".concat(i,")");let g,y,v,b,x;h.mult=.5,g={enter:y={opacity:vM,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:bM,x:y.x,y:y.y},exit:{opacity:vM}};let _=null,w=null;t.fill||(_=e.symbolBaseFillColor,w=e.symbolBaseStrokeColor),Kk(g,{fill:o("symbolFillColor",_),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",w),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),gM.forEach((e=>{t[e]&&(v[e]=y[e]={scale:t[e],field:sM})}));const k=TM({type:kM,role:gA,key:sM,from:f,clip:!!u||void 0,encode:g},n.symbols),A=Qk(c);A.offset=o("labelOffset"),g={enter:y={opacity:vM,x:{signal:d,offset:A},y:h},update:v={opacity:bM,text:{field:rM},x:y.x,y:y.y},exit:{opacity:vM}},Kk(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const E=TM({type:AM,role:mA,style:lM,key:sM,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:vM,height:u?Qk(u):vM,opacity:vM},exit:{opacity:vM},update:v={opacity:bM,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(m,")"),v.row.signal="".concat(p,"%").concat(b),v.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(v.row.signal="floor(".concat(p," / ").concat(m,")"),v.column.signal="".concat(p," % ").concat(m),x={field:p}),v.column.signal="(".concat(i,")?").concat(v.column.signal,":").concat(p),EM({role:iA,from:r={facet:{data:r,name:"value",groupby:nM}},encode:tA(g,a,yM),marks:[k,E],name:l,interactive:s,sort:x})}const LM='item.orient === "left"',jM='item.orient === "right"',UM="(".concat(LM," || ").concat(jM,")"),qM="datum.vgrad && ".concat(UM),IM=SM('"top"','"bottom"','"middle"'),WM="datum.vgrad && ".concat(jM," ? (").concat(SM('"right"','"left"','"center"'),") : (").concat(UM," && !(datum.vgrad && ").concat(LM,')) ? "left" : ').concat(DM),$M="item._anchor || (".concat(UM,' ? "middle" : "start")'),HM="".concat(qM," ? (").concat(LM," ? -90 : 90) : 0"),ZM="".concat(UM," ? (datum.vgrad ? (").concat(jM,' ? "bottom" : "top") : ').concat(IM,') : "top"');function YM(t,e){let n;return U(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+VM(t.path)+")":t.sphere&&(n="geoShape("+VM(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function VM(t){return U(t)&&t.signal?t.signal:Dt(t)}function GM(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===xM?iA:e||nA:e}function XM(t){return{marktype:t.type,name:t.name||void 0,role:t.role||GM(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function QM(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function JM(t,e){const n=function(t){const e=function(t){return t=t&&t.toLowerCase(),yt(Sr,t)?Sr[t]:null}(t);return e&&e.Definition||null}(t.type);n||w("Unrecognized transform type: "+Dt(t.type));const r=PA(n.type.toLowerCase(),null,KM(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function KM(t,e,n){const r={},i=t.params.length;for(let o=0;o<i;++o){const i=t.params[o];r[i.name]=tC(i,e,n)}return r}function tC(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){return Et(e.from)||w('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(L(r)||w("Expected an array of sub-parameters. Instead: "+Dt(r)),r.map((e=>nC(t,e,n)))):nC(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!HA(i)?i.map((e=>eC(t,e,n))):eC(t,i,n):void(t.required&&w("Missing required "+Dt(e.type)+" parameter: "+Dt(t.name)))}function eC(t,e,n){const r=t.type;if(HA(e))return aC(r)?w("Expression references can not be signals."):sC(r)?n.fieldRef(e):lC(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||sC(r);return i&&rC(e)?n.exprRef(e.expr,e.as):i&&iC(e)?jA(e.field,e.as):aC(r)?Mw(e,n):oC(r)?LA(n.getData(e).values):sC(r)?jA(e):lC(r)?n.compareRef(e):e}}function nC(t,e,n){const r=t.params.length;let i;for(let a=0;a<r;++a){i=t.params[a];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||w("Unsupported parameter: "+Dt(e));const o=pt(KM(i,e,n),i.key);return LA(n.add(_E(o)))}const rC=t=>t&&t.expr,iC=t=>t&&t.field,oC=t=>"data"===t,aC=t=>"expr"===t,sC=t=>"field"===t,lC=t=>"compare"===t;function uC(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:LA(e.getData(t.data).output)}function cC(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function fC(t){return Et(t)?t:null}function dC(t,e,n){const r=IA(n.op,n.field);let i;if(e.ops){for(let o=0,a=e.as.length;o<a;++o)if(e.as[o]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function hC(t,e,n,r,i,o,a){const s=e[n]||(e[n]={}),l=function(t){return U(t)?("descending"===t.order?"-":"+")+IA(t.op,t.field):""}(o);let u,c,f=fC(i);if(null!=f&&(t=e.scope,f+=l?"|"+l:"",u=s[f]),!u){const n=o?{field:UA,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:LA(e.output)};l&&(n.sort=t.sortRef(o)),c=t.add(PA(r,void 0,n)),a&&(e.index[i]=c),u=LA(c),null!=f&&(s[f]=u)}return u}function pC(t,e,n){const r=t.remove,i=t.insert,o=t.toggle,a=t.modify,s=t.values,l=e.add(BA()),u=Mw("if("+t.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((t=>null==t?"null":t)).join(",")+"),0)",e);l.update=u.$expr,l.params=u.$params}function mC(t,e){const n=GM(t),r=t.type===xM,i=t.from&&t.from.facet,o=t.overlap;let a,s,l,u,c,f,d,h=t.layout||n===iA||n===rA;const p=n===nA||h||i,m=function(t,e,n){let r,i,o,a,s;return t?(r=t.facet)&&(e||w("Only group marks can be faceted."),null!=r.field?a=s=uC(r,n):(t.data?s=LA(n.getData(t.data).aggregate):(o=JM(pt({type:"aggregate",groupby:it(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=uC(r,n),a=s=LA(n.add(o))),i=n.keyRef(r.groupby,!0))):a=LA(n.add(sE(null,[{}]))),a||(a=uC(t,n)),{key:i,pulse:a,parent:s}}(t.from,r,e);s=e.add(uE({key:m.key||(t.key?jA(t.key):void 0),pulse:m.pulse,clean:!r}));const g=LA(s);s=l=e.add(sE({pulse:g})),s=e.add(yE({markdef:XM(t),interactive:QM(t.interactive,e),clip:YM(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:LA(s)}));const y=LA(s);s=u=e.add(cE(SA(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=JM(t,e),r=n.metadata;(r.generates||r.changes)&&w("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=LA(s),e.add(s=n)})),t.sort&&(s=e.add(DE({sort:e.compareRef(t.sort),pulse:LA(s)})));const v=LA(s);(i||h)&&(h=e.add(FE({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),f=LA(h));const b=e.add(aE({mark:y,pulse:f||v}));d=LA(b),r&&(p&&(a=e.operators,a.pop(),h&&a.pop()),e.pushState(v,f||d,g),i?function(t,e,n){const r=t.from.facet,i=r.name,o=uC(r,e);let a;r.name||w("Facet must have a name: "+Dt(r)),r.data||w("Facet must reference a data set: "+Dt(r)),r.field?a=e.add(wE({field:e.fieldRef(r.field),pulse:o})):r.groupby?a=e.add(dE({key:e.keyRef(r.groupby),group:LA(e.proxy(n.parent)),pulse:o})):w("Facet must specify groupby or field: "+Dt(r));const s=e.fork(),l=s.add(sE()),u=s.add(SE({pulse:LA(l)}));s.addData(i,new cC(s,l,l,u)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(t).toRuntime()}}(t,e,m):p?function(t,e,n){const r=e.add(wE({pulse:n.pulse})),i=e.fork();i.add(SE()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,m):e.parse(t),e.popState(),p&&(h&&a.push(h),a.push(b))),o&&(d=function(t,e,n){const r=t.method,i=t.bound,o=t.separation,a={separation:HA(o)?n.signalRef(o.signal):o,method:HA(r)?n.signalRef(r.signal):r,pulse:e};if(t.order&&(a.sort=n.compareRef({field:t.order})),i){const t=i.tolerance;a.boundTolerance=HA(t)?n.signalRef(t.signal):+t,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return LA(n.add(xE(a)))}(o,d,e));const x=e.add(ME({pulse:d})),_=e.add(SE({pulse:LA(x)},void 0,e.parent()));null!=t.name&&(c=t.name,e.addData(c,new cC(e,l,x,_)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&w("Marks only support modify triggers."),pC(t,e,c)})))}function gC(t,e,n){const r={enter:{},update:{}};return Kk(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function yC(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):CM(t,n[0].encode)}cC.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let o=e[0],a=null,s=1;for(o&&"load"===o.type&&(o=e[1]),t.add(e[0]);s<n;++s)e[s].params.pulse=LA(e[s-1]),t.add(e[s]),"aggregate"===e[s].type&&(a=e[s]);return new cC(t,o,i,r,a)},cC.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),o=fC(e);let a,s,l;return null!=o&&(t=r.scope,a=i[o]),a?n&&n.field&&dC(t,a.agg.params,n):(l={groupby:t.fieldRef(e,"key"),pulse:LA(r.output)},n&&n.field&&dC(t,l,n),s=t.add(iE(l)),a=t.add(sE({pulse:LA(s)})),a={agg:s,ref:LA(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef(){return LA(this.values)},extentRef(t,e){return hC(t,this,"extent","extent",e,!1)},domainRef(t,e){return hC(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return hC(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return hC(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return hC(t,this,"indata","tupleindex",e,!0,!0)}};const vC='item.orient==="'.concat(GE,'"?-90:item.orient==="').concat(XE,'"?90:0');function bC(t,e){const n={enter:{},update:{}};return Kk(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:DM},angle:{signal:vC},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),tA(n,e,yM)}function xC(t){const e=sE({},t);return e.metadata={source:!0},e}function _C(t,e){return gE({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const wC=t=>t===QE||t===VE,kC=(t,e,n)=>HA(t)?FC(t.signal,e,n):t===GE||t===VE?e:n,AC=(t,e,n)=>HA(t)?SC(t.signal,e,n):wC(t)?e:n,EC=(t,e,n)=>HA(t)?DC(t.signal,e,n):wC(t)?n:e,MC=(t,e,n)=>HA(t)?TC(t.signal,e,n):t===VE?{value:e}:{value:n},CC=(t,e,n)=>HA(t)?NC(t.signal,e,n):t===XE?{value:e}:{value:n},SC=(t,e,n)=>OC("".concat(t," === '").concat(VE,"' || ").concat(t," === '").concat(QE,"'"),e,n),DC=(t,e,n)=>OC("".concat(t," !== '").concat(VE,"' && ").concat(t," !== '").concat(QE,"'"),e,n),FC=(t,e,n)=>RC("".concat(t," === '").concat(GE,"' || ").concat(t," === '").concat(VE,"'"),e,n),TC=(t,e,n)=>RC("".concat(t," === '").concat(VE,"'"),e,n),NC=(t,e,n)=>RC("".concat(t," === '").concat(XE,"'"),e,n),OC=(t,e,n)=>(e=null!=e?Qk(e):e,n=null!=n?Qk(n):n,zC(e)&&zC(n)?{signal:"".concat(t," ? (").concat(e=e?e.signal||Dt(e.value):null,") : (").concat(n=n?n.signal||Dt(n.value):null,")")}:[pt({test:t},e)].concat(n||[])),zC=t=>null==t||1===Object.keys(t).length,RC=(t,e,n)=>({signal:"".concat(t," ? (").concat(BC(e),") : (").concat(BC(n),")")}),PC=(t,e,n,r,i)=>({signal:(null!=r?"".concat(t," === '").concat(GE,"' ? (").concat(BC(r),") : "):"")+(null!=n?"".concat(t," === '").concat(QE,"' ? (").concat(BC(n),") : "):"")+(null!=i?"".concat(t," === '").concat(XE,"' ? (").concat(BC(i),") : "):"")+(null!=e?"".concat(t," === '").concat(VE,"' ? (").concat(BC(e),") : "):"")+"(null)"}),BC=t=>HA(t)?t.signal:null==t?null:Dt(t),LC=(t,e)=>0===e?0:HA(t)?{signal:"(".concat(t.signal,") * ").concat(e)}:{value:t*e},jC=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function UC(t,e,n,r){let i;if(e&&yt(e,t))return e[t];if(yt(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[uM][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[lM][i]}return null}function qC(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function IC(t,e){return{scale:t.scale,range:e}}function WC(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function $C(t,e){const n={enter:{},update:{}};return Kk(n,{orient:t("orient"),offset:t("offset")||0,position:YA(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function HC(t,e,n){const r=it(t.signals),i=it(t.scales);return n||r.forEach((t=>zA(t,e))),it(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=YE(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=YE(n[i],i,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";ps(n)||w("Unrecognized scale type: "+Dt(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),it(t.data).forEach((t=>function(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(JM(t,e))})),t.on&&t.on.forEach((n=>{pC(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,o,a,s,l,u=null,c=!1,f=!1;for(t.values?HA(t.values)||ZA(t.format)?(r.push(_C(e,t)),r.push(u=xC())):r.push(u=xC({$ingest:t.values,$format:t.format})):t.url?ZA(t.url)||ZA(t.format)?(r.push(_C(e,t)),r.push(u=xC())):r.push(u=xC({$request:t.url,$format:t.format})):t.source&&(u=i=it(t.source).map((t=>LA(e.getData(t).output))),r.push(null)),o=0,a=n.length;o<a;++o)s=n[o],l=s.metadata,u||l.source||r.push(u=xC()),r.push(s),l.generates&&(f=!0),l.modifies&&!f&&(c=!0),l.source?u=s:l.changes&&(u=null);return i&&(a=i.length-1,r[0]=EE({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,xC())),u||r.push(xC()),r.push(SE({})),r}(t,e,n))}(t,e))),i.forEach((t=>zE(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?w("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=Mw(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>function(t,e,n){const r=t.encode,i={target:n};let o=t.events,a=t.update,s=[];o||w("Signal update missing events specification."),Et(o)&&(o=Wk(o,e.isSubscope()?WA:$A)),o=it(o).filter((t=>t.signal||t.scale?(s.push(t),0):1)),s.length>1&&(s=[nE(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&w("Signal encode and update are mutually exclusive."),a="encode(item(),"+Dt(r)+")"),i.update=Et(a)?Mw(a,e):null!=a.expr?Mw(a.expr,e):null!=a.value?a.value:null!=a.signal?{$expr:eE,$params:{$value:e.signalRef(a.signal)}}:w("Invalid signal update specification."),t.force&&(i.options={force:!0}),s.forEach((t=>e.addUpdate(pt(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):XA(t,e)}}(t,e),i))))}(t,e,n.id)))}(t,e))),it(t.axes).forEach((t=>function(t,e){const n=function(t,e){var n,r,i,o=e.config,a=o.style,s=o.axis,l="band"===e.scaleType(t.scale)&&o.axisBand,u=t.orient;if(HA(u)){const t=qC([o.axisX,o.axisY]),e=qC([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},t))n[i]=AC(u,UC(i,o.axisX,s,a),UC(i,o.axisY,s,a));for(i of(r={},e))r[i]=PC(u.signal,UC(i,o.axisTop,s,a),UC(i,o.axisBottom,s,a),UC(i,o.axisLeft,s,a),UC(i,o.axisRight,s,a))}else n=u===VE||u===QE?o.axisX:o.axisY,r=o["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||l?pt({},s,n,r,l):s}(t,e),r=t.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,l=MM(t,n),u=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(e.signal,") === 'extent'")},U(i)||(i={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(l),c={scale:t.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=t.title},f=LA(e.add(sE({},[c]))),d=LA(e.add(oE({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),h=[];let p;return c.grid&&h.push(function(t,e,n,r,i){const o=MM(t,e),a=t.orient,s=t.gridScale,l=kC(a,1,-1),u=function(t,e){if(1===e);else if(U(t)){let n=t=pt({},t);for(;null!=n.mult;){if(!U(n.mult))return n.mult=HA(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n=n.mult=pt({},n.mult)}n.mult=e}else t=HA(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);return t}(t.offset,l);let c,f,d;const h={enter:c={opacity:vM},update:d={opacity:bM},exit:f={opacity:vM}};Kk(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:sM,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=AC(a,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:l,offset:u}:{value:0,offset:u},y=s?{scale:s,range:1,mult:l,offset:u}:pt(m,{mult:l,offset:u});return c.x=d.x=AC(a,p,g),c.y=d.y=EC(a,p,g),c.x2=d.x2=EC(a,y),c.y2=d.y2=AC(a,y),f.x=AC(a,p),f.y=EC(a,p),TM({type:wM,role:sA,key:sM,from:r,encode:h},n)}(t,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(function(t,e,n,r,i,o){const a=MM(t,e),s=t.orient,l=kC(s,-1,1);let u,c,f;const d={enter:u={opacity:vM},update:f={opacity:bM},exit:c={opacity:vM}};Kk(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=Qk(i);h.mult=l;const p={scale:t.scale,field:sM,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=u.y=AC(s,vM,p),f.y2=u.y2=AC(s,h),c.x=AC(s,p),f.x=u.x=EC(s,vM,p),f.x2=u.x2=EC(s,h),c.y=EC(s,p),TM({type:wM,role:uA,key:sM,from:r,encode:d},n)}(t,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(function(t,e,n,r,i,o){const a=MM(t,e),s=t.orient,l=t.scale,u=kC(s,-1,1),c=VA(a("labelFlush")),f=VA(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p,m=0===c||!!c;const g=Qk(i);g.mult=u,g.offset=Qk(a("labelPadding")||0),g.offset.mult=u;const y={scale:l,field:sM,band:.5,offset:FM(o.offset,a("labelOffset"))},v=AC(s,m?WC(l,c,'"left"','"right"','"center"'):{value:"center"},CC(s,"left","right")),b=AC(s,MC(s,"bottom","top"),m?WC(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=WC(l,c,"-(".concat(f,")"),f,0);m=m&&f;const _={opacity:vM,x:AC(s,y,g),y:EC(s,y,g)},w={enter:_,update:p={opacity:bM,text:{field:rM},x:_.x,y:_.y,align:v,baseline:b},exit:{opacity:vM,x:_.x,y:_.y}};Kk(w,{dx:!d&&m?AC(s,x):null,dy:!h&&m?EC(s,x):null}),Kk(w,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const k=a("labelBound");let A=a("labelOverlap");return A=A||k?{separation:a("labelSeparation"),method:A,order:"datum.index",bound:k?{scale:l,orient:s,tolerance:k}:null}:void 0,p.align!==v&&(p.align=jC(p.align,v)),p.baseline!==b&&(p.baseline=jC(p.baseline,b)),TM({type:AM,role:lA,style:lM,key:sM,from:r,encode:w,overlap:A},n)}(t,n,r.labels,d,p,u))),c.domain&&h.push(function(t,e,n,r){const i=MM(t,e),o=t.orient;let a,s;const l={enter:a={opacity:vM},update:s={opacity:bM},exit:{opacity:vM}};Kk(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=IC(t,0),c=IC(t,1);return a.x=s.x=AC(o,u,vM),a.x2=s.x2=AC(o,c),a.y=s.y=EC(o,u,vM),a.y2=s.y2=EC(o,c),TM({type:wM,role:aA,from:r,encode:l},n)}(t,n,r.domain,f)),c.title&&h.push(function(t,e,n,r){const i=MM(t,e),o=t.orient,a=kC(o,-1,1);let s,l;const u={enter:s={opacity:vM,anchor:Qk(i("titleAnchor",null)),align:{signal:DM}},update:l=pt({},s,{opacity:bM,text:Qk(t.title)}),exit:{opacity:vM}},c={signal:'lerp(range("'.concat(t.scale,'"), ').concat(SM(0,1,.5),")")};return l.x=AC(o,c),l.y=EC(o,c),s.angle=AC(o,vM,LC(a,90)),s.baseline=AC(o,MC(o,QE,VE),{value:QE}),l.angle=s.angle,l.baseline=s.baseline,Kk(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=jC(Qk(t),n.update[e]),!1):!eA(e,r),o=i(t("titleX"),"x"),a=i(t("titleY"),"y");n.enter.auto=a===o?Qk(a):AC(e,Qk(a),Qk(o))}(i,o,u,n),u.update.align=jC(u.update.align,s.align),u.update.angle=jC(u.update.angle,s.angle),u.update.baseline=jC(u.update.baseline,s.baseline),TM({type:AM,role:cA,style:uM,from:r,encode:u},n)}(t,n,r.title,f)),mC(EM({role:oA,from:f,encode:tA($C(l,t),i,yM),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:a,style:s}),e)}(t,e))),it(t.marks).forEach((t=>mC(t,e))),it(t.legends).forEach((t=>function(t,e){const n=e.config.legend,r=t.encode||{},i=MM(t,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,l=o.style,u={};let c,f,d,h=0;gM.forEach((e=>t[e]?(u[e]=t[e],h=h||t[e]):0)),h||w("Missing valid scale for legend.");const p=function(t,e){let n=t.type||dM;return t.type||1!==function(t){return gM.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=gs(e)?hM:vs(e)?pM:dM),n!==hM?n:vs(e)?pM:hM}(t,e.scaleType(h)),m={title:null!=t.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=LA(e.add(sE(null,[m]))),y=LA(e.add(mE(f={type:p,scale:e.scaleRef(h),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===hM?(d=[NM(t,h,n,r.gradient),PM(t,n,r.labels,y)],f.count=f.count||e.signalRef("max(2,2*floor((".concat(VA(i.gradientLength()),")/100))"))):p===pM?d=[OM(t,h,n,r.gradient,y),PM(t,n,r.labels,y)]:(c=function(t,e){const n=MM(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),d=[BM(t,n,r,y,VA(c.columns))],f.size=function(t,e,n){const r=VA(yC("size",t,n)),i=VA(yC("strokeWidth",t,n)),o=VA(function(t,e,n){return CM("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r.fontSize}(0,e,n)}(n[1].encode,e,lM));return Mw("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(o,")"),e)}(t,e,d[0].marks)),d=[EM({role:hA,from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],m.title&&d.push(function(t,e,n,r){const i=MM(t,e),o={enter:{opacity:vM},update:{opacity:bM,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:vM}};return Kk(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:$M},angle:{signal:HM},align:{signal:WM},baseline:{signal:ZM},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),TM({type:AM,role:yA,style:uM,from:r,encode:o},n)}(t,n,r.title,g)),mC(EM({role:fA,from:g,encode:tA(gC(i,t,n),o,yM),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:l}),e)}(t,e))),t.title&&function(t,e){const n=MM(t=Et(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,l=[],u=LA(e.add(sE(null,[{}])));l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Kk(o,{text:t.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),TM({type:AM,role:bA,style:cM,from:r,encode:o},n)}(t,n,function(t){const e=t.encode;return e&&e.title||pt({name:t.name,interactive:t.interactive,style:t.style},e)}(t),u)),t.subtitle&&l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Kk(o,{text:t.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),TM({type:AM,role:xA,style:fM,from:r,encode:o},n)}(t,n,r.subtitle,u)),mC(EM({role:vA,from:u,encode:bC(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),e)}(t.title,e),e.parseLambdas(),e}function ZC(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function YC(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function VC(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function GC(t){return(L(t)?XC:QC)(t)}function XC(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(U(e)?e.signal||GC(e):Dt(e))}return n+"]"}function QC(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+Dt(e)+":"+(U(n)?n.signal||GC(n):Dt(n));return r+"}"}function JC(t){return e=this,r=function*(){const e=function(t,e,n){return U(t)||w("Input Vega specification must be an object."),function(t,e){const n=e.config,r=LA(e.root=e.add(BA())),i=function(t,e){const n=n=>YA(t[n],e[n]),r=[ZC("background",n("background")),ZC("autosize",Yk(n("autosize"))),ZC("padding",Xk(n("padding"))),ZC("width",n("width")||0),ZC("height",n("height")||0)],i=r.reduce(((t,e)=>(t[e.name]=e,t)),{}),o={};return it(t.signals).forEach((t=>{yt(i,t.name)?t=pt(i[t.name],t):r.push(t),o[t.name]=t})),it(e.signals).forEach((t=>{yt(o,t.name)||yt(i,t.name)||r.push(t)})),r}(t,n);i.forEach((t=>zA(t,e))),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const o=e.add(sE()),a=e.add(cE(SA((t=>tA({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t))(t.encode),xM,rA,t.style,e,{pulse:LA(o)}))),s=e.add(FE({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:LA(a)}));e.operators.pop(),e.pushState(LA(a),LA(s),null),HC(t,e,i),e.operators.push(s);let l=e.add(aE({mark:r,pulse:LA(s)}));return l=e.add(ME({pulse:LA(l)})),l=e.add(SE({pulse:LA(l)})),e.addData("root",new cC(e,o,o,l)),e}(t,new YC(e=I(function(){const t="sans-serif",e="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:e},area:{fill:e},image:null,line:{stroke:e,strokeWidth:2},path:{stroke:e},rect:{fill:e},rule:{stroke:n},shape:{stroke:e},symbol:{fill:e,size:64},text:{fill:n,font:t,fontSize:11},trail:{fill:e,size:2},style:{"guide-label":{fill:n,font:t,fontSize:10},"guide-title":{fill:n,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),e,t.config),void 0)).toRuntime()}(t);return yield new Ek(e).renderer("svg").hover().runAsync()},new((n=void 0)||(n=Promise))((function(t,i){function o(t){try{s(r.next(t))}catch(t){i(t)}}function a(t){try{s(r.throw(t))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(e.value).then(o,a)}s((r=r.apply(e,[])).next())}));var e,n,r}function KC(t){return t.scenegraph().root.items[0]}function tS(t){return t.filter(((e,n)=>{const r=JSON.stringify(e);return n===t.findIndex((t=>JSON.stringify(t)===r))}))}function eS(t,e){let n=[];const r=["cell","axis-grid"];return void 0===t.items||t.items.forEach((t=>{void 0!==t.role&&t.role===e&&nS(t,r)?n.push(t):n=n.concat(eS(t,e))})),n}function nS(t,e){return void 0===t.role||e.some((e=>t.role.includes(e)))?void 0===t.role&&void 0!==t.items?t.items.every((t=>nS(t,e))):void 0===t.role&&void 0===t.items:!(!t.items.every((t=>nS(t,e)))&&void 0!==t.items)}function rS(t){try{const e=t.context.data,n=Object.keys(e).filter((t=>t.match(/data_\d/)));if(n.length)return n.map((t=>e[t].values.value)).filter(((t,e,n)=>!!t.length&&0!==Object.keys(t[0]).length&&n.findLastIndex((e=>Object.keys(e[0]).every((e=>Object.keys(t[0]).includes(e)))))===e));{const t=Object.keys(e).filter((t=>t.match(/(source)|(data)_\d/))),n=t[t.length-1];return[e[n].values.value]}}catch(t){throw new Error("No data found in the Vega scenegraph \n ".concat(t))}}function iS(t){const e=oS(t,"axis-tick");return e.length?e.map((t=>t.items.map((t=>t.datum.value)))):null}function oS(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return"role"in t?(t.role===e&&n.push(t),t.items.reduce(((t,n)=>oS(n,e,t)),n)):"items"in t?t.items.reduce(((t,n)=>oS(n,e,t)),n):n}YC.prototype=VC.prototype={parse(t){return HC(t,this)},fork(){return new VC(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof RA?LA(t):t;return this.add(AE({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(LA(this.add(SE({pulse:t})))),this._parent.push(e),this._lookup.push(n?LA(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return H(this._parent)},encode(){return H(this._encode)},lookup(){return H(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(Et(t))return jA(t,e);t.signal||w("Unsupported field reference: "+Dt(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=LA(this.add(hE(t)))}return r},compareRef(t){let e=!1;const n=t=>HA(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=it(t.field).map(n),i=it(t.order).map(n);return e?LA(this.add(lE({fields:r,orders:i}))):qA(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=it(t).map((t=>HA(t)?(n=!0,LA(r[t.signal])):t)),n?LA(this.add(pE({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=IA(t.op,t.field),n=t.order||"ascending";return n.signal?LA(this.add(lE({fields:e,orders:this.signalRef(n.signal)}))):qA(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return yt(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&w("Duplicate signal name: "+Dt(t));const n=e instanceof RA?e:this.add(BA(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||w("Unrecognized signal name: "+Dt(t)),this.signals[t]},signalRef(t){return this.signals[t]?LA(this.signals[t]):(yt(this.lambdas,t)||(this.lambdas[t]=this.add(BA(null))),LA(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=Mw(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&U(t)?this.signalRef(t.signal||GC(t)):t},exprRef(t,e){const n={expr:Mw(t,this)};return e&&(n.expr.$name=e),LA(this.add(fE(n)))},addBinding(t,e){this.bindings||w("Nested signals do not support binding: "+Dt(t)),this.bindings.push(pt({signal:t},e))},addScaleProj(t,e){yt(this.scales,t)&&w("Duplicate scale or projection name: "+Dt(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,CE(e))},addProjection(t,e){this.addScaleProj(t,kE(e))},getScale(t){return this.scales[t]||w("Unrecognized scale name: "+Dt(t)),this.scales[t]},scaleRef(t){return LA(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return yt(this.data,t)&&w("Duplicate data set name: "+Dt(t)),this.data[t]=e},getData(t){return this.data[t]||w("Undefined data set name: "+Dt(t)),this.data[t]},addDataPipeline(t,e){return yt(this.data,t)&&w("Duplicate data set name: "+Dt(t)),this.addData(t,cC.fromEntries(this,e))}},pt(Sr,t,e,r,i,o,s,a,l,u,c,f);const aS=t=>{return n=function*(){const e=KC(yield JC(t)),n=rS(e)[0],r=t.description;return e.items.some((t=>"scope"===t.role))?Object.assign({description:r},function(t,e,n){var r;const i=tS(eS(e,"axis").map((e=>lS(t,e,n)))),o=tS(eS(e,"legend").map((e=>uS(t,e,n))));let a;const s=null===(r=t.marks)||void 0===r?void 0:r.find(((t,e)=>t.from&&t.from.facet)),l=sS(s.marks[0].type),u=s.from.facet.groupby;return a=Array.isArray(u)?u[0]:u,{mark:l,data:n,axes:i,legends:o,facet:a}}(t,e,n)):Object.assign({description:r},function(t,e,n){var r;const i=eS(e,"axis").map((e=>lS(t,e,n))),o=eS(e,"legend").map((e=>uS(t,e,n))),a=eS(e,"title").length>0?eS(e,"title")[0].items[0].items[0].items[0].text:void 0,s=sS(null===(r=t.marks)||void 0===r?void 0:r.map((t=>t.type))[0]);return{data:n,axes:i,legends:o,mark:s,title:a}}(t,e,n))},new((e=void 0)||(e=Promise))((function(t,r){function i(t){try{a(n.next(t))}catch(t){r(t)}}function o(t){try{a(n.throw(t))}catch(t){r(t)}}function a(n){n.done?t(n.value):function(t){return t instanceof e?t:new e((function(e){e(t)}))}(n.value).then(i,o)}a((n=n.apply(void 0,[])).next())}));var e,n};function sS(t){switch(t){case"symbol":return"point";case"line":return"line";case"rect":return"bar";default:return}}function lS(t,e,n){var r,i,o,a,s,l;const u=e.items[0],c=null===(o=null===(i=null===(r=u.items.find((t=>"axis-title"===t.role)))||void 0===r?void 0:r.items)||void 0===i?void 0:i[0])||void 0===o?void 0:o.text,f=u.datum.scale,d=null===(a=t.scales)||void 0===a?void 0:a.find((t=>t.name===f));let h,p=null==d?void 0:d.domain;if(p||null===(s=t.marks)||void 0===s||s.forEach((t=>{const e=t.scales;if(e){let t=e.find((t=>t.name===f));t&&(p=t.domain)}})),(null==p?void 0:p.field)&&!(null===(l=null==p?void 0:p.field)||void 0===l?void 0:l.signal))h=p.field;else if(p.data&&p.fields)if(2===p.fields.length&&p.fields[0].endsWith("_start")&&p.fields[1].endsWith("_end")){const t=p.fields[0];h=t.substring(0,t.indexOf("_start"))}else h=p.fields[0];else h=p.fields[0].field;const m=null==d?void 0:d.type,g="bottom"===u.orient||"top"===u.orient?"x":"y";return"time"===m&&n.forEach((t=>{t[h]=new Date(t[h])})),{title:c,field:h,scaleType:m,axisType:g}}function uS(t,e,n){var r;const i=e.items[0].datum.scales[Object.keys(e.items[0].datum.scales)[0]],o=null===(r=t.scales)||void 0===r?void 0:r.find((t=>t.name===i)),a=e.items[0].items.find((t=>"legend-title"===t.role)).items[0].text;let s;const l=null==o?void 0:o.domain;return"field"in l?l.field.signal||(s=l.field):Object.keys(n[0]).some((t=>t.toLocaleString()===a.toLocaleLowerCase()))&&(s=a.toLocaleLowerCase()),{channel:i,title:a,field:s}}var cS=n(8138),fS=n.n(cS),dS=n(9378),hS=n.n(dS),pS=n(5695),mS=n.n(pS);function gS(t){return!!t.or}function yS(t){return!!t.and}function vS(t){return!!t.not}function bS(t,e){if(vS(t))bS(t.not,e);else if(yS(t))for(const n of t.and)bS(n,e);else if(gS(t))for(const n of t.or)bS(n,e);else e(t)}function xS(t,e){return vS(t)?{not:xS(t.not,e)}:yS(t)?{and:t.and.map((t=>xS(t,e)))}:gS(t)?{or:t.or.map((t=>xS(t,e)))}:e(t)}const _S=hS(),wS=fS();function kS(t,e){const n={};for(const r of e)yt(t,r)&&(n[r]=t[r]);return n}function AS(t,e){const n={...t};for(const r of e)delete n[r];return n}Set.prototype.toJSON=function(){return"Set(".concat([...this].map((t=>mS()(t))).join(","),")")};const ES=mS();function MS(t){if(At(t))return t;const e=Et(t)?t:mS()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n&=n;return n}function CS(t){return!1===t||null===t}function SS(t,e){return t.includes(e)}function DS(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function FS(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function TS(t,e){for(const n of BS(e))W(t,n,e[n],!0)}function NS(t,e){const n=[],r={};let i;for(const o of t)i=e(o),i in r||(r[i]=1,n.push(o));return n}function OS(t,e){for(const n of t)if(e.has(n))return!0;return!1}function zS(t){const e=new Set;for(const n of t){const t=k(n).map(((t,e)=>0===e?t:"[".concat(t,"]"))),r=t.map(((e,n)=>t.slice(0,n+1).join("")));for(const n of r)e.add(n)}return e}function RS(t,e){return void 0===t||void 0===e||OS(zS(t),zS(e))}function PS(t){return 0===BS(t).length}const BS=Object.keys,LS=Object.values,jS=Object.entries;function US(t){return!0===t||!1===t}function qS(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function IS(t,e){return vS(t)?"!(".concat(IS(t.not,e),")"):yS(t)?"(".concat(t.and.map((t=>IS(t,e))).join(") && ("),")"):gS(t)?"(".concat(t.or.map((t=>IS(t,e))).join(") || ("),")"):e(t)}function WS(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&WS(t[n],e)&&delete t[n],PS(t)}function $S(t){return t.charAt(0).toUpperCase()+t.substr(1)}function HS(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";const n=k(t),r=[];for(let i=1;i<=n.length;i++){const t="[".concat(n.slice(0,i).map(Dt).join("]["),"]");r.push("".concat(e).concat(t))}return r.join(" && ")}function ZS(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function YS(t){return"".concat(k(t).map(ZS).join("\\."))}function VS(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function GS(t){return"".concat(k(t).join("."))}function XS(t){return t?k(t).length:0}function QS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)if(void 0!==r)return r}let JS=42;function KS(t){if(void 0!==t)return(t%360+360)%360}function tD(t){return!!At(t)||!isNaN(t)&&!isNaN(parseFloat(t))}const eD="row",nD="column",rD="facet",iD="x",oD="y",aD="x2",sD="y2",lD="xOffset",uD="yOffset",cD="radius",fD="radius2",dD="theta",hD="theta2",pD="latitude",mD="longitude",gD="latitude2",yD="longitude2",vD="color",bD="fill",xD="stroke",_D="shape",wD="size",kD="angle",AD="opacity",ED="fillOpacity",MD="strokeOpacity",CD="strokeWidth",SD="strokeDash",DD="text",FD="order",TD="detail",ND="key",OD="tooltip",zD="href",RD="url",PD="description",BD={theta:1,theta2:1,radius:1,radius2:1};function LD(t){return t in BD}const jD={longitude:1,longitude2:1,latitude:1,latitude2:1};function UD(t){switch(t){case pD:return"y";case gD:return"y2";case mD:return"x";case yD:return"x2"}}function qD(t){return t in jD}const ID=BS(jD),WD={x:1,y:1,x2:1,y2:1,...BD,...jD,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function $D(t){return t===vD||t===bD||t===xD}const HD={row:1,column:1,facet:1},ZD=BS(HD),YD={...WD,...HD},VD=BS(YD),{order:GD,detail:XD,tooltip:QD,...JD}=YD,{row:KD,column:tF,facet:eF,...nF}=JD;function rF(t){return!!YD[t]}BS(JD),BS(nF);const iF=[aD,sD,gD,yD,hD,fD];function oF(t){return aF(t)!==t}function aF(t){switch(t){case aD:return iD;case sD:return oD;case gD:return pD;case yD:return mD;case hD:return dD;case fD:return cD}return t}function sF(t){if(LD(t))switch(t){case dD:return"startAngle";case hD:return"endAngle";case cD:return"outerRadius";case fD:return"innerRadius"}return t}function lF(t){switch(t){case iD:return aD;case oD:return sD;case pD:return gD;case mD:return yD;case dD:return hD;case cD:return fD}}function uF(t){switch(t){case iD:case aD:return"width";case oD:case sD:return"height"}}function cF(t){switch(t){case iD:return"xOffset";case oD:return"yOffset";case aD:return"x2Offset";case sD:return"y2Offset";case dD:return"thetaOffset";case cD:return"radiusOffset";case hD:return"theta2Offset";case fD:return"radius2Offset"}}function fF(t){switch(t){case iD:return"xOffset";case oD:return"yOffset"}}function dF(t){switch(t){case"xOffset":return"x";case"yOffset":return"y"}}const hF=BS(WD),{x:pF,y:mF,x2:gF,y2:yF,xOffset:vF,yOffset:bF,latitude:xF,longitude:_F,latitude2:wF,longitude2:kF,theta:AF,theta2:EF,radius:MF,radius2:CF,...SF}=WD,DF=BS(SF),FF={x:1,y:1},TF=BS(FF);function NF(t){return t in FF}const OF={theta:1,radius:1},zF=BS(OF);function RF(t){return"width"===t?iD:oD}const PF={xOffset:1,yOffset:1};function BF(t){return t in PF}BS(PF);const{text:LF,tooltip:jF,href:UF,url:qF,description:IF,detail:WF,key:$F,order:HF,...ZF}=SF,YF=BS(ZF),VF={...FF,...OF,...PF,...ZF},GF=BS(VF);function XF(t){return!!VF[t]}const QF={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:JF,...KF}=QF;function tT(t){switch(t){case iD:case oD:case dD:case cD:case lD:case uD:case wD:case kD:case CD:case AD:case ED:case MD:case aD:case sD:case hD:case fD:return;case rD:case eD:case nD:case _D:case SD:case DD:case OD:case zD:case RD:case PD:return"discrete";case vD:case bD:case xD:return"flexible";case pD:case mD:case gD:case yD:case TD:case ND:case FD:return}}const eT={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},nT={count:1,min:1,max:1};function rT(t){return!!t&&!!t.argmin}function iT(t){return!!t&&!!t.argmax}function oT(t){return Et(t)&&!!eT[t]}const aT=new Set(["count","valid","missing","distinct"]);function sT(t){return Et(t)&&aT.has(t)}const lT=new Set(["count","sum","distinct","valid","missing"]),uT=new Set(["mean","average","median","q1","q3","min","max"]);function cT(t){return wt(t)&&(t=fR(t,void 0)),"bin"+BS(t).map((e=>pT(t[e])?qS("_".concat(e,"_").concat(jS(t[e]))):qS("_".concat(e,"_").concat(t[e])))).join("")}function fT(t){return!0===t||hT(t)&&!t.binned}function dT(t){return"binned"===t||hT(t)&&!0===t.binned}function hT(t){return U(t)}function pT(t){return null===t||void 0===t?void 0:t.param}function mT(t){switch(t){case eD:case nD:case wD:case vD:case bD:case xD:case CD:case AD:case ED:case MD:case _D:return 6;case SD:return 4;default:return 10}}function gT(t){return!(null===t||void 0===t||!t.expr)}function yT(t){const e=BS(t||{}),n={};for(const r of e)n[r]=CT(t[r]);return n}function vT(t){const{anchor:e,frame:n,offset:r,orient:i,angle:o,limit:a,color:s,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...m}=t,g={...e?{anchor:e}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...void 0!==o?{angle:o}:{},...void 0!==a?{limit:a}:{}},y={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}};return{titleMarkConfig:{...m,...s?{fill:s}:{}},subtitleMarkConfig:kS(t,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:g,subtitle:y}}function bT(t){return Et(t)||L(t)&&Et(t[0])}function xT(t){return!(null===t||void 0===t||!t.signal)}function _T(t){return!!t.step}function wT(t){return!L(t)&&"field"in t&&"data"in t}const kT=BS({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),AT={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},ET=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function MT(t){const e=L(t.condition)?t.condition.map(ST):ST(t.condition);return{...CT(t),condition:e}}function CT(t){if(gT(t)){const{expr:e,...n}=t;return{signal:e,...n}}return t}function ST(t){if(gT(t)){const{expr:e,...n}=t;return{signal:e,...n}}return t}function DT(t){if(gT(t)){const{expr:e,...n}=t;return{signal:e,...n}}return xT(t)?t:void 0!==t?{value:t}:void 0}function FT(t){return xT(t)?t.signal:Dt(t)}function TT(t){return xT(t)?t.signal:Dt(t.value)}function NT(t){return xT(t)?t.signal:null==t?null:Dt(t)}function OT(t,e,n){for(const r of n){const n=PT(r,e.markDef,e.config);void 0!==n&&(t[r]=DT(n))}return t}function zT(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function RT(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!o||i&&i!==t?PT(t,e,n,r):void 0}function PT(t,e,n){let{vgChannel:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return QS(r?BT(t,e,n.style):void 0,BT(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function BT(t,e,n){return LT(t,zT(e),n)}function LT(t,e,n){let r;e=it(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function jT(t,e){return it(t).reduce(((t,n)=>{var r;return t.field.push(Qz(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t}),{field:[],order:[]})}function UT(t,e){const n=[...t];return e.forEach((t=>{for(const e of n)if(_S(e,t))return;n.push(t)})),n}function qT(t,e){return _S(t,e)||!e?t:t?[...it(t),...it(e)].join(", "):e}function IT(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((bT(n)||xT(n))&&(bT(r)||xT(r)))return{explicit:t.explicit,value:qT(n,r)};if(bT(n)||xT(n))return{explicit:t.explicit,value:n};if(bT(r)||xT(r))return{explicit:t.explicit,value:r};if(!(bT(n)||xT(n)||bT(r)||xT(r)))return{explicit:t.explicit,value:UT(n,r)};throw new Error("It should never reach here")}function WT(t){return"Invalid specification ".concat(ES(t),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}function $T(t){return("width"==t?"Width":"Height")+' "container" only works for single views and layered views.'}function HT(t){return"".concat("width"==t?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat("width"==t?"x":"y",'".')}function ZT(t){return t?'Dropping "fit-'.concat(t,'" because spec has discrete ').concat(uF(t),"."):'Dropping "fit" because spec has discrete size.'}function YT(t){return"Unknown field for ".concat(t,". Cannot calculate view size.")}function VT(t){return'Cannot project a selection on encoding channel "'.concat(t,'", which has no field.')}function GT(t,e){return'Cannot project a selection on encoding channel "'.concat(t,'" as it uses an aggregate function ("').concat(e,'").')}function XT(t){return"Selection not supported for ".concat(t," yet.")}function QT(t){return'The "columns" property cannot be used when "'.concat(t,'" has nested row/column.')}function JT(t,e,n){return'An ancestor parsed field "'.concat(t,'" as ').concat(n," but a child wants to parse the field as ").concat(e,".")}function KT(t){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(t," are dropped.")}function tN(t){return"".concat(t,"Offset dropped because ").concat(t," is continuous")}function eN(t){return"There is no ".concat(t," encoding. Replacing ").concat(t,"Offset encoding as ").concat(t,".")}function nN(t){return'Invalid field type "'.concat(t,'".')}function rN(t,e){const{fill:n,stroke:r}=e;return"Dropping color ".concat(t," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function iN(t,e){return"Dropping ".concat(ES(t),' from channel "').concat(e,'" since it does not contain any data field, datum, value, or signal.')}function oN(t,e,n){return"".concat(t,' dropped as it is incompatible with "').concat(e,'"').concat(n?" when ".concat(n):"",".")}function aN(t){return"".concat(t," encoding has no scale, so specified scale is ignored.")}function sN(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned).")}function lN(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).")}function uN(t,e){return'Using discrete channel "'.concat(t,'" to encode "').concat(e,'" field can be misleading as it does not encode ').concat("ordinal"===e?"order":"magnitude",".")}function cN(t){return"Using unaggregated domain with raw field has no effect (".concat(ES(t),").")}function fN(t){return'Unaggregated domain not applicable for "'.concat(t,'" since it produces values outside the origin domain of the source data.')}function dN(t){return"Unaggregated domain is currently unsupported for log scale (".concat(ES(t),").")}function hN(t,e,n){return"".concat(n,"-scale's \"").concat(e,'" is dropped as it does not work with ').concat(t," scale.")}function pN(t){return'The step for "'.concat(t,'" is dropped because the ').concat("width"===t?"x":"y"," is continuous.")}const mN="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function gN(t,e){return"Invalid ".concat(t,": ").concat(ES(e),".")}function yN(t){return"1D error band does not support ".concat(t,".")}function vN(t){return"Channel ".concat(t,' is required for "binned" bin.')}const bN=B(z);let xN=bN;function _N(){xN.warn(...arguments)}function wN(t){if(t&&U(t))for(const e of FN)if(e in t)return!0;return!1}new WeakMap;const kN=["january","february","march","april","may","june","july","august","september","october","november","december"],AN=kN.map((t=>t.substr(0,3))),EN=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],MN=EN.map((t=>t.substr(0,3)));function CN(t,e){const n=[];if(e&&void 0!==t.day&&BS(t).length>1&&(_N(function(t){return"Dropping day from datetime ".concat(ES(t)," as day cannot be combined with other units.")}(t)),delete(t=wS(t)).day),void 0!==t.year?n.push(t.year):n.push(2012),void 0!==t.month){const r=e?function(t){if(tD(t)&&(t=+t),At(t))return t-1;{const e=t.toLowerCase(),n=kN.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=AN.indexOf(r);if(-1!==i)return i;throw new Error(gN("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(tD(t)&&(t=+t),At(t))return t>4&&_N(gN("quarter",t)),t-1;throw new Error(gN("quarter",t))}(t.quarter):t.quarter;n.push(At(r)?3*r:"".concat(r,"*3"))}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(tD(t)&&(t=+t),At(t))return t%7;{const e=t.toLowerCase(),n=EN.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=MN.indexOf(r);if(-1!==i)return i;throw new Error(gN("day",t))}}(t.day):t.day;n.push(At(r)?r+1:"".concat(r,"+1"))}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const e=t[r];n.push(void 0===e?0:e)}return n}function SN(t){const e=CN(t,!0).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}const DN={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},FN=BS(DN);function TN(t){return t.startsWith("utc")}const NN={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function ON(t){return FN.filter((e=>zN(t,e)))}function zN(t,e){const n=t.indexOf(e);return!(n<0||n>0&&"seconds"===e&&"i"===t.charAt(n-1)||t.length>n+3&&"day"===e&&"o"===t.charAt(n+3)||n>0&&"year"===e&&"f"===t.charAt(n-1))}function RN(t){if(!t)return;const e=ON(t);return"timeUnitSpecifier(".concat(ES(e),", ").concat(ES(NN),")")}function PN(t){if(!t)return;let e;return Et(t)?e={unit:t}:U(t)&&(e={...t,...t.unit?{unit:t.unit}:{}}),TN(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function BN(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>t;const n=PN(t),r=function(t){const e=ON(t);return e[e.length-1]}(n.unit);if(r&&"day"!==r){const t={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},i=n.step||1;return"".concat(e(SN({...t,..."quarter"===r?{month:+t.month+3*i}:"week"===r?{date:+t.date+7*i}:{[r]:+t[r]+i}}))," - ").concat(e(SN(t)))}}function LN(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.equal}function jN(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.lt}function UN(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.lte}function qN(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.gt}function IN(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.gte}function WN(t){if(null!==t&&void 0!==t&&t.field){if(L(t.range)&&2===t.range.length)return!0;if(xT(t.range))return!0}return!1}function $N(t){return!(null===t||void 0===t||!t.field)&&(L(t.oneOf)||L(t.in))}function HN(t){return $N(t)||LN(t)||WN(t)||jN(t)||qN(t)||UN(t)||IN(t)}function ZN(t,e){return pR(t,{timeUnit:e,wrapTime:!0})}function YN(t){var e;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{field:r}=t,i=null===(e=PN(t.timeUnit))||void 0===e?void 0:e.unit,o=i?"time(".concat(function(t,e){let{end:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1};const r=HS(e),i=TN(t)?"utc":"";let o;const a={};for(const l of FN)zN(t,l)&&(a[l]="quarter"===(s=l)?"(".concat(i,"quarter(").concat(r,")-1)"):"".concat(i).concat(s,"(").concat(r,")"),o=l);var s;return n&&(a[o]+="+1"),function(t){const e=CN(t,!1).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}(a)}(i,r),")"):Qz(t,{expr:"datum"});if(LN(t))return"".concat(o,"===").concat(ZN(t.equal,i));if(jN(t))return"".concat(o,"<").concat(ZN(t.lt,i));if(qN(t))return"".concat(o,">").concat(ZN(t.gt,i));if(UN(t))return"".concat(o,"<=").concat(ZN(t.lte,i));if(IN(t))return"".concat(o,">=").concat(ZN(t.gte,i));if($N(t))return"indexof([".concat(function(t,e){return t.map((t=>ZN(t,e)))}(t.oneOf,i).join(","),"], ").concat(o,") !== -1");if(function(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.valid}(t))return VN(o,t.valid);if(WN(t)){const{range:e}=t,r=xT(e)?{signal:"".concat(e.signal,"[0]")}:e[0],a=xT(e)?{signal:"".concat(e.signal,"[1]")}:e[1];if(null!==r&&null!==a&&n)return"inrange("+o+", ["+ZN(r,i)+", "+ZN(a,i)+"])";const s=[];return null!==r&&s.push("".concat(o," >= ").concat(ZN(r,i))),null!==a&&s.push("".concat(o," <= ").concat(ZN(a,i))),s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(ES(t)))}function VN(t){return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?"!isValid(".concat(t,") || !isFinite(+").concat(t,")"):"isValid(".concat(t,") && isFinite(+").concat(t,")")}function GN(t){var e;return HN(t)&&t.timeUnit?{...t,timeUnit:null===(e=PN(t.timeUnit))||void 0===e?void 0:e.unit}:t}const XN={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function QN(t){return"ordinal"===t||"nominal"===t}const JN=XN.quantitative,KN=XN.ordinal,tO=XN.temporal,eO=XN.nominal,nO=XN.geojson;BS(XN);const rO={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},iO={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function oO(t,e){const n=iO[t],r=iO[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}BS(iO);const aO={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function sO(t){return aO[t]}const lO=new Set(["linear","log","pow","sqrt","symlog"]),uO=new Set([...lO,"time","utc"]);function cO(t){return lO.has(t)}const fO=new Set(["quantile","quantize","threshold"]),dO=new Set([...uO,...fO,"sequential","identity"]),hO=new Set(["ordinal","bin-ordinal","point","band"]);function pO(t){return hO.has(t)}function mO(t){return dO.has(t)}function gO(t){return uO.has(t)}function yO(t){return fO.has(t)}function vO(t){return null===t||void 0===t?void 0:t.param}new Set(["time","utc"]);const bO={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:xO,domain:_O,range:wO,rangeMax:kO,rangeMin:AO,scheme:EO,...MO}=(BS(bO),bO),CO=BS(MO);function SO(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(t);case"bins":return!["point","band","identity","ordinal"].includes(t);case"round":return gO(t)||"band"===t||"point"===t;case"padding":case"rangeMin":case"rangeMax":return gO(t)||["point","band"].includes(t);case"paddingOuter":case"align":return["point","band"].includes(t);case"paddingInner":return"band"===t;case"domainMax":case"domainMid":case"domainMin":case"clamp":return gO(t);case"nice":return gO(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return mO(t)&&!SS(["log","time","utc","threshold","quantile"],t)}}function DO(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return $D(t)?void 0:'Cannot use the scale property "'.concat(e,'" with non-color channel.');case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const FO={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},TO=FO.arc,NO=FO.area,OO=FO.bar,zO=FO.image,RO=FO.line,PO=FO.point,BO=FO.rect,LO=FO.rule,jO=FO.text,UO=FO.tick,qO=FO.trail,IO=FO.circle,WO=FO.square,$O=FO.geoshape;function HO(t){return["line","area","trail"].includes(t)}function ZO(t){return["rect","bar","image","arc"].includes(t)}const YO=new Set(BS(FO));function VO(t){return t.type}const GO=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],XO=BS({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),QO=BS({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function JO(t){return t&&null!=t.band}const KO={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};function tz(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:o}=t,a=oz(t);return Bz(n)&&!sT(n.aggregate)&&i&&gO(i.get("type"))?function(t){let{fieldDef:e,channel:n,markDef:r,ref:i,config:o}=t;return HO(r.type)?i:null===RT("invalid",r,o)?[ez(e,n),i]:i}({fieldDef:n,channel:e,markDef:r,ref:a,config:o}):a}function ez(t,e){return{test:nz(t,!0),..."y"===aF(e)?{field:{group:"height"}}:{value:0}}}function nz(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return VN(Et(t)?t:Qz(t,{expr:"datum"}),!e)}function rz(t,e,n,r){const i={};if(e&&(i.scale=e),jz(t)){const{datum:e}=t;wN(e)?i.signal=SN(e):xT(e)?i.signal=e.signal:gT(e)?i.signal=e.expr:i.value=e}else i.field=Qz(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function iz(t){let{scaleName:e,fieldOrDatumDef:n,fieldOrDatumDef2:r,offset:i,startSuffix:o,bandPosition:a=.5}=t;const s=0<a&&a<1?"datum":void 0,l=Qz(n,{expr:s,suffix:o}),u=void 0!==r?Qz(r,{expr:s}):Qz(n,{suffix:"end",expr:s}),c={};if(0===a||1===a){c.scale=e;const t=0===a?l:u;c.field=t}else{const t=xT(a)?"".concat(a.signal," * ").concat(l," + (1-").concat(a.signal,") * ").concat(u):"".concat(a," * ").concat(l," + ").concat(1-a," * ").concat(u);c.signal='scale("'.concat(e,'", ').concat(t,")")}return i&&(c.offset=i),c}function oz(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c,bandPosition:f}=t;if(n){if(Wz(n)){var d,h;const t=null===s||void 0===s?void 0:s.get("type");if($z(n)){var p;null!==(p=f)&&void 0!==p||(f=Fz({fieldDef:n,fieldDef2:r,markDef:i,config:o}));const{bin:s,timeUnit:c,type:d}=n;if(fT(s)||f&&c&&d===tO)return null!==l&&void 0!==l&&l.impute?rz(n,a,{binSuffix:"mid"},{offset:u}):f&&!pO(t)?iz({scaleName:a,fieldOrDatumDef:n,bandPosition:f,offset:u}):rz(n,a,gR(n,e)?{binSuffix:"range"}:{},{offset:u});if(dT(s)){if(Bz(r))return iz({scaleName:a,fieldOrDatumDef:n,fieldOrDatumDef2:r,bandPosition:f,offset:u});_N(vN(e===iD?aD:sD))}}return rz(n,a,pO(t)?{binSuffix:"range"}:{},{offset:u,band:"band"===t?null!==(d=null!==(h=f)&&void 0!==h?h:n.bandPosition)&&void 0!==d?d:.5:void 0})}if(Hz(n)){const t=u?{offset:u}:{};return{...az(e,n.value),...t}}}return ot(c)&&(c=c()),c?{...c,...u?{offset:u}:{}}:c}function az(t,e){return SS(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:SS(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:DT(e)}function sz(t){return t&&"number"!==t&&"time"!==t}function lz(t,e,n){return"".concat(t,"(").concat(e).concat(n?", ".concat(ES(n)):"",")")}const uz=" \u2013 ";function cz(t){let{fieldOrDatumDef:e,format:n,formatType:r,expr:i,normalizeStack:o,config:a}=t;if(sz(r))return dz({fieldOrDatumDef:e,format:n,formatType:r,expr:i,config:a});const s=fz(e,i,o),l=Lz(e);if(void 0===n&&void 0===r&&a.customFormatTypes){if("quantitative"===l){if(o&&a.normalizedNumberFormatType)return dz({fieldOrDatumDef:e,format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,expr:i,config:a});if(a.numberFormatType)return dz({fieldOrDatumDef:e,format:a.numberFormat,formatType:a.numberFormatType,expr:i,config:a})}if("temporal"===l&&a.timeFormatType&&Bz(e)&&void 0===e.timeUnit)return dz({fieldOrDatumDef:e,format:a.timeFormat,formatType:a.timeFormatType,expr:i,config:a})}if(hR(e)){var u,c;const t=function(t){let{field:e,timeUnit:n,format:r,formatType:i,rawTimeFormat:o,isUTCScale:a}=t;return!n||r?!n&&i?"".concat(i,"(").concat(e,", '").concat(r,"')"):"".concat(a?"utc":"time","Format(").concat(e,", '").concat(r=Et(r)?r:o,"')"):function(t,e,n){if(!t)return;const r=RN(t);return"".concat(n||TN(t)?"utc":"time","Format(").concat(e,", ").concat(r,")")}(n,e,a)}({field:s,timeUnit:Bz(e)?null===(u=PN(e.timeUnit))||void 0===u?void 0:u.unit:void 0,format:n,formatType:a.timeFormatType,rawTimeFormat:a.timeFormat,isUTCScale:Zz(e)&&(null===(c=e.scale)||void 0===c?void 0:c.type)===rO.UTC});return t?{signal:t}:void 0}return n=mz({type:l,specifiedFormat:n,config:a,normalizeStack:o}),Bz(e)&&fT(e.bin)?{signal:vz(s,Qz(e,{expr:i,binSuffix:"end"}),n,r,a)}:n||"quantitative"===Lz(e)?{signal:"".concat(gz(s,n))}:{signal:"isValid(".concat(s,") ? ").concat(s,' : ""+').concat(s)}}function fz(t,e,n){return Bz(t)?n?"".concat(Qz(t,{expr:e,suffix:"end"}),"-").concat(Qz(t,{expr:e,suffix:"start"})):Qz(t,{expr:e}):function(t){const{datum:e}=t;return wN(e)?SN(e):"".concat(ES(e))}(t)}function dz(t){var e;let{fieldOrDatumDef:n,format:r,formatType:i,expr:o,normalizeStack:a,config:s,field:l}=t;return null!==(e=l)&&void 0!==e||(l=fz(n,o,a)),"datum.value"!==l&&Bz(n)&&fT(n.bin)?{signal:vz(l,Qz(n,{expr:o,binSuffix:"end"}),r,i,s)}:{signal:lz(i,l,r)}}function hz(t,e,n,r,i,o){if(!Et(r)||!sz(r)){if(void 0===n&&void 0===r&&i.customFormatTypes&&"quantitative"===Lz(t)){if(i.normalizedNumberFormatType&&Yz(t)&&"normalize"===t.stack)return;if(i.numberFormatType)return}if(Yz(t)&&"normalize"===t.stack&&i.normalizedNumberFormat)return mz({type:"quantitative",config:i,normalizeStack:!0});if(hR(t)){var a;const e=Bz(t)?null===(a=PN(t.timeUnit))||void 0===a?void 0:a.unit:void 0;if(void 0===e&&i.customFormatTypes&&i.timeFormatType)return;return function(t){let{specifiedFormat:e,timeUnit:n,config:r,omitTimeFormatConfig:i}=t;return e||(n?{signal:RN(n)}:i?void 0:r.timeFormat)}({specifiedFormat:n,timeUnit:e,config:i,omitTimeFormatConfig:o})}return mz({type:e,specifiedFormat:n,config:i})}}function pz(t,e,n){var r;return t&&(xT(t)||"number"===t||"time"===t)?t:hR(e)&&"time"!==n&&"utc"!==n?Bz(e)&&null!==(r=PN(null===e||void 0===e?void 0:e.timeUnit))&&void 0!==r&&r.utc?"utc":"time":void 0}function mz(t){let{type:e,specifiedFormat:n,config:r,normalizeStack:i}=t;return Et(n)?n:e===JN?i?r.normalizedNumberFormat:r.numberFormat:void 0}function gz(t,e){return"format(".concat(t,', "').concat(e||"",'")')}function yz(t,e,n,r){var i;return sz(n)?lz(n,t,e):gz(t,null!==(i=Et(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function vz(t,e,n,r,i){if(void 0===n&&void 0===r&&i.customFormatTypes&&i.numberFormatType)return vz(t,e,i.numberFormat,i.numberFormatType,i);const o=yz(t,n,r,i),a=yz(e,n,r,i);return"".concat(VN(t,!1),' ? "null" : ').concat(o,' + "').concat(uz,'" + ').concat(a)}const bz="min",xz={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function _z(t){return t in xz}function wz(t){return!(null===t||void 0===t||!t.encoding)}function kz(t){return t&&("count"===t.op||!!t.field)}function Az(t){return t&&L(t)}function Ez(t){return"row"in t||"column"in t}function Mz(t){return!!t&&"header"in t}function Cz(t){return"facet"in t}function Sz(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:e}}function Dz(t){return"sort"in t}function Fz(t){let{fieldDef:e,fieldDef2:n,markDef:r,config:i}=t;if(Wz(e)&&void 0!==e.bandPosition)return e.bandPosition;if(Bz(e)){const{timeUnit:t,bin:o}=e;if(t&&!n)return ZO(r.type)?0:PT("timeUnitBandPosition",r,i);if(fT(o))return.5}}function Tz(t){var e,n,r;let{channel:i,fieldDef:o,fieldDef2:a,markDef:s,config:l,scaleType:u,useVlSizeChannel:c}=t;const f=uF(i),d=RT(c?"size":f,s,l,{vgChannel:f});if(void 0!==d)return d;if(Bz(o)){const{timeUnit:t,bin:e}=o;if(t&&!a)return{band:PT("timeUnitBandSize",s,l)};if(fT(e)&&!pO(u))return{band:1}}return ZO(s.type)?u?pO(u)?(null===(e=l[s.type])||void 0===e?void 0:e.discreteBandSize)||{band:1}:null===(n=l[s.type])||void 0===n?void 0:n.continuousBandSize:null===(r=l[s.type])||void 0===r?void 0:r.discreteBandSize:void 0}function Nz(t,e,n,r){return!!(fT(t.bin)||t.timeUnit&&$z(t)&&"temporal"===t.type)&&void 0!==Fz({fieldDef:t,fieldDef2:e,markDef:n,config:r})}function Oz(t){return t&&!!t.sort&&!t.field}function zz(t){return t&&"condition"in t}function Rz(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!L(e)&&Bz(e)}function Pz(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!L(e)&&Wz(e)}function Bz(t){return t&&(!!t.field||"count"===t.aggregate)}function Lz(t){return null===t||void 0===t?void 0:t.type}function jz(t){return t&&"datum"in t}function Uz(t){return $z(t)&&!Jz(t)||Iz(t)}function qz(t){return $z(t)&&"quantitative"===t.type&&!t.bin||Iz(t)}function Iz(t){return jz(t)&&At(t.datum)}function Wz(t){return Bz(t)||jz(t)}function $z(t){return t&&("field"in t||"count"===t.aggregate)&&"type"in t}function Hz(t){return t&&"value"in t&&"value"in t}function Zz(t){return t&&("scale"in t||"sort"in t)}function Yz(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function Vz(t){return t&&"legend"in t}function Gz(t){return t&&("format"in t||"formatType"in t)}function Xz(t){return AS(t,["legend","axis","header","scale"])}function Qz(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.field;const r=e.prefix;let i=e.suffix,o="";if(function(t){return"count"===t.aggregate}(t))n=function(t){return t.startsWith("__")}(u="count")?u:"__".concat(u);else{let r;if(!e.nofn)if(function(t){return"op"in t}(t))r=t.op;else{var a,s,l;const{bin:u,aggregate:c,timeUnit:f}=t;fT(u)?(r=cT(u),i=(null!==(a=e.binSuffix)&&void 0!==a?a:"")+(null!==(s=e.suffix)&&void 0!==s?s:"")):c?iT(c)?(o='["'.concat(n,'"]'),n="argmax_".concat(c.argmax)):rT(c)?(o='["'.concat(n,'"]'),n="argmin_".concat(c.argmin)):r=String(c):f&&(r=function(t){const{utc:e,...n}=PN(t);return n.unit?(e?"utc":"")+BS(n).map((t=>qS("".concat("unit"===t?"":"_".concat(t,"_")).concat(n[t])))).join(""):(e?"utc":"")+"timeunit"+BS(n).map((t=>qS("_".concat(t,"_").concat(n[t])))).join("")}(f),i=(!["range","mid"].includes(e.binSuffix)&&e.binSuffix||"")+(null!==(l=e.suffix)&&void 0!==l?l:""))}r&&(n=n?"".concat(r,"_").concat(n):r)}var u;return i&&(n="".concat(n,"_").concat(i)),r&&(n="".concat(r,"_").concat(n)),e.forAs?GS(n):e.expr?function(t){return"".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum","[").concat(Dt(k(t).join(".")),"]")}(n,e.expr)+o:YS(n)+o}function Jz(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Bz(t)&&!!t.bin;case"temporal":return!1}throw new Error(nN(t.type))}const Kz=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(iT(e))return"".concat(i," for argmax(").concat(e.argmax,")");if(rT(e))return"".concat(i," for argmin(").concat(e.argmin,")");const o=PN(r),a=e||(null===o||void 0===o?void 0:o.unit)||(null===o||void 0===o?void 0:o.maxbins)&&"timeunit"||fT(n)&&"bin";return a?"".concat(a.toUpperCase(),"(").concat(i,")"):i}(t);default:return function(t,e){const{field:n,bin:r,timeUnit:i,aggregate:o}=t;if("count"===o)return e.countTitle;if(fT(r))return"".concat(n," (binned)");if(i){var a;const t=null===(a=PN(i))||void 0===a?void 0:a.unit;if(t)return"".concat(n," (").concat(ON(t).join("-"),")")}else if(o)return iT(o)?"".concat(n," for max ").concat(o.argmax):rT(o)?"".concat(n," for min ").concat(o.argmin):"".concat($S(o)," of ").concat(n);return n}(t,e)}};let tR=Kz;function eR(t){tR=t}function nR(t,e,n){var r,i;let{allowDisabling:o,includeDefault:a=!0}=n;const s=null===(r=rR(t))||void 0===r?void 0:r.title;if(!Bz(t))return null!==s&&void 0!==s?s:t.title;const l=t,u=a?iR(l,e):void 0;return o?QS(s,l.title,u):null!==(i=null!==s&&void 0!==s?s:l.title)&&void 0!==i?i:u}function rR(t){return Yz(t)&&t.axis?t.axis:Vz(t)&&t.legend?t.legend:Mz(t)&&t.header?t.header:void 0}function iR(t,e){return tR(t,e)}function oR(t){if(Gz(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{var e;const n=null!==(e=rR(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function aR(t){return Bz(t)?t:Rz(t)?t.condition:void 0}function sR(t){return Wz(t)?t:Pz(t)?t.condition:void 0}function lR(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Et(t)||At(t)||wt(t)?(_N(function(t,e,n){return"Channel ".concat(t," is a ").concat(e,". Converted to {value: ").concat(ES(n),"}.")}(e,Et(t)?"string":At(t)?"number":"boolean",t)),{value:t}):Wz(t)?uR(t,e,n,r):Pz(t)?{...t,condition:uR(t.condition,e,n,r)}:t}function uR(t,e,n,r){if(Gz(t)){const{format:i,formatType:o,...a}=t;if(sz(o)&&!n.customFormatTypes)return _N(KT(e)),uR(a,e,n,r)}else{const i=Yz(t)?"axis":Vz(t)?"legend":Mz(t)?"header":null;if(i&&t[i]){const{format:o,formatType:a,...s}=t[i];if(sz(a)&&!n.customFormatTypes)return _N(KT(e)),uR({...t,[i]:s},e,n,r)}}return Bz(t)?cR(t,e,r):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=At(n)?"quantitative":Et(n)?"nominal":wN(n)?"temporal":void 0,{...t,type:e}}(t)}function cR(t,e){let{compositeMark:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{aggregate:r,timeUnit:i,bin:o,field:a}=t,s={...t};if(n||!r||oT(r)||iT(r)||rT(r)||(_N(function(t){return'Invalid aggregation operator "'.concat(t,'".')}(r)),delete s.aggregate),i&&(s.timeUnit=PN(i)),a&&(s.field="".concat(a)),fT(o)&&(s.bin=fR(o,e)),dT(o)&&!NF(e)&&_N(function(t){return"Channel ".concat(t,' should not be used with "binned" bin.')}(e)),$z(s)){const{type:t}=s,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case JN:return"quantitative";case"t":case tO:return"temporal";case"o":case KN:return"ordinal";case"n":case eO:return"nominal";case nO:return"geojson"}}(t);t!==e&&(s.type=e),"quantitative"!==t&&sT(r)&&(_N(function(t,e){return'Invalid field type "'.concat(t,'" for aggregate: "').concat(e,'", using "quantitative" instead.')}(t,r)),s.type="quantitative")}else if(!oF(e)){const t=function(t,e,n){switch(e){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(Dz(t)&&L(t.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=t;if(o)return"temporal";if(i||r&&!iT(r)&&!rT(r))return"quantitative";if(Zz(t)&&null!==(n=t.scale)&&void 0!==n&&n.type)switch(iO[t.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(s,e);s.type=t}if($z(s)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:"Channel ".concat(e," should not be used with a geojson data.")};switch(e){case eD:case nD:case rD:return Jz(t)?dR:{compatible:!1,warning:sN(e)};case iD:case oD:case lD:case uD:case vD:case bD:case xD:case DD:case TD:case ND:case OD:case zD:case RD:case kD:case dD:case cD:case PD:return dR;case mD:case yD:case pD:case gD:return n!==JN?{compatible:!1,warning:"Channel ".concat(e," should be used with a quantitative field only, not ").concat(t.type," field.")}:dR;case AD:case ED:case MD:case CD:case wD:case hD:case fD:case aD:case sD:return"nominal"!==n||t.sort?dR:{compatible:!1,warning:"Channel ".concat(e," should not be used with an unsorted discrete field.")};case _D:case SD:return Jz(t)||function(t,e){return Zz(t)&&yO(null===(e=t.scale)||void 0===e?void 0:e.type)}(t)?dR:{compatible:!1,warning:lN(e)};case FD:return"nominal"!==t.type||"sort"in t?dR:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(s,e)||{};!1===t&&_N(n)}if(Dz(s)&&Et(s.sort)){const{sort:t}=s;if(_z(t))return{...s,sort:{encoding:t}};const e=t.substr(1);if("-"===t.charAt(0)&&_z(e))return{...s,sort:{encoding:e,order:"descending"}}}if(Mz(s)){const{header:t}=s;if(t){const{orient:e,...n}=t;if(e)return{...s,header:{...n,labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e}}}}return s}function fR(t,e){return wt(t)?{maxbins:mT(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:{...t,maxbins:mT(e)}}const dR={compatible:!0};function hR(t){const{formatType:e}=oR(t);return"time"===e||!e&&function(t){return t&&("temporal"===t.type||Bz(t)&&!!t.timeUnit)}(t)}function pR(t,e){var n;let{timeUnit:r,type:i,wrapTime:o,undefinedIfExprNotRequired:a}=e;const s=r&&(null===(n=PN(r))||void 0===n?void 0:n.unit);let l,u=s||"temporal"===i;return gT(t)?l=t.expr:xT(t)?l=t.signal:wN(t)?(u=!0,l=SN(t)):(Et(t)||At(t))&&u&&(l="datetime(".concat(ES(t),")"),function(t){return!!DN[t]}(s)&&(At(t)&&t<1e4||Et(t)&&isNaN(Date.parse(t)))&&(l=SN({[s]:t}))),l?o&&u?"time(".concat(l,")"):l:a?void 0:ES(t)}function mR(t,e){const{type:n}=t;return e.map((e=>{const r=pR(e,{timeUnit:Bz(t)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e}))}function gR(t,e){return fT(t.bin)?XF(e)&&["ordinal","nominal"].includes(t.type):(console.warn("Only call this method for binned field defs."),!1)}const yR={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function vR(t){return null===t||void 0===t?void 0:t.condition}const bR=["domain","grid","labels","ticks","title"],xR={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},_R={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},wR={..._R,style:1,labelExpr:1,encoding:1};function kR(t){return!!wR[t]}BS(wR);const AR=BS({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function ER(t){return"mark"in t}class MR{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!ER(t)&&function(t){return VO(t)?t.type:t}(t.mark)===this.name}}function CR(t,e){const n=t&&t[e];return!!n&&(L(n)?DS(n,(t=>!!t.field)):Bz(n)||Rz(n))}function SR(t,e){const n=t&&t[e];return!!n&&(L(n)?DS(n,(t=>!!t.field)):Bz(n)||jz(n)||Pz(n))}function DR(t,e){if(NF(e)){const n=t[e];if((Bz(n)||jz(n))&&(QN(n.type)||Bz(n)&&n.timeUnit))return SR(t,fF(e))}return!1}function FR(t){return DS(VD,(e=>{if(CR(t,e)){const n=t[e];if(L(n))return DS(n,(t=>!!t.aggregate));{const t=aR(n);return t&&!!t.aggregate}}return!1}))}function TR(t,e){const n=[],r=[],i=[],o=[],a={};return zR(t,((s,l)=>{if(Bz(s)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=s;if(c||d||f){const t=rR(s),p=null===t||void 0===t?void 0:t.title;let m=Qz(s,{forAs:!0});const g={...p?[]:{title:nR(s,e,{allowDisabling:!0})},...h,field:m};if(c){let t;if(iT(c)?(t="argmax",m=Qz({op:"argmax",field:c.argmax},{forAs:!0}),g.field="".concat(m,".").concat(u)):rT(c)?(t="argmin",m=Qz({op:"argmin",field:c.argmin},{forAs:!0}),g.field="".concat(m,".").concat(u)):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(t=c),t){const e={op:t,as:m};u&&(e.field=u),o.push(e)}}else if(n.push(m),$z(s)&&fT(f)){if(r.push({bin:f,field:u,as:m}),n.push(Qz(s,{binSuffix:"end"})),gR(s,l)&&n.push(Qz(s,{binSuffix:"range"})),NF(l)){const t={field:"".concat(m,"_end")};a["".concat(l,"2")]=t}g.bin="binned",oF(l)||(g.type=JN)}else if(d){i.push({timeUnit:d,field:u,as:m});const t=$z(s)&&s.type!==tO&&"time";t&&(l===DD||l===OD?g.formatType=t:function(t){return!!SF[t]}(l)?g.legend={formatType:t,...g.legend}:NF(l)&&(g.axis={formatType:t,...g.axis}))}a[l]=g}else n.push(u),a[l]=t[l]}else a[l]=t[l]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function NR(t,e,n){const r=function(t,e){return function(t){switch(t){case vD:case bD:case xD:case PD:case TD:case ND:case OD:case zD:case FD:case AD:case ED:case MD:case CD:case rD:case eD:case nD:return QF;case iD:case oD:case lD:case uD:case pD:case mD:return KF;case aD:case sD:case gD:case yD:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case wD:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case SD:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case _D:return{point:"always",geoshape:"always"};case DD:return{text:"always"};case kD:return{point:"always",square:"always",text:"always"};case RD:return{image:"always"};case dD:case cD:return{text:"always",arc:"always"};case hD:case fD:return{arc:"always"}}}(t)[e]}(e,n);if(!r)return!1;if("binned"===r){const n=t[e===aD?iD:oD];return!!(Bz(n)&&Bz(t[e])&&dT(n.bin))}return!0}function OR(t,e){const n={};for(const r of BS(t)){const i=lR(t[r],r,e,{compositeMark:!0});n[r]=i}return n}function zR(t,e,n){if(t)for(const r of BS(t)){const i=t[r];if(L(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function RR(t,e){return BS(e).reduce(((n,r)=>{switch(r){case iD:case oD:case zD:case PD:case RD:case aD:case sD:case lD:case uD:case dD:case hD:case cD:case fD:case pD:case mD:case gD:case yD:case DD:case _D:case kD:case OD:return n;case FD:if("line"===t||"trail"===t)return n;case TD:case ND:{const t=e[r];if(L(t)||Bz(t))for(const e of it(t))e.aggregate||n.push(Qz(e,{}));return n}case wD:if("trail"===t)return n;case vD:case bD:case xD:case AD:case ED:case MD:case SD:case CD:{const t=aR(e[r]);return t&&!t.aggregate&&n.push(Qz(t,{})),n}}}),[])}function PR(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};const i=t.map((t=>{let{fieldPrefix:n,titlePrefix:i}=t;const o=r?" of ".concat(BR(e)):"";return{field:n+e.field,type:e.type,title:xT(i)?{signal:"".concat(i,'"').concat(escape(o),'"')}:i+o}})),o=function(t){const e=[];for(const n of BS(t))if(CR(t,n)){const r=it(t[n]);for(const t of r)Bz(t)?e.push(t):Rz(t)&&e.push(t.condition)}return e}(n).map(Xz);return{tooltip:[...i,...NS(o,MS)]}}function BR(t){const{title:e,field:n}=t;return QS(e,n)}function LR(t,e,n,r,i){const{scale:o,axis:a}=n;return s=>{let{partName:l,mark:u,positionPrefix:c,endPositionPrefix:f,extraEncoding:d={}}=s;const h=BR(n);return jR(t,l,i,{mark:u,encoding:{[e]:{field:"".concat(c,"_").concat(n.field),type:n.type,...void 0!==h?{title:h}:{},...void 0!==o?{scale:o}:{},...void 0!==a?{axis:a}:{}},...Et(f)?{["".concat(e,"2")]:{field:"".concat(f,"_").concat(n.field)}}:{},...r,...d}})}}function jR(t,e,n,r){const{clip:i,color:o,opacity:a}=t,s=t.type;return t[e]||void 0===t[e]&&n[e]?[{...r,mark:{...n[e],...i?{clip:i}:{},...o?{color:o}:{},...a?{opacity:a}:{},...VO(r.mark)?r.mark:{type:r.mark},style:"".concat(s,"-").concat(String(e)),...wt(t[e])?{}:t[e]}}]:[]}function UR(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",o=r[i],a=r["".concat(i,"2")],s=r["".concat(i,"Error")],l=r["".concat(i,"Error2")];return{continuousAxisChannelDef:qR(o,n),continuousAxisChannelDef2:qR(a,n),continuousAxisChannelDefError:qR(s,n),continuousAxisChannelDefError2:qR(l,n),continuousAxis:i}}function qR(t,e){if(null!==t&&void 0!==t&&t.aggregate){const{aggregate:n,...r}=t;return n!==e&&_N(function(t,e){return"Continuous axis should not have customized aggregation function ".concat(t,"; ").concat(e," already agregates the axis.")}(n,e)),r}return t}function IR(t,e){const{mark:n,encoding:r}=t,{x:i,y:o}=r;if(VO(n)&&n.orient)return n.orient;if(Uz(i)){if(Uz(o)){const t=Bz(i)&&i.aggregate,n=Bz(o)&&o.aggregate;if(t||n!==e){if(n||t!==e){if(t===e&&n===e)throw new Error("Both x and y cannot have aggregate");return hR(o)&&!hR(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(Uz(o))return"vertical";throw new Error("Need a valid continuous axis for ".concat(e,"s"))}const WR="boxplot",$R=new MR(WR,ZR);function HR(t){return At(t)?"tukey":t}function ZR(t,e){var n,r;let{config:i}=e;t={...t,encoding:OR(t.encoding,i)};const{mark:o,encoding:a,params:s,projection:l,...u}=t,c=VO(o)?o:{type:o};s&&_N(XT("boxplot"));const f=null!==(n=c.extent)&&void 0!==n?n:i.boxplot.extent,d=RT("size",c,i),h=c.invalid,p=HR(f),{bins:m,timeUnits:g,transform:y,continuousAxisChannelDef:v,continuousAxis:b,groupby:x,aggregate:_,encodingWithoutContinuousAxis:w,ticksOrient:k,boxOrient:A,customTooltipWithoutAggregatedField:E}=function(t,e,n){const r=IR(t,WR),{continuousAxisChannelDef:i,continuousAxis:o}=UR(t,r,WR),a=i.field,s=HR(e),l=[...YR(a),{op:"median",field:a,as:"mid_box_".concat(a)},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],u="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(a,'"] - datum["lower_box_').concat(a,'"]'),as:"iqr_".concat(a)},{calculate:'min(datum["upper_box_'.concat(a,'"] + datum["iqr_').concat(a,'"] * ').concat(e,', datum["max_').concat(a,'"])'),as:"upper_whisker_".concat(a)},{calculate:'max(datum["lower_box_'.concat(a,'"] - datum["iqr_').concat(a,'"] * ').concat(e,', datum["min_').concat(a,'"])'),as:"lower_whisker_".concat(a)}],{[o]:c,...f}=t.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=function(t){const{tooltip:e,...n}=t;if(!e)return{filteredEncoding:n};let r,i;if(L(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return L(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:p,timeUnits:m,aggregate:g,groupby:y,encoding:v}=TR(h,n),b="vertical"===r?"horizontal":"vertical",x=r;return{bins:p,timeUnits:m,transform:[...p,...m,{aggregate:[...g,...l],groupby:y},...u],groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:d}}(t,f,i),{color:M,size:C,...S}=w,D=t=>LR(c,b,v,t,i.boxplot),F=D(S),T=D(w),N=D({...S,...C?{size:C}:{}}),O=PR([{fieldPrefix:"min-max"===p?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===p?"lower_whisker_":"min_",titlePrefix:"Min"}],v,w),z={type:"tick",color:"black",opacity:1,orient:k,invalid:h,aria:!1},R="min-max"===p?O:PR([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,w),P=[...F({partName:"rule",mark:{type:"rule",invalid:h,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:R}),...F({partName:"rule",mark:{type:"rule",invalid:h,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:R}),...F({partName:"ticks",mark:z,positionPrefix:"lower_whisker",extraEncoding:R}),...F({partName:"ticks",mark:z,positionPrefix:"upper_whisker",extraEncoding:R})],B=[..."tukey"!==p?P:[],...T({partName:"box",mark:{type:"bar",...d?{size:d}:{},orient:A,invalid:h,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:O}),...N({partName:"median",mark:{type:"tick",invalid:h,...U(i.boxplot.median)&&i.boxplot.median.color?{color:i.boxplot.median.color}:{},...d?{size:d}:{},orient:k,aria:!1},positionPrefix:"mid_box",extraEncoding:O})];if("min-max"===p)return{...u,transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(y),layer:B};const j='datum["lower_box_'.concat(v.field,'"]'),q='datum["upper_box_'.concat(v.field,'"]'),I="(".concat(q," - ").concat(j,")"),W="".concat(j," - ").concat(f," * ").concat(I),$="".concat(q," + ").concat(f," * ").concat(I),H='datum["'.concat(v.field,'"]'),Z={joinaggregate:YR(v.field),groupby:x},Y={transform:[{filter:"(".concat(W," <= ").concat(H,") && (").concat(H," <= ").concat($,")")},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_".concat(v.field)},{op:"max",field:v.field,as:"upper_whisker_".concat(v.field)},{op:"min",field:"lower_box_".concat(v.field),as:"lower_box_".concat(v.field)},{op:"max",field:"upper_box_".concat(v.field),as:"upper_box_".concat(v.field)},..._],groupby:x}],layer:P},{tooltip:V,...G}=S,{scale:X,axis:Q}=v,J=BR(v),K=AS(Q,["title"]),tt=jR(c,"outliers",i.boxplot,{transform:[{filter:"(".concat(H," < ").concat(W,") || (").concat(H," > ").concat($,")")}],mark:"point",encoding:{[b]:{field:v.field,type:v.type,...void 0!==J?{title:J}:{},...void 0!==X?{scale:X}:{},...PS(K)?{}:{axis:K}},...G,...M?{color:M}:{},...E?{tooltip:E}:{}}})[0];let et;const nt=[...m,...g,Z];return tt?et={transform:nt,layer:[tt,Y]}:(et=Y,et.transform.unshift(...nt)),{...u,layer:[et,{transform:y,layer:B}]}}function YR(t){return[{op:"q1",field:t,as:"lower_box_".concat(t)},{op:"q3",field:t,as:"upper_box_".concat(t)}]}const VR="errorbar",GR=new MR(VR,XR);function XR(t,e){let{config:n}=e;t={...t,encoding:OR(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,ticksOrient:s,markDef:l,outerSpec:u,tooltipEncoding:c}=QR(t,VR,n);delete a.size;const f=LR(l,o,i,a,n.errorbar),d=l.thickness,h=l.size,p={type:"tick",orient:s,aria:!1,...void 0!==d?{thickness:d}:{},...void 0!==h?{size:h}:{}},m=[...f({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:c}),...f({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:c}),...f({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==d?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return{...u,transform:r,...m.length>1?{layer:m}:{...m[0]}}}function QR(t,e,n){var r;const{mark:i,encoding:o,params:a,projection:s,...l}=t,u=VO(i)?i:{type:i};a&&_N(XT(e));const{orient:c,inputType:f}=function(t,e){const{encoding:n}=t;if(function(t){return(Wz(t.x)||Wz(t.y))&&!Wz(t.x2)&&!Wz(t.y2)&&!Wz(t.xError)&&!Wz(t.xError2)&&!Wz(t.yError)&&!Wz(t.yError2)}(n))return{orient:IR(t,e),inputType:"raw"};const r=function(t){return Wz(t.x2)||Wz(t.y2)}(n),i=function(t){return Wz(t.xError)||Wz(t.xError2)||Wz(t.yError)||Wz(t.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error("".concat(e," cannot be both type aggregated-upper-lower and aggregated-error"));const t=n.x2,r=n.y2;if(Wz(t)&&Wz(r))throw new Error("".concat(e," cannot have both x2 and y2"));if(Wz(t)){if(Uz(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(e))}if(Wz(r)){if(Uz(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(e))}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(Wz(r)&&!Wz(t))throw new Error("".concat(e," cannot have xError2 without xError"));if(Wz(s)&&!Wz(i))throw new Error("".concat(e," cannot have yError2 without yError"));if(Wz(t)&&Wz(i))throw new Error("".concat(e," cannot have both xError and yError with both are quantiative"));if(Wz(t)){if(Uz(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Wz(i)){if(Uz(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(t,e),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:g}=UR(t,c,e),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=function(t,e,n,r,i,o,a,s){let l=[],u=[];const c=e.field;let f,d=!1;if("raw"===o){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!=("iqr"===n)&&_N(function(t,e,n){return"".concat(t," is not usually used with ").concat(e," for ").concat(n,".")}(e,n,a)),"stderr"===n||"stdev"===n)l=[{op:n,field:c,as:"extent_".concat(c)},{op:e,field:c,as:"center_".concat(c)}],u=[{calculate:'datum["center_'.concat(c,'"] + datum["extent_').concat(c,'"]'),as:"upper_".concat(c)},{calculate:'datum["center_'.concat(c,'"] - datum["extent_').concat(c,'"]'),as:"lower_".concat(c)}],f=[{fieldPrefix:"center_",titlePrefix:$S(e)},{fieldPrefix:"upper_",titlePrefix:JR(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:JR(e,n,"-")}],d=!0;else{let t,e,r;"ci"===n?(t="mean",e="ci0",r="ci1"):(t="median",e="q1",r="q3"),l=[{op:e,field:c,as:"lower_".concat(c)},{op:r,field:c,as:"upper_".concat(c)},{op:t,field:c,as:"center_".concat(c)}],f=[{fieldPrefix:"upper_",titlePrefix:nR({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:nR({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:nR({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&_N(function(t,e){return"".concat(e?"extent ":"").concat(e&&t?"and ":"").concat(t?"center ":"").concat(e&&t?"are ":"is ","not needed when data are aggregated.")}(t.center,t.extent)),"aggregated-upper-lower"===o?(f=[],u=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_".concat(c)},{calculate:'datum["'.concat(c,'"]'),as:"lower_".concat(c)}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:'datum["'.concat(c,'"] + datum["').concat(r.field,'"]'),as:"upper_".concat(c)}],i?u.push({calculate:'datum["'.concat(c,'"] + datum["').concat(i.field,'"]'),as:"lower_".concat(c)}):u.push({calculate:'datum["'.concat(c,'"] - datum["').concat(r.field,'"]'),as:"lower_".concat(c)}));for(const t of u)f.push({fieldPrefix:t.as.substring(0,6),titlePrefix:VS(VS(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}(u,d,h,p,m,f,e,n),{[g]:_,["x"===g?"x2":"y2"]:w,["x"===g?"xError":"yError"]:k,["x"===g?"xError2":"yError2"]:A,...E}=o,{bins:M,timeUnits:C,aggregate:S,groupby:D,encoding:F}=TR(E,n),T=[...S,...y],N="raw"!==f?[]:D,O=PR(b,d,F,x);return{transform:[...null!==(r=l.transform)&&void 0!==r?r:[],...M,...C,...0===T.length?[]:[{aggregate:T,groupby:N}],...v],groupby:N,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:F,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:O}}function JR(t,e,n){return"".concat($S(t)," ").concat(n," ").concat(e)}const KR="errorband",tP=new MR(KR,eP);function eP(t,e){let{config:n}=e;t={...t,encoding:OR(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:l,tooltipEncoding:u}=QR(t,KR,n),c=s,f=LR(c,o,i,a,n.errorband),d=void 0!==t.encoding.x&&void 0!==t.encoding.y;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const m={...c.interpolate?{interpolate:c.interpolate}:{},...c.tension&&c.interpolate?{tension:c.tension}:{}};return d?(h={...h,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):c.interpolate?_N(yN("interpolate")):c.tension&&_N(yN("tension")),{...l,transform:r,layer:[...f({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}const nP={};function rP(t,e,n){const r=new MR(t,e);nP[t]={normalizer:r,parts:n}}rP(WR,ZR,["box","median","outliers","rule","ticks"]),rP(VR,XR,["ticks","rule"]),rP(KR,eP,["band","borders"]);const iP=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],oP={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},aP={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},sP=BS(oP),lP=BS(aP),uP=BS({header:1,headerRow:1,headerColumn:1,headerFacet:1}),cP=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],fP={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},dP=(BS(fP),"_vgsid_"),hP={point:{on:"click",fields:[dP],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function pP(t){return"legend"===t||!(null===t||void 0===t||!t.legend)}function mP(t){return pP(t)&&U(t)}function gP(t){return!(null===t||void 0===t||!t.select)}function yP(t){const e=[];for(const n of t||[]){if(gP(n))continue;const{expr:t,bind:r,...i}=n;if(r&&t){const n={...i,bind:r,init:t};e.push(n)}else{const n={...i,...t?{update:t}:{},...r?{bind:r}:{}};e.push(n)}}return e}function vP(t){return"concat"in t}function bP(t){return"vconcat"in t}function xP(t){return"hconcat"in t}function _P(t){var e;let{step:n,offsetIsDiscrete:r}=t;return r?null!==(e=n.for)&&void 0!==e?e:"offset":"position"}function wP(t){return U(t)&&void 0!==t.step}function kP(t){return t.view||t.width||t.height}const AP=BS({align:1,bounds:1,center:1,columns:1,spacing:1});function EP(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function MP(t,e){const n=CP(t,e);return wP(n)?n.step:SP}function CP(t,e){var n;return QS(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const SP=20,DP={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:SP},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:hP,style:{},title:{},facet:{spacing:20},concat:{spacing:20},normalizedNumberFormat:".0%"},FP=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],TP={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},NP={blue:FP[0],orange:FP[1],red:FP[2],teal:FP[3],green:FP[4],yellow:FP[5],purple:FP[6],pink:FP[7],brown:FP[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function OP(t){const e=BS(t||{}),n={};for(const r of e){const e=t[r];n[r]=vR(e)?MT(e):CT(e)}return n}const zP=[...QO,...AR,...uP,"background","padding","legend","lineBreak","scale","style","title","view"];function RP(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,font:n,fontSize:r,selection:i,...o}=t,a=I({},wS(DP),n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:U(t)?{...NP,...t}:NP}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:U(t)?{...TP,...t}:TP}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},o||{});i&&W(a,"selection",i,!0);const s=AS(a,zP);for(const l of["background","lineBreak","padding"])a[l]&&(s[l]=CT(a[l]));for(const l of QO)a[l]&&(s[l]=yT(a[l]));for(const l of AR)a[l]&&(s[l]=OP(a[l]));for(const l of uP)a[l]&&(s[l]=yT(a[l]));return a.legend&&(s.legend=yT(a.legend)),a.scale&&(s.scale=yT(a.scale)),a.style&&(s.style=function(t){const e=BS(t),n={};for(const r of e)n[r]=OP(t[r]);return n}(a.style)),a.title&&(s.title=yT(a.title)),a.view&&(s.view=yT(a.view)),s}const PP=new Set(["view",...YO]),BP=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],LP={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]};function jP(t,e,n,r){var i,o;"view"===e&&(n="cell");const a={...r?t[e][r]:t[e],...t.style[null!==(i=n)&&void 0!==i?i:e]};PS(a)||(t.style[null!==(o=n)&&void 0!==o?o:e]=a),r||delete t[e]}function UP(t){return"layer"in t}class qP{map(t,e){return Cz(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):xP(t)?this.mapHConcat(t,e):bP(t)?this.mapVConcat(t,e):vP(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(UP(t))return this.mapLayer(t,e);if(ER(t))return this.mapUnit(t,e);throw new Error(WT(t))}mapLayer(t,e){return{...t,layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))}}mapHConcat(t,e){return{...t,hconcat:t.hconcat.map((t=>this.map(t,e)))}}mapVConcat(t,e){return{...t,vconcat:t.vconcat.map((t=>this.map(t,e)))}}mapConcat(t,e){const{concat:n,...r}=t;return{...r,concat:n.map((t=>this.map(t,e)))}}mapFacet(t,e){return{...t,spec:this.map(t.spec,e)}}mapRepeat(t,e){return{...t,spec:this.map(t.spec,e)}}}const IP={zero:1,center:1,normalize:1},WP=new Set([TO,OO,NO,LO,PO,IO,WO,RO,jO,UO]),$P=new Set([OO,NO,TO]);function HP(t){return Bz(t)&&"quantitative"===Lz(t)&&!t.bin}function ZP(t,e,n){let{orient:r,type:i}=n;const o="x"===e?"y":"radius",a="x"===e,s=t[e],l=t[o];if(Bz(s)&&Bz(l))if(HP(s)&&HP(l)){if(s.stack)return e;if(l.stack)return o;const t=Bz(s)&&!!s.aggregate;if(t!==(Bz(l)&&!!l.aggregate))return t?e:o;if(a&&"bar"===i){if("vertical"===r)return o;if("horizontal"===r)return e}}else{if(HP(s))return e;if(HP(l))return o}else{if(HP(s))return e;if(HP(l))return o}}function YP(t,e){var n,r;const i=VO(t)?t:{type:t},o=i.type;if(!WP.has(o))return null;const a=ZP(e,"x",i)||ZP(e,"theta",i);if(!a)return null;const s=e[a],l=Bz(s)?Qz(s,{}):void 0,u=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(a),c=[],f=new Set;if(e[u]){const t=e[u],n=Bz(t)?Qz(t,{}):void 0;n&&n!==l&&(c.push(u),f.add(n));const r="x"===u?"xOffset":"yOffset",i=e[r],o=Bz(i)?Qz(i,{}):void 0;o&&o!==l&&(c.push(r),f.add(o))}const d=DF.reduce(((t,n)=>{if("tooltip"!==n&&CR(e,n)){const r=e[n];for(const e of it(r)){const r=aR(e);if(r.aggregate)continue;const i=Qz(r,{});i&&f.has(i)||t.push({channel:n,fieldDef:r})}}return t}),[]);let h;return void 0!==s.stack?h=wt(s.stack)?s.stack?"zero":null:s.stack:$P.has(o)&&(h="zero"),h&&h in IP?FR(e)&&0===d.length?null:null!==s&&void 0!==s&&null!==(n=s.scale)&&void 0!==n&&n.type&&(null===s||void 0===s||null===(r=s.scale)||void 0===r?void 0:r.type)!==rO.LINEAR?(null!==s&&void 0!==s&&s.stack&&_N(function(t){return"Cannot stack non-linear scale (".concat(t,").")}(s.scale.type)),null):Wz(e[lF(a)])?(void 0!==s.stack&&_N('Cannot stack "'.concat(p=a,'" if there is already "').concat(p,'2".')),null):(Bz(s)&&s.aggregate&&!lT.has(s.aggregate)&&_N('Stacking is applied even though the aggregate function is non-summative ("'.concat(s.aggregate,'").')),{groupbyChannels:c,groupbyFields:f,fieldChannel:a,impute:null!==s.impute&&HO(o),stackBy:d,offset:h}):null;var p}function VP(t){const{point:e,line:n,...r}=t;return BS(r).length>1?r:r.type}function GP(t){for(const e of["line","area","rule","trail"])t[e]&&(t={...t,[e]:AS(t[e],["point","line"])});return t}function XP(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===t.point?{opacity:0}:t.point?U(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?U(e.point)?e.point:{}:void 0}function QP(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class JP{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(ER(t)){const{mark:n,encoding:r}=t,i=VO(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!XP(i,e[i.type],r);case"area":return!!XP(i,e[i.type],r)||!!QP(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{params:i,projection:o,mark:a,name:s,encoding:l,...u}=t,c=OR(l,r),f=VO(a)?a:{type:a},d=XP(f,r[f.type],c),h="area"===f.type&&QP(f,r[f.type]),p=[{name:s,...i?{params:i}:{},mark:VP({..."area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:AS(c,["shape"])}],m=YP(f,c);let g=c;if(m){const{fieldChannel:t,offset:e}=m;g={...c,[t]:{...c[t],...e?{stack:e}:{}}}}return g=AS(g,["y2","x2"]),h&&p.push({...o?{projection:o}:{},mark:{type:"line",...kS(f,["clip","interpolate","tension","tooltip"]),...h},encoding:g}),d&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...kS(f,["clip","tooltip"]),...d},encoding:g}),n({...u,layer:p},{...e,config:GP(r)})}}function KP(t,e){return e?Ez(t)?oB(t,e):nB(t,e):t}function tB(t,e){return e?oB(t,e):t}function eB(t,e,n){const r=e[t];return function(t){return t&&!Et(t)&&"repeat"in t}(r)?r.repeat in n?{...e,[t]:n[r.repeat]}:void _N(function(t){return'Unknown repeated value "'.concat(t,'".')}(r.repeat)):e}function nB(t,e){if(void 0!==(t=eB("field",t,e))){if(null===t)return null;if(Dz(t)&&kz(t.sort)){const n=eB("field",t.sort,e);t={...t,...n?{sort:n}:{}}}return t}}function rB(t,e){if(Bz(t))return nB(t,e);{const n=eB("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function iB(t,e){if(!Wz(t)){if(Pz(t)){const n=rB(t.condition,e);if(n)return{...t,condition:n};{const{condition:e,...n}=t;return n}}return t}{const n=rB(t,e);if(n)return n;if(zz(t))return{condition:t.condition}}}function oB(t,e){const n={};for(const r in t)if(yt(t,r)){const i=t[r];if(L(i))n[r]=i.map((t=>iB(t,e))).filter((t=>t));else{const t=iB(i,e);void 0!==t&&(n[r]=t)}}return n}class aB{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(ER(t)){const{encoding:e,mark:n}=t;if("line"===n||VO(n)&&"line"===n.type)for(const t of iF){const n=e[aF(t)];if(e[t]&&(Bz(n)&&!dT(n.bin)||jz(n)))return!0}}return!1}run(t,e,n){const{encoding:r,mark:i}=t;var o,a;return _N((o=!!r.x2,a=!!r.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(o&&a?"x2 and y2":o?"x2":"y2",". We will use the rule mark (line segments) instead."))),n({...t,mark:U(i)?{...i,type:"rule"}:"rule"},e)}}function sB(t){let{parentEncoding:e,encoding:n={},layer:r}=t,i={};if(e){const t=new Set([...BS(e),...BS(n)]);for(const o of t){const t=n[o],a=e[o];if(Wz(t)){const e={...a,...t};i[o]=e}else Pz(t)?i[o]={...t,condition:{...a,...t.condition}}:t||null===t?i[o]=t:(r||Hz(a)||xT(a)||Wz(a)||L(a))&&(i[o]=a)}}else i=n;return!i||PS(i)?void 0:i}function lB(t){const{parentProjection:e,projection:n}=t;return e&&n&&_N(function(t){const{parentProjection:e,projection:n}=t;return"Layer's shared projection ".concat(ES(e)," is overridden by a child projection ").concat(ES(n),".")}({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function uB(t){return"filter"in t}function cB(t){return"lookup"in t}function fB(t){return"pivot"in t}function dB(t){return"density"in t}function hB(t){return"quantile"in t}function pB(t){return"regression"in t}function mB(t){return"loess"in t}function gB(t){return"sample"in t}function yB(t){return"window"in t}function vB(t){return"joinaggregate"in t}function bB(t){return"flatten"in t}function xB(t){return"calculate"in t}function _B(t){return"bin"in t}function wB(t){return"impute"in t}function kB(t){return"timeUnit"in t}function AB(t){return"aggregate"in t}function EB(t){return"stack"in t}function MB(t){return"fold"in t}function CB(t,e){const{transform:n,...r}=t;if(n){const t=n.map((t=>{if(uB(t))return{filter:FB(t,e)};if(_B(t)&&hT(t.bin))return{...t,bin:DB(t.bin)};if(cB(t)){const{selection:e,...n}=t.from;return e?{...t,from:{param:e,...n}}:t}return t}));return{...r,transform:t}}return t}function SB(t,e){var n;const r=wS(t);if(Bz(r)&&hT(r.bin)&&(r.bin=DB(r.bin)),Zz(r)&&null!==(n=r.scale)&&void 0!==n&&null!==(n=n.domain)&&void 0!==n&&n.selection){const{selection:t,...e}=r.scale.domain;r.scale.domain={...e,...t?{param:t}:{}}}if(zz(r))if(L(r.condition))r.condition=r.condition.map((t=>{const{selection:n,param:r,test:i,...o}=t;return r?t:{...o,test:FB(t,e)}}));else{const{selection:t,param:n,test:i,...o}=SB(r.condition,e);r.condition=n?r.condition:{...o,test:FB(r.condition,e)}}return r}function DB(t){const e=t.extent;if(null!==e&&void 0!==e&&e.selection){const{selection:n,...r}=e;return{...t,extent:{...r,param:n}}}return t}function FB(t,e){const n=t=>xS(t,(t=>{var n,r,i;const o={param:t,empty:null===(n=e.emptySelections[t])||void 0===n||n};return null!==(r=(i=e.selectionPredicates)[t])&&void 0!==r||(i[t]=[]),e.selectionPredicates[t].push(o),o}));return t.selection?n(t.selection):xS(t.test||t.filter,(t=>t.selection?n(t.selection):t))}class TB extends qP{map(t,e){var n;const r=null!==(n=e.selections)&&void 0!==n?n:[];if(t.params&&!ER(t)){const e=[];for(const n of t.params)gP(n)?r.push(n):e.push(n);t.params=e}return e.selections=r,super.map(t,e)}mapUnit(t,e){var n;const r=e.selections;if(!r||!r.length)return t;const i=(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name),o=[];for(const a of r)if(a.views&&a.views.length)for(const e of a.views)(Et(e)&&(e===t.name||i.includes(e))||L(e)&&e.map((t=>i.indexOf(t))).every(((t,e,n)=>-1!==t&&(0===e||t>n[e-1]))))&&o.push(a);else o.push(a);return o.length&&(t.params=o),t}}for(const n of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=TB.prototype[n];TB.prototype[n]=function(e,n){return t.call(this,e,NB(e,n))}}function NB(t,e){var n;return t.name?{...e,path:(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name)}:e}const OB=new class extends qP{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[$R,GR,tP,new JP,new aB]}map(t,e){if(ER(t)){const n=CR(t.encoding,eD),r=CR(t.encoding,nD),i=CR(t.encoding,rD);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=tB(t.encoding,e.repeater),o={...t,...t.name?{name:[e.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{},...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,e);const a=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(o,e.config))return s.run(o,e,a);return o}mapRepeat(t,e){return function(t){return!L(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r,...i}=t,{row:o,column:a,layer:s}=n,{repeater:l={},repeaterPrefix:u=""}=e;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:r}},e):{...i,layer:s.map((t=>{const n={...l,layer:t},i="".concat((r.name?"".concat(r.name,"_"):"")+u,"child__layer_").concat(qS(t)),o=this.mapLayerOrUnit(r,{...e,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:o,...a}=t;!L(r)&&t.columns&&(t=AS(t,["columns"]),_N(QT("repeat")));const s=[],{repeater:l={},repeaterPrefix:u=""}=e,c=!L(r)&&r.row||[l?l.row:null],f=!L(r)&&r.column||[l?l.column:null],d=L(r)&&r||[l?l.repeat:null];for(const p of d)for(const t of c)for(const n of f){const o={repeat:p,row:t,column:n,layer:l.layer},a=(i.name?"".concat(i.name,"_"):"")+u+"child__"+(L(r)?"".concat(qS(p)):(r.row?"row_".concat(qS(t)):"")+(r.column?"column_".concat(qS(n)):"")),c=this.map(i,{...e,repeater:o,repeaterPrefix:a});c.name=a,s.push(AS(c,["data"]))}const h=L(r)?t.columns:r.column?r.column.length:1;return{data:null!==(n=i.data)&&void 0!==n?n:o,align:"all",...a,columns:h,concat:s}}mapFacet(t,e){const{facet:n}=t;return Ez(n)&&t.columns&&(t=AS(t,["columns"]),_N(QT("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:o,config:a}=e,s=lB({parentProjection:o,projection:r}),l=sB({parentEncoding:i,encoding:tB(n,e.repeater)});return this.mapUnit({...t,...s?{projection:s}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,e){const{row:n,column:r,facet:i,...o}=t.encoding,{mark:a,width:s,projection:l,height:u,view:c,params:f,encoding:d,...h}=t,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},e),g=tB(o,e.repeater);return this.mapFacet({...h,...m,facet:p,spec:{...s?{width:s}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:a,encoding:g,...f?{params:f}:{}}},e)}getFacetMappingAndLayout(t,e){const{row:n,column:r,facet:i}=t;if(n||r){i&&_N("Facet encoding dropped as ".concat((a=[...n?[eD]:[],...r?[nD]:[]]).join(" and ")," ").concat(a.length>1?"are":"is"," also specified."));const e={},s={};for(const n of[eD,nD]){const r=t[n];if(r){const{align:t,center:i,spacing:a,columns:l,...u}=r;e[n]=u;for(const e of["align","center","spacing"]){var o;void 0!==r[e]&&(null!==(o=s[e])&&void 0!==o||(s[e]={}),s[e][n]=r[e])}}}return{facetMapping:e,layout:s}}{const{align:t,center:n,spacing:r,columns:o,...a}=i;return{facetMapping:KP(a,e.repeater),layout:{...t?{align:t}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}var a}mapLayer(t,e){let{parentEncoding:n,parentProjection:r,...i}=e;const{encoding:o,projection:a,...s}=t,l={...i,parentEncoding:sB({parentEncoding:n,encoding:o,layer:!0}),parentProjection:lB({parentProjection:r,projection:a})};return super.mapLayer({...s,...t.name?{name:[l.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{}},l)}},zB=new class extends qP{map(t,e){var n,r;return null!==(n=e.emptySelections)&&void 0!==n||(e.emptySelections={}),null!==(r=e.selectionPredicates)&&void 0!==r||(e.selectionPredicates={}),t=CB(t,e),super.map(t,e)}mapLayerOrUnit(t,e){if((t=CB(t,e)).encoding){const n={};for(const[r,i]of jS(t.encoding))n[r]=SB(i,e);t={...t,encoding:n}}return super.mapLayerOrUnit(t,e)}mapUnit(t,e){const{selection:n,...r}=t;return n?{...r,params:jS(n).map((t=>{let[n,r]=t;const{init:i,bind:o,empty:a,...s}=r;"single"===s.type?(s.type="point",s.toggle=!1):"multi"===s.type&&(s.type="point"),e.emptySelections[n]="none"!==a;for(const u of LS(null!==(l=e.selectionPredicates[n])&&void 0!==l?l:{})){var l;u.empty="none"!==a}return{name:n,value:i,select:s,bind:o}}))}:t}},RB=new TB;function PB(t){return Et(t)?{type:t}:null!==t&&void 0!==t?t:{}}const BB=["background","padding"];function LB(t,e){const n={};for(const r of BB)t&&void 0!==t[r]&&(n[r]=CT(t[r]));return e&&(n.params=t.params),n}class jB{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.explicit=t,this.implicit=e}clone(){return new jB(wS(this.explicit),wS(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return QS(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,e){let{value:n,explicit:r}=e;void 0!==n&&this.set(t,n,r)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,e){let{explicit:n,implicit:r}=e;void 0!==n[t]?this.set(t,n[t],!0):void 0!==r[t]&&this.set(t,r[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of BS(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function UB(t){return{explicit:!0,value:t}}function qB(t){return{explicit:!1,value:t}}function IB(t){return(e,n,r,i)=>{const o=t(e.value,n.value);return o>0?e:o<0?n:WB(e,n,r,i)}}function WB(t,e,n,r){return t.explicit&&e.explicit&&_N(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(ES(n)," and ").concat(ES(r),"). Using ").concat(ES(n),".")}(n,r,t.value,e.value)),t}function $B(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:WB;return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:_S(t.value,e.value)?t:i(t,e,n,r)}class HB extends jB{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function ZB(t){return"url"in t}function YB(t){return"values"in t}function VB(t){return"name"in t&&!ZB(t)&&!YB(t)&&!GB(t)}function GB(t){return t&&(XB(t)||QB(t)||JB(t))}function XB(t){return"sequence"in t}function QB(t){return"sphere"in t}function JB(t){return"graticule"in t}var KB;function tL(t){const{signals:e,hasLegend:n,index:r,...i}=t;return i.field=YS(i.field),i}function eL(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;if(L(t)){const r=t.map((t=>eL(t,e,n)));return e?"[".concat(r.join(", "),"]"):r}return wN(t)?n(e?SN(t):function(t){const e=CN(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n(ES(t)):t}function nL(t,e){for(const r of LS(null!==(n=t.component.selection)&&void 0!==n?n:{})){var n;const i=r.name;let o="".concat(i).concat(xj,", ").concat("global"===r.resolve?"true":"{unit: ".concat(Aj(t),"}"));for(const n of kj)n.defined(r)&&(n.signals&&(e=n.signals(t,r,e)),n.modifyExpr&&(o=n.modifyExpr(t,r,o)));e.push({name:i+_j,on:[{events:{signal:r.name+xj},update:"modify(".concat(Dt(r.name+bj),", ").concat(o,")")}]})}return oL(e)}function rL(t,e){if(t.component.selection&&BS(t.component.selection).length){const n=Dt(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:Wk("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return oL(e)}function iL(t,e){for(const r of LS(null!==(n=t.component.selection)&&void 0!==n?n:{})){var n;for(const n of kj)n.defined(r)&&n.marks&&(e=n.marks(t,r,e))}return e}function oL(t){return t.map((t=>(t.on&&!t.on.length&&delete t.on,t)))}!function(t){t[t.Raw=0]="Raw",t[t.Main=1]="Main",t[t.Row=2]="Row",t[t.Column=3]="Column",t[t.Lookup=4]="Lookup"}(KB||(KB={}));class aL{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.includes(t)?_N("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const n=t.parent.removeChild(t);this._parent=e,e.addChild(this,n),t.parent=this}}class sL extends aL{clone(){const t=new this.constructor;return t.debugName="clone_".concat(this.debugName),t._source=this._source,t._name="clone_".concat(this._name),t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output ".concat(++JS)),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class lL extends aL{clone(){return new lL(null,wS(this.formula))}constructor(t,e){super(t),this.formula=e}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,e)=>{const{field:n,timeUnit:r}=e;if(r){const i=Qz(e,{forAs:!0});t[MS({as:i,field:n,timeUnit:r})]={as:i,field:n,timeUnit:r}}return t}),{});return PS(n)?null:new lL(t,n)}static makeFromTransform(t,e){const{timeUnit:n,...r}={...e},i={...r,timeUnit:PN(n)};return new lL(t,{[MS(i)]:i})}merge(t){this.formula={...this.formula};for(const e in t.formula)this.formula[e]||(this.formula[e]=t.formula[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}removeFormulas(t){const e={};for(const[n,r]of jS(this.formula))t.has(r.as)||(e[n]=r);this.formula=e}producedFields(){return new Set(LS(this.formula).map((t=>t.as)))}dependentFields(){return new Set(LS(this.formula).map((t=>t.field)))}hash(){return"TimeUnit ".concat(MS(this.formula))}assemble(){const t=[];for(const e of LS(this.formula)){const{field:n,as:r,timeUnit:i}=e,{unit:o,utc:a,...s}=PN(i);t.push({field:YS(n),type:"timeunit",...o?{units:ON(o)}:{},...a?{timezone:"utc"}:{},...s,as:[r,"".concat(r,"_end")]})}return t}}const uL="_tuple_fields";class cL{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.items=e,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const fL={defined:()=>!0,parse:(t,e,n)=>{var r;const i=e.name,o=null!==(r=e.project)&&void 0!==r?r:e.project=new cL,a={},s={},l=new Set,u=(t,e)=>{const n="visual"===e?t.channel:t.field;let r=qS("".concat(i,"_").concat(n));for(let o=1;l.has(r);o++)r=qS("".concat(i,"_").concat(n,"_").concat(o));return l.add(r),{[e]:r}},c=e.type,f=t.config.selection[c],d=void 0!==n.value?it(n.value):null;let{fields:h,encodings:p}=U(n.select)?n.select:{};if(!h&&!p&&d)for(const v of d)if(U(v))for(const t of BS(v)){var m;nF[t]?(p||(p=[])).push(t):"interval"===c?(_N('Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.'),p=f.encodings):(null!==(m=h)&&void 0!==m?m:h=[]).push(t)}h||p||(p=f.encodings,"fields"in f&&(h=f.fields));for(const v of null!==(g=p)&&void 0!==g?g:[]){var g;const e=t.fieldDef(v);if(e){let n=e.field;if(e.aggregate){_N(GT(v,e.aggregate));continue}if(!n){_N(VT(v));continue}if(e.timeUnit){n=t.vgField(v);const r={timeUnit:e.timeUnit,as:n,field:e.field};s[MS(r)]=r}if(!a[n]){const r={field:n,channel:v,type:"interval"===c&&XF(v)&&mO(t.getScaleComponent(v).get("type"))?"R":e.bin?"R-RE":"E",index:o.items.length};r.signals={...u(r,"data"),...u(r,"visual")},o.items.push(a[n]=r),o.hasField[n]=a[n],o.hasSelectionId=o.hasSelectionId||n===dP,qD(v)?(r.geoChannel=v,r.channel=UD(v),o.hasChannel[r.channel]=a[n]):o.hasChannel[v]=a[n]}}else _N(VT(v))}for(const v of null!==(y=h)&&void 0!==y?y:[]){var y;if(o.hasField[v])continue;const t={type:"E",field:v,index:o.items.length};t.signals={...u(t,"data")},o.items.push(t),o.hasField[v]=t,o.hasSelectionId=o.hasSelectionId||v===dP}d&&(e.init=d.map((t=>o.items.map((e=>U(t)?void 0!==t[e.geoChannel||e.channel]?t[e.geoChannel||e.channel]:t[e.field]:t))))),PS(s)||(o.timeUnit=new lL(null,s))},signals:(t,e,n)=>{const r=e.name+uL;return n.filter((t=>t.name===r)).length>0||e.project.hasSelectionId?n:n.concat({name:r,value:e.project.items.map(tL)})}},dL=fL,hL={defined:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!XF(i))continue;const o=t.getScaleComponent(i),a=o?o.get("type"):void 0;o&&mO(a)?(o.set("selectionExtent",{param:e.name,field:r.field},!0),n.push(r)):_N("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter((t=>0===n.filter((e=>e.name===t.signals.data)).length));if(!t.parent||gL(t)||0===r.length)return n;const i=n.filter((t=>t.name===e.name))[0];let o=i.update;if(o.indexOf(wj)>=0)i.update="{".concat(r.map((t=>"".concat(Dt(YS(t.field)),": ").concat(t.signals.data))).join(", "),"}");else{for(const t of r){const e="".concat(Dt(YS(t.field)),": ").concat(t.signals.data);o.includes(e)||(o="".concat(o.substring(0,o.length-1),", ").concat(e,"}"))}i.update=o}return n.concat(r.map((t=>({name:t.signals.data}))))},signals:(t,e,n)=>{if(t.parent&&!gL(t))for(const r of e.scales){const t=n.filter((t=>t.name===r.signals.data))[0];t.push="outer",delete t.value,delete t.update}return n}},pL=hL;function mL(t,e){return"domain(".concat(Dt(t.scaleName(e)),")")}function gL(t){var e;return t.parent&&rI(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:gL(t.parent.parent))}const yL="_brush",vL="_scale_trigger",bL="geo_interval_init_tick",xL="_init",_L={defined:t=>"interval"===t.type,parse:(t,e,n)=>{var r;if(t.hasProjection){const t={...U(n.select)?n.select:{}};t.fields=[dP],t.encodings||(t.encodings=n.value?BS(n.value):[mD,pD]),n.select={type:"interval",...t}}if(e.translate&&!pL.defined(e)){const t="!event.item || event.item.mark.name !== ".concat(Dt(e.name+yL));for(const n of e.events){var i;if(!n.between){_N("".concat(n," is not an ordered event stream for interval selections."));continue}const e=it(null!==(i=(r=n.between[0]).filter)&&void 0!==i?i:r.filter=[]);e.indexOf(t)<0&&e.push(t)}}},signals:(t,e,n)=>{const r=e.name,i=r+xj,o=LS(e.project.hasChannel).filter((t=>t.channel===iD||t.channel===oD)),a=e.init?e.init[0]:null;if(n.push(...o.reduce(((n,r)=>n.concat(function(t,e,n,r){const i=!t.hasProjection,o=n.channel,a=n.signals.visual,s=Dt(i?t.scaleName(o):t.projectionName()),l=t=>"scale(".concat(s,", ").concat(t,")"),u=t.getSizeSignalRef(o===iD?"width":"height").signal,c="".concat(o,"(unit)"),f=e.events.reduce(((t,e)=>[...t,{events:e.between[0],update:"[".concat(c,", ").concat(c,"]")},{events:e,update:"[".concat(a,"[0], clamp(").concat(c,", 0, ").concat(u,")]")}]),[]);if(i){const i=n.signals.data,u=pL.defined(e),c=t.getScaleComponent(o),d=c?c.get("type"):void 0,h=r?{init:eL(r,!0,l)}:{value:[]};return f.push({events:{signal:e.name+vL},update:mO(d)?"[".concat(l("".concat(i,"[0]")),", ").concat(l("".concat(i,"[1]")),"]"):"[0, 0]"}),u?[{name:i,on:[]}]:[{name:a,...h,on:f},{name:i,...r?{init:eL(r)}:{},on:[{events:{signal:a},update:"".concat(a,"[0] === ").concat(a,"[1] ? null : invert(").concat(s,", ").concat(a,")")}]}]}{const t=o===iD?0:1,n=e.name+xL;return[{name:a,...r?{init:"[".concat(n,"[0][").concat(t,"], ").concat(n,"[1][").concat(t,"]]")}:{value:[]},on:f}]}}(t,e,r,a&&a[r.index]))),[])),t.hasProjection){const s=Dt(t.projectionName()),l=t.projectionName()+"_center",{x:u,y:c}=e.project.hasChannel,f=u&&u.signals.visual,d=c&&c.signals.visual,h=u?a&&a[u.index]:"".concat(l,"[0]"),p=c?a&&a[c.index]:"".concat(l,"[1]"),m=e=>t.getSizeSignalRef(e).signal,g="[[".concat(f?f+"[0]":"0",", ").concat(d?d+"[0]":"0","],[").concat(f?f+"[1]":m("width"),", ").concat(d?d+"[1]":m("height"),"]]");!a||(n.unshift({name:r+xL,init:"[scale(".concat(s,", [").concat(u?h[0]:h,", ").concat(c?p[0]:p,"]), scale(").concat(s,", [").concat(u?h[1]:h,", ").concat(c?p[1]:p,"])]")}),u&&c)||n.find((t=>t.name===l))||n.unshift({name:l,update:"invert(".concat(s,", [").concat(m("width"),"/2, ").concat(m("height"),"/2])")});const y="vlSelectionTuples(intersect(".concat(g,", {markname: ").concat(Dt(t.getName("marks")),"}, unit.mark), {unit: ").concat(Aj(t),"})"),v=o.map((t=>t.signals.visual));return n.concat({name:i,on:[{events:[...v.length?[{signal:v.join(" || ")}]:[],...a?[{signal:bL}]:[]],update:y}]})}{if(!pL.defined(e)){const e=r+vL,i=o.map((e=>{const n=e.channel,{data:r,visual:i}=e.signals,o=Dt(t.scaleName(n)),a=mO(t.getScaleComponent(n).get("type"))?"+":"";return"(!isArray(".concat(r,") || (").concat(a,"invert(").concat(o,", ").concat(i,")[0] === ").concat(a).concat(r,"[0] && ").concat(a,"invert(").concat(o,", ").concat(i,")[1] === ").concat(a).concat(r,"[1]))")}));i.length&&n.push({name:e,value:{},on:[{events:o.map((e=>({scale:t.scaleName(e.channel)}))),update:i.join(" && ")+" ? ".concat(e," : {}")}]})}const s=o.map((t=>t.signals.data)),l="unit: ".concat(Aj(t),", fields: ").concat(r+uL,", values");return n.concat({name:i,...a?{init:"{".concat(l,": ").concat(eL(a),"}")}:{},...s.length?{on:[{events:[{signal:s.join(" || ")}],update:"".concat(s.join(" && ")," ? {").concat(l,": [").concat(s,"]} : null")}]}:{}})}},topLevelSignals:(t,e,n)=>(tI(t)&&t.hasProjection&&e.init&&(n.filter((t=>t.name===bL)).length||n.unshift({name:bL,value:null,on:[{events:"timer{1}",update:"".concat(bL," === null ? {} : ").concat(bL)}]})),n),marks:(t,e,n)=>{const r=e.name,{x:i,y:o}=e.project.hasChannel,a=null===i||void 0===i?void 0:i.signals.visual,s=null===o||void 0===o?void 0:o.signals.visual,l="data(".concat(Dt(e.name+bj),")");if(pL.defined(e)||!i&&!o)return n;const u={x:void 0!==i?{signal:"".concat(a,"[0]")}:{value:0},y:void 0!==o?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==i?{signal:"".concat(a,"[1]")}:{field:{group:"width"}},y2:void 0!==o?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===e.resolve)for(const m of BS(u))u[m]=[{test:"".concat(l,".length && ").concat(l,"[0].unit === ").concat(Aj(t)),...u[m]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=e.mark,p=BS(h).reduce(((t,e)=>(t[e]=[{test:[void 0!==i&&"".concat(a,"[0] !== ").concat(a,"[1]"),void 0!==o&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter((t=>t)).join(" && "),value:h[e]},{value:null}],t)),{});return[{name:"".concat(r+yL,"_bg"),type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:u}},...n,{name:r+yL,type:"rect",clip:!0,encode:{enter:{...d?{cursor:{value:d}}:{},fill:{value:"transparent"}},update:{...u,...p}}}]}},wL=_L,kL={defined:t=>"point"===t.type,signals:(t,e,n)=>{var r;const i=e.name,o=i+uL,a=e.project,s="(item().isVoronoi ? datum.datum : datum)",l=LS(null!==(r=t.component.selection)&&void 0!==r?r:{}).reduce(((t,e)=>"interval"===e.type?t.concat(e.name+yL):t),[]).map((t=>"indexof(item().mark.name, '".concat(t,"') < 0"))).join(" && "),u="datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0"+(l?" && ".concat(l):"");let c="unit: ".concat(Aj(t),", ");e.project.hasSelectionId?c+="".concat(dP,": ").concat(s,"[").concat(Dt(dP),"]"):c+="fields: ".concat(o,", values: [").concat(a.items.map((e=>{const n=t.fieldDef(e.channel);return null!==n&&void 0!==n&&n.bin?"[".concat(s,"[").concat(Dt(t.vgField(e.channel,{})),"], ").concat(s,"[").concat(Dt(t.vgField(e.channel,{binSuffix:"end"})),"]]"):"".concat(s,"[").concat(Dt(e.field),"]")})).join(", "),"]");const f=e.events;return n.concat([{name:i+xj,on:f?[{events:f,update:"".concat(u," ? {").concat(c,"} : null"),force:!0}]:[]}])}},AL=kL;function EL(t,e,n,r){const i=zz(e)&&e.condition,o=r(e);if(i){const e=it(i).map((e=>{const n=r(e);if(function(t){return t.param}(e)){const{param:r,empty:i}=e;return{test:Tj(t,{param:r,empty:i}),...n}}return{test:Oj(t,e.test),...n}}));return{[n]:[...e,...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function ML(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";const n=t.encoding[e];return EL(t,n,e,(e=>CL(e,t.config)))}function CL(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(t){if(Hz(t))return DT(t.value);if(Wz(t)){const{format:r,formatType:i}=oR(t);return cz({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function SL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{encoding:n,markDef:r,config:i,stack:o}=t,a=n.tooltip;if(L(a))return{tooltip:FL({tooltip:a},o,i,e)};{const s=e.reactiveGeom?"datum.datum":"datum";return EL(t,a,"tooltip",(t=>{const a=CL(t,i,s);if(a)return a;if(null===t)return;let l=RT("tooltip",r,i);return!0===l&&(l={content:"encoding"}),Et(l)?{value:l}:U(l)?xT(l)?l:"encoding"===l.content?FL(n,o,i,e):{signal:s}:void 0}))}}function DL(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={...n,...n.tooltipFormat},o={},a=r?"datum.datum":"datum",s=[];function l(n,r){var l;const u=aF(r),c=$z(n)?n:{...n,type:t[u].type},f=it(c.title||iR(c,i)).join(", ");let d;if(NF(r)){const e="x"===r?"x2":"y2",n=aR(t[e]);if(dT(c.bin)&&n){const t=Qz(c,{expr:a}),r=Qz(n,{expr:a}),{format:s,formatType:l}=oR(c);d=vz(t,r,s,l,i),o[e]=!0}}if((NF(r)||r===dD||r===cD)&&e&&e.fieldChannel===r&&"normalize"===e.offset){const{format:t,formatType:e}=oR(c);d=cz({fieldOrDatumDef:c,format:t,formatType:e,expr:a,config:i,normalizeStack:!0}).signal}null!==(l=d)&&void 0!==l||(d=CL(c,i,a).signal),s.push({channel:r,key:f,value:d})}zR(t,((t,e)=>{Bz(t)?l(t,e):Rz(t)&&l(t.condition,e)}));const u={};for(const{channel:c,key:f,value:d}of s)o[c]||u[f]||(u[f]=d);return u}function FL(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=DL(t,e,n,{reactiveGeom:r}),o=jS(i).map((t=>{let[e,n]=t;return'"'.concat(e,'": ').concat(n)}));return o.length>0?{signal:"{".concat(o.join(", "),"}")}:void 0}function TL(t){const{markDef:e,config:n}=t,r=RT("aria",e,n);return!1===r?{}:{...r?{aria:r}:{},...NL(t),...OL(t)}}function NL(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=RT("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:e in AT?{}:{ariaRoleDescription:{value:e}}}function OL(t){const{encoding:e,markDef:n,config:r,stack:i}=t,o=e.description;if(o)return EL(t,o,"description",(e=>CL(e,t.config)));const a=RT("description",n,r);if(null!=a)return{description:DT(a)};if(!1===r.aria)return{};const s=DL(e,i,r);return PS(s)?void 0:{description:{signal:jS(s).map(((t,e)=>{let[n,r]=t;return'"'.concat(e>0?"; ":"").concat(n,': " + (').concat(r,")")})).join(" + ")}}}function zL(t,e){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{markDef:i,encoding:o,config:a}=e,{vgChannel:s}=r;let{defaultRef:l,defaultValue:u}=r;void 0===l&&(null!==(n=u)&&void 0!==n||(u=RT(t,i,a,{vgChannel:s,ignoreVgConfig:!0})),void 0!==u&&(l=DT(u)));const c=o[t];return EL(e,c,null!==s&&void 0!==s?s:t,(n=>oz({channel:t,channelDef:n,markDef:i,config:a,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:l})))}function RL(t){var e,n,r,i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0};const{markDef:a,encoding:s,config:l}=t,{type:u}=a,c=null!==(e=o.filled)&&void 0!==e?e:RT("filled",a,l),f=SS(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,d=null!==(n=null!==(r=RT(!0===c?"color":void 0,a,l,{vgChannel:"fill"}))&&void 0!==r?r:l.mark[!0===c&&"color"])&&void 0!==n?n:f,h=null!==(i=RT(!1===c?"color":void 0,a,l,{vgChannel:"stroke"}))&&void 0!==i?i:l.mark[!1===c&&"color"],p=c?"fill":"stroke",m={...d?{fill:DT(d)}:{},...h?{stroke:DT(h)}:{}};return a.color&&(c?a.fill:a.stroke)&&_N(rN("property",{fill:"fill"in a,stroke:"stroke"in a})),{...m,...zL("color",t,{vgChannel:p,defaultValue:c?d:h}),...zL("fill",t,{defaultValue:s.fill?d:void 0}),...zL("stroke",t,{defaultValue:s.stroke?h:void 0})}}function PL(t){const{encoding:e,mark:n}=t,r=e.order;return!HO(n)&&Hz(r)?EL(t,r,"zindex",(t=>DT(t.value))):{}}function BL(t){let{channel:e,markDef:n,encoding:r={},model:i,bandPosition:o}=t;const a="".concat(e,"Offset"),s=n[a],l=r[a];if(("xOffset"===a||"yOffset"===a)&&l)return{offsetType:"encoding",offset:oz({channel:a,channelDef:l,markDef:n,config:null===i||void 0===i?void 0:i.config,scaleName:i.scaleName(a),scale:i.getScaleComponent(a),stack:null,defaultRef:DT(s),bandPosition:o})};const u=n[a];return u?{offsetType:"visual",offset:u}:{}}function LL(t,e,n){let{defaultPos:r,vgChannel:i}=n;const{encoding:o,markDef:a,config:s,stack:l}=e,u=o[t],c=o[lF(t)],f=e.scaleName(t),d=e.getScaleComponent(t),{offset:h,offsetType:p}=BL({channel:t,markDef:a,encoding:o,model:e,bandPosition:.5}),m=jL({model:e,defaultPos:r,channel:t,scaleName:f,scale:d}),g=!u&&NF(t)&&(o.latitude||o.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,scaleName:r,stack:i,offset:o,markDef:a}=t;if(Wz(n)&&i&&e===i.fieldChannel){if(Bz(n)){let t=n.bandPosition;if(void 0!==t||"text"!==a.type||"radius"!==e&&"theta"!==e||(t=.5),void 0!==t)return iz({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:t,offset:o})}return rz(n,r,{suffix:"end"},{offset:o})}return tz(t)}({channel:t,channelDef:u,channel2Def:c,markDef:a,config:s,scaleName:f,scale:d,stack:l,offset:h,defaultRef:m,bandPosition:"encoding"===p?0:void 0});return g?{[i||t]:g}:void 0}function jL(t){let{model:e,defaultPos:n,channel:r,scaleName:i,scale:o}=t;const{markDef:a,config:s}=e;return()=>{const t=aF(r),l=sF(r),u=RT(r,a,s,{vgChannel:l});if(void 0!==u)return az(r,u);switch(n){case"zeroOrMin":case"zeroOrMax":if(i){const t=o.get("type");if(SS([rO.LOG,rO.TIME,rO.UTC],t));else if(o.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===n)return"y"===t?{field:{group:"height"}}:{value:0};switch(t){case"radius":return{signal:"min(".concat(e.width.signal,",").concat(e.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...e[uF(r)],mult:.5}}}}const UL={left:"x",center:"xc",right:"x2"},qL={top:"y",middle:"yc",bottom:"y2"};function IL(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===t||"theta"===t)return sF(t);const i="x"===t?"align":"baseline",o=RT(i,e,n);let a;return xT(o)?(_N(function(t){return"The ".concat(t," for range marks cannot be an expression")}(i)),a=void 0):a=o,"x"===t?UL[a||("top"===r?"left":"center")]:qL[a||r]}function WL(t,e,n){let{defaultPos:r,defaultPos2:i,range:o}=n;return o?$L(t,e,{defaultPos:r,defaultPos2:i}):LL(t,e,{defaultPos:r})}function $L(t,e,n){let{defaultPos:r,defaultPos2:i}=n;const{markDef:o,config:a}=e,s=lF(t),l=uF(t),u=function(t,e,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=t,l=aF(n),u=uF(n),c=sF(n),f=r[l],d=t.scaleName(l),h=t.getScaleComponent(l),{offset:p}=BL(n in r||n in o?{channel:n,markDef:o,encoding:r,model:t}:{channel:l,markDef:o,encoding:r,model:t});if(!f&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const e=uF(n),r=t.markDef[e];return null!=r?{[e]:{value:r}}:{[c]:{field:t.getName(n)}}}const m=function(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c}=t;return Wz(n)&&l&&e.charAt(0)===l.fieldChannel.charAt(0)?rz(n,a,{suffix:"start"},{offset:u}):tz({channel:e,channelDef:r,scaleName:a,scale:s,stack:l,markDef:i,config:o,offset:u,defaultRef:c})}({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:p,defaultRef:void 0});return void 0!==m?{[c]:m}:HL(n,o)||HL(n,{[n]:BT(n,o,s.style),[u]:BT(u,o,s.style)})||HL(n,s[i])||HL(n,s.mark)||{[c]:jL({model:t,defaultPos:e,channel:n,scaleName:d,scale:h})()}}(e,i,s);return{...LL(t,e,{defaultPos:r,vgChannel:u[l]?IL(t,o,a):sF(t)}),...u}}function HL(t,e){const n=uF(t),r=sF(t);if(void 0!==e[r])return{[r]:az(t,e[r])};if(void 0!==e[t])return{[r]:az(t,e[t])};if(e[n]){const r=e[n];if(!JO(r))return{[n]:az(t,r)};_N(function(t){return"Position range does not support relative band size for ".concat(t,".")}(n))}}function ZL(t,e){var n,r;const{config:i,encoding:o,markDef:a}=t,s=a.type,l=lF(e),u=uF(e),c=o[e],f=o[l],d=t.getScaleComponent(e),h=d?d.get("type"):void 0,p=a.orient,m=null!==(n=null!==(r=o[u])&&void 0!==r?r:o.size)&&void 0!==n?n:RT("size",a,i,{vgChannel:u}),g=cF(e),y="bar"===s&&("x"===e?"vertical"===p:"horizontal"===p);return!Bz(c)||!(fT(c.bin)||dT(c.bin)||c.timeUnit&&!f)||m&&!JO(m)||o[g]||pO(h)?(Wz(c)&&pO(h)||y)&&!f?function(t,e,n){const{markDef:r,encoding:i,config:o,stack:a}=n,s=r.orient,l=n.scaleName(e),u=n.getScaleComponent(e),c=uF(e),f=lF(e),d=cF(e),h=n.scaleName(d),p=n.getScaleComponent(fF(e)),m="horizontal"===s&&"y"===e||"vertical"===s&&"x"===e;let g;(i.size||r.size)&&(m?g=zL("size",n,{vgChannel:c,defaultRef:DT(r.size)}):_N(function(t){return'Cannot apply size to non-oriented mark "'.concat(t,'".')}(r.type)));const y=!!g,v=Tz({channel:e,fieldDef:t,markDef:r,config:o,scaleType:null===u||void 0===u?void 0:u.get("type"),useVlSizeChannel:m});g=g||{[c]:YL(c,h||l,p||u,o,v,!!t,r.type)};const b=IL(e,r,o,"band"===(null===u||void 0===u?void 0:u.get("type"))&&JO(v)&&!y?"top":"middle"),x="xc"===b||"yc"===b,{offset:_,offsetType:w}=BL({channel:e,markDef:r,encoding:i,model:n,bandPosition:x?.5:0}),k=tz({channel:e,channelDef:t,markDef:r,config:o,scaleName:l,scale:u,stack:a,offset:_,defaultRef:jL({model:n,defaultPos:"mid",channel:e,scaleName:l,scale:u}),bandPosition:x?"encoding"===w?0:.5:xT(v)?{signal:"(1-".concat(v,")/2")}:JO(v)?(1-v.band)/2:0});if(c)return{[b]:k,...g};{const t=sF(f),e=g[c],n=_?{...e,offset:_}:e;return{[b]:k,[t]:L(k)?[k[0],{...k[1],offset:n}]:{...k,offset:n}}}}(c,e,t):$L(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function(t,e,n,r){let{fieldDef:i,fieldDef2:o,channel:a,model:s}=t;const{config:l,markDef:u,encoding:c}=s,f=s.getScaleComponent(a),d=s.scaleName(a),h=f?f.get("type"):void 0,p=f.get("reverse"),m=Tz({channel:a,fieldDef:i,markDef:u,config:l,scaleType:h}),g=null===(e=s.component.axes[a])||void 0===e?void 0:e[0],y=null!==(n=null===g||void 0===g?void 0:g.get("translate"))&&void 0!==n?n:.5,v=NF(a)&&null!==(r=RT("binSpacing",u,l))&&void 0!==r?r:0,b=lF(a),x=sF(a),_=sF(b),{offset:w}=BL({channel:a,markDef:u,encoding:c,model:s,bandPosition:0}),k=xT(m)?{signal:"(1-".concat(m.signal,")/2")}:JO(m)?(1-m.band)/2:.5;if(fT(i.bin)||i.timeUnit)return{[_]:GL({fieldDef:i,scaleName:d,bandPosition:k,offset:VL(b,v,p,y,w)}),[x]:GL({fieldDef:i,scaleName:d,bandPosition:xT(k)?{signal:"1-".concat(k.signal)}:1-k,offset:VL(a,v,p,y,w)})};if(dT(i.bin)){const t=rz(i,d,{},{offset:VL(b,v,p,y,w)});if(Bz(o))return{[_]:t,[x]:rz(o,d,{},{offset:VL(a,v,p,y,w)})};if(hT(i.bin)&&i.bin.step)return{[_]:t,[x]:{signal:'scale("'.concat(d,'", ').concat(Qz(i,{expr:"datum"})," + ").concat(i.bin.step,")"),offset:VL(a,v,p,y,w)}}}_N(vN(b))}({fieldDef:c,fieldDef2:f,channel:e,model:t})}function YL(t,e,n,r,i,o,a){if(JO(i)){if(!n)return{mult:i.band,field:{group:t}};{const t=n.get("type");if("band"===t){let t="bandwidth('".concat(e,"')");return 1!==i.band&&(t="".concat(i.band," * ").concat(t)),{signal:"max(0.25, ".concat(t,")")}}1!==i.band&&(_N(function(t){return"Cannot use the relative band size with ".concat(t," scale.")}(t)),i=void 0)}}else{if(xT(i))return i;if(i)return{value:i}}if(n){const t=n.get("range");if(_T(t)&&At(t.step))return{value:t.step-2}}if(!o){const{bandPaddingInner:e,barBandPaddingInner:n,rectBandPaddingInner:i}=r.scale,o=QS(e,"bar"===a?n:i);if(xT(o))return{signal:"(1 - (".concat(o.signal,")) * ").concat(t)};if(At(o))return{signal:"".concat(1-o," * ").concat(t)};if(gT(o))return{signal:"(1 - (".concat(o.expr,")) * ").concat(t)}}return{value:MP(r.view,t)-2}}function VL(t,e,n,r,i){if(LD(t))return 0;const o="x"===t||"y2"===t?-e/2:e/2;if(xT(n)||xT(i)||xT(r)){const t=NT(n),e=NT(i),a=NT(r);return{signal:(a?"".concat(a," + "):"")+(t?"(".concat(t," ? -1 : 1) * "):"")+(e?"(".concat(e," + ").concat(o,")"):o)}}return i=i||0,r+(n?-i-o:+i+o)}function GL(t){let{fieldDef:e,scaleName:n,bandPosition:r,offset:i}=t;return iz({scaleName:n,fieldOrDatumDef:e,bandPosition:r,offset:i})}const XL=new Set(["aria","width","height"]);function QL(t,e){const{fill:n,stroke:r}="include"===e.color?RL(t):{};return{...KL(t.markDef,e),...JL(t,"fill",n),...JL(t,"stroke",r),...zL("opacity",t),...zL("fillOpacity",t),...zL("strokeOpacity",t),...zL("strokeWidth",t),...zL("strokeDash",t),...PL(t),...SL(t),...ML(t,"href"),...TL(t)}}function JL(t,e,n){const{config:r,mark:i,markDef:o}=t;if("hide"===RT("invalid",o,r)&&n&&!HO(i)){const r=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum"});o&&mO(i)&&(e[o]=!0)}return e}),{}),o=BS(i);if(o.length>0){const t=n?"||":"&&";return o.map((t=>nz(t,n))).join(" ".concat(t," "))}}(t,{invalid:!0,channels:GF});if(r)return{[e]:[{test:r,value:null},...it(n)]}}return n?{[e]:n}:{}}function KL(t,e){return kT.reduce(((n,r)=>(XL.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=DT(t[r])),n)),{})}function tj(t){const{config:e,markDef:n}=t;if(RT("invalid",n,e)){const e=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){var i;const o=r.get("type"),a=t.vgField(n,{expr:"datum",binSuffix:null!==(i=t.stack)&&void 0!==i&&i.impute?"mid":void 0});a&&mO(o)&&(e[a]=!0)}return e}),{}),o=BS(i);if(o.length>0){const t=n?"||":"&&";return o.map((t=>nz(t,n))).join(" ".concat(t," "))}}(t,{channels:TF});if(e)return{defined:{signal:e}}}return{}}function ej(t,e){if(void 0!==e)return{[t]:DT(e)}}const nj="voronoi",rj={defined:t=>"point"===t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName(nj)},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,o=t.mark;if(HO(o))return _N('The "nearest" transform is not supported for '.concat(o," marks.")),n;const a={name:t.getName(nj),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...SL(t,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let s=0,l=!1;return n.forEach(((e,n)=>{var r;const i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?s=n:i.indexOf(nj)>=0&&(l=!0)})),l||n.splice(s+1,0,a),n}},ij=rj,oj={defined:t=>"point"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!pP(t.bind),parse:(t,e,n)=>Mj(e,n),topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,o=e.bind,a=e.init&&e.init[0],s=ij.defined(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((t,i)=>{var l,u;const c=qS("".concat(r,"_").concat(t.field));n.filter((t=>t.name===c)).length||n.unshift({name:c,...a?{init:eL(a[i])}:{value:null},on:e.events?[{events:e.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(s,"[").concat(Dt(t.field),"] : null")}]:[],bind:null!==(l=null!==(u=o[t.field])&&void 0!==u?u:o[t.channel])&&void 0!==l?l:o})})),n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.filter((t=>t.name===r+xj))[0],a=r+uL,s=i.items.map((t=>qS("".concat(r,"_").concat(t.field)))),l=s.map((t=>"".concat(t," !== null"))).join(" && ");return s.length&&(o.update="".concat(l," ? {fields: ").concat(a,", values: [").concat(s.join(", "),"]} : null")),delete o.value,delete o.on,n}},aj=oj,sj="_toggle",lj={defined:t=>"point"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+sj,value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+xj,r=e.name+sj;return"".concat(r," ? null : ").concat(n,", ")+("global"===e.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(Aj(t),"}, "))+"".concat(r," ? ").concat(n," : null")}},uj={defined:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e)=>{e.clear&&(e.clear=Et(e.clear)?Wk(e.clear,"view"):e.clear)},topLevelSignals:(t,e,n)=>{if(aj.defined(e))for(const r of e.project.items){const t=n.findIndex((t=>t.name===qS("".concat(e.name,"_").concat(r.field))));-1!==t&&n[t].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const i of e.project.items){const t=n.findIndex((t=>t.name===i.signals.visual));r(t,"[0, 0]"),-1===t&&r(n.findIndex((t=>t.name===i.signals.data)),"null")}else{let t=n.findIndex((t=>t.name===e.name+xj));r(t,"null"),lj.defined(e)&&(t=n.findIndex((t=>t.name===e.name+sj)),r(t,"false"))}return n}},cj={defined:t=>{const e="global"===t.resolve&&t.bind&&pP(t.bind),n=1===t.project.items.length&&t.project.items[0].field!==dP;return e&&!n&&_N("Legend bindings are only supported for selections over an individual field or encoding channel."),e&&n},parse:(t,e,n)=>{const r=wS(n);if(r.select=Et(r.select)?{type:r.select,toggle:e.toggle}:{...r.select,toggle:e.toggle},Mj(e,r),U(n.select)&&(n.select.on||n.select.clear)){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events){var i;n.filter=it(null!==(i=n.filter)&&void 0!==i?i:[]),n.filter.includes(t)||n.filter.push(t)}}const o=mP(e.bind)?e.bind.legend:"click",a=Et(o)?Wk(o,"view"):it(o);e.bind={legend:{merge:a}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=mP(e.bind)&&e.bind.legend,o=t=>e=>{const n=wS(e);return n.markname=t,n};for(const a of e.project.items){if(!a.hasLegend)continue;const t="".concat(qS(a.field),"_legend"),s="".concat(r,"_").concat(t);if(0===n.filter((t=>t.name===s)).length){const r=i.merge.map(o("".concat(t,"_symbols"))).concat(i.merge.map(o("".concat(t,"_labels")))).concat(i.merge.map(o("".concat(t,"_entries"))));n.unshift({name:s,...e.init?{}:{value:null},on:[{events:r,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(s),force:!0}]})}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.find((t=>t.name===r+xj)),a=r+uL,s=i.items.filter((t=>t.hasLegend)).map((t=>qS("".concat(r,"_").concat(qS(t.field),"_legend")))),l="".concat(s.map((t=>"".concat(t," !== null"))).join(" && ")," ? {fields: ").concat(a,", values: [").concat(s.join(", "),"]} : null");e.events&&s.length>0?o.on.push({events:s.map((t=>({signal:t}))),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const u=n.find((t=>t.name===r+sj)),c=mP(e.bind)&&e.bind.legend;return u&&(e.events?u.on.push({...u.on[0],events:c}):u.on[0].events=c),n}},fj="_translate_anchor",dj="_translate_delta",hj={defined:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=pL.defined(e),o=r+fj,{x:a,y:s}=e.project.hasChannel;let l=Wk(e.translate,"scope");return i||(l=l.map((t=>(t.between[0].markname=r+yL,t)))),n.push({name:o,value:{},on:[{events:l.map((t=>t.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==a?", extent_x: ".concat(i?mL(t,iD):"slice(".concat(a.signals.visual,")")):"")+(void 0!==s?", extent_y: ".concat(i?mL(t,oD):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+dj,value:{},on:[{events:l,update:"{x: ".concat(o,".x - x(unit), y: ").concat(o,".y - y(unit)}")}]}),void 0!==a&&pj(t,e,a,"width",n),void 0!==s&&pj(t,e,s,"height",n),n}};function pj(t,e,n,r,i){var o,a;const s=e.name,l=s+fj,u=s+dj,c=n.channel,f=pL.defined(e),d=i.filter((t=>t.name===n.signals[f?"data":"visual"]))[0],h=t.getSizeSignalRef(r).signal,p=t.getScaleComponent(c),m=p&&p.get("type"),g=p&&p.get("reverse"),y="".concat(l,".extent_").concat(c),v="".concat(f&&p?"log"===m?"panLog":"symlog"===m?"panSymlog":"pow"===m?"panPow":"panLinear":"panLinear","(").concat(y,", ").concat(f?c===iD?g?"":"-":g?"-":"":"").concat(u,".").concat(c," / ").concat(f?"".concat(h):"span(".concat(y,")")).concat(f?"pow"===m?", ".concat(null!==(o=p.get("exponent"))&&void 0!==o?o:1):"symlog"===m?", ".concat(null!==(a=p.get("constant"))&&void 0!==a?a:1):"":"",")");d.on.push({events:{signal:u},update:f?v:"clampRange(".concat(v,", 0, ").concat(h,")")})}const mj="_zoom_anchor",gj="_zoom_delta",yj={defined:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=pL.defined(e),o=r+gj,{x:a,y:s}=e.project.hasChannel,l=Dt(t.scaleName(iD)),u=Dt(t.scaleName(oD));let c=Wk(e.zoom,"scope");return i||(c=c.map((t=>(t.markname=r+yL,t)))),n.push({name:r+mj,on:[{events:c,update:i?"{"+[l?"x: invert(".concat(l,", x(unit))"):"",u?"y: invert(".concat(u,", y(unit))"):""].filter((t=>t)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==a&&vj(t,e,a,"width",n),void 0!==s&&vj(t,e,s,"height",n),n}};function vj(t,e,n,r,i){var o,a;const s=e.name,l=n.channel,u=pL.defined(e),c=i.filter((t=>t.name===n.signals[u?"data":"visual"]))[0],f=t.getSizeSignalRef(r).signal,d=t.getScaleComponent(l),h=d&&d.get("type"),p=u?mL(t,l):c.name,m=s+gj,g="".concat(u&&d?"log"===h?"zoomLog":"symlog"===h?"zoomSymlog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear","(").concat(p,", ").concat(s).concat(mj,".").concat(l,", ").concat(m).concat(u?"pow"===h?", ".concat(null!==(o=d.get("exponent"))&&void 0!==o?o:1):"symlog"===h?", ".concat(null!==(a=d.get("constant"))&&void 0!==a?a:1):"":"",")");c.on.push({events:{signal:m},update:u?g:"clampRange(".concat(g,", 0, ").concat(f,")")})}const bj="_store",xj="_tuple",_j="_modify",wj="vlSelectionResolve",kj=[AL,wL,dL,lj,aj,pL,cj,uj,hj,yj,ij];function Aj(t){let{escape:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0},n=e?Dt(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!eI(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of ZD)t[e]&&(n+=" + '__facet_".concat(e,"_' + (facet[").concat(Dt(r.vgField(e)),"])"))}return n}function Ej(t){var e;return LS(null!==(e=t.component.selection)&&void 0!==e?e:{}).reduce(((t,e)=>t||e.project.hasSelectionId),!1)}function Mj(t,e){!Et(e.select)&&e.select.on||delete t.events,!Et(e.select)&&e.select.clear||delete t.clear,!Et(e.select)&&e.select.toggle||delete t.toggle}function Cj(t){const e=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(e.push(...Cj(t.object)),e.push(...Cj(t.property))),e)}function Sj(t){return"MemberExpression"===t.object.type?Sj(t.object):"datum"===t.object.name}function Dj(t){const e=px(t),n=new Set;return e.visit((t=>{"MemberExpression"===t.type&&Sj(t)&&n.add(Cj(t).slice(1).join("."))})),n}class Fj extends aL{clone(){return new Fj(null,this.model,wS(this.filter))}constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=Oj(this.model,this.filter,this),this._dependentFields=Dj(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter ".concat(this.expr)}}function Tj(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum";const i=Et(e)?e:e.param,o=qS(i),a=Dt(o+bj);let s;try{s=t.getSelectionComponent(o,i)}catch(t){return"!!".concat(o)}if(s.project.timeUnit){const e=null!==n&&void 0!==n?n:t.component.data.raw,r=s.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}const l="".concat(s.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(").concat(a,", ").concat(r).concat("global"===s.resolve?")":", ".concat(Dt(s.resolve),")")),u="length(data(".concat(a,"))");return!1===e.empty?"".concat(u," && ").concat(l):"!".concat(u," || ").concat(l)}function Nj(t,e,n){const r=qS(e),i=n.encoding;let o,a=n.field;try{o=t.getSelectionComponent(r,e)}catch(t){return r}if(i||a){if(i&&!a){const t=o.project.items.filter((t=>t.channel===i));!t.length||t.length>1?(a=o.project.items[0].field,_N((t.length?"Multiple ":"No ")+"matching ".concat(Dt(i)," encoding found for selection ").concat(Dt(n.param),". ")+'Using "field": '.concat(Dt(a),"."))):a=t[0].field}}else a=o.project.items[0].field,o.project.items.length>1&&_N('A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": '.concat(Dt(a),"."));return"".concat(o.name,"[").concat(Dt(YS(a)),"]")}function Oj(t,e,n){return IS(e,(e=>Et(e)?e:function(t){return null===t||void 0===t?void 0:t.param}(e)?Tj(t,e,n):YN(e)))}function zj(t,e,n,r){var i,o,a,s,l;null!==(i=t.encode)&&void 0!==i||(t.encode={}),null!==(o=(s=t.encode)[e])&&void 0!==o||(s[e]={}),null!==(a=(l=t.encode[e]).update)&&void 0!==a||(l.update={}),t.encode[e].update[n]=r}function Rj(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1};const{disable:i,orient:o,scale:a,labelExpr:s,title:l,zindex:u,...c}=t.combine();if(!i){for(const t in c){const n=xR[t],r=c[t];if(n&&n!==e&&"both"!==n)delete c[t];else if(vR(r)){const{condition:e,...n}=r,i=it(e),o=yR[t];if(o){const{vgProp:e,part:r}=o,a=[...i.map((t=>{const{test:e,...n}=t;return{test:Oj(null,e),...n}})),n];zj(c,r,e,a),delete c[t]}else if(null===o){const e={signal:i.map((t=>{const{test:e,...n}=t;return"".concat(Oj(null,e)," ? ").concat(TT(n)," : ")})).join("")+TT(n)};c[t]=e}}else if(xT(r)){const e=yR[t];if(e){const{vgProp:n,part:i}=e;zj(c,i,n,r),delete c[t]}}SS(["labelAlign","labelBaseline"],t)&&null===c[t]&&delete c[t]}if("grid"===e){if(!c.grid)return;if(c.encode){const{grid:t}=c.encode;c.encode={...t?{grid:t}:{}},PS(c.encode)&&delete c.encode}return{scale:a,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:QS(u,0)}}{if(!r.header&&t.mainExtracted)return;if(void 0!==s){var f;let t=s;null!==(f=c.encode)&&void 0!==f&&null!==(f=f.labels)&&void 0!==f&&f.update&&xT(c.encode.labels.update.text)&&(t=VS(s,"datum.label",c.encode.labels.update.text.signal)),zj(c,"labels","text",{signal:t})}if(null===c.labelAlign&&delete c.labelAlign,c.encode){for(const e of bR)t.hasAxisPart(e)||delete c.encode[e];PS(c.encode)&&delete c.encode}const e=function(t,e){if(t)return L(t)&&!bT(t)?t.map((t=>iR(t,e))).join(", "):t}(l,n);return{scale:a,orient:o,grid:!1,...e?{title:e}:{},...c,...!1===n.aria?{aria:!1}:{},zindex:QS(u,0)}}}}function Pj(t){const{axes:e}=t.component,n=[];for(const r of TF)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}function Bj(t,e,n,r){return Object.assign.apply(null,[{},...t.map((t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},o=e["x"===n?"axisTop":"axisRight"]||{},a=new Set([...BS(i),...BS(o)]),s={};for(const e of a.values())s[e]={signal:"".concat(r.signal,' === "').concat(t,'" ? ').concat(NT(i[e])," : ").concat(NT(o[e]))};return s}return e[t]}))])}function Lj(t,e){const n=[{}];for(const i of t){var r;let t=null===(r=e[i])||void 0===r?void 0:r.style;if(t){t=it(t);for(const r of t)n.push(e.style[r])}}return Object.assign.apply(null,n)}function jj(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=LT(t,n,e);if(void 0!==i)return{configFrom:"style",configValue:i};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"]){var o;if(void 0!==(null===(o=r[a])||void 0===o?void 0:o[t]))return{configFrom:a,configValue:r[a][t]}}return{}}const Uj={scale:t=>{let{model:e,channel:n}=t;return e.scaleName(n)},format:t=>{let{format:e}=t;return e},formatType:t=>{let{formatType:e}=t;return e},grid:t=>{var e;let{fieldOrDatumDef:n,axis:r,scaleType:i}=t;return null!==(e=r.grid)&&void 0!==e?e:function(t,e){return!pO(t)&&Bz(e)&&!fT(null===e||void 0===e?void 0:e.bin)&&!dT(null===e||void 0===e?void 0:e.bin)}(i,n)},gridScale:t=>{let{model:e,channel:n}=t;return function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n)}(e,n)},labelAlign:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelAlign||Wj(n,r,i)},labelAngle:t=>{let{labelAngle:e}=t;return e},labelBaseline:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelBaseline||Ij(n,r,i)},labelFlush:t=>{var e;let{axis:n,fieldOrDatumDef:r,channel:i}=t;return null!==(e=n.labelFlush)&&void 0!==e?e:function(t,e){if("x"===e&&SS(["quantitative","temporal"],t))return!0}(r.type,i)},labelOverlap:t=>{var e;let{axis:n,fieldOrDatumDef:r,scaleType:i}=t;return null!==(e=n.labelOverlap)&&void 0!==e?e:function(t,e,n,r){if(n&&!U(r)||"nominal"!==t&&"ordinal"!==t)return"log"!==e&&"symlog"!==e||"greedy"}(r.type,i,Bz(r)&&!!r.timeUnit,Bz(r)?r.sort:void 0)},orient:t=>{let{orient:e}=t;return e},tickCount:t=>{var e;let{channel:n,model:r,axis:i,fieldOrDatumDef:o,scaleType:a}=t;const s="x"===n?"width":"y"===n?"height":void 0,l=s?r.getSizeSignalRef(s):void 0;return null!==(e=i.tickCount)&&void 0!==e?e:function(t){let{fieldOrDatumDef:e,scaleType:n,size:r,values:i}=t;if(!i&&!pO(n)&&"log"!==n){if(Bz(e)){var o;if(fT(e.bin))return{signal:"ceil(".concat(r.signal,"/10)")};if(e.timeUnit&&SS(["month","hours","day","quarter"],null===(o=PN(e.timeUnit))||void 0===o?void 0:o.unit))return}return{signal:"ceil(".concat(r.signal,"/40)")}}}({fieldOrDatumDef:o,scaleType:a,size:l,values:i.values})},tickMinStep:function(t){let{format:e,fieldOrDatumDef:n}=t;if("d"===e)return 1;if(Bz(n)){const{timeUnit:t}=n;if(t){const e=BN(t);if(e)return{signal:e}}}},title:t=>{let{axis:e,model:n,channel:r}=t;if(void 0!==e.title)return e.title;const i=$j(n,r);if(void 0!==i)return i;const o=n.typedFieldDef(r),a="x"===r?"x2":"y2",s=n.fieldDef(a);return UT(o?[Sz(o)]:[],Bz(s)?[Sz(s)]:[])},values:t=>{let{axis:e,fieldOrDatumDef:n}=t;return function(t,e){const n=t.values;return L(n)?mR(e,n):xT(n)?n:void 0}(e,n)},zindex:t=>{var e;let{axis:n,fieldOrDatumDef:r,mark:i}=t;return null!==(e=n.zindex)&&void 0!==e?e:function(t,e){return"rect"===t&&Jz(e)?1:0}(i,r)}};function qj(t){return"(((".concat(t.signal," % 360) + 360) % 360)")}function Ij(t,e,n,r){if(void 0!==t){if("x"===n){if(xT(t)){const n=qj(t);return{signal:"(45 < ".concat(n," && ").concat(n," < 135) || (225 < ").concat(n," && ").concat(n,' < 315) ? "middle" :(').concat(n," <= 45 || 315 <= ").concat(n,") === ").concat(xT(e)?"(".concat(e.signal,' === "top")'):"top"===e,' ? "bottom" : "top"')}}if(45<t&&t<135||225<t&&t<315)return"middle";if(xT(e)){const n=t<=45||315<=t?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "top" ? "bottom" : "top"')}}return(t<=45||315<=t)==("top"===e)?"bottom":"top"}if(xT(t)){const n=qj(t);return{signal:"".concat(n," <= 45 || 315 <= ").concat(n," || (135 <= ").concat(n," && ").concat(n," <= 225) ? ").concat(r?'"middle"':"null"," : (45 <= ").concat(n," && ").concat(n," <= 135) === ").concat(xT(e)?"(".concat(e.signal,' === "left")'):"left"===e,' ? "top" : "bottom"')}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(xT(e)){const n=45<=t&&t<=135?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "left" ? "top" : "bottom"')}}return(45<=t&&t<=135)==("left"===e)?"top":"bottom"}}function Wj(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(xT(t)){const n=qj(t);return{signal:"(".concat(i?"(".concat(n," + 90)"):n," % 180 === 0) ? ").concat(r?null:'"center"'," :(").concat(i," < ").concat(n," && ").concat(n," < ").concat(180+i,") === ").concat(xT(e)?"(".concat(e.signal,' === "').concat(o,'")'):e===o,' ? "left" : "right"')}}if((t+i)%180==0)return r?null:"center";if(xT(e)){const n=i<t&&t<180+i?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "').concat(o,'" ? "left" : "right"')}}return(i<t&&t<180+i)==(e===o)?"left":"right"}function $j(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;return o&&a?qT(o,a):o||a||(void 0!==o?o:void 0!==a?a:void 0)}class Hj extends aL{clone(){return new Hj(null,wS(this.transform))}constructor(t,e){super(t),this.transform=e,this._dependentFields=Dj(this.transform.calculate)}static parseAllForSortIndex(t,e){return e.forEachFieldDef(((e,n)=>{if(Zz(e)&&Az(e.sort)){const{field:r,timeUnit:i}=e,o=e.sort,a=o.map(((t,e)=>"".concat(YN({field:r,timeUnit:i,equal:t})," ? ").concat(e," : "))).join("")+o.length;t=new Hj(t,{calculate:a,as:Zj(e,n,{forAs:!0})})}})),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate ".concat(MS(this.transform))}}function Zj(t,e,n){return Qz(t,{prefix:e,suffix:"sort_index",...null!==n&&void 0!==n?n:{}})}function Yj(t,e){return SS(["top","bottom"],e)?"column":SS(["left","right"],e)||"row"===t?"row":"column"}function Vj(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return QS((e||{})[t],i[t],n.header[t])}function Gj(t,e,n,r){const i={};for(const o of t){const t=Vj(o,e||{},n,r);void 0!==t&&(i[o]=t)}return i}const Xj=["row","column"],Qj=["header","footer"];function Jj(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=Gj(["titleAnchor","titleAngle","titleOrient"],i.header,r,e),l=Yj(e,s),u=KS(a);return{name:"".concat(e,"-title"),type:"group",role:"".concat(l,"-title"),title:{text:n,..."row"===e?{orient:"left"}:{},style:"guide-title",...tU(u,l),...Kj(l,u,o),...sU(r,i,e,sP,oP)}}}function Kj(t,e){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle"){case"start":return{align:"left"};case"end":return{align:"right"}}const n=Wj(e,"row"===t?"left":"top","row"===t?"y":"x");return n?{align:n}:{}}function tU(t,e){const n=Ij(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function eU(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of Qj)if(n[i])for(const o of n[i]){const a=iU(t,e,i,n,o);null!=a&&r.push(a)}return r}function nU(t,e){var n;const{sort:r}=t;return kz(r)?{field:Qz(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:L(r)?{field:Zj(t,e,{expr:"datum"}),order:"ascending"}:{field:Qz(t,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function rU(t,e,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:l}=Gj(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t.header,n,e),u=cz({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,c=Yj(e,s);return{text:{signal:l?VS(VS(l,"datum.label",u),"datum.value",Qz(t,{expr:"parent"})):u},..."row"===e?{orient:"left"}:{},style:"guide-label",frame:"group",...tU(o,c),...Kj(c,o,a),...sU(n,t,e,lP,aP)}}function iU(t,e,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=t.config?t.config:void 0;if(a&&i.labels){const{labelOrient:t}=Gj(["labelOrient"],a.header,s,e);("row"===e&&!SS(["top","bottom"],t)||"column"===e&&!SS(["left","right"],t))&&(o=rU(a,e,s))}const l=eI(t)&&!Ez(t.facet),u=i.axes,c=(null===u||void 0===u?void 0:u.length)>0;if(o||c){const s="row"===e?"height":"width";return{name:t.getName("".concat(e,"_").concat(n)),type:"group",role:"".concat(e,"-").concat(n),...r.facetFieldDef?{from:{data:t.getName("".concat(e,"_domain"))},sort:nU(a,e)}:{},...c&&l?{from:{data:t.getName("facet_domain_".concat(e))}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const oU={column:{start:0,end:1},row:{start:1,end:0}};function aU(t,e){return oU[e][t]}function sU(t,e,n,r,i){const o={};for(const a of r){if(!i[a])continue;const r=Vj(a,null===e||void 0===e?void 0:e.header,t,n);void 0!==r&&(o[i[a]]=r)}return o}function lU(t){return[...uU(t,"width"),...uU(t,"height"),...uU(t,"childWidth"),...uU(t,"childHeight")]}function uU(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),o=e.get("range");if(pO(r)&&_T(o)){const r=t.scaleName(n);return eI(t.parent)&&"independent"===t.parent.component.resolve.scale[n]?[cU(r,o)]:[cU(r,o),{name:i,update:fU(r,e,"domain('".concat(r,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r="isFinite(".concat(n,") ? ").concat(n," : ").concat(EP(t.config.view,e?"width":"height"));return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function cU(t,e){const n="".concat(t,"_step");return xT(e.step)?{name:n,update:e.step.signal}:{name:n,value:e.step}}function fU(t,e,n){const r=e.get("type"),i=e.get("padding"),o=QS(e.get("paddingOuter"),i);let a=e.get("paddingInner");return a="band"===r?void 0!==a?a:i:1,"bandspace(".concat(n,", ").concat(NT(a),", ").concat(NT(o),") * ").concat(t,"_step")}function dU(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function hU(t,e){return BS(t).reduce(((n,r)=>{const i=t[r];return{...n,...EL(e,i,r,(t=>DT(t.value)))}}),{})}function pU(t,e){if(eI(e))return"theta"===t?"independent":"shared";if(rI(e))return"shared";if(nI(e))return NF(t)||"theta"===t||"radius"===t?"independent":"shared";throw new Error("invalid model type for resolve")}function mU(t,e){const n=t.scale[e],r=NF(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&_N(function(t){return'Setting the scale to be independent for "'.concat(t,'" means we also have to set the guide (axis or legend) to be independent.')}(e)),"independent"):t[r][e]||"shared"}const gU={...fP,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},yU=BS(gU);class vU extends jB{}const bU={symbols:function(t,e){var n,r,i,o,a;let{fieldOrDatumDef:s,model:l,channel:u,legendCmpt:c,legendType:f}=e;if("symbol"!==f)return;const{markDef:d,encoding:h,config:p,mark:m}=l,g=d.filled&&"trail"!==m;let y={...OT({},l,GO),...RL(l,{filled:g})};const v=null!==(n=c.get("symbolOpacity"))&&void 0!==n?n:p.legend.symbolOpacity,b=null!==(r=c.get("symbolFillColor"))&&void 0!==r?r:p.legend.symbolFillColor,x=null!==(i=c.get("symbolStrokeColor"))&&void 0!==i?i:p.legend.symbolStrokeColor,_=void 0===v?null!==(o=xU(h.opacity))&&void 0!==o?o:d.opacity:void 0;if(y.fill)if("fill"===u||g&&u===vD)delete y.fill;else if(y.fill.field)b?delete y.fill:(y.fill=DT(null!==(a=p.legend.symbolBaseFillColor)&&void 0!==a?a:"black"),y.fillOpacity=DT(null!==_&&void 0!==_?_:1));else if(L(y.fill)){var w,k,A;const t=null!==(w=null!==(k=_U(null!==(A=h.fill)&&void 0!==A?A:h.color))&&void 0!==k?k:d.fill)&&void 0!==w?w:g&&d.color;t&&(y.fill=DT(t))}if(y.stroke)if("stroke"===u||!g&&u===vD)delete y.stroke;else if(y.stroke.field||x)delete y.stroke;else if(L(y.stroke)){const t=QS(_U(h.stroke||h.color),d.stroke,g?d.color:void 0);t&&(y.stroke={value:t})}if(u!==AD){const t=Bz(s)&&kU(0,c,s);t?y.opacity=[{test:t,...DT(null!==_&&void 0!==_?_:1)},DT(p.legend.unselectedOpacity)]:_&&(y.opacity=DT(_))}return y={...y,...t},PS(y)?void 0:y},gradient:function(t,e){var n;let{model:r,legendType:i,legendCmpt:o}=e;if("gradient"!==i)return;const{config:a,markDef:s,encoding:l}=r;let u={};const c=void 0===(null!==(n=o.get("gradientOpacity"))&&void 0!==n?n:a.legend.gradientOpacity)?xU(l.opacity)||s.opacity:void 0;return c&&(u.opacity=DT(c)),u={...u,...t},PS(u)?void 0:u},labels:function(t,e){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:o}=e;const a=r.legend(i)||{},s=r.config,l=Bz(n)?kU(0,o,n):void 0,u=l?[{test:l,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:c,formatType:f}=a;let d;sz(f)?d=dz({fieldOrDatumDef:n,field:"datum.value",format:c,formatType:f,config:s}):void 0===c&&void 0===f&&s.customFormatTypes&&("quantitative"===n.type&&s.numberFormatType?d=dz({fieldOrDatumDef:n,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):"temporal"===n.type&&s.timeFormatType&&Bz(n)&&void 0===n.timeUnit&&(d=dz({fieldOrDatumDef:n,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const h={...u?{opacity:u}:{},...d?{text:d}:{},...t};return PS(h)?void 0:h},entries:function(t,e){let{legendCmpt:n}=e;const r=n.get("selections");return null!==r&&void 0!==r&&r.length?{...t,fill:{value:"transparent"}}:t}};function xU(t){return wU(t,((t,e)=>Math.max(t,e.value)))}function _U(t){return wU(t,((t,e)=>QS(t,e.value)))}function wU(t,e){return function(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&(L(e)||Hz(e))}(t)?it(t.condition).reduce(e,t.value):Hz(t)?t.value:void 0}function kU(t,e,n){const r=e.get("selections");if(null===r||void 0===r||!r.length)return;const i=Dt(n.field);return r.map((t=>"(!length(data(".concat(Dt(qS(t)+bj),")) || (").concat(t,"[").concat(i,"] && indexof(").concat(t,"[").concat(i,"], datum.value) >= 0))"))).join(" || ")}const AU={direction:t=>{let{direction:e}=t;return e},format:t=>{let{fieldOrDatumDef:e,legend:n,config:r}=t;const{format:i,formatType:o}=n;return hz(e,e.type,i,o,r,!1)},formatType:t=>{let{legend:e,fieldOrDatumDef:n,scaleType:r}=t;const{formatType:i}=e;return pz(i,n,r)},gradientLength:t=>{var e,n;const{legend:r,legendConfig:i}=t;return null!==(e=null!==(n=r.gradientLength)&&void 0!==n?n:i.gradientLength)&&void 0!==e?e:function(t){let{legendConfig:e,model:n,direction:r,orient:i,scaleType:o}=t;const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:s,gradientVerticalMaxLength:l,gradientVerticalMinLength:u}=e;if(gO(o))return"horizontal"===r?"top"===i||"bottom"===i?MU(n,"width",s,a):s:MU(n,"height",u,l)}(t)},labelOverlap:t=>{var e,n;let{legend:r,legendConfig:i,scaleType:o}=t;return null!==(e=null!==(n=r.labelOverlap)&&void 0!==n?n:i.labelOverlap)&&void 0!==e?e:function(t){if(SS(["quantile","threshold","log","symlog"],t))return"greedy"}(o)},symbolType:t=>{var e;let{legend:n,markDef:r,channel:i,encoding:o}=t;return null!==(e=n.symbolType)&&void 0!==e?e:function(t,e,n,r){if("shape"!==e){var i;const t=null!==(i=_U(n))&&void 0!==i?i:r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(r.type,i,o.shape,r.shape)},title:t=>{let{fieldOrDatumDef:e,config:n}=t;return nR(e,n,{allowDisabling:!0})},type:t=>{let{legendType:e,scaleType:n,channel:r}=t;if($D(r)&&gO(n)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:t=>{let{fieldOrDatumDef:e,legend:n}=t;return function(t,e){const n=t.values;return L(n)?mR(e,n):xT(n)?n:void 0}(n,e)}};function EU(t){var e,n;let{legendConfig:r,legendType:i,orient:o,legend:a}=t;return null!==(e=null!==(n=a.direction)&&void 0!==n?n:r[i?"gradientDirection":"symbolDirection"])&&void 0!==e?e:function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(o,i)}function MU(t,e,n,r){return{signal:"clamp(".concat(t.getSizeSignalRef(e).signal,", ").concat(n,", ").concat(r,")")}}function CU(t){const e=tI(t)?function(t){const{encoding:e}=t,n={};for(const r of[vD,...cP]){const i=sR(e[r]);i&&t.getScaleComponent(r)&&(r===_D&&Bz(i)&&i.type===nO||(n[r]=DU(t,r)))}return n}(t):function(t){const{legends:e,resolve:n}=t.component;for(const r of t.children){CU(r);for(const i of BS(r.component.legends))n.legend[i]=mU(t.component.resolve,i),"shared"===n.legend[i]&&(e[i]=FU(e[i],r.component.legends[i]),e[i]||(n.legend[i]="independent",delete e[i]))}for(const r of BS(e))for(const e of t.children)e.component.legends[r]&&"shared"===n.legend[r]&&delete e.component.legends[r];return e}(t);return t.component.legends=e,e}function SU(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!(null===n||void 0===n||!n.values);case"title":if("title"===e&&t===(null===r||void 0===r?void 0:r.title))return!0}return t===(n||{})[e]}function DU(t,e){var n,r,i,o;let a=t.legend(e);const{markDef:s,encoding:l,config:u}=t,c=u.legend,f=new vU({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n,r){const i=null===(r=t.fieldDef(e))||void 0===r?void 0:r.field;for(const l of LS(null!==(o=t.component.selection)&&void 0!==o?o:{})){var o,a;const t=null!==(a=l.project.hasField[i])&&void 0!==a?a:l.project.hasChannel[e];if(t&&cj.defined(l)){var s;const e=null!==(s=n.get("selections"))&&void 0!==s?s:[];e.push(l.name),n.set("selections",e,!1),t.hasLegend=!0}}}(t,e,f);const d=void 0!==a?!a:c.disable;if(f.set("disable",d,void 0!==a),d)return f;a=a||{};const h=t.getScaleComponent(e).get("type"),p=sR(l[e]),m=Bz(p)?null===(n=PN(p.timeUnit))||void 0===n?void 0:n.unit:void 0,g=a.orient||u.legend.orient||"right",y=function(t){const{legend:e}=t;return QS(e.type,function(t){let{channel:e,timeUnit:n,scaleType:r}=t;if($D(e)){if(SS(["quarter","month","day"],n))return"symbol";if(gO(r))return"gradient"}return"symbol"}(t))}({legend:a,channel:e,timeUnit:m,scaleType:h}),v={legend:a,channel:e,model:t,markDef:s,encoding:l,fieldOrDatumDef:p,legendConfig:c,config:u,scaleType:h,orient:g,legendType:y,direction:EU({legend:a,legendType:y,orient:g,legendConfig:c})};for(const A of yU){if("gradient"===y&&A.startsWith("symbol")||"symbol"===y&&A.startsWith("gradient"))continue;const n=A in AU?AU[A](v):a[A];if(void 0!==n){const r=SU(n,A,a,t.fieldDef(e));(r||void 0===u.legend[A])&&f.set(A,n,r)}}const b=null!==(r=null===(i=a)||void 0===i?void 0:i.encoding)&&void 0!==r?r:{},x=f.get("selections"),_={},w={fieldOrDatumDef:p,model:t,channel:e,legendCmpt:f,legendType:y};for(const A of["labels","legend","title","symbols","gradient","entries"]){var k;const e=hU(null!==(k=b[A])&&void 0!==k?k:{},t),n=A in bU?bU[A](e,w):e;void 0===n||PS(n)||(_[A]={...null!==x&&void 0!==x&&x.length&&Bz(p)?{name:"".concat(qS(p.field),"_legend_").concat(A)}:{},...null!==x&&void 0!==x&&x.length?{interactive:!!x}:{},update:n})}return PS(_)||f.set("encode",_,!(null===(o=a)||void 0===o||!o.encoding)),f}function FU(t,e){var n,r;if(!t)return e.clone();const i=t.getWithExplicit("orient"),o=e.getWithExplicit("orient");if(i.explicit&&o.explicit&&i.value!==o.value)return;let a=!1;for(const s of yU){const n=$B(t.getWithExplicit(s),e.getWithExplicit(s),s,"legend",((t,e)=>{switch(s){case"symbolType":return n=t,"circle"===(r=e).value?r:n;case"title":return IT(t,e);case"type":return a=!0,qB("symbol")}var n,r;return WB(t,e,s,"legend")}));t.setWithExplicit(s,n)}return a&&(null!==(n=t.implicit)&&void 0!==n&&null!==(n=n.encode)&&void 0!==n&&n.gradient&&WS(t.implicit,["encode","gradient"]),null!==(r=t.explicit)&&void 0!==r&&null!==(r=r.encode)&&void 0!==r&&r.gradient&&WS(t.explicit,["encode","gradient"])),t}function TU(t){const e=t.component.legends,n={};for(const i of BS(e)){const r=t.getScaleComponent(i),o=ES(r.get("domains"));if(n[o])for(const t of n[o])FU(t,e[i])||n[o].push(e[i]);else n[o]=[e[i].clone()]}const r=LS(n).flat().map((e=>function(t,e){const{disable:n,labelExpr:r,selections:i,...o}=t.combine();if(!n){var a;if(!1===e.aria&&null==o.aria&&(o.aria=!1),null!==(a=o.encode)&&void 0!==a&&a.symbols){const t=o.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||o.stroke||(t.stroke={value:"transparent"});for(const e of cP)o[e]&&delete t[e]}if(o.title||delete o.title,void 0!==r){var s;let t=r;null!==(s=o.encode)&&void 0!==s&&null!==(s=s.labels)&&void 0!==s&&s.update&&xT(o.encode.labels.update.text)&&(t=VS(r,"datum.label",o.encode.labels.update.text.signal)),function(t,e,n,r,i,o,a){var s,l;null!==(i=t.encode)&&void 0!==i||(t.encode={}),null!==(o=(s=t.encode)[e])&&void 0!==o||(s[e]={}),null!==(a=(l=t.encode[e]).update)&&void 0!==a||(l.update={}),t.encode[e].update.text=r}(o,"labels",0,{signal:t})}return o}}(e,t.config))).filter((t=>void 0!==t));return r}function NU(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:"[".concat(e.size.map((t=>t.signal)).join(", "),"]")},o=e.data.reduce(((e,n)=>{const r=xT(n)?n.signal:"data('".concat(t.lookupDataSource(n),"')");return SS(e,r)||e.push(r),e}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?"[".concat(o.join(", "),"]"):o[0]},...n}]}return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const OU=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class zU extends jB{constructor(t,e,n,r){super({...e},{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function RU(t){t.component.projection=tI(t)?function(t){if(t.hasProjection){var e;const n=yT(t.specifiedProjection),r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,o=r?function(t){const e=[],{encoding:n}=t;for(const r of[[mD,pD],[yD,gD]])(sR(n[r[0]])||sR(n[r[1]]))&&e.push({signal:t.getName("geojson_".concat(e.length))});return t.channelHasField(_D)&&t.typedFieldDef(_D).type===nO&&e.push({signal:t.getName("geojson_".concat(e.length))}),0===e.length&&e.push(t.requestDataName(KB.Main)),e}(t):void 0,a=new zU(t.projectionName(!0),{...null!==(e=yT(t.config.projection))&&void 0!==e?e:{},...null!==n&&void 0!==n?n:{}},i,o);return a.get("type")||a.set("type","equalEarth",!1),a}}(t):function(t){if(0===t.children.length)return;let e;for(const r of t.children)RU(r);const n=FS(t.children,(t=>{const n=t.component.projection;if(n){if(e){const t=function(t,e){const n=FS(OU,(n=>!yt(t.explicit,n)&&!yt(e.explicit,n)||!!(yt(t.explicit,n)&&yt(e.explicit,n)&&_S(t.get(n),e.get(n)))));if(_S(t.size,e.size)){if(n)return t;if(_S(t.explicit,{}))return e;if(_S(e.explicit,{}))return t}return null}(e,n);return t&&(e=t),!!t}return e=n,!0}return!0}));if(e&&n){const n=t.projectionName(!0),r=new zU(n,e.specifiedProjection,e.size,wS(e.data));for(const e of t.children){const t=e.component.projection;t&&(t.isFit&&r.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}return r}}(t)}function PU(t,e,n,r){if(gR(e,n)){var i,o;const a=tI(t)&&null!==(i=null!==(o=t.axis(n))&&void 0!==o?o:t.legend(n))&&void 0!==i?i:{},s=Qz(e,{expr:"datum"}),l=Qz(e,{expr:"datum",binSuffix:"end"});return{formulaAs:Qz(e,{binSuffix:"range",forAs:!0}),formula:vz(s,l,a.format,a.formatType,r)}}return{}}function BU(t,e){return"".concat(cT(t),"_").concat(e)}function LU(t,e,n){var r;const i=BU(null!==(r=fR(n,void 0))&&void 0!==r?r:{},e);return t.getName("".concat(i,"_bins"))}function jU(t,e,n){let r,i;r=function(t){return"as"in t}(t)?Et(t.as)?[t.as,"".concat(t.as,"_end")]:[t.as[0],t.as[1]]:[Qz(t,{forAs:!0}),Qz(t,{binSuffix:"end",forAs:!0})];const o={...fR(e,void 0)},a=BU(o,t.field),{signal:s,extentSignal:l}=function(t,e){return{signal:t.getName("".concat(e,"_bins")),extentSignal:t.getName("".concat(e,"_extent"))}}(n,a);if(pT(o.extent)){const t=o.extent;i=Nj(n,t.param,t),delete o.extent}return{key:a,binComponent:{bin:o,field:t.field,as:[r],...s?{signal:s}:{},...l?{extentSignal:l}:{},...i?{span:i}:{}}}}class UU extends aL{clone(){return new UU(null,wS(this.bins))}constructor(t,e){super(t),this.bins=e}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{if($z(n)&&fT(n.bin)){const{key:i,binComponent:o}=jU(n,n.bin,e);t[i]={...o,...t[i],...PU(e,n,r,e.config)}}return t}),{});return PS(n)?null:new UU(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=jU(e,e.bin,n);return new UU(t,{[r]:i})}merge(t,e){for(const n of BS(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=NS([...this.bins[n].as,...t.bins[n].as],MS)):this.bins[n]=t.bins[n];for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(LS(this.bins).map((t=>t.as)).flat(2))}dependentFields(){return new Set(LS(this.bins).map((t=>t.field)))}hash(){return"Bin ".concat(MS(this.bins))}assemble(){return LS(this.bins).flatMap((t=>{const e=[],[n,...r]=t.as,{extent:i,...o}=t.bin,a={type:"bin",field:YS(t.field),as:n,signal:t.signal,...pT(i)?{extent:null}:{extent:i},...t.span?{span:{signal:"span(".concat(t.span,")")}}:{},...o};!i&&t.extentSignal&&(e.push({type:"extent",field:YS(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),e.push(a);for(const s of r)for(let t=0;t<2;t++)e.push({type:"formula",expr:Qz({field:n[t]},{expr:"datum"}),as:s[t]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e}))}}class qU extends aL{clone(){return new qU(null,new Set(this.dimensions),wS(this.measures))}constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef((t=>{t.aggregate&&(n=!0)}));const r={},i=new Set;return n?(e.forEachFieldDef(((t,n)=>{var o;const{aggregate:a,field:s}=t;if(a)if("count"===a)null!==(o=r["*"])&&void 0!==o||(r["*"]={}),r["*"].count=new Set([Qz(t,{forAs:!0})]);else{var l,u;if(rT(a)||iT(a)){var c;const t=rT(a)?"argmin":"argmax",e=a[t];null!==(c=r[e])&&void 0!==c||(r[e]={}),r[e][t]=new Set([Qz({op:t,field:e},{forAs:!0})])}else null!==(l=r[s])&&void 0!==l||(r[s]={}),r[s][a]=new Set([Qz(t,{forAs:!0})]);XF(n)&&"unaggregated"===e.scaleDomain(n)&&(null!==(u=r[s])&&void 0!==u||(r[s]={}),r[s].min=new Set([Qz({field:s,aggregate:"min"},{forAs:!0})]),r[s].max=new Set([Qz({field:s,aggregate:"max"},{forAs:!0})]))}else!function(t,e,n,r,i){const o=tI(r)?r.encoding[lF(e)]:void 0;if($z(n)&&tI(r)&&Nz(n,o,r.markDef,r.config))t.add(Qz(n,{})),t.add(Qz(n,{suffix:"end"})),n.bin&&gR(n,e)&&t.add(Qz(n,{binSuffix:"range"}));else if(qD(e)){const n=UD(e);t.add(r.getName(n))}else t.add(Qz(n));Zz(n)&&function(t){return U(t)&&"field"in t}(null===(i=n.scale)||void 0===i?void 0:i.range)&&t.add(n.scale.range.field)}(i,n,t,e)})),i.size+BS(r).length===0?null:new qU(t,i,r)):null}static makeFromTransform(t,e){const n=new Set,r={};for(const s of e.aggregate){var i,o;const{op:t,field:e,as:n}=s;t&&("count"===t?(null!==(i=r["*"])&&void 0!==i||(r["*"]={}),r["*"].count=new Set([n||Qz(s,{forAs:!0})])):(null!==(o=r[e])&&void 0!==o||(r[e]={}),r[e][t]=new Set([n||Qz(s,{forAs:!0})])))}for(const s of null!==(a=e.groupby)&&void 0!==a?a:[]){var a;n.add(s)}return n.size+BS(r).length===0?null:new qU(t,n,r)}merge(t){return function(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}(this.dimensions,t.dimensions)?(function(t,e){for(const r of BS(e)){const i=e[r];for(const e of BS(i)){var n;r in t?t[r][e]=new Set([...null!==(n=t[r][e])&&void 0!==n?n:[],...i[e]]):t[r]={[e]:i[e]}}}}(this.measures,t.measures),!0):(function(){xN.debug(...arguments)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...BS(this.measures)])}producedFields(){const t=new Set;for(const e of BS(this.measures))for(const n of BS(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add("".concat(n,"_").concat(e)):r.forEach(t.add,t)}return t}hash(){return"Aggregate ".concat(MS({dimensions:this.dimensions,measures:this.measures}))}assemble(){const t=[],e=[],n=[];for(const r of BS(this.measures))for(const i of BS(this.measures[r]))for(const o of this.measures[r][i])n.push(o),t.push(i),e.push("*"===r?null:YS(r));return{type:"aggregate",groupby:[...this.dimensions].map(YS),ops:t,fields:e,as:n}}}class IU extends aL{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const i of ZD){const t=e.facet[i];if(t){const{bin:n,sort:r}=t;this[i]={name:e.getName("".concat(i,"_domain")),fields:[Qz(t),...fT(n)?[Qz(t,{binSuffix:"end"})]:[]],...kz(r)?{sortField:r}:L(r)?{sortIndexField:Zj(t,i)}:{}}}}this.childModel=e.child}hash(){let t="Facet";for(const e of ZD)this[e]&&(t+=" ".concat(e.charAt(0),":").concat(MS(this[e])));return t}get fields(){const t=[];for(const n of ZD){var e;(null===(e=this[n])||void 0===e?void 0:e.fields)&&t.push(...this[n].fields)}return t}dependentFields(){const t=new Set(this.fields);for(const e of ZD)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of TF){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(pO(r)&&_T(i)){const n=Tq(Nq(this.childModel,e));n?t[e]=n:_N(YT(e))}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x",facet:void 0}[t],i=[],o=[],a=[];r&&n&&n[r]&&(e?(i.push("distinct_".concat(n[r])),o.push("max")):(i.push(n[r]),o.push("distinct")),a.push("distinct_".concat(n[r])));const{sortField:s,sortIndexField:l}=this[t];if(s){const{op:t=bz,field:e}=s;i.push(e),o.push(t),a.push(Qz(s,{forAs:!0}))}else l&&(i.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:null!==e&&void 0!==e?e:this.data,transform:[{type:"aggregate",groupby:this[t].fields,...i.length?{fields:i,ops:o,as:a}:{}}]}}assembleFacetHeaderData(t){const{columns:e}=this.model.layout,{layoutHeaders:n}=this.model.component,r=[],i={};for(const u of Xj){for(const t of Qj){var o;const e=null!==(o=n[u]&&n[u][t])&&void 0!==o?o:[];for(const t of e){var a;if((null===(a=t.axes)||void 0===a?void 0:a.length)>0){i[u]=!0;break}}}if(i[u]){const t='length(data("'.concat(this.facet.name,'"))'),n="row"===u?e?{signal:"ceil(".concat(t," / ").concat(e,")")}:1:e?{signal:"min(".concat(t,", ").concat(e,")")}:{signal:t};r.push({name:"".concat(this.facet.name,"_").concat(u),transform:[{type:"sequence",start:0,stop:n}]})}}const{row:s,column:l}=i;return(s||l)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let e=null;const n=this.getChildIndependentFieldsWithStep(),{column:r,row:i,facet:o}=this;if(r&&i&&(n.x||n.y)){var a,s;e="cross_".concat(this.column.name,"_").concat(this.row.name);const r=[].concat(null!==(a=n.x)&&void 0!==a?a:[],null!==(s=n.y)&&void 0!==s?s:[]),i=r.map((()=>"distinct"));t.push({name:e,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:r,ops:i}]})}for(const l of[nD,eD])this[l]&&t.push(this.assembleRowColumnHeaderData(l,e,n));if(o){const e=this.assembleFacetHeaderData(n);e&&t.push(...e)}return t}}function WU(t){return t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t}function $U(t){const e={};return bS(t.filter,(t=>{if(HN(t)){var n;let r=null;LN(t)?r=CT(t.equal):UN(t)?r=CT(t.lte):jN(t)?r=CT(t.lt):qN(t)?r=CT(t.gt):IN(t)?r=CT(t.gte):WN(t)?r=t.range[0]:$N(t)&&(r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]),r&&(wN(r)?e[t.field]="date":At(r)?e[t.field]="number":Et(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}})),e}class HU extends aL{clone(){return new HU(null,wS(this._parse))}constructor(t,e){super(t),this._parse=e}hash(){return"Parse ".concat(MS(this._parse))}static makeExplicit(t,e,n){var r;let i={};const o=e.data;return!GB(o)&&null!==o&&void 0!==o&&null!==(r=o.format)&&void 0!==r&&r.parse&&(i=o.format.parse),this.makeWithAncestors(t,i,{},n)}static makeWithAncestors(t,e,n,r){for(const a of BS(n)){const t=r.getWithExplicit(a);void 0!==t.value&&(t.explicit||t.value===n[a]||"derived"===t.value||"flatten"===n[a]?delete n[a]:_N(JT(a,n[a],t.value)))}for(const a of BS(e)){const t=r.get(a);void 0!==t&&(t===e[a]?delete e[a]:_N(JT(a,e[a],t)))}const i=new jB(e,n);r.copyAll(i);const o={};for(const a of BS(i.combine())){const t=i.get(a);null!==t&&(o[a]=t)}return 0===BS(o).length||r.parseNothing?null:new HU(t,o)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const e of BS(this._parse)){const n=this._parse[e];1===XS(e)&&(t[e]=n)}return t}producedFields(){return new Set(BS(this._parse))}dependentFields(){return new Set(BS(this._parse))}assembleTransforms(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return BS(this._parse).filter((e=>!t||XS(e)>1)).map((t=>{const e=function(t,e){const n=HS(t);return"number"===e?"toNumber(".concat(n,")"):"boolean"===e?"toBoolean(".concat(n,")"):"string"===e?"toString(".concat(n,")"):"date"===e?"toDate(".concat(n,")"):"flatten"===e?n:e.startsWith("date:")?"timeParse(".concat(n,",'").concat(WU(e.slice(5,e.length)),"')"):e.startsWith("utc:")?"utcParse(".concat(n,",'").concat(WU(e.slice(4,e.length)),"')"):(_N('Unrecognized parse "'.concat(e,'".')),null)}(t,this._parse[t]);return e?{type:"formula",expr:e,as:GS(t)}:null})).filter((t=>null!==t))}}class ZU extends aL{clone(){return new ZU(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([dP])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:dP}}}class YU extends aL{clone(){return new YU(null,this.params)}constructor(t,e){super(t),this.params=e}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule ".concat(MS(this.params))}assemble(){return{type:"graticule",...!0===this.params?{}:this.params}}}class VU extends aL{clone(){return new VU(null,this.params)}constructor(t,e){super(t),this.params=e}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return"Hash ".concat(MS(this.params))}assemble(){return{type:"sequence",...this.params}}}class GU extends aL{constructor(t){var e;let n;if(super(null),null!==(e=t)&&void 0!==e||(t={name:"source"}),GB(t)||(n=t.format?{...AS(t.format,["parse"])}:{}),YB(t))this._data={values:t.values};else if(ZB(t)){if(this._data={url:t.url},!n.type){let e=/(?:\.([^.]+))?$/.exec(t.url)[1];SS(["json","csv","tsv","dsv","topojson"],e)||(e="json"),n.type=e}}else QB(t)?this._data={values:[{type:"Sphere"}]}:(VB(t)||GB(t))&&(this._data={});this._generator=GB(t),t.name&&(this._name=t.name),n&&!PS(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var XU,QU=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n};function JU(t){return t instanceof GU||t instanceof YU||t instanceof VU}class KU{constructor(){XU.set(this,void 0),QU(this,XU,!1,"f")}setModified(){QU(this,XU,!0,"f")}get modifiedFlag(){return function(t,e,n,r){if("function"==typeof e||!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}(this,XU)}}XU=new WeakMap;class tq extends KU{getNodeDepths(t,e,n){n.set(t,e);for(const r of t.children)this.getNodeDepths(r,e+1,n);return n}optimize(t){const e=[...this.getNodeDepths(t,0,new Map).entries()].sort(((t,e)=>e[1]-t[1]));for(const n of e)this.run(n[0]);return this.modifiedFlag}}class eq extends KU{optimize(t){this.run(t);for(const e of t.children)this.optimize(e);return this.modifiedFlag}}class nq extends eq{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map((t=>t.hash())),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const r of BS(n))n[r].length>1&&(this.setModified(),this.mergeNodes(t,n[r]))}}class rq extends eq{constructor(t){super(),this.requiresSelectionId=t&&Ej(t)}run(t){t instanceof ZU&&(this.requiresSelectionId&&(JU(t.parent)||t.parent instanceof qU||t.parent instanceof HU)||(this.setModified(),t.remove()))}}class iq extends KU{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,e){let n=new Set;t instanceof lL&&(n=t.producedFields(),OS(n,e)&&(this.setModified(),t.removeFormulas(e),0===t.producedFields.length&&t.remove()));for(const r of t.children)this.run(r,new Set([...e,...n]))}}class oq extends eq{constructor(){super()}run(t){t instanceof sL&&!t.isRequired()&&(this.setModified(),t.remove())}}class aq extends tq{run(t){if(!(JU(t)||t.numChildren()>1))for(const e of t.children)if(e instanceof HU)if(t instanceof HU)this.setModified(),t.merge(e);else{if(RS(t.producedFields(),e.dependentFields()))continue;this.setModified(),e.swapWithParent()}}}class sq extends tq{run(t){const e=[...t.children],n=t.children.filter((t=>t instanceof HU));if(t.numChildren()>1&&n.length>=1){const r={},i=new Set;for(const t of n){const e=t.parse;for(const t of BS(e))t in r?r[t]!==e[t]&&i.add(t):r[t]=e[t]}for(const t of i)delete r[t];if(!PS(r)){this.setModified();const n=new HU(t,r);for(const i of e){if(i instanceof HU)for(const t of BS(r))delete i.parse[t];t.removeChild(i),i.parent=n,i instanceof HU&&0===BS(i.parse).length&&i.remove()}}}}}class lq extends tq{run(t){t instanceof sL||t.numChildren()>0||t instanceof IU||t instanceof GU||(this.setModified(),t.remove())}}class uq extends tq{run(t){const e=t.children.filter((t=>t instanceof lL)),n=e.pop();for(const r of e)this.setModified(),n.merge(r)}}class cq extends tq{run(t){const e=t.children.filter((t=>t instanceof qU)),n={};for(const r of e){const t=MS(r.groupBy);t in n||(n[t]=[]),n[t].push(r)}for(const r of BS(n)){const e=n[r];if(e.length>1){const n=e.pop();for(const r of e)n.merge(r)&&(t.removeChild(r),r.parent=n,r.remove(),this.setModified())}}}}class fq extends tq{constructor(t){super(),this.model=t}run(t){const e=!(JU(t)||t instanceof Fj||t instanceof HU||t instanceof ZU),n=[],r=[];for(const i of t.children)i instanceof UU&&(e&&!RS(t.producedFields(),i.dependentFields())?n.push(i):r.push(i));if(n.length>0){const e=n.pop();for(const t of n)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof UU?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(r.length>1){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified()}}}class dq extends tq{run(t){const e=[...t.children];if(!DS(e,(t=>t instanceof sL))||t.numChildren()<=1)return;const n=[];let r;for(const i of e)if(i instanceof sL){let e=i;for(;1===e.numChildren();){const[t]=e.children;if(!(t instanceof sL))break;e=t}n.push(...e.children),r?(t.removeChild(i),i.parent=r.parent,r.parent.removeChild(r),r.parent=e,this.setModified()):r=e}else n.push(i);if(n.length){this.setModified();for(const t of n)t.parent.removeChild(t),t.parent=r}}}class hq extends aL{clone(){return new hq(null,wS(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){this.transform.groupby=NS(this.transform.groupby.concat(t),(t=>t))}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map((t=>t.field)).filter((t=>void 0!==t)).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:Qz(t)}hash(){return"JoinAggregateTransform ".concat(MS(this.transform))}assemble(){const t=[],e=[],n=[];for(const i of this.transform.joinaggregate)e.push(i.op),n.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return{type:"joinaggregate",as:n,ops:e,fields:t,...void 0!==r?{groupby:r}:{}}}}class pq extends aL{clone(){return new pq(null,wS(this._stack))}constructor(t,e){super(t),this._stack=e}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:o="zero"}=e,a=[],s=[];if(void 0!==e.sort)for(const c of e.sort)a.push(c.field),s.push(QS(c.order,"ascending"));const l={field:a,order:s};let u;return u=function(t){return L(t)&&t.every((t=>Et(t)))&&t.length>1}(i)?i:Et(i)?[i,"".concat(i,"_end")]:["".concat(e.stack,"_start"),"".concat(e.stack,"_end")],new pq(t,{dimensionFieldDefs:[],stackField:n,groupby:r,offset:o,sort:l,facetby:[],as:u})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannels:i,fieldChannel:o,offset:a,impute:s}=n,l=i.map((t=>aR(r[t]))).filter((t=>!!t)),u=function(t){return t.stack.stackBy.reduce(((t,e)=>{const n=Qz(e.fieldDef);return n&&t.push(n),t}),[])}(e),c=e.encoding.order;let f;if(L(c)||Bz(c))f=jT(c);else{const t=Oz(c)?c.sort:"y"===o?"descending":"ascending";f=u.reduce(((e,n)=>(e.field.push(n),e.order.push(t),e)),{field:[],order:[]})}return new pq(t,{dimensionFieldDefs:l,stackField:e.vgField(o),facetby:[],stackby:u,sort:f,offset:a,impute:s,as:[e.vgField(o,{suffix:"start",forAs:!0}),e.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return"Stack ".concat(MS(this._stack))}getGroupbyFields(){const{dimensionFieldDefs:t,impute:e,groupby:n}=this._stack;return t.length>0?t.map((t=>t.bin?e?[Qz(t,{binSuffix:"mid"})]:[Qz(t,{}),Qz(t,{binSuffix:"end"})]:[Qz(t)])).flat():null!==n&&void 0!==n?n:[]}assemble(){const t=[],{facetby:e,dimensionFieldDefs:n,stackField:r,stackby:i,sort:o,offset:a,impute:s,as:l}=this._stack;if(s)for(const u of n){const{bandPosition:n=.5,bin:o}=u;if(o){const e=Qz(u,{expr:"datum"}),r=Qz(u,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:"".concat(n,"*").concat(e,"+").concat(1-n,"*").concat(r),as:Qz(u,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...i,...e],key:Qz(u,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:o,as:l,offset:a}),t}}class mq extends aL{clone(){return new mq(null,wS(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){this.transform.groupby=NS(this.transform.groupby.concat(t),(t=>t))}dependentFields(){var t,e;const n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(n.add,n),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach((t=>n.add(t.field))),this.transform.window.map((t=>t.field)).filter((t=>void 0!==t)).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:Qz(t)}hash(){return"WindowTransform ".concat(MS(this.transform))}assemble(){const t=[],e=[],n=[],r=[];for(const f of this.transform.window)e.push(f.op),n.push(this.getDefaultName(f)),r.push(void 0===f.param?null:f.param),t.push(void 0===f.field?null:f.field);const i=this.transform.frame,o=this.transform.groupby;if(i&&null===i[0]&&null===i[1]&&e.every((t=>oT(t))))return{type:"joinaggregate",as:n,ops:e,fields:t,...void 0!==o?{groupby:o}:{}};const a=[],s=[];if(void 0!==this.transform.sort)for(const f of this.transform.sort){var l;a.push(f.field),s.push(null!==(l=f.order)&&void 0!==l?l:"ascending")}const u={field:a,order:s},c=this.transform.ignorePeers;return{type:"window",params:r,as:n,ops:e,fields:t,sort:u,...void 0!==c?{ignorePeers:c}:{},...void 0!==o?{groupby:o}:{},...void 0!==i?{frame:i}:{}}}}function gq(t){if(t instanceof IU)if(1!==t.numChildren()||t.children[0]instanceof sL){const n=t.model.component.data.main;yq(n);const r=(e=t,function t(n){if(!(n instanceof IU)){const r=n.clone();if(r instanceof sL){const t=vq+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof qU||r instanceof pq||r instanceof mq||r instanceof hq)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof qU||e instanceof pq||e instanceof mq||e instanceof hq)&&e.addDimensions(t.fields),e.swapWithParent(),gq(t)}else t.children.map(gq);var e}function yq(t){if(t instanceof sL&&t.type===KB.Main&&1===t.numChildren()){const e=t.children[0];e instanceof IU||(e.swapWithParent(),yq(t))}}const vq="scale_";function bq(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return!1;if(!bq(e.children))return!1}return!0}function xq(t,e){let n=!1;for(const r of e)n=t.optimize(r)||n;return n}function _q(t,e,n){let r=t.sources,i=!1;return i=xq(new oq,r)||i,i=xq(new rq(e),r)||i,r=r.filter((t=>t.numChildren()>0)),i=xq(new lq,r)||i,r=r.filter((t=>t.numChildren()>0)),n||(i=xq(new aq,r)||i,i=xq(new fq(e),r)||i,i=xq(new iq,r)||i,i=xq(new sq,r)||i,i=xq(new cq,r)||i,i=xq(new uq,r)||i,i=xq(new nq,r)||i,i=xq(new dq,r)||i),t.sources=r,i}class wq{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new wq((()=>t(e)))}}function kq(t){tI(t)?function(t){const e=t.component.scales;for(const n of BS(e)){const r=Aq(t,n);if(e[n].setWithExplicit("domains",r),Sq(t,n),t.component.data.isFaceted){let e=t;for(;!eI(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)wT(t)&&(t.data=vq+t.data.replace(vq,""))}}}(t):function(t){for(const n of t.children)kq(n);const e=t.component.scales;for(const n of BS(e)){let r,i=null;for(const e of t.children){const t=e.component.scales[n];if(t){r=void 0===r?t.getWithExplicit("domains"):$B(r,t.getWithExplicit("domains"),"domains","scale",Fq);const e=t.get("selectionExtent");i&&e&&i.param!==e.param&&_N("The same selection must be used to override scale domains in a layered view."),i=e}}e[n].setWithExplicit("domains",r),i&&e[n].set("selectionExtent",i,!0)}}(t)}function Aq(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=Dq(e,n);if(!t)return void _N(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=Dq(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]={...t.specifiedScales[e],domain:i}),"x"===e&&sR(r.x2)?sR(r.x)?$B(Mq(n,i,t,"x"),Mq(n,i,t,"x2"),"domain","scale",Fq):Mq(n,i,t,"x2"):"y"===e&&sR(r.y2)?sR(r.y)?$B(Mq(n,i,t,"y"),Mq(n,i,t,"y2"),"domain","scale",Fq):Mq(n,i,t,"y2"):Mq(n,i,t,e)}function Eq(t,e,n){var r;const i=null===(r=PN(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map((t=>({signal:"{data: ".concat(pR(t,{timeUnit:n,type:e}),"}")})))}(t,e,i):[t]}function Mq(t,e,n,r){const{encoding:i}=n,o=sR(i[r]),{type:a}=o,s=o.timeUnit;if(function(t){return null===t||void 0===t?void 0:t.unionWith}(e)){const i=Mq(t,void 0,n,r);return UB([...Eq(e.unionWith,a,s),...i.value])}if(xT(e))return UB([e]);if(e&&"unaggregated"!==e&&!vO(e))return UB(Eq(e,a,s));const l=n.stack;if(l&&r===l.fieldChannel){if("normalize"===l.offset)return qB([[0,1]]);const t=n.requestDataName(KB.Main);return qB([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const u=XF(r)&&Bz(o)?function(t,e,n){if(!pO(n))return;const r=t.fieldDef(e),i=r.sort;if(Az(i))return{op:"min",field:Zj(r,e),order:"ascending"};const{stack:o}=t,a=o?new Set([...o.groupbyFields,...o.stackBy.map((t=>t.fieldDef.field))]):void 0;if(kz(i))return Cq(i,o&&!a.has(i.field));if(wz(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:s,field:l}=r,u=o&&!a.has(l);if(rT(s)||iT(s))return Cq({field:Qz(r),order:n},u);if(oT(s)||!s)return Cq({op:s,field:l,order:n},u)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(SS(["ascending",void 0],i))return!0}}(n,r,t):void 0;if(jz(o))return qB(Eq([o.datum],a,s));const c=o;if("unaggregated"===e){const t=n.requestDataName(KB.Main),{field:e}=o;return qB([{data:t,field:Qz({field:e,aggregate:"min"})},{data:t,field:Qz({field:e,aggregate:"max"})}])}if(fT(c.bin)){if(pO(t))return qB("bin-ordinal"===t?[]:[{data:US(u)?n.requestDataName(KB.Main):n.requestDataName(KB.Raw),field:n.vgField(r,gR(c,r)?{binSuffix:"range"}:{}),sort:!0!==u&&U(u)?u:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=c;if(fT(t)){const e=LU(n,c.field,t);return qB([new wq((()=>{const t=n.getSignalName(e);return"[".concat(t,".start, ").concat(t,".stop]")}))])}return qB([{data:n.requestDataName(KB.Main),field:n.vgField(r,{})}])}}if(c.timeUnit&&SS(["time","utc"],t)&&Nz(c,tI(n)?n.encoding[lF(r)]:void 0,n.markDef,n.config)){const t=n.requestDataName(KB.Main);return qB([{data:t,field:n.vgField(r)},{data:t,field:n.vgField(r,{suffix:"end"})}])}return qB(u?[{data:US(u)?n.requestDataName(KB.Main):n.requestDataName(KB.Raw),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(KB.Main),field:n.vgField(r)}])}function Cq(t,e){const{op:n,field:r,order:i}=t;return{op:null!==n&&void 0!==n?n:e?"sum":bz,...r?{field:YS(r)}:{},...i?{order:i}:{}}}function Sq(t,e){var n;const r=t.component.scales[e],i=t.specifiedScales[e].domain,o=null===(n=t.fieldDef(e))||void 0===n?void 0:n.bin,a=vO(i)&&i,s=hT(o)&&pT(o.extent)&&o.extent;(a||s)&&r.set("selectionExtent",null!==a&&void 0!==a?a:s,!0)}function Dq(t,e){const{aggregate:n,type:r}=t;return n?Et(n)&&!uT.has(n)?{valid:!1,reason:fN(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:dN(t)}:{valid:!0}:{valid:!1,reason:cN(t)}}function Fq(t,e,n,r){return t.explicit&&e.explicit&&_N(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(ES(n)," and ").concat(ES(r),"). Using the union of the two domains.")}(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function Tq(t){if(wT(t)&&Et(t.field))return t.field;if(function(t){return!L(t)&&"fields"in t&&!("data"in t)}(t)){let e;for(const n of t.fields)if(wT(n)&&Et(n.field))if(e){if(e!==n.field)return _N("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=n.field;return _N("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),e}if(function(t){return!L(t)&&"fields"in t&&"data"in t}(t)){_N("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const e=t.fields[0];return Et(e)?e:void 0}}function Nq(t,e){return function(t){const e=NS(t.map((t=>{if(wT(t)){const{sort:e,...n}=t;return n}return t})),MS),n=NS(t.map((t=>{if(wT(t)){const e=t.sort;return void 0===e||US(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}})).filter((t=>void 0!==t)),MS);if(0===e.length)return;if(1===e.length){const e=t[0];if(wT(e)&&n.length>0){let t=n[0];if(n.length>1){_N(mN);const e=n.filter((t=>U(t)&&"op"in t&&"min"!==t.op));t=!n.every((t=>U(t)&&"op"in t))||1!==e.length||e[0]}else if(U(t)&&"field"in t){const n=t.field;e.field===n&&(t=!t.order||{order:t.order})}return{...e,sort:t}}return e}const r=NS(n.map((t=>US(t)||!("op"in t)||Et(t.op)&&t.op in nT?t:(_N(function(t){return"Dropping sort property ".concat(ES(t),' as unioned domains only support boolean or op "count", "min", and "max".')}(t)),!0))),MS);let i;1===r.length?i=r[0]:r.length>1&&(_N(mN),i=!0);const o=NS(t.map((t=>wT(t)?t.data:null)),(t=>t));return 1===o.length&&null!==o[0]?{data:o[0],fields:e.map((t=>t.field)),...i?{sort:i}:{}}:{fields:e,...i?{sort:i}:{}}}(t.component.scales[e].get("domains").map((e=>(wT(e)&&(e.data=t.lookupDataSource(e.data)),e))))}function Oq(t){return rI(t)||nI(t)?t.children.reduce(((t,e)=>t.concat(Oq(e))),zq(t)):zq(t)}function zq(t){return BS(t.component.scales).reduce(((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:l,range:u,reverse:c,...f}=i,d=function(t,e,n,r){if(NF(n)){if(_T(t))return{step:{signal:"".concat(e,"_step")}}}else if(U(t)&&wT(t))return{...t,data:r.lookupDataSource(t.data)};return t}(i.range,o,n,t),h=Nq(t,n),p=s?function(t,e,n,r){const i=Nj(t,e.param,e);return{signal:mO(n.get("type"))&&L(r)&&r[0]>r[1]?"isValid(".concat(i,") && reverse(").concat(i,")"):i}}(t,s,r,h):null;return e.push({name:o,type:a,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...void 0!==c?{reverse:c}:{},...f}),e}),[])}class Rq extends jB{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||DS(this.get("domains"),(t=>L(t)&&2===t.length&&t[0]<=0&&t[1]>=0))}}const Pq=["range","scheme"];function Bq(t,e){const n=t.fieldDef(e);if(null!==n&&void 0!==n&&n.bin){const{bin:r,field:i}=n,o=uF(e),a=t.getName(o);if(U(r)&&r.binned&&void 0!==r.step)return new wq((()=>{const n=t.scaleName(e),i='(domain("'.concat(n,'")[1] - domain("').concat(n,'")[0]) / ').concat(r.step);return"".concat(t.getSignalName(a)," / (").concat(i,")")}));if(fT(r)){const e=LU(t,i,r);return new wq((()=>{const n=t.getSignalName(e),r="(".concat(n,".stop - ").concat(n,".start) / ").concat(n,".step");return"".concat(t.getSignalName(a)," / (").concat(r,")")}))}}}function Lq(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const c of Pq)if(void 0!==n[c]){const r=SO(i,c),o=DO(t,c);if(r)if(o)_N(o);else switch(c){case"range":{const r=n.range;if(L(r)){if(NF(t))return UB(r.map((t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return wq.fromName(r,n)}return t})))}else if(U(r))return UB({data:e.requestDataName(KB.Main),field:r.field,sort:{op:"min",field:e.vgField(t)}});return UB(r)}case"scheme":return UB(jq(n[c]))}else _N(hN(i,c,t))}const o=t===iD||"xOffset"===t?"width":"height",a=r[o];if(wP(a))if(NF(t))if(pO(i)){const n=Uq(a,e,t);if(n)return UB({step:n})}else _N(pN(o));else if(BF(t)){const n=t===lD?"x":"y";if("band"===e.getScaleComponent(n).get("type")){const t=qq(a,i);if(t)return UB(t)}}const{rangeMin:s,rangeMax:l}=n,u=function(t,e){const{size:n,config:r,mark:i,encoding:o}=e,a=e.getSignalName.bind(e),{type:s}=sR(o[t]),l=e.getScaleComponent(t).get("type"),{domain:u,domainMid:c}=e.specifiedScales[t];switch(t){case iD:case oD:{if(SS(["point","band"],l)){const i=Iq(t,n,r.view);if(wP(i))return{step:Uq(i,e,t)}}const i=uF(t),o=e.getName(i);return t===oD&&mO(l)?[wq.fromName(a,o),0]:[0,wq.fromName(a,o)]}case lD:case uD:return function(t,e,n){const r=t===lD?"x":"y",i=e.getScaleComponent(r).get("type"),o=e.scaleName(r);if("band"===i){const t=Iq(r,e.size,e.config.view);if(wP(t)){const e=qq(t,n);if(e)return e}return[0,{signal:"bandwidth('".concat(o,"')")}]}{const n=e.encoding[r];if(Bz(n)&&n.timeUnit){const t=BN(n.timeUnit,(t=>"scale('".concat(o,"', ").concat(t,")"))),r=e.config.scale.bandWithNestedOffsetPaddingInner;return r?[{signal:"".concat(xT(r)?"".concat(r.signal,"/2"):""+r/2," * (").concat(t,")")},{signal:"".concat(xT(r)?"(1 - ".concat(r.signal,"/2)"):""+(1-r/2)," * (").concat(t,")")}]:[0,{signal:t}]}return function(t){throw new Error(t)}("Cannot use ".concat(t," scale if ").concat(r," scale is not discrete."))}}(t,e,l);case wD:{const o=Wq(i,e.component.scales[t].get("zero"),r),a=function(t,e,n,r){const i={x:Bq(n,"x"),y:Bq(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=Hq(e,i,r.view);return At(t)?t-1:new wq((()=>"".concat(t.signal," - 1")))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=Hq(e,i,r.view);return At(t)?Math.pow($q*t,2):new wq((()=>"pow(".concat($q," * ").concat(t.signal,", 2)")))}}throw new Error(oN("size",t))}(i,n,e,r);return yO(l)?function(t,e,n){const r=()=>{const r=NT(e),i=NT(t),o="(".concat(r," - ").concat(i,") / (").concat(n," - 1)");return"sequence(".concat(i,", ").concat(r," + ").concat(o,", ").concat(o,")")};return xT(e)?new wq(r):{signal:r()}}(o,a,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&L(n)?n.length+1:(_N(function(t){return"Domain for ".concat(t," is required for threshold scale.")}(r)),3)}}(l,r,u,t)):[o,a]}case dD:return[0,2*Math.PI];case kD:return[0,360];case cD:return[0,new wq((()=>"min(".concat(e.getSignalName("width"),",").concat(e.getSignalName("height"),")/2")))];case CD:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case SD:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case _D:return"symbol";case vD:case bD:case xD:return"ordinal"===l?"nominal"===s?"category":"ordinal":void 0!==c?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case AD:case ED:case MD:return[r.scale.minOpacity,r.scale.maxOpacity]}}(t,e);return(void 0!==s||void 0!==l)&&SO(i,"rangeMin")&&L(u)&&2===u.length?UB([null!==s&&void 0!==s?s:u[0],null!==l&&void 0!==l?l:u[1]]):qB(u)}function jq(t){return function(t){return!Et(t)&&!!t.name}(t)?{scheme:t.name,...AS(t,["name"])}:{scheme:t}}function Uq(t,e,n){const{encoding:r}=e,i=e.getScaleComponent(n),o=fF(n),a=r[o];if("offset"===_P({step:t,offsetIsDiscrete:Wz(a)&&QN(a.type)})&&SR(r,o)){var s,l,u,c,f;const n=e.getScaleComponent(o);let r="domain('".concat(e.scaleName(o),"').length");"band"===n.get("type")&&(r="bandspace(".concat(r,", ").concat(null!==(s=null!==(l=n.get("paddingInner"))&&void 0!==l?l:n.get("padding"))&&void 0!==s?s:0,", ").concat(null!==(u=null!==(c=n.get("paddingOuter"))&&void 0!==c?c:n.get("padding"))&&void 0!==u?u:0,")"));const a=null!==(f=i.get("paddingInner"))&&void 0!==f?f:i.get("padding");return{signal:"".concat(t.step," * ").concat(r," / (1-").concat(FT(a),")")}}return t.step}function qq(t,e){if("offset"===_P({step:t,offsetIsDiscrete:pO(e)}))return{step:t.step}}function Iq(t,e,n){const r=t===iD?"width":"height";return e[r]||CP(n,r)}function Wq(t,e,n){if(e)return xT(e)?{signal:"".concat(e.signal," ? 0 : ").concat(Wq(t,!1,n))}:0;switch(t){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(oN("size",t))}const $q=.95;function Hq(t,e,n){const r=wP(t.width)?t.width.step:MP(n,"width"),i=wP(t.height)?t.height.step:MP(n,"height");return e.x||e.y?new wq((()=>"min(".concat([e.x?e.x.signal:r,e.y?e.y.signal:i].join(", "),")"))):Math.min(r,i)}function Zq(t,e){tI(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=t;for(const s of BS(n)){const l=a[s],u=n[s],c=t.getScaleComponent(s),f=sR(i[s]),d=l[e],h=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),g=SO(h,e),y=DO(s,e);if(void 0!==d&&(g?y&&_N(y):_N(hN(h,e,s))),g&&void 0===y)if(void 0!==d){const t=f.timeUnit,n=f.type;switch(e){case"domainMax":case"domainMin":wN(l[e])||"temporal"===n||t?u.set(e,{signal:pR(l[e],{type:n,timeUnit:t})},!0):u.set(e,l[e],!0);break;default:u.copyKeyFromObject(e,l)}}else{const n=e in Yq?Yq[e]({model:t,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:m,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:o,config:r,hasNestedOffsetScale:DR(i,s),hasSecondaryRangeChannel:!!i[lF(s)]}):r.scale[e];void 0!==n&&u.set(e,n,!1)}}}(t,e):Gq(t,e)}const Yq={bins:t=>{let{model:e,fieldOrDatumDef:n}=t;return Bz(n)?function(t,e){const n=e.bin;if(fT(n)){const r=LU(t,e.field,n);return new wq((()=>t.getSignalName(r)))}if(dT(n)&&hT(n)&&void 0!==n.step)return{step:n.step}}(e,n):void 0},interpolate:t=>{let{channel:e,fieldOrDatumDef:n}=t;return function(t,e){if(SS([vD,bD,xD],t)&&"nominal"!==e)return"hcl"}(e,n.type)},nice:t=>{let{scaleType:e,channel:n,domain:r,domainMin:i,domainMax:o,fieldOrDatumDef:a}=t;return function(t,e,n,r,i,o,a){if(!(null!==(a=aR(o))&&void 0!==a&&a.bin||L(n)||null!=i||null!=r||SS([rO.TIME,rO.UTC],t)))return!!NF(e)||void 0}(e,n,r,i,o,a)},padding:t=>{let{channel:e,scaleType:n,fieldOrDatumDef:r,markDef:i,config:o}=t;return function(t,e,n,r,i,o){if(NF(t)){if(gO(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:a}=i;if("bar"===e&&(!Bz(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===t||"horizontal"===a&&"y"===t))return o.continuousBandSize}if(e===rO.POINT)return n.pointPadding}}(e,n,o.scale,r,i,o.bar)},paddingInner:t=>{let{scalePadding:e,channel:n,markDef:r,scaleType:i,config:o,hasNestedOffsetScale:a}=t;return function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(void 0===t){if(NF(e)){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:r,bandWithNestedOffsetPaddingInner:a}=i;return o?a:QS(t,"bar"===n?e:r)}return BF(e)&&r===rO.BAND?i.offsetBandPaddingInner:void 0}}(e,n,r.type,i,o.scale,a)},paddingOuter:t=>{let{scalePadding:e,channel:n,scaleType:r,scalePaddingInner:i,config:o,hasNestedOffsetScale:a}=t;return function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(void 0===t)if(NF(e)){const{bandPaddingOuter:t,bandWithNestedOffsetPaddingOuter:e}=i;if(o)return e;if(n===rO.BAND)return QS(t,xT(r)?{signal:"".concat(r.signal,"/2")}:r/2)}else if(BF(e)){if(n===rO.POINT)return.5;if(n===rO.BAND)return i.offsetBandPaddingOuter}}(e,n,r,i,o.scale,a)},reverse:t=>{let{fieldOrDatumDef:e,scaleType:n,channel:r,config:i}=t;return function(t,e,n,r){return"x"===n&&void 0!==r.xReverse?mO(t)&&"descending"===e?xT(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse:!(!mO(t)||"descending"!==e)||void 0}(n,Bz(e)?e.sort:void 0,r,i.scale)},zero:t=>{let{channel:e,fieldOrDatumDef:n,domain:r,markDef:i,scaleType:o,config:a,hasSecondaryRangeChannel:s}=t;return function(t,e,n,r,i,o,a){if(n&&"unaggregated"!==n&&mO(i)){if(L(n)){const t=n[0],e=n[n.length-1];if(t<=0&&e>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!yO(i))return!0;if((!Bz(e)||!e.bin)&&SS([...TF,...zF],t)){const{orient:e,type:n}=r;return(!SS(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t))&&(!(!SS(["bar","area"],n)||a)||(null===o||void 0===o?void 0:o.zero))}return!1}(e,n,r,i,o,a.scale,s)}};function Vq(t){tI(t)?function(t){const e=t.component.scales;for(const n of GF){const r=e[n];if(!r)continue;const i=Lq(n,t);r.setWithExplicit("range",i)}}(t):Gq(t,"range")}function Gq(t,e){const n=t.component.scales;for(const r of t.children)"range"===e?Vq(r):Zq(r,e);for(const r of BS(n)){let i;for(const n of t.children){const t=n.component.scales[r];t&&(i=$B(i,t.getWithExplicit(e),e,"scale",IB(((t,n)=>"range"===e&&t.step&&n.step?t.step-n.step:0))))}n[r].setWithExplicit(e,i)}}function Xq(t,e,n,r){const i=function(t,e,n,r,i){switch(e.type){case"nominal":case"ordinal":if($D(t)||"discrete"===tT(t))return"shape"===t&&"ordinal"===e.type&&_N(uN(t,"ordinal")),"ordinal";if(NF(t)||BF(t)){if(SS(["rect","bar","image","rule"],n.type))return"band";if(r)return"band"}else if("arc"===n.type&&t in OF)return"band";return JO(n[uF(t)])||Yz(e)&&null!==(i=e.axis)&&void 0!==i&&i.tickBand?"band":"point";case"temporal":return $D(t)?"time":"discrete"===tT(t)?(_N(uN(t,"temporal")),"ordinal"):Bz(e)&&e.timeUnit&&PN(e.timeUnit).utc?"utc":"time";case"quantitative":return $D(t)?Bz(e)&&fT(e.bin)?"bin-ordinal":"linear":"discrete"===tT(t)?(_N(uN(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(nN(e.type))}(e,n,r,arguments.length>4&&void 0!==arguments[4]&&arguments[4]),{type:o}=t;return XF(e)?void 0!==o?function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!XF(t))return!1;switch(t){case iD:case oD:case lD:case uD:case dD:case cD:return!!gO(e)||"band"===e||"point"===e&&!n;case wD:case CD:case AD:case ED:case MD:case kD:return gO(e)||yO(e)||SS(["band","point","ordinal"],e);case vD:case bD:case xD:return"band"!==e;case SD:case _D:return"ordinal"===e||yO(e)}}(e,o)?Bz(n)&&(a=o,s=n.type,!(SS([KN,eO],s)?void 0===a||pO(a):s===tO?SS([rO.TIME,rO.UTC,void 0],a):s!==JN||cO(a)||yO(a)||void 0===a))?(_N(function(t,e){return'FieldDef does not work with "'.concat(t,'" scale. We are using "').concat(e,'" scale instead.')}(o,i)),i):o:(_N(function(t,e,n){return'Channel "'.concat(t,'" does not work with "').concat(e,'" scale. We are using "').concat(n,'" scale instead.')}(e,o,i)),i):i:null;var a,s}function Qq(t){tI(t)?t.component.scales=function(t){const{encoding:e,mark:n,markDef:r}=t,i={};for(const a of GF){const s=sR(e[a]);if(s&&n===$O&&a===_D&&s.type===nO)continue;let l=s&&s.scale;if(!BF(a)||DR(e,dF(a))){if(s&&null!==l&&!1!==l){var o;null!==(o=l)&&void 0!==o||(l={});const n=Xq(l,a,s,r,DR(e,a));i[a]=new Rq(t.scaleName("".concat(a),!0),{value:n,explicit:l.type===n})}}else l&&_N(aN(a))}return i}(t):t.component.scales=function(t){var e;const n=t.component.scales={},r={},i=t.component.resolve;for(const a of t.children){Qq(a);for(const n of BS(a.component.scales)){var o;if(null!==(o=(e=i.scale)[n])&&void 0!==o||(e[n]=pU(n,t)),"shared"===i.scale[n]){const t=r[n],e=a.component.scales[n].getWithExplicit("type");t?oO(t.value,e.value)?r[n]=$B(t,e,"type","scale",Jq):(i.scale[n]="independent",delete r[n]):r[n]=e}}}for(const a of BS(r)){const e=t.scaleName(a,!0),i=r[a];n[a]=new Rq(e,i);for(const n of t.children){const t=n.component.scales[a];t&&(n.renameScale(t.get("name"),e),t.merged=!0)}}return n}(t)}const Jq=IB(((t,e)=>sO(t)-sO(e)));class Kq{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function tI(t){return"unit"===(null===t||void 0===t?void 0:t.type)}function eI(t){return"facet"===(null===t||void 0===t?void 0:t.type)}function nI(t){return"concat"===(null===t||void 0===t?void 0:t.type)}function rI(t){return"layer"===(null===t||void 0===t?void 0:t.type)}class iI{constructor(t,e,n,r,i,o,a){var s,l;this.type=e,this.parent=n,this.config=i,this.correctDataNames=t=>{var e,n;return null!==(e=t.from)&&void 0!==e&&e.data&&(t.from.data=this.lookupDataSource(t.from.data)),null!==(n=t.from)&&void 0!==n&&null!==(n=n.facet)&&void 0!==n&&n.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t},this.parent=n,this.config=i,this.view=yT(a),this.name=null!==(s=t.name)&&void 0!==s?s:r,this.title=bT(t.title)?{text:t.title}:t.title?yT(t.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new Kq,this.projectionNameMap=n?n.projectionNameMap:new Kq,this.signalNameMap=n?n.signalNameMap:new Kq,this.data=t.data,this.description=t.description,this.transforms=(null!==(l=t.transform)&&void 0!==l?l:[]).map((t=>uB(t)?{filter:xS(t.filter,GN)}:t)),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){const r=n[e],i={},{spacing:o,columns:a}=r;void 0!==o&&(i.spacing=o),void 0!==a&&(Cz(t)&&!Ez(t.facet)||vP(t))&&(i.columns=a),bP(t)&&(i.columns=1);for(const u of AP)if(void 0!==t[u])if("spacing"===u){var s,l;const e=t[u];i[u]=At(e)?e:{row:null!==(s=e.row)&&void 0!==s?s:o,column:null!==(l=e.column)&&void 0!==l?l:o}}else i[u]=t[u];return i}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:Cz(t)||(null===n||void 0===n?void 0:n.component.data.isFaceted)&&void 0===t.data},layoutSize:new jB,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?wS(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t){let{ignoreRange:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qq(t),kq(t);for(const n of CO)Zq(t,n);e||Vq(t)}(this)}parseProjection(){RU(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){CU(this)}assembleEncodeFromView(t){const{style:e,...n}=t,r={};for(const i of BS(n)){const t=n[i];void 0!==t&&(r[i]=DT(t))}return r}assembleGroupEncodeEntry(t){var e;let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),t||(this.description&&(n.description=DT(this.description)),"unit"!==this.type&&"layer"!==this.type)?PS(n)?void 0:n:{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...null!==(e=n)&&void 0!==e?e:{}}}assembleLayout(){if(!this.layout)return;const{spacing:t,...e}=this.layout,{component:n,config:r}=this,i=function(t,e){const n={};for(const r of ZD){const i=t[r];if(null!==i&&void 0!==i&&i.facetFieldDef){const{titleAnchor:t,titleOrient:o}=Gj(["titleAnchor","titleOrient"],i.facetFieldDef.header,e,r),a=Yj(r,o),s=aU(t,a);void 0!==s&&(n[a]=s)}}return PS(n)?void 0:n}(n.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...e,...i?{titleBand:i}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of ZD)t[n].title&&e.push(Jj(this,n));for(const n of Xj)e=e.concat(eU(this,n));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map((t=>Rj(t,"grid",e))),...r.map((t=>Rj(t,"grid",e))),...n.map((t=>Rj(t,"main",e))),...r.map((t=>Rj(t,"main",e)))].filter((t=>t))}(this.component.axes,this.config)}assembleLegends(){return TU(this)}assembleProjections(){return rI(t=this)||nI(t)?function(t){return t.children.reduce(((t,e)=>t.concat(e.assembleProjections())),NU(t))}(t):NU(t);var t}assembleTitle(){var t,e,n;const{encoding:r,...i}=null!==(t=this.title)&&void 0!==t?t:{},o={...vT(this.config.title).nonMarkTitleProperties,...i,...r?{encode:{update:r}}:{}};if(o.text)return SS(["unit","layer"],this.type)?SS(["middle",void 0],o.anchor)&&(null!==(e=o.frame)&&void 0!==e||(o.frame="group")):null!==(n=o.anchor)&&void 0!==n||(o.anchor="start"),PS(o)?void 0:o}assembleGroup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e={};(t=t.concat(this.assembleSignals())).length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||eI(this.parent)?Oq(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const o=this.assembleLegends();return o.length>0&&(e.legends=o),e}getName(t){return qS((this.name?"".concat(this.name,"_"):"")+t)}getDataName(t){return this.getName(KB[t].toLowerCase())}requestDataName(t){const e=this.getDataName(t),n=this.component.data.outputNodeRefCounts;return n[e]=(n[e]||0)+1,e}getSizeSignalRef(t){if(eI(this.parent)){const e=RF(dU(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(pO(t)&&_T(r)){const t=n.get("name"),r=Tq(Nq(this,e));return r?{signal:fU(t,n,Qz({aggregate:"distinct",field:r},{expr:"datum"}))}:(_N(YT(e)),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):rF(t)&&XF(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error('Cannot find a selection named "'.concat(e,'".'));return n}hasAxisOrientSignalRef(){var t,e;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some((t=>t.hasOrientSignalRef())))||(null===(e=this.component.axes.y)||void 0===e?void 0:e.some((t=>t.hasOrientSignalRef())))}}class oI extends iI{vgField(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.fieldDef(t);if(n)return Qz(n,e)}reduceFieldDef(t,e){return function(t,e,n,r){return t?BS(t).reduce(((n,i)=>{const o=t[i];return L(o)?o.reduce(((t,n)=>e.call(r,t,n,i)),n):e.call(r,n,o,i)}),n):n}(this.getMapping(),((e,n,r)=>{const i=aR(n);return i?t(e,i,r):e}),e)}forEachFieldDef(t,e){zR(this.getMapping(),((e,n)=>{const r=aR(e);r&&t(r,n)}),e)}}class aI extends aL{clone(){return new aI(null,wS(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=wS(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(i=o[1])&&void 0!==i?i:"density"],e.groupby&&null==e.minsteps&&null==e.maxsteps&&null==e.steps&&(this.transform.steps=200)}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform ".concat(MS(this.transform))}assemble(){const{density:t,...e}=this.transform;return{type:"kde",field:t,...e}}}class sI extends aL{clone(){return new sI(null,{...this.filter})}constructor(t,e){super(t),this.filter=e}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==RT("invalid",i,n))return null;const o=e.reduceFieldDef(((t,n,i)=>{const o=XF(i)&&e.getScaleComponent(i);return o&&mO(o.get("type"))&&"count"!==n.aggregate&&!HO(r)&&(t[n.field]=n),t}),{});return BS(o).length?new sI(t,o):null}dependentFields(){return new Set(BS(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid ".concat(MS(this.filter))}assemble(){const t=BS(this.filter).reduce(((t,e)=>{const n=this.filter[e],r=Qz(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push("(isDate(".concat(r,") || (isValid(").concat(r,") && isFinite(+").concat(r,")))")):"quantitative"===n.type&&(t.push("isValid(".concat(r,")")),t.push("isFinite(+".concat(r,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class lI extends aL{clone(){return new lI(this.parent,wS(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=wS(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((t,e)=>{var n;return null!==(n=r[e])&&void 0!==n?n:t}))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform ".concat(MS(this.transform))}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class uI extends aL{clone(){return new uI(null,wS(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=wS(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(i=o[1])&&void 0!==i?i:"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform ".concat(MS(this.transform))}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class cI extends aL{clone(){return new cI(null,wS(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[[mD,pD],[yD,gD]]){const i=r.map((t=>{const n=sR(e.encoding[t]);return Bz(n)?n.field:jz(n)?{expr:"".concat(n.datum)}:Hz(n)?{expr:"".concat(n.value)}:void 0}));(i[0]||i[1])&&(t=new cI(t,i,null,e.getName("geojson_"+n++)))}if(e.channelHasField(_D)){const r=e.typedFieldDef(_D);r.type===nO&&(t=new cI(t,null,r.field,e.getName("geojson_"+n++)))}return t}constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}dependentFields(){var t;const e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(Et);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(MS(this.fields))}assemble(){return[...this.geojson?[{type:"filter",expr:'isValid(datum["'.concat(this.geojson,'"])')}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class fI extends aL{clone(){return new fI(null,this.projection,wS(this.fields),wS(this.as))}constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[[mD,pD],[yD,gD]]){const r=n.map((t=>{const n=sR(e.encoding[t]);return Bz(n)?n.field:jz(n)?{expr:"".concat(n.datum)}:Hz(n)?{expr:"".concat(n.value)}:void 0})),i=n[0]===yD?"2":"";(r[0]||r[1])&&(t=new fI(t,e.projectionName(),r,[e.getName("x".concat(i)),e.getName("y".concat(i))]))}return t}dependentFields(){return new Set(this.fields.filter(Et))}producedFields(){return new Set(this.as)}hash(){return"Geopoint ".concat(this.projection," ").concat(MS(this.fields)," ").concat(MS(this.as))}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class dI extends aL{clone(){return new dI(null,wS(this.transform))}constructor(t,e){super(t),this.transform=e}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t;return{signal:"sequence(".concat([e,n,...r?[r]:[]].join(","),")")}}static makeFromTransform(t,e){return new dI(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(Bz(r)&&Bz(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const a=r.impute?i:i.impute?r:void 0,{method:s,value:l,frame:u,keyvals:c}=o.impute,f=RR(e.mark,n);return new dI(t,{impute:o.field,key:a.field,...s?{method:s}:{},...void 0!==l?{value:l}:{},...u?{frame:u}:{},...void 0!==c?{keyvals:c}:{},...f.length?{groupby:f}:{}})}return null}hash(){return"Impute ".concat(MS(this.transform))}assemble(){var t;const{impute:e,key:n,keyvals:r,method:i,groupby:o,value:a,frame:s=[null,null]}=this.transform,l={type:"impute",field:e,key:n,...r?{keyvals:(u=r,void 0!==(null===(t=u)||void 0===t?void 0:t.stop)?this.processSequence(r):r)}:{},method:"value",...o?{groupby:o}:{},value:i&&"value"!==i?null:a};var u;return i&&"value"!==i?[l,{type:"window",as:["imputed_".concat(e,"_value")],ops:[i],fields:[e],frame:s,ignorePeers:!1,...o?{groupby:o}:{}},{type:"formula",expr:"datum.".concat(e," === null ? datum.imputed_").concat(e,"_value : datum.").concat(e),as:e}]:[l]}}class hI extends aL{clone(){return new hI(null,wS(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=wS(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.loess]}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform ".concat(MS(this.transform))}assemble(){const{loess:t,on:e,...n}=this.transform;return{type:"loess",x:e,y:t,...n}}}class pI extends aL{clone(){return new pI(null,wS(this.transform),this.secondary)}constructor(t,e,n){super(t),this.transform=e,this.secondary=n}static make(t,e,n,r){const i=e.component.data.sources,{from:o}=n;let a=null;if(function(t){return"data"in t}(o)){let t=SI(o.data,i);t||(t=new GU(o.data),i.push(t));const n=e.getName("lookup_".concat(r));a=new sL(t,n,KB.Lookup,e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=a}else if(function(t){return"param"in t}(o)){const t=o.param;let r;n={as:t,...n};try{r=e.getSelectionComponent(qS(t),t)}catch(e){throw new Error('Lookups can only be performed on selection parameters. "'.concat(t,'" is a variable parameter.'))}if(a=r.materialized,!a)throw new Error('Cannot define and lookup the "'.concat(t,'" selection in the same view. Try moving the lookup into a second, layered view?'))}return new pI(t,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?it(this.transform.as):this.transform.from.fields)}hash(){return"Lookup ".concat(MS({transform:this.transform,secondary:this.secondary}))}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:it(this.transform.as)}:{}};else{let e=this.transform.as;Et(e)||(_N('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),e="_lookup"),t={as:[e]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class mI extends aL{clone(){return new mI(null,wS(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=wS(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(i=o[1])&&void 0!==i?i:"value"]}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform ".concat(MS(this.transform))}assemble(){const{quantile:t,...e}=this.transform;return{type:"quantile",field:t,...e}}}class gI extends aL{clone(){return new gI(null,wS(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=wS(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.regression]}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform ".concat(MS(this.transform))}assemble(){const{regression:t,on:e,...n}=this.transform;return{type:"regression",x:e,y:t,...n}}}class yI extends aL{clone(){return new yI(null,wS(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){var e;this.transform.groupby=NS((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),(t=>t))}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return"PivotTransform ".concat(MS(this.transform))}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return{type:"pivot",field:t,value:e,...void 0!==r?{limit:r}:{},...void 0!==i?{op:i}:{},...void 0!==n?{groupby:n}:{}}}}class vI extends aL{clone(){return new vI(null,wS(this.transform))}constructor(t,e){super(t),this.transform=e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform ".concat(MS(this.transform))}assemble(){return{type:"sample",size:this.transform.sample}}}function bI(t){let e=0;return function n(r,i){var o;if(r instanceof GU&&!r.isGenerator&&!ZB(r.data)&&(t.push(i),i={name:null,source:i.name,transform:[]}),r instanceof HU&&(r.parent instanceof GU&&!i.source?(i.format={...null!==(o=i.format)&&void 0!==o?o:{},parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof IU)return i.name||(i.name="data_"+e++),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source,void t.push(...r.assemble());switch((r instanceof YU||r instanceof VU||r instanceof sI||r instanceof Fj||r instanceof Hj||r instanceof fI||r instanceof qU||r instanceof pI||r instanceof mq||r instanceof hq||r instanceof uI||r instanceof lI||r instanceof aI||r instanceof hI||r instanceof mI||r instanceof gI||r instanceof ZU||r instanceof vI||r instanceof yI)&&i.transform.push(r.assemble()),(r instanceof UU||r instanceof lL||r instanceof dI||r instanceof pq||r instanceof cI)&&i.transform.push(...r.assemble()),r instanceof sL&&(i.source&&0===i.transform.length?r.setSource(i.source):r.parent instanceof sL?r.setSource(i.name):(i.name||(i.name="data_"+e++),r.setSource(i.name),1===r.numChildren()&&(t.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof sL&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+e++);let o=i.name;!i.source||i.transform.length>0?t.push(i):o=i.source;for(const t of r.children)n(t,{name:null,source:o,transform:[]});break}}}}function xI(t,e){const{facet:n,config:r,child:i,component:o}=t;if(t.channelHasField(e)){var a;const s=n[e],l=Vj("title",null,r,e);let u=nR(s,r,{allowDisabling:!0,includeDefault:void 0===l||!!l});i.component.layoutHeaders[e].title&&(u=L(u)?u.join(", "):u,u+=" / ".concat(i.component.layoutHeaders[e].title),i.component.layoutHeaders[e].title=null);const c=Vj("labelOrient",s.header,r,e),f=null!==s.header&&QS(null===(a=s.header)||void 0===a?void 0:a.labels,r.header.labels,!0),d=SS(["bottom","right"],c)?"footer":"header";o.layoutHeaders[e]={title:null!==s.header?u:null,facetFieldDef:s,[d]:"facet"===e?[]:[_I(t,e,f)]}}}function _I(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function wI(t,e){const{child:n}=t;if(n.component.axes[e]){const{layoutHeaders:o,resolve:a}=t.component;if(a.axis[e]=mU(a,e),"shared"===a.axis[e]){const a="x"===e?"column":"row",s=o[a];for(const o of n.component.axes[e]){var r;const e="top"===(i=o.get("orient"))||"left"===i||xT(i)?"header":"footer";null!==(r=s[e])&&void 0!==r||(s[e]=[_I(t,a,!1)]);const n=Rj(o,"main",t.config,{header:!0});n&&s[e][0].axes.push(n),o.mainExtracted=!0}}}var i}function kI(t){for(const e of t.children)e.parseLayoutSize()}function AI(t,e){const n=dU(e),r=RF(n),i=t.component.resolve,o=t.component.layoutSize;let a;for(const l of t.children){var s;const e=l.component.layoutSize.getWithExplicit(n),o=null!==(s=i.scale[r])&&void 0!==s?s:pU(r,t);if("independent"===o&&"step"===e.value){a=void 0;break}if(a){if("independent"===o&&a.value!==e.value){a=void 0;break}a=$B(a,e,n,"")}else a=e}if(a){for(const r of t.children)t.renameSignal(r.getName(n),t.getName(e)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(e,a)}else o.setWithExplicit(e,{explicit:!1,value:void 0})}function EI(t,e){const n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){const t=i.get("type"),n=i.get("range");if(pO(t)){const t=CP(r.view,e);return _T(n)||wP(t)?"step":t}return EP(r.view,e)}if(t.hasProjection||"arc"===t.mark)return EP(r.view,e);{const t=CP(r.view,e);return wP(t)?t.step:t}}function MI(t,e,n){return Qz(e,{suffix:"by_".concat(Qz(t)),...null!==n&&void 0!==n?n:{}})}class CI extends oI{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=QI(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Ez(t))return{facet:this.initFacetFieldDef(t,"facet")};const e=BS(t),n={};for(const r of e){if(![eD,nD].includes(r)){_N(oN(r,"facet"));break}const e=t[r];if(void 0===e.field){_N(iN(e,r));break}n[r]=this.initFacetFieldDef(e,r)}return n}initFacetFieldDef(t,e){const n=cR(t,e);return n.header?n.header=yT(n.header):null===n.header&&(n.header=null),n}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=DI(this),this.child.parseData()}parseLayoutSize(){kI(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of ZD)xI(t,e);wI(t,"x"),wI(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const i of ZD)for(const o of Qj){const a=this.component.layoutHeaders[i],s=a[o],{facetFieldDef:l}=a;if(l){const n=Vj("titleOrient",l.header,this.config,i);if(["right","bottom"].includes(n)){var e;const r=Yj(i,n);null!==(e=t.titleAnchor)&&void 0!==e||(t.titleAnchor={}),t.titleAnchor[r]="end"}}if(null!==s&&void 0!==s&&s[0]){var n,r;const e="row"===i?"height":"width",s="header"===o?"headerBand":"footerBand";"facet"===i||this.child.component.layoutSize.get(e)||(null!==(n=t[s])&&void 0!==n||(t[s]={}),t[s][i]=.5),a.title&&(null!==(r=t.offset)&&void 0!==r||(t.offset={}),t.offset["row"===i?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof CI))return{signal:"length(data('".concat(this.getName("column_domain"),"'))")}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof CI?{...this.channelHasField("column")?{encode:{update:{columns:{field:Qz(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof CI){if(this.child.channelHasField("column")){const r=Qz(this.child.facet.column);t.push(r),e.push("distinct"),n.push("distinct_".concat(r))}}else for(const r of TF){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(pO(o)&&_T(a)){const i=Tq(Nq(this.child,r));i?(t.push(i),e.push("distinct"),n.push("distinct_".concat(i))):_N(YT(r))}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const u of ZD){const t=this.facet[u];if(t){s.push(Qz(t));const{bin:e,sort:l}=t;if(fT(e)&&s.push(Qz(t,{binSuffix:"end"})),kz(l)){const{field:e,op:s=bz}=l,u=MI(t,l);n&&r?(i.push(u),o.push("max"),a.push(u)):(i.push(e),o.push(s),a.push(u))}else if(L(l)){const e=Zj(t,u);i.push(e),o.push("max"),a.push(e)}}}const l=!!n&&!!r;return{name:t,data:e,groupby:s,...l||i.length>0?{aggregate:{...l?{cross:l}:{},...i.length?{fields:i,ops:o,as:a}:{}}}:{}}}facetSortFields(t){const{facet:e}=this,n=e[t];return n?kz(n.sort)?[MI(n,n.sort,{expr:"datum"})]:L(n.sort)?[Zj(n,t,{expr:"datum"})]:[Qz(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(kz(t)?t.order:!L(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:e}=this;if(t.facet)return rU(t.facet,"facet",e);const n={row:["top","bottom"],column:["left","right"]};for(const i of Xj)if(t[i]){var r;const o=Vj("labelOrient",null===(r=t[i])||void 0===r?void 0:r.header,e,i);if(n[i].includes(o))return rU(t[i],i,e)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=bI(e);for(const r of t.children)n(r,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...r?{title:r}:{},...i?{style:i}:{},from:{facet:this.assembleFacet()},sort:{field:ZD.map((t=>this.facetSortFields(t))).flat(),order:ZD.map((t=>this.facetSortOrder(t))).flat()},...e.length>0?{data:e}:{},...n?{encode:{update:n}}:{},...t.assembleGroup(rL(this,[]))}]}getMapping(){return this.facet}}function SI(t,e){for(const a of e){var n,r,i,o;const e=a.data;if(t.name&&a.hasName()&&t.name!==a.dataName)continue;const s=null===(n=t.format)||void 0===n?void 0:n.mesh,l=null===(r=e.format)||void 0===r?void 0:r.feature;if(s&&l)continue;const u=null===(i=t.format)||void 0===i?void 0:i.feature;if((u||l)&&u!==l)continue;const c=null===(o=e.format)||void 0===o?void 0:o.mesh;if(!s&&!c||s===c)if(YB(t)&&YB(e)){if(_S(t.values,e.values))return a}else if(ZB(t)&&ZB(e)){if(t.url===e.url)return a}else if(VB(t)&&t.name===a.dataName)return a}return null}function DI(t){var e,n,r,i,o,a,s;let l=function(t,e){if(t.data||!t.parent){if(null===t.data){const t=new GU({values:[]});return e.push(t),t}const n=SI(t.data,e);if(n)return GB(t.data)||(n.data.format=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)TS(t,null!==i&&void 0!==i?i:{});return t}({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new GU(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}(t,t.component.data.sources);const{outputNodes:u,outputNodeRefCounts:c}=t.component.data,f=t.data,d=f&&(GB(f)||ZB(f)||YB(f))||!t.parent?new HB:t.parent.component.data.ancestorParse.clone();GB(f)?(XB(f)?l=new VU(l,f.sequence):JB(f)&&(l=new YU(l,f.graticule)),d.parseNothing=!0):null===(null===f||void 0===f||null===(e=f.format)||void 0===e?void 0:e.parse)&&(d.parseNothing=!0),l=null!==(n=HU.makeExplicit(l,t,d))&&void 0!==n?n:l,l=new ZU(l);const h=t.parent&&rI(t.parent);(tI(t)||eI(t))&&h&&(l=null!==(r=UU.makeFromEncoding(l,t))&&void 0!==r?r:l),t.transforms.length>0&&(l=function(t,e,n){let r=0;for(const a of e.transforms){let s,l;if(xB(a))l=t=new Hj(t,a),s="derived";else if(uB(a)){var i;const r=$U(a);l=t=null!==(i=HU.makeWithAncestors(t,{},r,n))&&void 0!==i?i:t,t=new Fj(t,e,a.filter)}else if(_B(a))l=t=UU.makeFromTransform(t,a,e),s="number";else if(kB(a))s="date",void 0===n.getWithExplicit(a.field).value&&(t=new HU(t,{[a.field]:s}),n.set(a.field,s,!1)),l=t=lL.makeFromTransform(t,a);else if(AB(a))l=t=qU.makeFromTransform(t,a),s="number",Ej(e)&&(t=new ZU(t));else if(cB(a))l=t=pI.make(t,e,a,r++),s="derived";else if(yB(a))l=t=new mq(t,a),s="number";else if(vB(a))l=t=new hq(t,a),s="number";else if(EB(a))l=t=pq.makeFromTransform(t,a),s="derived";else if(MB(a))l=t=new uI(t,a),s="derived";else if(bB(a))l=t=new lI(t,a),s="derived";else if(fB(a))l=t=new yI(t,a),s="derived";else if(gB(a))t=new vI(t,a);else if(wB(a))l=t=dI.makeFromTransform(t,a),s="derived";else if(dB(a))l=t=new aI(t,a),s="derived";else if(hB(a))l=t=new mI(t,a),s="derived";else if(pB(a))l=t=new gI(t,a),s="derived";else{if(!mB(a)){_N("Ignoring an invalid transform: ".concat(ES(a),"."));continue}l=t=new hI(t,a),s="derived"}if(l&&void 0!==s)for(const t of null!==(o=l.producedFields())&&void 0!==o?o:[]){var o;n.set(t,s,!1)}}return t}(l,t,d));const p=function(t){const e={};if(tI(t)&&t.component.selection)for(const n of BS(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&XS(t.field)>1&&(e[t.field]="flatten")}return e}(t),m=function(t){const e={};function n(t){var n;hR(t)?e[t.field]="date":"quantitative"===t.type&&Et(n=t.aggregate)&&SS(["min","max"],n)?e[t.field]="number":XS(t.field)>1?t.field in e||(e[t.field]="flatten"):Zz(t)&&kz(t.sort)&&XS(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((tI(t)||eI(t))&&t.forEachFieldDef(((e,r)=>{if($z(e))n(e);else{const i=aF(r),o=t.fieldDef(i);n({...e,type:o.type})}})),tI(t)){const{mark:n,markDef:r,encoding:i}=t;if(HO(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];Bz(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}(t);l=null!==(i=HU.makeWithAncestors(l,{},{...p,...m},d))&&void 0!==i?i:l,tI(t)&&(l=cI.parseAll(l,t),l=fI.parseAll(l,t)),(tI(t)||eI(t))&&(h||(l=null!==(o=UU.makeFromEncoding(l,t))&&void 0!==o?o:l),l=null!==(a=lL.makeFromEncoding(l,t))&&void 0!==a?a:l,l=Hj.parseAllForSortIndex(l,t));const g=t.getDataName(KB.Raw),y=new sL(l,g,KB.Raw,c);if(u[g]=y,l=y,tI(t)){var v,b;const e=qU.makeFromEncoding(l,t);e&&(l=e,Ej(t)&&(l=new ZU(l))),l=null!==(v=dI.makeFromEncoding(l,t))&&void 0!==v?v:l,l=null!==(b=pq.makeFromEncoding(l,t))&&void 0!==b?b:l}tI(t)&&(l=null!==(s=sI.make(l,t))&&void 0!==s?s:l);const x=t.getDataName(KB.Main),_=new sL(l,x,KB.Main,c);u[x]=_,l=_,tI(t)&&function(t,e){for(const[r,i]of jS(null!==(n=t.component.selection)&&void 0!==n?n:{})){var n;const o=t.getName("lookup_".concat(r));t.component.data.outputNodes[o]=i.materialized=new sL(new Fj(e,t,{param:r}),o,KB.Lookup,t.component.data.outputNodeRefCounts)}}(t,_);let w=null;if(eI(t)){var k;const e=t.getName("facet");l=null!==(k=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(kz(i.sort)){const{field:n,op:r=bz}=i.sort;t=e=new hq(t,{joinaggregate:[{op:r,field:n,as:MI(i,i.sort,{forAs:!0})}],groupby:[Qz(i)]})}return e}return null}(l,t.facet))&&void 0!==k?k:l,w=new IU(l,t,e,_.getSource()),u[e]=w}return{...t.component.data,outputNodes:u,outputNodeRefCounts:c,raw:y,main:_,facetRoot:w,ancestorParse:d}}class FI extends iI{constructor(t,e,n,r){var i,o;super(t,"concat",e,n,r,t.resolve),"shared"!==(null===(i=t.resolve)||void 0===i||null===(i=i.axis)||void 0===i?void 0:i.x)&&"shared"!==(null===(o=t.resolve)||void 0===o||null===(o=o.axis)||void 0===o?void 0:o.y)||_N("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map(((t,e)=>QI(t,this,this.getName("concat_".concat(e)),void 0,r)))}parseData(){this.component.data=DI(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of BS(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return bP(t)?t.vconcat:xP(t)?t.hconcat:t.concat}parseLayoutSize(){!function(t){kI(t);const e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";AI(t,e),AI(t,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.forEach((t=>t.assembleSignals())),[]}assembleLayoutSignals(){const t=lU(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleMarks(){return this.children.map((t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...e?{title:e}:{},...n?{style:n}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}}))}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...null!=t?{columns:t}:{},bounds:"full",align:"each"}}}const TI={disable:1,gridScale:1,scale:1,..._R,labelExpr:1,encode:1},NI=BS(TI);class OI extends jB{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new OI(wS(this.explicit),wS(this.implicit),this.mainExtracted)}hasAxisPart(t){return!("axis"!==t&&("grid"===t||"title"===t?!this.get(t):!1===(e=this.get(t))||null===e));var e}hasOrientSignalRef(){return xT(this.explicit.orient)}}const zI={bottom:"top",top:"bottom",left:"right",right:"left"};function RI(t,e){if(!t)return e.map((t=>t.clone()));{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!=!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(e.explicit&&o.explicit&&e.value!==o.value)return;t[r]=PI(n,i)}}}return t}function PI(t,e){for(const n of NI){const r=$B(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",((t,e)=>{switch(n){case"title":return IT(t,e);case"gridScale":return{explicit:t.explicit,value:QS(t.value,e.value)}}return WB(t,e,n,"axis")}));t.setWithExplicit(n,r)}return t}function BI(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(xT(n.labelAngle)?n.labelAngle:KS(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===$j(r,i))return!0}return t===n[e]}const LI=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function jI(t,e){var n,r,i,o,a;let s=e.axis(t);const l=new OI,u=sR(e.encoding[t]),{mark:c,config:f}=e,d=(null===(n=s)||void 0===n?void 0:n.orient)||(null===(r=f["x"===t?"axisX":"axisY"])||void 0===r?void 0:r.orient)||(null===(i=f.axis)||void 0===i?void 0:i.orient)||function(t){return"x"===t?"bottom":"left"}(t),h=e.getScaleComponent(t).get("type"),p=function(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:cO(e)?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[],o="x"===t?"axisX":"axisY",a=xT(n)?"axisOrient":"axis".concat($S(n)),s=[...i,...i.map((t=>o+t.substr(4)))],l=["axis",a,o];return{vlOnlyAxisConfig:Bj(s,r,t,n),vgAxisConfig:Bj(l,r,t,n),axisConfigStyle:Lj([...l,...s],r)}}(t,h,d,e.config),m=void 0!==s?!s:jj("disable",f.style,null===(o=s)||void 0===o?void 0:o.style,p).configValue;if(l.set("disable",m,void 0!==s),m)return l;s=s||{};const g=function(t,e,n,r,i){const o=null===e||void 0===e?void 0:e.labelAngle;if(void 0!==o)return xT(o)?o:KS(o);{const{configValue:o}=jj("labelAngle",r,null===e||void 0===e?void 0:e.style,i);return void 0!==o?KS(o):n!==iD||!SS([eO,KN],t.type)||Bz(t)&&t.timeUnit?void 0:270}}(u,s,t,f.style,p),y=pz(s.formatType,u,h),v=hz(u,u.type,s.format,s.formatType,f,!0),b={fieldOrDatumDef:u,axis:s,channel:t,model:e,scaleType:h,orient:d,labelAngle:g,format:v,formatType:y,mark:c,config:f};for(const w of NI){const n=w in Uj?Uj[w](b):kR(w)?s[w]:void 0,r=void 0!==n,i=BI(n,w,s,e,t);if(r&&i)l.set(w,n,i);else{const{configValue:t,configFrom:e}=kR(w)&&"values"!==w?jj(w,f.style,s.style,p):{},o=void 0!==t;r&&!o?l.set(w,n,i):("vgAxisConfig"!==e||LI.has(w)&&o||vR(t)||xT(t))&&l.set(w,t,!1)}}const x=null!==(a=s.encoding)&&void 0!==a?a:{},_=bR.reduce(((n,r)=>{var i;if(!l.hasAxisPart(r))return n;const o=hU(null!==(i=x[r])&&void 0!==i?i:{},e),a="labels"===r?function(t,e,n,r){const{encoding:i,config:o}=t,a=null!==(r=sR(i[e]))&&void 0!==r?r:sR(i[lF(e)]),s=t.axis(e)||{},{format:l,formatType:u}=s;if(sz(u))return{text:dz({fieldOrDatumDef:a,field:"datum.value",format:l,formatType:u,config:o}),...n};if(void 0===l&&void 0===u&&o.customFormatTypes){if("quantitative"===Lz(a)){if(Yz(a)&&"normalize"===a.stack&&o.normalizedNumberFormatType)return{text:dz({fieldOrDatumDef:a,field:"datum.value",format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,config:o}),...n};if(o.numberFormatType)return{text:dz({fieldOrDatumDef:a,field:"datum.value",format:o.numberFormat,formatType:o.numberFormatType,config:o}),...n}}if("temporal"===Lz(a)&&o.timeFormatType&&Bz(a)&&!a.timeUnit)return{text:dz({fieldOrDatumDef:a,field:"datum.value",format:o.timeFormat,formatType:o.timeFormatType,config:o}),...n}}return n}(e,t,o):o;return void 0===a||PS(a)||(n[r]={update:a}),n}),{});return PS(_)||l.set("encode",_,!!s.encoding||void 0!==s.labelAngle),l}function UI(t,e){const{config:n}=t;return{...QL(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...LL("x",t,{defaultPos:"mid"}),...LL("y",t,{defaultPos:"mid"}),...zL("size",t),...zL("angle",t),...qI(t,0,e)}}function qI(t,e,n){return n?{shape:{value:n}}:zL("shape",t)}function II(t,e,n){if(void 0===RT("align",t,n))return"center"}function WI(t,e,n){if(void 0===RT("baseline",t,n))return"middle"}function $I(t){var e;const{config:n,markDef:r}=t,{orient:i}=r,o="horizontal"===i?"width":"height",a=t.getScaleComponent("horizontal"===i?"x":"y"),s=null!==(e=RT("size",r,n,{vgChannel:o}))&&void 0!==e?e:n.tick.bandSize;if(void 0!==s)return s;{const t=a?a.get("range"):void 0;return t&&_T(t)&&At(t.step)?3*t.step/4:3*MP(n.view,o)/4}}const HI={arc:{vgMark:"arc",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...LL("x",t,{defaultPos:"mid"}),...LL("y",t,{defaultPos:"mid"}),...ZL(t,"radius"),...ZL(t,"theta")})},area:{vgMark:"area",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...WL("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient}),...WL("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient}),...tj(t)})},bar:{vgMark:"rect",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...ZL(t,"x"),...ZL(t,"y")})},circle:{vgMark:"symbol",encodeEntry:t=>UI(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[{type:"geoshape",projection:t.projectionName(),...n&&Bz(n)&&n.type===nO?{field:Qz(n,{expr:"datum"})}:{}}]}},image:{vgMark:"image",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...ZL(t,"x"),...ZL(t,"y"),...ML(t,"url")})},line:{vgMark:"line",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...LL("x",t,{defaultPos:"mid"}),...LL("y",t,{defaultPos:"mid"}),...zL("size",t,{vgChannel:"strokeWidth"}),...tj(t)})},point:{vgMark:"symbol",encodeEntry:t=>UI(t)},rect:{vgMark:"rect",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...ZL(t,"x"),...ZL(t,"y")})},rule:{vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?{...QL(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...WL("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n}),...WL("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n}),...zL("size",t,{vgChannel:"strokeWidth"})}:{}}},square:{vgMark:"symbol",encodeEntry:t=>UI(t,"square")},text:{vgMark:"text",encodeEntry:t=>{const{config:e,encoding:n}=t;return{...QL(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...LL("x",t,{defaultPos:"mid"}),...LL("y",t,{defaultPos:"mid"}),...ML(t),...zL("size",t,{vgChannel:"fontSize"}),...zL("angle",t),...ej("align",II(t.markDef,0,e)),...ej("baseline",WI(t.markDef,0,e)),...LL("radius",t,{defaultPos:null}),...LL("theta",t,{defaultPos:null})}}},tick:{vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return{...QL(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...LL("x",t,{defaultPos:"mid",vgChannel:"xc"}),...LL("y",t,{defaultPos:"mid",vgChannel:"yc"}),...zL("size",t,{defaultValue:$I(t),vgChannel:i}),[o]:DT(RT("thickness",n,e))}}},trail:{vgMark:"trail",encodeEntry:t=>({...QL(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...LL("x",t,{defaultPos:"mid"}),...LL("y",t,{defaultPos:"mid"}),...zL("size",t),...tj(t)})}},ZI="faceted_path_",YI="stack_group_";function VI(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""};const{mark:n,markDef:r,encoding:i,config:o}=t,a=QS(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!((null===e||void 0===e||!e.get("selectionExtent"))&&(null===n||void 0===n||!n.get("selectionExtent")))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),s=zT(r),l=i.key,u=function(t){const{encoding:e,stack:n,mark:r,markDef:i,config:o}=t,a=e.order;if(!(!L(a)&&Hz(a)&&CS(a.value)||!a&&CS(RT("order",i,o)))){if((L(a)||Bz(a))&&!n)return jT(a,{expr:"datum"});if(HO(r)){const n="horizontal"===i.orient?"y":"x",r=e[n];if(Bz(r)){var s;const e=r.sort;return L(e)?{field:Qz(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:kz(e)?{field:Qz({aggregate:FR(t.encoding)?e.op:void 0,field:e.field},{expr:"datum"})}:wz(e)?{field:Qz(t.fieldDef(e.encoding),{expr:"datum"}),order:e.order}:null===e?void 0:{field:Qz(r,{binSuffix:null!==(s=t.stack)&&void 0!==s&&s.impute?"mid":void 0,expr:"datum"})}}}}}(t),c=function(t){if(!t.component.selection)return null;const e=BS(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=BS(r.component.selection).length,r=r.parent;return n?{interactive:e>0||"geoshape"===t.mark||!!t.encoding.tooltip}:null}(t),f=RT("aria",r,o),d=HI[n].postEncodingTransform?HI[n].postEncodingTransform(t):null;return[{name:t.getName("marks"),type:HI[n].vgMark,...a?{clip:!0}:{},...s?{style:s}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...!1===f?{aria:f}:{},from:{data:e.fromPrefix+t.requestDataName(KB.Main)},encode:{update:HI[n].encodeEntry(t)},...d?{transform:d}:{}}]}class GI extends oI{constructor(t,e,n){var r;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;super(t,"unit",e,n,o,void 0,kP(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=VO(t.mark)?{...t.mark}:{type:t.mark},s=a.type;void 0===a.filled&&(a.filled=function(t,e,n){let{graticule:r}=n;if(r)return!1;const i=PT("filled",t,e),o=t.type;return QS(i,o!==PO&&o!==RO&&o!==LO)}(a,o,{graticule:t.data&&JB(t.data)}));const l=this.encoding=function(t,e,n,r){const i={};for(const s of BS(t))rF(s)||_N("".concat(o=s,"-encoding is dropped as ").concat(o," is not a valid encoding channel."));var o,a;for(let s of hF){if(!t[s])continue;const o=t[s];if(BF(s)){const t=dF(s),e=i[t];if(Bz(e)){if(("quantitative"===(a=e.type)||"temporal"===a)&&Bz(o)&&!e.timeUnit){_N(tN(t));continue}}else s=t,_N(eN(t))}if("angle"!==s||"arc"!==e||t.theta||(_N("Arc marks uses theta channel rather than angle, replacing angle with theta."),s=dD),NR(t,s,e)){if(s===wD&&"line"===e){const e=aR(t[s]);if(null!==e&&void 0!==e&&e.aggregate){_N("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(s===vD&&(n?"fill"in t:"stroke"in t))_N(rN("encoding",{fill:"fill"in t,stroke:"stroke"in t}));else if(s===TD||s===FD&&!L(o)&&!Hz(o)||s===OD&&L(o)){if(o){if(s===FD){const e=t[s];if(Oz(e)){i[s]=e;continue}}i[s]=it(o).reduce(((t,e)=>(Bz(e)?t.push(cR(e,s)):_N(iN(e,s)),t)),[])}}else{if(s===OD&&null===o)i[s]=null;else if(!(Bz(o)||jz(o)||Hz(o)||zz(o)||xT(o))){_N(iN(o,s));continue}i[s]=lR(o,s,r)}}else _N(oN(s,e))}return i}(t.encoding||{},s,a.filled,o);this.markDef=function(t,e,n){const r=yT(t),i=RT("orient",r,n);if(r.orient=function(t,e,n){switch(t){case PO:case IO:case WO:case jO:case BO:case zO:return}const{x:r,y:i,x2:o,y2:a}=e;switch(t){case OO:if(Bz(r)&&(dT(r.bin)||Bz(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Bz(i)&&(dT(i.bin)||Bz(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o)return(Bz(r)&&r.type===JN&&!fT(r.bin)||Iz(r))&&Bz(i)&&dT(i.bin)?"horizontal":"vertical";if(!a)return(Bz(i)&&i.type===JN&&!fT(i.bin)||Iz(i))&&Bz(r)&&dT(r.bin)?"vertical":"horizontal"}case LO:if(o&&(!Bz(r)||!dT(r.bin))&&a&&(!Bz(i)||!dT(i.bin)))return;case NO:if(a)return Bz(i)&&dT(i.bin)?"horizontal":"vertical";if(o)return Bz(r)&&dT(r.bin)?"vertical":"horizontal";if(t===LO){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case RO:case UO:{const e=qz(r),o=qz(i);if(n)return n;if(e&&!o)return"tick"!==t?"horizontal":"vertical";if(!e&&o)return"tick"!==t?"vertical":"horizontal";if(e&&o)return"vertical";{const t=$z(r)&&r.type===tO,e=$z(i)&&i.type===tO;if(t&&!e)return"vertical";if(!t&&e)return"horizontal"}return}}return"vertical"}(r.type,e,i),void 0!==i&&i!==r.orient&&_N('Specified orient "'.concat(r.orient,'" overridden with "').concat(i,'".')),"bar"===r.type&&r.orient){const t=RT("cornerRadiusEnd",r,n);if(void 0!==t){const n="horizontal"===r.orient&&e.x2||"vertical"===r.orient&&e.y2?["cornerRadius"]:KO[r.orient];for(const e of n)r[e]=t;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}return void 0===RT("opacity",r,n)&&(r.opacity=function(t,e){if(SS([PO,UO,IO,WO],t)&&!FR(e))return.7}(r.type,e)),void 0===RT("cursor",r,n)&&(r.cursor=function(t,e,n){return e.href||t.href||RT("href",t,n)?"pointer":t.cursor}(r,e,n)),r}(a,l,o),this.size=function(t){let{encoding:e,size:n}=t;for(const r of TF){const t=uF(r);wP(n[t])&&Uz(e[r])&&(delete n[t],_N(pN(t)))}return n}({encoding:l,size:kP(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=YP(this.markDef,l),this.specifiedScales=this.initScales(s,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=(null!==(r=t.params)&&void 0!==r?r:[]).filter((t=>gP(t)))}get hasProjection(){const{encoding:t}=this,e=this.mark===$O,n=t&&ID.some((e=>Wz(t[e])));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return GF.reduce(((t,n)=>{var r;const i=sR(e[n]);return i&&(t[n]=this.initScale(null!==(r=i.scale)&&void 0!==r?r:{})),t}),{})}initScale(t){const{domain:e,range:n}=t,r=yT(t);return L(e)&&(r.domain=e.map(CT)),L(n)&&(r.range=n.map(CT)),r}initAxes(t){return TF.reduce(((e,n)=>{const r=t[n];if(Wz(r)||n===iD&&Wz(t.x2)||n===oD&&Wz(t.y2)){const t=Wz(r)?r.axis:void 0;e[n]=t?this.initAxis({...t}):t}return e}),{})}initAxis(t){const e=BS(t),n={};for(const r of e){const e=t[r];n[r]=vR(e)?MT(e):CT(e)}return n}initLegends(t){return YF.reduce(((e,n)=>{const r=sR(t[n]);if(r&&function(t){switch(t){case vD:case bD:case xD:case wD:case _D:case AD:case CD:case SD:return!0;case ED:case MD:case kD:return!1}}(n)){const t=r.legend;e[n]=t?yT(t):t}return e}),{})}parseData(){this.component.data=DI(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of TF){const i=uF(r);if(e[i]){const t=e[i];n.layoutSize.set(i,wP(t)?"step":t,!0)}else{const e=EI(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){const n={},r=t.config.selection;if(!e||!e.length)return n;for(const o of e){const e=qS(o.name),a=o.select,s=Et(a)?a:a.type,l=U(a)?wS(a):{type:s},u=r[s];for(const t in u){var i;"fields"!==t&&"encodings"!==t&&("mark"===t&&(l[t]={...u[t],...l[t]}),void 0!==l[t]&&!0!==l[t]||(l[t]=wS(null!==(i=u[t])&&void 0!==i?i:l[t])))}const c=n[e]={...l,name:e,type:s,init:o.value,bind:o.bind,events:Et(l.on)?Wk(l.on,"scope"):it(wS(l.on))},f=wS(o);for(const n of kj)n.defined(c)&&n.parse&&n.parse(t,c,f)}return n}(this,this.selection)}parseMarkGroup(){this.component.mark=function(t){if(SS([RO,NO,qO],t.mark)){const e=RR(t.mark,t.encoding);if(e.length>0)return function(t,e){return[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:ZI+t.requestDataName(KB.Main),data:t.requestDataName(KB.Main),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:VI(t,{fromPrefix:ZI})}]}(t,e)}else if(t.mark===OO){const e=ET.some((e=>RT(e,t.markDef,t.config)));if(t.stack&&!t.fieldDef("size")&&e)return function(t,e){const[n]=VI(t,{fromPrefix:YI}),r=t.scaleName(t.stack.fieldChannel),i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.vgField(t.stack.fieldChannel,e)},o=(t,e)=>"".concat(t,"(").concat([i({prefix:"min",suffix:"start",expr:e}),i({prefix:"max",suffix:"start",expr:e}),i({prefix:"min",suffix:"end",expr:e}),i({prefix:"max",suffix:"end",expr:e})].map((t=>"scale('".concat(r,"',").concat(t,")"))).join(","),")");let a,s;"x"===t.stack.fieldChannel?(a={...kS(n.encode.update,["y","yc","y2","height",...ET]),x:{signal:o("min","datum")},x2:{signal:o("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update={...AS(n.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(a={...kS(n.encode.update,["x","xc","x2","width"]),y:{signal:o("min","datum")},y2:{signal:o("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update={...AS(n.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const u of ET){const e=PT(u,t.markDef,t.config);n.encode.update[u]?(a[u]=n.encode.update[u],delete n.encode.update[u]):e&&(a[u]=DT(e)),e&&(n.encode.update[u]={value:0})}const l=[];if((null===(e=t.stack.groupbyChannels)||void 0===e?void 0:e.length)>0)for(const u of t.stack.groupbyChannels){const e=t.fieldDef(u),n=Qz(e);n&&l.push(n),((null===e||void 0===e?void 0:e.bin)||(null===e||void 0===e?void 0:e.timeUnit))&&l.push(Qz(e,{binSuffix:"end"}))}return a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((e,r)=>{if(n.encode.update[r])return{...e,[r]:n.encode.update[r]};{const n=PT(r,t.markDef,t.config);return void 0!==n?{...e,[r]:DT(n)}:e}}),a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:t.requestDataName(KB.Main),name:YI+t.requestDataName(KB.Main),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}(t)}return VI(t)}(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,TF.reduce(((e,n)=>(t.component.scales[n]&&(e[n]=[jI(n,t)]),e)),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){let n=!1;for(const i of LS(null!==(r=t.component.selection)&&void 0!==r?r:{})){var r;const o=i.name,a=Dt(o+bj);if(0===e.filter((t=>t.name===o)).length){const t="global"===i.resolve?"union":i.resolve,n="point"===i.type?", true, true)":")";e.push({name:i.name,update:"".concat(wj,"(").concat(a,", ").concat(Dt(t)).concat(n)})}n=!0;for(const n of kj)n.defined(i)&&n.topLevelSignals&&(e=n.topLevelSignals(t,i,e))}return n&&0===e.filter((t=>"unit"===t.name)).length&&e.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),oL(e)}(this,t)}assembleSignals(){return[...Pj(this),...nL(this,[])]}assembleSelectionData(t){return function(t,e){const n=[...e],r=Aj(t,{escape:!1});for(const o of LS(null!==(i=t.component.selection)&&void 0!==i?i:{})){var i;const t={name:o.name+bj};if(o.project.hasSelectionId&&(t.transform=[{type:"collect",sort:{field:dP}}]),o.init){const e=o.project.items.map(tL);t.values=o.project.hasSelectionId?o.init.map((t=>({unit:r,[dP]:eL(t,!1)[0]}))):o.init.map((t=>({unit:r,fields:e,values:eL(t,!1)})))}n.filter((t=>t.name===o.name+bj)).length||n.push(t)}return n}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return lU(this)}assembleMarks(){var t;let e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&rI(this.parent)||(e=iL(this,e)),e.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return CR(this.encoding,t)}fieldDef(t){return aR(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return $z(e)?e:null}}class XI extends iI{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const o={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map(((t,e)=>{if(UP(t))return new XI(t,this,this.getName("layer_".concat(e)),o,i);if(ER(t))return new GI(t,this,this.getName("layer_".concat(e)),o,i);throw new Error(WT(t))}))}parseData(){this.component.data=DI(this);for(const t of this.children)t.parseData()}parseLayoutSize(){kI(this),AI(this,"width"),AI(this,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of BS(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){const{axes:e,resolve:n}=t.component,r={top:0,bottom:0,right:0,left:0};for(const o of t.children){o.parseAxesAndHeaders();for(const r of BS(o.component.axes))n.axis[r]=mU(t.component.resolve,r),"shared"===n.axis[r]&&(e[r]=RI(e[r],o.component.axes[r]),e[r]||(n.axis[r]="independent",delete e[r]))}for(const o of TF){for(const a of t.children)if(a.component.axes[o]){if("independent"===n.axis[o]){var i;e[o]=(null!==(i=e[o])&&void 0!==i?i:[]).concat(a.component.axes[o]);for(const t of a.component.axes[o]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!xT(e)){if(r[e]>0&&!n){const n=zI[e];r[e]>r[n]&&t.set("orient",n,!1)}r[e]++}}}delete a.component.axes[o]}if("independent"===n.axis[o]&&e[o]&&e[o].length>1)for(const t of e[o])t.get("grid")&&!t.explicit.grid&&(t.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleSignals())),Pj(this))}assembleLayoutSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleLayoutSignals())),lU(this))}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleGroupStyle(){const t=new Set;for(const n of this.children)for(const e of it(n.assembleGroupStyle()))t.add(e);const e=Array.from(t);return e.length>1?e:1===e.length?e[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)tI(n)&&(e=iL(n,e));return e}(this,this.children.flatMap((t=>t.assembleMarks())))}assembleLegends(){return this.children.reduce(((t,e)=>t.concat(e.assembleLegends())),TU(this))}}function QI(t,e,n,r,i){if(Cz(t))return new CI(t,e,n,i);if(UP(t))return new XI(t,e,n,r,i);if(ER(t))return new GI(t,e,n,r,i);if(function(t){return bP(t)||xP(t)||vP(t)}(t))return new FI(t,e,n,i);throw new Error(WT(t))}var JI=n(7646),KI=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){t.done?i(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,s)}l((r=r.apply(t,e||[])).next())}))};const tW=t=>KI(void 0,void 0,void 0,(function*(){const e=KC(yield JC(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;e.logger&&(n=e.logger,xN=n),e.fieldTitle&&eR(e.fieldTitle);try{const n=RP(I(e.config,t.config)),r=function(t,e){void 0===e&&(e=RP(t.config));const n=function(t){const e={config:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};return RB.map(OB.map(zB.map(t,e),e),e)}(t,e),{width:r,height:i}=t,o=function(t,e,n){let{width:r,height:i}=e;const o=ER(t)||UP(t),a={};o?"container"==r&&"container"==i?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==i&&(a.type="fit-y",a.contains="padding"):("container"==r&&(_N($T("width")),r=void 0),"container"==i&&(_N($T("height")),i=void 0));const s={type:"pad",...a,...n?PB(n.autosize):{},...PB(t.autosize)};if("fit"!==s.type||o||(_N('Autosize "fit" only works for single views and layered views.'),s.type="pad"),"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&_N(HT("width")),"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&_N(HT("height")),!_S(s,{type:"pad"}))return s}(n,{width:r,height:i,autosize:t.autosize},e);return{...n,...o?{autosize:o}:{}}}(t,n),i=QI(r,null,"",void 0,n);i.parse(),function(t,e){bq(t.sources);let n=0,r=0;for(let i=0;i<5&&_q(t,e,!0);i++)n++;t.sources.map(gq);for(let i=0;i<5&&_q(t,e,!1);i++)r++;bq(t.sources),5===Math.max(n,r)&&_N("Maximum optimization runs(5) reached.")}(i.component.data,i);const o=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const i=t.config?function(t){t=wS(t);for(const e of BP)delete t[e];if(t.axis)for(const e in t.axis)vR(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of iP)delete t.legend[e];if(t.mark){for(const e of XO)delete t.mark[e];t.mark.tooltip&&U(t.mark.tooltip)&&delete t.mark.tooltip}t.params&&(t.signals=(t.signals||[]).concat(yP(t.params)),delete t.params);for(const e of PP){for(const r of XO)delete t[e][r];const n=LP[e];if(n)for(const r of n)delete t[e][r];jP(t,e)}for(const e of BS(nP))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=vT(t.title);PS(e)||(t.style["group-title"]={...t.style["group-title"],...e}),PS(n)||(t.style["group-subtitle"]={...t.style["group-subtitle"],...n}),PS(r)?delete t.title:t.title=r}(t);for(const e in t)U(t[e])&&PS(t[e])&&delete t[e];return PS(t)?void 0:t}(t.config):void 0,o=[].concat(t.assembleSelectionData([]),function(t,e){const n=[],r=bI(n);let i=0;for(const l of t.sources){l.hasName()||(l.dataName="source_"+i++);const t=l.assemble();r(l,t)}for(const l of n)0===l.transform.length&&delete l.transform;let o=0;for(const[l,u]of n.entries()){var a;0!==(null!==(a=u.transform)&&void 0!==a?a:[]).length||u.source||n.splice(o++,0,n.splice(l,1)[0])}for(const l of n)for(const e of null!==(s=l.transform)&&void 0!==s?s:[]){var s;"lookup"===e.type&&(e.from=t.outputNodes[e.from].getSource())}for(const l of n)l.name in e&&(l.values=e[l.name]);return n}(t.component.data,n)),a=t.assembleProjections(),s=t.assembleTitle(),l=t.assembleGroupStyle(),u=t.assembleGroupEncodeEntry(!0);let c=t.assembleLayoutSignals();c=c.filter((t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1)));const{params:f,...d}=e;return{$schema:"https://vega.github.io/schema/vega/v5.json",...t.description?{description:t.description}:{},...d,...s?{title:s}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:o,...a.length>0?{projections:a}:{},...t.assembleGroup([...c,...t.assembleSelectionTopLevelSignals([]),...yP(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):Et(e)&&(e={type:e}),i&&o&&("fit"===(a=e.type)||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)_N(ZT()),e.type="pad";else if("step"===i||"step"===o){const t="step"===i?"width":"height";_N(ZT(RF(t)));const n="width"===t?"height":"width";e.type=function(t){return t?"fit-".concat(RF(t)):"fit"}(n)}var a;return{...1===BS(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e},...LB(n,!1),...LB(t,!0)}}(t,r.autosize,n,i),t.datasets,t.usermeta);return{spec:o,normalized:r}}finally{e.logger&&(xN=bN),e.fieldTitle&&eR(Kz)}}(t).spec)),n=rS(e);if("mark"in t)return iW(e,t,n[0]);if("layer"in t||"concat"in t||"hconcat"in t||"vconcat"in t){const r=Object.keys(t).find((t=>["layer","concat","hconcat","vconcat"].includes(t)));return yield function(t,e,n,r){return KI(this,void 0,void 0,(function*(){const i=r.map((t=>({description:e.description,data:t,fields:[],axes:[],legends:[]})));return e[n].map((n=>{if("mark"in n){const o={data:n.data||e.data,mark:n.mark,encoding:n.encoding},a=r.find((t=>{const e=Object.keys(t[0]);return Object.values(o.encoding).map((e=>eW(e,t))).filter((t=>t)).every((t=>e.includes(t)))})),s=iW(t,o,a),l=i.find((t=>Object.keys(t.data[0]).every((t=>t in a[0]))));l&&(l.fields.push(...s.fields),l.axes.push(...s.axes),l.legends.push(...s.legends),l.mark=s.mark)}})),i.forEach((t=>{t.fields=t.fields.filter(((t,e,n)=>n.findIndex((e=>e.field===t.field))===e)),t.axes=t.axes.filter(((t,e,n)=>n.findIndex((e=>e.field===t.field))===e)),t.legends=t.legends.filter(((t,e,n)=>n.findIndex((e=>e.field===t.field))===e)),rW(t)})),1===i.length?i[0]:{operator:"layer"===n?"layer":"concat",units:i}}))}(e,t,r,n)}})),eW=(t,e)=>"aggregate"in t?"count"===t.aggregate?"__".concat(t.aggregate):"".concat(t.aggregate,"_").concat(t.field):"timeUnit"in t?"".concat(t.timeUnit,"_").concat(t.field):"bin"in t&&!0===t.bin&&e.length?Object.keys(e[0]).find((e=>e.startsWith("bin")&&e.includes(t.field)&&!e.endsWith("_end"))):"condition"in t?t.condition.field:t.field,nW=t=>"aggregate"in t&&"count"===t.aggregate?"count":"".concat(t.bin?"binned ":"").concat("aggregate"in t?"".concat(t.aggregate," "):"").concat("condition"in t?t.condition.field:t.field).concat("timeUnit"in t&&t.timeUnit!==t.field.toLowerCase()?" (".concat(t.timeUnit,")"):""),rW=t=>{t.fields.forEach((e=>{"temporal"===e.type&&t.data.forEach((t=>{t[e.field]=new Date(t[e.field])}))}))};function iW(t,e,n){const r={description:e.description,data:n,fields:[],axes:[],legends:[],guides:[]};return r.mark=(t=>{const e=t.mark;return e&&e.type?e.type:e})(e),e.encoding&&Object.entries(e.encoding).forEach((e=>{let[i,o]=e;const a=Object.assign({},o);if(a.field=eW(o,n),a.label=nW(o),a.type=o.type||!!o.timeUnit&&"temporal"||!!o.bin&&"quantitative"||(0,JI.typeInference)(n,a.field),a.field){if(["row","column","facet"].includes(i))r.facet=a.field;else if("line"===r.mark&&["color","detail"].includes(i))r.facet=a.field;else if(["x","y"].includes(i)){const e=iS(t);r.axes.push({axisType:i,field:a.field,title:o.title,ticks:e&&e.length?1===e.length||2===e.length&&"x"===i?e[0]:e[1]:void 0})}else["color","opacity","size"].includes(i)?r.legends.push({channel:i,field:a.field,title:o.title}):"order"===i&&r.guides.push({field:a.field,title:o.title,channel:i});r.fields.find((t=>t.field===a.field))||r.fields.push(a)}})),rW(r),r}})(),j})(),t.exports=j()},191:function(t,e,n){var r,i,o,a,s,l,u,c,f,d,h,p,m,g,y,v,b,x,_,w=n(400).default;_=()=>(()=>{var t={138:t=>{var e=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,r;try{e=Map}catch(t){e=function(){}}try{n=Set}catch(t){n=function(){}}try{r=Promise}catch(t){r=function(){}}function i(o,s,l,u,c){"object"==typeof s&&(l=s.depth,u=s.prototype,c=s.includeNonEnumerable,s=s.circular);var f=[],d=[],h="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===l&&(l=1/0),function o(l,p){if(null===l)return null;if(0===p)return l;var m,g;if("object"!=typeof l)return l;if(t(l,e))m=new e;else if(t(l,n))m=new n;else if(t(l,r))m=new r((function(t,e){l.then((function(e){t(o(e,p-1))}),(function(t){e(o(t,p-1))}))}));else if(i.__isArray(l))m=[];else if(i.__isRegExp(l))m=new RegExp(l.source,a(l)),l.lastIndex&&(m.lastIndex=l.lastIndex);else if(i.__isDate(l))m=new Date(l.getTime());else{if(h&&Buffer.isBuffer(l))return m=Buffer.allocUnsafe?Buffer.allocUnsafe(l.length):new Buffer(l.length),l.copy(m),m;t(l,Error)?m=Object.create(l):void 0===u?(g=Object.getPrototypeOf(l),m=Object.create(g)):(m=Object.create(u),g=u)}if(s){var y=f.indexOf(l);if(-1!=y)return d[y];f.push(l),d.push(m)}for(var v in t(l,e)&&l.forEach((function(t,e){var n=o(e,p-1),r=o(t,p-1);m.set(n,r)})),t(l,n)&&l.forEach((function(t){var e=o(t,p-1);m.add(e)})),l){var b;g&&(b=Object.getOwnPropertyDescriptor(g,v)),b&&null==b.set||(m[v]=o(l[v],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(l);for(v=0;v<x.length;v++){var _=x[v];(!(k=Object.getOwnPropertyDescriptor(l,_))||k.enumerable||c)&&(m[_]=o(l[_],p-1),k.enumerable||Object.defineProperty(m,_,{enumerable:!1}))}}if(c){var w=Object.getOwnPropertyNames(l);for(v=0;v<w.length;v++){var k,A=w[v];(k=Object.getOwnPropertyDescriptor(l,A))&&k.enumerable||(m[A]=o(l[A],p-1),Object.defineProperty(m,A,{enumerable:!1}))}}return m}(o,l)}function o(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=o,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===o(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===o(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===o(t)},i.__getRegExpFlags=a,i}();t.exports&&(t.exports=e)},914:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(601),i=n.n(r),o=n(609),a=n.n(o)()(i());a.push([t.id,".olli-dialog {\n  border: 1px solid black;\n  padding: 10px 15px;\n  position: fixed;\n  left: 25%;\n  right: 25%;\n  top: 15%;\n  background: #fff;\n  -webkit-box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.75);\n  -moz-box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.75);\n  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.75);\n}\n\n.olli-dialog button {\n  margin-bottom: 5px;\n}\n\n.olli-dialog h2 {\n  margin: 0;\n}\n\n.olli-dialog p {\n  margin-top: 0;\n}\n\n.olli-dialog #olli-dialog-content * {\n  max-width: 100%;\n}\n\n.olli-dialog #olli-dialog-content:has(table) {\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.olli-hidden {\n  display: none;\n}",""]);const s=a},370:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(601),i=n.n(r),o=n(609),a=n.n(o)()(i());a.push([t.id,".olli-vis ul[role='tree'] {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n}\n\n.olli-vis ul[role='tree'] li {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n}\n\n.olli-vis [role='treeitem']:not(.expanded) + [role='group'] {\n  display: none;\n}\n\n.olli-vis [role='treeitem'].expanded + [role='group'] {\n  display: block;\n}\n\n.olli-vis [role='treeitem']:not(.expanded) > ul {\n  display: none;\n}\n\n.olli-vis [role='treeitem'].expanded > ul {\n  display: block;\n}\n\n/* .olli-vis [role=\"treeitem\"],\n.olli-vis [role=\"treeitem\"] span {\n  width: 9em;\n  margin: 0;\n  padding: 0.125em;\n  display: block;\n} */\n\n/* disable default keyboard focus styling for treeitems\n   Keyboard focus is styled with the following CSS */\n.olli-vis :focus {\n  outline: 0;\n}\n\n.olli-vis .focus,\n.olli-vis span.focus {\n  border-color: black;\n  background-color: #eee;\n}\n\n.olli-vis .hover,\n.olli-vis span:hover {\n  background-color: #ddd;\n}\n",""]);const s=a},609:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);r&&a[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},879:function(t){t.exports=function(){"use strict";var t=6e4,e=36e5,n="millisecond",r="second",i="minute",o="hour",a="day",s="week",l="month",u="quarter",c="year",f="date",d="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},g=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},y={s:g,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+g(r,2,"0")+":"+g(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,l),o=n-i<0,a=e.clone().add(r+(o?-1:1),l);return+(-(r+(n-i)/(o?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:l,y:c,w:s,d:a,D:f,h:o,m:i,s:r,ms:n,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},v="en",b={};b[v]=m;var x=function(t){return t instanceof A},_=function t(e,n,r){var i;if(!e)return v;if("string"==typeof e){var o=e.toLowerCase();b[o]&&(i=o),n&&(b[o]=n,i=o);var a=e.split("-");if(!i&&a.length>1)return t(a[0])}else{var s=e.name;b[s]=e,i=s}return!r&&i&&(v=i),i||!r&&v},w=function(t,e){if(x(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new A(n)},k=y;k.l=_,k.i=x,k.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var A=function(){function m(t){this.$L=_(t.locale,null,!0),this.parse(t)}var g=m.prototype;return g.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(k.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(h);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},g.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},g.$utils=function(){return k},g.isValid=function(){return!(this.$d.toString()===d)},g.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},g.isAfter=function(t,e){return w(t)<this.startOf(e)},g.isBefore=function(t,e){return this.endOf(e)<w(t)},g.$g=function(t,e,n){return k.u(t)?this[e]:this.set(n,t)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(t,e){var n=this,u=!!k.u(e)||e,d=k.p(t),h=function(t,e){var r=k.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return u?r:r.endOf(a)},p=function(t,e){return k.w(n.toDate()[t].apply(n.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},m=this.$W,g=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case c:return u?h(1,0):h(31,11);case l:return u?h(1,g):h(0,g+1);case s:var b=this.$locale().weekStart||0,x=(m<b?m+7:m)-b;return h(u?y-x:y+(6-x),g);case a:case f:return p(v+"Hours",0);case o:return p(v+"Minutes",1);case i:return p(v+"Seconds",2);case r:return p(v+"Milliseconds",3);default:return this.clone()}},g.endOf=function(t){return this.startOf(t,!1)},g.$set=function(t,e){var s,u=k.p(t),d="set"+(this.$u?"UTC":""),h=(s={},s[a]=d+"Date",s[f]=d+"Date",s[l]=d+"Month",s[c]=d+"FullYear",s[o]=d+"Hours",s[i]=d+"Minutes",s[r]=d+"Seconds",s[n]=d+"Milliseconds",s)[u],p=u===a?this.$D+(e-this.$W):e;if(u===l||u===c){var m=this.clone().set(f,1);m.$d[h](p),m.init(),this.$d=m.set(f,Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},g.set=function(t,e){return this.clone().$set(t,e)},g.get=function(t){return this[k.p(t)]()},g.add=function(n,u){var f,d=this;n=Number(n);var h=k.p(u),p=function(t){var e=w(d);return k.w(e.date(e.date()+Math.round(t*n)),d)};if(h===l)return this.set(l,this.$M+n);if(h===c)return this.set(c,this.$y+n);if(h===a)return p(1);if(h===s)return p(7);var m=(f={},f[i]=t,f[o]=e,f[r]=1e3,f)[h]||1,g=this.$d.getTime()+n*m;return k.w(g,this)},g.subtract=function(t,e){return this.add(-1*t,e)},g.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=k.z(this),o=this.$H,a=this.$m,s=this.$M,l=n.weekdays,u=n.months,c=function(t,n,i,o){return t&&(t[n]||t(e,r))||i[n].slice(0,o)},f=function(t){return k.s(o%12||12,t,"0")},h=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:k.s(s+1,2,"0"),MMM:c(n.monthsShort,s,u,3),MMMM:c(u,s),D:this.$D,DD:k.s(this.$D,2,"0"),d:String(this.$W),dd:c(n.weekdaysMin,this.$W,l,2),ddd:c(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:k.s(o,2,"0"),h:f(1),hh:f(2),a:h(o,a,!0),A:h(o,a,!1),m:String(a),mm:k.s(a,2,"0"),s:String(this.$s),ss:k.s(this.$s,2,"0"),SSS:k.s(this.$ms,3,"0"),Z:i};return r.replace(p,(function(t,e){return e||m[t]||i.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,f,d){var h,p=k.p(f),m=w(n),g=(m.utcOffset()-this.utcOffset())*t,y=this-m,v=k.m(this,m);return v=(h={},h[c]=v/12,h[l]=v,h[u]=v/3,h[s]=(y-g)/6048e5,h[a]=(y-g)/864e5,h[o]=y/e,h[i]=y/t,h[r]=y/1e3,h)[p]||y,d?v:k.a(v)},g.daysInMonth=function(){return this.endOf(l).$D},g.$locale=function(){return b[this.$L]},g.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=_(t,e,!0);return r&&(n.$L=r),n},g.clone=function(){return k.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},m}(),E=A.prototype;return w.prototype=E,[["$ms",n],["$s",r],["$m",i],["$H",o],["$W",a],["$M",l],["$y",c],["$D",f]].forEach((function(t){E[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,A,w),t.$i=!0),w},w.locale=_,w.isDayjs=x,w.unix=function(t){return w(1e3*t)},w.en=b[v],w.Ls=b,w.p={},w}()},378:t=>{"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!=i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!t(e[a],n[a]))return!1}return!0}return e!=e&&n!=n}},695:t=>{"use strict";t.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var n,r="boolean"==typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},o={key:r,value:t[r]};return n(i,o)}}),o=[];return function t(e){if(e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!=typeof e)return JSON.stringify(e);var n,a;if(Array.isArray(e)){for(a="[",n=0;n<e.length;n++)n&&(a+=","),a+=t(e[n])||"null";return a+"]"}if(null===e)return"null";if(-1!==o.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(e)-1,l=Object.keys(e).sort(i&&i(e));for(a="",n=0;n<l.length;n++){var u=l[n],c=t(e[u]);c&&(a&&(a+=","),a+=JSON.stringify(u)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(t)}},62:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},a=[],s=0;s<t.length;s++){var l=t[s],u=r.base?l[0]+r.base:l[0],c=o[u]||0,f="".concat(u," ").concat(c);o[u]=c+1;var d=n(f),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(h);else{var p=i(h,r);r.byIndex=s,e.splice(s,0,{identifier:f,updater:p,references:1})}a.push(f)}return a}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var l=r(t,i),u=0;u<o.length;u++){var c=n(o[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=l}}},793:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},173:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},892:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},36:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},464:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},925:(t,e,n)=>{t.exports=n(448)},448:(t,e,n)=>{function r(t){let e=null;try{e=n.g.localStorage.getItem(t)}catch(t){throw new Error("localStorage not accessible")}return e}function i(t,e){try{n.g.localStorage.setItem(t,e)}catch(t){throw new Error("localStorage not accessible")}}function o(t){try{n.g.localStorage.removeItem(t)}catch(t){throw new Error("localStorage not accessible")}}t.exports=class{constructor(t,e){if(e){const n=parseInt(e,10);if(!n||n<=0)throw new Error("version has to be a positive integer");this.name=t,this.version=n;const a=parseInt(r(t),10)||0;n>a&&(o("".concat(t,":").concat(a)),i(t,e.toString(10)))}else{const e=parseInt(r(t),10)||0;if(!e)throw new Error("There is no existing storage named ".concat(t));this.name=t,this.version=e}}read(){const t="".concat(this.name,":").concat(this.version),e=r(t);let n=null;if(e)try{n=JSON.parse(e)}catch(e){o(t)}return n}write(t){const e="".concat(this.name,":").concat(this.version),n=JSON.stringify(t);void 0===n?o(e):i(e,n)}static reset(){!function(){try{n.g.localStorage.clear()}catch(t){throw new Error("localStorage not accessible")}}()}}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nc=void 0;var _={};return(()=>{"use strict";n.r(_),n.d(_,{isMultiOlliSpec:()=>r$,olli:()=>g$,typeInference:()=>p$});var t={};n.r(t),n.d(t,{aggregate:()=>xs,bin:()=>_s,collect:()=>ks,compare:()=>As,countpattern:()=>Ms,cross:()=>Cs,density:()=>Ts,dotbin:()=>Ps,expression:()=>Bs,extent:()=>js,facet:()=>qs,field:()=>Is,filter:()=>$s,flatten:()=>Hs,fold:()=>Zs,formula:()=>Ys,generate:()=>Vs,impute:()=>Qs,joinaggregate:()=>Js,kde:()=>Ks,key:()=>tl,load:()=>nl,lookup:()=>il,multiextent:()=>ol,multivalues:()=>sl,params:()=>ul,pivot:()=>cl,prefacet:()=>fl,project:()=>dl,proxy:()=>hl,quantile:()=>pl,relay:()=>ml,sample:()=>gl,sequence:()=>yl,sieve:()=>vl,subflow:()=>Us,timeunit:()=>bl,tupleindex:()=>_l,values:()=>wl,window:()=>Cl});var e={};n.r(e),n.d(e,{interpolate:()=>Jc,interpolateArray:()=>$c,interpolateBasis:()=>Nc,interpolateBasisClosed:()=>Oc,interpolateCubehelix:()=>Vd,interpolateCubehelixLong:()=>Gd,interpolateDate:()=>Zc,interpolateDiscrete:()=>td,interpolateHcl:()=>Rd,interpolateHclLong:()=>Pd,interpolateHsl:()=>dd,interpolateHslLong:()=>hd,interpolateHue:()=>ed,interpolateLab:()=>Od,interpolateNumber:()=>Yc,interpolateNumberArray:()=>Ic,interpolateObject:()=>Vc,interpolateRgb:()=>Lc,interpolateRgbBasis:()=>Uc,interpolateRgbBasisClosed:()=>qc,interpolateRound:()=>Kc,interpolateString:()=>Qc,interpolateTransformCss:()=>sd,interpolateTransformSvg:()=>ld,interpolateZoom:()=>cd,piecewise:()=>Wf,quantize:()=>Xd});var k={};n.r(k),n.d(k,{bound:()=>sb,identifier:()=>cb,mark:()=>fb,overlap:()=>db,render:()=>bb,viewlayout:()=>Ub});var A={};n.r(A),n.d(A,{axisticks:()=>Ib,datajoin:()=>Wb,encode:()=>Hb,legendentries:()=>Zb,linkpath:()=>Qb,pie:()=>nx,scale:()=>ox,sortitems:()=>ux,stack:()=>px});var E={};n.r(E),n.d(E,{contour:()=>Xk,geojson:()=>Kk,geopath:()=>tA,geopoint:()=>eA,geoshape:()=>nA,graticule:()=>rA,heatmap:()=>iA,isocontour:()=>Uk,kde2d:()=>Yk,projection:()=>aA});var M={};n.r(M),n.d(M,{force:()=>eE});var C={};n.r(C),n.d(C,{nest:()=>iM,pack:()=>cM,partition:()=>dM,stratify:()=>hM,tree:()=>gM,treelinks:()=>yM,treemap:()=>xM});var S={};n.r(S),n.d(S,{label:()=>jM});var D={};n.r(D),n.d(D,{loess:()=>qM,regression:()=>WM});var F={};n.r(F),n.d(F,{voronoi:()=>bC});var T={};n.r(T),n.d(T,{wordcloud:()=>zC});var N={};n.r(N),n.d(N,{crossfilter:()=>qC,resolvefilter:()=>IC});const O=()=>(window._olli||(window._olli={}),window._olli),z=t=>{window._olli=Object.assign(Object.assign({},window._olli),t)},R=t=>{z({instancesOnPage:(O().instancesOnPage||[]).concat([t])}),O().keyListenerAttached||(document.addEventListener("keydown",(t=>{if(!(t=>{switch(null==t?void 0:t.nodeName){case"INPUT":return!["range","button","checkbox","number"].includes(t.getAttribute("type")||"");case"TEXTAREA":return!0}return"string"==typeof(null==t?void 0:t.getAttribute("contenteditable"))})(document.activeElement)){const{lastVisitedInstance:e,instancesOnPage:n}=O();if("KeyO"===t.code){const r=!(!e||!document.body.contains(e.rootDomNode))&&e||(n.length?n[0]:null);if(r)if(document.activeElement===r.rootDomNode){const e=n.indexOf(r);if(t.shiftKey){if(e>0){const t=n[e-1];t.setFocusToItem(t.rootTreeItem)}}else if(e<n.length-1){const t=n[e+1];t.setFocusToItem(t.rootTreeItem)}}else r.lastFocusedTreeItem&&document.activeElement!==r.lastFocusedTreeItem.domNode?r.setFocusToItem(r.lastFocusedTreeItem):r.setFocusToItem(r.rootTreeItem)}}})),z({keyListenerAttached:!0}))};function P(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function B(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function L(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function j(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function U(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?j:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;if(t===P)return j;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}(i);r>n;){if(r-n>600){const o=r-n+1,a=e-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);U(t,e,Math.max(n,Math.floor(e-a*l/o+u)),Math.min(r,Math.floor(e+(o-a)*l/o+u)),i)}const o=t[e];let a=n,s=r;for(q(t,n,e),i(t[r],o)>0&&q(t,n,r);a<s;){for(q(t,a,s),++a,--s;i(t[a],o)<0;)++a;for(;i(t[s],o)>0;)--s}0===i(t[n],o)?q(t,n,s):(++s,q(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function q(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function I(t){return null===t?NaN:+t}function W(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return L(t);if(e>=1)return B(t);var r,i=(r-1)*e,o=Math.floor(i),a=B(U(t,o).subarray(0,o+1));return a+(L(t.subarray(o+1))-a)*(i-o)}}function $(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}}function H(t,e){return W(t,.5,e)}function*Z(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function Y(t,e,n){const r=Float64Array.from(Z(t,n));return r.sort(P),e.map((t=>$(r,t)))}function V(t,e){return Y(t,[.25,.5,.75],e)}function G(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let a of t)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of t)null!=(s=e(s,++a,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=V(t,e),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function X(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let o,a,s,l,u,c,f=t.extent[0],d=t.extent[1];const h=t.span||d-f||Math.abs(f)||1;if(t.step)o=t.step;else if(t.steps){for(l=h/e,u=0,c=t.steps.length;u<c&&t.steps[u]<l;++u);o=t.steps[Math.max(0,u-1)]}else{for(a=Math.ceil(Math.log(e)/r),s=t.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>e;)o*=n;for(u=0,c=i.length;u<c;++u)l=o/i[u],l>=s&&h/l<=e&&(o=l)}l=Math.log(o);const p=l>=0?0:1+~~(-l/r),m=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(l=Math.floor(f/o+m)*o,f=f<l?l-o:l,d=Math.ceil(d/o)*o),{start:f,stop:d===f?f+o:d,step:o}}var Q=Math.random;function J(t,e,n,r){r=r||(t=>t);const i=t.length,o=new Float64Array(i);let a,s=0,l=1,u=r(t[0]),c=u,f=u+e;for(;l<i;++l){if(a=r(t[l]),a>=f){for(c=(u+c)/2;s<l;++s)o[s]=c;f=a+e,u=a}c=a}for(c=(u+c)/2;s<l;++s)o[s]=c;return n?function(t,e){const n=t.length;let r,i,o=0,a=1;for(;t[o]===t[a];)++a;for(;a<n;){for(r=a+1;t[a]===t[r];)++r;if(t[a]-t[a-1]<e){for(i=a+(o+r-a-a>>1);i<a;)t[i++]=t[a];for(;i>a;)t[i--]=t[o]}o=a,a=r}return t}(o,e+e/4):o}const K=Math.sqrt(2*Math.PI),tt=Math.SQRT2;let et=NaN;function nt(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(et==et)i=et,et=NaN;else{do{i=2*Q()-1,o=2*Q()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,et=o*r}return t+i*e}function rt(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*K)}function it(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,o=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,o/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,o=t/e/2.506628274631)}return r>0?1-o:o}function ot(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*tt*function(t){let e,n=-Math.log((1-t)*(1+t));return n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0,e*t}(2*t-1)}function at(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>nt(n,r),pdf:t=>rt(t,n,r),cdf:t=>it(t,n,r),icdf:t=>ot(t,n,r)};return i.mean(t).stdev(e)}function st(t,e){const n=at();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=G(t)),i):e},sample:()=>t[~~(Q()*r)]+e*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-t[a])/e);return o/e/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-t[a])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function lt(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+nt()*e)}function ut(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*K*t)}function ct(t,e,n){return it(Math.log(t),e,n)}function ft(t,e,n){return Math.exp(ot(t,e,n))}function dt(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*Q()}function ht(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function pt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function mt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function gt(t,e,n){let r=0,i=0;for(const o of t){const t=n(o);null==e(o)||null==t||isNaN(t)||(r+=(t-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function yt(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-o*t,o]}function vt(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,o=new Float64Array(i),a=new Float64Array(i);let s,l,u,c=0,f=0,d=0;for(u of t)o[c]=s=+e(u),a[c]=l=+n(u),++c,f+=(s-f)/c,d+=(l-d)/c;for(c=0;c<i;++c)o[c]-=f,a[c]-=d;return[o,a,f,d]}function bt(t,e,n,r){let i,o,a=-1;for(const s of t)i=e(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function xt(t,e,n,r,i){let o=0,a=0;return bt(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;o+=n*n,a+=s*s})),1-o/a}function _t(t,e,n){let r=0,i=0,o=0,a=0,s=0;bt(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=yt(r,i,o,a),u=t=>l[0]+l[1]*t;return{coef:l,predict:u,rSquared:xt(t,e,n,i,u)}}function wt(t,e,n){const[r,i,o,a]=vt(t,e,n),s=r.length;let l,u,c,f,d=0,h=0,p=0,m=0,g=0;for(l=0;l<s;)u=r[l],c=i[l++],f=u*u,d+=(f-d)/l,h+=(f*u-h)/l,p+=(f*f-p)/l,m+=(u*c-m)/l,g+=(f*c-g)/l;const y=p-d*d,v=d*y-h*h,b=(g*d-m*h)/v,x=(m*y-g*h)/v,_=-b*d,w=t=>b*(t-=o)*t+x*t+_+a;return{coef:[_-x*o+b*o*o+a,x-2*b*o,b],predict:w,rSquared:xt(t,e,n,a,w)}}function kt(t,e,n,r){const i=Array(t);let o,a,s,l;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(s=e[o],l=1,i[o]+=s,a=1;a<=o;++a)l*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*l;return i[0]+=r,i}function At(t){return(t=1-t*t*t)*t*t}function Et(t,e,n){const r=t[e];let i=n[0],o=n[1]+1;if(!(o>=t.length))for(;e>i&&t[o]-r<=r-t[i];)n[0]=++i,n[1]=o,++o}const Mt=.5*Math.PI/180;function Ct(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],a=e[1],s=a-o,l=s/r,u=[i(o)],c=[];if(n===r){for(let t=1;t<r;++t)u.push(i(o+t/n*s));return u.push(i(a)),u}c.push(i(a));for(let m=n;--m>0;)c.push(i(o+m/n*s));let f=u[0],d=c[c.length-1];const h=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let o=0;o<i;++o){const t=e[o][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(f[1],c);for(;d;){const t=i((f[0]+d[0])/2);t[0]-f[0]>=l&&St(f,t,d,h,p)>Mt?c.push(t):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function St(t,e,n,r,i){const o=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),a=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(o-a)}function Dt(t,e,n){return t.fields=e||[],t.fname=n,t}function Ft(t){return null==t?null:t.fname}function Tt(t){return null==t?null:t.fields}function Nt(t){return 1===t.length?Ot(t[0]):zt(t)}const Ot=t=>function(e){return e[t]},zt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Rt(t){throw Error(t)}function Pt(t){const e=[],n=t.length;let r,i,o,a=null,s=0,l="";function u(){e.push(l+t.substring(r,i)),l="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)l+=t.substring(r,i++),r=i;else if(o===a)u(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&u(),s=r=i+1):"]"===o&&(s||Rt("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&Rt("Access path missing closing bracket: "+t),a&&Rt("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function Bt(t,e,n){const r=Pt(t);return t=1===r.length?r[0]:t,Dt((n&&n.get||Nt)(r),[t],e||t)}const Lt=Bt("id"),jt=Dt((t=>t),[],"identity"),Ut=Dt((()=>0),[],"zero"),qt=Dt((()=>1),[],"one"),It=Dt((()=>!0),[],"true"),Wt=Dt((()=>!1),[],"false");function $t(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const Ht=0,Zt=1,Yt=2,Vt=3,Gt=4;function Xt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$t,r=t||Ht;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=Zt&&n(e||"error","ERROR",arguments),this},warn(){return r>=Yt&&n(e||"warn","WARN",arguments),this},info(){return r>=Vt&&n(e||"log","INFO",arguments),this},debug(){return r>=Gt&&n(e||"log","DEBUG",arguments),this}}}var Qt=Array.isArray;function Jt(t){return t===Object(t)}function Kt(t){return t[t.length-1]}function te(t){return null==t||""===t?null:+t}const ee=t=>e=>t*Math.exp(e),ne=t=>e=>Math.log(t*e),re=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),ie=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,oe=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function ae(t,e,n,r){const i=n(t[0]),o=n(Kt(t)),a=(o-i)*e;return[r(i-a),r(o-a)]}function se(t,e,n,r,i){const o=r(t[0]),a=r(Kt(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function le(t,e,n){return se(t,e,n,te,jt)}function ue(t,e,n){const r=Math.sign(t[0]);return se(t,e,n,ne(r),ee(r))}function ce(t,e,n,r){return se(t,e,n,oe(r),oe(1/r))}function fe(t,e,n,r){return se(t,e,n,re(r),ie(r))}function de(t){return null!=t?Qt(t)?t:[t]:[]}function he(t){return"function"==typeof t}const pe="descending";function me(t,e,n){n=n||{},e=de(e)||[];const r=[],i=[],o={},a=n.comparator||ye;return de(t).forEach(((t,a)=>{null!=t&&(r.push(e[a]===pe?-1:1),i.push(t=he(t)?t:Bt(t,null,n)),(Tt(t)||[]).forEach((t=>o[t]=1)))})),0===i.length?null:Dt(a(i,r),Object.keys(o))}const ge=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),ye=(t,e)=>1===t.length?ve(t[0],e[0]):be(t,e,t.length),ve=(t,e)=>function(n,r){return ge(t(n),t(r))*e},be=(t,e,n)=>(e.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=t[s],a=ge(o(r),o(i));return a*e[s]});function xe(t){return he(t)?t:()=>t}function _e(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function we(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function ke(t,e){let n,r,i,o,a=0;if(t&&(n=t.length))if(null==e){for(r=t[a];a<n&&(null==r||r!=r);r=t[++a]);for(i=o=r;a<n;++a)r=t[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[a]);a<n&&(null==r||r!=r);r=e(t[++a]));for(i=o=r;a<n;++a)r=e(t[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}const Ae=Object.prototype.hasOwnProperty;function Ee(t,e){return Ae.call(t,e)}const Me={};function Ce(t){let e,n={};function r(t){return Ee(n,t)&&n[t]!==Me}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===Me&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=Me),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===Me||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function Se(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),we(r,n)}function De(t,e,n,r){let i,o=e[0],a=e[e.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=a:t<a)}function Fe(t){return"boolean"==typeof t}function Te(t){return"[object Date]"===Object.prototype.toString.call(t)}function Ne(t){return"number"==typeof t}function Oe(t){return"string"==typeof t}function ze(t,e,n){t&&(t=e?de(t).map((t=>t.replace(/\\(.)/g,"$1"))):de(t));const r=t&&t.length,i=n&&n.get||Nt,o=t=>i(e?[t]:Pt(t));let a;if(r)if(1===r){const e=o(t[0]);a=function(t){return""+e(t)}}else{const e=t.map(o);a=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else a=function(){return""};return Dt(a,t,"key")}function Re(t,e){let n="";for(;--e>=0;)n+=t;return n}function Pe(t){return t&&Kt(t)-t[0]||0}function Be(t){return Qt(t)?"["+t.map(Be)+"]":Jt(t)||Oe(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Le(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t||!t)}const je=t=>Ne(t)||Te(t)?t:Date.parse(t);function Ue(t,e){return e=e||je,null==t||""===t?null:e(t)}function qe(t){return null==t||""===t?null:t+""}function Ie(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function We(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var $e={},He={},Ze=34,Ye=10,Ve=13;function Ge(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Xe(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Qe(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Je(t){return t}function Ke(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return tn(t,e)}))}:tn(t,e)}function tn(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=en(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function en(t,e){var n=function(t){if(null==t)return Je;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+a;l<u;)c[l]=t[l],++l;return c}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,a)}function o(t){return n(t)}function a(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=a(e.arcs);break;case"MultiLineString":n=e.arcs.map(a);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function nn(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)})),e.forEach((function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),s=a[0],l=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=l]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o}function rn(t){return en(t,on.apply(this,arguments))}function on(t,e,n){var r,i,o;if(arguments.length>1)r=function(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function l(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(l)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:nn(t,r)}}const an=Math.sqrt(50),sn=Math.sqrt(10),ln=Math.sqrt(2);function un(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=an?10:o>=sn?5:o>=ln?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?un(t,e,2*n):[s,l,u]}function cn(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];const r=e<t,[i,o,a]=r?un(e,t,n):un(t,e,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function fn(t,e,n){return un(t=+t,e=+e,n=+n)[2]}function dn(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?fn(e,t,n):fn(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}var hn,pn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mn(t){if(!(e=pn.exec(t)))throw new Error("invalid format: "+t);var e;return new gn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function gn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function yn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function vn(t){return(t=yn(Math.abs(t)))?t[1]:NaN}function bn(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(vn(e)/3)))-vn(Math.abs(t)))}function xn(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vn(e)-vn(t))+1}function _n(t){return Math.max(0,-vn(Math.abs(t)))}function wn(t,e){var n=yn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}mn.prototype=gn.prototype,gn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const kn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>wn(100*t,e),r:wn,s:function(t,e){var n=yn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(hn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+yn(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function An(t){return t}var En,Mn,Cn,Sn=Array.prototype.map,Dn=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Fn(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?An:(e=Sn.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?An:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Sn.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=mn(t)).fill,n=t.align,f=t.sign,d=t.symbol,h=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):kn[v]||(void 0===g&&(g=12),y=!0,v="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?o:/[%p]/.test(v)?l:"",_=kn[v],w=/[defgprs%]/.test(v);function k(t){var i,o,l,d=b,k=x;if("c"===v)k=_(t)+k,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:_(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0==+t&&"+"!==f&&(A=!1),d=(A?"("===f?f:u:"-"===f||"("===f?"":f)+d,k=("s"===v?Dn[8+hn/3]:"")+k+(A&&"("===f?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){k=(46===l?a+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}m&&!h&&(t=r(t,1/0));var E=d.length+t.length+k.length,M=E<p?new Array(p-E+1).join(e):"";switch(m&&h&&(t=r(M+t,M.length?p-k.length:1/0),M=""),n){case"<":t=d+t+k+M;break;case"=":t=d+M+t+k;break;case"^":t=M.slice(0,E=M.length>>1)+d+t+k+M.slice(E);break;default:t=M+d+t+k}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:f,formatPrefix:function(t,e){var n=f(((t=mn(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(vn(e)/3))),i=Math.pow(10,-r),o=Dn[8+r/3];return function(t){return n(i*t)+o}}}}En=Fn({thousands:",",grouping:[3],currency:["$",""]}),Mn=En.format,Cn=En.formatPrefix;const Tn=new Date,Nn=new Date;function On(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=e=>(t(e=new Date(+e)),e),i.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),i.round=t=>{const e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),e(n,o),t(n)}while(s<n&&n<r);return a},i.filter=n=>On((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})),n&&(i.count=(e,r)=>(Tn.setTime(+e),Nn.setTime(+r),t(Tn),t(Nn),Math.floor(n(Tn,Nn))),i.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?e=>r(e)%t==0:e=>i.count(0,e)%t==0):i:null)),i}const zn=1e3,Rn=6e4,Pn=36e5,Bn=864e5,Ln=6048e5,jn=31536e6,Un=On((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Rn)/Bn),(t=>t.getDate()-1)),qn=(Un.range,On((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Bn),(t=>t.getUTCDate()-1))),In=(qn.range,On((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Bn),(t=>Math.floor(t/Bn))));function Wn(t){return On((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Rn)/Ln))}In.range;const $n=Wn(0),Hn=Wn(1),Zn=Wn(2),Yn=Wn(3),Vn=Wn(4),Gn=Wn(5),Xn=Wn(6);function Qn(t){return On((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/Ln))}$n.range,Hn.range,Zn.range,Yn.range,Vn.range,Gn.range,Xn.range;const Jn=Qn(0),Kn=Qn(1),tr=Qn(2),er=Qn(3),nr=Qn(4),rr=Qn(5),ir=Qn(6),or=(Jn.range,Kn.range,tr.range,er.range,nr.range,rr.range,ir.range,On((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear())));or.every=t=>isFinite(t=Math.floor(t))&&t>0?On((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null,or.range;const ar=On((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));ar.every=t=>isFinite(t=Math.floor(t))&&t>0?On((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null,ar.range;const sr=On((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth())),lr=(sr.range,On((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth()))),ur=(lr.range,On((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn-t.getMinutes()*Rn)}),((t,e)=>{t.setTime(+t+e*Pn)}),((t,e)=>(e-t)/Pn),(t=>t.getHours()))),cr=(ur.range,On((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*Pn)}),((t,e)=>(e-t)/Pn),(t=>t.getUTCHours()))),fr=(cr.range,On((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn)}),((t,e)=>{t.setTime(+t+e*Rn)}),((t,e)=>(e-t)/Rn),(t=>t.getMinutes()))),dr=(fr.range,On((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*Rn)}),((t,e)=>(e-t)/Rn),(t=>t.getUTCMinutes()))),hr=(dr.range,On((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*zn)}),((t,e)=>(e-t)/zn),(t=>t.getUTCSeconds()))),pr=(hr.range,On((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t)));function mr(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gr(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=P,n=(e,n)=>P(t(e),n),r=(e,n)=>t(e)-n):(e=t===P||t===mr?t:yr,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function yr(){return 0}pr.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?On((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):pr:null),pr.range;const vr="year",br="quarter",xr="month",_r="week",wr="date",kr="day",Ar="dayofyear",Er="hours",Mr="minutes",Cr="seconds",Sr="milliseconds",Dr=[vr,br,xr,_r,wr,kr,Ar,Er,Mr,Cr,Sr],Fr=Dr.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function Tr(t){const e=de(t).slice(),n={};return e.length||Rt("Missing time unit."),e.forEach((t=>{Ee(Fr,t)?n[t]=1:Rt("Invalid time unit: ".concat(t,"."))})),(n[_r]||n[kr]?1:0)+(n[br]||n[xr]||n[wr]?1:0)+(n[Ar]?1:0)>1&&Rt("Incompatible time units: ".concat(t)),e.sort(((t,e)=>Fr[t]-Fr[e])),e}const Nr={[vr]:"%Y ",[br]:"Q%q ",[xr]:"%b ",[wr]:"%d ",[_r]:"W%U ",[kr]:"%a ",[Ar]:"%j ",[Er]:"%H:00",[Mr]:"00:%M",[Cr]:":%S",[Sr]:".%L",["".concat(vr,"-").concat(xr)]:"%Y-%m ",["".concat(vr,"-").concat(xr,"-").concat(wr)]:"%Y-%m-%d ",["".concat(Er,"-").concat(Mr)]:"%H:%M"},Or=new Date;function zr(t){return Or.setFullYear(t),Or.setMonth(0),Or.setDate(1),Or.setHours(0,0,0,0),Or}function Rr(t){return Un.count(zr(t.getFullYear())-1,t)}function Pr(t){return $n.count(zr(t.getFullYear())-1,t)}function Br(t){return zr(t).getDay()}function Lr(t,e,n,r,i,o,a){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,o,a);return s.setFullYear(t),s}return new Date(t,e,n,r,i,o,a)}function jr(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return qn.count(e-1,t)}function Ur(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Jn.count(e-1,t)}function qr(t){return Or.setTime(Date.UTC(t,0,1)),Or.getUTCDay()}function Ir(t,e,n,r,i,o,a){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,a));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,a))}function Wr(t,e,n,r,i){const o=e||1,a=Kt(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===a&&o,e),l=new Date,u=Ie(t),c=u[vr]?s(vr):xe(2012),f=u[xr]?s(xr):u[br]?s(br):Ut,d=u[_r]&&u[kr]?s(kr,1,_r+kr):u[_r]?s(_r,1):u[kr]?s(kr,1):u[wr]?s(wr,1):u[Ar]?s(Ar,1):qt,h=u[Er]?s(Er):Ut,p=u[Mr]?s(Mr):Ut,m=u[Cr]?s(Cr):Ut,g=u[Sr]?s(Sr):Ut;return function(t){l.setTime(+t);const e=c(l);return i(e,f(l),d(l,e),h(l),p(l),m(l),g(l))}}function $r(t,e,n){return e+7*t-(n+6)%7}const Hr={[vr]:t=>t.getFullYear(),[br]:t=>Math.floor(t.getMonth()/3),[xr]:t=>t.getMonth(),[wr]:t=>t.getDate(),[Er]:t=>t.getHours(),[Mr]:t=>t.getMinutes(),[Cr]:t=>t.getSeconds(),[Sr]:t=>t.getMilliseconds(),[Ar]:t=>Rr(t),[_r]:t=>Pr(t),[_r+kr]:(t,e)=>$r(Pr(t),t.getDay(),Br(e)),[kr]:(t,e)=>$r(1,t.getDay(),Br(e))},Zr={[br]:t=>3*t,[_r]:(t,e)=>$r(t,0,Br(e))};function Yr(t,e){return Wr(t,e||1,Hr,Zr,Lr)}const Vr={[vr]:t=>t.getUTCFullYear(),[br]:t=>Math.floor(t.getUTCMonth()/3),[xr]:t=>t.getUTCMonth(),[wr]:t=>t.getUTCDate(),[Er]:t=>t.getUTCHours(),[Mr]:t=>t.getUTCMinutes(),[Cr]:t=>t.getUTCSeconds(),[Sr]:t=>t.getUTCMilliseconds(),[Ar]:t=>jr(t),[_r]:t=>Ur(t),[kr]:(t,e)=>$r(1,t.getUTCDay(),qr(e)),[_r+kr]:(t,e)=>$r(Ur(t),t.getUTCDay(),qr(e))},Gr={[br]:t=>3*t,[_r]:(t,e)=>$r(t,0,qr(e))};function Xr(t,e){return Wr(t,e||1,Vr,Gr,Ir)}const Qr={[vr]:or,[br]:sr.every(3),[xr]:sr,[_r]:$n,[wr]:Un,[kr]:Un,[Ar]:Un,[Er]:ur,[Mr]:fr,[Cr]:hr,[Sr]:pr},Jr={[vr]:ar,[br]:lr.every(3),[xr]:lr,[_r]:Jn,[wr]:qn,[kr]:qn,[Ar]:qn,[Er]:cr,[Mr]:dr,[Cr]:hr,[Sr]:pr};function Kr(t){return Qr[t]}function ti(t){return Jr[t]}function ei(t,e,n){return t?t.offset(e,n):void 0}function ni(t,e,n,r){return t?t.range(e,n,r):void 0}const ri=31536e6,ii=[vr,xr,wr,Er,Mr,Cr,Sr],oi=ii.slice(0,-1),ai=oi.slice(0,-1),si=ai.slice(0,-1),li=si.slice(0,-1),ui=[vr,xr],ci=[vr],fi=[[oi,1,1e3],[oi,5,5e3],[oi,15,15e3],[oi,30,3e4],[ai,1,6e4],[ai,5,3e5],[ai,15,9e5],[ai,30,18e5],[si,1,36e5],[si,3,108e5],[si,6,216e5],[si,12,432e5],[li,1,864e5],[[vr,_r],1,6048e5],[ui,1,2592e6],[ui,3,7776e6],[ci,1,ri]];function di(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function hi(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function pi(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function mi(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,u=Ci(i),c=Si(i),f=Ci(o),d=Si(o),h=Ci(a),p=Si(a),m=Ci(s),g=Si(s),y=Ci(l),v=Si(l),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Gi,e:Gi,f:to,g:fo,G:po,H:Xi,I:Qi,j:Ji,L:Ki,m:eo,M:no,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Bo,s:Lo,S:ro,u:io,U:oo,V:so,w:lo,W:uo,x:null,X:null,y:co,Y:ho,Z:mo,"%":Po},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:go,e:go,f:_o,g:No,G:zo,H:yo,I:vo,j:bo,L:xo,m:wo,M:ko,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Bo,s:Lo,S:Ao,u:Eo,U:Mo,V:So,w:Do,W:Fo,x:null,X:null,y:To,Y:Oo,Z:Ro,"%":Po},_={a:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:ji,e:ji,f:Hi,g:Ri,G:zi,H:qi,I:qi,j:Ui,L:$i,m:Li,M:Ii,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:Bi,Q:Yi,s:Vi,S:Wi,u:Fi,U:Ti,V:Ni,w:Di,W:Oi,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:Ri,Y:zi,Z:Pi,"%":Zi};function w(t,e){return function(n){var r,i,o,a=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(i=_i[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}}function k(t,e){return function(n){var r,i,o=pi(1900,void 0,1);if(A(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=hi(pi(o.y,0,1))).getUTCDay(),r=i>4||0===i?Kn.ceil(r):Kn(r),r=qn.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=di(pi(o.y,0,1))).getDay(),r=i>4||0===i?Hn.ceil(r):Hn(r),r=Un.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?hi(pi(o.y,0,1)).getUTCDay():di(pi(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,hi(o)):di(o)}}function A(t,e,n,r){for(var i,o,a=0,s=e.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=_[i in _i?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=k(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=k(t+="",!0);return e.toString=function(){return t},e}}}var gi,yi,vi,bi,xi,_i={"-":"",_:" ",0:"0"},wi=/^\s*\d+/,ki=/^%/,Ai=/[\\^$*+?|[\]().{}]/g;function Ei(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Mi(t){return t.replace(Ai,"\\$&")}function Ci(t){return new RegExp("^(?:"+t.map(Mi).join("|")+")","i")}function Si(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function Di(t,e,n){var r=wi.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Fi(t,e,n){var r=wi.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ti(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Ni(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Oi(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function zi(t,e,n){var r=wi.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ri(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Pi(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Bi(t,e,n){var r=wi.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Li(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function ji(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Ui(t,e,n){var r=wi.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function qi(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Ii(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Wi(t,e,n){var r=wi.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function $i(t,e,n){var r=wi.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Hi(t,e,n){var r=wi.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Zi(t,e,n){var r=ki.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Yi(t,e,n){var r=wi.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Vi(t,e,n){var r=wi.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Gi(t,e){return Ei(t.getDate(),e,2)}function Xi(t,e){return Ei(t.getHours(),e,2)}function Qi(t,e){return Ei(t.getHours()%12||12,e,2)}function Ji(t,e){return Ei(1+Un.count(or(t),t),e,3)}function Ki(t,e){return Ei(t.getMilliseconds(),e,3)}function to(t,e){return Ki(t,e)+"000"}function eo(t,e){return Ei(t.getMonth()+1,e,2)}function no(t,e){return Ei(t.getMinutes(),e,2)}function ro(t,e){return Ei(t.getSeconds(),e,2)}function io(t){var e=t.getDay();return 0===e?7:e}function oo(t,e){return Ei($n.count(or(t)-1,t),e,2)}function ao(t){var e=t.getDay();return e>=4||0===e?Vn(t):Vn.ceil(t)}function so(t,e){return t=ao(t),Ei(Vn.count(or(t),t)+(4===or(t).getDay()),e,2)}function lo(t){return t.getDay()}function uo(t,e){return Ei(Hn.count(or(t)-1,t),e,2)}function co(t,e){return Ei(t.getFullYear()%100,e,2)}function fo(t,e){return Ei((t=ao(t)).getFullYear()%100,e,2)}function ho(t,e){return Ei(t.getFullYear()%1e4,e,4)}function po(t,e){var n=t.getDay();return Ei((t=n>=4||0===n?Vn(t):Vn.ceil(t)).getFullYear()%1e4,e,4)}function mo(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ei(e/60|0,"0",2)+Ei(e%60,"0",2)}function go(t,e){return Ei(t.getUTCDate(),e,2)}function yo(t,e){return Ei(t.getUTCHours(),e,2)}function vo(t,e){return Ei(t.getUTCHours()%12||12,e,2)}function bo(t,e){return Ei(1+qn.count(ar(t),t),e,3)}function xo(t,e){return Ei(t.getUTCMilliseconds(),e,3)}function _o(t,e){return xo(t,e)+"000"}function wo(t,e){return Ei(t.getUTCMonth()+1,e,2)}function ko(t,e){return Ei(t.getUTCMinutes(),e,2)}function Ao(t,e){return Ei(t.getUTCSeconds(),e,2)}function Eo(t){var e=t.getUTCDay();return 0===e?7:e}function Mo(t,e){return Ei(Jn.count(ar(t)-1,t),e,2)}function Co(t){var e=t.getUTCDay();return e>=4||0===e?nr(t):nr.ceil(t)}function So(t,e){return t=Co(t),Ei(nr.count(ar(t),t)+(4===ar(t).getUTCDay()),e,2)}function Do(t){return t.getUTCDay()}function Fo(t,e){return Ei(Kn.count(ar(t)-1,t),e,2)}function To(t,e){return Ei(t.getUTCFullYear()%100,e,2)}function No(t,e){return Ei((t=Co(t)).getUTCFullYear()%100,e,2)}function Oo(t,e){return Ei(t.getUTCFullYear()%1e4,e,4)}function zo(t,e){var n=t.getUTCDay();return Ei((t=n>=4||0===n?nr(t):nr.ceil(t)).getUTCFullYear()%1e4,e,4)}function Ro(){return"+0000"}function Po(){return"%"}function Bo(t){return+t}function Lo(t){return Math.floor(+t/1e3)}function jo(t){const e={};return n=>e[n]||(e[n]=t(n))}function Uo(t){const e=jo(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=mn(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return r=e(n),i=e(".1f")(1)[1],t=>{const e=r(t),n=e.indexOf(i);if(n<0)return e;let o=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(e,n);const a=o<e.length?e.slice(o):"";for(;--o>n;)if("0"!==e[o]){++o;break}return e.slice(0,o)+a}}var r,i;return e(n)},formatSpan(t,r,i,o){o=mn(null==o?",f":o);const a=dn(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=bn(a,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(l=xn(a,s))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=_n(a))||(o.precision=l-2*("%"===o.type))}return e(o)}}}let qo,Io;function Wo(t){return Uo(Fn(t))}function $o(t){return arguments.length?qo=Wo(t):qo}function Ho(t,e,n){Jt(n=n||{})||Rt("Invalid time multi-format specifier: ".concat(n));const r=e(Cr),i=e(Mr),o=e(Er),a=e(wr),s=e(_r),l=e(xr),u=e(br),c=e(vr),f=t(n[Sr]||".%L"),d=t(n[Cr]||":%S"),h=t(n[Mr]||"%I:%M"),p=t(n[Er]||"%I %p"),m=t(n[wr]||n[kr]||"%a %d"),g=t(n[_r]||"%b %d"),y=t(n[xr]||"%B"),v=t(n[br]||"%B"),b=t(n[vr]||"%Y");return t=>(r(t)<t?f:i(t)<t?d:o(t)<t?h:a(t)<t?p:l(t)<t?s(t)<t?m:g:c(t)<t?u(t)<t?y:v:b)(t)}function Zo(t){const e=jo(t.format),n=jo(t.utcFormat);return{timeFormat:t=>Oe(t)?e(t):Ho(e,Kr,t),utcFormat:t=>Oe(t)?n(t):Ho(n,ti,t),timeParse:jo(t.parse),utcParse:jo(t.utcParse)}}function Yo(t){return Zo(mi(t))}function Vo(t){return arguments.length?Io=Yo(t):Io}gi=mi({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),yi=gi.format,vi=gi.parse,bi=gi.utcFormat,xi=gi.utcParse,qo=Uo({format:Mn,formatPrefix:Cn}),Io=Zo({format:yi,parse:vi,utcFormat:bi,utcParse:xi});const Go=(t,e)=>we({},t,e),Xo=/^(data:|([A-Za-z]+:)?\/\/)/,Qo=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Jo=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function Ko(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function ta(t,e){e=we({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,a;const s=Qo.test(t.replace(Jo,""));null!=t&&"string"==typeof t&&s||Rt("Sanitize failure, invalid URI: "+Be(t));const l=Xo.test(t);return(a=e.baseURL)&&!l&&(t.startsWith("/")||a.endsWith("/")||(t="/"+t),t=a+t),o=(i=t.startsWith("file://"))||"file"===e.mode||"http"!==e.mode&&!l&&n,i?t=t.slice(7):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function ea(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):na}async function na(){Rt("No file system access.")}function ra(t){return t?async function(e,n){const r=we({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?he(o[i])?o[i]():o.text():Rt(o.status+""+o.statusText)}:ia}async function ia(){Rt("No HTTP fetch method available.")}const oa=t=>null!=t&&t==t,aa=t=>!(Number.isNaN(+t)||t instanceof Date),sa={boolean:Le,integer:te,number:te,date:Ue,string:qe,unknown:jt},la=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>aa(t)&&Number.isInteger(+t),aa,t=>!Number.isNaN(Date.parse(t))],ua=["boolean","integer","number","date"];function ca(t){const e=function(e,n){const r={delimiter:t};return fa(e,n?we(n,r):r)};return e.responseType="text",e}function fa(t,e){return e.header&&(t=e.header.map(Be).join(e.delimiter)+"\n"+t),function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return He;if(u)return u=!1,$e;var e,r,i=a;if(t.charCodeAt(i)===Ze){for(;a++<o&&t.charCodeAt(a)!==Ze||t.charCodeAt(++a)===Ze;);return(e=a)>=o?l=!0:(r=t.charCodeAt(a++))===Ye?u=!0:r===Ve&&(u=!0,t.charCodeAt(a)===Ye&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===Ye)u=!0;else if(r===Ve)u=!0,t.charCodeAt(a)===Ye&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===Ye&&--o,t.charCodeAt(o-1)===Ve&&--o;(r=c())!==He;){for(var f=[];r!==$e&&r!==He;)f.push(r),r=c();e&&null==(f=e(f,s++))||i.push(f)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?function(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Qe(-e,6):e>9999?"+"+Qe(e,6):Qe(e,4))+"-"+Qe(t.getUTCMonth()+1,2)+"-"+Qe(t.getUTCDate(),2)+(o?"T"+Qe(n,2)+":"+Qe(r,2)+":"+Qe(i,2)+"."+Qe(o,3)+"Z":i?"T"+Qe(n,2)+":"+Qe(r,2)+":"+Qe(i,2)+"Z":r||n?"T"+Qe(n,2)+":"+Qe(r,2)+"Z":"")}(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Ge(t);return function(r,i){return e(n(r),i,t)}}(t,e):Ge(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=Xe(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Xe(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}(e.delimiter).parse(t+"")}function da(t,e){const n=e&&e.property?Bt(e.property):jt;return!Jt(t)||(r=t,"function"==typeof Buffer&&he(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){return!Qt(t)&&function(t){return t&&he(t[Symbol.iterator])}(t)&&(t=[...t]),e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}fa.responseType="text",da.responseType="json";const ha={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function pa(t,e){let n,r,i,o;return t=da(t,e),e&&e.feature?(n=Ke,i=e.feature):e&&e.mesh?(n=rn,i=e.mesh,o=ha[e.filter]):Rt("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):Rt("Invalid TopoJSON object: "+i),r&&r.features||[r]}pa.responseType="json";const ma={dsv:fa,csv:ca(","),tsv:ca("\t"),json:da,topojson:pa};function ga(t,e){return arguments.length>1?(ma[t]=e,this):Ee(ma,t)?ma[t]:null}function ya(t){const e=ga(t);return e&&e.responseType||"text"}const va=function(t,e){return e=>({options:e||{},sanitize:ta,load:Ko,fileAccess:!1,file:ea(null),http:ra(t)})}("undefined"!=typeof fetch&&fetch);function ba(t){const e=t||jt,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function xa(t,e){try{await e(t)}catch(e){t.error(e)}}const _a=Symbol("vega_id");let wa=1;function ka(t){return!(!t||!Aa(t))}function Aa(t){return t[_a]}function Ea(t,e){return t[_a]=e,t}function Ma(t){const e=t===Object(t)?t:{data:t};return Aa(e)?e:Ea(e,wa++)}function Ca(t){return Sa(t,Ma({}))}function Sa(t,e){for(const n in t)e[n]=t[n];return e}function Da(t,e){return Ea(e,Aa(t))}function Fa(t,e){return t?e?(n,r)=>t(n,r)||Aa(e(n))-Aa(e(r)):(e,n)=>t(e,n)||Aa(e)-Aa(n):null}function Ta(t){return t&&t.constructor===Na}function Na(){const t=[],e=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:Na,insert(e){const n=de(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=he(t)?r:e,i=de(t),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify(t,e,r){const o={field:e,value:xe(r)};return he(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return he(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return a=!0,this},pulse(s,l){const u={},c={};let f,d,h,p,m,g;for(f=0,d=l.length;f<d;++f)u[Aa(l[f])]=1;for(f=0,d=e.length;f<d;++f)m=e[f],u[Aa(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach((t=>{p(t)&&(u[Aa(t)]=-1)}));for(f=0,d=t.length;f<d;++f)m=t[f],g=Aa(m),u[g]?u[g]=1:s.add.push(Ma(t[f]));for(f=0,d=l.length;f<d;++f)m=l[f],u[Aa(m)]<0&&s.rem.push(m);function y(t,e,n){n?t[e]=n(t):s.encode=e,a||(c[Aa(t)]=t)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,g=u[Aa(m)],g>0&&(y(m,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach((t=>{p(t)&&u[Aa(t)]>0&&y(t,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=e.length||r.length?l.filter((t=>u[Aa(t)]>0)):l.slice();else for(g in c)s.mod.push(c[g]);return(o||null==o&&(e.length||r.length))&&s.clean(!0),s}}}const Oa="_:mod:_";function za(){Object.defineProperty(this,Oa,{writable:!0,value:{}})}za.prototype={set(t,e,n,r){const i=this,o=i[t],a=i[Oa];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,a[e+":"+t]=-1,a[t]=-1):(o!==n||r)&&(i[t]=n,a[t]=Qt(n)?1+n.length:-1),i},modified(t,e){const n=this[Oa];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(Qt(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[Oa]={},this}};let Ra=0;const Pa=new za;function Ba(t,e,n,r){this.id=++Ra,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function La(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}Ba.prototype={targets(){return this._targets||(this._targets=ba(Lt))},set(t){return this.value!==t?(this.value=t,1):0},skip:La(1),modified:La(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new za,i=this._argops=this._argops||[],o=[];let a,s,l,u;const c=(t,n,a)=>{a instanceof Ba?(a!==this&&(e&&a.targets().add(this),o.push(a)),i.push({op:a,name:t,index:n})):r.set(t,n,a)};for(a in t)if(s=t[a],"pulse"===a)de(s).forEach((t=>{t instanceof Ba?t!==this&&(t.targets().add(this),o.push(t)):Rt("Pulse parameters must be operator instances.")})),this.source=s;else if(Qt(s))for(r.set(a,-1,Array(l=s.length)),u=0;u<l;++u)c(a,u,s[u]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(t){const e=this._argval||Pa,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===t,e.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let ja=0;function Ua(t,e,n){this.id=++ja,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function qa(t,e,n){return new Ua(t,e,n)}Ua.prototype={_filter:It,_apply:jt,targets(){return this._targets||(this._targets=ba(Lt))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=qa(t);return this.targets().add(e),e},apply(t){const e=qa(null,t);return this.targets().add(e),e},merge(){const t=qa();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=qa();return this.targets().add(qa(null,null,_e(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(qa(null,null,(()=>n=!0))),e.targets().add(qa(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=It,this._targets=null}};const Ia={skip:!0};function Wa(t,e,n,r,i,o){const a=we({},o,Ia);let s,l;he(n)||(n=xe(n)),void 0===r?s=e=>t.touch(n(e)):he(r)?(l=new Ba(null,r,i,!1),s=e=>{l.evaluate(e);const r=n(e),i=l.value;Ta(i)?t.pulse(r,i,o):t.update(r,i,a)}):s=e=>t.update(n(e),r,a),e.apply(s)}function $a(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const a=o||{},s=new Ba(null,function(t,e){return e=he(e)?e:xe(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(a.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const Ha={};function Za(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Ya(t,e){const n=[];return We(t,e,(t=>n.push(t))),n}function Va(t,e){const n={};return t.visit(e,(t=>{n[Aa(t)]=1})),t=>n[Aa(t)]?null:t}function Ga(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function Xa(t,e,n,r){const i=this;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===e){if(a.fields){const t=i.fields||(i.fields={});for(const e in a.fields)t[e]=1}a.changed(i.ADD)&&(o|=i.ADD),a.changed(i.REM)&&(o|=i.REM),a.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function Qa(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}Za.prototype={StopPropagation:Ha,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new Za(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new Za(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,Va(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return Qt(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?Qt(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Ga(n.addF,e)),2&t&&(n.remF=Ga(n.remF,e)),4&t&&(n.modF=Ga(n.modF,e)),16&t&&(n.srcF=Ga(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=Ya(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=Ya(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=Ya(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return We(n.source,n.srcF,r),n;1&t&&We(n.add,n.addF,r),2&t&&We(n.rem,n.remF,r),4&t&&We(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||We(i,t?Va(n,5):n.srcF,r)}return n}},Se(Xa,Za,{fork(t){const e=new Za(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?Qt(t)?t.some((t=>n[t])):n[t]:0},filter(){Rt("MultiPulse does not support filtering.")},materialize(){Rt("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const Ja={skip:!1,force:!1};function Ka(t,e,n,r){let i,o;const a=t[n];for(;n>e&&(o=n-1>>1,i=t[o],r(a,i)<0);)t[n]=i,n=o;return t[n]=a}function ts(){this.logger(Xt()),this.logLevel(Zt),this._clock=0,this._rank=0,this._locale=function(t,e){const n=arguments.length;return n&&2!==n&&Rt("defaultLocale expects either zero or two arguments."),n?Go($o(t),Vo(e)):Go($o(),Vo())}();try{this._loader=va()}catch(t){}this._touched=ba(Lt),this._input={},this._pulse=null,this._heap=function(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Ka(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,o=t[e];let a,s=1+(e<<1);for(;s<i;)a=s+1,a<i&&n(t[s],t[a])>=0&&(s=a),t[e]=t[s],s=1+((e=s)<<1);t[e]=o,Ka(t,r,e,n)}(e,0,t)):r=n,r}}}(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function es(t){return function(){return this._log[t].apply(this,arguments)}}function ns(t,e){Ba.call(this,t,null,e)}ts.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:es("error"),warn:es("warn"),info:es("info"),debug:es("debug"),logLevel:es("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,o=1;return t instanceof Ba?i=t:t&&t.prototype instanceof Ba?i=new t:he(t)?i=new Ba(null,t):(o=0,i=new Ba(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&Rt("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||Ja);const r=new Za(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||Ja;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||Ja;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:Na,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return function(t,e,n,r){const i=ga((e=e||{}).type||"json");return i||Rt("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=Vo();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,l,u,c,f=t.columns||Object.keys(t[0]);"auto"===e&&(e=function(t,e){return e.reduce(((e,n)=>(e[n]=function(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=la.length,i=la.map(((t,e)=>e+1));for(let o,a,s=0,l=0;s<n;++s)for(a=e?t[s][e]:t[s],o=0;o<r;++o)if(i[o]&&oa(a)&&!la[o](a)&&(i[o]=0,++l,l===la.length))return"string";return ua[i.reduce(((t,e)=>0===t?e:t),0)-1]}(t,n),e)),{})}(t,f)),f=Object.keys(e);const d=f.map((t=>{const i=e[t];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:")))return o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1)),("utc"===o[0]?r:n)(a);if(!sa[i])throw Error("Illegal format pattern: "+t+":"+i);return sa[i]}));for(s=0,u=t.length,c=f.length;s<u;++s)for(o=t[s],l=0;l<c;++l)a=f[l],o[a]=d[l](o[a])}(t,e.parse,n,r),Ee(t,"columns")&&delete t.columns,t}(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0==--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(It).insert(o.data||[])),i.done(),o},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:ya(e&&e.type)});try{r=n.parse(r,e)}catch(e){i=-2,n.warn("Data ingestion failed",t,e)}}catch(e){i=-1,n.warn("Loading failed",t,e)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,o=qa(n,r),a=function(t){t.dataflow=i;try{o.receive(t)}catch(t){i.error(t)}finally{i.run()}};let s;s="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):de(t);const l=s.length;for(let u=0;u<l;++u)s[u].addEventListener(e,a);return o},on:function(t,e,n,r,i){return(t instanceof Ba?$a:Wa)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return Qa(r);if(r._pending&&await r._pending,e&&await xa(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Za(r,o,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=ba(Lt);let a,s,l,u=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,t)),s.then?s=await s:s.async&&(i.push(s.async),s=Ha),s!==Ha&&a._targets&&a._targets.forEach((t=>r._enqueue(t))),++u):r._enqueue(a,!0)}catch(t){r._heap.clear(),l=t}if(r._input={},r._pulse=null,r.debug("Pulse ".concat(o,": ").concat(u," operators")),l&&(r._postrun=[],r.error(l)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await xa(r,t[e].callback)}return n&&await xa(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(t){r.error(t)}}))})))),r},run:function(t,e,n){return this._pulse?Qa(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(t){this.error(t)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&Qt(n)?new Xa(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==Ha&&(t.source=e.source),t)}(this._pulse,n&&n.pulse)}},Se(ns,Ba,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const rs={};function is(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function os(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function as(t,e,n){return n||t+(e?"_"+e:"")}const ss=()=>{},ls={init:ss,add:ss,rem:ss,idx:0},us={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},cs=Object.keys(us).filter((t=>"__count__"!==t));function fs(t,e){return us[t](e)}function ds(t,e){return t.idx-e.idx}function hs(){this.valid=0,this.missing=0,this._ops.forEach((t=>t.init(this)))}function ps(t,e){null!=t&&""!==t?t==t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function ms(t,e){null!=t&&""!==t?t==t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function gs(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function ys(t,e){const n=e||jt,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=us[t]())}))};return t.forEach(n),Object.values(e).sort(ds)}(t),i=t.slice().sort(ds);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=hs,o.prototype.add=ps,o.prototype.rem=ms,o.prototype.set=gs,o.prototype.get=n,o.fields=t.map((t=>t.out)),o}function vs(t){this._key=t?Bt(t):Aa,this.reset()}[...cs,"__count__"].forEach((t=>{us[t]=function(t,e){return n=>we({name:t,out:n||t},ls,e)}(t,us[t])}));const bs=vs.prototype;function xs(t){ns.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function _s(t){ns.call(this,null,t)}function ws(t,e,n){const r=t;let i=e||[],o=n||[],a={},s=0;return{add:t=>o.push(t),remove:t=>a[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter((t=>!a[r(t)])),a={},s=0),e&&t&&i.sort(t),o.length&&(i=t?function(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const a=new e.constructor(i+o);let s=0,l=0,u=0;for(;s<i&&l<o;++u)a[u]=t(e[s],n[l])>0?n[l++]:e[s++];for(;s<i;++s,++u)a[u]=e[s];for(;l<o;++l,++u)a[u]=n[l];return a}(t,i,o.sort(t)):i.concat(o),o=[]),i)}}function ks(t){ns.call(this,[],t)}function As(t){Ba.call(this,null,Es,t)}function Es(t){return this.value&&!t.modified()?this.value:me(t.fields,t.orders)}function Ms(t){ns.call(this,null,t)}function Cs(t){ns.call(this,null,t)}bs.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},bs.add=function(t){this._add.push(t)},bs.rem=function(t){this._rem.push(t)},bs.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,o=Array(r-i),a={};let s,l,u;for(s=0;s<i;++s)a[n(e[s])]=1;for(s=0,l=0;s<r;++s)a[n(u=t[s])]?a[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o},bs.distinct=function(t){const e=this.values(),n={};let r,i=e.length,o=0;for(;--i>=0;)r=t(e[i])+"",Ee(n,r)||(n[r]=1,++o);return o},bs.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=function(t,e){const n=t.length;let r,i,o,a,s,l=-1;if(null==e){for(;++l<n;)if(i=t[l],null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=t[l],null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}else{for(;++l<n;)if(i=e(t[l],l,t),null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=e(t[l],l,t),null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}return[a,s]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},bs.argmin=function(t){return this.extent(t)[0]||{}},bs.argmax=function(t){return this.extent(t)[1]||{}},bs.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},bs.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},bs.quartile=function(t){return this._get===t&&this._q||(this._q=V(this.values(),t),this._get=t),this._q},bs.q1=function(t){return this.quartile(t)[0]},bs.q2=function(t){return this.quartile(t)[1]},bs.q3=function(t){return this.quartile(t)[2]},bs.ci=function(t){return this._get===t&&this._ci||(this._ci=function(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(Z(t,r)),o=i.length;let a,s,l,u;for(l=0,u=Array(1e3);l<1e3;++l){for(a=0,s=0;s<o;++s)a+=i[~~(Q()*o)];u[l]=a/o}return u.sort(P),[W(u,.025),W(u,.975)]}(this.values(),0,0,t),this._get=t),this._ci},bs.ci0=function(t){return this.ci(t)[0]},bs.ci1=function(t){return this.ci(t)[1]},xs.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:cs},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},Se(xs,ns,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):Object.create(null),e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function o(t){let e,o,a,s;for(e in t)for(a=t[e].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(t._prev),o(e),function o(a,s,l){const u=n[l],c=r[l++];for(const n in c){const r=a?a+"|"+n:n;s[u]=c[n],l<i?o(r,s,l):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=de(Tt(t)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,e.push(o))}this._dims=de(t.groupby),this._dnames=this._dims.map((t=>{const e=Ft(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:os(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=t.fields||[null],a=t.ops||["count"],s=t.as||[],l=o.length,u={};let c,f,d,h,p,m;for(l!==a.length&&Rt("Unmatched number of fields and aggregate ops."),m=0;m<l;++m)c=o[m],f=a[m],null==c&&"count"!==f&&Rt("Null aggregate field specified."),h=Ft(c),p=as(f,h,s[m]),n.push(p),"count"!==f?(d=u[h],d||(i(c),d=u[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(fs(f,p))):this._counts.push(p);return this._measures=this._measures.map((t=>ys(t,t.field))),Object.create(null)},cellkey:os(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new vs),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](t);return e?Da(e.tuple,o):Ma(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,a=t.rem,s=t.mod;let l,u,c,f;if(r)for(u in r)l=r[u],i&&!l.num||a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(e[c])),e[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(0===l.num&&i?a:s).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,t}}),_s.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},Se(_s,ns,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,a=t.as||["bin0","bin1"],s=a[0],l=a[1];let u;return u=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(Tt(t.field))?e.ADD_MOD:e.ADD,e.visit(u,n?t=>{const e=r(t);t[s]=e,t[l]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[s]=r(t)),e.modifies(n?a:s)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=X(t),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=t.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const l=function(t){let n=te(e(t));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return l.start=a,l.stop=n.stop,l.step=r,this.value=Dt(l,Tt(e),t.name||"bin_"+Ft(e))}}),ks.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Se(ks,ns,{transform(t,e){const n=e.fork(e.ALL),r=ws(Aa,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Fa(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),Se(As,Ba),Ms.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},Se(Ms,ns,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,o)||[],l=0,u=i.length;l<u;++l)a.test(r=i[l])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,a=this._stop,s=t.field,l=t.as||["text","count"],u=n((t=>i[t]=1+(i[t]||0))),c=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,u):(e.visit(e.ADD,u),e.visit(e.REM,c)),this._finish(e,l)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],o=e[1],a=t.fork(t.NO_SOURCE|t.NO_FIELDS);let s,l,u;for(s in n)l=r[s],u=n[s]||0,!l&&u?(r[s]=l=Ma({}),l[i]=s,l[o]=u,a.add.push(l)):0===u?(l&&a.rem.push(l),n[s]=null,r[s]=null):l[o]!==u&&(l[o]=u,a.mod.push(l));return a.modifies(e)}}),Cs.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Se(Cs,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],o=r[1],a=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,o,a=[],s={},l=t.length,u=0;u<l;++u)for(s[e]=o=t[u],i=0;i<l;++i)s[n]=t[i],r(s)&&(a.push(Ma(s)),(s={})[e]=o);return a}(s,i,o,t.filter||It)):n.mod=s,n.source=this.value,n.modifies(r)}});const Ss={kde:st,mixture:function(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=Q();let i=t[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(e<o){i=t[a];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)},normal:at,lognormal:function(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>lt(n,r),pdf:t=>ut(t,n,r),cdf:t=>ct(t,n,r),icdf:t=>ft(t,n,r)};return i.mean(t).stdev(e)},uniform:function(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>dt(n,r),pdf:t=>ht(t,n,r),cdf:t=>pt(t,n,r),icdf:t=>mt(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}},Ds="function";function Fs(t,e){const n=t[Ds];Ee(Ss,n)||Rt("Unknown distribution function: "+n);const r=Ss[n]();for(const i in t)"field"===i?r.data((t.from||e()).map(t[i])):"distributions"===i?r[i](t[i].map((t=>Fs(t,e)))):typeof r[i]===Ds&&r[i](t[i]);return r}function Ts(t){ns.call(this,null,t)}const Ns=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Os={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Ns},{name:"weights",type:"number",array:!0}]};function zs(t,e){return t?t.map(((t,n)=>e[n]||Ft(t))):null}function Rs(t,e,n){const r=[],i=t=>t(l);let o,a,s,l,u,c;if(null==e)r.push(t.map(n));else for(o={},a=0,s=t.length;a<s;++a)l=t[a],u=e.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}function Ps(t){ns.call(this,null,t)}function Bs(t){Ba.call(this,null,Ls,t),this.modified(!0)}function Ls(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Dt((n=>e(n,t)),Tt(e),Ft(e))}function js(t){ns.call(this,[void 0,void 0],t)}function Us(t,e){Ba.call(this,t),this.parent=e,this.count=0}function qs(t){ns.call(this,{},t),this._keys=Ce();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function Is(t){Ba.call(this,null,Ws,t)}function Ws(t){return this.value&&!t.modified()?this.value:Qt(t.name)?de(t.name).map((t=>Bt(t))):Bt(t.name,t.as)}function $s(t){ns.call(this,Ce(),t)}function Hs(t){ns.call(this,[],t)}function Zs(t){ns.call(this,[],t)}function Ys(t){ns.call(this,null,t)}function Vs(t){ns.call(this,[],t)}Ts.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Ns.concat(Os)},{name:"as",type:"string",array:!0,default:["value","density"]}]},Se(Ts,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=Fs(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let a=t.method||"pdf";"pdf"!==a&&"cdf"!==a&&Rt("Invalid density method: "+a),t.extent||r.data||Rt("Missing density extent parameter."),a=r[a];const s=t.as||["value","density"],l=Ct(a,t.extent||ke(r.data()),i,o).map((t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],Ma(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),Ps.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},Se(Ps,ns,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=Rs(e.source,t.groupby,jt),i=t.smooth||!1,o=t.field,a=t.step||((t,e)=>Pe(ke(t,e))/30)(n,o),s=Fa(((t,e)=>o(t)-o(e))),l=t.as||"bin",u=r.length;let c,f=1/0,d=-1/0,h=0;for(;h<u;++h){const t=r[h].sort(s);c=-1;for(const e of J(t,a,i,o))e<f&&(f=e),e>d&&(d=e),t[++c][l]=e}return this.value={start:f,stop:d,step:a},e.reflow(!0).modifies(l)}}),Se(Bs,Ba),js.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Se(js,ns,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=te(r(t));null!=e&&(e<o&&(o=e),e>a&&(a=e))})),!Number.isFinite(o)||!Number.isFinite(a)){let t=Ft(r);t&&(t=' for field "'.concat(t,'"')),e.dataflow.warn("Infinite extent".concat(t,": [").concat(o,", ").concat(a,"]")),o=a=void 0}this.value=[o,a]}}),Se(Us,Ba,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),Se(qs,ns,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let o,a,s=Ee(i,t)&&i[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[t])&&a.tuple,o=n.dataflow,s=new Us(n.fork(n.NO_SOURCE),this),o.add(s).connect(e(o,t,a)),i[t]=s,this.activate(s)),s},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,a=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=Aa(t),n=o.get(e);void 0!==n&&(o.delete(e),s(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);o.set(Aa(t),e),s(e).add(t)})),a||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=Aa(t),n=o.get(e),i=r(t);n===i?s(i).mod(t):(o.set(e,i),s(n).rem(t),s(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{s(o.get(Aa(t))).mod(t)})),a&&e.visit(e.REFLOW,(t=>{const e=Aa(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),s(n).rem(t),s(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),Se(Is,Ba),$s.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Se($s,ns,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),o=i.add,a=i.rem,s=i.mod,l=t.expr;let u=!0;function c(e){const n=Aa(e),i=l(e,t),c=r.get(n);i&&c?(r.delete(n),o.push(e)):i||c?u&&i&&!c&&s.push(e):(r.set(n,1),a.push(e))}return e.visit(e.REM,(t=>{const e=Aa(t);r.has(e)?r.delete(e):a.push(t)})),e.visit(e.ADD,(e=>{l(e,t)?o.push(e):r.set(Aa(e),1)})),e.visit(e.MOD,c),t.modified()&&(u=!1,e.visit(e.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Hs.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Se(Hs,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=zs(r,t.as||[]),o=t.index||null,a=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),s=e.reduce(((t,e)=>Math.max(t,e.length)),0);let l,u,c,f=0;for(;f<s;++f){for(u=Ca(t),l=0;l<a;++l)u[i[l]]=null==(c=e[l][f])?null:c;o&&(u[o]=f),n.add.push(u)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),Zs.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Se(Zs,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(Ft),o=t.as||["key","value"],a=o[0],s=o[1],l=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,o=0;o<l;++o)e=Ca(t),e[a]=i[o],e[s]=r[o](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(o)}}),Ys.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Se(Ys,ns,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,(e=>e[r]=n(e,t)))}}),Se(Vs,ns,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,o,a,s=this.value,l=t.size-s.length;if(l>0){for(i=[];--l>=0;)i.push(a=Ma(r(t))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-l),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-l);return n.source=this.value=s,n}});const Gs={value:"value",median:H,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:L,max:B},Xs=[];function Qs(t){ns.call(this,[],t)}function Js(t){xs.call(this,t)}function Ks(t){ns.call(this,null,t)}function tl(t){Ba.call(this,null,el,t)}function el(t){return this.value&&!t.modified()?this.value:ze(t.fields,t.flat)}function nl(t){ns.call(this,[],t),this._pending=null}function rl(t,e,n){n.forEach(Ma);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function il(t){ns.call(this,{},t)}function ol(t){Ba.call(this,null,al,t)}function al(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function sl(t){Ba.call(this,null,ll,t)}function ll(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function ul(t){ns.call(this,null,t)}function cl(t){xs.call(this,t)}function fl(t){qs.call(this,t)}function dl(t){ns.call(this,null,t)}function hl(t){ns.call(this,null,t)}function pl(t){ns.call(this,null,t)}function ml(t){ns.call(this,null,t)}function gl(t){ns.call(this,[],t),this.count=0}function yl(t){ns.call(this,null,t)}function vl(t){ns.call(this,null,t),this.modified(!0)}function bl(t){ns.call(this,null,t)}Qs.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Se(Qs,ns,{transform(t,e){var n,r,i,o,a,s,l,u,c,f,d=e.fork(e.ALL),h=function(t){var e,n=t.method||Gs.value;if(null!=Gs[n])return n===Gs.value?(e=void 0!==t.value?t.value:0,()=>e):Gs[n];Rt("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),m=Ft(t.field),g=Ft(t.key),y=(t.groupby||[]).map(Ft),v=function(t,e,n,r){var i,o,a,s,l,u,c,f,d=t=>t(f),h=[],p=r?r.slice():[],m={},g={};for(p.forEach(((t,e)=>m[t]=e+1)),s=0,c=t.length;s<c;++s)u=n(f=t[s]),l=m[u]||(m[u]=p.push(u)),(a=g[o=(i=e?e.map(d):Xs)+""])||(a=g[o]=[],h.push(a),a.values=i),a[l-1]=f;return h.domain=p,h}(e.source,t.groupby,t.key,t.keyvals),b=[],x=this.value,_=v.domain.length;for(a=0,u=v.length;a<u;++a)for(i=(n=v[a]).values,r=NaN,l=0;l<_;++l)if(null==n[l]){for(o=v.domain[l],f={_impute:!0},s=0,c=i.length;s<c;++s)f[y[s]]=i[s];f[g]=o,f[m]=Number.isNaN(r)?r=h(n,p):r,b.push(Ma(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),Js.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:cs},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},Se(Js,xs,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{we(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),Ks.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Se(Ks,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=Rs(r,t.groupby,t.field),o=(t.groupby||[]).map(Ft),a=t.bandwidth,s=t.cumulative?"cdf":"pdf",l=t.as||["value","density"],u=[];let c=t.extent,f=t.steps||t.minsteps||25,d=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&Rt("Invalid density method: "+s),"shared"===t.resolve&&(c||(c=ke(r,t.field)),f=d=t.steps||d),i.forEach((e=>{const n=st(e,a)[s],r=t.counts?e.length:1;Ct(n,c||ke(e),f,d).forEach((t=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=e.dims[r];n[l[0]]=t[0],n[l[1]]=t[1]*r,u.push(Ma(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),Se(tl,Ba),Se(nl,ns,{transform(t,e){const n=e.dataflow;if(this._pending)return rl(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return rl(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then((t=>(this._pending=de(t.data),t=>t.touch(this))));return{async:e}}return n.request(t.url,t.format).then((t=>rl(this,e,de(t.data))))}}),il.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Se(il,ns,{transform(t,e){const n=t.fields,r=t.index,i=t.values,o=null==t.default?null:t.default,a=t.modified(),s=n.length;let l,u,c,f=a?e.SOURCE:e.ADD,d=e,h=t.as;return i?(u=i.length,s>1&&!h&&Rt('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*u&&Rt('The "as" parameter has too few output field names.'),h=h||i.map(Ft),l=function(t){for(var e,a,l=0,c=0;l<s;++l)if(null==(a=r.get(n[l](t))))for(e=0;e<u;++e,++c)t[h[c]]=o;else for(e=0;e<u;++e,++c)t[h[c]]=i[e](a)}):(h||Rt("Missing output field names."),l=function(t){for(var e,i=0;i<s;++i)e=r.get(n[i](t)),t[h[i]]=null==e?o:e}),a?d=e.reflow(!0):(c=n.some((t=>e.modified(t.fields))),f|=c?e.MOD:0),e.visit(f,l),d.modifies(h)}}),Se(ol,Ba),Se(sl,Ba),Se(ul,ns,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),cl.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:cs,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},Se(cl,xs,{_transform:xs.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=Tt(n).concat(Tt(r)),a=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(ge),e?i.slice(0,e):i}(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:a.map((()=>i)),fields:a.map((t=>function(t,e,n,r){return Dt((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,o))),as:a.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),Se(fl,qs,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Aa(t),n,e,t);return(t.modified("field")||r&&e.modified(Tt(r)))&&Rt("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(Ma(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),dl.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Se(dl,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=zs(t.fields,t.as||[]),o=r?(t,e)=>function(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):Sa;let a;return this.value?a=this.value:(e=e.addAll(),a=this.value={}),e.visit(e.REM,(t=>{const e=Aa(t);n.rem.push(a[e]),a[e]=null})),e.visit(e.ADD,(t=>{const e=o(t,Ma({}));a[Aa(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(o(t,a[Aa(t)]))})),n}}),Se(hl,ns,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),pl.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},Se(pl,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=Rs(e.materialize(e.SOURCE).source,t.groupby,t.field),o=(t.groupby||[]).map(Ft),a=[],s=t.step||.01,l=t.probs||is(s/2,1-1e-14,s),u=l.length;return i.forEach((t=>{const e=Y(t,l);for(let n=0;n<u;++n){const i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[r[0]]=l[n],i[r[1]]=e[n],a.push(Ma(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),Se(ml,ns,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=Aa(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=Ca(t);r[Aa(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[Aa(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),gl.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Se(gl,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value.reduce(((t,e)=>(t[Aa(e)]=1,t)),{});let a=this.value,s=this.count,l=0;function u(t){let e,r;a.length<i?a.push(t):(r=~~((s+1)*Q()),r<a.length&&r>=l&&(e=a[r],o[Aa(e)]&&n.rem.push(e),a[r]=t)),++s}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=Aa(t);o[e]&&(o[e]=-1,n.rem.push(t)),--s})),a=a.filter((t=>-1!==o[Aa(t)]))),(e.rem.length||r)&&a.length<i&&e.source&&(l=s=a.length,e.visit(e.SOURCE,(t=>{o[Aa(t)]||u(t)})),l=-1),r&&a.length>i){const t=a.length-i;for(let e=0;e<t;++e)o[Aa(a[e])]=-1,n.rem.push(a[e]);a=a.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{o[Aa(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,u),(e.add.length||l<0)&&(n.add=a.filter((t=>!o[Aa(t)]))),this.count=s,this.value=n.source=a,n}}),yl.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Se(yl,ns,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=is(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,Ma(e)})),n.add=e.add.concat(this.value),n}}),Se(vl,ns,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const xl=["unit0","unit1"];function _l(t){ns.call(this,Ce(),t)}function wl(t){ns.call(this,null,t)}bl.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Dr,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:xl}]},Se(bl,ns,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),a=(i?ti:Kr)(o.unit).offset,s=t.as||xl,l=s[0],u=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=e.ADD;return(t.modified()||e.changed(e.REM)||e.modified(Tt(n)))&&(h=(e=e.reflow(!0)).SOURCE,f=1/0,d=-1/0),e.visit(h,(t=>{const e=n(t);let i,s;null==e?(t[l]=null,r&&(t[u]=null)):(t[l]=i=s=o(e),r&&(t[u]=s=a(i,c)),i<f&&(f=i),s>d&&(d=s))})),o.start=f,o.stop=d,e.modifies(r?s:l)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:function(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(Pe(e))/n;let i,o,a=gr((t=>t[2])).right(fi,r);return a===fi.length?(i=ci,o=dn(e[0]/ri,e[1]/ri,n)):a?(a=fi[r/fi[a-1][2]<fi[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=ii,o=Math.max(dn(e[0],e[1],n),1)),{units:i,step:o}}({extent:t.extent||ke(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),o=Tr(r),a=this.value||{},s=(n?Xr:Yr)(o,i);return s.unit=Kt(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),Se(_l,ns,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let a=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),Se(wl,ns,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(Fa(t.sort)):e.source).map(t.field))}});const kl={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=kl.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||Rt("ntile num must be greater than zero.");const n=kl.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||Rt("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n)if(null!=t(e[n]))return n;return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}},Al=Object.keys(kl);function El(t){const e=de(t.ops),n=de(t.fields),r=de(t.params),i=de(t.as),o=this.outputs=[],a=this.windows=[],s={},l={},u=[],c=[];let f=!0;function d(t){de(Tt(t)).forEach((t=>s[t]=1))}d(t.sort),e.forEach(((t,e)=>{const s=n[e],h=Ft(s),p=as(t,h,i[e]);if(d(s),o.push(p),Ee(kl,t))a.push(function(t,e,n,r){const i=kl[t](e,n);return{init:i.init||Ut,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==s&&"count"!==t&&Rt("Null aggregate field specified."),"count"===t)return void u.push(p);f=!1;let e=l[h];e||(e=l[h]=[],e.field=s,c.push(e)),e.push(fs(t,p))}})),(u.length||c.length)&&(this.cell=function(t,e,n){t=t.map((t=>ys(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new t[a](r);if(r.store)var s=r.data=new vs;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,a;for(s&&s.values(),i=0,a=e.length;i<a;++i)t[e[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)o[t].init()},r}(c,u,f)),this.inputs=Object.keys(s)}const Ml=El.prototype;function Cl(t){ns.call(this,{},t),this._mlen=0,this._mods=[]}function Sl(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=t.data(n),l=s.length,u=o?gr(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||xe(-1)};e.init();for(let f=0;f<l;++f)Dl(c,a,f,l),o&&Fl(c,u),e.update(c,s[f])}function Dl(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Fl(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}function Tl(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Nl(t){this._context=t}function Ol(){}function zl(t){this._context=t}function Rl(t){this._context=t}function Pl(t,e){this._basis=new Nl(t),this._beta=e}Ml.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},Ml.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,o=r&&r.length;let a;if(n){for(a=t.p0;a<t.i0;++a)n.rem(i[a]);for(a=t.p1;a<t.i1;++a)n.add(i[a]);n.set(e)}for(a=0;a<o;++a)r[a].update(t,e)},Cl.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Al.concat(cs)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},Se(Cl,ns,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=Fa(t.sort),i=os(t.groupby),o=t=>this.group(i(t));let a=this.state;a&&!n||(a=this.state=new El(t)),n||e.modified(a.inputs)?(this.value={},e.visit(e.SOURCE,(t=>o(t).add(t)))):(e.visit(e.REM,(t=>o(t).remove(t))),e.visit(e.ADD,(t=>o(t).add(t))));for(let s=0,l=this._mlen;s<l;++s)Sl(this._mods[s],a,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(a.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=ws(Aa),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),Nl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Tl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Tl(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},zl.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Tl(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Rl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Tl(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Pl.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*a),this._beta*e[l]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const Bl=function t(e){function n(t){return 1===e?new Nl(t):new Pl(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Ll(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function jl(t,e){this._context=t,this._k=(1-e)/6}jl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ll(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Ll(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Ul=function t(e){function n(t){return new jl(t,e)}return n.tension=function(e){return t(+e)},n}(0);function ql(t,e){this._context=t,this._k=(1-e)/6}ql.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ll(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Il=function t(e){function n(t){return new ql(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Wl(t,e){this._context=t,this._k=(1-e)/6}Wl.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Ll(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const $l=function t(e){function n(t){return new Wl(t,e)}return n.tension=function(e){return t(+e)},n}(0),Hl=Math.abs,Zl=Math.atan2,Yl=Math.cos,Vl=Math.max,Gl=Math.min,Xl=Math.sin,Ql=Math.sqrt,Jl=1e-12,Kl=Math.PI,tu=Kl/2,eu=2*Kl;function nu(t){return t>=1?tu:t<=-1?-tu:Math.asin(t)}function ru(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>Jl){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>Jl){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function iu(t,e){this._context=t,this._alpha=e}iu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:ru(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const ou=function t(e){function n(t){return e?new iu(t,e):new jl(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function au(t,e){this._context=t,this._alpha=e}au.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:ru(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const su=function t(e){function n(t){return e?new au(t,e):new Wl(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function lu(t,e){this._context=t,this._alpha=e}lu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ru(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const uu=function t(e){function n(t){return e?new lu(t,e):new ql(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function cu(t){this._context=t}function fu(t){return new cu(t)}function du(t){this._context=t}function hu(t){return t<0?-1:1}function pu(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(hu(o)+hu(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function mu(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function gu(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function yu(t){this._context=t}function vu(t){this._context=new bu(t)}function bu(t){this._context=t}function xu(t){this._context=t}function _u(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function wu(t,e){this._context=t,this._t=e}function ku(t){return function(){return t}}cu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},du.prototype={areaStart:Ol,areaEnd:Ol,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},yu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gu(this,this._t0,mu(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,gu(this,mu(this,n=pu(this,t,e)),n);break;default:gu(this,this._t0,n=pu(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(vu.prototype=Object.create(yu.prototype)).point=function(t,e){yu.prototype.point.call(this,e,t)},bu.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},xu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=_u(t),i=_u(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},wu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const Au=Math.PI,Eu=2*Au,Mu=1e-6,Cu=Eu-Mu;function Su(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Du{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Su:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: ".concat(t));if(e>15)return Su;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append(r||(r=w(["M",",",""])),this._x0=this._x1=+t,this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(i||(i=w(["Z"]))))}lineTo(t,e){this._append(o||(o=w(["L",",",""])),this._x1=+t,this._y1=+e)}quadraticCurveTo(t,e,n,r){this._append(a||(a=w(["Q",",",",",",",""])),+t,+e,this._x1=+n,this._y1=+r)}bezierCurveTo(t,e,n,r,i,o){this._append(s||(s=w(["C",",",",",",",",",",",""])),+t,+e,+n,+r,this._x1=+i,this._y1=+o)}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let o=this._x1,a=this._y1,s=n-t,d=r-e,h=o-t,p=a-e,m=h*h+p*p;if(null===this._x1)this._append(l||(l=w(["M",",",""])),this._x1=t,this._y1=e);else if(m>Mu)if(Math.abs(p*s-d*h)>Mu&&i){let l=n-o,f=r-a,g=s*s+d*d,y=l*l+f*f,v=Math.sqrt(g),b=Math.sqrt(m),x=i*Math.tan((Au-Math.acos((g+m-y)/(2*v*b)))/2),_=x/b,k=x/v;Math.abs(_-1)>Mu&&this._append(u||(u=w(["L",",",""])),t+_*h,e+_*p),this._append(c||(c=w(["A",",",",0,0,",",",",",""])),i,i,+(p*l>h*f),this._x1=t+k*s,this._y1=e+k*d)}else this._append(f||(f=w(["L",",",""])),this._x1=t,this._y1=e)}arc(t,e,n,r,i,o){if(t=+t,e=+e,o=!!o,(n=+n)<0)throw new Error("negative radius: ".concat(n));let a=n*Math.cos(r),s=n*Math.sin(r),l=t+a,u=e+s,c=1^o,f=o?r-i:i-r;null===this._x1?this._append(d||(d=w(["M",",",""])),l,u):(Math.abs(this._x1-l)>Mu||Math.abs(this._y1-u)>Mu)&&this._append(h||(h=w(["L",",",""])),l,u),n&&(f<0&&(f=f%Eu+Eu),f>Cu?this._append(p||(p=w(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,c,t-a,e-s,n,n,c,this._x1=l,this._y1=u):f>Mu&&this._append(m||(m=w(["A",",",",0,",",",",",",",""])),n,n,+(f>=Au),c,this._x1=t+n*Math.cos(i),this._y1=e+n*Math.sin(i)))}rect(t,e,n,r){this._append(g||(g=w(["M",",","h","v","h","Z"])),this._x0=this._x1=+t,this._y0=this._y1=+e,n=+n,+r,-n)}toString(){return this._}}function Fu(){return new Du}function Tu(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: ".concat(n));e=t}return t},()=>new Du(e)}function Nu(t){return t.innerRadius}function Ou(t){return t.outerRadius}function zu(t){return t.startAngle}function Ru(t){return t.endAngle}function Pu(t){return t&&t.padAngle}function Bu(t,e,n,r,i,o,a){var s=t-n,l=e-r,u=(a?o:-o)/Ql(s*s+l*l),c=u*l,f=-u*s,d=t+c,h=e+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,v=p-d,b=m-h,x=v*v+b*b,_=i-o,w=d*m-p*h,k=(b<0?-1:1)*Ql(Vl(0,_*_*x-w*w)),A=(w*b-v*k)/x,E=(-w*v-b*k)/x,M=(w*b+v*k)/x,C=(-w*v+b*k)/x,S=A-g,D=E-y,F=M-g,T=C-y;return S*S+D*D>F*F+T*T&&(A=M,E=C),{cx:A,cy:E,x01:-c,y01:-f,x11:A*(i/_-1),y11:E*(i/_-1)}}function Lu(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function ju(t){return t[0]}function Uu(t){return t[1]}function qu(t,e){var n=ku(!0),r=null,i=fu,o=null,a=Tu(s);function s(s){var l,u,c,f=(s=Lu(s)).length,d=!1;for(null==r&&(o=i(c=a())),l=0;l<=f;++l)!(l<f&&n(u=s[l],l,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+t(u,l,s),+e(u,l,s));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?ju:ku(t),e="function"==typeof e?e:void 0===e?Uu:ku(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:ku(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s}function Iu(t,e,n){var r=null,i=ku(!0),o=null,a=fu,s=null,l=Tu(u);function u(u){var c,f,d,h,p,m=(u=Lu(u)).length,g=!1,y=new Array(m),v=new Array(m);for(null==o&&(s=a(p=l())),c=0;c<=m;++c){if(!(c<m&&i(h=u[c],c,u))===g)if(g=!g)f=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=f;--d)s.point(y[d],v[d]);s.lineEnd(),s.areaEnd()}g&&(y[c]=+t(h,c,u),v[c]=+e(h,c,u),s.point(r?+r(h,c,u):y[c],n?+n(h,c,u):v[c]))}if(p)return s=null,p+""||null}function c(){return qu().defined(i).curve(a).context(o)}return t="function"==typeof t?t:void 0===t?ju:ku(+t),e="function"==typeof e?e:ku(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?Uu:ku(+n),u.x=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ku(+t),u):r},u.y=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:ku(+t),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:ku(!!t),u):i},u.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),u):a},u.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),u):o},u}Fu.prototype=Du.prototype,Array.prototype.slice,Ql(3);const Wu={draw(t,e){const n=Ql(e/Kl);t.moveTo(n,0),t.arc(0,0,n,0,eu)}};function $u(t,e){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}Ql(1/3),Xl(Kl/10),Xl(7*Kl/10),Xl(eu/10),Yl(eu/10),Ql(3),Ql(3),Ql(3),Ql(12);const Hu=gr(P),Zu=Hu.right,Yu=Hu.left,Vu=(gr(I).center,Zu);function Gu(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Xu(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Qu(){}var Ju=.7,Ku=1/Ju,tc="\\s*([+-]?\\d+)\\s*",ec="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rc=/^#([0-9a-f]{3,8})$/,ic=new RegExp("^rgb\\(".concat(tc,",").concat(tc,",").concat(tc,"\\)$")),oc=new RegExp("^rgb\\(".concat(nc,",").concat(nc,",").concat(nc,"\\)$")),ac=new RegExp("^rgba\\(".concat(tc,",").concat(tc,",").concat(tc,",").concat(ec,"\\)$")),sc=new RegExp("^rgba\\(".concat(nc,",").concat(nc,",").concat(nc,",").concat(ec,"\\)$")),lc=new RegExp("^hsl\\(".concat(ec,",").concat(nc,",").concat(nc,"\\)$")),uc=new RegExp("^hsla\\(".concat(ec,",").concat(nc,",").concat(nc,",").concat(ec,"\\)$")),cc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function fc(){return this.rgb().formatHex()}function dc(){return this.rgb().formatRgb()}function hc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=rc.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?pc(e):3===n?new vc(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?mc(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?mc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ic.exec(t))?new vc(e[1],e[2],e[3],1):(e=oc.exec(t))?new vc(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ac.exec(t))?mc(e[1],e[2],e[3],e[4]):(e=sc.exec(t))?mc(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=lc.exec(t))?Ac(e[1],e[2]/100,e[3]/100,1):(e=uc.exec(t))?Ac(e[1],e[2]/100,e[3]/100,e[4]):cc.hasOwnProperty(t)?pc(cc[t]):"transparent"===t?new vc(NaN,NaN,NaN,0):null}function pc(t){return new vc(t>>16&255,t>>8&255,255&t,1)}function mc(t,e,n,r){return r<=0&&(t=e=n=NaN),new vc(t,e,n,r)}function gc(t){return t instanceof Qu||(t=hc(t)),t?new vc((t=t.rgb()).r,t.g,t.b,t.opacity):new vc}function yc(t,e,n,r){return 1===arguments.length?gc(t):new vc(t,e,n,null==r?1:r)}function vc(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function bc(){return"#".concat(kc(this.r)).concat(kc(this.g)).concat(kc(this.b))}function xc(){const t=_c(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(wc(this.r),", ").concat(wc(this.g),", ").concat(wc(this.b)).concat(1===t?")":", ".concat(t,")"))}function _c(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function kc(t){return((t=wc(t))<16?"0":"")+t.toString(16)}function Ac(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Cc(t,e,n,r)}function Ec(t){if(t instanceof Cc)return new Cc(t.h,t.s,t.l,t.opacity);if(t instanceof Qu||(t=hc(t)),!t)return new Cc;if(t instanceof Cc)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new Cc(a,s,l,t.opacity)}function Mc(t,e,n,r){return 1===arguments.length?Ec(t):new Cc(t,e,n,null==r?1:r)}function Cc(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Sc(t){return(t=(t||0)%360)<0?t+360:t}function Dc(t){return Math.max(0,Math.min(1,t||0))}function Fc(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Tc(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function Nc(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Tc((n-r/e)*e,a,i,o,s)}}function Oc(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return Tc((n-r/e)*e,i,o,a,s)}}Gu(Qu,hc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fc,formatHex:fc,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ec(this).formatHsl()},formatRgb:dc,toString:dc}),Gu(vc,yc,Xu(Qu,{brighter(t){return t=null==t?Ku:Math.pow(Ku,t),new vc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Ju:Math.pow(Ju,t),new vc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new vc(wc(this.r),wc(this.g),wc(this.b),_c(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bc,formatHex:bc,formatHex8:function(){return"#".concat(kc(this.r)).concat(kc(this.g)).concat(kc(this.b)).concat(kc(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:xc,toString:xc})),Gu(Cc,Mc,Xu(Qu,{brighter(t){return t=null==t?Ku:Math.pow(Ku,t),new Cc(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Ju:Math.pow(Ju,t),new Cc(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new vc(Fc(t>=240?t-240:t+120,i,r),Fc(t,i,r),Fc(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Cc(Sc(this.h),Dc(this.s),Dc(this.l),_c(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=_c(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(Sc(this.h),", ").concat(100*Dc(this.s),"%, ").concat(100*Dc(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const zc=t=>()=>t;function Rc(t,e){return function(n){return t+n*e}}function Pc(t,e){var n=e-t;return n?Rc(t,n>180||n<-180?n-360*Math.round(n/360):n):zc(isNaN(t)?e:t)}function Bc(t,e){var n=e-t;return n?Rc(t,n):zc(isNaN(t)?e:t)}const Lc=function t(e){var n=function(t){return 1==(t=+t)?Bc:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):zc(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=yc(t)).r,(e=yc(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Bc(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function jc(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=yc(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var Uc=jc(Nc),qc=jc(Oc);function Ic(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function Wc(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function $c(t,e){return(Wc(e)?Ic:Hc)(t,e)}function Hc(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Jc(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function Zc(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Yc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Vc(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Jc(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Gc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xc=new RegExp(Gc.source,"g");function Qc(t,e){var n,r,i,o=Gc.lastIndex=Xc.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=Gc.exec(t))&&(r=Xc.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Yc(n,r)})),o=Xc.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function Jc(t,e){var n,r=typeof e;return null==e||"boolean"===r?zc(e):("number"===r?Yc:"string"===r?(n=hc(e))?(e=n,Lc):Qc:e instanceof hc?Lc:e instanceof Date?Zc:Wc(e)?Ic:Array.isArray(e)?Hc:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Vc:Yc)(t,e)}function Kc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function tf(t){return+t}var ef=[0,1];function nf(t){return t}function rf(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function of(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=rf(i,r),o=n(a,o)):(r=rf(r,i),o=n(o,a)),function(t){return o(r(t))}}function af(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=rf(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Vu(t,e,1,r)-1;return o[n](i[n](e))}}function sf(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function lf(){var t,e,n,r,i,o,a=ef,s=ef,l=Jc,u=nf;function c(){var t=Math.min(a.length,s.length);return u!==nf&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(a[0],a[t-1])),r=t>2?af:of,i=o=null,f}function f(e){return null==e||isNaN(e=+e)?n:(i||(i=r(a.map(t),s,l)))(t(u(e)))}return f.invert=function(n){return u(e((o||(o=r(s,a.map(t),Yc)))(n)))},f.domain=function(t){return arguments.length?(a=Array.from(t,tf),c()):a.slice()},f.range=function(t){return arguments.length?(s=Array.from(t),c()):s.slice()},f.rangeRound=function(t){return s=Array.from(t),l=Kc,c()},f.clamp=function(t){return arguments.length?(u=!!t||nf,c()):u!==nf},f.interpolate=function(t){return arguments.length?(l=t,c()):l},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,c()}}function uf(){return lf()(nf,nf)}function cf(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function ff(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}function df(t,e,n,r){var i,o=dn(t,e,n);switch((r=mn(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=bn(o,a))||(r.precision=i),Cn(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=xn(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=_n(o))||(r.precision=i-2*("%"===r.type))}return Mn(r)}function hf(t){var e=t.domain;return t.ticks=function(t){var n=e();return cn(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return df(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,s=o.length-1,l=o[a],u=o[s],c=10;for(u<l&&(i=l,l=u,u=i,i=a,a=s,s=i);c-- >0;){if((i=fn(l,u,n))===r)return o[a]=l,o[s]=u,e(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function pf(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}function mf(t){return Math.log(t)}function gf(t){return Math.exp(t)}function yf(t){return-Math.log(-t)}function vf(t){return-Math.exp(-t)}function bf(t){return isFinite(t)?+("1e"+t):t<0?0:t}function xf(t){return(e,n)=>-t(-e,n)}function _f(t){const e=t(mf,gf),n=e.domain;let r,i,o=10;function a(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(o),i=function(t){return 10===t?bf:t===Math.E?Math.exp:e=>Math.pow(t,e)}(o),n()[0]<0?(r=xf(r),i=xf(i),t(yf,vf)):t(mf,gf),e}return e.base=function(t){return arguments.length?(o=+t,a()):o},e.domain=function(t){return arguments.length?(n(t),a()):n()},e.ticks=t=>{const e=n();let a=e[0],s=e[e.length-1];const l=s<a;l&&([a,s]=[s,a]);let u,c,f=r(a),d=r(s);const h=null==t?10:+t;let p=[];if(!(o%1)&&d-f<h){if(f=Math.floor(f),d=Math.ceil(d),a>0){for(;f<=d;++f)for(u=1;u<o;++u)if(c=f<0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}}else for(;f<=d;++f)for(u=o-1;u>=1;--u)if(c=f>0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}2*p.length<h&&(p=cn(a,s,h))}else p=cn(f,d,Math.min(d-f,h)).map(i);return l?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=mn(n)).precision||(n.trim=!0),n=Mn(n)),t===1/0)return n;const a=Math.max(1,o*t/e.ticks().length);return t=>{let e=t/i(Math.round(r(t)));return e*o<o-.5&&(e*=o),e<=a?n(t):""}},e.nice=()=>n(pf(n(),{floor:t=>i(Math.floor(r(t))),ceil:t=>i(Math.ceil(r(t)))})),e}function wf(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function kf(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Af(t){return t<0?-t*t:t*t}function Ef(t){var e=t(nf,nf),n=1;return e.exponent=function(e){return arguments.length?1==(n=+e)?t(nf,nf):.5===n?t(kf,Af):t(wf(n),wf(1/n)):n},hf(e)}function Mf(){var t=Ef(lf());return t.copy=function(){return sf(t,Mf()).exponent(t.exponent())},cf.apply(t,arguments),t}function Cf(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Sf(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Df(t){var e=1,n=t(Cf(e),Sf(e));return n.constant=function(n){return arguments.length?t(Cf(e=+n),Sf(e)):e},hf(n)}function Ff(t,e,n,r,i,o){const a=[[hr,1,zn],[hr,5,5e3],[hr,15,15e3],[hr,30,3e4],[o,1,Rn],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,Pn],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,Bn],[r,2,1728e5],[n,1,Ln],[e,1,2592e6],[e,3,7776e6],[t,1,jn]];function s(e,n,r){const i=Math.abs(n-e)/r,o=gr((t=>{let[,,e]=t;return e})).right(a,i);if(o===a.length)return t.every(dn(e/jn,n/jn,r));if(0===o)return pr.every(Math.max(dn(e,n,r),1));const[s,l]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(l)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"==typeof n.range?n:s(t,e,n),o=i?i.range(t,+e+1):[];return r?o.reverse():o},s]}const[Tf,Nf]=Ff(ar,lr,Jn,In,cr,dr),[Of,zf]=Ff(or,sr,$n,Un,ur,fr);function Rf(t){return new Date(t)}function Pf(t){return t instanceof Date?+t:+new Date(+t)}function Bf(t,e,n,r,i,o,a,s,l,u){var c=uf(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),v=u("%b %d"),b=u("%B"),x=u("%Y");function _(t){return(l(t)<t?h:s(t)<t?p:a(t)<t?m:o(t)<t?g:r(t)<t?i(t)<t?y:v:n(t)<t?b:x)(t)}return c.invert=function(t){return new Date(f(t))},c.domain=function(t){return arguments.length?d(Array.from(t,Pf)):d().map(Rf)},c.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},c.tickFormat=function(t,e){return null==e?_:u(e)},c.nice=function(t){var n=d();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(pf(n,t)):c},c.copy=function(){return sf(c,Bf(t,e,n,r,i,o,a,s,l,u))},c}function Lf(){return cf.apply(Bf(Of,zf,or,sr,$n,Un,ur,fr,hr,yi).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function jf(){var t,e,n,r,i,o=0,a=1,s=nf,l=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([o,a]=i,t=r(o=+o),e=r(a=+a),n=t===e?0:1/(e-t),u):[o,a]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=c(Jc),u.rangeRound=c(Kc),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),u}}function Uf(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function qf(){var t=hf(jf()(nf));return t.copy=function(){return Uf(t,qf())},ff.apply(t,arguments)}function If(){var t=Ef(jf());return t.copy=function(){return Uf(t,If()).exponent(t.exponent())},ff.apply(t,arguments)}function Wf(t,e){void 0===e&&(e=t,t=Jc);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function $f(){var t,e,n,r,i,o,a,s=0,l=.5,u=1,c=1,f=nf,d=!1;function h(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(c*t<c*e?r:i),f(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,f=Wf(t,[n,r,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(a){return arguments.length?([s,l,u]=a,t=o(s=+s),e=o(l=+l),n=o(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,h):[s,l,u]},h.clamp=function(t){return arguments.length?(d=!!t,h):d},h.interpolator=function(t){return arguments.length?(f=t,h):f},h.range=p(Jc),h.rangeRound=p(Kc),h.unknown=function(t){return arguments.length?(a=t,h):a},function(a){return o=a,t=a(s),e=a(l),n=a(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,h}}function Hf(){var t=Ef($f());return t.copy=function(){return Uf(t,Hf()).exponent(t.exponent())},ff.apply(t,arguments)}class Zf extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qf;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(Vf(this,t))}has(t){return super.has(Vf(this,t))}set(t,e){return super.set(Gf(this,t),e)}delete(t){return super.delete(Xf(this,t))}}class Yf extends Set{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qf;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const n of t)this.add(n)}has(t){return super.has(Vf(this,t))}add(t){return super.add(Gf(this,t))}delete(t){return super.delete(Xf(this,t))}}function Vf(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function Gf(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function Xf(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function Qf(t){return null!==t&&"object"==typeof t?t.valueOf():t}const Jf=Symbol("implicit");function Kf(){var t=new Zf,e=[],n=[],r=Jf;function i(i){let o=t.get(i);if(void 0===o){if(r!==Jf)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Zf;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Kf(e,n).unknown(r)},cf.apply(i,arguments),i}function td(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function ed(t,e){var n=Pc(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}var nd,rd=180/Math.PI,id={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function od(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*rd,skewX:Math.atan(l)*rd,scaleX:a,scaleY:s}}function ad(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:Yc(t,i)},{i:l-2,x:Yc(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Yc(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Yc(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Yc(t,n)},{i:s-2,x:Yc(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var sd=ad((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?id:od(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ld=ad((function(t){return null==t?id:(nd||(nd=document.createElementNS("http://www.w3.org/2000/svg","g")),nd.setAttribute("transform",t),(t=nd.transform.baseVal.consolidate())?od((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):id)}),", ",")",")");function ud(t){return((t=Math.exp(t))+1/t)/2}const cd=function t(e,n,r){function i(t,i){var o,a,s=t[0],l=t[1],u=t[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-l,m=h*h+p*p;if(m<1e-12)a=Math.log(d/u)/e,o=function(t){return[s+t*h,l+t*p,u*Math.exp(e*t*a)]};else{var g=Math.sqrt(m),y=(d*d-u*u+r*m)/(2*u*n*g),v=(d*d-u*u-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-b)/e,o=function(t){var r=t*a,i=ud(b),o=u/(n*g)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+o*h,l+o*p,u*i/ud(e*r+b)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function fd(t){return function(e,n){var r=t((e=Mc(e)).h,(n=Mc(n)).h),i=Bc(e.s,n.s),o=Bc(e.l,n.l),a=Bc(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}const dd=fd(Pc);var hd=fd(Bc);const pd=Math.PI/180,md=180/Math.PI,gd=.96422,yd=1,vd=.82521,bd=4/29,xd=6/29,_d=3*xd*xd,wd=.008856451679035631;function kd(t){if(t instanceof Ed)return new Ed(t.l,t.a,t.b,t.opacity);if(t instanceof Td)return Nd(t);t instanceof vc||(t=gc(t));var e,n,r=Dd(t.r),i=Dd(t.g),o=Dd(t.b),a=Md((.2225045*r+.7168786*i+.0606169*o)/yd);return r===i&&i===o?e=n=a:(e=Md((.4360747*r+.3850649*i+.1430804*o)/gd),n=Md((.0139322*r+.0971045*i+.7141733*o)/vd)),new Ed(116*a-16,500*(e-a),200*(a-n),t.opacity)}function Ad(t,e,n,r){return 1===arguments.length?kd(t):new Ed(t,e,n,null==r?1:r)}function Ed(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Md(t){return t>wd?Math.pow(t,1/3):t/_d+bd}function Cd(t){return t>xd?t*t*t:_d*(t-bd)}function Sd(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Dd(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Fd(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Td)return new Td(t.h,t.c,t.l,t.opacity);if(t instanceof Ed||(t=kd(t)),0===t.a&&0===t.b)return new Td(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*md;return new Td(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new Td(t,e,n,null==r?1:r)}function Td(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Nd(t){if(isNaN(t.h))return new Ed(t.l,0,0,t.opacity);var e=t.h*pd;return new Ed(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Od(t,e){var n=Bc((t=Ad(t)).l,(e=Ad(e)).l),r=Bc(t.a,e.a),i=Bc(t.b,e.b),o=Bc(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function zd(t){return function(e,n){var r=t((e=Fd(e)).h,(n=Fd(n)).h),i=Bc(e.c,n.c),o=Bc(e.l,n.l),a=Bc(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}Gu(Ed,Ad,Xu(Qu,{brighter(t){return new Ed(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new Ed(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new vc(Sd(3.1338561*(e=gd*Cd(e))-1.6168667*(t=yd*Cd(t))-.4906146*(n=vd*Cd(n))),Sd(-.9787684*e+1.9161415*t+.033454*n),Sd(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Gu(Td,Fd,Xu(Qu,{brighter(t){return new Td(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Td(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Nd(this).rgb()}}));const Rd=zd(Pc);var Pd=zd(Bc),Bd=-.14861,Ld=1.78277,jd=-.29227,Ud=-.90649,qd=1.97294,Id=qd*Ud,Wd=qd*Ld,$d=Ld*jd-Ud*Bd;function Hd(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Zd)return new Zd(t.h,t.s,t.l,t.opacity);t instanceof vc||(t=gc(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=($d*r+Id*e-Wd*n)/($d+Id-Wd),o=r-i,a=(qd*(n-i)-jd*o)/Ud,s=Math.sqrt(a*a+o*o)/(qd*i*(1-i)),l=s?Math.atan2(a,o)*md-120:NaN;return new Zd(l<0?l+360:l,s,i,t.opacity)}(t):new Zd(t,e,n,null==r?1:r)}function Zd(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Yd(t){return function e(n){function r(e,r){var i=t((e=Hd(e)).h,(r=Hd(r)).h),o=Bc(e.s,r.s),a=Bc(e.l,r.l),s=Bc(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Gu(Zd,Hd,Xu(Qu,{brighter(t){return t=null==t?Ku:Math.pow(Ku,t),new Zd(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Ju:Math.pow(Ju,t),new Zd(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*pd,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new vc(255*(e+n*(Bd*r+Ld*i)),255*(e+n*(jd*r+Ud*i)),255*(e+n*(qd*r)),this.opacity)}}));const Vd=Yd(Pc);var Gd=Yd(Bc);function Xd(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function Qd(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const Jd="linear",Kd="log",th="pow",eh="sqrt",nh="symlog",rh="time",ih="utc",oh="sequential",ah="diverging",sh="quantile",lh="quantize",uh="threshold",ch="ordinal",fh="point",dh="band",hh="bin-ordinal",ph="continuous",mh="discrete",gh="discretizing",yh="interpolating",vh="temporal";function bh(){const t=Kf().unknown(void 0),e=t.domain,n=t.range;let r,i,o=[0,1],a=!1,s=0,l=0,u=.5;function c(){const t=e().length,c=o[1]<o[0],f=o[1-c],d=Qd(t,s,l);let h=o[c-0];r=(f-h)/(d||1),a&&(r=Math.floor(r)),h+=(f-h-r*(t-s))*u,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const p=is(t).map((t=>h+r*t));return n(c?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),c()):e()},t.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},t.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,c()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(a=!!t,c()):a},t.padding=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),s=l,c()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),c()):s},t.paddingOuter=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let l,u,c,f=+t[0],d=+t[1];return f!=f||d!=d||(d<f&&(c=f,f=d,d=c),d<a[0]||f>o[1-r])?void 0:(l=Math.max(0,Zu(a,f)-1),u=f===d?l:Zu(a,d)-1,f-a[l]>i+1e-10&&++l,r&&(c=l,l=s-u,u=s-c),l>u?void 0:e().slice(l,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return bh().domain(e()).range(o).round(a).paddingInner(s).paddingOuter(l).align(u)},c()}function xh(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return xh(e())},t}var _h=Array.prototype.map;const wh=Array.prototype.slice,kh=new Map,Ah=Symbol("vega_scale");function Eh(t){return t[Ah]=!0,t}function Mh(t,e,n){return arguments.length>1?(kh.set(t,function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,o,a,s=e[0],l=e[1],u=-1;for(l<s&&(i=s,s=l,l=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=l&&(u<0&&(u=o),r=o);if(!(u<0))return s=t.invertExtent(n[u]),l=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=t,Eh(n)};return r.metadata=Ie(de(n)),r}(t,e,n)),this):Ch(t)?kh.get(t):void 0}function Ch(t){return kh.has(t)}function Sh(t,e){const n=kh.get(t);return n&&n.metadata[e]}function Dh(t){return Sh(t,ph)}function Fh(t){return Sh(t,mh)}function Th(t){return Sh(t,gh)}function Nh(t){return Sh(t,Kd)}function Oh(t){return Sh(t,yh)}function zh(t){return Sh(t,sh)}Mh("identity",(function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,tf),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,tf):[0,1],hf(r)})),Mh(Jd,(function t(){var e=uf();return e.copy=function(){return sf(e,t())},cf.apply(e,arguments),hf(e)}),ph),Mh(Kd,(function t(){const e=_f(lf()).domain([1,10]);return e.copy=()=>sf(e,t()).base(e.base()),cf.apply(e,arguments),e}),[ph,Kd]),Mh(th,Mf,ph),Mh(eh,(function(){return Mf.apply(null,arguments).exponent(.5)}),ph),Mh(nh,(function t(){var e=Df(lf());return e.copy=function(){return sf(e,t()).constant(e.constant())},cf.apply(e,arguments)}),ph),Mh(rh,Lf,[ph,vh]),Mh(ih,(function(){return cf.apply(Bf(Tf,Nf,ar,lr,Jn,qn,cr,dr,hr,bi).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[ph,vh]),Mh(oh,qf,[ph,yh]),Mh("".concat(oh,"-").concat(Jd),qf,[ph,yh]),Mh("".concat(oh,"-").concat(Kd),(function t(){var e=_f(jf()).domain([1,10]);return e.copy=function(){return Uf(e,t()).base(e.base())},ff.apply(e,arguments)}),[ph,yh,Kd]),Mh("".concat(oh,"-").concat(th),If,[ph,yh]),Mh("".concat(oh,"-").concat(eh),(function(){return If.apply(null,arguments).exponent(.5)}),[ph,yh]),Mh("".concat(oh,"-").concat(nh),(function t(){var e=Df(jf());return e.copy=function(){return Uf(e,t()).constant(e.constant())},ff.apply(e,arguments)}),[ph,yh]),Mh("".concat(ah,"-").concat(Jd),(function t(){var e=hf($f()(nf));return e.copy=function(){return Uf(e,t())},ff.apply(e,arguments)}),[ph,yh]),Mh("".concat(ah,"-").concat(Kd),(function t(){var e=_f($f()).domain([.1,1,10]);return e.copy=function(){return Uf(e,t()).base(e.base())},ff.apply(e,arguments)}),[ph,yh,Kd]),Mh("".concat(ah,"-").concat(th),Hf,[ph,yh]),Mh("".concat(ah,"-").concat(eh),(function(){return Hf.apply(null,arguments).exponent(.5)}),[ph,yh]),Mh("".concat(ah,"-").concat(nh),(function t(){var e=Df($f());return e.copy=function(){return Uf(e,t()).constant(e.constant())},ff.apply(e,arguments)}),[ph,yh]),Mh(sh,(function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=$(n,t/e);return a}function a(t){return null==t||isNaN(t=+t)?e:r[Vu(i,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(P),o()},a.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return i.slice()},a.copy=function(){return t().domain(n).range(r).unknown(e)},cf.apply(a,arguments)}),[gh,sh]),Mh(lh,(function t(){var e,n=0,r=1,i=1,o=[.5],a=[0,1];function s(t){return null!=t&&t<=t?a[Vu(o,t,0,i)]:e}function l(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,l()):[n,r]},s.range=function(t){return arguments.length?(i=(a=Array.from(t)).length-1,l()):a.slice()},s.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(a).unknown(e)},cf.apply(hf(s),arguments)}),gh),Mh(uh,(function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return null!=t&&t<=t?r[Vu(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},cf.apply(o,arguments)}),gh),Mh(hh,(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Vu(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return _h.call(t,te)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=wh.call(t),r):n.slice()},r.tickFormat=function(t,n){return df(e[0],Kt(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[mh,gh]),Mh(ch,Kf,mh),Mh(dh,bh,mh),Mh(fh,(function(){return xh(bh().paddingInner(1))}),mh);const Rh=["clamp","base","constant","exponent"];function Ph(t,e,n){return Wf(Lh(e||"rgb",n),t)}function Bh(t,e,n){const r=n-e;let i,o,a;return r&&Number.isFinite(r)?(i=(o=t.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=Mh(o)().domain([e,n]).range([0,1]),Rh.forEach((e=>t[e]?a[e](t[e]()):0)),a):xe(.5)}function Lh(t,n){const r=e[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=n&&r&&r.gamma?r.gamma(n):r}function jh(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Uh(t,e){for(const n in t)Ih(n,e(t[n]))}const qh={};function Ih(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(qh[t]=e,this):qh[t]}Uh({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},jh),Uh({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>Ph(jh(t))));const Wh="symbol",$h="discrete",Hh=t=>Qt(t)?t.map((t=>String(t))):String(t),Zh=(t,e)=>t[1]-e[1],Yh=(t,e)=>e[1]-t[1];function Vh(t,e,n){let r;return Ne(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(Pe(t.domain())/n||1)))),Jt(e)&&(r=e.step,e=e.interval),Oe(e)&&(e=t.type===rh?Kr(e):t.type==ih?ti(e):Rt("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function Gh(t,e,n){let r=t.range(),i=r[0],o=Kt(r),a=Zh;if(i>o&&(r=o,o=i,i=r,a=Yh),i=Math.floor(i),o=Math.ceil(o),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=o)).sort(a).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],Kt(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function Xh(t,e){return t.bins?Gh(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Qh(t,e,n,r,i,o){const a=e.type;let s=Hh;if(a===rh||i===rh)s=t.timeFormat(r);else if(a===ih||i===ih)s=t.utcFormat(r);else if(Nh(a)){const i=t.formatFloat(r);if(o||e.bins)s=i;else{const t=Jh(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function Jh(t,e,n){const r=Xh(t,e),i=t.base(),o=Math.log(i),a=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=a};return n?r.filter(s):s}const Kh={[sh]:"quantiles",[lh]:"thresholds",[uh]:"domain"},tp={[sh]:"quantiles",[lh]:"domain"};function ep(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=Kt(t),e}(t.bins):t.type===Kd?Jh(t,e,!0):Kh[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Kh[t.type]]()):Xh(t,e)}const np=t=>Kh[t.type]||t.bins;function rp(t,e,n,r,i,o,a){const s=tp[e.type]&&o!==rh&&o!==ih?function(t,e,n){const r=e[tp[e.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return t.formatSpan(0,a,30,n)}(t,e,i):Qh(t,e,n,i,o,a);return r===Wh&&np(e)?ip(s):r===$h?ap(s):sp(s)}const ip=t=>(e,n,r)=>{const i=op(r[n+1],op(r.max,1/0)),o=lp(e,t),a=lp(i,t);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},op=(t,e)=>null!=t?t:e,ap=t=>(e,n)=>n?t(e):null,sp=t=>e=>t(e),lp=(t,e)=>Number.isFinite(t)?e(t):null;function up(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(t,e,n,r){const i=r||e.type;return Oe(n)&&function(t){return Sh(t,vh)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==rh?n||i!==ih?rp(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}(t,e,n.format,n.formatType);if(Th(e.type)){const t=ep(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Fh(e.type)){const t=e.domain(),n=t.length;return"".concat(n," value").concat(1===n?"":"s",": ").concat(n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", "))}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(Kt(t)))}}let cp=0;const fp="p_";function dp(t){return t&&t.gradient}function hp(t,e,n){const r=t.gradient;let i=t.id,o="radial"===r?fp:"";return i||(i=t.id="gradient_"+cp++,"radial"===r?(t.x1=pp(t.x1,.5),t.y1=pp(t.y1,.5),t.r1=pp(t.r1,0),t.x2=pp(t.x2,.5),t.y2=pp(t.y2,.5),t.r2=pp(t.r2,.5),o=fp):(t.x1=pp(t.x1,0),t.y1=pp(t.y1,0),t.x2=pp(t.x2,1),t.y2=pp(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+o+i+")"}function pp(t,e){return null!=t?t:e}const mp={basis:{curve:function(t){return new Nl(t)}},"basis-closed":{curve:function(t){return new zl(t)}},"basis-open":{curve:function(t){return new Rl(t)}},bundle:{curve:Bl,tension:"beta",value:.85},cardinal:{curve:Ul,tension:"tension",value:0},"cardinal-open":{curve:Il,tension:"tension",value:0},"cardinal-closed":{curve:$l,tension:"tension",value:0},"catmull-rom":{curve:ou,tension:"alpha",value:.5},"catmull-rom-closed":{curve:su,tension:"alpha",value:.5},"catmull-rom-open":{curve:uu,tension:"alpha",value:.5},linear:{curve:fu},"linear-closed":{curve:function(t){return new du(t)}},monotone:{horizontal:function(t){return new vu(t)},vertical:function(t){return new yu(t)}},natural:{curve:function(t){return new xu(t)}},step:{curve:function(t){return new wu(t,.5)}},"step-after":{curve:function(t){return new wu(t,1)}},"step-before":{curve:function(t){return new wu(t,0)}}};function gp(t,e,n){var r=Ee(mp,t)&&mp[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const yp={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},vp=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,bp=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,xp=/^((\s+,?\s*)|(,\s*))/,_p=/^[01]/;function wp(t){const e=[];return(t.match(vp)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=yp[r],o=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let o=0;o<e;++o){const e="a"!==t||3!==o&&4!==o?bp:_p,a=n.slice(i).match(e);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(xp);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),a=o.length;if(a<i||a&&a%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<a;t+=i)e.push([n,...o.slice(t,t+i)])}})),e}const kp=Math.PI/180,Ap=Math.PI/2,Ep=2*Math.PI,Mp=Math.sqrt(3)/2;var Cp={},Sp={},Dp=[].join;function Fp(t){const e=Dp.call(t);if(Sp[e])return Sp[e];var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7];const c=u*a,f=-l*s,d=l*a,h=u*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),_=n+p-x*m,w=r+m+x*p,k=n+g,A=r+y,E=k+x*y,M=A-x*g;return Sp[e]=[c*_+f*w,d*_+h*w,c*E+f*M,d*E+h*M,c*k+f*A,d*k+h*A]}const Tp=["l",0,0,0,0,0,0,0];function Np(t,e,n){const r=Tp[0]=t[0];if("a"===r||"A"===r)Tp[1]=e*t[1],Tp[2]=n*t[2],Tp[3]=t[3],Tp[4]=t[4],Tp[5]=t[5],Tp[6]=e*t[6],Tp[7]=n*t[7];else if("h"===r||"H"===r)Tp[1]=e*t[1];else if("v"===r||"V"===r)Tp[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)Tp[i]=(i%2==1?e:n)*t[i];return Tp}function Op(t,e,n,r,i,o){var a,s,l,u,c,f=null,d=0,h=0,p=0,m=0,g=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var v=0,b=e.length;v<b;++v){switch(a=e[v],1===i&&1===o||(a=Np(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],t.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],t.lineTo(d+n,h+r);break;case"h":d+=a[1],t.lineTo(d+n,h+r);break;case"H":d=a[1],t.lineTo(d+n,h+r);break;case"v":h+=a[1],t.lineTo(d+n,h+r);break;case"V":h=a[1],t.lineTo(d+n,h+r);break;case"m":g=d+=a[1],y=h+=a[2],t.moveTo(d+n,h+r);break;case"M":g=d=a[1],y=h=a[2],t.moveTo(d+n,h+r);break;case"c":s=d+a[5],l=h+a[6],p=d+a[3],m=h+a[4],t.bezierCurveTo(d+a[1]+n,h+a[2]+r,p+n,m+r,s+n,l+r),d=s,h=l;break;case"C":d=a[5],h=a[6],p=a[3],m=a[4],t.bezierCurveTo(a[1]+n,a[2]+r,p+n,m+r,d+n,h+r);break;case"s":s=d+a[3],l=h+a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,d+a[1]+n,h+a[2]+r,s+n,l+r),p=d+a[1],m=h+a[2],d=s,h=l;break;case"S":s=a[3],l=a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"q":s=d+a[3],l=h+a[4],p=d+a[1],m=h+a[2],t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"Q":s=a[3],l=a[4],t.quadraticCurveTo(a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"t":s=d+a[1],l=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,m=h):"t"===f[0]?(p=2*d-u,m=2*h-c):"q"===f[0]&&(p=2*d-p,m=2*h-m),u=p,c=m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),h=l,p=(d=s)+a[1],m=h+a[2];break;case"T":s=a[1],l=a[2],p=2*d-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"a":zp(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":zp(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=g,h=y,t.closePath()}f=a}}function zp(t,e,n,r){const i=function(t,e,n,r,i,o,a,s,l){const u=Dp.call(arguments);if(Cp[u])return Cp[u];const c=a*kp,f=Math.sin(c),d=Math.cos(c),h=d*(s-t)*.5+f*(l-e)*.5,p=d*(l-e)*.5-f*(s-t)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=d/n,y=f/n,v=-f/r,b=d/r,x=g*s+y*l,_=v*s+b*l,w=g*t+y*e,k=v*t+b*e;let A=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;A<0&&(A=0);let E=Math.sqrt(A);o==i&&(E=-E);const M=.5*(x+w)-E*(k-_),C=.5*(_+k)+E*(w-x),S=Math.atan2(_-C,x-M);let D=Math.atan2(k-C,w-M)-S;D<0&&1===o?D+=Ep:D>0&&0===o&&(D-=Ep);const F=Math.ceil(Math.abs(D/(Ap+.001))),T=[];for(let N=0;N<F;++N){const t=S+N*D/F,e=S+(N+1)*D/F;T[N]=[M,C,t,e,n,r,f,d]}return Cp[u]=T}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let o=0;o<i.length;++o){const e=Fp(i[o]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const Rp=.5773502691896257,Pp={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,Ep)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n,i=r-n*Rp,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n,i=r-n*Rp;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Mp*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};var Bp={};const Lp=.448084975506;function jp(t){return t.x}function Up(t){return t.y}function qp(t){return t.width}function Ip(t){return t.height}function Wp(t){return"function"==typeof t?t:()=>+t}function $p(t,e,n){return Math.max(e,Math.min(t,n))}function Hp(t,e){return null!=t?t:e}const Zp=t=>t.x||0,Yp=t=>t.y||0,Vp=t=>!(!1===t.defined),Gp=function(){var t=Nu,e=Ou,n=ku(0),r=null,i=zu,o=Ru,a=Pu,s=null,l=Tu(u);function u(){var u,c,f=+t.apply(this,arguments),d=+e.apply(this,arguments),h=i.apply(this,arguments)-tu,p=o.apply(this,arguments)-tu,m=Hl(p-h),g=p>h;if(s||(s=u=l()),d<f&&(c=d,d=f,f=c),d>Jl)if(m>eu-Jl)s.moveTo(d*Yl(h),d*Xl(h)),s.arc(0,0,d,h,p,!g),f>Jl&&(s.moveTo(f*Yl(p),f*Xl(p)),s.arc(0,0,f,p,h,g));else{var y,v,b=h,x=p,_=h,w=p,k=m,A=m,E=a.apply(this,arguments)/2,M=E>Jl&&(r?+r.apply(this,arguments):Ql(f*f+d*d)),C=Gl(Hl(d-f)/2,+n.apply(this,arguments)),S=C,D=C;if(M>Jl){var F=nu(M/f*Xl(E)),T=nu(M/d*Xl(E));(k-=2*F)>Jl?(_+=F*=g?1:-1,w-=F):(k=0,_=w=(h+p)/2),(A-=2*T)>Jl?(b+=T*=g?1:-1,x-=T):(A=0,b=x=(h+p)/2)}var N=d*Yl(b),O=d*Xl(b),z=f*Yl(w),R=f*Xl(w);if(C>Jl){var P,B=d*Yl(x),L=d*Xl(x),j=f*Yl(_),U=f*Xl(_);if(m<Kl)if(P=function(t,e,n,r,i,o,a,s){var l=n-t,u=r-e,c=a-i,f=s-o,d=f*l-c*u;if(!(d*d<Jl))return[t+(d=(c*(e-o)-f*(t-i))/d)*l,e+d*u]}(N,O,j,U,B,L,z,R)){var q=N-P[0],I=O-P[1],W=B-P[0],$=L-P[1],H=1/Xl(function(t){return t>1?0:t<-1?Kl:Math.acos(t)}((q*W+I*$)/(Ql(q*q+I*I)*Ql(W*W+$*$)))/2),Z=Ql(P[0]*P[0]+P[1]*P[1]);S=Gl(C,(f-Z)/(H-1)),D=Gl(C,(d-Z)/(H+1))}else S=D=0}A>Jl?D>Jl?(y=Bu(j,U,N,O,d,D,g),v=Bu(B,L,z,R,d,D,g),s.moveTo(y.cx+y.x01,y.cy+y.y01),D<C?s.arc(y.cx,y.cy,D,Zl(y.y01,y.x01),Zl(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,D,Zl(y.y01,y.x01),Zl(y.y11,y.x11),!g),s.arc(0,0,d,Zl(y.cy+y.y11,y.cx+y.x11),Zl(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,D,Zl(v.y11,v.x11),Zl(v.y01,v.x01),!g))):(s.moveTo(N,O),s.arc(0,0,d,b,x,!g)):s.moveTo(N,O),f>Jl&&k>Jl?S>Jl?(y=Bu(z,R,B,L,f,-S,g),v=Bu(N,O,j,U,f,-S,g),s.lineTo(y.cx+y.x01,y.cy+y.y01),S<C?s.arc(y.cx,y.cy,S,Zl(y.y01,y.x01),Zl(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,S,Zl(y.y01,y.x01),Zl(y.y11,y.x11),!g),s.arc(0,0,f,Zl(y.cy+y.y11,y.cx+y.x11),Zl(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,S,Zl(v.y11,v.x11),Zl(v.y01,v.x01),!g))):s.arc(0,0,f,w,_,g):s.lineTo(z,R)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Kl/2;return[Yl(r)*n,Xl(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ku(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ku(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ku(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:ku(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:ku(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:ku(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),Xp=Iu().x(Zp).y1(Yp).y0((t=>(t.y||0)+(t.height||0))).defined(Vp),Qp=Iu().y(Yp).x1(Zp).x0((t=>(t.x||0)+(t.width||0))).defined(Vp),Jp=qu().x(Zp).y(Yp).defined(Vp),Kp=function(){var t=jp,e=Up,n=qp,r=Ip,i=Wp(0),o=i,a=i,s=i,l=null;function u(u,c,f){var d,h=null!=c?c:+t.call(this,u),p=null!=f?f:+e.call(this,u),m=+n.call(this,u),g=+r.call(this,u),y=Math.min(m,g)/2,v=$p(+i.call(this,u),0,y),b=$p(+o.call(this,u),0,y),x=$p(+a.call(this,u),0,y),_=$p(+s.call(this,u),0,y);if(l||(l=d=Fu()),v<=0&&b<=0&&x<=0&&_<=0)l.rect(h,p,m,g);else{var w=h+m,k=p+g;l.moveTo(h+v,p),l.lineTo(w-b,p),l.bezierCurveTo(w-Lp*b,p,w,p+Lp*b,w,p+b),l.lineTo(w,k-_),l.bezierCurveTo(w,k-Lp*_,w-Lp*_,k,w-_,k),l.lineTo(h+x,k),l.bezierCurveTo(h+Lp*x,k,h,k-Lp*x,h,k-x),l.lineTo(h,p+v),l.bezierCurveTo(h,p+Lp*v,h+Lp*v,p,h+v,p),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(e){return arguments.length?(t=Wp(e),u):t},u.y=function(t){return arguments.length?(e=Wp(t),u):e},u.width=function(t){return arguments.length?(n=Wp(t),u):n},u.height=function(t){return arguments.length?(r=Wp(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=Wp(t),o=null!=e?Wp(e):i,s=null!=n?Wp(n):i,a=null!=r?Wp(r):o,u):i},u.context=function(t){return arguments.length?(l=null==t?null:t,u):l},u}().x(Zp).y(Yp).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Hp(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Hp(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Hp(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Hp(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),tm=function(t,e){let n=null,r=Tu(i);function i(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"==typeof t?t:ku(t||Wu),e="function"==typeof e?e:ku(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"==typeof e?e:ku(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:ku(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}().type((t=>{return e=t.shape||"circle",Ee(Pp,e)?Pp[e]:function(t){if(!Ee(Bp,t)){const e=wp(t);Bp[t]={draw:function(t,n){Op(t,e,0,0,Math.sqrt(n)/2)}}}return Bp[t]}(e);var e})).size((t=>Hp(t.size,64))),em=function(){var t,e,n,r,i,o,a,s,l=null;function u(t,e,n){const r=n/2;if(i){var u=a-e,c=t-o;if(u||c){var f=Math.sqrt(u*u+c*c),d=(u/=f)*s,h=(c/=f)*s,p=Math.atan2(c,u);l.moveTo(o-d,a-h),l.lineTo(t-u*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+d,a+h),l.arc(o,a,s,p,p+Math.PI)}else l.arc(t,e,r,0,Ep);l.closePath()}else i=1;o=t,a=e,s=r}function c(o){var a,s,c,f=o.length,d=!1;for(null==l&&(l=c=Fu()),a=0;a<=f;++a)!(a<f&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&u(+t(s,a,o),+e(s,a,o),+n(s,a,o));if(c)return l=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(r=t,c):r},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}().x(Zp).y(Yp).defined(Vp).size((t=>t.size||1));function nm(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function rm(t,e,n,r){return Kp.context(t)(e,n,r)}var im=1;function om(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+im++),a=i.clipping[o]||(i.clipping[o]={id:o});return he(r)?a.path=r(null):nm(n)?a.path=rm(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function am(t){this.clear(),t&&this.union(t)}function sm(t){this.mark=t,this.bounds=this.bounds||new am}function lm(t){sm.call(this,t),this.items=this.items||[]}function um(t){this._pending=0,this._loader=t||va()}function cm(t){t._pending+=1}function fm(t){t._pending-=1}function dm(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}am.prototype={clone(){return new am(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(t),l=Math.sin(t),u=e-e*s+n*l,c=n-e*l-n*s;return[s*r-l*i+u,l*r+s*i+c,s*r-l*a+u,l*r+s*a+c,s*o-l*i+u,l*o+s*i+c,s*o-l*a+u,l*o+s*a+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Se(lm,sm),um.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return cm(e),e._loader.sanitize(t,{context:"href"}).then((t=>(fm(e),t))).catch((()=>(fm(e),null)))},loadImage(t){const e=this,n="undefined"!=typeof Image?Image:null;return cm(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=Ee(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>fm(e),i.onerror=()=>fm(e),i.src=r,i})).catch((t=>(fm(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const hm=Ep-1e-8;let pm,mm,gm,ym,vm,bm,xm,_m;const wm=(t,e)=>pm.add(t,e),km=(t,e)=>wm(mm=t,gm=e),Am=t=>wm(t,pm.y1),Em=t=>wm(pm.x1,t),Mm=(t,e)=>vm*t+xm*e,Cm=(t,e)=>bm*t+_m*e,Sm=(t,e)=>wm(Mm(t,e),Cm(t,e)),Dm=(t,e)=>km(Mm(t,e),Cm(t,e));function Fm(t,e){return pm=t,e?(ym=e*kp,vm=_m=Math.cos(ym),bm=Math.sin(ym),xm=-bm):(vm=_m=1,ym=bm=xm=0),Tm}const Tm={beginPath(){},closePath(){},moveTo:Dm,lineTo:Dm,rect(t,e,n,r){ym?(Sm(t+n,e),Sm(t+n,e+r),Sm(t,e+r),Dm(t,e)):(wm(t+n,e+r),km(t,e))},quadraticCurveTo(t,e,n,r){const i=Mm(t,e),o=Cm(t,e),a=Mm(n,r),s=Cm(n,r);Nm(mm,i,a,Am),Nm(gm,o,s,Em),km(a,s)},bezierCurveTo(t,e,n,r,i,o){const a=Mm(t,e),s=Cm(t,e),l=Mm(n,r),u=Cm(n,r),c=Mm(i,o),f=Cm(i,o);Om(mm,a,l,c,Am),Om(gm,s,u,f,Em),km(c,f)},arc(t,e,n,r,i,o){if(r+=ym,i+=ym,mm=n*Math.cos(i)+t,gm=n*Math.sin(i)+e,Math.abs(i-r)>hm)wm(t-n,e-n),wm(t+n,e+n);else{const a=r=>wm(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,l;if(a(r),a(i),i!==r)if((r%=Ep)<0&&(r+=Ep),(i%=Ep)<0&&(i+=Ep),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=Ep,s=r-r%Ap,l=0;l<4&&s>i;++l,s-=Ap)a(s);else for(s=r-r%Ap+Ap,l=0;l<4&&s<i;++l,s+=Ap)a(s)}}};function Nm(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function Om(t,e,n,r,i){const o=r-t+3*e-3*n,a=t+n-2*e,s=t-e;let l,u=0,c=0;Math.abs(o)>1e-14?(l=a*a+s*o,l>=0&&(l=Math.sqrt(l),u=(-a+l)/o,c=(-a-l)/o)):u=.5*s/a,0<u&&u<1&&i(zm(u,t,e,n,r)),0<c&&c<1&&i(zm(c,t,e,n,r))}function zm(t,e,n,r,i){const o=1-t,a=o*o,s=t*t;return a*o*e+3*a*t*n+3*o*s*r+s*t*i}var Rm=(Rm=$u(1,1))?Rm.getContext("2d"):null;const Pm=new am;function Bm(t){return function(e,n){if(!Rm)return!0;t(Rm,e),Pm.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=Pm;for(let t=i;t<=a;++t)for(let e=r;e<=o;++e)if(Rm.isPointInPath(e,t))return!0;return!1}}function Lm(t,e){return e.contains(t.x||0,t.y||0)}function jm(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,o=t.height||0;return e.intersects(Pm.set(n,r,n+i,r+o))}function Um(t,e,n,r,i){const{x1:o,y1:a,x2:s,y2:l}=t,u=r-e,c=i-n;let f,d,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(f=-u,d=-(o-e)),1===p&&(f=u,d=s-e),2===p&&(f=-c,d=-(a-n)),3===p&&(f=c,d=l-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>g)return!1;h>m&&(m=h)}else if(f>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function qm(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Im(t,e){return null==t?e:t}function Wm(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function $m(t,e,n){return dp(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+Im(e.x1,.5)*r,n.y1+Im(e.y1,.5)*i,Math.max(r,i)*Im(e.r1,0),n.x1+Im(e.x2,.5)*r,n.y1+Im(e.y2,.5)*i,Math.max(r,i)*Im(e.r2,.5));else{const a=Im(e.x1,0),s=Im(e.y1,0),l=Im(e.x2,1),u=Im(e.y2,0);if(a!==l&&s!==u&&r!==i){const n=$u(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=Wm(o.createLinearGradient(a,s,l,u),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+l*r,n.y1+u*i)}return Wm(o,e.stops)}(t,n,e.bounds):n}function Hm(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=$m(t,e,e.fill),!0)}var Zm=[];function Ym(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=$m(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Zm),t.lineDashOffset=e.strokeDashOffset||0),!0)}function Vm(t,e){return t.zindex-e.zindex||t.index-e.index}function Gm(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(Vm)}function Xm(t,e){var n,r,i=t.items;if(!i||!i.length)return;const o=Gm(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}function Qm(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const o=Gm(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Jm(t){return function(e,n,r){Xm(n,(n=>{r&&!r.intersects(n.bounds)||tg(t,e,n,n)}))}}function Km(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||tg(t,e,n.items[0],n.items)}}function tg(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(qm(e,n),n.fill&&Hm(e,n,i)&&e.fill(),n.stroke&&Ym(e,n,i)&&e.stroke()))}function eg(t){return t=t||It,function(e,n,r,i,o,a){return r*=e.pixelRatio,i*=e.pixelRatio,Qm(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return t(e,n,r,i,o,a)?n:void 0}))}}function ng(t,e){return function(n,r,i,o){var a,s,l=Array.isArray(r)?r[0]:r,u=null==e?l.fill:e,c=l.stroke&&n.isPointInStroke;return c&&(a=l.strokeWidth,s=l.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function rg(t){return eg(ng(t))}function ig(t,e){return"translate("+t+","+e+")"}function og(t){return"rotate("+t+")"}function ag(t){return ig(t.x||0,t.y||0)}function sg(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=kp),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return ig(t.x||0,t.y||0)+(t.angle?" "+og(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(Fm(t,n.angle),n),dm(t,n).translate(n.x||0,n.y||0)},draw:Jm(r),pick:rg(r),isect:n||Bm(r)}}var lg=sg("arc",(function(t,e){return Gp.context(t)(e)}));function ug(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=ng(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(Fm(t),r),dm(t,r[0]))},draw:Km(r),pick:function(t,e,n,r,o,a){var s=e.items,l=e.bounds;return!s||!s.length||l&&!l.contains(o,a)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Lm,tip:n}}var cg=ug("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Qp:Xp).curve(gp(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",a=t.length,s=1/0;--a>=0;)!1!==t[a].defined&&(r=Math.abs(t[a][o]-i))<s&&(s=r,n=t[a]);return n}));function fg(t,e){t.beginPath(),nm(e)?rm(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function dg(t){const e=Im(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function hg(t,e){const n=dg(e);t("d",rm(null,e,n,n))}function pg(t,e,n,r){const i=dg(e);t.beginPath(),rm(t,e,(n||0)+i,(r||0)+i)}const mg=ng(pg),gg=ng(pg,!1),yg=ng(pg,!0);var vg={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",ag(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),dm(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){Xm(e,(e=>{const r=e.x||0,i=e.y||0,o=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(pg(t,e,r,i),qm(t,e),e.fill&&Hm(t,e,a)&&t.fill(),e.stroke&&!o&&Ym(t,e,a)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&fg(t,e),n&&n.translate(-r,-i),Xm(e,(e=>{this.draw(t,e,n)})),n&&n.translate(r,i),t.restore(),o&&e.stroke&&a&&(pg(t,e,r,i),qm(t,e),Ym(t,e,a)&&t.stroke())}))},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const a=n*t.pixelRatio,s=r*t.pixelRatio;return Qm(e,(l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),m=l.clip;if(m&&(i<c||i>h||o<f||o>p))return;if(t.save(),t.translate(c,f),c=i-c,f=o-f,m&&nm(l)&&!yg(t,l,a,s))return t.restore(),null;const g=l.strokeForeground,y=!1!==e.interactive;return y&&g&&l.stroke&&gg(t,l,a,s)?(t.restore(),l):(u=Qm(l,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,c,f)?this.pick(t,n,r,c,f):null)),!u&&y&&(l.fill||!g&&l.stroke)&&mg(t,l,a,s)&&(u=l),t.restore(),u||null)}))},isect:jm,content:function(t,e,n){t("clip-path",e.clip?om(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),hg(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?hg(t,e):t("d","")}},bg={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function xg(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function _g(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function wg(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function kg(t,e){return"center"===t?e/2:"right"===t?e:0}function Ag(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var Eg={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=xg(e,n),i=_g(e,r),o=wg(e,r),a=(e.x||0)-kg(e.align,i),s=(e.y||0)-Ag(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",bg["xmlns:xlink"],"xlink:href"),t("transform",ig(a,s)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=_g(e,n),i=wg(e,n),o=(e.x||0)-kg(e.align,r),a=(e.y||0)-Ag(e.baseline,i);return t.set(o,a,o+r,a+i)},draw:function(t,e,n){Xm(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=xg(e,this);let i=_g(e,r),o=wg(e,r);if(0===i||0===o)return;let a,s,l,u,c=(e.x||0)-kg(e.align,i),f=(e.y||0)-Ag(e.baseline,o);!1!==e.aspect&&(s=r.width/r.height,l=e.width/e.height,s==s&&l==l&&s!==l&&(l<s?(u=i/s,f+=(o-u)/2,o=u):(u=o*s,c+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(qm(t,e),t.globalAlpha=null!=(a=e.opacity)?a:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,c,f,i,o))}))},pick:eg(),isect:It,get:xg,xOffset:kg,yOffset:Ag},Mg=ug("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Jp.curve(gp(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function Cg(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,a=e.scaleY||1,s=(e.angle||0)*kp,l=e.pathCache;l&&l.path===n||((e.pathCache=l=wp(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),Op(t,l,0,0,o,a),t.rotate(-s),t.translate(-r,-i)):Op(t,l,r,i,o,a)}var Sg={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return ig(t.x||0,t.y||0)+(t.angle?" "+og(t.angle):"")+(t.scaleX||t.scaleY?" scale("+(t.scaleX||1)+","+(t.scaleY||1)+")":"")}(e)),t("d",e.path)},bound:function(t,e){return Cg(Fm(t,e.angle),e)?t.set(0,0,0,0):dm(t,e,!0)},draw:Jm(Cg),pick:rg(Cg),isect:Bm(Cg)};function Dg(t,e){t.beginPath(),rm(t,e)}var Fg={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",rm(null,e))},bound:function(t,e){var n,r;return dm(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Jm(Dg),pick:rg(Dg),isect:jm};function Tg(t,e,n){var r,i,o,a;return!(!e.stroke||!Ym(t,e,n)||(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,a=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),0))}var Ng={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",ag(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return dm(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Xm(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&Tg(t,e,r)&&(qm(t,e),t.stroke())}}))},pick:eg((function(t,e,n,r){return!!t.isPointInStroke&&Tg(t,e,1)&&t.isPointInStroke(n,r)})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Um(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},Og=sg("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),zg=sg("symbol",(function(t,e){return tm.context(t)(e)}),Lm);const Rg=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>Ee(e,t)||Ee(n,t),get:t=>Ee(e,t)?e[t]:Ee(n,t)?o(t,n[t]):void 0,set:(t,n)=>Ee(e,t)?e[t]=n:o(t,n)}}();var Pg={height:Ig,measureWidth:Ug,estimateWidth:Lg,width:Lg,canvas:Bg};function Bg(t){Pg.width=t&&Rm?Ug:Lg}function Lg(t,e){return jg(Zg(t,e),Ig(t))}function jg(t,e){return~~(.8*t.length*e)}function Ug(t,e){return Ig(t)<=0||!(e=Zg(t,e))?0:qg(e,Vg(t))}function qg(t,e){const n="(".concat(e,") ").concat(t);let r=Rg.get(n);return void 0===r&&(Rm.font=e,r=Rm.measureText(t).width,Rg.set(n,r)),r}function Ig(t){return null!=t.fontSize?+t.fontSize||0:11}function Wg(t){return null!=t.lineHeight?t.lineHeight:Ig(t)+2}function $g(t){return e=t.lineBreak&&t.text&&!Qt(t.text)?t.text.split(t.lineBreak):t.text,Qt(e)?e.length>1?e:e[0]:e;var e}function Hg(t){const e=$g(t);return(Qt(e)?e.length-1:0)*Wg(t)}function Zg(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(Pg.width===Ug){const e=Vg(t);return t=>qg(t,e)}{const e=Ig(t);return t=>jg(t,e)}}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"\u2026",a="rtl"===t.dir,s=0,l=e.length;if(n-=r(o),a){for(;s<l;)i=s+l>>>1,r(e.slice(i))>n?s=i+1:l=i;return o+e.slice(s)}for(;s<l;)i=1+(s+l>>>1),r(e.slice(0,i))<n?s=i:l=i-1;return e.slice(0,s)+o}(t,n):n}function Yg(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Vg(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Ig(t)+"px "+Yg(t,e)}function Gg(t){var e=t.baseline,n=Ig(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Wg(t):"line-bottom"===e?.29*n-.5*Wg(t):0)}Bg(!0);const Xg={left:"start",center:"middle",right:"end"},Qg=new am;function Jg(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-Ap,n+=i*Math.cos(e),r+=i*Math.sin(e)),Qg.x1=n,Qg.y1=r,Qg}function Kg(t,e,n){var r,i=Pg.height(e),o=e.align,a=Jg(e),s=a.x1,l=a.y1,u=e.dx||0,c=(e.dy||0)+Gg(e)-Math.round(.8*i),f=$g(e);if(Qt(f)?(i+=Wg(e)*(f.length-1),r=f.reduce(((t,n)=>Math.max(t,Pg.width(e,n))),0)):r=Pg.width(e,f),"center"===o?u-=r/2:"right"===o&&(u-=r),t.set(u+=s,c+=l,u+r,c+i),e.angle&&!n)t.rotate(e.angle*kp,s,l);else if(2===n)return t.rotatedPoints(e.angle*kp,s,l);return t}var ty={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Gg(e),o=Jg(e),a=o.x1,s=o.y1,l=e.angle||0;t("text-anchor",Xg[e.align]||"start"),l?(n=ig(a,s)+" "+og(l),(r||i)&&(n+=" "+ig(r,i))):n=ig(a+r,s+i),t("transform",n)},bound:Kg,draw:function(t,e,n){Xm(e,(e=>{var r,i,o,a,s,l,u,c=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===c||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Vg(e),t.textAlign=e.align||"left",i=(r=Jg(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*kp),i=o=0),i+=e.dx||0,o+=(e.dy||0)+Gg(e),l=$g(e),qm(t,e),Qt(l))for(s=Wg(e),a=0;a<l.length;++a)u=Zg(e,l[a]),e.fill&&Hm(t,e,c)&&t.fillText(u,i,o),e.stroke&&Ym(t,e,c)&&t.strokeText(u,i,o),o+=s;else u=Zg(e,l),e.fill&&Hm(t,e,c)&&t.fillText(u,i,o),e.stroke&&Ym(t,e,c)&&t.strokeText(u,i,o);e.angle&&t.restore()}}))},pick:eg((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var a=Jg(e),s=a.x1,l=a.y1,u=Kg(Qg,e,1),c=-e.angle*kp,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*l),p=d*i+f*o+(l-d*s-f*l);return u.contains(h,p)})),isect:function(t,e){const n=Kg(Qg,t,2);return Um(e,n[0],n[1],n[2],n[3])||Um(e,n[0],n[1],n[4],n[5])||Um(e,n[4],n[5],n[6],n[7])||Um(e,n[2],n[3],n[6],n[7])}},ey=ug("trail",(function(t,e){return em.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),ny={arc:lg,area:cg,group:vg,image:Eg,line:Mg,path:Sg,rect:Fg,rule:Ng,shape:Og,symbol:zg,text:ty,trail:ey};function ry(t,e,n){var r=ny[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new am),t,n)}var iy={mark:null};const oy=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function ay(t){return sy("string"==typeof t?JSON.parse(t):t)}function sy(t){var e,n,r,i=t.marktype,o=t.items;if(o)for(n=0,r=o.length;n<r;++n)e=i?"mark":"group",o[n][e]=t,o[n].zindex&&(o[n][e].zdirty=!0),"group"===(i||e)&&sy(o[n]);return i&&function(t,e,n){var r,i,o,a,s=ny[t.marktype],l=s.bound,u=t.items,c=u&&u.length;if(s.nested)return c?o=u[0]:(iy.mark=t,o=iy),a=ry(o,l,n),e&&e.union(a)||a;if(e=e||t.bounds&&t.bounds.clear()||new am,c)for(r=0,i=u.length;r<i;++r)e.union(ry(u[r],l,n));t.bounds=e}(t),t}function ly(t){arguments.length?this.root=ay(t):(this.root=uy({marktype:"group",name:"root",role:"frame"}),this.root.items=[new lm(this.root)])}function uy(t,e){const n={bounds:new am,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function cy(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function fy(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function dy(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=cy(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function hy(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function py(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function my(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function gy(t,e){this._active=null,this._handlers={},this._loader=t||va(),this._tooltip=e||yy}function yy(t,e,n,r){t.element().setAttribute("title",r||"")}function vy(t){this._el=null,this._bgcolor=null,this._loader=new um(t)}ly.prototype={toJSON(t){return function(t,e){return JSON.stringify(t,oy,e)}(this.root,t||0)},mark(t,e,n){const r=uy(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},gy.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=cy(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,o,a=t&&t.mark;if(a&&(i=ny[a.marktype]).tip){for((o=my(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(a.items,o)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,l+=t.y||0;return{x:s,y:l,width:o,height:a,left:s,top:l,right:s+o,bottom:l+a}}},vy.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const by="dragenter",xy="dragleave",_y="dragover",wy="mousedown",ky="mousemove",Ay="mouseout",Ey="mouseover",My="click",Cy="mousewheel",Sy="touchstart",Dy="touchmove",Fy="touchend",Ty=ky,Ny=Ay,Oy=My;function zy(t,e){gy.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function Ry(t,e){(t=>t===Sy||t===Dy||t===Fy?[Sy,Dy,Fy]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function Py(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r)),this.fire(t,r)}}function By(t){return function(e){this.fire(t,e),this._active=null}}Se(zy,gy,{initialize(t,e,n){return this._canvas=t&&fy(t,"canvas"),[My,wy,ky,Ay,xy].forEach((t=>Ry(this,t))),gy.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",by,xy,_y,wy,"mouseup",ky,Ay,Ey,My,"dblclick","wheel",Cy,Sy,Dy,Fy],DOMMouseScroll(t){this.fire(Cy,t)},mousemove:Py(ky,Ey,Ay),dragover:Py(_y,by,xy),mouseout:By(Ay),dragleave:By(xy),mousedown(t){this._down=this._active,this.fire(wy,t)},click(t){this._down===this._active&&(this.fire(My,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Sy,t,!0)},touchmove(t){this.fire(Dy,t,!0)},touchend(t){this.fire(Fy,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===Oy&&r&&r.href?this.handleHref(e,r,r.href):t!==Ty&&t!==Ny||this.handleTooltip(e,r,t!==Ny),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(Ry(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=my(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const o=this.context();return ny[t.marktype].pick.call(this,o,t,e,n,r,i)}});var Ly="undefined"!=typeof window&&window.devicePixelRatio||1;function jy(t){vy.call(this,t),this._options={},this._redraw=!1,this._dirty=new am,this._tempb=new am}const Uy=vy.prototype;function qy(t,e){gy.call(this,t,e);const n=this;n._hrefHandler=Iy(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=Iy(n,((t,e)=>{n.handleTooltip(t,e,t.type!==Ny)}))}Se(jy,vy,{initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:$u(1,1,this._options.type),t&&this._canvas&&(hy(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Uy.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(Uy.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,o){const a="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),l=a?Ly:i;t.width=e*l,t.height=n*l;for(const u in o)s[u]=o[u];a&&1!==l&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||Rt("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=((t,e,n)=>(new am).set(0,0,e,n).translate(-t[0],-t[1]))(n,r,i);e.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,s),e.restore(),o.clear(),this},draw(t,e,n){const r=ny[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),he(n)?(t.beginPath(),n(t),t.clip()):fg(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}});const Iy=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};Se(qy,gy,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(Oy,this._hrefHandler),r.removeEventListener(Ty,this._tooltipHandler),r.removeEventListener(Ny,this._tooltipHandler)),this._svg=r=t&&fy(t,"svg"),r&&(r.addEventListener(Oy,this._hrefHandler),r.addEventListener(Ty,this._tooltipHandler),r.addEventListener(Ny,this._tooltipHandler)),gy.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:Iy(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Wy="aria-hidden",$y="aria-label",Hy="role",Zy="aria-roledescription",Yy="graphics-object",Vy="graphics-symbol",Gy=(t,e,n)=>({[Hy]:t,[Zy]:e,[$y]:n||void 0}),Xy=Ie(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Qy={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?nv(t):null,i=t.context,o=i.scales[e.scale].value,a=i.dataflow.locale(),s=o.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(Fh(s)?"discrete":s," scale")+" with ".concat(up(a,o,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?nv(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,o=Object.keys(i),a=t.context,s=a.scales[i[o[0]]].value,l=a.dataflow.locale();return((u=r).length?u[0].toUpperCase()+u.slice(1):u)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return(t=t.map((t=>t+("fill"===t||"stroke"===t?" color":"")))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+Kt(t)}(o))+" with ".concat(up(l,s,t));var u}},"title-text":{desc:"title",caption:t=>"Title text '".concat(ev(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(ev(t),"'")}},Jy={ariaRole:Hy,ariaRoleDescription:Zy,description:$y};function Ky(t,e){const n=!1===e.aria;if(t(Wy,n||void 0),n||null==e.description)for(const r in Jy)t(Jy[r],void 0);else{const n=e.mark.marktype;t($y,e.description),t(Hy,e.ariaRole||("group"===n?Yy:Vy)),t(Zy,e.ariaRoleDescription||"".concat(n," mark"))}}function tv(t){return!1===t.aria?{[Wy]:!0}:Xy[t.role]?null:Qy[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Gy(e.role||Vy,e.desc,n.description||r(n))}catch(t){return null}}(t,Qy[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Gy(n?Yy:Vy,"".concat(e," mark container"),t.description)}(t)}function ev(t){return de(t.text).join(" ")}function nv(t){try{return de(Kt(t.items).items[0].text).join(" ")}catch(t){return null}}const rv=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function iv(){let t="",e="",n="";const r=[],i=()=>e=n="",o=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(rv(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),a),a={open(s){(o=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(o)})(s),e="<"+s;for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(const t of u)for(const e in t)o(e,t[e]);return a},close(){const o=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(o,">"):"/>"):"</".concat(o,">"),i(),a},attr:o,text:t=>(n+=rv(t),a),toString:()=>t};return a}const ov=t=>av(iv(),t)+"";function av(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):av(t,e)}return t.close()}const sv={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},lv={blend:"mix-blend-mode"},uv={fill:"none","stroke-miterlimit":10},cv="http://www.w3.org/2000/xmlns/",fv=bg.xmlns;function dv(t){vy.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const hv=vy.prototype;function pv(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function mv(t,e,n){let r,i,o;if("radial"===e.gradient){let r=dy(t,n++,"pattern",fv);kv(r,{id:fp+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=dy(r,0,"rect",fv),kv(r,{width:1,height:1,fill:"url(".concat(Ev(),"#").concat(e.id,")")}),kv(t=dy(t,n++,"radialGradient",fv),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else kv(t=dy(t,n++,"linearGradient",fv),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=dy(t,r,"stop",fv),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return hy(t,r),n}function gv(t,e,n){let r;return(t=dy(t,n,"clipPath",fv)).setAttribute("id",e.id),e.path?(r=dy(t,0,"path",fv),r.setAttribute("d",e.path)):(r=dy(t,0,"rect",fv),kv(r,{x:0,y:0,width:e.width,height:e.height})),hy(t,1),n+1}function yv(t,e,n,r,i){let o,a=t._svg;if(!a&&(o=e.ownerDocument,a=cy(o,r,fv),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},"g"===r))){const e=cy(o,"path",fv);a.appendChild(e),e.__data__=t;const n=cy(o,"g",fv);a.appendChild(n),n.__data__=t;const r=cy(o,"path",fv);a.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}Se(dv,vy,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=dy(t,0,"svg",fv),this._svg.setAttributeNS(cv,"xmlns",fv),this._svg.setAttributeNS(cv,"xmlns:xlink",bg["xmlns:xlink"]),this._svg.setAttribute("version",bg.version),this._svg.setAttribute("class","marks"),hy(t,1),this._root=dy(this._svg,0,"g",fv),kv(this._root,uv),hy(this._svg,1)),this.background(this._bgcolor),hv.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),hv.background.apply(this,arguments)},resize(t,e,n,r){return hv.resize.call(this,t,e,n,r),this._svg&&(kv(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=dy(t,0,"rect",fv),kv(n,{width:this._width,height:this._height,fill:e}));const r=ov(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),hy(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,o,a,s,l;for(a=0,s=t.length;a<s;++a)n=t[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=ny[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,pv(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,pv(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=ny[e.marktype],o=!1===e.interactive?"none":null,a="g"===i.tag,s=yv(e,t,n,"g",r);s.setAttribute("class",py(e));const l=tv(e);for(const d in l)Av(s,d,l[d]);a||Av(s,"pointer-events",o),Av(s,"clip-path",e.clip?om(this,e,e.group):null);let u=null,c=0;const f=t=>{const e=this.isDirty(t),n=yv(t,s,u,i.tag,r);e&&(this._update(i,n,t),a&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;Xm(n,(n=>{r=t.mark(e,n,r),++i})),hy(e,1+i)}(this,n,t)),u=n,++c};return i.nested?e.items.length&&f(e.items[0]):Xm(e,f),hy(s,c),s},_update(t,e,n){vv=e,bv=e.__values__,Ky(_v,n),t.attr(_v,n,this);const r=xv[t.type];r&&r.call(this,t,e,n),vv&&this.style(vv,n)},style(t,e){if(null!=e){for(const n in sv){let r="font"===n?Yg(e):e[n];if(r===bv[n])continue;const i=sv[n];null==r?t.removeAttribute(i):(dp(r)&&(r=hp(r,this._defs.gradient,Ev())),t.setAttribute(i,r+"")),bv[n]=r}for(const n in lv)wv(t,lv[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=dy(t,1,"defs",fv)),r=mv(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=dy(t,1,"defs",fv)),r=gv(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):hy(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let vv=null,bv=null;const xv={group(t,e,n){const r=vv=e.childNodes[2];bv=r.__values__,t.foreground(_v,n,this),bv=e.__values__,vv=e.childNodes[1],t.content(_v,n,this);const i=vv=e.childNodes[0];t.background(_v,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==bv.events&&(Av(r,"pointer-events",o),Av(i,"pointer-events",o),bv.events=o),n.strokeForeground&&n.stroke){const t=n.fill;Av(r,"display",null),this.style(i,n),Av(i,"stroke",null),t&&(n.fill=null),bv=r.__values__,this.style(r,n),t&&(n.fill=t),vv=null}else Av(r,"display","none")},image(t,e,n){!1===n.smooth?(wv(e,"image-rendering","optimizeSpeed"),wv(e,"image-rendering","pixelated")):wv(e,"image-rendering",null)},text(t,e,n){const r=$g(n);let i,o,a,s;Qt(r)?(o=r.map((t=>Zg(n,t))),i=o.join("\n"),i!==bv.text&&(hy(e,0),a=e.ownerDocument,s=Wg(n),o.forEach(((t,r)=>{const i=cy(a,"tspan",fv);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),bv.text=i)):(o=Zg(n,r),o!==bv.text&&(e.textContent=o,bv.text=o)),Av(e,"font-family",Yg(n)),Av(e,"font-size",Ig(n)+"px"),Av(e,"font-style",n.fontStyle),Av(e,"font-variant",n.fontVariant),Av(e,"font-weight",n.fontWeight)}};function _v(t,e,n){e!==bv[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(vv,t,e,n):Av(vv,t,e),bv[t]=e)}function wv(t,e,n){n!==bv[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),bv[e]=n)}function kv(t,e){for(const n in e)Av(t,n,e[n])}function Av(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function Ev(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Mv(t){vy.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}Se(Mv,vy,{svg(){return this._text},_render(t){const e=iv();e.open("svg",we({},bg,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",uv,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=ny[e.marktype],r=n.tag,i=[Ky,n.attr];t.open("g",{class:py(e),"clip-path":e.clip?om(this,e,e.group):null},tv(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&t.open("a",a),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=$g(o);if(Qt(e)){const n={x:0,dy:Wg(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Zg(o,e[r])).close()}else t.text(Zg(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),Xm(o,(e=>this.mark(t,e))),t.close(),r&&a?(i&&(o.fill=null),o.stroke=a,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),a&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):Xm(e,o),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(o,e,this))):n(o,e,this),r&&function(t,e,n,r,i){let o;if(null==e)return t;if("bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===r&&(t["font-family"]=Yg(e),t["font-size"]=Ig(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in sv){let n=e[a];const r=sv[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(dp(n)&&(n=hp(n,i.gradient,"")),t[r]=n)}for(const a in lv){const t=e[a];null!=t&&(o=o||[],o.push("".concat(lv[a],": ").concat(t,";")))}o&&(t.style=o.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:fp+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const Cv="canvas",Sv=Cv,Dv="svg",Fv={};function Tv(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Fv[t]=e,this):Fv[t]}function Nv(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)Ov(i[s],e,n,r);else for(const t=ny[o].isect;s<a;++s){const n=i[s];zv(n,e,t)&&r.push(n)}}return r}function Ov(t,e,n,r){n&&n(t.mark)&&zv(t,e,ny.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const a=t.x||0,s=t.y||0;e.translate(-a,-s);for(let t=0;t<o;++t)Nv(i[t],e,n,r);e.translate(a,s)}return r}function zv(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}Fv[Cv]=Fv.png={renderer:jy,headless:jy,handler:zy},Fv.svg={renderer:dv,headless:Mv,handler:qy},Fv.none={};const Rv=new am,Pv="top",Bv="left",Lv="right",jv="bottom",Uv="start",qv="middle",Iv="end",Wv="group",$v="axis",Hv="title",Zv="legend",Yv="row-header",Vv="row-footer",Gv="row-title",Xv="column-header",Qv="column-footer",Jv="column-title",Kv="fit-x",tb="fit-y",eb="none",nb="all",rb="each",ib="flush",ob="column",ab="row";function sb(t){ns.call(this,null,t)}function lb(t,e,n){return e(t.bounds.clear(),t,n)}Se(sb,ns,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=ny[i],a=o.bound;let s,l=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),l=lb(r,a),r.items.forEach((t=>{t.bounds.clear().union(l)}));else if(i===Wv||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),l.clear(),r.items.forEach((t=>l.union(lb(t,a)))),r.role){case $v:case Zv:case Hv:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,(t=>{l.union(lb(t,a))})),e.visit(e.MOD,(t=>{s=s||l.alignsWith(t.bounds),n.dirty(t),l.union(lb(t,a))})),s&&(l.clear(),r.items.forEach((t=>l.union(t.bounds))));return function(t){const e=t.clip;if(he(e))e(Fm(Rv.clear()));else{if(!e)return;Rv.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(Rv)}(r),e.modifies("bounds")}});const ub=":vega_identifier:";function cb(t){ns.call(this,0,t)}function fb(t){ns.call(this,null,t)}function db(t){ns.call(this,null,t)}cb.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Se(cb,ns,{transform(t,e){const n=(i=e.dataflow)._signals[ub]||(i._signals[ub]=i.add(0)),r=t.as;var i;let o=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++o)),n.set(this.value=o),e}}),Se(fb,ns,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===Wv?lm:sm;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const hb={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&pb(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},pb=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),mb=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(pb(o,n=t[r].bounds,e))return!0},gb=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},yb=t=>(t.forEach((t=>t.opacity=1)),t),vb=(t,e)=>t.reflow(e.modified()).modifies("opacity");function bb(t){ns.call(this,null,t)}Se(db,ns,{transform(t,e){const n=hb[t.method]||hb.parity,r=t.separation||0;let i,o,a=e.materialize(e.SOURCE).source;if(!a||!a.length)return;if(!t.method)return t.modified("method")&&(yb(a),e=vb(e,t)),e;if(a=a.filter(gb),!a.length)return;if(t.sort&&(a=a.slice().sort(t.sort)),i=yb(a),e=vb(e,t),i.length>=3&&mb(i,r)){do{i=n(i,r)}while(i.length>=3&&mb(i,r));i.length<3&&!Kt(a).opacity&&(i.length>1&&(Kt(i).opacity=0),Kt(a).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=((t,e,n)=>{var r=t.range(),i=new am;return e===Pv||e===jv?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),a.forEach((t=>{o(t)||(t.opacity=0)})));const s=i[0].mark.bounds.clear();return a.forEach((t=>{t.opacity&&s.union(t.bounds)})),e}}),Se(bb,ns,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const xb=new am;function _b(t,e,n){return t[e]===n?0:(t[e]=n,1)}function wb(t){var e=t.items[0].orient;return e===Bv||e===Lv}function kb(t,e,n,r){var i,o,a=e.items[0],s=a.datum,l=null!=a.translate?a.translate:.5,u=a.orient,c=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&Hg(g),x=0,_=0;switch(xb.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),u){case Pv:x=h||0,_=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(f,0),g&&Ab(t,g,o,y,b,0,-1,v);break;case Bv:x=-d,_=h||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,f),g&&Ab(t,g,o,y,b,1,-1,v);break;case Lv:x=n+d,_=h||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,f),g&&Ab(t,g,o,y,b,1,1,v);break;case jv:x=h||0,_=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(f,o),g&&Ab(t,g,o,y,0,0,1,v);break;default:x=a.x,_=a.y}return dm(v.translate(x,_),a),_b(a,"x",x+l)|_b(a,"y",_+l)&&(a.bounds=xb,t.dirty(a),a.bounds=v,t.dirty(a)),a.mark.bounds.clear().union(v)}function Ab(t,e,n,r,i,o,a,s){const l=e.bounds;if(e.auto){const s=a*(n+i+r);let u=0,c=0;t.dirty(e),o?u=(e.x||0)-(e.x=s):c=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(l.translate(-u,-c)),t.dirty(e)}s.union(l)}const Eb=(t,e)=>Math.floor(Math.min(t,e)),Mb=(t,e)=>Math.ceil(Math.max(t,e));function Cb(t){return(new am).set(0,0,t.width||0,t.height||0)}function Sb(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function Db(t,e,n){const r=Jt(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function Fb(t){return t<0?Math.ceil(-t):0}function Tb(t,e,n){var r,i,o,a,s,l,u,c,f,d,h,p=!n.nodirty,m=n.bounds===ib?Cb:Sb,g=xb.set(0,0,0,0),y=Db(n.align,ob),v=Db(n.align,ab),b=Db(n.padding,ob),x=Db(n.padding,ab),_=n.columns||e.length,w=_<=0?1:Math.ceil(e.length/_),k=e.length,A=Array(k),E=Array(_),M=0,C=Array(k),S=Array(w),D=0,F=Array(k),T=Array(k),N=Array(k);for(i=0;i<_;++i)E[i]=0;for(i=0;i<w;++i)S[i]=0;for(i=0;i<k;++i)l=e[i],s=N[i]=m(l),l.x=l.x||0,F[i]=0,l.y=l.y||0,T[i]=0,o=i%_,a=~~(i/_),M=Math.max(M,u=Math.ceil(s.x2)),D=Math.max(D,c=Math.ceil(s.y2)),E[o]=Math.max(E[o],u),S[a]=Math.max(S[a],c),A[i]=b+Fb(s.x1),C[i]=x+Fb(s.y1),p&&t.dirty(e[i]);for(i=0;i<k;++i)i%_==0&&(A[i]=0),i<_&&(C[i]=0);if(y===rb)for(o=1;o<_;++o){for(h=0,i=o;i<k;i+=_)h<A[i]&&(h=A[i]);for(i=o;i<k;i+=_)A[i]=h+E[o-1]}else if(y===nb){for(h=0,i=0;i<k;++i)i%_&&h<A[i]&&(h=A[i]);for(i=0;i<k;++i)i%_&&(A[i]=h+M)}else for(y=!1,o=1;o<_;++o)for(i=o;i<k;i+=_)A[i]+=E[o-1];if(v===rb)for(a=1;a<w;++a){for(h=0,r=(i=a*_)+_;i<r;++i)h<C[i]&&(h=C[i]);for(i=a*_;i<r;++i)C[i]=h+S[a-1]}else if(v===nb){for(h=0,i=_;i<k;++i)h<C[i]&&(h=C[i]);for(i=_;i<k;++i)C[i]=h+D}else for(v=!1,a=1;a<w;++a)for(r=(i=a*_)+_;i<r;++i)C[i]+=S[a-1];for(f=0,i=0;i<k;++i)f=A[i]+(i%_?f:0),F[i]+=f-e[i].x;for(o=0;o<_;++o)for(d=0,i=o;i<k;i+=_)d+=C[i],T[i]+=d-e[i].y;if(y&&Db(n.center,ob)&&w>1)for(i=0;i<k;++i)(f=(s=y===nb?M:E[i%_])-N[i].x2-e[i].x-F[i])>0&&(F[i]+=f/2);if(v&&Db(n.center,ab)&&1!==_)for(i=0;i<k;++i)(d=(s=v===nb?D:S[~~(i/_)])-N[i].y2-e[i].y-T[i])>0&&(T[i]+=d/2);for(i=0;i<k;++i)g.union(N[i].translate(F[i],T[i]));switch(f=Db(n.anchor,"x"),d=Db(n.anchor,"y"),Db(n.anchor,ob)){case Iv:f-=g.width();break;case qv:f-=g.width()/2}switch(Db(n.anchor,ab)){case Iv:d-=g.height();break;case qv:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),i=0;i<k;++i)e[i].mark.bounds.clear();for(i=0;i<k;++i)(l=e[i]).x+=F[i]+=f,l.y+=T[i]+=d,g.union(l.mark.bounds.union(l.bounds.translate(F[i],T[i]))),p&&t.dirty(l);return g}function Nb(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function Ob(t,e){return t.bounds[e]}function zb(t,e,n,r,i,o,a,s,l,u,c,f,d,h){var p,m,g,y,v,b,x,_,w,k=n.length,A=0,E=0;if(!k)return A;for(p=c;p<k;p+=f)n[p]&&(A=a(A,l(n[p],u)));if(!e.length)return A;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),A+=o,m=0,y=e.length;m<y;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=c,m=0,y=e.length;m<y;++m,p+=f){for(v=(b=e[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);s?(_=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),w=A):(_=A,w=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),v.union(b.bounds.translate(_-(b.x||0),w-(b.y||0))),b.x=_,b.y=w,t.dirty(b),E=a(E,v[u])}return E}function Rb(t,e,n,r,i,o){if(e){t.dirty(e);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),e.bounds.translate(a-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=a,e.y=s,t.dirty(e)}}function Pb(t,e,n,r,i,o,a){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),l=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,s("offset",0)),u=s("anchor",Uv),c=u===Iv?1:u===qv?.5:0,f={align:rb,bounds:s("bounds",ib),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case Bv:f.anchor={x:Math.floor(r.x1)-l,column:Iv,y:c*(a||r.height()+2*r.y1),row:u};break;case Lv:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case Pv:f.anchor={y:Math.floor(i.y1)-l,row:Iv,x:c*(o||i.width()+2*i.x1),column:u};break;case jv:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case"top-left":f.anchor={x:l,y:l};break;case"top-right":f.anchor={x:o-l,y:l,column:Iv};break;case"bottom-left":f.anchor={x:l,y:a-l,row:Iv};break;case"bottom-right":f.anchor={x:o-l,y:a-l,column:Iv,row:Iv}}return f}function Bb(t,e){var n,r,i=e.items[0],o=i.datum,a=i.orient,s=i.bounds,l=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var a=e.items[1].items[0],s=a.anchor,l=e.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case Bv:i+=Math.ceil(a.bounds.width())+l;break;case Lv:case jv:break;default:o+=a.bounds.height()+l}switch((i||o)&&jb(t,n,i,o),a.orient){case Bv:c+=Lb(e,n,a,s,1,1);break;case Lv:u+=Lb(e,n,a,Iv,0,0)+l,c+=Lb(e,n,a,s,1,1);break;case jv:u+=Lb(e,n,a,s,0,0),c+=Lb(e,n,a,Iv,-1,0,1)+l;break;default:u+=Lb(e,n,a,s,0,0)}(u||c)&&jb(t,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(jb(t,n,-u,0),jb(t,a,-u,0))}else(i||o)&&jb(t,n,i,o)}(t,i,i.items[0].items[0]),s=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),"symbol"===o.type&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),a!==eb&&(i.x=l=0,i.y=u=0),i.width=n,i.height=r,dm(s.set(l,u,l+n,u+r),i),i.mark.bounds.clear().union(s),i}function Lb(t,e,n,r,i,o,a){const s="symbol"!==t.datum.type,l=n.datum.vgrad,u=(!s||!o&&l||a?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,c=l&&o?u:0,f=l&&o?0:u,d=i<=0?0:Hg(n);return Math.round(r===Uv?c:r===Iv?f-d:.5*(u-d))}function jb(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function Ub(t){ns.call(this,null,t)}function qb(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function Ib(t){ns.call(this,null,t)}function Wb(t){ns.call(this,null,t)}function $b(){return Ma({})}function Hb(t){ns.call(this,null,t)}function Zb(t){ns.call(this,[],t)}Se(Ub,ns,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&function(t,e,n){var r,i,o,a,s,l,u,c=function(t){var e,n,r=t.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(e=r[o]).items,e.marktype===Wv)switch(e.role){case $v:case Zv:case Hv:break;case Yv:a.rowheaders.push(...n);break;case Vv:a.rowfooters.push(...n);break;case Xv:a.colheaders.push(...n);break;case Qv:a.colfooters.push(...n);break;case Gv:a.rowtitle=n[0];break;case Jv:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(e),f=c.marks,d=n.bounds===ib?Nb:Ob,h=n.offset,p=n.columns||f.length,m=p<=0?1:Math.ceil(f.length/p),g=m*p;const y=Tb(t,f,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(l=Db(n.headerBand,ab,null),r=zb(t,c.rowheaders,f,0,m,-Db(h,"rowHeader"),Eb,0,d,"x1",0,p,1,l)),c.colheaders&&(l=Db(n.headerBand,ob,null),i=zb(t,c.colheaders,f,0,p,-Db(h,"columnHeader"),Eb,1,d,"y1",0,1,p,l)),c.rowfooters&&(l=Db(n.footerBand,ab,null),o=zb(t,c.rowfooters,f,0,m,Db(h,"rowFooter"),Mb,0,d,"x2",p-1,p,1,l)),c.colfooters&&(l=Db(n.footerBand,ob,null),a=zb(t,c.colfooters,f,0,p,Db(h,"columnFooter"),Mb,1,d,"y2",g-p,1,p,l)),c.rowtitle&&(s=Db(n.titleAnchor,ab),u=Db(h,"rowTitle"),u=s===Iv?o+u:r-u,l=Db(n.titleBand,ab,.5),Rb(t,c.rowtitle,u,0,y,l)),c.coltitle&&(s=Db(n.titleAnchor,ob),u=Db(h,"columnTitle"),u=s===Iv?a+u:i-u,l=Db(n.titleBand,ob,.5),Rb(t,c.coltitle,u,1,y,l))}(n,e,t.layout),function(t,e,n){var r,i,o,a,s,l=e.items,u=Math.max(0,e.width||0),c=Math.max(0,e.height||0),f=(new am).set(0,0,u,c),d=f.clone(),h=f.clone(),p=[];for(a=0,s=l.length;a<s;++a)switch((i=l[a]).role){case $v:(wb(i)?d:h).union(kb(t,i,u,c));break;case Hv:r=i;break;case Zv:p.push(Bb(t,i));break;case"frame":case"scope":case Yv:case Vv:case Gv:case Xv:case Qv:case Jv:d.union(i.bounds),h.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(o=t.orient||Lv)!==eb&&(e[o]||(e[o]=[])).push(t)}));for(const r in e){const i=e[r];Tb(t,i,Pb(i,r,n.legends,d,h,u,c))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),!n.autosize||"fit"!==n.autosize.type&&n.autosize.type!==Kv&&n.autosize.type!==tb)f.union(r);else switch(e.orient){case Bv:case Lv:f.add(r.x1,0).add(r.x2,0);break;case Pv:case jv:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(t,e,n,r,i){var o,a=e.items[0],s=a.frame,l=a.orient,u=a.anchor,c=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=l===Bv||l===Lv?r:n,m=0,g=0,y=0,v=0,b=0;if(s!==Wv?l===Bv?(m=i.y2,p=i.y1):l===Lv?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):l===Bv&&(m=r,p=0),o=u===Uv?m:u===Iv?p:(m+p)/2,h&&h.text){switch(l){case Pv:case jv:b=d.bounds.height()+f;break;case Bv:v=d.bounds.width()+f;break;case Lv:v=-d.bounds.width()-f}xb.clear().union(h.bounds),xb.translate(v-(h.x||0),b-(h.y||0)),_b(h,"x",v)|_b(h,"y",b)&&(t.dirty(h),h.bounds.clear().union(xb),h.mark.bounds.clear().union(xb),t.dirty(h)),xb.clear().union(h.bounds)}else xb.clear();switch(xb.union(d.bounds),l){case Pv:g=o,y=i.y1-xb.height()-c;break;case Bv:g=i.x1-xb.width()-c,y=o;break;case Lv:g=i.x2+xb.width()+c,y=o;break;case jv:g=o,y=i.y2+c;break;default:g=a.x,y=a.y}return _b(a,"x",g)|_b(a,"y",y)&&(xb.translate(g,y),t.dirty(a),a.bounds.clear().union(xb),e.bounds.clear().union(xb),t.dirty(a)),a.bounds}(t,r,u,c,f)),e.clip&&f.set(0,0,e.width||0,e.height||0),function(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let a=t._width,s=t._height,l=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,e.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===i.contains){const e=t.padding();a-=e.left+e.right,s-=e.top+e.bottom}o===eb?(u=0,f=0,l=a,c=s):"fit"===o?(l=Math.max(0,a-u-d),c=Math.max(0,s-f-h)):o===Kv?(l=Math.max(0,a-u-d),s=c+f+h):o===tb?(a=l+u+d,c=Math.max(0,s-f-h)):"pad"===o&&(a=l+u+d,s=c+f+h),t._resizeView(a,s,l,c,[u,f],i.resize)}(t,e,f,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}}),Se(Ib,ns,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,a=Vh(o,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||Qh(n,o,a,t.formatSpecifier,t.formatType,!!t.values),l=t.values?Gh(o,t.values,a):Xh(o,a);return i&&(r.rem=i),i=l.map(((t,e)=>Ma({index:e/(l.length-1||1),value:t,label:s(t)}))),t.extra&&i.length&&i.push(Ma({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),Se(Wb,ns,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||$b,o=t.key||Aa,a=this.value;return Qt(r.encode)&&(r.encode=null),a&&(t.modified("key")||e.modified(o))&&Rt("DataJoin does not support modified key function or fields."),a||(e=e.addAll(),this.value=a=function(t){const e=Ce().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(o)),e.visit(e.ADD,(t=>{const e=o(t);let n=a.get(e);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),a.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=o(t),n=a.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=o(t),n=a.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),Se(Hb,ns,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if(Qt(o)){if(!n.changed()&&!o.every((t=>i[t])))return e.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||Wt,l=i.enter||Wt,u=i.exit||Wt,c=(o&&!a?i[o]:s)||Wt;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{l(e,t),s(e,t)})),n.modifies(l.output),n.modifies(s.output),c!==Wt&&c!==s&&(e.visit(e.ADD,(e=>{c(e,t)})),n.modifies(c.output))),e.changed(e.REM)&&u!==Wt&&(e.visit(e.REM,(e=>{u(e,t)})),n.modifies(u.output)),a||c!==Wt){const i=e.MOD|(t.modified()?e.REFLOW:0);a?(e.visit(i,(e=>{const i=l(e,t)||r;(c(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)):e.visit(i,(e=>{(c(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:e.StopPropagation}}),Se(Zb,ns,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,a,s=e.dataflow.locale(),l=e.fork(e.NO_SOURCE|e.NO_FIELDS),u=this.value,c=t.type||Wh,f=t.scale,d=+t.limit,h=Vh(f,null==t.count?5:t.count,t.minstep),p=!!t.values||c===Wh,m=t.format||rp(s,f,h,c,t.formatSpecifier,t.formatType,p),g=t.values||ep(f,h);return u&&(l.rem=u),c===Wh?(d&&g.length>d?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=g.slice(0,d-1),a=!0):u=g,he(i=t.size)?(t.values||0!==f(u[0])||(u=u.slice(1)),o=u.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=xe(o=i||8),u=u.map(((e,n)=>Ma({index:n,label:m(e,n,u),value:e,offset:o,size:i(e,t)}))),a&&(a=g[u.length],u.push(Ma({index:u.length,label:"\u2026".concat(g.length-u.length," entries"),value:a,offset:o,size:i(a,t)})))):"gradient"===c?(n=f.domain(),r=Bh(f,n[0],Kt(n)),g.length<3&&!t.values&&n[0]!==Kt(n)&&(g=[n[0],Kt(n)]),u=g.map(((t,e)=>Ma({index:e,label:m(t,e,g),value:t,perc:r(t)})))):(i=g.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+Kt(e),o=i-r;if(t.type===uh){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}(f),u=g.map(((t,e)=>Ma({index:e,label:m(t,e,g),value:t,perc:e?r(t):0,perc2:e===i?1:r(g[e+1])})))),l.source=u,l.add=u,this.value=u,l}});const Yb=t=>t.source.x,Vb=t=>t.source.y,Gb=t=>t.target.x,Xb=t=>t.target.y;function Qb(t){ns.call(this,{},t)}Qb.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Se(Qb,ns,{transform(t,e){var n=t.sourceX||Yb,r=t.sourceY||Vb,i=t.targetX||Gb,o=t.targetY||Xb,a=t.as||"path",s=t.orient||"vertical",l=t.shape||"line",u=ex.get(l+"-"+s)||ex.get(l);return u||Rt("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[a]=u(n(t),r(t),i(t),o(t))})),e.reflow(t.modified()).modifies(a)}});const Jb=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,Kb=(t,e,n,r)=>{var i=n-t,o=r-e,a=Math.hypot(i,o)/2;return"M"+t+","+e+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},tx=(t,e,n,r)=>{const i=n-t,o=r-e,a=.2*(i+o),s=.2*(o-i);return"M"+t+","+e+"C"+(t+a)+","+(e+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},ex=Ce({line:Jb,"line-radial":(t,e,n,r)=>Jb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:Kb,"arc-radial":(t,e,n,r)=>Kb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:tx,"curve-radial":(t,e,n,r)=>tx(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*a+","+e*s+"L"+r*a+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n),l=(e+r)/2;return"M"+e*i+","+e*o+"C"+l*i+","+l*o+" "+l*a+","+l*s+" "+r*a+","+r*s}});function nx(t){ns.call(this,null,t)}function rx(t){return Dh(t)&&t!==oh}nx.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Se(nx,ns,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],a=o[0],s=o[1],l=t.field||qt,u=t.startAngle||0,c=null!=t.endAngle?t.endAngle:2*Math.PI,f=e.source,d=f.map(l),h=d.length,p=u,m=(c-u)/qb(d),g=is(h);for(t.sort&&g.sort(((t,e)=>d[t]-d[e])),n=0;n<h;++n)i=d[g[n]],(r=f[g[n]])[a]=p,r[s]=p+=i*m;return this.value=d,e.reflow(t.modified()).modifies(o)}});const ix=Ie(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function ox(t){ns.call(this,null,t),this.modified(!0)}function ax(t,e,n){return Nh(t)&&Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0))!==e.length&&n.warn("Log scale domain includes zero: "+Be(e)),e}function sx(t,e,n){return he(t)&&(e||n)?function(t,e){const n=e[0],r=Kt(e)-n;return function(e){return t(n+e*r)}}(t,lx(e||[0,1],n)):t}function lx(t,e){return e?t.slice().reverse():t}function ux(t){ns.call(this,null,t)}Se(ox,ns,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";return n===oh?oh+"-"+Jd:(function(t){const e=t.type;return Dh(e)&&e!==rh&&e!==ih&&(t.scheme||t.range&&t.range.length&&t.range.every(Oe))}(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?oh+"-":3===e?ah+"-":""),(r+n||Jd).toLowerCase())}(t);for(i in r&&i===r.type||(this.value=r=Mh(i)()),t)if(!ix[i]){if("padding"===i&&rx(r.type))continue;he(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){t!==dh&&t!==fh&&Rt("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===fh?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Qd(n,i,r)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i=e.schemeExtent;return Qt(e.scheme)?r=Ph(e.scheme,e.interpolate,e.interpolateGamma):(r=Ih(e.scheme.toLowerCase()))||Rt("Unrecognized scheme name: ".concat(e.scheme)),n=t===uh?n+1:t===hh?n-1:t===sh||t===lh?+e.schemeCount||5:n,Oh(t)?sx(r,i,e.reverse):he(r)?function(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}(sx(r,i),n):t===ch?r:r.slice(0,n)}(r,e,n),he(o))){if(t.interpolator)return t.interpolator(o);Rt("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&Oh(r))return t.interpolator(Ph(lx(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(Lh(e.interpolate,e.interpolateGamma)):he(t.round)?t.round(i):he(t.rangeRound)&&t.interpolate(i?Kc:Jc),o&&t.range(lx(o,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!Qt(r)){const e=t.domain(),n=e[0],i=Kt(e),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||Rt("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=is(a,s+o/2,o)}return r?t.bins=r:t.bins&&delete t.bins,t.type===hh&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain()),n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(ax(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,a=e.domain,s=t.type,l=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===Jd||e===th||e===eh)}(t);if(!a)return 0;if(rx(s)&&e.padding&&a[0]!==Kt(a)&&(a=function(t,e,n,r,i,o){var a=Math.abs(Kt(n)-n[0]),s=a/(a-2*r),l=t===Kd?ue(e,null,s):t===eh?ce(e,null,s,.5):t===th?ce(e,null,s,i||1):t===nh?fe(e,null,s,o||1):le(e,null,s);return(e=e.slice())[0]=l[0],e[e.length-1]=l[1],e}(s,a,e.range,e.padding,e.exponent,e.constant)),(l||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(a=a.slice()).length-1||1,l&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=e.domainMin&&(a[0]=e.domainMin),null!=e.domainMax&&(a[i]=e.domainMax),null!=e.domainMid)){const t=(o=e.domainMid)>a[i]?i+1:o<a[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(t,0,o)}return t.domain(ax(s,a,n)),s===ch&&t.unknown(e.domainImplicit?Jf:void 0),e.nice&&t.nice&&t.nice(!0!==e.nice&&Vh(t,e.nice)||null),a.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Se(ux,ns,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(Fa(t.sort)),this.modified(n),e}});const cx="zero",fx="center",dx="normalize",hx=["y0","y1"];function px(t){ns.call(this,null,t)}function mx(t,e,n,r,i){for(var o,a=(e-t.sum)/2,s=t.length,l=0;l<s;++l)(o=t[l])[r]=a,o[i]=a+=Math.abs(n(o))}function gx(t,e,n,r,i){for(var o,a=1/t.sum,s=0,l=t.length,u=0,c=0;u<l;++u)(o=t[u])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function yx(t,e,n,r,i){for(var o,a,s=0,l=0,u=t.length,c=0;c<u;++c)(o=+n(a=t[c]))<0?(a[r]=l,a[i]=l+=o):(a[r]=s,a[i]=s+=o)}px.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:cx,values:[cx,fx,dx]},{name:"as",type:"string",array:!0,length:2,default:hx}]},Se(px,ns,{transform(t,e){var n,r,i,o,a=t.as||hx,s=a[0],l=a[1],u=Fa(t.sort),c=t.field||qt,f=t.offset===fx?mx:t.offset===dx?gx:yx;for(n=function(t,e,n,r){var i,o,a,s,l,u,c,f,d,h=[],p=t=>t(l);if(null==e)h.push(t.slice());else for(i={},o=0,a=t.length;o<a;++o)l=t[o],(c=i[u=e.map(p)])||(i[u]=c=[],h.push(c)),c.push(l);for(u=0,d=0,s=h.length;u<s;++u){for(o=0,f=0,a=(c=h[u]).length;o<a;++o)f+=Math.abs(r(c[o]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(e.source,t.groupby,u,c),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,c,s,l);return e.reflow(t.modified()).modifies(a)}});const vx=t=>t;function bx(t,e){t&&_x.hasOwnProperty(t.type)&&_x[t.type](t,e)}var xx={Feature:function(t,e){bx(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)bx(n[r].geometry,e)}},_x={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){wx(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)wx(n[r],e,0)},Polygon:function(t,e){kx(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)kx(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)bx(n[r],e)}};function wx(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function kx(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)wx(t[n],e,1);e.polygonEnd()}function Ax(t,e){t&&xx.hasOwnProperty(t.type)?xx[t.type](t,e):bx(t,e)}class Ex{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[n++]=a),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}var Mx=1e-6,Cx=1e-12,Sx=Math.PI,Dx=Sx/2,Fx=Sx/4,Tx=2*Sx,Nx=180/Sx,Ox=Sx/180,zx=Math.abs,Rx=Math.atan,Px=Math.atan2,Bx=Math.cos,Lx=Math.ceil,jx=Math.exp,Ux=(Math.floor,Math.hypot),qx=Math.log,Ix=Math.pow,Wx=Math.sin,$x=Math.sign||function(t){return t>0?1:t<0?-1:0},Hx=Math.sqrt,Zx=Math.tan;function Yx(t){return t>1?0:t<-1?Sx:Math.acos(t)}function Vx(t){return t>1?Dx:t<-1?-Dx:Math.asin(t)}function Gx(){}var Xx,Qx,Jx,Kx,t_=new Ex,e_=new Ex,n_={point:Gx,lineStart:Gx,lineEnd:Gx,polygonStart:function(){n_.lineStart=r_,n_.lineEnd=a_},polygonEnd:function(){n_.lineStart=n_.lineEnd=n_.point=Gx,t_.add(zx(e_)),e_=new Ex},result:function(){var t=t_/2;return t_=new Ex,t}};function r_(){n_.point=i_}function i_(t,e){n_.point=o_,Xx=Jx=t,Qx=Kx=e}function o_(t,e){e_.add(Kx*t-Jx*e),Jx=t,Kx=e}function a_(){o_(Xx,Qx)}const s_=n_;var l_=1/0,u_=l_,c_=-l_,f_=c_,d_={point:function(t,e){t<l_&&(l_=t),t>c_&&(c_=t),e<u_&&(u_=e),e>f_&&(f_=e)},lineStart:Gx,lineEnd:Gx,polygonStart:Gx,polygonEnd:Gx,result:function(){var t=[[l_,u_],[c_,f_]];return c_=f_=-(u_=l_=1/0),t}};const h_=d_;var p_,m_,g_,y_,v_=0,b_=0,x_=0,__=0,w_=0,k_=0,A_=0,E_=0,M_=0,C_={point:S_,lineStart:D_,lineEnd:N_,polygonStart:function(){C_.lineStart=O_,C_.lineEnd=z_},polygonEnd:function(){C_.point=S_,C_.lineStart=D_,C_.lineEnd=N_},result:function(){var t=M_?[A_/M_,E_/M_]:k_?[__/k_,w_/k_]:x_?[v_/x_,b_/x_]:[NaN,NaN];return v_=b_=x_=__=w_=k_=A_=E_=M_=0,t}};function S_(t,e){v_+=t,b_+=e,++x_}function D_(){C_.point=F_}function F_(t,e){C_.point=T_,S_(g_=t,y_=e)}function T_(t,e){var n=t-g_,r=e-y_,i=Hx(n*n+r*r);__+=i*(g_+t)/2,w_+=i*(y_+e)/2,k_+=i,S_(g_=t,y_=e)}function N_(){C_.point=S_}function O_(){C_.point=R_}function z_(){P_(p_,m_)}function R_(t,e){C_.point=P_,S_(p_=g_=t,m_=y_=e)}function P_(t,e){var n=t-g_,r=e-y_,i=Hx(n*n+r*r);__+=i*(g_+t)/2,w_+=i*(y_+e)/2,k_+=i,A_+=(i=y_*t-g_*e)*(g_+t),E_+=i*(y_+e),M_+=3*i,S_(g_=t,y_=e)}const B_=C_;function L_(t){this._context=t}L_.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Tx)}},result:Gx};var j_,U_,q_,I_,W_,$_=new Ex,H_={point:Gx,lineStart:function(){H_.point=Z_},lineEnd:function(){j_&&Y_(U_,q_),H_.point=Gx},polygonStart:function(){j_=!0},polygonEnd:function(){j_=null},result:function(){var t=+$_;return $_=new Ex,t}};function Z_(t,e){H_.point=Y_,U_=I_=t,q_=W_=e}function Y_(t,e){I_-=t,W_-=e,$_.add(Hx(I_*I_+W_*W_)),I_=t,W_=e}const V_=H_;let G_,X_,Q_,J_;class K_{constructor(t){this._append=null==t?tw:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));if(e>15)return tw;if(e!==G_){const t=10**e;G_=e,X_=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return X_}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append(y||(y=w(["M",",",""])),t,e),this._point=1;break;case 1:this._append(v||(v=w(["L",",",""])),t,e);break;default:if(this._append(b||(b=w(["M",",",""])),t,e),this._radius!==Q_||this._append!==X_){const t=this._radius,e=this._;this._="",this._append(x||(x=w(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),t,t,t,-2*t,t,t,2*t),Q_=t,X_=this._append,J_=this._,this._=e}this._+=J_}}result(){const t=this._;return this._="",t.length?t:null}}function tw(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function ew(t,e){let n,r,i=3,o=4.5;function a(t){return t&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),Ax(t,n(r))),r.result()}return a.area=function(t){return Ax(t,n(s_)),s_.result()},a.measure=function(t){return Ax(t,n(V_)),V_.result()},a.bounds=function(t){return Ax(t,n(h_)),h_.result()},a.centroid=function(t){return Ax(t,n(B_)),B_.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,vx):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new K_(i)):new L_(e=t),"function"!=typeof o&&r.pointRadius(o),a):e},a.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(r.pointRadius(+t),+t),a):o},a.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));i=e}return null===e&&(r=new K_(i)),a},a.projection(t).digits(i).context(e)}function nw(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:Gx,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function rw(t,e){return zx(t[0]-e[0])<Mx&&zx(t[1]-e[1])<Mx}function iw(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function ow(t,e,n,r,i){var o,a,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(rw(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*Mx}s.push(n=new iw(r,t,null,!0)),l.push(n.o=new iw(r,null,n,!1)),s.push(n=new iw(a,t,null,!1)),l.push(n.o=new iw(a,null,n,!0))}})),s.length){for(l.sort(e),aw(s),aw(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function aw(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function sw(t){return[Px(t[1],t[0]),Vx(t[2])]}function lw(t){var e=t[0],n=t[1],r=Bx(n);return[r*Bx(e),r*Wx(e),Wx(n)]}function uw(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function cw(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function fw(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function dw(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function hw(t){var e=Hx(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function pw(t){return zx(t[0])<=Sx?t[0]:$x(t[0])*((zx(t[0])+Sx)%Tx-Sx)}function mw(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function gw(t,e,n,r){return function(i){var o,a,s,l=e(i),u=nw(),c=e(u),f=!1,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,a=mw(a);var t=function(t,e){var n=pw(e),r=e[1],i=Wx(r),o=[Wx(n),-Bx(n),0],a=0,s=0,l=new Ex;1===i?r=Dx+Mx:-1===i&&(r=-Dx-Mx);for(var u=0,c=t.length;u<c;++u)if(d=(f=t[u]).length)for(var f,d,h=f[d-1],p=pw(h),m=h[1]/2+Fx,g=Wx(m),y=Bx(m),v=0;v<d;++v,p=x,g=w,y=k,h=b){var b=f[v],x=pw(b),_=b[1]/2+Fx,w=Wx(_),k=Bx(_),A=x-p,E=A>=0?1:-1,M=E*A,C=M>Sx,S=g*w;if(l.add(Px(S*E*Wx(M),y*k+S*Bx(M))),a+=C?A+E*Tx:A,C^p>=n^x>=n){var D=cw(lw(h),lw(b));hw(D);var F=cw(o,D);hw(F);var T=(C^A>=0?-1:1)*Vx(F[2]);(r>T||r===T&&(D[0]||D[1]))&&(s+=C^A>=0?1:-1)}}return(a<-Mx||a<Mx&&l<-Cx)^1&s}(o,r);a.length?(f||(i.polygonStart(),f=!0),ow(a,vw,t,n,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(e,n){t(e,n)&&i.point(e,n)}function p(t,e){l.point(t,e)}function m(){d.point=p,l.lineStart()}function g(){d.point=h,l.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,n,r,l=c.clean(),d=u.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&l){if((e=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else h>1&&2&l&&d.push(d.pop().concat(d.shift())),a.push(d.filter(yw))}return d}}function yw(t){return t.length>1}function vw(t,e){return((t=t.x)[0]<0?t[1]-Dx-Mx:Dx-t[1])-((e=e.x)[0]<0?e[1]-Dx-Mx:Dx-e[1])}const bw=gw((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?Sx:-Sx,l=zx(o-n);zx(l-Sx)<Mx?(t.point(n,r=(r+a)/2>0?Dx:-Dx),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&l>=Sx&&(zx(n-i)<Mx&&(n-=i*Mx),zx(o-s)<Mx&&(o-=s*Mx),r=function(t,e,n,r){var i,o,a=Wx(t-n);return zx(a)>Mx?Rx((Wx(e)*(o=Bx(r))*Wx(n)-Wx(r)*(i=Bx(e))*Wx(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*Dx,r.point(-Sx,i),r.point(0,i),r.point(Sx,i),r.point(Sx,0),r.point(Sx,-i),r.point(0,-i),r.point(-Sx,-i),r.point(-Sx,0),r.point(-Sx,i);else if(zx(t[0]-e[0])>Mx){var o=t[0]<e[0]?Sx:-Sx;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-Sx,-Dx]);function xw(t,e){(e=lw(e))[0]-=t,hw(e);var n=Yx(-e[1]);return((-e[2]<0?-n:n)+Tx-Mx)%Tx}var _w=1e9,ww=-_w;function kw(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return zx(r[0]-t)<Mx?i>0?0:3:zx(r[0]-n)<Mx?i>0?2:1:zx(r[1]-e)<Mx?i>0?1:0:i>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var l,u,c,f,d,h,p,m,g,y,v,b=a,x=nw(),_={point:w,lineStart:function(){_.point=k,u&&u.push(c=[]),y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(k(f,d),h&&g&&x.rejoin(),l.push(x.result())),_.point=w,g&&b.lineEnd()},polygonStart:function(){b=x,l=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],l=1,c=s.length,f=s[0],d=f[0],h=f[1];l<c;++l)o=d,a=h,d=(f=s[l])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(t-o)&&++e:h<=r&&(d-o)*(r-a)<(h-a)*(t-o)&&--e;return e}(),n=v&&e,i=(l=mw(l)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&ow(l,s,e,o,a),a.polygonEnd()),b=a,l=u=c=null}};function w(t,e){i(t,e)&&b.point(t,e)}function k(o,a){var s=i(o,a);if(u&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var l=[p=Math.max(ww,Math.min(_w,p)),m=Math.max(ww,Math.min(_w,m))],x=[o=Math.max(ww,Math.min(_w,o)),a=Math.max(ww,Math.min(_w,a))];!function(t,e,n,r,i,o){var a,s=t[0],l=t[1],u=0,c=1,f=e[0]-s,d=e[1]-l;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(t[0]=s+u*f,t[1]=l+u*d),c<1&&(e[0]=s+c*f,e[1]=l+c*d),!0}}}}}(l,x,t,e,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(l[0],l[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return _}}function Aw(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Ew(t,e){return zx(t)>Sx&&(t-=Math.round(t/Tx)*Tx),[t,e]}function Mw(t,e,n){return(t%=Tx)?e||n?Aw(Sw(t),Dw(e,n)):Sw(t):e||n?Dw(e,n):Ew}function Cw(t){return function(e,n){return zx(e+=t)>Sx&&(e-=Math.round(e/Tx)*Tx),[e,n]}}function Sw(t){var e=Cw(t);return e.invert=Cw(-t),e}function Dw(t,e){var n=Bx(t),r=Wx(t),i=Bx(e),o=Wx(e);function a(t,e){var a=Bx(e),s=Bx(t)*a,l=Wx(t)*a,u=Wx(e),c=u*n+s*r;return[Px(l*i-c*o,s*n-u*r),Vx(c*i+l*o)]}return a.invert=function(t,e){var a=Bx(e),s=Bx(t)*a,l=Wx(t)*a,u=Wx(e),c=u*i-l*o;return[Px(l*i+u*o,s*n+c*r),Vx(c*n-s*r)]},a}function Fw(t){return function(e){var n=new Tw;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Tw(){}function Nw(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Ax(n,t.stream(h_)),e(h_.result()),null!=r&&t.clipExtent(r),t}function Ow(t,e,n){return Nw(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function zw(t,e,n){return Ow(t,[[0,0],e],n)}function Rw(t,e,n){return Nw(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function Pw(t,e,n){return Nw(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}Ew.invert=Ew,Tw.prototype={constructor:Tw,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Bw=16,Lw=Bx(30*Ox);function jw(t,e){return+e?function(t,e){function n(r,i,o,a,s,l,u,c,f,d,h,p,m,g){var y=u-r,v=c-i,b=y*y+v*v;if(b>4*e&&m--){var x=a+d,_=s+h,w=l+p,k=Hx(x*x+_*_+w*w),A=Vx(w/=k),E=zx(zx(w)-1)<Mx||zx(o-f)<Mx?(o+f)/2:Px(_,x),M=t(E,A),C=M[0],S=M[1],D=C-r,F=S-i,T=v*D-y*F;(T*T/b>e||zx((y*D+v*F)/b-.5)>.3||a*d+s*h+l*p<Lw)&&(n(r,i,o,a,s,l,C,S,E,x/=k,_/=k,w,m,g),g.point(C,S),n(C,S,E,x,_,w,u,c,f,d,h,p,m,g))}}return function(e){var r,i,o,a,s,l,u,c,f,d,h,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,m.point=v,e.lineStart()}function v(r,i){var o=lw([r,i]),a=t(r,i);n(c,f,u,d,h,p,c=a[0],f=a[1],u=r,d=o[0],h=o[1],p=o[2],Bw,e),e.point(c,f)}function b(){m.point=g,e.lineEnd()}function x(){y(),m.point=_,m.lineEnd=w}function _(t,e){v(r=t,e),i=c,o=f,a=d,s=h,l=p,m.point=v}function w(){n(c,f,u,d,h,p,i,o,r,a,s,l,Bw,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return Fw({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var Uw=Fw({point:function(t,e){this.stream.point(t*Ox,e*Ox)}});function qw(t,e,n,r,i,o){if(!o)return function(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}(t,e,n,r,i);var a=Bx(o),s=Wx(o),l=a*t,u=s*t,c=a/t,f=s/t,d=(s*n-a*e)/t,h=(s*e+a*n)/t;function p(t,o){return[l*(t*=r)-u*(o*=i)+e,n-u*t-l*o]}return p.invert=function(t,e){return[r*(c*t-f*e+d),i*(h-f*t-c*e)]},p}function Iw(t){return Ww((function(){return t}))()}function Ww(t){var e,n,r,i,o,a,s,l,u,c,f=150,d=480,h=250,p=0,m=0,g=0,y=0,v=0,b=0,x=1,_=1,w=null,k=bw,A=null,E=vx,M=.5;function C(t){return l(t[0]*Ox,t[1]*Ox)}function S(t){return(t=l.invert(t[0],t[1]))&&[t[0]*Nx,t[1]*Nx]}function D(){var t=qw(f,0,0,x,_,b).apply(null,e(p,m)),r=qw(f,d-t[0],h-t[1],x,_,b);return n=Mw(g,y,v),s=Aw(e,r),l=Aw(n,s),a=jw(s,M),F()}function F(){return u=c=null,C}return C.stream=function(t){return u&&c===t?u:u=Uw(function(t){return Fw({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(E(c=t)))))},C.preclip=function(t){return arguments.length?(k=t,w=void 0,F()):k},C.postclip=function(t){return arguments.length?(E=t,A=r=i=o=null,F()):E},C.clipAngle=function(t){return arguments.length?(k=+t?function(t){var e=Bx(t),n=6*Ox,r=e>0,i=zx(e)>Mx;function o(t,n){return Bx(t)*Bx(n)>e}function a(t,n,r){var i=[1,0,0],o=cw(lw(t),lw(n)),a=uw(o,o),s=o[0],l=a-s*s;if(!l)return!r&&t;var u=e*a/l,c=-e*s/l,f=cw(i,o),d=dw(i,u);fw(d,dw(o,c));var h=f,p=uw(d,h),m=uw(h,h),g=p*p-m*(uw(d,d)-1);if(!(g<0)){var y=Hx(g),v=dw(h,(-p-y)/m);if(fw(v,d),v=sw(v),!r)return v;var b,x=t[0],_=n[0],w=t[1],k=n[1];_<x&&(b=x,x=_,_=b);var A=_-x,E=zx(A-Sx)<Mx;if(!E&&k<w&&(b=w,w=k,k=b),E||A<Mx?E?w+k>0^v[1]<(zx(v[0]-x)<Mx?w:k):w<=v[1]&&v[1]<=k:A>Sx^(x<=v[0]&&v[0]<=_)){var M=dw(h,(-p+y)/m);return fw(M,d),[v,sw(M)]}}}function s(e,n){var i=r?t:Sx-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return gw(o,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,d){var h,p=[f,d],m=o(f,d),g=r?m?0:s(f,d):m?s(f+(f<0?Sx:-Sx),d):0;if(!e&&(u=l=m)&&t.lineStart(),m!==l&&(!(h=a(e,p))||rw(e,h)||rw(p,h))&&(p[2]=1),m!==l)c=0,m?(t.lineStart(),h=a(p,e),t.point(h[0],h[1])):(h=a(e,p),t.point(h[0],h[1],2),t.lineEnd()),e=h;else if(i&&e&&r^m){var y;g&n||!(y=a(p,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!m||e&&rw(e,p)||t.point(p[0],p[1]),e=p,l=m,n=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,r,i,o){!function(t,e,n,r,i,o){if(n){var a=Bx(e),s=Wx(e),l=r*n;null==i?(i=e+r*Tx,o=e-l/2):(i=xw(a,i),o=xw(a,o),(r>0?i<o:i>o)&&(i+=r*Tx));for(var u,c=i;r>0?c>o:c<o;c-=l)u=sw([a,-s*Bx(c),-s*Wx(c)]),t.point(u[0],u[1])}}(o,t,n,i,e,r)}),r?[0,-t]:[-Sx,t-Sx])}(w=t*Ox):(w=null,bw),F()):w*Nx},C.clipExtent=function(t){return arguments.length?(E=null==t?(A=r=i=o=null,vx):kw(A=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),F()):null==A?null:[[A,r],[i,o]]},C.scale=function(t){return arguments.length?(f=+t,D()):f},C.translate=function(t){return arguments.length?(d=+t[0],h=+t[1],D()):[d,h]},C.center=function(t){return arguments.length?(p=t[0]%360*Ox,m=t[1]%360*Ox,D()):[p*Nx,m*Nx]},C.rotate=function(t){return arguments.length?(g=t[0]%360*Ox,y=t[1]%360*Ox,v=t.length>2?t[2]%360*Ox:0,D()):[g*Nx,y*Nx,v*Nx]},C.angle=function(t){return arguments.length?(b=t%360*Ox,D()):b*Nx},C.reflectX=function(t){return arguments.length?(x=t?-1:1,D()):x<0},C.reflectY=function(t){return arguments.length?(_=t?-1:1,D()):_<0},C.precision=function(t){return arguments.length?(a=jw(s,M=t*t),F()):Hx(M)},C.fitExtent=function(t,e){return Ow(C,t,e)},C.fitSize=function(t,e){return zw(C,t,e)},C.fitWidth=function(t,e){return Rw(C,t,e)},C.fitHeight=function(t,e){return Pw(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&S,D()}}function $w(t){var e=0,n=Sx/3,r=Ww(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*Ox,n=t[1]*Ox):[e*Nx,n*Nx]},i}function Hw(t,e){var n=Wx(t),r=(n+Wx(e))/2;if(zx(r)<Mx)return function(t){var e=Bx(t);function n(t,n){return[t*e,Wx(n)/e]}return n.invert=function(t,n){return[t/e,Vx(n*e)]},n}(t);var i=1+n*(2*r-n),o=Hx(i)/r;function a(t,e){var n=Hx(i-2*r*Wx(e))/r;return[n*Wx(t*=r),o-n*Bx(t)]}return a.invert=function(t,e){var n=o-e,a=Px(t,zx(n))*$x(n);return n*r<0&&(a-=Sx*$x(t)*$x(n)),[a/r,Vx((i-(t*t+n*n)*r*r)/(2*r))]},a}function Zw(){return $w(Hw).scale(155.424).center([0,33.6442])}function Yw(){return Zw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Vw(t){return function(e,n){var r=Bx(e),i=Bx(n),o=t(r*i);return o===1/0?[2,0]:[o*i*Wx(e),o*Wx(n)]}}function Gw(t){return function(e,n){var r=Hx(e*e+n*n),i=t(r),o=Wx(i),a=Bx(i);return[Px(e*o,r*a),Vx(r&&n*o/r)]}}var Xw=Vw((function(t){return Hx(2/(1+t))}));Xw.invert=Gw((function(t){return 2*Vx(t/2)}));var Qw=Vw((function(t){return(t=Yx(t))&&t/Wx(t)}));function Jw(t,e){return[t,qx(Zx((Dx+e)/2))]}function Kw(t){var e,n,r,i=Iw(t),o=i.center,a=i.scale,s=i.translate,l=i.clipExtent,u=null;function c(){var o=Sx*a(),s=i(function(t){function e(e){return(e=t(e[0]*Ox,e[1]*Ox))[0]*=Nx,e[1]*=Nx,e}return t=Mw(t[0]*Ox,t[1]*Ox,t.length>2?t[2]*Ox:0),e.invert=function(e){return(e=t.invert(e[0]*Ox,e[1]*Ox))[0]*=Nx,e[1]*=Nx,e},e}(i.rotate()).invert([0,0]));return l(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===Jw?[[Math.max(s[0]-o,u),e],[Math.min(s[0]+o,n),r]]:[[u,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),c()):a()},i.translate=function(t){return arguments.length?(s(t),c()):s()},i.center=function(t){return arguments.length?(o(t),c()):o()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),c()):null==u?null:[[u,e],[n,r]]},c()}function tk(t){return Zx((Dx+t)/2)}function ek(t,e){var n=Bx(t),r=t===e?Wx(t):qx(n/Bx(e))/qx(tk(e)/tk(t)),i=n*Ix(tk(t),r)/r;if(!r)return Jw;function o(t,e){i>0?e<-Dx+Mx&&(e=-Dx+Mx):e>Dx-Mx&&(e=Dx-Mx);var n=i/Ix(tk(e),r);return[n*Wx(r*t),i-n*Bx(r*t)]}return o.invert=function(t,e){var n=i-e,o=$x(r)*Hx(t*t+n*n),a=Px(t,zx(n))*$x(n);return n*r<0&&(a-=Sx*$x(t)*$x(n)),[a/r,2*Rx(Ix(i/o,1/r))-Dx]},o}function nk(t,e){return[t,e]}function rk(t,e){var n=Bx(t),r=t===e?Wx(t):(n-Bx(e))/(e-t),i=n/r+t;if(zx(r)<Mx)return nk;function o(t,e){var n=i-e,o=r*t;return[n*Wx(o),i-n*Bx(o)]}return o.invert=function(t,e){var n=i-e,o=Px(t,zx(n))*$x(n);return n*r<0&&(o-=Sx*$x(t)*$x(n)),[o/r,i-$x(r)*Hx(t*t+n*n)]},o}Qw.invert=Gw((function(t){return t})),Jw.invert=function(t,e){return[t,2*Rx(jx(e))-Dx]},nk.invert=nk;var ik=1.340264,ok=-.081106,ak=893e-6,sk=.003796,lk=Hx(3)/2;function uk(t,e){var n=Vx(lk*Wx(e)),r=n*n,i=r*r*r;return[t*Bx(n)/(lk*(ik+3*ok*r+i*(7*ak+9*sk*r))),n*(ik+ok*r+i*(ak+sk*r))]}function ck(t,e){var n=Bx(e),r=Bx(t)*n;return[n*Wx(t)/r,Wx(e)/r]}function fk(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function dk(t,e){return[Bx(e)*Wx(t),Wx(e)]}function hk(t,e){var n=Bx(e),r=1+Bx(t)*n;return[n*Wx(t)/r,Wx(e)/r]}function pk(t,e){return[qx(Zx((Dx+e)/2)),-t]}uk.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(ik+ok*i+o*(ak+sk*i))-e)/(ik+3*ok*i+o*(7*ak+9*sk*i)))*r)*i*i,!(zx(n)<Cx));++a);return[lk*t*(ik+3*ok*i+o*(7*ak+9*sk*i))/Bx(r),Vx(Wx(r)/lk)]},ck.invert=Gw(Rx),fk.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(zx(n)>Mx&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},dk.invert=Gw(Vx),hk.invert=Gw((function(t){return 2*Rx(t)})),pk.invert=function(t,e){return[-e,2*Rx(jx(t))-Dx]};var mk=Math.abs,gk=(Math.atan,Math.atan2,Math.ceil,Math.cos),yk=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),vk=(Math.tan,1e-6),bk=Math.PI,xk=bk/2,_k=(Math.SQRT1_2,kk(2));function wk(t){return t>1?xk:t<-1?-xk:Math.asin(t)}function kk(t){return t>0?Math.sqrt(t):0}function Ak(t,e){var n,r=t*yk(e),i=30;do{e-=n=(e+yk(e)-r)/(1+gk(e))}while(mk(n)>vk&&--i>0);return e/2}kk(bk);var Ek=function(t,e,n){function r(r,i){return[t*r*gk(i=Ak(n,i)),e*yk(i)]}return r.invert=function(r,i){return i=wk(i/e),[r/(t*gk(i)),wk((2*i+yk(2*i))/n)]},r}(_k/xk,_k,bk);const Mk=ew(),Ck=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Sk(t,e){if(!t||"string"!=typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(Fk[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=ew().projection(r),r.copy=r.copy||function(){const t=n();return Ck.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},Eh(r)}}(t,e),this):Fk[t]||null}function Dk(t){return t&&t.path||Mk}const Fk={albers:Yw,albersusa:function(){var t,e,n,r,i,o,a=Yw(),s=Zw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Zw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){o=[t,e]}};function c(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function f(){return t=e=null,c}return c.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:a).invert(t)},c.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),s.stream(n),l.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},c.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),l.precision(t),f()):a.precision()},c.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),l.scale(t),c.translate(a.translate())):a.scale()},c.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],c=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,c-.238*e],[o+.455*e,c+.238*e]]).stream(u),r=s.translate([o-.307*e,c+.201*e]).clipExtent([[o-.425*e+Mx,c+.12*e+Mx],[o-.214*e-Mx,c+.234*e-Mx]]).stream(u),i=l.translate([o-.205*e,c+.212*e]).clipExtent([[o-.214*e+Mx,c+.166*e+Mx],[o-.115*e-Mx,c+.234*e-Mx]]).stream(u),f()},c.fitExtent=function(t,e){return Ow(c,t,e)},c.fitSize=function(t,e){return zw(c,t,e)},c.fitWidth=function(t,e){return Rw(c,t,e)},c.fitHeight=function(t,e){return Pw(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return Iw(Xw).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Iw(Qw).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return $w(ek).scale(109.5).parallels([30,30])},conicequalarea:Zw,conicequidistant:function(){return $w(rk).scale(131.154).center([0,13.9389])},equalEarth:function(){return Iw(uk).scale(177.158)},equirectangular:function(){return Iw(nk).scale(152.63)},gnomonic:function(){return Iw(ck).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,o,a,s=1,l=0,u=0,c=1,f=1,d=0,h=null,p=1,m=1,g=Fw({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=vx;function v(){return p=s*c,m=s*f,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+l,i+u]}return b.invert=function(n){var r=n[0]-l,i=n[1]-u;if(d){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/m]},b.stream=function(t){return o&&a===t?o:o=g(y(a=t))},b.postclip=function(t){return arguments.length?(y=t,h=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(h=n=r=i=null,vx):kw(h=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==h?null:[[h,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],v()):[l,u]},b.angle=function(n){return arguments.length?(e=Wx(d=n%360*Ox),t=Bx(d),v()):d*Nx},b.reflectX=function(t){return arguments.length?(c=t?-1:1,v()):c<0},b.reflectY=function(t){return arguments.length?(f=t?-1:1,v()):f<0},b.fitExtent=function(t,e){return Ow(b,t,e)},b.fitSize=function(t,e){return zw(b,t,e)},b.fitWidth=function(t,e){return Rw(b,t,e)},b.fitHeight=function(t,e){return Pw(b,t,e)},b},mercator:function(){return Kw(Jw).scale(961/Tx)},mollweide:function(){return Iw(Ek).scale(169.529)},naturalEarth1:function(){return Iw(fk).scale(175.295)},orthographic:function(){return Iw(dk).scale(249.5).clipAngle(90+Mx)},stereographic:function(){return Iw(hk).scale(250).clipAngle(142)},transversemercator:function(){var t=Kw(pk),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const n in Fk)Sk(n,Fk[n]);function Tk(t,e,n){var r=is(t,e-Mx,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Nk(t,e,n){var r=is(t,e-Mx,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Ok(){}const zk=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Rk(){var t=1,e=1,n=a;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,l,u,c,f,d=new Array,h=new Array;for(a=s=-1,u=n[0]>=r,zk[u<<1].forEach(p);++a<t-1;)l=u,u=n[a+1]>=r,zk[l|u<<1].forEach(p);for(zk[u<<0].forEach(p);++s<e-1;){for(a=-1,u=n[s*t+t]>=r,c=n[s*t]>=r,zk[u<<1|c<<2].forEach(p);++a<t-1;)l=u,u=n[s*t+t+a+1]>=r,f=c,c=n[s*t+a+1]>=r,zk[l|u<<1|c<<2|f<<3].forEach(p);zk[u|c<<3].forEach(p)}for(a=-1,c=n[s*t]>=r,zk[c<<2].forEach(p);++a<t-1;)f=c,c=n[s*t+a+1]>=r,zk[c<<2|f<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+a,t[0][1]+s],l=[t[1][0]+a,t[1][1]+s],u=o(r),c=o(l);(e=h[u])?(n=d[c])?(delete h[e.end],delete d[n.start],e===n?(e.ring.push(l),i(e.ring)):d[e.start]=h[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[e.end],e.ring.push(l),h[e.end=c]=e):(e=d[c])?(n=h[u])?(delete d[e.start],delete h[n.end],e===n?(e.ring.push(l),i(e.ring)):d[n.start]=h[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=u]=e):d[u]=h[c]={start:u,end:c,ring:[r,l]}}zk[c<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):s.push(t)})),s.forEach((t=>{for(var e,n=0,r=a.length;n<r;++n)if(-1!==Pk((e=a[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],l=0|a,u=0|s,c=r[u*t+l];a>0&&a<t&&l===a&&(o=r[u*t+l-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<e&&u===s&&(o=r[(u-1)*t+l],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||Rt("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?a:Ok,r):n===a},r}function Pk(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=Bk(t,e[r]))return n;return 0}function Bk(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var l=t[o],u=l[0],c=l[1],f=t[s],d=f[0],h=f[1];if(Lk(l,f,e))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function Lk(t,e,n){var r,i,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],a=e[r],i<=o&&o<=a||a<=o&&o<=i)}function jk(t,e,n){return function(r){var i=ke(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,l=e?dn(o,a,t):s/(t+1);return is(o+l,a,l)}}function Uk(t){ns.call(this,null,t)}function qk(t,e,n,r,i){const o=t.x1||0,a=t.y1||0,s=e*n<0;function l(t){t.forEach(u)}function u(t){s&&t.reverse(),t.forEach(c)}function c(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-a)*n+i}return function(t){return t.coordinates.forEach(l),t}}function Ik(t,e,n){const r=t>=0?t:G(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Wk(t){return he(t)?t:xe(+t)}function $k(){var t=t=>t[0],e=t=>t[1],n=qt,r=[-1,-1],i=960,o=500,a=2;function s(s,l){const u=Ik(r[0],s,t)>>a,c=Ik(r[1],s,e)>>a,f=u?u+2:0,d=c?c+2:0,h=2*f+(i>>a),p=2*d+(o>>a),m=new Float32Array(h*p),g=new Float32Array(h*p);let y=m;s.forEach((r=>{const i=f+(+t(r)>>a),o=d+(+e(r)>>a);i>=0&&i<h&&o>=0&&o<p&&(m[i+o*h]+=+n(r))})),u>0&&c>0?(Hk(h,p,m,g,u),Zk(h,p,g,m,c),Hk(h,p,m,g,u),Zk(h,p,g,m,c),Hk(h,p,m,g,u),Zk(h,p,g,m,c)):u>0?(Hk(h,p,m,g,u),Hk(h,p,g,m,u),Hk(h,p,m,g,u),y=g):c>0&&(Zk(h,p,m,g,c),Zk(h,p,g,m,c),Zk(h,p,m,g,c),y=g);const v=l?Math.pow(2,-2*a):1/qb(y);for(let t=0,e=h*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(i>>a),y2:d+(o>>a)}}return s.x=function(e){return arguments.length?(t=Wk(e),s):t},s.y=function(t){return arguments.length?(e=Wk(t),s):e},s.weight=function(t){return arguments.length?(n=Wk(t),s):n},s.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||Rt("invalid size"),i=e,o=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||Rt("invalid cell size"),a=Math.floor(Math.log(t)/Math.LN2),s):1<<a},s.bandwidth=function(t){return arguments.length?(1===(t=de(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&Rt("invalid bandwidth"),r=t,s):r},s}function Hk(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+a*t]),e>=i&&(e>=o&&(s-=n[e-o+a*t]),r[e-i+a*t]=s/Math.min(e+1,t-1+o-e,o))}function Zk(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let s=0,l=0;s<e+i;++s)s<e&&(l+=n[a+s*t]),s>=i&&(s>=o&&(l-=n[a+(s-o)*t]),r[a+(s-i)*t]=l/Math.min(s+1,e-1+o-s,o))}function Yk(t){ns.call(this,null,t)}Uk.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Se(Uk,ns,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||jt,o=Rk().smooth(!1!==t.smooth),a=t.thresholds||function(t,e,n){const r=jk(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>B(e(t).values))))}(r,i,t),s=null===t.as?null:t.as||"contour",l=[];return r.forEach((e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,Qt(a)?a:a(n.values));!function(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;if(he(i)&&(i=i(n,r)),he(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const a=(Ne(i)?i:i[0])||1,s=(Ne(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;t.forEach(qk(e,a,s,l,u))}(r,n,e,t),r.forEach((t=>{l.push(Sa(e,Ma(null!=s?{[s]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),Yk.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Vk=["x","y","weight","size","cellSize","bandwidth"];function Gk(t,e){return Vk.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function Xk(t){ns.call(this,null,t)}Se(Yk,ns,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,o,a,s,l=[],u=t=>t(o);if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}(e.materialize(e.SOURCE).source,t.groupby),o=(t.groupby||[]).map(Ft),a=Gk($k(),t),s=t.as||"grid";return n=i.map((e=>Ma(function(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}({[s]:a(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),Xk.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Se(Xk,ns,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=Rk().smooth(!1!==t.smooth),a=t.values,s=t.thresholds||jk(t.count||10,t.nice,!!a),l=t.size;return a||(a=e.materialize(e.SOURCE).source,r=qk(n=Gk($k(),t)(a,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],a=n.values),s=Qt(s)?s:s(a),a=o.size(l)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(Ma),i}});const Qk="Feature",Jk="FeatureCollection";function Kk(t){ns.call(this,null,t)}function tA(t){ns.call(this,null,t)}function eA(t){ns.call(this,null,t)}function nA(t){ns.call(this,null,t)}function rA(t){ns.call(this,[],t),this.generator=function(){var t,e,n,r,i,o,a,s,l,u,c,f,d=10,h=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return is(Lx(r/p)*p,n,p).map(c).concat(is(Lx(s/m)*m,a,m).map(f)).concat(is(Lx(e/d)*d,t,d).filter((function(t){return zx(t%p)>Mx})).map(l)).concat(is(Lx(o/h)*h,i,h).filter((function(t){return zx(t%m)>Mx})).map(u))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],y):[p,m]},y.stepMinor=function(t){return arguments.length?(d=+t[0],h=+t[1],y):[d,h]},y.precision=function(d){return arguments.length?(g=+d,l=Tk(o,i,90),u=Nk(e,t,g),c=Tk(s,a,90),f=Nk(r,n,g),y):g},y.extentMajor([[-180,-90+Mx],[180,90-Mx]]).extentMinor([[-180,-80-Mx],[180,80+Mx]])}()}function iA(t){ns.call(this,null,t)}function oA(t){if(!he(t))return!1;const e=Ie(Tt(t));return e.$x||e.$y||e.$value||e.$max}function aA(t){ns.call(this,null,t),this.modified(!0)}function sA(t,e,n){he(t[e])&&t[e](n)}function lA(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,l,u,c,f,d,h=t._root,p={data:r},m=t._x0,g=t._y0,y=t._x1,v=t._y1;if(!h)return t._root=p,t;for(;h.length;)if((u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=h,!(h=h[f=c<<1|u]))return i[f]=p,t;if(s=+t._x.call(null,h.data),l=+t._y.call(null,h.data),e===s&&n===l)return p.next=h,i?i[f]=p:t._root=p,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|u)==(d=(l>=a)<<1|s>=o));return i[d]=h,i[f]=p,t}function uA(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function cA(t){return t[0]}function fA(t){return t[1]}function dA(t,e,n){var r=new hA(null==e?cA:e,null==n?fA:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function hA(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function pA(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}Kk.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Se(Kk,ns,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,a=o&&o[0],s=o&&o[1],l=t.geojson||!o&&jt,u=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(Tt(l))||a&&e.modified(Tt(a))||s&&e.modified(Tt(s)),this.value&&!n||(u=e.SOURCE,this._features=r=[],this._points=i=[]),l&&e.visit(u,(t=>r.push(l(t)))),a&&s&&(e.visit(u,(t=>{var e=a(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:Qk,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:Jk,features:r}}}),tA.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Se(tA,ns,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||jt,o=t.as||"path",a=n.SOURCE;!r||t.modified()?(this.value=r=Dk(t.projection),n.materialize().reflow()):a=i===jt||e.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(t,e){const n=t.pointRadius();return t.context(null),null!=e&&t.pointRadius(e),n}(r,t.pointRadius);return n.visit(a,(t=>t[o]=r(i(t)))),r.pointRadius(s),n.modifies(o)}}),eA.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Se(eA,ns,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],a=t.as||["x","y"],s=a[0],l=a[1];function u(t){const e=r([i(t),o(t)]);e?(t[s]=e[0],t[l]=e[1]):(t[s]=void 0,t[l]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,u):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,u)),e.modifies(a)}}),nA.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Se(nA,ns,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>(t.context(e),r),r}(Dk(t.projection),t.field||Bt("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(t=>t[i]=r)),n.modifies(i)}}),rA.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Se(rA,ns,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const o in t)he(i[o])&&i[o](t[o]);return n=i(),r.length?e.mod.push(Da(r[0],n)):e.add.push(Ma(n)),r[0]=n,e}}),iA.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Se(iA,ns,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||jt,o=function(t,e){let n;return he(t)?(n=n=>t(n,e),n.dep=oA(t)):t?n=xe(t):(n=t=>t.$value/t.$max||0,n.dep=!0),n}(t.opacity,t),a=function(t,e){let n;return he(t)?(n=n=>yc(t(n,e)),n.dep=oA(t)):n=xe(yc(t||"#888")),n}(t.color,t),s=t.as||"image",l={$x:0,$y:0,$value:0,$max:r?B(n.map((t=>B(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=we({},t,l);r||(n.$max=B(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,o=t.height,a=t.x1||0,s=t.y1||0,l=t.x2||i,u=t.y2||o,c=t.values,f=c?t=>c[t]:Ut,d=$u(l-a,u-s),h=d.getContext("2d"),p=h.getImageData(0,0,l-a,u-s),m=p.data;for(let g=s,y=0;g<u;++g){e.$y=g-s;for(let t=a,o=g*i;t<l;++t,y+=4){e.$x=t-a,e.$value=f(t+o);const i=n(e);m[y+0]=i.r,m[y+1]=i.g,m[y+2]=i.b,m[y+3]=~~(255*r(e))}}return h.putImageData(p,0,0),d}(e,n,a.dep?a:xe(a(n)),o.dep?o:xe(o(n)))})),e.reflow(!0).modifies(s)}}),Se(aA,ns,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=Sk((t||"mercator").toLowerCase());return e||Rt("Unrecognized projection type: "+t),e()}(t.type),Ck.forEach((e=>{null!=t[e]&&sA(n,e,t[e])}))):Ck.forEach((e=>{t.modified(e)&&sA(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return 1===(t=de(t)).length?t[0]:{type:Jk,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===Jk?t.features:de(t).filter((t=>null!=t)).map((t=>t.type===Qk?t:{type:Qk,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var mA=dA.prototype=hA.prototype;function gA(t){return function(){return t}}function yA(t){return 1e-6*(t()-.5)}function vA(t){return t.x+t.vx}function bA(t){return t.y+t.vy}mA.copy=function(){var t,e,n=new hA(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=pA(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=pA(e));return n},mA.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return lA(this.cover(e,n),e,n,t)},mA.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>f&&(f=i));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<o;++n)lA(this,a[n],s[n],t[n]);return this},mA.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,l=i-n||1,u=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},mA.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},mA.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},mA.find=function(t,e,n){var r,i,o,a,s,l,u,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new uA(m,c,f,d,h)),null==n?n=1/0:(c=t-n,f=e-n,d=t+n,h=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(o=l.y0)>h||(a=l.x1)<c||(s=l.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new uA(m[3],g,y,a,s),new uA(m[2],i,y,g,s),new uA(m[1],g,o,a,y),new uA(m[0],i,o,g,y)),(u=(e>=y)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var v=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=v*v+b*b;if(x<n){var _=Math.sqrt(n=x);c=t-_,f=e-_,d=t+_,h=e+_,r=m.data}}return r},mA.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,l,u,c,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((u=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(l=(m+y)/2))?m=l:y=l,e=h,!(h=h[f=c<<1|u]))return this;if(!h.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,d=f)}for(;h.data!==t;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(h=e[0]||e[1]||e[2]||e[3])&&h===(e[3]||e[2]||e[1]||e[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},mA.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},mA.root=function(){return this._root},mA.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},mA.visit=function(t){var e,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new uA(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&l.length){var u=(r+o)/2,c=(i+a)/2;(n=l[3])&&s.push(new uA(n,u,c,o,a)),(n=l[2])&&s.push(new uA(n,r,c,u,a)),(n=l[1])&&s.push(new uA(n,u,i,o,c)),(n=l[0])&&s.push(new uA(n,r,i,u,c))}return this},mA.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new uA(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(a+l)/2,f=(s+u)/2;(o=i[0])&&n.push(new uA(o,a,s,c,f)),(o=i[1])&&n.push(new uA(o,c,s,l,f)),(o=i[2])&&n.push(new uA(o,a,f,c,u)),(o=i[3])&&n.push(new uA(o,c,f,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},mA.x=function(t){return arguments.length?(this._x=t,this):this._x},mA.y=function(t){return arguments.length?(this._y=t,this):this._y};var xA={value:()=>{}};function _A(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new wA(r)}function wA(t){this._=t}function kA(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function AA(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=xA,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}wA.prototype=_A.prototype={constructor:wA,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(n=(t=o[a]).type)i[n]=AA(i[n],t.name,e);else if(null==e)for(n in i)i[n]=AA(i[n],t.name,null);return this}for(;++a<s;)if((n=(t=o[a]).type)&&(n=kA(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new wA(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const EA=_A;var MA,CA,SA=0,DA=0,FA=0,TA=1e3,NA=0,OA=0,zA=0,RA="object"==typeof performance&&performance.now?performance:Date,PA="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function BA(){return OA||(PA(LA),OA=RA.now()+zA)}function LA(){OA=0}function jA(){this._call=this._time=this._next=null}function UA(t,e,n){var r=new jA;return r.restart(t,e,n),r}function qA(){OA=(NA=RA.now())+zA,SA=DA=0;try{!function(){BA(),++SA;for(var t,e=MA;e;)(t=OA-e._time)>=0&&e._call.call(void 0,t),e=e._next;--SA}()}finally{SA=0,function(){for(var t,e,n=MA,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:MA=e);CA=t,WA(r)}(),OA=0}}function IA(){var t=RA.now(),e=t-NA;e>TA&&(zA-=e,NA=t)}function WA(t){SA||(DA&&(DA=clearTimeout(DA)),t-OA>24?(t<1/0&&(DA=setTimeout(qA,t-RA.now()-zA)),FA&&(FA=clearInterval(FA))):(FA||(NA=RA.now(),FA=setInterval(IA,TA)),SA=1,PA(qA)))}jA.prototype=UA.prototype={constructor:jA,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?BA():+n)+(null==e?0:+e),this._next||CA===this||(CA?CA._next=this:MA=this,CA=this),this._call=t,this._time=n,WA()},stop:function(){this._call&&(this._call=null,this._time=1/0,WA())}};const $A=4294967296;function HA(t){return t.x}function ZA(t){return t.y}var YA=Math.PI*(3-Math.sqrt(5));function VA(t){return t.index}function GA(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const XA={center:function(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,l=0;for(i=0;i<a;++i)s+=(o=n[i]).x,l+=o.y;for(s=(s/a-t)*r,l=(l/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=l}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,o=1;function a(){for(var t,a,l,u,c,f,d,h=e.length,p=0;p<o;++p)for(a=dA(e,vA,bA).visitAfter(s),t=0;t<h;++t)l=e[t],f=n[l.index],d=f*f,u=l.x+l.vx,c=l.y+l.vy,a.visit(m);function m(t,e,n,o,a){var s=t.data,h=t.r,p=f+h;if(!s)return e>u+p||o<u-p||n>c+p||a<c-p;if(s.index>l.index){var m=u-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=yA(r))*m),0===g&&(y+=(g=yA(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,l.vx+=(m*=y)*(p=(h*=h)/(d+h)),l.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=gA(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,l()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:gA(+e),l(),a):t},a},nbody:function(){var t,e,n,r,i,o=gA(-30),a=1,s=1/0,l=.81;function u(n){var i,o=t.length,a=dA(t,HA,ZA).visitAfter(f);for(r=n,i=0;i<o;++i)e=t[i],a.visit(d)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function f(t){var e,n,r,o,a,s=0,l=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,l+=n,r+=n*e.x,o+=n*e.y);t.x=r/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,o,u,c){if(!t.value)return!0;var f=t.x-e.x,d=t.y-e.y,h=c-o,p=f*f+d*d;if(h*h/l<p)return p<s&&(0===f&&(p+=(f=yA(n))*f),0===d&&(p+=(d=yA(n))*d),p<a&&(p=Math.sqrt(a*p)),e.vx+=f*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===f&&(p+=(f=yA(n))*f),0===d&&(p+=(d=yA(n))*d),p<a&&(p=Math.sqrt(a*p)));do{t.data!==e&&(h=i[t.data.index]*r/p,e.vx+=f*h,e.vy+=d*h)}while(t=t.next)}}return u.initialize=function(e,r){t=e,n=r,c()},u.strength=function(t){return arguments.length?(o="function"==typeof t?t:gA(+t),c(),u):o},u.distanceMin=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u},link:function(t){var e,n,r,i,o,a,s=VA,l=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=gA(30),c=1;function f(r){for(var i=0,s=t.length;i<c;++i)for(var l,u,f,d,h,p,m,g=0;g<s;++g)u=(l=t[g]).source,d=(f=l.target).x+f.vx-u.x-u.vx||yA(a),h=f.y+f.vy-u.y-u.vy||yA(a),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*e[g],h*=p,f.vx-=d*(m=o[g]),f.vy-=h*m,u.vx+=d*(m=1-m),u.vy+=h*m}function d(){if(r){var a,l,u=r.length,c=t.length,f=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(a=0,i=new Array(u);a<c;++a)(l=t[a]).index=a,"object"!=typeof l.source&&(l.source=GA(f,l.source)),"object"!=typeof l.target&&(l.target=GA(f,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)l=t[a],o[a]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);e=new Array(c),h(),n=new Array(c),p()}}function h(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+l(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,a=e,d()},f.links=function(e){return arguments.length?(t=e,d(),f):t},f.id=function(t){return arguments.length?(s=t,f):s},f.iterations=function(t){return arguments.length?(c=+t,f):c},f.strength=function(t){return arguments.length?(l="function"==typeof t?t:gA(+t),h(),f):l},f.distance=function(t){return arguments.length?(u="function"==typeof t?t:gA(+t),p(),f):u},f},x:function(t){var e,n,r,i=gA(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=gA(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:gA(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:gA(+e),a(),o):t},o},y:function(t){var e,n,r,i=gA(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=gA(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:gA(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:gA(+e),a(),o):t},o}},QA="forces",JA=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],KA=["static","iterations"],tE=["x","y","vx","vy"];function eE(t){ns.call(this,null,t)}function nE(t,e,n,r){var i,o,a,s,l=de(e.forces);for(i=0,o=JA.length;i<o;++i)(a=JA[i])!==QA&&e.modified(a)&&t[a](e[a]);for(i=0,o=l.length;i<o;++i)s=QA+i,(a=n||e.modified(QA,i)?iE(l[i]):r&&rE(l[i],r)?t.force(s):null)&&t.force(s,a);for(o=t.numForces||0;i<o;++i)t.force(QA+i,null);return t.numForces=l.length,t}function rE(t,e){var n,r;for(n in t)if(he(r=t[n])&&e.modified(Tt(r)))return 1;return 0}function iE(t){var e,n;for(n in Ee(XA,t.force)||Rt("Unrecognized force: "+t.force),e=XA[t.force](),t)he(e[n])&&oE(e[n],t[n],t);return e}function oE(t,e,n){t(he(e)?t=>e(t,n):e)}function aE(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function sE(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=uE)):void 0===e&&(e=lE);for(var n,r,i,o,a,s=new dE(t),l=[s];n=l.pop();)if((i=e(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)l.push(r=i[o]=new dE(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(fE)}function lE(t){return t.children}function uE(t){return Array.isArray(t)?t[1]:null}function cE(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function fE(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function dE(t){this.data=t,this.depth=this.height=0,this.parent=null}function hE(t){return null==t?null:pE(t)}function pE(t){if("function"!=typeof t)throw new Error;return t}function mE(){return 0}function gE(t){return function(){return t}}eE.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:tE}]},Se(eE,ns,{transform(t,e){var n,r,i=this.value,o=e.changed(e.ADD_REM),a=t.modified(JA),s=t.iterations||300;if(i?(o&&(e.modifies("index"),i.nodes(e.source)),(a||e.changed(e.MOD))&&nE(i,t,0,e)):(this.value=i=function(t,e){const n=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=UA(f),u=EA("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%$A)/$A}();function f(){d(),u.call("tick",e),n<r&&(l.stop(),u.call("end",e))}function d(r){var l,u,c=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),l=0;l<c;++l)null==(u=t[l]).fx?u.x+=u.vx*=a:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=a:(u.y=u.fy,u.vy=0);return e}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*YA;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),h(),e={tick:d,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(c=t,s.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,l,u=0,c=t.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(a=(i=e-(s=t[u]).x)*i+(o=n-s.y)*o)<r&&(l=s,r=a);return l},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),nE(n,e,!0).on("end",(()=>o=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(o=!0,i.tick()),e.modifies("index")),a||o||t.modified(KA)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let s,l=this._argops,u=0,c=l.length;u<c;++u)if(s=l[u],s.name===QA&&"link"===s.op._argval.force)for(var r,i=s.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(tE)}}),dE.prototype=sE.prototype={constructor:dE,count:function(){return this.eachAfter(aE)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(e,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return sE(this).eachBefore(cE)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};const yE=4294967296;function vE(t,e){var n,r;if(_E(e,t))return[e];for(n=0;n<t.length;++n)if(bE(e,t[n])&&_E(kE(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(bE(kE(t[n],t[r]),e)&&bE(kE(t[n],e),t[r])&&bE(kE(t[r],e),t[n])&&_E(AE(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function bE(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function xE(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function _E(t,e){for(var n=0;n<e.length;++n)if(!xE(t,e[n]))return!1;return!0}function wE(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return kE(t[0],t[1]);case 3:return AE(t[0],t[1],t[2])}var e}function kE(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,l=o-n,u=a-r,c=s-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+s)/2}}function AE(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,l=e.r,u=n.x,c=n.y,f=n.r,d=r-a,h=r-u,p=i-s,m=i-c,g=l-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+l*l,x=v-u*u-c*c+f*f,_=h*p-d*m,w=(p*x-m*b)/(2*_)-r,k=(m*g-p*y)/_,A=(h*b-d*x)/(2*_)-i,E=(d*y-h*g)/_,M=k*k+E*E-1,C=2*(o+w*k+A*E),S=w*w+A*A-o*o,D=-(Math.abs(M)>1e-6?(C+Math.sqrt(C*C-4*M*S))/(2*M):S/C);return{x:r+w+k*D,y:i+A+E*D,r:D}}function EE(t,e,n){var r,i,o,a,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(i=e.r+n.r,i*=i,a=t.r+n.r,i>(a*=a)?(r=(u+a-i)/(2*u),o=Math.sqrt(Math.max(0,a/u-r*r)),n.x=t.x-r*s-o*l,n.y=t.y-r*l+o*s):(r=(u+i-a)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*s-o*l,n.y=e.y+r*l+o*s)):(n.x=e.x+n.r,n.y=e.y)}function ME(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function CE(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function SE(t){this._=t,this.next=null,this.previous=null}function DE(t){return Math.sqrt(t.value)}function FE(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function TE(t,e,n){return function(r){if(i=r.children){var i,o,a,s=i.length,l=t(r)*e||0;if(l)for(o=0;o<s;++o)i[o].r+=l;if(a=function(t,e){if(!(o=(t=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,r,i,o,a,s,l,u,c,f,d;if((n=t[0]).x=0,n.y=0,!(o>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;EE(r,n,i=t[2]),n=new SE(n),r=new SE(r),i=new SE(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(l=3;l<o;++l){EE(n._,r._,i=t[l]),i=new SE(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(ME(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue t}f+=u._.r,u=u.next}else{if(ME(c._,i._)){(n=c).next=r,r.previous=n,--l;continue t}d+=c._.r,c=c.previous}}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=CE(n);(i=i.next)!==r;)(s=CE(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=function(t,e){for(var n,r,i=0,o=(t=function(t,e){let n,r,i=t.length;for(;i;)r=e()*i--|0,n=t[i],t[i]=t[r],t[r]=n;return t}(Array.from(t),e)).length,a=[];i<o;)n=t[i],r&&xE(r,n)?++i:(r=wE(a=vE(a,n)),i=0);return r}(n,e),l=0;l<o;++l)(n=t[l]).x-=i.x,n.y-=i.y;return i.r}(i,n),l)for(o=0;o<s;++o)i[o].r-=l;r.r=a+l}}}function NE(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function OE(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function zE(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(r-e)/t.value;++s<l;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*u}var RE={depth:-1},PE={},BE={};function LE(t){return t.id}function jE(t){return t.parentId}function UE(){var t,e=LE,n=jE;function r(r){var i,o,a,s,l,u,c,f,d=Array.from(r),h=e,p=n,m=new Map;if(null!=t){const e=d.map(((e,n)=>function(t){let e=(t="".concat(t)).length;return IE(t,e-1)&&!IE(t,e-2)&&(t=t.slice(0,-1)),"/"===t[0]?t:"/".concat(t)}(t(e,n,r)))),n=e.map(qE),i=new Set(e).add("");for(const t of n)i.has(t)||(i.add(t),e.push(t),n.push(qE(t)),d.push(BE));h=(t,n)=>e[n],p=(t,e)=>n[e]}for(a=0,i=d.length;a<i;++a)o=d[a],u=d[a]=new dE(o),null!=(c=h(o,a,r))&&(c+="")&&(f=u.id=c,m.set(f,m.has(f)?PE:u)),null!=(c=p(o,a,r))&&(c+="")&&(u.parent=c);for(a=0;a<i;++a)if(c=(u=d[a]).parent){if(!(l=m.get(c)))throw new Error("missing: "+c);if(l===PE)throw new Error("ambiguous: "+c);l.children?l.children.push(u):l.children=[u],u.parent=l}else{if(s)throw new Error("multiple roots");s=u}if(!s)throw new Error("no root");if(null!=t){for(;s.data===BE&&1===s.children.length;)s=s.children[0],--i;for(let t=d.length-1;t>=0&&(u=d[t]).data===BE;--t)u.data=null}if(s.parent=RE,s.eachBefore((function(t){t.depth=t.parent.depth+1,--i})).eachBefore(fE),s.parent=null,i>0)throw new Error("cycle");return s}return r.id=function(t){return arguments.length?(e=hE(t),r):e},r.parentId=function(t){return arguments.length?(n=hE(t),r):n},r.path=function(e){return arguments.length?(t=hE(e),r):t},r}function qE(t){let e=t.length;if(e<2)return"";for(;--e>1&&!IE(t,e););return t.slice(0,e)}function IE(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}function WE(t,e){return t.parent===e.parent?1:2}function $E(t){var e=t.children;return e?e[0]:t.t}function HE(t){var e=t.children;return e?e[e.length-1]:t.t}function ZE(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function YE(t,e,n){return t.a.parent===e.parent?t.a:n}function VE(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function GE(t,e){return t.parent===e.parent?1:2}function XE(t,e){return t+e.x}function QE(t,e){return Math.max(t,e.y)}function JE(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(i-n)/t.value;++s<l;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*u}VE.prototype=Object.create(dE.prototype);var KE=(1+Math.sqrt(5))/2;function tM(t,e,n,r,i,o){for(var a,s,l,u,c,f,d,h,p,m,g,y=[],v=e.children,b=0,x=0,_=v.length,w=e.value;b<_;){l=i-n,u=o-r;do{c=v[x++].value}while(!c&&x<_);for(f=d=c,g=c*c*(m=Math.max(u/l,l/u)/(w*t)),p=Math.max(d/g,g/f);x<_;++x){if(c+=s=v[x].value,s<f&&(f=s),s>d&&(d=s),g=c*c*m,(h=Math.max(d/g,g/f))>p){c-=s;break}p=h}y.push(a={value:c,dice:l<u,children:v.slice(b,x)}),a.dice?zE(a,n,r,i,w?r+=u*c/w:o):JE(a,n,r,w?n+=l*c/w:i,o),w-=c,b=x}return y}const eM=function t(e){function n(t,n,r,i,o){tM(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(KE),nM=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,l,u,c,f=-1,d=a.length,h=t.value;++f<d;){for(l=(s=a[f]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?zE(s,n,r,i,h?r+=(o-r)*s.value/h:o):JE(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else t._squarify=a=tM(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(KE);function rM(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function iM(t){ns.call(this,null,t)}iM.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const oM=t=>t.values;function aM(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,o=t[r++],a={},s={};let l,u,c,f=-1;for(;++f<i;)l=o(u=e[f])+"",(c=a[l])?c.push(u):a[l]=[u];for(l in a)s[l]=n(a[l],r);return s}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function sM(t){ns.call(this,null,t)}Se(iM,ns,{transform(t,e){e.source||Rt("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each((t=>{t.children&&ka(t.data)&&i.rem.push(t.data)})),this.value=o=sE({values:de(t.keys).reduce(((t,e)=>(t.key(e),t)),aM()).entries(i.source)},oM),n&&o.each((t=>{t.children&&(t=Ma(t.data),i.add.push(t),i.source.push(t))})),rM(o,Aa,Aa)),i.source.root=o,i}});const lM=(t,e)=>t.parent===e.parent?1:2;Se(sM,ns,{transform(t,e){e.source&&e.source.root||Rt(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(Fa(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?lM:qt);try{this.value=n(i)}catch(t){Rt(t)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}(t,r,o))),e.reflow(t.modified()).modifies(o).modifies("leaf")}});const uM=["x","y","r","depth","children"];function cM(t){sM.call(this,t)}cM.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:uM.length,default:uM}]},Se(cM,sM,{layout:function(){var t=null,e=1,n=1,r=mE;function i(i){const o=function(){let t=1;return()=>(t=(1664525*t+1013904223)%yE)/yE}();return i.x=e/2,i.y=n/2,t?i.eachBefore(FE(t)).eachAfter(TE(r,.5,o)).eachBefore(NE(1)):i.eachBefore(FE(DE)).eachAfter(TE(mE,1,o)).eachAfter(TE(r,i.r/Math.min(e,n),o)).eachBefore(NE(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=hE(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:gE(+t),i):r},i},params:["radius","size","padding"],fields:uM});const fM=["x0","y0","x1","y1","depth","children"];function dM(t){sM.call(this,t)}function hM(t){ns.call(this,null,t)}dM.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:fM.length,default:fM}]},Se(dM,sM,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&zE(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(OE),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:fM}),hM.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Se(hM,ns,{transform(t,e){e.source||Rt("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?rM(UE().id(t.key).parentId(t.parentKey)(i.source),t.key,It):rM(UE()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const pM={tidy:function(){var t=WE,e=1,n=1,r=null;function i(i){var l=function(t){for(var e,n,r,i,o,a=new VE(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new VE(r[i],i)),n.parent=e;return(a.parent=new VE(null,0)).children=[a],a}(i);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),r)i.eachBefore(s);else{var u=i,c=i,f=i;i.eachBefore((function(t){t.x<u.x&&(u=t),t.x>c.x&&(c=t),t.depth>f.depth&&(f=t)}));var d=u===c?1:t(u,c)/2,h=d-u.x,p=e/(c.x+d+h),m=n/(f.depth||1);i.eachBefore((function(t){t.x=(t.x+h)*p,t.y=t.depth*m}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,l=o.parent.children[0],u=o.m,c=a.m,f=s.m,d=l.m;s=HE(s),o=$E(o),s&&o;)l=$E(l),(a=HE(a)).a=e,(i=s.z+f-o.z-u+t(s._,o._))>0&&(ZE(YE(s,e,r),e,i),u+=i,c+=i),f+=s.m,u+=o.m,d+=l.m,c+=a.m;s&&!HE(a)&&(a.t=s,a.m+=f-c),o&&!$E(l)&&(l.t=o,l.m+=u-d,r=e)}return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=GE,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(XE,0)/t.length}(n),e.y=function(t){return 1+t.reduce(QE,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),l=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),u=s.x-t(s,l)/2,c=l.x+t(l,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-u)/(c-u)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},mM=["x","y","depth","children"];function gM(t){sM.call(this,t)}function yM(t){ns.call(this,[],t)}gM.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:mM.length,default:mM}]},Se(gM,sM,{layout(t){const e=t||"tidy";if(Ee(pM,e))return pM[e]();Rt("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:mM}),yM.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Se(yM,ns,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||Rt("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>o[Aa(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[Aa(e)]&&o[Aa(n)]&&i.add.push(Ma({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>o[Aa(t)]=1)),n.forEach((t=>{(o[Aa(t.source)]||o[Aa(t.target)])&&i.mod.push(t)}))),i}});const vM={binary:function(t,e,n,r,i){var o,a,s=t.children,l=s.length,u=new Array(l+1);for(u[0]=a=o=0;o<l;++o)u[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,l){if(e>=n-1){var c=s[e];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=l)}for(var f=u[e],d=r/2+f,h=e+1,p=n-1;h<p;){var m=h+p>>>1;u[m]<d?h=m+1:p=m}d-u[h-1]<u[h]-d&&e+1<h&&--h;var g=u[h]-f,y=r-g;if(a-i>l-o){var v=r?(i*y+a*g)/r:a;t(e,h,g,i,o,v,l),t(h,n,y,v,o,a,l)}else{var b=r?(o*y+l*g)/r:l;t(e,h,g,i,o,a,b),t(h,n,y,i,b,a,l)}}(0,l,t.value,e,n,r,i)},dice:zE,slice:JE,slicedice:function(t,e,n,r,i){(1&t.depth?JE:zE)(t,e,n,r,i)},squarify:eM,resquarify:nM},bM=["x0","y0","x1","y1","depth","children"];function xM(t){sM.call(this,t)}xM.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:bM.length,default:bM}]},Se(xM,sM,{layout(){const t=function(){var t=eM,e=!1,n=1,r=1,i=[0],o=mE,a=mE,s=mE,l=mE,u=mE;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(f),i=[0],e&&t.eachBefore(OE),t}function f(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,f=e.x1-n,d=e.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),e.x0=r,e.y0=c,e.x1=f,e.y1=d,e.children&&(n=i[e.depth+1]=o(e)/2,r+=u(e)-n,c+=a(e)-n,(f-=s(e)-n)<r&&(r=f=(r+f)/2),(d-=l(e)-n)<c&&(c=d=(c+d)/2),t(e,r,c,f,d))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=pE(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:gE(+t),c):o},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:gE(+t),c):a},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:gE(+t),c):s},c.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:gE(+t),c):l},c.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:gE(+t),c):u},c}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{Ee(vM,e)?t.tile(vM[e]):Rt("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:bM});const _M=4278190080;function wM(t,e,n){return new Uint32Array(t.getImageData(0,0,e,n).data.buffer)}function kM(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>kM(t,e.items,n)))})):ny[r].draw(t,{items:n?e.map(AM):e})}function AM(t){const e=Sa(t,{});return e.stroke&&0!==e.strokeOpacity||e.fill&&0!==e.fillOpacity?{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}:e}const EM=31,MM=new Uint32Array(33),CM=new Uint32Array(33);CM[0]=0,MM[0]=~CM[0];for(let n=1;n<=32;++n)CM[n]=CM[n-1]<<1|1,MM[n]=~CM[n];function SM(t,e,n,r,i,o){let a=n/2;return t-a<0||t+a>i||e-(a=r/2)<0||e+a>o}function DM(t,e,n,r,i,o,a,s){const l=i*o/(2*r),u=t(e-l),c=t(e+l),f=t(n-(o/=2)),d=t(n+o);return a.outOfBounds(u,f,c,d)||a.getRange(u,f,c,d)||s&&s.getRange(u,f,c,d)}const FM=[-1,-1,1,1],TM=[-1,1,-1,1],NM=["right","center","left"],OM=["bottom","middle","top"];function zM(t,e,n,r,i,o,a,s,l,u,c,f){return!(i.outOfBounds(t,n,e,r)||(f&&o||i).getRange(t,n,e,r))}const RM={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},PM={naive:function(t,e,n,r){const i=t.width,o=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,a=t.datum.fontSize,s=Pg.width(t.datum,t.datum.text);let l,u,c,f,d,h,p,m=0;for(let r=0;r<n;++r)l=e[r].x,c=e[r].y,u=void 0===e[r].x2?l:e[r].x2,f=void 0===e[r].y2?c:e[r].y2,d=(l+u)/2,h=(c+f)/2,p=Math.abs(u-l+f-c),p>=m&&(m=p,t.x=d,t.y=h);return d=s/2,h=a/2,l=t.x-d,u=t.x+d,c=t.y-h,f=t.y+h,t.align="center",l<0&&u<=i?t.align="left":0<=l&&i<u&&(t.align="right"),t.baseline="middle",c<0&&f<=o?t.baseline="top":0<=c&&o<f&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1];function l(e,n,r,l,u){const c=t.invert(e),f=t.invert(n);let d,h=r,p=o;if(!SM(c,f,l,u,i,o)&&!DM(t,c,f,u,l,h,a,s)&&!DM(t,c,f,u,l,u,a,null)){for(;p-h>=1;)d=(h+p)/2,DM(t,c,f,u,l,d,a,s)?p=d:h=d;if(h>r)return[c,f,h,!0]}}return function(e){const s=e.datum.datum.items[r].items,u=s.length,c=e.datum.fontSize,f=Pg.width(e.datum,e.datum.text);let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C,S,D=n?c:0,F=!1,T=!1,N=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,h=void 0===s[r].x2?d:s[r].x2,m=void 0===s[r].y2?p:s[r].y2,d>h&&(S=d,d=h,h=S),p>m&&(S=p,p=m,m=S),x=t(d),w=t(h),_=~~((x+w)/2),k=t(p),E=t(m),A=~~((k+E)/2),v=_;v>=x;--v)for(b=A;b>=k;--b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);for(v=_;v<=w;++v)for(b=A;b<=E;++b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);F||n||(M=Math.abs(h-d+m-p),g=(d+h)/2,y=(p+m)/2,M>=N&&!SM(g,y,f,c,i,o)&&!DM(t,g,y,c,f,c,a,null)&&(N=M,e.x=g,e.y=y,T=!0))}return!(!F&&!T||(g=f/2,y=c/2,a.setRange(t(e.x-g),t(e.y-y),t(e.x+g),t(e.y+y)),e.align="center",e.baseline="middle",0))}},floodfill:function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=t.bitmap();return function(e){const u=e.datum.datum.items[r].items,c=u.length,f=e.datum.fontSize,d=Pg.width(e.datum,e.datum.text),h=[];let p,m,g,y,v,b,x,_,w,k,A,E,M=n?f:0,C=!1,S=!1,D=0;for(let r=0;r<c;++r){for(p=u[r].x,g=u[r].y,m=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?g:u[r].y2,h.push([t((p+m)/2),t((g+y)/2)]);h.length;)if([x,_]=h.pop(),!(a.get(x,_)||s.get(x,_)||l.get(x,_))){l.set(x,_);for(let t=0;t<4;++t)v=x+FM[t],b=_+TM[t],l.outOfBounds(v,b,v,b)||h.push([v,b]);if(v=t.invert(x),b=t.invert(_),w=M,k=o,!SM(v,b,d,f,i,o)&&!DM(t,v,b,f,d,w,a,s)&&!DM(t,v,b,f,d,f,a,null)){for(;k-w>=1;)A=(w+k)/2,DM(t,v,b,f,d,A,a,s)?k=A:w=A;w>M&&(e.x=v,e.y=b,M=w,C=!0)}}C||n||(E=Math.abs(m-p+y-g),v=(p+m)/2,b=(g+y)/2,E>=D&&!SM(v,b,d,f,i,o)&&!DM(t,v,b,f,d,f,a,null)&&(D=E,e.x=v,e.y=b,S=!0))}return!(!C&&!S||(v=d/2,b=f/2,a.setRange(t(e.x-v),t(e.y-b),t(e.x+v),t(e.y+b)),e.align="center",e.baseline="middle",0))}}},BM=["x","y","opacity","align","baseline"],LM=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function jM(t){ns.call(this,null,t)}function UM(t,e){var n,r,i,o,a,s,l=[],u=function(t){return t(o)};if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}function qM(t){ns.call(this,null,t)}jM.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:LM},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:BM.length,default:BM}]},Se(jM,ns,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t.sort;return he(r)&&e.modified(r.fields)}()))return;t.size&&2===t.size.length||Rt("Size parameter should be specified as a [width, height] array.");const r=t.as||BM;return function(t,e,n,r,i,o,a,s,l,u,c){if(!t.length)return t;const f=Math.max(r.length,i.length),d=function(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}(r,f),h=function(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=RM[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}(i,f),p=(x=t[0].datum)&&x.mark&&x.mark.marktype,m="group"===p&&t[0].datum.items[l].marktype,g="area"===m,y=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,m,s,l),v=null===u||u===1/0,b=g&&"naive"===c;var x;let _=-1,w=-1;const k=t.map((t=>{const e=v?Pg.width(t,t.text):void 0;return _=Math.max(_,e),w=Math.max(w,t.fontSize),{datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t),textWidth:e}}));u=null===u||u===1/0?Math.max(_,w)+Math.max(...r):u;const A=function(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),a=t=>~~((t+n)/r);return a.invert=t=>t*r-n,a.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+32)/32));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>5]&1<<(i&EM)},set:(e,n)=>{const i=n*t+e;r(i>>>5,1<<(i&EM))},clear:(e,n)=>{const r=n*t+e;i(r>>>5,~(1<<(r&EM)))},getRange:(e,r,i,o)=>{let a,s,l,u,c=o;for(;c>=r;--c)if(a=c*t+e,s=c*t+i,l=a>>>5,u=s>>>5,l===u){if(n[l]&MM[a&EM]&CM[1+(s&EM)])return!0}else{if(n[l]&MM[a&EM])return!0;if(n[u]&CM[1+(s&EM)])return!0;for(let t=l+1;t<u;++t)if(n[t])return!0}return!1},setRange:(e,n,i,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+i,l=a>>>5,u=s>>>5,l===u)r(l,MM[a&EM]&CM[1+(s&EM)]);else for(r(l,MM[a&EM]),r(u,CM[1+(s&EM)]),c=l+1;c<u;++c)r(c,4294967295)},clearRange:(e,n,r,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+r,l=a>>>5,u=s>>>5,l===u)i(l,CM[a&EM]|MM[1+(s&EM)]);else for(i(l,CM[a&EM]),i(u,MM[1+(s&EM)]),c=l+1;c<u;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=e||i>=t}}(i,o),a.ratio=r,a.padding=n,a.width=t,a.height=e,a}(e[0],e[1],u);let E;if(!b){n&&k.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<h.length&&!e;++t)e=5===h[t]||d[t]<0;const r=(p&&a||g)&&t.map((t=>t.datum));E=o.length||r?function(t,e,n,r,i){const o=t.width,a=t.height,s=r||i,l=$u(o,a).getContext("2d"),u=$u(o,a).getContext("2d"),c=s&&$u(o,a).getContext("2d");n.forEach((t=>kM(l,t,!1))),kM(u,e,!1),s&&kM(c,e,!0);const f=wM(l,o,a),d=wM(u,o,a),h=s&&wM(c,o,a),p=t.bitmap(),m=s&&t.bitmap();let g,y,v,b,x,_,w,k;for(y=0;y<a;++y)for(g=0;g<o;++g)x=y*o+g,_=f[x]&_M,k=d[x]&_M,w=s&&h[x]&_M,(_||w||k)&&(v=t(g),b=t(y),i||!_&&!k||p.set(v,b),s&&(_||w)&&m.set(v,b));return[p,m]}(A,r||[],o,e,g):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(A,a&&k)}const M=g?PM[c](A,E,a,l):function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=r.length;return function(e){var u;const c=e.boundary,f=e.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C=null!==(u=e.textWidth)&&void 0!==u?u:0;for(let i=0;i<l;++i){if(d=(3&n[i])-1,h=(n[i]>>>2&3)-1,p=0===d&&0===h||r[i]<0,m=d&&h?Math.SQRT1_2:1,g=r[i]<0?-1:1,y=c[1+d]+r[i]*d*m,w=c[4+h]+g*f*h/2+r[i]*h*m,b=w-f/2,x=w+f/2,k=t(y),E=t(b),M=t(x),!C){if(!zM(k,k,E,M,a,s,0,0,0,0,0,p))continue;C=Pg.width(e.datum,e.datum.text)}if(_=y+g*C*d/2,y=_-C/2,v=_+C/2,k=t(y),A=t(v),zM(k,A,E,M,a,s,0,0,0,0,0,p))return e.x=d?d*g<0?v:y:_,e.y=h?h*g<0?x:b:w,e.align=NM[d*g+1],e.baseline=OM[h*g+1],a.setRange(k,E,A,M),!0}return!1}}(A,E,h,d);return k.forEach((t=>t.opacity=+M(t))),k}(e.materialize(e.SOURCE).source||[],t.size,t.sort,de(null==t.offset?1:t.offset),de(t.anchor||LM),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),qM.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Se(qM,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=UM(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Ft),o=i.length,a=t.as||[Ft(t.x),Ft(t.y)],s=[];r.forEach((e=>{(function(t,e,n,r){const[i,o,a,s]=vt(t,e,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const t=[0,u-1];for(let n=0;n<l;++n){const e=i[n],r=t[0],a=t[1],s=e-i[r]>i[a]-e?r:a;let l=0,u=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-e||1);for(let t=r;t<=a;++t){const n=i[t],r=o[t],a=At(Math.abs(e-n)*g)*d[t],s=n*a;l+=a,u+=s,h+=r*a,p+=r*s,m+=n*s}const[y,v]=yt(u/l,h/l,p/l,m/l);c[n]=y+v*e,f[n]=Math.abs(o[n]-c[n]),Et(i,n+1,t)}if(2===h)break;const e=H(f);if(Math.abs(e)<1e-12)break;for(let n,r,i=0;i<l;++i)n=f[i]/(6*e),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,o=[];let a,s=0,l=0,u=[];for(;s<i;++s)a=t[s]+n,u[0]===a?u[1]+=(e[s]-u[1])/++l:(l=0,u[1]+=r,u=[a,e[s]],o.push(u));return u[1]+=r,o}(i,c,a,s)})(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let r=0;r<o;++r)n[i[r]]=e.dims[r];n[a[0]]=t[0],n[a[1]]=t[1],s.push(Ma(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const IM={constant:gt,linear:_t,log:function(t,e,n){let r=0,i=0,o=0,a=0,s=0;bt(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=yt(r,i,o,a),u=t=>l[0]+l[1]*Math.log(t);return{coef:l,predict:u,rSquared:xt(t,e,n,i,u)}},exp:function(t,e,n){const[r,i,o,a]=vt(t,e,n);let s,l,u,c=0,f=0,d=0,h=0,p=0;bt(t,e,n,((t,e)=>{s=r[p++],l=Math.log(e),u=s*e,c+=(e*l-c)/p,f+=(u-f)/p,d+=(u*l-d)/p,h+=(s*u-h)/p}));const[m,g]=yt(f/a,c/a,d/a,h/a),y=t=>Math.exp(m+g*(t-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:xt(t,e,n,a,y)}},pow:function(t,e,n){let r=0,i=0,o=0,a=0,s=0,l=0;bt(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++l,r+=(n-r)/l,i+=(u-i)/l,o+=(n*u-o)/l,a+=(n*n-a)/l,s+=(e-s)/l}));const u=yt(r,i,o,a),c=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:xt(t,e,n,s,c)}},quad:wt,poly:function(t,e,n,r){if(0===r)return gt(t,e,n);if(1===r)return _t(t,e,n);if(2===r)return wt(t,e,n);const[i,o,a,s]=vt(t,e,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d)*o[p];for(u.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(u);const y=function(t){const e=t.length-1,n=[];let r,i,o,a,s;for(r=0;r<e;++r){for(a=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][a])&&(a=i);for(o=r;o<e+1;++o)s=t[o][r],t[o][r]=t[o][a],t[o][a]=s;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,o=i+1;o<e;++o)s+=t[o][i]*n[o];n[i]=(t[e][i]-s)/t[i][i]}return n}(c),v=t=>{t-=a;let e=s+y[0]+y[1]*t+y[2]*t*t;for(d=3;d<f;++d)e+=y[d]*Math.pow(t,d);return e};return{coef:kt(f,y,-a,s),predict:v,rSquared:xt(t,e,n,s,v)}}};function WM(t){ns.call(this,null,t)}WM.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(IM)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Se(WM,ns,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=UM(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Ft),o=t.method||"linear",a=null==t.order?3:t.order,s=((t,e)=>"poly"===t?e:"quad"===t?2:1)(o,a),l=t.as||[Ft(t.x),Ft(t.y)],u=IM[o],c=[];let f=t.extent;Ee(IM,o)||Rt("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=s)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,t.x,t.y,a);if(t.params)return void c.push(Ma({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=f||ke(n,t.x),h=t=>{const e={};for(let r=0;r<i.length;++r)e[i[r]]=n.dims[r];e[l[0]]=t[0],e[l[1]]=t[1],c.push(Ma(e))};"linear"===o||"constant"===o?d.forEach((t=>h([t,r.predict(t)]))):Ct(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});const $M=134217729;function HM(t,e,n,r,i){let o,a,s,l,u=e[0],c=r[0],f=0,d=0;c>u==c>-u?(o=u,u=e[++f]):(o=c,c=r[++d]);let h=0;if(f<t&&d<n)for(c>u==c>-u?(a=u+o,s=o-(a-u),u=e[++f]):(a=c+o,s=o-(a-c),c=r[++d]),o=a,0!==s&&(i[h++]=s);f<t&&d<n;)c>u==c>-u?(a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f]):(a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d]),o=a,0!==s&&(i[h++]=s);for(;f<t;)a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f],o=a,0!==s&&(i[h++]=s);for(;d<n;)a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d],o=a,0!==s&&(i[h++]=s);return 0===o&&0!==h||(i[h++]=o),h}function ZM(t){return new Float64Array(t)}const YM=ZM(4),VM=ZM(8),GM=ZM(12),XM=ZM(16),QM=ZM(4);function JM(t,e,n,r,i,o){const a=(e-o)*(n-i),s=(t-i)*(r-o),l=a-s,u=Math.abs(a+s);return Math.abs(l)>=33306690738754716e-32*u?l:-function(t,e,n,r,i,o,a){let s,l,u,c,f,d,h,p,m,g,y,v,b,x,_,w,k,A;const E=t-i,M=n-i,C=e-o,S=r-o;x=E*S,d=$M*E,h=d-(d-E),p=E-h,d=$M*S,m=d-(d-S),g=S-m,_=p*g-(x-h*m-p*m-h*g),w=C*M,d=$M*C,h=d-(d-C),p=C-h,d=$M*M,m=d-(d-M),g=M-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,YM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,YM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,YM[2]=v-(A-f)+(y-f),YM[3]=A;let D=function(t,e){let n=e[0];for(let r=1;r<4;r++)n+=e[r];return n}(0,YM),F=22204460492503146e-32*a;if(D>=F||-D>=F)return D;if(f=t-E,s=t-(E+f)+(f-i),f=n-M,u=n-(M+f)+(f-i),f=e-C,l=e-(C+f)+(f-o),f=r-S,c=r-(S+f)+(f-o),0===s&&0===l&&0===u&&0===c)return D;if(F=11093356479670487e-47*a+33306690738754706e-32*Math.abs(D),D+=E*c+S*s-(C*u+M*l),D>=F||-D>=F)return D;x=s*S,d=$M*s,h=d-(d-s),p=s-h,d=$M*S,m=d-(d-S),g=S-m,_=p*g-(x-h*m-p*m-h*g),w=l*M,d=$M*l,h=d-(d-l),p=l-h,d=$M*M,m=d-(d-M),g=M-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,QM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,QM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,QM[2]=v-(A-f)+(y-f),QM[3]=A;const T=HM(4,YM,4,QM,VM);x=E*c,d=$M*E,h=d-(d-E),p=E-h,d=$M*c,m=d-(d-c),g=c-m,_=p*g-(x-h*m-p*m-h*g),w=C*u,d=$M*C,h=d-(d-C),p=C-h,d=$M*u,m=d-(d-u),g=u-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,QM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,QM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,QM[2]=v-(A-f)+(y-f),QM[3]=A;const N=HM(T,VM,4,QM,GM);x=s*c,d=$M*s,h=d-(d-s),p=s-h,d=$M*c,m=d-(d-c),g=c-m,_=p*g-(x-h*m-p*m-h*g),w=l*u,d=$M*l,h=d-(d-l),p=l-h,d=$M*u,m=d-(d-u),g=u-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,QM[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,QM[1]=b-(y+f)+(f-w),A=v+y,f=A-v,QM[2]=v-(A-f)+(y-f),QM[3]=A;const O=HM(N,GM,4,QM,XM);return XM[O-1]}(t,e,n,r,i,o,u)}ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(8),ZM(8),ZM(8),ZM(4),ZM(8),ZM(8),ZM(8),ZM(12),ZM(192),ZM(192),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(8),ZM(4),ZM(4),ZM(4),ZM(8),ZM(16),ZM(16),ZM(16),ZM(32),ZM(32),ZM(48),ZM(64),ZM(1152),ZM(1152),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(4),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(24),ZM(1152),ZM(1152),ZM(1152),ZM(1152),ZM(1152),ZM(2304),ZM(2304),ZM(3456),ZM(5760),ZM(8),ZM(8),ZM(8),ZM(16),ZM(24),ZM(48),ZM(48),ZM(96),ZM(192),ZM(384),ZM(384),ZM(384),ZM(768),ZM(96),ZM(96),ZM(96),ZM(1152);const KM=Math.pow(2,-52),tC=new Uint32Array(512);class eC{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sC,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lC;const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new eC(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let a=1/0,s=1/0,l=-1/0,u=-1/0;for(let E=0;E<o;E++){const e=t[2*E],n=t[2*E+1];e<a&&(a=e),n<s&&(s=n),e>l&&(l=e),n>u&&(u=n),this._ids[E]=E}const c=(a+l)/2,f=(s+u)/2;let d,h,p,m=1/0;for(let E=0;E<o;E++){const e=nC(c,f,t[2*E],t[2*E+1]);e<m&&(d=E,m=e)}const g=t[2*d],y=t[2*d+1];m=1/0;for(let E=0;E<o;E++){if(E===d)continue;const e=nC(g,y,t[2*E],t[2*E+1]);e<m&&e>0&&(h=E,m=e)}let v=t[2*h],b=t[2*h+1],x=1/0;for(let E=0;E<o;E++){if(E===d||E===h)continue;const e=iC(g,y,v,b,t[2*E],t[2*E+1]);e<x&&(p=E,x=e)}let _=t[2*p],w=t[2*p+1];if(x===1/0){for(let r=0;r<o;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];oC(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(JM(g,y,v,b,_,w)<0){const t=h,e=v,n=b;h=p,v=_,b=w,p=t,_=e,w=n}const k=function(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l);return{x:t+(u*c-s*f)*d,y:e+(a*f-l*c)*d}}(g,y,v,b,_,w);this._cx=k.x,this._cy=k.y;for(let E=0;E<o;E++)this._dists[E]=nC(t[2*E],t[2*E+1],k.x,k.y);oC(this._ids,this._dists,0,o-1),this._hullStart=d;let A=3;n[d]=e[p]=h,n[h]=e[d]=p,n[p]=e[h]=d,r[d]=0,r[h]=1,r[p]=2,i.fill(-1),i[this._hashKey(g,y)]=d,i[this._hashKey(v,b)]=h,i[this._hashKey(_,w)]=p,this.trianglesLen=0,this._addTriangle(d,h,p,-1,-1,-1);for(let E,M,C=0;C<this._ids.length;C++){const o=this._ids[C],a=t[2*o],s=t[2*o+1];if(C>0&&Math.abs(a-E)<=KM&&Math.abs(s-M)<=KM)continue;if(E=a,M=s,o===d||o===h||o===p)continue;let l=0;for(let t=0,e=this._hashKey(a,s);t<this._hashSize&&(l=i[(e+t)%this._hashSize],-1===l||l===n[l]);t++);l=e[l];let u,c=l;for(;u=n[c],JM(a,s,t[2*c],t[2*c+1],t[2*u],t[2*u+1])>=0;)if(c=u,c===l){c=-1;break}if(-1===c)continue;let f=this._addTriangle(c,o,n[c],-1,-1,r[c]);r[o]=this._legalize(f+2),r[c]=f,A++;let m=n[c];for(;u=n[m],JM(a,s,t[2*m],t[2*m+1],t[2*u],t[2*u+1])<0;)f=this._addTriangle(m,o,u,r[o],-1,r[m]),r[o]=this._legalize(f+2),n[m]=m,A--,m=u;if(c===l)for(;u=e[c],JM(a,s,t[2*u],t[2*u+1],t[2*c],t[2*c+1])<0;)f=this._addTriangle(u,o,c,-1,r[c],r[u]),this._legalize(f+2),r[u]=f,n[c]=c,A--,c=u;this._hullStart=e[o]=c,n[c]=e[m]=o,n[o]=m,i[this._hashKey(a,s)]=o,i[this._hashKey(t[2*c],t[2*c+1])]=c}this.hull=new Uint32Array(A);for(let E=0,M=this._hullStart;E<A;E++)this.hull[E]=M,M=n[M];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[t],s=t-t%3;if(o=s+(t+2)%3,-1===a){if(0===i)break;t=tC[--i];continue}const l=a-a%3,u=s+(t+1)%3,c=l+(a+2)%3,f=e[o],d=e[t],h=e[u],p=e[c];if(rC(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){e[t]=p,e[a]=f;const r=n[c];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(a,n[o]),this._link(o,c);const s=l+(a+1)%3;i<tC.length&&(tC[i++]=s)}else{if(0===i)break;t=tC[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function nC(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function rC(t,e,n,r,i,o,a,s){const l=t-a,u=e-s,c=n-a,f=r-s,d=i-a,h=o-s,p=c*c+f*f,m=d*d+h*h;return l*(f*m-p*h)-u*(c*m-p*d)+(l*l+u*u)*(c*h-f*d)<0}function iC(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=(u*c-s*f)*d,p=(a*f-l*c)*d;return h*h+p*p}function oC(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=n&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=n+1,o=r;aC(t,n+r>>1,i),e[t[n]]>e[t[r]]&&aC(t,n,r),e[t[i]]>e[t[r]]&&aC(t,i,r),e[t[n]]>e[t[i]]&&aC(t,n,i);const a=t[i],s=e[a];for(;;){do{i++}while(e[t[i]]<s);do{o--}while(e[t[o]]>s);if(o<i)break;aC(t,i,o)}t[n+1]=t[o],t[o]=a,r-i+1>=o-n?(oC(t,e,i,r),oC(t,e,n,o-1)):(oC(t,e,n,o-1),oC(t,e,i,r))}}function aC(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function sC(t){return t[0]}function lC(t){return t[1]}const uC=1e-6;class cC{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>uC||Math.abs(this._y1-i)>uC)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}rect(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class fC{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class dC{constructor(t){let[e,n,r,i]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(e=+e)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this;let i,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,y=0,v=n.length;g<v;g+=3,y+=2){const r=2*n[g],s=2*n[g+1],l=2*n[g+2],u=t[r],c=t[r+1],f=t[s],d=t[s+1],h=t[l],v=t[l+1],b=f-u,x=d-c,_=h-u,w=v-c,k=2*(b*w-x*_);if(Math.abs(k)<1e-9){if(void 0===i){i=o=0;for(const n of e)i+=t[2*n],o+=t[2*n+1];i/=e.length,o/=e.length}const n=1e9*Math.sign((i-u)*w-(o-c)*_);p=(u+h)/2-n*w,m=(c+v)/2+n*_}else{const t=1/k,e=b*b+x*x,n=_*_+w*w;p=u+(w*e-x*n)*t,m=c+(b*n-_*e)*t}a[y]=p,a[y+1]=m}let s,l,u,c=e[e.length-1],f=4*c,d=t[2*c],h=t[2*c+1];r.fill(0);for(let p=0;p<e.length;++p)c=e[p],s=f,l=d,u=h,f=4*c,d=t[2*c],h=t[2*c+1],r[s+2]=r[f]=u-h,r[s+3]=r[f+1]=d-l}render(t){const e=null==t?t=new cC:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let u=0,c=n.length;u<c;++u){const e=n[u];if(e<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(e/3),a=o[r],s=o[r+1],l=o[i],c=o[i+1];this._renderSegment(a,s,l,c,t)}let s,l=i[i.length-1];for(let u=0;u<i.length;++u){s=l,l=i[u];const e=2*Math.floor(r[l]/3),n=o[e],c=o[e+1],f=4*s,d=this._project(n,c,a[f+2],a[f+3]);d&&this._renderSegment(n,c,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new cC:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new cC:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||e.lineTo(r[o],r[o+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new fC;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const a=this._regioncode(t,e),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,a=t.length;o<a;o+=2)if(e[r]===t[o]&&e[r+1]===t[o+1]&&e[(r+2)%i]===t[(o+a-2)%a]&&e[(r+3)%i]===t[(o+a-1)%a]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(e[2*n],e[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return this._simplify(n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e))}_clipFinite(t,e){const n=e.length;let r,i,o,a,s=null,l=e[n-2],u=e[n-1],c=this._regioncode(l,u),f=0;for(let d=0;d<n;d+=2)if(r=l,i=u,l=e[d],u=e[d+1],o=c,c=this._regioncode(l,u),0===o&&0===c)a=f,f=0,s?s.push(l,u):s=[l,u];else{let e,n,d,h,p;if(0===o){if(null===(e=this._clipSegment(r,i,l,u,o,c)))continue;[n,d,h,p]=e}else{if(null===(e=this._clipSegment(l,u,r,i,c,o)))continue;[h,p,n,d]=e,a=f,f=this._edgecode(n,d),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(n,d):s=[n,d]}a=f,f=this._edgecode(h,p),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(h,p):s=[h,p]}if(s)a=f,f=this._edgecode(s[0],s[1]),a&&f&&this._edge(t,a,f,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,e,n,r,i,o){const a=i<o;for(a&&([t,e,n,r,i,o]=[n,r,t,e,o,i]);;){if(0===i&&0===o)return a?[n,r,t,e]:[t,e,n,r];if(i&o)return null;let s,l,u=i||o;8&u?(s=t+(n-t)*(this.ymax-e)/(r-e),l=this.ymax):4&u?(s=t+(n-t)*(this.ymin-e)/(r-e),l=this.ymin):2&u?(l=e+(r-e)*(this.xmax-t)/(n-t),s=this.xmax):(l=e+(r-e)*(this.xmin-t)/(n-t),s=this.xmin),i?(t=s,e=l,i=this._regioncode(t,e)):(n=s,r=l,o=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,o){let a,s=Array.from(e);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(t,s))for(let l,u=0,c=s.length,f=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)l=f,f=this._edgecode(s[u],s[u+1]),l&&f&&(u=this._edge(t,l,f,s,u),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}return i}_project(t,e,n,r){let i,o,a,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(a=this.ymin,o=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(a=this.ymax,o=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(o=this.xmax,a=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(o=this.xmin,a=e+(s=i)*r)}return[o,a]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const n=(e+2)%t.length,r=(e+4)%t.length;(t[e]===t[n]&&t[n]===t[r]||t[e+1]===t[n+1]&&t[n+1]===t[r+1])&&(t.splice(n,2),e-=2)}t.length||(t=null)}return t}}const hC=2*Math.PI,pC=Math.pow;function mC(t){return t[0]}function gC(t){return t[1]}function yC(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class vC{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mC,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gC,r=arguments.length>3?arguments[3]:void 0;return new vC("length"in t?function(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=t[a];o[2*a]=e.call(r,i,a,t),o[2*a+1]=n.call(r,i,a,t)}return o}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new eC(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],o=2*e[r+2];if((n[o]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[o+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,a=e.length/2;o<a;++o){const t=yC(e[2*o],e[2*o+1],i);e[2*o]=t[0],e[2*o+1]=t[1]}this._delaunator=new eC(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,l=n.length;s<l;++s){const t=i[s%3==2?s-2:s+1];-1!==n[s]&&-1!==o[t]||(o[t]=s)}for(let s=0,l=r.length;s<l;++s)a[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new dC(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const e=a.indexOf(t);return e>0&&(yield a[e-1]),void(e<a.length-1&&(yield a[e+1]))}const s=e[t];if(-1===s)return;let l=s,u=-1;do{if(yield u=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=i[l],-1===l){const e=n[(r[t]+1)%n.length];return void(e!==u&&(yield e))}}while(l!==s)}find(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:l}=this;if(-1===r[t]||!l.length)return(t+1)%(l.length>>1);let u=t,c=pC(e-l[2*t],2)+pC(n-l[2*t+1],2);const f=r[t];let d=f;do{let r=s[d];const f=pC(e-l[2*r],2)+pC(n-l[2*r+1],2);if(f<c&&(c=f,u=r),d=d%3==2?d-2:d+1,s[d]!==t)break;if(d=a[d],-1===d){if(d=i[(o[t]+1)%i.length],d!==r&&pC(e-l[2*d],2)+pC(n-l[2*d+1],2)<c)return d;break}}while(d!==f);return u}render(t){const e=null==t?t=new cC:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,a=r.length;o<a;++o){const e=r[o];if(e<o)continue;const a=2*i[o],s=2*i[e];t.moveTo(n[a],n[a+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"==typeof t.moveTo||(e=t,t=null),e=null==e?2:+e;const n=null==t?t=new cC:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];t.moveTo(n+e,o),t.arc(n,o,e,0,hC)}return n&&n.value()}renderHull(t){const e=null==t?t=new cC:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let a=1;a<o;++a){const e=2*n[a];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new fC;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new cC:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],a=2*i[t+1],s=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[a],r[a+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new fC;return this.renderTriangle(t,e),e.value()}}function bC(t){ns.call(this,null,t)}bC.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const xC=[-1e5,-1e5,1e5,1e5];function _C(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}Se(bC,ns,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:xC;const o=this.value=vC.from(r,t.x,t.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const t=o.cellPolygon(a);r[a][n]=t?_C(t):null}return e.reflow(t.modified()).modifies(n)}});var wC=Math.PI/180,kC=64,AC=2048;function EC(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,(kC<<5)/o,AC/o);var a,s,l,u,c,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,a=i.measureText(e.text+"m").width*o,l=e.size<<1,e.rotate){var m=Math.sin(e.rotate*wC),g=Math.cos(e.rotate*wC),y=a*g,v=a*m,b=l*g,x=l*m;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,l=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(l>h&&(h=l),f+a>=kC<<5&&(f=0,d+=h,h=0),d+l>=AC)break;i.translate((f+(a>>1))/o,(d+(l>>1))/o),e.rotate&&i.rotate(e.rotate*wC),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=a,e.height=l,e.xoff=f,e.yoff=d,e.x1=a>>1,e.y1=l>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=a}for(var _=i.getImageData(0,0,(kC<<5)/o,AC/o).data,w=[];--r>=0;)if((e=n[r]).hasText){for(s=(a=e.width)>>5,l=e.y1-e.y0,u=0;u<l*s;u++)w[u]=0;if(null==(f=e.xoff))return;d=e.yoff;var k=0,A=-1;for(c=0;c<l;c++){for(u=0;u<a;u++){var E=s*c+(u>>5),M=_[(d+c)*(kC<<5)+(f+u)<<2]?1<<31-u%32:0;w[E]|=M,k|=M}k?A=c:(e.y0++,l--,c--,d++)}e.y1=e.y0+A,e.sprite=w.slice(0,(e.y1-e.y0)*s)}}}function MC(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,a=t.x-(o<<4),s=127&a,l=32-s,u=t.y1-t.y0,c=(t.y+t.y0)*n+(a>>5),f=0;f<u;f++){r=0;for(var d=0;d<=o;d++)if((r<<l|(d<o?(r=i[f*o+d])>>>s:0))&e[c+d])return!0;c+=n}return!1}function CC(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function SC(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function DC(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function FC(t){return"function"==typeof t?t:function(){return t}}var TC={archimedean:DC,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const NC=["x","y","font","fontSize","fontStyle","fontWeight","angle"],OC=["text","font","rotate","fontSize","fontStyle","fontWeight"];function zC(t){ns.call(this,function(){var t,e,n,r,i,o,a,s=[256,256],l=DC,u=[],c=Math.random,f={};function d(t,e,n){for(var r,i,o,a=e.x,u=e.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=l(s),h=c()<.5?1:-1,p=-h;(r=d(p+=h))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(e.x=a+i,e.y=u+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1])&&(!n||!MC(e,t,s[0]))&&(!n||SC(e,n))){for(var m,g=e.sprite,y=e.width>>5,v=s[0]>>5,b=e.x-(y<<4),x=127&b,_=32-x,w=e.y1-e.y0,k=(e.y+e.y0)*v+(b>>5),A=0;A<w;A++){m=0;for(var E=0;E<=y;E++)t[k+E]|=m<<_|(E<y?(m=g[A*y+E])>>>x:0);k+=v}return e.sprite=null,!0}return!1}return f.layout=function(){for(var l=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(kC<<5)/e,t.height=AC/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}($u()),f=function(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),h=null,p=u.length,m=-1,g=[],y=u.map((s=>({text:t(s),font:e(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((t,e)=>e.size-t.size));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,EC(l,v,y,m),v.hasText&&d(f,v,h)&&(g.push(v),h?CC(h,v):h=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},f.words=function(t){return arguments.length?(u=t,f):u},f.size=function(t){return arguments.length?(s=[+t[0],+t[1]],f):s},f.font=function(t){return arguments.length?(e=FC(t),f):e},f.fontStyle=function(t){return arguments.length?(r=FC(t),f):r},f.fontWeight=function(t){return arguments.length?(i=FC(t),f):i},f.rotate=function(t){return arguments.length?(o=FC(t),f):o},f.text=function(e){return arguments.length?(t=FC(e),f):t},f.spiral=function(t){return arguments.length?(l=TC[t]||t,f):l},f.fontSize=function(t){return arguments.length?(n=FC(t),f):n},f.padding=function(t){return arguments.length?(a=FC(t),f):a},f.random=function(t){return arguments.length?(c=t,f):c},f}(),t)}zC.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:NC}]},Se(zC,ns,{transform(t,e){!t.size||t.size[0]&&t.size[1]||Rt("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||OC.some((function(n){const r=t[n];return he(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,o=t.as||NC;let a,s=t.fontSize||14;if(he(s)?a=t.fontSizeRange:s=xe(s),a){const t=s,e=Mh("sqrt")().domain(ke(r,t)).range(a);s=n=>e(t(n))}r.forEach((t=>{t[o[0]]=NaN,t[o[1]]=NaN,t[o[3]]=0}));const l=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random(Q).layout(),u=i.size(),c=u[0]>>1,f=u[1]>>1,d=l.length;for(let h,p,m=0;m<d;++m)h=l[m],p=h.datum,p[o[0]]=h.x+c,p[o[1]]=h.y+f,p[o[2]]=h.font,p[o[3]]=h.size,p[o[4]]=h.style,p[o[5]]=h.weight,p[o[6]]=h.rotate;return e.reflow(n).modifies(o)}});const RC=t=>new Uint8Array(t),PC=t=>new Uint16Array(t),BC=t=>new Uint32Array(t);function LC(t,e,n){const r=(e<257?RC:e<65537?PC:BC)(t);return n&&r.set(n),r}function jC(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),o=t.index,a=i[0],s=i[1],l=o.length;let u;for(u=0;u<a;++u)e[o[u]]|=r;for(u=s;u<l;++u)e[o[u]]|=r;return n}}}function UC(){let t=BC(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,l=BC(s);let u,c,f,d=Array(s);for(f=0;f<s;++f)d[f]=r(i[f]),l[f]=f;if(d=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),n=t,r=e,Array.from(r,(t=>n[t]));var n,r}(d,l),a)u=e,c=t,e=Array(a+s),t=BC(a+s),function(t,e,n,r,i,o,a,s,l){let u,c=0,f=0;for(u=0;c<r&&f<a;++u)e[c]<i[f]?(s[u]=e[c],l[u]=n[c++]):(s[u]=i[f],l[u]=o[f++]+t);for(;c<r;++c,++u)s[u]=e[c],l[u]=n[c];for(;f<a;++f,++u)s[u]=i[f],l[u]=o[f]+t}(o,u,c,a,d,l,s,e,t);else{if(o>0)for(f=0;f<s;++f)l[f]+=o;e=d,t=l}return n=a+s,{index:l,value:d}},remove:function(r,i){const o=n;let a,s,l;for(s=0;!i[t[s]]&&s<o;++s);for(l=s;s<o;++s)i[a=t[s]]||(t[l]=a,e[l]=e[s],++l);n=o-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[Yu(r,t[0],0,i),Zu(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function qC(t){ns.call(this,function(){let t=8,e=[],n=BC(0),r=LC(0,t),i=LC(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const o=e.length,a=Array(o-t),s=e;let l,u,c;for(u=0;!n[u]&&u<o;++u)a[u]=e[u],s[u]=u;for(c=u;u<o;++u)l=e[u],n[u]?s[u]=-1:(s[u]=c,r[c]=r[u],i[c]=i[u],a[c]=l,l._index=c++),r[u]=0;return e=a,s},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=LC(e,t,r),i=LC(e,t))}}}(),t),this._indices=null,this._dims=null}function IC(t){ns.call(this,null,t)}qC.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Se(qC,ns,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},o=this._dims=[],a=r.length;let s,l,u=0;for(;u<a;++u)s=n[u].fname,l=i[s]||(i[s]=UC()),o.push(jC(l,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,o=this._indices,a=this._dims,s=this.value,l=s.curr(),u=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,g,y,v,b,x,_,w,k;if(u.set(l),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&s.add(e.add),e.mod.length)for(x={},v=e.mod,_=0,w=v.length;_<w;++_)x[v[_]._index]=1;for(_=0;_<h;++_)k=r[_],(!a[_]||t.modified("fields",_)||e.modified(k.fields))&&(y=k.fname,(m=p[y])||(o[y]=g=UC(),p[y]=m=g.insert(k,e.source,0)),a[_]=jC(g,_,i[_]).onAdd(m,l));for(_=0,w=s.data().length;_<w;++_)b[_]||(u[_]!==l[_]?f.push(_):x[_]&&l[_]!==c&&d.push(_));return s.mask=(1<<h)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,o=this._dims,a=this._indices,s=t.fields,l={},u=n.add,c=i.size()+r.length,f=o.length;let d,h,p,m=i.size();i.resize(c,f),i.add(r);const g=i.curr(),y=i.prev(),v=i.all();for(d=0;d<f;++d)h=s[d].fname,p=l[h]||(l[h]=a[h].insert(s[d],r,m)),o[d].onAdd(p,g);for(;m<c;++m)y[m]=v,g[m]!==v&&u.push(m)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),o=r.all(),a=t.mod;let s,l,u;for(s=0,l=a.length;s<l;++s)u=a[s]._index,i[u]!==o&&n.push(u)},remove(t,e,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),l={},u=n.rem,c=e.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,a[h]=p=o[h],o[h]=s,p!==s&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(e,d,l),l},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,o=e.stamp,a=r.length;let s,l,u=0;for(n.filters=0,l=0;l<a;++l)t.modified("query",l)&&(s=l,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(l=0,u=0;l<a;++l)t.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),l=t.index(),u=t.bisect(t.range),c=t.bisect(e),f=c[0],d=c[1],h=u[0],p=u[1],m=t.one;let g,y,v;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),o=t.index(),a=t.bisect(t.range),s=t.bisect(e),l=s[0],u=s[1],c=a[0],f=a[1],d=t.one;let h,p,m;if(l<c)for(h=l,p=Math.min(c,u);h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(l>c)for(h=c,p=Math.min(l,f);h<p;++h)m=o[h],i[m]^=d,r.push(m);if(u>f)for(h=Math.max(l,f),p=u;h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(u<f)for(h=Math.max(c,u),p=f;h<p;++h)m=o[h],i[m]^=d,r.push(m);t.range=e.slice()}}),IC.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Se(IC,ns,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0==(i&n))return e.StopPropagation;const o=e.fork(e.ALL),a=r.data(),s=r.curr(),l=r.prev(),u=t=>s[t]&n?null:a[t];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,(t=>{const e=s[t]&n;return!e&&e^l[t]&n?a[t]:null})),o.filter(o.REM,(t=>{const e=s[t]&n;return!e||e^e^l[t]&n?null:a[t]}))):(o.filter(o.ADD,u),o.filter(o.REM,(t=>(s[t]&n)===i?a[t]:null))),o.filter(o.SOURCE,(t=>u(t._index)))}});const WC="Literal",$C="CallExpression";function HC(t){this.type=t}var ZC,YC,VC,GC,XC;HC.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case $C:return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var QC=1,JC=2,KC=3,tS=4,eS=5,nS=6,rS=7,iS=8;(ZC={})[QC]="Boolean",ZC[JC]="<end>",ZC[KC]="Identifier",ZC[tS]="Keyword",ZC[eS]="Null",ZC[nS]="Numeric",ZC[rS]="Punctuator",ZC[iS]="String",ZC[9]="RegularExpression";var oS="ArrayExpression",aS="BinaryExpression",sS="CallExpression",lS="ConditionalExpression",uS="Identifier",cS="Literal",fS="LogicalExpression",dS="MemberExpression",hS="ObjectExpression",pS="Property",mS="UnaryExpression",gS="Unexpected token %0",yS="Unexpected number",vS="Unexpected string",bS="Unexpected identifier",xS="Unexpected reserved word",_S="Unexpected end of input",wS="Invalid regular expression",kS="Invalid regular expression: missing /",AS="Octal literals are not allowed in strict mode.",ES="Duplicate data property in object literal not allowed in strict mode",MS="ILLEGAL",CS="Disabled.",SS=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),DS=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function FS(t,e){if(!t)throw new Error("ASSERT: "+e)}function TS(t){return t>=48&&t<=57}function NS(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function OS(t){return"01234567".indexOf(t)>=0}function zS(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function RS(t){return 10===t||13===t||8232===t||8233===t}function PS(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&SS.test(String.fromCharCode(t))}function BS(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&DS.test(String.fromCharCode(t))}const LS={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function jS(){for(;VC<GC;){const t=YC.charCodeAt(VC);if(!zS(t)&&!RS(t))break;++VC}}function US(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)VC<GC&&NS(YC[VC])?(r=YC[VC++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):tD({},gS,MS);return String.fromCharCode(i)}function qS(){var t,e,n,r;for(e=0,"}"===(t=YC[VC])&&tD({},gS,MS);VC<GC&&NS(t=YC[VC++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&tD({},gS,MS),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function IS(){var t,e;for(t=YC.charCodeAt(VC++),e=String.fromCharCode(t),92===t&&(117!==YC.charCodeAt(VC)&&tD({},gS,MS),++VC,(t=US("u"))&&"\\"!==t&&PS(t.charCodeAt(0))||tD({},gS,MS),e=t);VC<GC&&BS(t=YC.charCodeAt(VC));)++VC,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==YC.charCodeAt(VC)&&tD({},gS,MS),++VC,(t=US("u"))&&"\\"!==t&&BS(t.charCodeAt(0))||tD({},gS,MS),e+=t);return e}function WS(){var t,e,n,r,i=VC,o=YC.charCodeAt(VC),a=YC[VC];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++VC,{type:rS,value:String.fromCharCode(o),start:i,end:VC};default:if(61===(t=YC.charCodeAt(VC+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return VC+=2,{type:rS,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:VC};case 33:case 61:return VC+=2,61===YC.charCodeAt(VC)&&++VC,{type:rS,value:YC.slice(i,VC),start:i,end:VC}}}return">>>="===(r=YC.substr(VC,4))?{type:rS,value:r,start:i,end:VC+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:rS,value:n,start:i,end:VC+=3}:a===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===e?{type:rS,value:e,start:i,end:VC+=2}:("//"===e&&tD({},gS,MS),"<>=!+-*%&|^/".indexOf(a)>=0?(++VC,{type:rS,value:a,start:i,end:VC}):void tD({},gS,MS))}function $S(){var t,e,n;if(FS(TS((n=YC[VC]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=VC,t="","."!==n){if(t=YC[VC++],n=YC[VC],"0"===t){if("x"===n||"X"===n)return++VC,function(t){let e="";for(;VC<GC&&NS(YC[VC]);)e+=YC[VC++];return 0===e.length&&tD({},gS,MS),PS(YC.charCodeAt(VC))&&tD({},gS,MS),{type:nS,value:parseInt("0x"+e,16),start:t,end:VC}}(e);if(OS(n))return function(t){let e="0"+YC[VC++];for(;VC<GC&&OS(YC[VC]);)e+=YC[VC++];return(PS(YC.charCodeAt(VC))||TS(YC.charCodeAt(VC)))&&tD({},gS,MS),{type:nS,value:parseInt(e,8),octal:!0,start:t,end:VC}}(e);n&&TS(n.charCodeAt(0))&&tD({},gS,MS)}for(;TS(YC.charCodeAt(VC));)t+=YC[VC++];n=YC[VC]}if("."===n){for(t+=YC[VC++];TS(YC.charCodeAt(VC));)t+=YC[VC++];n=YC[VC]}if("e"===n||"E"===n)if(t+=YC[VC++],"+"!==(n=YC[VC])&&"-"!==n||(t+=YC[VC++]),TS(YC.charCodeAt(VC)))for(;TS(YC.charCodeAt(VC));)t+=YC[VC++];else tD({},gS,MS);return PS(YC.charCodeAt(VC))&&tD({},gS,MS),{type:nS,value:parseFloat(t),start:e,end:VC}}function HS(){if(jS(),VC>=GC)return{type:JC,start:VC,end:VC};const t=YC.charCodeAt(VC);return PS(t)?function(){var t,e;return t=VC,e=92===YC.charCodeAt(VC)?IS():function(){var t,e;for(t=VC++;VC<GC;){if(92===(e=YC.charCodeAt(VC)))return VC=t,IS();if(!BS(e))break;++VC}return YC.slice(t,VC)}(),{type:1===e.length?KC:LS.hasOwnProperty(e)?tS:"null"===e?eS:"true"===e||"false"===e?QC:KC,value:e,start:t,end:VC}}():40===t||41===t||59===t?WS():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(FS("'"===(t=YC[VC])||'"'===t,"String literal must starts with a quote"),e=VC,++VC;VC<GC;){if((n=YC[VC++])===t){t="";break}if("\\"===n)if((n=YC[VC++])&&RS(n.charCodeAt(0)))"\r"===n&&"\n"===YC[VC]&&++VC;else switch(n){case"u":case"x":"{"===YC[VC]?(++VC,i+=qS()):i+=US(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:OS(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),VC<GC&&OS(YC[VC])&&(o=!0,r=8*r+"01234567".indexOf(YC[VC++]),"0123".indexOf(n)>=0&&VC<GC&&OS(YC[VC])&&(r=8*r+"01234567".indexOf(YC[VC++]))),i+=String.fromCharCode(r)):i+=n}else{if(RS(n.charCodeAt(0)))break;i+=n}}return""!==t&&tD({},gS,MS),{type:iS,value:i,octal:o,start:e,end:VC}}():46===t?TS(YC.charCodeAt(VC+1))?$S():WS():TS(t)?$S():WS()}function ZS(){const t=XC;return VC=t.end,XC=HS(),VC=t.end,t}function YS(){const t=VC;XC=HS(),VC=t}function VS(t,e,n){const r=new HC("||"===t||"&&"===t?fS:aS);return r.operator=t,r.left=e,r.right=n,r}function GS(t,e){const n=new HC(sS);return n.callee=t,n.arguments=e,n}function XS(t){const e=new HC(uS);return e.name=t,e}function QS(t){const e=new HC(cS);return e.value=t.value,e.raw=YC.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function JS(t,e,n){const r=new HC(dS);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function KS(t,e,n){const r=new HC(pS);return r.key=e,r.value=n,r.kind=t,r}function tD(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(FS(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=VC,n.description=i,n}function eD(t){t.type===JC&&tD(t,_S),t.type===nS&&tD(t,yS),t.type===iS&&tD(t,vS),t.type===KC&&tD(t,bS),t.type===tS&&tD(t,xS),tD(t,gS,t.value)}function nD(t){const e=ZS();e.type===rS&&e.value===t||eD(e)}function rD(t){return XC.type===rS&&XC.value===t}function iD(t){return XC.type===tS&&XC.value===t}function oD(){VC=XC.start;const t=ZS();return t.type===iS||t.type===nS?(t.octal&&tD(t,AS),QS(t)):XS(t.value)}function aD(){var t,e,n;return VC=XC.start,(t=XC).type===KC?(n=oD(),nD(":"),KS("init",n,pD())):t.type!==JC&&t.type!==rS?(e=oD(),nD(":"),KS("init",e,pD())):void eD(t)}const sD={if:1};function lD(){const t=[];if(nD("("),!rD(")"))for(;VC<GC&&(t.push(pD()),!rD(")"));)nD(",");return nD(")"),t}function uD(){VC=XC.start;const t=ZS();return function(t){return t.type===KC||t.type===tS||t.type===QC||t.type===eS}(t)||eD(t),XS(t.value)}function cD(){nD("[");const t=mD();return nD("]"),t}function fD(){const t=function(){var t;for(t=function(){var t,e,n;if(rD("("))return function(){nD("(");const t=mD();return nD(")"),t}();if(rD("["))return function(){const t=[];for(VC=XC.start,nD("[");!rD("]");)rD(",")?(ZS(),t.push(null)):(t.push(pD()),rD("]")||nD(","));return ZS(),function(t){const e=new HC(oS);return e.elements=t,e}(t)}();if(rD("{"))return function(){var t,e,n=[],r={},i=String;for(VC=XC.start,nD("{");!rD("}");)e="$"+((t=aD()).key.type===uS?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?tD({},ES):r[e]=!0,n.push(t),rD("}")||nD(",");return nD("}"),function(t){const e=new HC(hS);return e.properties=t,e}(n)}();if(t=XC.type,VC=XC.start,t===KC||sD[XC.value])n=XS(ZS().value);else if(t===iS||t===nS)XC.octal&&tD(XC,AS),n=QS(ZS());else{if(t===tS)throw new Error(CS);t===QC?((e=ZS()).value="true"===e.value,n=QS(e)):t===eS?((e=ZS()).value=null,n=QS(e)):rD("/")||rD("/=")?(n=QS(function(){var t,e,n,r;return XC=null,jS(),t=VC,e=function(){var t,e,n,r;for(FS("/"===(t=YC[VC]),"Regular expression literal must start with a slash"),e=YC[VC++],n=!1,r=!1;VC<GC;)if(e+=t=YC[VC++],"\\"===t)RS((t=YC[VC++]).charCodeAt(0))&&tD({},kS),e+=t;else if(RS(t.charCodeAt(0)))tD({},kS);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||tD({},kS),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";VC<GC&&BS((t=YC[VC]).charCodeAt(0));)++VC,"\\"===t&&VC<GC?tD({},gS,MS):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&tD({},wS,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";tD({},wS)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){tD({},wS)}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:VC}}()),YS()):eD(ZS())}return n}();;)if(rD("."))nD("."),t=JS(".",t,uD());else if(rD("("))t=GS(t,lD());else{if(!rD("["))break;t=JS("[",t,cD())}return t}();if(XC.type===rS&&(rD("++")||rD("--")))throw new Error(CS);return t}function dD(){var t,e;if(XC.type!==rS&&XC.type!==tS)e=fD();else{if(rD("++")||rD("--"))throw new Error(CS);if(rD("+")||rD("-")||rD("~")||rD("!"))t=ZS(),e=dD(),e=function(t,e){const n=new HC(mS);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(iD("delete")||iD("void")||iD("typeof"))throw new Error(CS);e=fD()}}return e}function hD(t){let e=0;if(t.type!==rS&&t.type!==tS)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function pD(){var t,e;return t=function(){var t,e,n,r,i,o,a,s,l,u;if(t=XC,l=dD(),0===(i=hD(r=XC)))return l;for(r.prec=i,ZS(),e=[t,XC],o=[l,r,a=dD()];(i=hD(XC))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,l=o.pop(),e.pop(),n=VS(s,l,a),o.push(n);(r=ZS()).prec=i,o.push(r),e.push(XC),n=dD(),o.push(n)}for(n=o[u=o.length-1],e.pop();u>1;)e.pop(),n=VS(o[u-1].value,o[u-2],n),u-=2;return n}(),rD("?")&&(ZS(),e=pD(),nD(":"),t=function(t,e,n){const r=new HC(lS);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,pD())),t}function mD(){const t=pD();if(rD(","))throw new Error(CS);return t}var gD={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function yD(t){function e(e,n,r){return i=>function(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&Rt("Missing arguments to clamp function."),e.length>3&&Rt("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&Rt("Missing arguments to if function."),e.length>3&&Rt("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var vD,bD,xD,_D,wD,kD,AD,ED,MD,CD,SD,DD,FD,TD,ND,OD,zD=new Ex,RD=new Ex,PD={point:Gx,lineStart:Gx,lineEnd:Gx,polygonStart:function(){zD=new Ex,PD.lineStart=BD,PD.lineEnd=LD},polygonEnd:function(){var t=+zD;RD.add(t<0?Tx+t:t),this.lineStart=this.lineEnd=this.point=Gx},sphere:function(){RD.add(Tx)}};function BD(){PD.point=jD}function LD(){UD(vD,bD)}function jD(t,e){PD.point=UD,vD=t,bD=e,xD=t*=Ox,_D=Bx(e=(e*=Ox)/2+Fx),wD=Wx(e)}function UD(t,e){var n=(t*=Ox)-xD,r=n>=0?1:-1,i=r*n,o=Bx(e=(e*=Ox)/2+Fx),a=Wx(e),s=wD*a,l=_D*o+s*Bx(i),u=s*r*Wx(i);zD.add(Px(u,l)),xD=t,_D=o,wD=a}var qD,ID,WD,$D,HD,ZD,YD,VD,GD,XD,QD,JD,KD,tF,eF,nF,rF={point:iF,lineStart:aF,lineEnd:sF,polygonStart:function(){rF.point=lF,rF.lineStart=uF,rF.lineEnd=cF,TD=new Ex,PD.polygonStart()},polygonEnd:function(){PD.polygonEnd(),rF.point=iF,rF.lineStart=aF,rF.lineEnd=sF,zD<0?(kD=-(ED=180),AD=-(MD=90)):TD>Mx?MD=90:TD<-Mx&&(AD=-90),OD[0]=kD,OD[1]=ED},sphere:function(){kD=-(ED=180),AD=-(MD=90)}};function iF(t,e){ND.push(OD=[kD=t,ED=t]),e<AD&&(AD=e),e>MD&&(MD=e)}function oF(t,e){var n=lw([t*Ox,e*Ox]);if(FD){var r=cw(FD,n),i=cw([r[1],-r[0],0],r);hw(i),i=sw(i);var o,a=t-CD,s=a>0?1:-1,l=i[0]*Nx*s,u=zx(a)>180;u^(s*CD<l&&l<s*t)?(o=i[1]*Nx)>MD&&(MD=o):u^(s*CD<(l=(l+360)%360-180)&&l<s*t)?(o=-i[1]*Nx)<AD&&(AD=o):(e<AD&&(AD=e),e>MD&&(MD=e)),u?t<CD?fF(kD,t)>fF(kD,ED)&&(ED=t):fF(t,ED)>fF(kD,ED)&&(kD=t):ED>=kD?(t<kD&&(kD=t),t>ED&&(ED=t)):t>CD?fF(kD,t)>fF(kD,ED)&&(ED=t):fF(t,ED)>fF(kD,ED)&&(kD=t)}else ND.push(OD=[kD=t,ED=t]);e<AD&&(AD=e),e>MD&&(MD=e),FD=n,CD=t}function aF(){rF.point=oF}function sF(){OD[0]=kD,OD[1]=ED,rF.point=iF,FD=null}function lF(t,e){if(FD){var n=t-CD;TD.add(zx(n)>180?n+(n>0?360:-360):n)}else SD=t,DD=e;PD.point(t,e),oF(t,e)}function uF(){PD.lineStart()}function cF(){lF(SD,DD),PD.lineEnd(),zx(TD)>Mx&&(kD=-(ED=180)),OD[0]=kD,OD[1]=ED,FD=null}function fF(t,e){return(e-=t)<0?e+360:e}function dF(t,e){return t[0]-e[0]}function hF(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var pF={sphere:Gx,point:mF,lineStart:yF,lineEnd:xF,polygonStart:function(){pF.lineStart=_F,pF.lineEnd=wF},polygonEnd:function(){pF.lineStart=yF,pF.lineEnd=xF}};function mF(t,e){t*=Ox;var n=Bx(e*=Ox);gF(n*Bx(t),n*Wx(t),Wx(e))}function gF(t,e,n){++qD,WD+=(t-WD)/qD,$D+=(e-$D)/qD,HD+=(n-HD)/qD}function yF(){pF.point=vF}function vF(t,e){t*=Ox;var n=Bx(e*=Ox);tF=n*Bx(t),eF=n*Wx(t),nF=Wx(e),pF.point=bF,gF(tF,eF,nF)}function bF(t,e){t*=Ox;var n=Bx(e*=Ox),r=n*Bx(t),i=n*Wx(t),o=Wx(e),a=Px(Hx((a=eF*o-nF*i)*a+(a=nF*r-tF*o)*a+(a=tF*i-eF*r)*a),tF*r+eF*i+nF*o);ID+=a,ZD+=a*(tF+(tF=r)),YD+=a*(eF+(eF=i)),VD+=a*(nF+(nF=o)),gF(tF,eF,nF)}function xF(){pF.point=mF}function _F(){pF.point=kF}function wF(){AF(JD,KD),pF.point=mF}function kF(t,e){JD=t,KD=e,t*=Ox,e*=Ox,pF.point=AF;var n=Bx(e);tF=n*Bx(t),eF=n*Wx(t),nF=Wx(e),gF(tF,eF,nF)}function AF(t,e){t*=Ox;var n=Bx(e*=Ox),r=n*Bx(t),i=n*Wx(t),o=Wx(e),a=eF*o-nF*i,s=nF*r-tF*o,l=tF*i-eF*r,u=Ux(a,s,l),c=Vx(u),f=u&&-c/u;GD.add(f*a),XD.add(f*s),QD.add(f*l),ID+=c,ZD+=c*(tF+(tF=r)),YD+=c*(eF+(eF=i)),VD+=c*(nF+(nF=o)),gF(tF,eF,nF)}function EF(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function MF(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function CF(){return 0}function SF(t){return t instanceof Yf?t:new Yf(t)}const DF="intersect",FF="union",TF="_vgsid_",NF=Bt(TF),OF="index:unit";function zF(t,e){for(var n,r,i=e.fields,o=e.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=Bt.getter||Bt(r.field),Te(n=r.getter(t))&&(n=te(n)),Te(o[s])&&(o[s]=te(o[s])),Te(o[s][0])&&(o[s]=o[s].map(te)),"E"===r.type){if(Qt(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if("R"===r.type){if(!De(n,o[s]))return!1}else if("R-RE"===r.type){if(!De(n,o[s],!0,!1))return!1}else if("R-E"===r.type){if(!De(n,o[s],!1,!1))return!1}else if("R-LE"===r.type&&!De(n,o[s],!1,!0))return!1;return!0}const RF=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=EF,n=(e,n)=>EF(t(e),n),r=(e,n)=>t(e)-n):(e=t===EF||t===MF?t:CF,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}(NF),PF=RF.left,BF=RF.right;var LF={["".concat(TF,"_union")]:function(){const t=new Yf;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)for(const e of i)t.add(e);return t},["".concat(TF,"_intersect")]:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t=new Yf(t),n=n.map(SF);t:for(const i of t)for(const e of n)if(!e.has(i)){t.delete(i);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=te(e[0]),r=te(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=te(e[0]),r=te(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function jF(t,e,n,r){e[0].type!==WC&&Rt("First argument to selection functions must be a string literal.");const i=e[0].value,o="unit",a="@"+o,s=":"+i;(e.length>=2&&Kt(e).value)!==DF||Ee(r,a)||(r[a]=n.getData(i).indataRef(n,o)),Ee(r,s)||(r[s]=n.getData(i).tuplesRef())}function UF(t){const e=this.context.data[t];return e?e.values.value:[]}const qF=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},IF=qF("format"),WF=qF("timeFormat"),$F=qF("utcFormat"),HF=qF("timeParse"),ZF=qF("utcParse"),YF=new Date(2e3,0,1);function VF(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(YF.setYear(2e3),YF.setMonth(t),YF.setDate(e),WF.call(this,YF,n)):""}const GF="%",XF="$";function QF(t,e,n,r){e[0].type!==WC&&Rt("First argument to data functions must be a string literal.");const i=e[0].value,o=":"+i;if(!Ee(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(t){}}function JF(t,e,n,r){if(e[0].type===WC)KF(n,r,e[0].value);else for(t in n.scales)KF(n,r,t)}function KF(t,e,n){const r=GF+n;if(!Ee(e,r))try{e[r]=t.scaleRef(n)}catch(t){}}function tT(t,e){if(he(t))return t;if(Oe(t)){const r=e.scales[t];return r&&(n=r.value)&&!0===n[Ah]?r.value:void 0}var n}function eT(t,e){return function(n,r,i){if(n){const e=tT(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const nT=eT("area",(function(t){return RD=new Ex,Ax(t,PD),2*RD})),rT=eT("bounds",(function(t){var e,n,r,i,o,a,s;if(MD=ED=-(kD=AD=1/0),ND=[],Ax(t,rF),n=ND.length){for(ND.sort(dF),e=1,o=[r=ND[0]];e<n;++e)hF(r,(i=ND[e])[0])||hF(r,i[1])?(fF(r[0],i[1])>fF(r[0],r[1])&&(r[1]=i[1]),fF(i[0],r[1])>fF(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(s=fF(r[1],i[0]))>a&&(a=s,kD=i[0],ED=r[1])}return ND=OD=null,kD===1/0||AD===1/0?[[NaN,NaN],[NaN,NaN]]:[[kD,AD],[ED,MD]]})),iT=eT("centroid",(function(t){qD=ID=WD=$D=HD=ZD=YD=VD=0,GD=new Ex,XD=new Ex,QD=new Ex,Ax(t,pF);var e=+GD,n=+XD,r=+QD,i=Ux(e,n,r);return i<Cx&&(e=ZD,n=YD,r=VD,ID<Mx&&(e=WD,n=$D,r=HD),(i=Ux(e,n,r))<Cx)?[NaN,NaN]:[Px(n,e)*Nx,Vx(r/i)*Nx]}));function oT(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(e){t.warn(e)}return n[n.length-1]}function aT(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function sT(t){const e=yc(t);return.2126*aT(e.r)+.7152*aT(e.g)+.0722*aT(e.b)}function lT(t,e){return t===e||t!=t&&e!=e||(Qt(t)?!(!Qt(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!lT(t[n],e[n]))return!1;return!0}(t,e):!(!Jt(t)||!Jt(e))&&uT(t,e))}function uT(t,e){for(const n in t)if(!lT(t[n],e[n]))return!1;return!0}function cT(t){return e=>uT(t,e)}const fT={};function dT(t){return Qt(t)||ArrayBuffer.isView(t)?t:null}function hT(t){return dT(t)||(Oe(t)?t:null)}const pT=t=>t.data;function mT(t,e){const n=UF.call(e,t);return n.root&&n.root.lookup||{}}const gT=()=>"undefined"!=typeof window&&window||null;function yT(t,e,n){if(!t)return[];const[r,i]=t,o=(new am).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new am).union(e),o=t.marktype;return o?Nv(t,i,n,r):"group"===o?Ov(t,i,n,r):Rt("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,o,function(t){let e=null;if(t){const n=de(t.marktype),r=de(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))}const vT={random:()=>Q(),cumulativeNormal:it,cumulativeLogNormal:ct,cumulativeUniform:pt,densityNormal:rt,densityLogNormal:ut,densityUniform:ht,quantileNormal:ot,quantileLogNormal:ft,quantileUniform:mt,sampleNormal:nt,sampleLogNormal:lt,sampleUniform:dt,isArray:Qt,isBoolean:Fe,isDate:Te,isDefined:t=>void 0!==t,isNumber:Ne,isObject:Jt,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:Oe,isTuple:ka,isValid:t=>null!=t&&t==t,toBoolean:Le,toDate:t=>Ue(t),toNumber:te,toString:qe,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return hT(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return dT(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return hT(t).lastIndexOf(...n)},replace:function(t,e,n){return he(n)&&Rt("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return dT(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return hT(t).slice(...n)},flush:function(t,e,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,l=t[0],u=Kt(t);u<l&&(s=l,l=u,u=s),s=Math.abs(e-l);const c=Math.abs(u-e);return s<c&&s<=a?r:c<=a?i:o},lerp:function(t,e){const n=t[0],r=Kt(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),we(...t)},pad:function(t,e,n,r){const i=n||" ",o=t+"",a=e-o.length;return a<=0?o:"left"===r?Re(i,a)+o:"center"===r?Re(i,~~(a/2))+o+Re(i,Math.ceil(a/2)):o+Re(i,a)},peek:Kt,pluck:function(t,e){const n=fT[e]||(fT[e]=Bt(e));return Qt(t)?t.map(n):n(t)},span:Pe,inrange:De,truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",o=t+"",a=o.length,s=Math.max(0,e-i.length);return a<=e?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},rgb:yc,lab:Ad,hcl:Fd,hsl:Mc,luminance:sT,contrast:function(t,e){const n=sT(t),r=sT(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:is,format:IF,utcFormat:$F,utcParse:ZF,utcOffset:function(t,e,n){return ei(ti(t),e,n)},utcSequence:function(t,e,n,r){return ni(ti(t),e,n,r)},timeFormat:WF,timeParse:HF,timeOffset:function(t,e,n){return ei(Kr(t),e,n)},timeSequence:function(t,e,n,r){return ni(Kr(t),e,n,r)},timeUnitSpecifier:function(t,e){const n=we({},Nr,e),r=Tr(t),i=r.length;let o,a,s="",l=0;for(l=0;l<i;)for(o=r.length;o>l;--o)if(a=r.slice(l,o).join("-"),null!=n[a]){s+=n[a],l=o;break}return s.trim()},monthFormat:function(t){return VF.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return VF.call(this,t,1,"%b")},dayFormat:function(t){return VF.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return VF.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return Pr(new Date(t))},utcweek:function(t){return Ur(new Date(t))},dayofyear:function(t){return Rr(new Date(t))},utcdayofyear:function(t){return jr(new Date(t))},warn:function(){return oT(this.context.dataflow,"warn",arguments)},info:function(){return oT(this.context.dataflow,"info",arguments)},debug:function(){return oT(this.context.dataflow,"debug",arguments)},extent:t=>ke(t),inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:yT,clampRange:function(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=gT();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=gT();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return Qd(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(It).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?Op(n,e=e||wp(t)):t}},panLinear:function(t,e){return ae(t,e,te,jt)},panLog:function(t,e){var n=Math.sign(t[0]);return ae(t,e,ne(n),ee(n))},panPow:function(t,e,n){return ae(t,e,oe(n),oe(1/n))},panSymlog:function(t,e,n){return ae(t,e,re(n),ie(n))},zoomLinear:le,zoomLog:ue,zoomPow:ce,zoomSymlog:fe,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){const a=this.context.dataflow,s=this.context.data[t],l=s.input,u=a.stamp();let c,f,d=s.changes;if(!1===a._trigger||!(l.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=a.changeset(),d.stamp=u,a.runAfter((()=>{s.modified=!0,a.pulse(l,d).run()}),!0,1)),n&&(c=!0===n?It:Qt(n)||ka(n)?n:cT(n),d.remove(c)),e&&d.insert(e),r&&(c=cT(r),l.value.some(c)?d.remove(c):d.insert(r)),i)for(f in o)d.modify(i,f,o[f]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(t=de(t))[t.length-1];return void 0===i||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return de(t).reduce(((e,n,r)=>{let[i,o]=n;return e+(0==r?"M ".concat(i,",").concat(o," "):r===t.length-1?" Z":"L ".concat(i,",").concat(o," "))}),"")},intersectLasso:function(t,e,n){const{x:r,y:i,mark:o}=n,a=(new am).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of e)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);return a.translate(r,i),yT([[a.x1,a.y1],[a.x2,a.y2]],t,o).filter((t=>function(t,e,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,s]=n[o],[l,u]=n[i];u>e!=s>e&&t<(a-l)*(e-u)/(s-u)+l&&r++}return 1&r}(t.x,t.y,e)))}},bT=["view","item","group","xy","x","y"],xT="this.",_T={},wT={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(Be(XF+t),"]"),functions:function(t){const e=yD(t);bT.forEach((t=>e[t]="event.vega."+t));for(const n in vT)e[n]=xT+n;return we(e,function(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=JF,n._range=JF,n._scale=JF;const r=e=>"_["+(e.type===WC?Be(GF+e.value):Be(GF)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}(t,vT,_T)),e},constants:gD,visitors:_T},kT=function(t){const e=(t=t||{}).allowed?Ie(t.allowed):{},n=t.forbidden?Ie(t.forbidden):{},r=t.constants||gD,i=(t.functions||yD)(f),o=t.globalvar,a=t.fieldvar,s=he(o)?o:t=>"".concat(o,'["').concat(t,'"]');let l={},u={},c=0;function f(t){if(Oe(t))return t;const e=d[t.type];return null==e&&Rt("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return c>0?i:Ee(n,i)?Rt("Illegal identifier: "+i):Ee(r,i)?r[i]:Ee(e,i)?i:(l[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=f(t.object);e&&(c+=1);const r=f(t.property);return n===a&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&Rt("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Ee(i,e)&&i[e];return r||Rt("Unrecognized function: "+e),he(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(f).join(",")+"]",BinaryExpression:t=>"("+f(t.left)+" "+t.operator+" "+f(t.right)+")",UnaryExpression:t=>"("+t.operator+f(t.argument)+")",ConditionalExpression:t=>"("+f(t.test)+"?"+f(t.consequent)+":"+f(t.alternate)+")",LogicalExpression:t=>"("+f(t.left)+t.operator+f(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(f).join(",")+"}",Property:t=>{c+=1;const e=f(t.key);return c-=1,e+":"+f(t.value)}};function h(t){const e={code:f(t),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},e}return h.functions=i,h.constants=r,h}(wT);function AT(t,e,n){return 1===arguments.length?vT[t]:(vT[t]=e,n&&(_T[t]=n),kT&&(kT.functions[t]=xT+t),this)}function ET(t,e){const n={};let r;try{r=function(t){VC=0,GC=(YC=t).length,XC=null,YS();const e=mD();if(XC.type!==JC)throw new Error("Unexpect token after expression.");return e}(t=Oe(t)?t:Be(t)+"")}catch(e){Rt("Expression parse error: "+t)}r.visit((t=>{if(t.type!==$C)return;const r=t.callee.name,i=wT.visitors[r];i&&i(r,t.arguments,e,n)}));const i=kT(r);return i.globals.forEach((t=>{const r=XF+t;!Ee(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:we({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}AT("bandwidth",(function(t,e){const n=tT(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),JF),AT("copy",(function(t,e){const n=tT(t,(e||this).context);return n?n.copy():void 0}),JF),AT("domain",(function(t,e){const n=tT(t,(e||this).context);return n?n.domain():[]}),JF),AT("range",(function(t,e){const n=tT(t,(e||this).context);return n&&n.range?n.range():[]}),JF),AT("invert",(function(t,e,n){const r=tT(t,(n||this).context);return r?Qt(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),JF),AT("scale",(function(t,e,n){const r=tT(t,(n||this).context);return r?r(e):void 0}),JF),AT("gradient",(function(t,e,n,r,i){t=tT(t,(i||this).context);const o=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let a=t.domain(),s=a[0],l=Kt(a),u=jt;return l-s?u=Bh(t,s,l):t=(t.interpolator?Mh("sequential")().interpolator(t.interpolator()):Mh("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,l=1]),t.ticks&&(a=t.ticks(+r||15),s!==a[0]&&a.unshift(s),l!==Kt(a)&&a.push(l)),a.forEach((e=>o.stop(u(e),t(e)))),o}),JF),AT("geoArea",nT,JF),AT("geoBounds",rT,JF),AT("geoCentroid",iT,JF),AT("geoShape",(function(t,e,n){const r=tT(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),JF),AT("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==WC&&Rt("First argument to indata must be a string literal."),e[1].type!==WC&&Rt("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,a="@"+o;Ee(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),AT("data",UF,QF),AT("treePath",(function(t,e,n){const r=mT(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(pT):void 0}),QF),AT("treeAncestors",(function(t,e){const n=mT(t,this)[e];return n?n.ancestors().map(pT):void 0}),QF),AT("vlSelectionTest",(function(t,e,n){for(var r,i,o,a,s,l=this.context.data[t],u=l?l.values.value:[],c=l?l[OF]&&l[OF].value:void 0,f=n===DF,d=u.length,h=0;h<d;++h)if(r=u[h],c&&f){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=zF(e,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(f^(s=zF(e,r)))return s;return d&&f}),jF),AT("vlSelectionIdTest",(function(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],o=r?r[OF]&&r[OF].value:void 0,a=n===DF,s=NF(e),l=PF(i,s);if(l===i.length)return!1;if(NF(i[l])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(BF(i,s)-l<o.size)return!1}return!0}),jF),AT("vlSelectionResolve",(function(t,e,n,r){for(var i,o,a,s,l,u,c,f,d,h,p,m,g=this.context.data[t],y=g?g.values.value:[],v={},b={},x={},_=y.length,w=0;w<_;++w)if(s=(i=y[w]).unit,o=i.fields,a=i.values,o&&a){for(p=0,m=o.length;p<m;++p)l=o[p],f=(c=v[l.field]||(v[l.field]={}))[s]||(c[s]=[]),x[l.field]=d=l.type.charAt(0),h=LF["".concat(d,"_union")],c[s]=h(f,de(a[p]));n&&(f=b[s]||(b[s]=[])).push(de(a).reduce(((t,e,n)=>(t[o[n].field]=e,t)),{}))}else l=TF,u=NF(i),(f=(c=v[l]||(v[l]={}))[s]||(c[s]=[])).push(u),n&&(f=b[s]||(b[s]=[])).push({[TF]:u});return e=e||FF,v[TF]?v[TF]=LF["".concat(TF,"_").concat(e)](...Object.values(v[TF])):Object.keys(v).forEach((t=>{v[t]=Object.keys(v[t]).map((e=>v[t][e])).reduce(((n,r)=>void 0===n?r:LF["".concat(x[t],"_").concat(e)](n,r)))})),y=Object.keys(b),n&&y.length&&(v[r?"vlPoint":"vlMulti"]=e===FF?{or:y.reduce(((t,e)=>(t.push(...b[e]),t)),[])}:{and:y.map((t=>({or:b[t]})))}),v}),jF),AT("vlSelectionTuples",(function(t,e){return t.map((t=>we(e.fields?{values:e.fields.map((e=>(e.getter||(e.getter=Bt(e.field)))(t.datum)))}:{[TF]:NF(t.datum)},e)))}));const MT=Ie(["rule"]),CT=Ie(["group","image","rect"]);function ST(t){return(t+"").toLowerCase()}function DT(t,e,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var FT={operator:(t,e)=>DT(t,["_"],e.code),parameter:(t,e)=>DT(t,["datum","_"],e.code),event:(t,e)=>DT(t,["event"],e.code),handler:(t,e)=>DT(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const t="o["+Be(o)+"]";i+="$=".concat(r[o].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(t,e){let n="";return MT[e]||(t.x2&&(t.x?(CT[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(CT[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",DT(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(Be).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let o,a;return t.path?(o="a".concat(t.path),a="b".concat(t.path)):((n=n||{})["f"+r]=t,o="this.f".concat(r,"(a)"),a="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function TT(t,e,n){if(!t||!Jt(t))return t;for(let r,i=0,o=NT.length;i<o;++i)if(r=NT[i],Ee(t,r.key))return r.parse(t,e,n);return t}var NT=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||Rt("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=ze(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=Dt(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=Bt(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=Dt(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=de(t.$compare).map((t=>t&&t.$tupleid?Aa:t));return e.fn[n]||(e.fn[n]=me(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>e.detach(o),a}}},{key:"$tupleid",parse:function(){return Aa}}];const OT={skip:!0};function zT(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||FT,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function RT(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function PT(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}zT.prototype=RT.prototype={fork(){const t=new RT(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),"collect"===ST(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const o in t.data){const r=n.data[o]||(n.data[o]={});t.data[o].forEach((t=>r[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[ST(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;"operator"!==ST(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||Rt("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=Qt(i)?i.map((t=>TT(t,n,e))):TT(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&Rt("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=Jt(r=t.source)?r.$ref:r,i=n.get(r),o=t.update,a=void 0;i||Rt("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(t,i,e,o,a)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],OT)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(It).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const BT="default";function LT(t,e){const n=t.globalCursor()?"undefined"!=typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function jT(t,e){var n=t._runtime.data;return Ee(n,e)||Rt("Unrecognized data set: "+e),n[e]}function UT(t,e){Ta(e)||Rt("Second argument to changes must be a changeset.");const n=jT(this,t);return n.modified=!0,this.pulse(n.input,e)}function qT(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function IT(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function WT(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}const $T="view",HT={trap:!1};function ZT(t,e,n,r){t._eventListeners.push({type:n,sources:de(e),handler:r})}function YT(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||Jt(r)&&!r[n])||(t.warn("Blocked ".concat(e," ").concat(n," event listener.")),!1)}function VT(t){return t.item}function GT(t){return t.item.mark.source}function XT(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function QT(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}const JT="vega-bind-radio";function KT(t,e,n,r){const i=n.event||"input",o=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,o),ZT(r,e,i,o),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!=typeof Event?new Event(t):{type:t}}(i))}}function tN(t,e,n,r){const i=r.signal(n.signal),o=QT("div",{class:"vega-bind"}),a="radio"===n.input?o:o.appendChild(QT("label"));a.appendChild(QT("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(o);let s=eN;switch(n.input){case"checkbox":s=nN;break;case"select":s=rN;break;case"radio":s=iN;break;case"range":s=oN}s(t,a,n,i)}function eN(t,e,n,r){const i=QT("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function nN(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=QT("input",i);e.appendChild(o),o.addEventListener("change",(()=>t.update(o.checked))),t.elements=[o],t.set=t=>o.checked=!!t||null}function rN(t,e,n,r){const i=QT("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};aN(t,r)&&(n.selected=!0),i.appendChild(QT("option",n,(o[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(aN(n.options[e],t))return void(i.selectedIndex=e)}}function iN(t,e,n,r){const i=QT("span",{class:JT}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,a)=>{const s={type:"radio",name:n.signal,value:e};aN(e,r)&&(s.checked=!0);const l=QT("input",s);l.addEventListener("change",(()=>t.update(e)));const u=QT("label",{},(o[a]||e)+"");return u.prepend(l),i.appendChild(u),l})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)aN(n[t].value,e)&&(n[t].checked=!0)}}function oN(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||dn(o,i,100),s=QT("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const l=QT("span",{},+r);e.appendChild(s),e.appendChild(l);const u=()=>{l.textContent=s.value,t.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),t.elements=[s],t.set=t=>{s.value=t,l.textContent=t}}function aN(t,e){return t===e||t+""==e+""}function sN(t,e,n,r,i,o){return(e=e||new r(t.loader())).initialize(n,qT(t),IT(t),WT(t),i,o).background(t.background())}function lN(t,e){return e?function(){try{e.apply(this,arguments)}catch(e){t.error(e)}}:null}function uN(t,e,n){if("string"==typeof e){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.textContent=""}catch(n){e=null,t.error(n)}return e}const cN=t=>+t||0;function fN(t){return Jt(t)?{top:cN(t.top),bottom:cN(t.bottom),left:cN(t.left),right:cN(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(cN(t))}async function dN(t,e,n,r){const i=Tv(e),o=i&&i.headless;return o||Rt("Unrecognized renderer type: "+e),await t.runAsync(),sN(t,null,null,o,n,r).renderAsync(t._scenegraph.root)}var hN="width",pN="height",mN="padding",gN={skip:!0};function yN(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===mN?r.left+r.right:0)}function vN(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===mN?r.top+r.bottom:0)}function bN(t,e){return e.modified&&Qt(e.input.value)&&t.indexOf("_:vega:_")}function xN(t,e){return!("parent"===t||e instanceof rs.proxy)}function _N(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":Qt(t)?wN(t):Jt(t)&&!Te(t)?(e=t,Object.keys(e).map((t=>{const n=e[t];return t+": "+(Qt(n)?wN(n):kN(n))})).join("\n")):t+"";var e}(r))}function wN(t){return"["+t.map(kN).join(", ")+"]"}function kN(t){return Qt(t)?"[\u2026]":Jt(t)&&!Te(t)?"{\u2026}":t}function AN(t,e){return Ee(t._signals,e)?t._signals[e]:Rt("Unrecognized signal name: "+Be(e))}function EN(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function MN(t,e,n,r){let i=EN(n,r);return i||(i=lN(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function CN(t,e,n){const r=EN(e,n);return r&&e._targets.remove(r),t}Se((function(t,e){const n=this;if(e=e||{},ts.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=we({},t.locale,e.locale);n.locale(function(t,e){const n=t?Wo(t):$o(),r=e?Yo(e):Vo();return Go(n,r)}(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||Sv,n._scenegraph=new ly;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||_N,n._redraw=!0,n._handler=(new zy).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=we({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{Qt(t[e])&&(t[e]=Ie(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return function(t,e,n,r){return new zT(t,e,n,r)}(t,rs,vT,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:we({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=yN(n,n._width),n._viewHeight=vN(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e[hN],r=e[pN],i=e[mN];function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=yN(t,e.size),o()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=vN(t,e.size),o()}),{size:r});const a=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:BT,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const r=e.value,i=r?Oe(r)?r:r.user:BT,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return Oe(n)||(r=n.item,n=n.user),LT(t,n&&n!==BT?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}),ts,{async evaluate(t,e,n){if(await ts.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=WT(r=this),o=qT(r),a=IT(r),r._renderer.background(r.background()),r._renderer.resize(o,a,i),r._handler.origin(i),r._resizeListeners.forEach((t=>{try{t(o,a)}catch(t){r.error(t)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(t){this.error(t)}var r,i,o,a;return n&&xa(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&PT(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=AN(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",fN(t)):fN(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(Tv(t)||Rt("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(ts.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(AN(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(hN,n,gN),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(pN,r,gN),a._resizeHeight.skip(!0)),a._viewWidth!==t&&(a._resize=1,a._viewWidth=t),a._viewHeight!==e&&(a._resize=1,a._viewHeight=e),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=lN(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return MN(this,t,AN(this,t),e)},removeSignalListener(t,e){return CN(this,AN(this,t),e)},addDataListener(t,e){return MN(this,t,jT(this,t).values,e)},removeDataListener(t,e){return CN(this,jT(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=LT(this,null);this._globalCursor=!!t,e&&LT(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new jA,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?BA():+n,r._restart((function o(a){a+=i,r._restart(o,i+=e,n),t(a)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,o=new Ua(n),a=function(n,r){i.runAsync(null,(()=>{t===$T&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),o.receive(function(t,e,n){var r,i,o=t._renderer,a=o&&o.canvas();return a&&(i=WT(t),(r=my(e.changedTouches?e.changedTouches[0]:e,a))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;Oe(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:xe(t),item:xe(e||{}),group:i,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}(t,n,r),e}(i,n,r))}))};if("timer"===t)YT(i,"timer",e)&&i.timer(a,e);else if(t===$T)YT(i,"view",e)&&i.addEventListener(e,a,HT);else if("window"===t?YT(i,"window",e)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&YT(i,"selector",e)&&(r=Array.from(document.querySelectorAll(t))),r){for(var s=0,l=r.length;s<l;++s)r[s].addEventListener(e,a);ZT(i,r,e,a)}else i.warn("Can not resolve event source: "+t);return o},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=o.length;--t>=0;)for(e=(n=o[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",VT),GT,XT(t)),this.on(this.events("view","mouseout",VT),GT,XT(e)),this},data:function(t,e){return arguments.length<2?jT(this,t).values.value:UT.call(this,t,Na().remove(It).insert(e))},change:UT,insert:function(t,e){return UT.call(this,t,Na().insert(e))},remove:function(t,e){return UT.call(this,t,Na().remove(e))},scale:function(t){var e=this._runtime.scales;return Ee(e,t)||Rt("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Tv(r);t=n._el=t?uN(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),PT(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||zy,s=t?o.renderer:o.headless;return n._renderer=s?sN(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),lN(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,WT(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,a),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=uN(n,e,!0):t.appendChild(QT("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=uN(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=_e(r.debounce,i.update))),(null==r.input&&r.element?KT:tN)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==Sv&&t!==Dv&&"png"!==t&&Rt("Unrecognized image type: "+t);const n=await dN(this,t,e);return t===Dv?function(t,e){const n=new Blob([t],{type:"image/svg+xml"});return window.URL.createObjectURL(n)}(n.svg()):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await dN(this,Sv,t,e)).canvas()},toSVG:async function(t){return(await dN(this,Dv,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:bN,signals:xN,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this}});const SN="view",DN="[",FN="]",TN="{",NN="}",ON=":",zN=",",RN="@",PN=">",BN=/[[\]{}]/,LN={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let jN,UN;function qN(t,e,n,r,i){const o=t.length;let a,s=0;for(;e<o;++e){if(a=t[e],!s&&a===n)return e;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return e}function IN(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=qN(t,i,zN,DN+TN,FN+NN),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function WN(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=qN(t,r,FN,DN,FN),r===e)throw"Empty between selector: "+t;if(n=IN(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if((t=t.slice(r+1).trim())[0]!==PN)throw"Expected '>' after between selector: "+t;n=n.map(WN);const i=WN(t.slice(1).trim());return i.between?{between:n,stream:i}:(i.between=n,i)}(t):function(t){const e={source:jN},n=[];let r,i,o=[0,0],a=0,s=0,l=t.length,u=0;if(t[l-1]===NN){if(u=t.lastIndexOf(TN),!(u>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(zN);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!=n)throw t;return n}))}(t.substring(u+1,l-1))}catch(e){throw"Invalid throttle specification: "+t}l=(t=t.slice(0,u).trim()).length,u=0}if(!l)throw t;if(t[0]===RN&&(a=++u),r=qN(t,u,ON),r<l&&(n.push(t.substring(s,r).trim()),s=u=++r),u=qN(t,u,DN),u===l)n.push(t.substring(s,l).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===l)throw"Unmatched left bracket: "+t;for(;u<l;){if(u=qN(t,u,FN),u===l)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<l-1&&t[++u]!==DN)throw"Expected left bracket: "+t;s=++u}if(!(l=n.length)||BN.test(n[l-1]))throw"Invalid event selector: "+t;var c;return l>1?(e.type=n[1],a?e.markname=n[0].slice(1):(c=n[0],UN[c]?e.marktype=n[0]:e.source=n[0])):e.type=n[0],"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1)),null!=i&&(e.filter=i),o[0]&&(e.throttle=o[0]),o[1]&&(e.debounce=o[1]),e}(t)}const $N=t=>Jt(t)&&!Qt(t)?we({},t):{value:t};function HN(t,e,n,r){return null!=n?(Jt(n)&&!Qt(n)||Qt(n)&&n.length&&Jt(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1):0}function ZN(t,e,n){for(const r in e)HN(t,r,e[r]);for(const r in n)HN(t,r,n[r],"update")}function YN(t,e,n){for(const r in e)n&&Ee(n,r)||(t[r]=we(t[r]||{},e[r]));return t}function VN(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const GN="mark",XN="frame",QN="scope",JN="axis",KN="axis-domain",tO="axis-grid",eO="axis-label",nO="axis-tick",rO="axis-title",iO="legend-band",oO="legend-gradient",aO="legend-label",sO="legend-symbol";function lO(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const uO=t=>Oe(t)?Be(t):t.signal?"(".concat(t.signal,")"):hO(t);function cO(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:Be(t)));for(;e.length&&null==Kt(e);)e.pop();return e.unshift(uO(t.gradient)),"gradient(".concat(e.join(","),")")}(t);let e=t.signal?"(".concat(t.signal,")"):t.color?function(t){return t.c?fO("hcl",t.h,t.c,t.l):t.h||t.s?fO("hsl",t.h,t.s,t.l):t.l||t.a?fO("lab",t.l,t.a,t.b):t.r||t.g||t.b?fO("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?hO(t.field):void 0!==t.value?Be(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=uO(t.scale);return null!=t.range?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(void 0!==e&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(1==+t.band?"":"*"+dO(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),null==e&&(e="0")),e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e="pow(".concat(e,",").concat(dO(t.exponent),")")),null!=t.mult&&(e+="*".concat(dO(t.mult))),null!=t.offset&&(e+="+".concat(dO(t.offset))),t.round&&(e="round(".concat(e,")")),e}const fO=(t,e,n,r)=>"(".concat(t,"(").concat([e,n,r].map(cO).join(","),")+'')");function dO(t){return Jt(t)?"("+cO(t)+")":t}function hO(t){return pO(Jt(t)?t:{datum:t})}function pO(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):Rt("Invalid field reference: "+Be(t));return t.signal||(r=Oe(r)?Pt(r).map(Be).join("]["):pO(r)),e+"["+r+"]"}function mO(t,e,n,r){const i={},o={};for(const s in t)null!=t[s]&&(i[s]=gO((a=t[s],Qt(a)?function(t){let e="";return t.forEach((t=>{const n=cO(t);e+=t.test?"(".concat(t.test,")?").concat(n,":"):n})),":"===Kt(e)&&(e+="null"),e}(a):cO(a)),r,n,o));var a;return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function gO(t,e,n,r){const i=ET(t,e);return i.$fields.forEach((t=>r[t]=1)),we(n,i.$params),i.$expr}const yO=["value","update","init","react","bind"];function vO(t,e){Rt(t+' for "outer" push: '+Be(e))}function bO(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function xO(t,e,n,r){return new bO(t,e,n,r)}function _O(t,e){return xO("operator",t,e)}function wO(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function kO(t,e){return e?{$field:t,$name:e}:{$field:t}}const AO=kO("key");function EO(t,e){return{$compare:t,$order:e}}function MO(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const CO="scope",SO="view";function DO(t){return t&&t.signal}function FO(t){if(DO(t))return!0;if(Jt(t))for(const e in t)if(FO(t[e]))return!0;return!1}function TO(t,e){return null!=t?t:e}function NO(t){return t&&t.signal||t}const OO="timer";function zO(t,e){return(t.merge?RO:t.stream?PO:t.type?BO:Rt("Invalid stream specification: "+Be(t)))(t,e)}function RO(t,e){const n=LO({merge:t.merge.map((t=>zO(t,e)))},t,e);return e.addStream(n).id}function PO(t,e){const n=LO({stream:zO(t.stream,e)},t,e);return e.addStream(n).id}function BO(t,e){let n;var r;t.type===OO?(n=e.event(OO,t.throttle),t={between:t.between,filter:t.filter}):n=e.event((r=t.source)===CO?SO:r||SO,t.type);const i=LO({stream:n},t,e);return 1===Object.keys(i).length?n:e.addStream(i).id}function LO(t,e,n){let r=e.between;return r&&(2!==r.length&&Rt('Stream "between" parameter must have 2 entries: '+Be(e)),t.between=[zO(r[0],n),zO(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===CO&&r.push("inScope(event.item)"),r.length&&(t.filter=ET("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const jO={code:"_.$value",ast:{type:"Identifier",value:"value"}};function UO(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const qO=t=>(e,n,r)=>xO(t,n,e||void 0,r),IO=qO("aggregate"),WO=qO("axisticks"),$O=qO("bound"),HO=qO("collect"),ZO=qO("compare"),YO=qO("datajoin"),VO=qO("encode"),GO=qO("expression"),XO=qO("facet"),QO=qO("field"),JO=qO("key"),KO=qO("legendentries"),tz=qO("load"),ez=qO("mark"),nz=qO("multiextent"),rz=qO("multivalues"),iz=qO("overlap"),oz=qO("params"),az=qO("prefacet"),sz=qO("projection"),lz=qO("proxy"),uz=qO("relay"),cz=qO("render"),fz=qO("scale"),dz=qO("sieve"),hz=qO("sortitems"),pz=qO("viewlayout"),mz=qO("values");let gz=0;const yz={min:"min",max:"max",count:"sum"};function vz(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=wz(t.domain,t,e),null!=t.range&&(n.range=Fz(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=bz(t.type||t),null!=t.gamma&&(e.interpolateGamma=bz(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=function(t){return Jt(t)?{interval:bz(t.interval),step:bz(t.step)}:bz(t)}(t.nice)),null!=t.bins&&(n.bins=function(t,e){return t.signal||Qt(t)?xz(t,e):e.objectProperty(t)}(t.bins,e)),t)Ee(n,r)||"name"===r||(n[r]=bz(t[r],e))}function bz(t,e){return Jt(t)?t.signal?e.signalRef(t.signal):Rt("Unsupported object: "+Be(t)):t}function xz(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>bz(t,e)))}function _z(t){Rt("Can not find data set: "+Be(t))}function wz(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(Qt(t)?kz:t.fields?Ez:Az)(t,e,n);null==e.domainMin&&null==e.domainMax||Rt("No scale domain defined for domainMin/domainMax to override.")}function kz(t,e,n){return t.map((t=>bz(t,n)))}function Az(t,e,n){const r=n.getData(t.data);return r||_z(t.data),Fh(e.type)?r.valuesRef(n,t.field,Cz(t.sort,!1)):zh(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function Ez(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=Oe(e)?{data:r,field:e}:Qt(e)||e.signal?function(t,e){const n="_:vega:_"+gz++,r=HO({});if(Qt(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+Be(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,dz({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(Fh(e.type)?Mz:zh(e.type)?Sz:Dz)(t,n,i)}function Mz(t,e,n){const r=Cz(t.sort,!0);let i,o;const a=n.map((t=>{const n=e.getData(t.data);return n||_z(t.data),n.countsRef(e,t.field,r)})),s={groupby:AO,pulse:a};r&&(i=r.op||"count",o=r.field?MO(i,r.field):"count",s.ops=[yz[i]],s.fields=[e.fieldRef(o)],s.as=[o]),i=e.add(IO(s));const l=e.add(HO({pulse:wO(i)}));return o=e.add(mz({field:AO,sort:e.sortRef(r),pulse:wO(l)})),wO(o)}function Cz(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!yz[t.op]&&Rt("Multiple domain scales can not be sorted using "+t.op):Rt("No field provided for sort aggregate op: "+t.op):Jt(t)?t.field="key":t={field:"key"}),t}function Sz(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||_z(t.data),n.domainRef(e,t.field)}));return wO(e.add(rz({values:r})))}function Dz(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||_z(t.data),n.extentRef(e,t.field)}));return wO(e.add(nz({extents:r})))}function Fz(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(Oe(i)){if(r&&Ee(r,i))return Fz(t=we({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Fh(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Rt("Unrecognized scale range value: "+Be(i))}else{if(i.scheme)return n.scheme=Qt(i.scheme)?xz(i.scheme,e):bz(i.scheme,e),i.extent&&(n.schemeExtent=xz(i.extent,e)),void(i.count&&(n.schemeCount=bz(i.count,e)));if(i.step)return void(n.rangeStep=bz(i.step,e));if(Fh(t.type)&&!Qt(i))return wz(i,t,e);Qt(i)||Rt("Unsupported range type: "+Be(i))}return i.map((t=>(Qt(t)?xz:bz)(t,e)))}function Tz(t,e,n){return Qt(t)?t.map((t=>Tz(t,e,n))):Jt(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:Rt("Unsupported parameter object: "+Be(t)):t}const Nz="top",Oz="left",zz="right",Rz="bottom",Pz="center",Bz="vertical",Lz="start",jz="end",Uz="index",qz="label",Iz="offset",Wz="perc",$z="perc2",Hz="value",Zz="guide-label",Yz="guide-title",Vz="symbol",Gz="gradient",Xz="discrete",Qz="size",Jz=[Qz,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],Kz={name:1,style:1,interactive:1},tR={value:0},eR={value:1},nR="group",rR="rect",iR="rule",oR="symbol",aR="text";function sR(t){return t.type=nR,t.interactive=t.interactive||!1,t}function lR(t,e){const n=(n,r)=>TO(t[n],TO(e[n],r));return n.isVertical=n=>Bz===TO(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>TO(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>TO(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>TO(t.columns,TO(e.columns,+n.isVertical(!0))),n}function uR(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function cR(t,e,n){return"item.anchor === '".concat(Lz,"' ? ").concat(t," : item.anchor === '").concat(jz,"' ? ").concat(e," : ").concat(n)}const fR=cR(Be(Oz),Be(zz),Be(Pz));function dR(t,e){return e?t?Jt(t)?Object.assign({},t,{offset:dR(t.offset,e)}):{value:t,offset:e}:e:t}function hR(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=YN(t.encode,e,Kz)):t.interactive=!1,t}function pR(t,e,n,r){const i=lR(t,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let l,u,c,f,d;o?(u=[0,1],c=[0,0],f=a,d=s):(u=[0,0],c=[1,0],f=s,d=a);const h={enter:l={opacity:tR,x:tR,y:tR,width:$N(f),height:$N(d)},update:we({},l,{opacity:eR,fill:{gradient:e,start:u,stop:c}}),exit:{opacity:tR}};return ZN(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),hR({type:rR,role:oO,encode:h},r)}function mR(t,e,n,r,i){const o=lR(t,n),a=o.isVertical(),s=o.gradientThickness(),l=o.gradientLength();let u,c,f,d,h="";a?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:tR,fill:{scale:e,field:Hz}};p[u]={signal:h+"datum."+Wz,mult:l},p[c]=tR,p[f]={signal:h+"datum."+$z,mult:l},p[d]=$N(s);const m={enter:p,update:we({},p,{opacity:eR}),exit:{opacity:tR}};return ZN(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),hR({type:rR,role:iO,key:Hz,from:i,encode:m},r)}const gR="datum.".concat(Wz,'<=0?"').concat(Oz,'":datum.').concat(Wz,'>=1?"').concat(zz,'":"').concat(Pz,'"'),yR="datum.".concat(Wz,'<=0?"').concat(Rz,'":datum.').concat(Wz,'>=1?"').concat(Nz,'":"middle"');function vR(t,e,n,r){const i=lR(t,e),o=i.isVertical(),a=$N(i.gradientThickness()),s=i.gradientLength();let l,u,c,f,d=i("labelOverlap"),h="";const p={enter:l={opacity:tR},update:u={opacity:eR,text:{field:qz}},exit:{opacity:tR}};return ZN(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:TO(t.labelLimit,e.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=u.baseline={signal:yR},c="y",f="x",h="1-"):(l.align=u.align={signal:gR},l.baseline={value:"top"},c="x",f="y"),l[c]=u[c]={signal:h+"datum."+Wz,mult:s},l[f]=u[f]=a,a.offset=TO(t.labelOffset,e.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+Uz}:void 0,hR({type:aR,role:aO,style:Zz,key:Hz,from:r,encode:p,overlap:d},n)}function bR(t,e,n,r,i){const o=lR(t,e),a=n.entries,s=!(!a||!a.interactive),l=a?a.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(Iz," : datum.").concat(Qz),h=u?$N(u):{field:Qz},p="datum.".concat(Uz),m="max(1, ".concat(i,")");let g,y,v,b,x;h.mult=.5,g={enter:y={opacity:tR,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:eR,x:y.x,y:y.y},exit:{opacity:tR}};let _=null,w=null;t.fill||(_=e.symbolBaseFillColor,w=e.symbolBaseStrokeColor),ZN(g,{fill:o("symbolFillColor",_),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",w),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),Jz.forEach((e=>{t[e]&&(v[e]=y[e]={scale:t[e],field:Hz})}));const k=hR({type:oR,role:sO,key:Hz,from:f,clip:!!u||void 0,encode:g},n.symbols),A=$N(c);A.offset=o("labelOffset"),g={enter:y={opacity:tR,x:{signal:d,offset:A},y:h},update:v={opacity:eR,text:{field:qz},x:y.x,y:y.y},exit:{opacity:tR}},ZN(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const E=hR({type:aR,role:aO,style:Zz,key:Hz,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:tR,height:u?$N(u):tR,opacity:tR},exit:{opacity:tR},update:v={opacity:eR,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(m,")"),v.row.signal="".concat(p,"%").concat(b),v.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(v.row.signal="floor(".concat(p," / ").concat(m,")"),v.column.signal="".concat(p," % ").concat(m),x={field:p}),v.column.signal="(".concat(i,")?").concat(v.column.signal,":").concat(p),sR({role:QN,from:r={facet:{data:r,name:"value",groupby:Uz}},encode:YN(g,a,Kz),marks:[k,E],name:l,interactive:s,sort:x})}const xR='item.orient === "left"',_R='item.orient === "right"',wR="(".concat(xR," || ").concat(_R,")"),kR="datum.vgrad && ".concat(wR),AR=cR('"top"','"bottom"','"middle"'),ER="datum.vgrad && ".concat(_R," ? (").concat(cR('"right"','"left"','"center"'),") : (").concat(wR," && !(datum.vgrad && ").concat(xR,')) ? "left" : ').concat(fR),MR="item._anchor || (".concat(wR,' ? "middle" : "start")'),CR="".concat(kR," ? (").concat(xR," ? -90 : 90) : 0"),SR="".concat(wR," ? (datum.vgrad ? (").concat(_R,' ? "bottom" : "top") : ').concat(AR,') : "top"');function DR(t,e){let n;return Jt(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+FR(t.path)+")":t.sphere&&(n="geoShape("+FR(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function FR(t){return Jt(t)&&t.signal?t.signal:Be(t)}function TR(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===nR?QN:e||GN:e}function NR(t){return{marktype:t.type,name:t.name||void 0,role:t.role||TR(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function OR(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function zR(t,e){const n=function(t){const e=function(t){return t=t&&t.toLowerCase(),Ee(rs,t)?rs[t]:null}(t);return e&&e.Definition||null}(t.type);n||Rt("Unrecognized transform type: "+Be(t.type));const r=xO(n.type.toLowerCase(),null,RR(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function RR(t,e,n){const r={},i=t.params.length;for(let o=0;o<i;++o){const i=t.params[o];r[i.name]=PR(i,e,n)}return r}function PR(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){return Oe(e.from)||Rt('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(Qt(r)||Rt("Expected an array of sub-parameters. Instead: "+Be(r)),r.map((e=>LR(t,e,n)))):LR(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!DO(i)?i.map((e=>BR(t,e,n))):BR(t,i,n):void(t.required&&Rt("Missing required "+Be(e.type)+" parameter: "+Be(t.name)))}function BR(t,e,n){const r=t.type;if(DO(e))return IR(r)?Rt("Expression references can not be signals."):WR(r)?n.fieldRef(e):$R(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||WR(r);return i&&jR(e)?n.exprRef(e.expr,e.as):i&&UR(e)?kO(e.field,e.as):IR(r)?ET(e,n):qR(r)?wO(n.getData(e).values):WR(r)?kO(e):$R(r)?n.compareRef(e):e}}function LR(t,e,n){const r=t.params.length;let i;for(let a=0;a<r;++a){i=t.params[a];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||Rt("Unsupported parameter: "+Be(e));const o=we(RR(i,e,n),i.key);return wO(n.add(oz(o)))}const jR=t=>t&&t.expr,UR=t=>t&&t.field,qR=t=>"data"===t,IR=t=>"expr"===t,WR=t=>"field"===t,$R=t=>"compare"===t;function HR(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:wO(e.getData(t.data).output)}function ZR(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function YR(t){return Oe(t)?t:null}function VR(t,e,n){const r=MO(n.op,n.field);let i;if(e.ops){for(let o=0,a=e.as.length;o<a;++o)if(e.as[o]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function GR(t,e,n,r,i,o,a){const s=e[n]||(e[n]={}),l=function(t){return Jt(t)?("descending"===t.order?"-":"+")+MO(t.op,t.field):""}(o);let u,c,f=YR(i);if(null!=f&&(t=e.scope,f+=l?"|"+l:"",u=s[f]),!u){const n=o?{field:AO,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:wO(e.output)};l&&(n.sort=t.sortRef(o)),c=t.add(xO(r,void 0,n)),a&&(e.index[i]=c),u=wO(c),null!=f&&(s[f]=u)}return u}function XR(t,e,n){const r=t.remove,i=t.insert,o=t.toggle,a=t.modify,s=t.values,l=e.add(_O()),u=ET("if("+t.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((t=>null==t?"null":t)).join(",")+"),0)",e);l.update=u.$expr,l.params=u.$params}function QR(t,e){const n=TR(t),r=t.type===nR,i=t.from&&t.from.facet,o=t.overlap;let a,s,l,u,c,f,d,h=t.layout||n===QN||n===XN;const p=n===GN||h||i,m=function(t,e,n){let r,i,o,a,s;return t?(r=t.facet)&&(e||Rt("Only group marks can be faceted."),null!=r.field?a=s=HR(r,n):(t.data?s=wO(n.getData(t.data).aggregate):(o=zR(we({type:"aggregate",groupby:de(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=HR(r,n),a=s=wO(n.add(o))),i=n.keyRef(r.groupby,!0))):a=wO(n.add(HO(null,[{}]))),a||(a=HR(t,n)),{key:i,pulse:a,parent:s}}(t.from,r,e);s=e.add(YO({key:m.key||(t.key?kO(t.key):void 0),pulse:m.pulse,clean:!r}));const g=wO(s);s=l=e.add(HO({pulse:g})),s=e.add(ez({markdef:NR(t),interactive:OR(t.interactive,e),clip:DR(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:wO(s)}));const y=wO(s);s=u=e.add(VO(function(t,e,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},t=function(t,e,n,r,i){const o={},a={};let s,l,u,c;for(l in l="lineBreak","text"!==e||null==i[l]||VN(l,t)||lO(o,l,i[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===XN?i.group:n===GN?we({},i.mark,i[e]):null,c)u=VN(l,t)||("fill"===l||"stroke"===l)&&(VN("fill",t)||VN("stroke",t)),u||lO(o,l,c[l]);for(l in de(r).forEach((e=>{const n=i.style&&i.style[e];for(const r in n)VN(r,t)||lO(o,r,n[r])})),t=we({},t),o)c=o[l],c.signal?(s=s||{})[l]=c:a[l]=c;return t.enter=we(a,t.enter),s&&(t.update=we(s,t.update)),t}(t,e,n,r,i.config);for(const s in t)a[s]=mO(t[s],e,o,i);return o}(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=zR(t,e),r=n.metadata;(r.generates||r.changes)&&Rt("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=wO(s),e.add(s=n)})),t.sort&&(s=e.add(hz({sort:e.compareRef(t.sort),pulse:wO(s)})));const v=wO(s);(i||h)&&(h=e.add(pz({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),f=wO(h));const b=e.add($O({mark:y,pulse:f||v}));d=wO(b),r&&(p&&(a=e.operators,a.pop(),h&&a.pop()),e.pushState(v,f||d,g),i?function(t,e,n){const r=t.from.facet,i=r.name,o=HR(r,e);let a;r.name||Rt("Facet must have a name: "+Be(r)),r.data||Rt("Facet must reference a data set: "+Be(r)),r.field?a=e.add(az({field:e.fieldRef(r.field),pulse:o})):r.groupby?a=e.add(XO({key:e.keyRef(r.groupby),group:wO(e.proxy(n.parent)),pulse:o})):Rt("Facet must specify groupby or field: "+Be(r));const s=e.fork(),l=s.add(HO()),u=s.add(dz({pulse:wO(l)}));s.addData(i,new ZR(s,l,l,u)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(t).toRuntime()}}(t,e,m):p?function(t,e,n){const r=e.add(az({pulse:n.pulse})),i=e.fork();i.add(dz()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,m):e.parse(t),e.popState(),p&&(h&&a.push(h),a.push(b))),o&&(d=function(t,e,n){const r=t.method,i=t.bound,o=t.separation,a={separation:DO(o)?n.signalRef(o.signal):o,method:DO(r)?n.signalRef(r.signal):r,pulse:e};if(t.order&&(a.sort=n.compareRef({field:t.order})),i){const t=i.tolerance;a.boundTolerance=DO(t)?n.signalRef(t.signal):+t,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return wO(n.add(iz(a)))}(o,d,e));const x=e.add(cz({pulse:d})),_=e.add(dz({pulse:wO(x)},void 0,e.parent()));null!=t.name&&(c=t.name,e.addData(c,new ZR(e,l,x,_)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&Rt("Marks only support modify triggers."),XR(t,e,c)})))}function JR(t,e,n){const r={enter:{},update:{}};return ZN(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function KR(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):uR(t,n[0].encode)}ZR.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let o=e[0],a=null,s=1;for(o&&"load"===o.type&&(o=e[1]),t.add(e[0]);s<n;++s)e[s].params.pulse=wO(e[s-1]),t.add(e[s]),"aggregate"===e[s].type&&(a=e[s]);return new ZR(t,o,i,r,a)},ZR.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),o=YR(e);let a,s,l;return null!=o&&(t=r.scope,a=i[o]),a?n&&n.field&&VR(t,a.agg.params,n):(l={groupby:t.fieldRef(e,"key"),pulse:wO(r.output)},n&&n.field&&VR(t,l,n),s=t.add(IO(l)),a=t.add(HO({pulse:wO(s)})),a={agg:s,ref:wO(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef(){return wO(this.values)},extentRef(t,e){return GR(t,this,"extent","extent",e,!1)},domainRef(t,e){return GR(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return GR(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return GR(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return GR(t,this,"indata","tupleindex",e,!0,!0)}};const tP='item.orient==="'.concat(Oz,'"?-90:item.orient==="').concat(zz,'"?90:0');function eP(t,e){const n={enter:{},update:{}};return ZN(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:fR},angle:{signal:tP},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),YN(n,e,Kz)}function nP(t){const e=HO({},t);return e.metadata={source:!0},e}function rP(t,e){return tz({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const iP=t=>t===Rz||t===Nz,oP=(t,e,n)=>DO(t)?dP(t.signal,e,n):t===Oz||t===Nz?e:n,aP=(t,e,n)=>DO(t)?cP(t.signal,e,n):iP(t)?e:n,sP=(t,e,n)=>DO(t)?fP(t.signal,e,n):iP(t)?n:e,lP=(t,e,n)=>DO(t)?hP(t.signal,e,n):t===Nz?{value:e}:{value:n},uP=(t,e,n)=>DO(t)?pP(t.signal,e,n):t===zz?{value:e}:{value:n},cP=(t,e,n)=>mP("".concat(t," === '").concat(Nz,"' || ").concat(t," === '").concat(Rz,"'"),e,n),fP=(t,e,n)=>mP("".concat(t," !== '").concat(Nz,"' && ").concat(t," !== '").concat(Rz,"'"),e,n),dP=(t,e,n)=>yP("".concat(t," === '").concat(Oz,"' || ").concat(t," === '").concat(Nz,"'"),e,n),hP=(t,e,n)=>yP("".concat(t," === '").concat(Nz,"'"),e,n),pP=(t,e,n)=>yP("".concat(t," === '").concat(zz,"'"),e,n),mP=(t,e,n)=>(e=null!=e?$N(e):e,n=null!=n?$N(n):n,gP(e)&&gP(n)?{signal:"".concat(t," ? (").concat(e=e?e.signal||Be(e.value):null,") : (").concat(n=n?n.signal||Be(n.value):null,")")}:[we({test:t},e)].concat(n||[])),gP=t=>null==t||1===Object.keys(t).length,yP=(t,e,n)=>({signal:"".concat(t," ? (").concat(bP(e),") : (").concat(bP(n),")")}),vP=(t,e,n,r,i)=>({signal:(null!=r?"".concat(t," === '").concat(Oz,"' ? (").concat(bP(r),") : "):"")+(null!=n?"".concat(t," === '").concat(Rz,"' ? (").concat(bP(n),") : "):"")+(null!=i?"".concat(t," === '").concat(zz,"' ? (").concat(bP(i),") : "):"")+(null!=e?"".concat(t," === '").concat(Nz,"' ? (").concat(bP(e),") : "):"")+"(null)"}),bP=t=>DO(t)?t.signal:null==t?null:Be(t),xP=(t,e)=>0===e?0:DO(t)?{signal:"(".concat(t.signal,") * ").concat(e)}:{value:t*e},_P=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function wP(t,e,n,r){let i;if(e&&Ee(e,t))return e[t];if(Ee(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[Yz][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[Zz][i]}return null}function kP(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function AP(t,e){return{scale:t.scale,range:e}}function EP(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function MP(t,e){const n={enter:{},update:{}};return ZN(n,{orient:t("orient"),offset:t("offset")||0,position:TO(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function CP(t,e,n){const r=de(t.signals),i=de(t.scales);return n||r.forEach((t=>function(t,e){const n=t.name;if("outer"===t.push)e.signals[n]||vO("No prior signal definition",n),yO.forEach((e=>{void 0!==t[e]&&vO("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}(t,e))),de(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=Tz(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=Tz(n[i],i,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";Ch(n)||Rt("Unrecognized scale type: "+Be(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),de(t.data).forEach((t=>function(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(zR(t,e))})),t.on&&t.on.forEach((n=>{XR(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,o,a,s,l,u=null,c=!1,f=!1;for(t.values?DO(t.values)||FO(t.format)?(r.push(rP(e,t)),r.push(u=nP())):r.push(u=nP({$ingest:t.values,$format:t.format})):t.url?FO(t.url)||FO(t.format)?(r.push(rP(e,t)),r.push(u=nP())):r.push(u=nP({$request:t.url,$format:t.format})):t.source&&(u=i=de(t.source).map((t=>wO(e.getData(t).output))),r.push(null)),o=0,a=n.length;o<a;++o)s=n[o],l=s.metadata,u||l.source||r.push(u=nP()),r.push(s),l.generates&&(f=!0),l.modifies&&!f&&(c=!0),l.source?u=s:l.changes&&(u=null);return i&&(a=i.length-1,r[0]=uz({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,nP())),u||r.push(nP()),r.push(dz({})),r}(t,e,n))}(t,e))),i.forEach((t=>vz(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?Rt("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=ET(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>function(t,e,n){const r=t.encode,i={target:n};let o=t.events,a=t.update,s=[];o||Rt("Signal update missing events specification."),Oe(o)&&(o=function(t,e,n){return jN=e||SN,UN=LN,IN(t.trim()).map(WN)}(o,e.isSubscope()?CO:SO)),o=de(o).filter((t=>t.signal||t.scale?(s.push(t),0):1)),s.length>1&&(s=[UO(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&Rt("Signal encode and update are mutually exclusive."),a="encode(item(),"+Be(r)+")"),i.update=Oe(a)?ET(a,e):null!=a.expr?ET(a.expr,e):null!=a.value?a.value:null!=a.signal?{$expr:jO,$params:{$value:e.signalRef(a.signal)}}:Rt("Invalid signal update specification."),t.force&&(i.options={force:!0}),s.forEach((t=>e.addUpdate(we(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):zO(t,e)}}(t,e),i))))}(t,e,n.id)))}(t,e))),de(t.axes).forEach((t=>function(t,e){const n=function(t,e){var n,r,i,o=e.config,a=o.style,s=o.axis,l="band"===e.scaleType(t.scale)&&o.axisBand,u=t.orient;if(DO(u)){const t=kP([o.axisX,o.axisY]),e=kP([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},t))n[i]=aP(u,wP(i,o.axisX,s,a),wP(i,o.axisY,s,a));for(i of(r={},e))r[i]=vP(u.signal,wP(i,o.axisTop,s,a),wP(i,o.axisBottom,s,a),wP(i,o.axisLeft,s,a),wP(i,o.axisRight,s,a))}else n=u===Nz||u===Rz?o.axisX:o.axisY,r=o["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||l?we({},s,n,r,l):s}(t,e),r=t.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,l=lR(t,n),u=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(e.signal,") === 'extent'")},Jt(i)||(i={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(l),c={scale:t.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=t.title},f=wO(e.add(HO({},[c]))),d=wO(e.add(WO({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),h=[];let p;return c.grid&&h.push(function(t,e,n,r,i){const o=lR(t,e),a=t.orient,s=t.gridScale,l=oP(a,1,-1),u=function(t,e){if(1===e);else if(Jt(t)){let n=t=we({},t);for(;null!=n.mult;){if(!Jt(n.mult))return n.mult=DO(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n=n.mult=we({},n.mult)}n.mult=e}else t=DO(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);return t}(t.offset,l);let c,f,d;const h={enter:c={opacity:tR},update:d={opacity:eR},exit:f={opacity:tR}};ZN(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:Hz,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=aP(a,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:l,offset:u}:{value:0,offset:u},y=s?{scale:s,range:1,mult:l,offset:u}:we(m,{mult:l,offset:u});return c.x=d.x=aP(a,p,g),c.y=d.y=sP(a,p,g),c.x2=d.x2=sP(a,y),c.y2=d.y2=aP(a,y),f.x=aP(a,p),f.y=sP(a,p),hR({type:iR,role:tO,key:Hz,from:r,encode:h},n)}(t,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(function(t,e,n,r,i,o){const a=lR(t,e),s=t.orient,l=oP(s,-1,1);let u,c,f;const d={enter:u={opacity:tR},update:f={opacity:eR},exit:c={opacity:tR}};ZN(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=$N(i);h.mult=l;const p={scale:t.scale,field:Hz,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=u.y=aP(s,tR,p),f.y2=u.y2=aP(s,h),c.x=aP(s,p),f.x=u.x=sP(s,tR,p),f.x2=u.x2=sP(s,h),c.y=sP(s,p),hR({type:iR,role:nO,key:Hz,from:r,encode:d},n)}(t,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(function(t,e,n,r,i,o){const a=lR(t,e),s=t.orient,l=t.scale,u=oP(s,-1,1),c=NO(a("labelFlush")),f=NO(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p,m=0===c||!!c;const g=$N(i);g.mult=u,g.offset=$N(a("labelPadding")||0),g.offset.mult=u;const y={scale:l,field:Hz,band:.5,offset:dR(o.offset,a("labelOffset"))},v=aP(s,m?EP(l,c,'"left"','"right"','"center"'):{value:"center"},uP(s,"left","right")),b=aP(s,lP(s,"bottom","top"),m?EP(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=EP(l,c,"-(".concat(f,")"),f,0);m=m&&f;const _={opacity:tR,x:aP(s,y,g),y:sP(s,y,g)},w={enter:_,update:p={opacity:eR,text:{field:qz},x:_.x,y:_.y,align:v,baseline:b},exit:{opacity:tR,x:_.x,y:_.y}};ZN(w,{dx:!d&&m?aP(s,x):null,dy:!h&&m?sP(s,x):null}),ZN(w,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const k=a("labelBound");let A=a("labelOverlap");return A=A||k?{separation:a("labelSeparation"),method:A,order:"datum.index",bound:k?{scale:l,orient:s,tolerance:k}:null}:void 0,p.align!==v&&(p.align=_P(p.align,v)),p.baseline!==b&&(p.baseline=_P(p.baseline,b)),hR({type:aR,role:eO,style:Zz,key:Hz,from:r,encode:w,overlap:A},n)}(t,n,r.labels,d,p,u))),c.domain&&h.push(function(t,e,n,r){const i=lR(t,e),o=t.orient;let a,s;const l={enter:a={opacity:tR},update:s={opacity:eR},exit:{opacity:tR}};ZN(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=AP(t,0),c=AP(t,1);return a.x=s.x=aP(o,u,tR),a.x2=s.x2=aP(o,c),a.y=s.y=sP(o,u,tR),a.y2=s.y2=sP(o,c),hR({type:iR,role:KN,from:r,encode:l},n)}(t,n,r.domain,f)),c.title&&h.push(function(t,e,n,r){const i=lR(t,e),o=t.orient,a=oP(o,-1,1);let s,l;const u={enter:s={opacity:tR,anchor:$N(i("titleAnchor",null)),align:{signal:fR}},update:l=we({},s,{opacity:eR,text:$N(t.title)}),exit:{opacity:tR}},c={signal:'lerp(range("'.concat(t.scale,'"), ').concat(cR(0,1,.5),")")};return l.x=aP(o,c),l.y=sP(o,c),s.angle=aP(o,tR,xP(a,90)),s.baseline=aP(o,lP(o,Rz,Nz),{value:Rz}),l.angle=s.angle,l.baseline=s.baseline,ZN(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=_P($N(t),n.update[e]),!1):!VN(e,r),o=i(t("titleX"),"x"),a=i(t("titleY"),"y");n.enter.auto=a===o?$N(a):aP(e,$N(a),$N(o))}(i,o,u,n),u.update.align=_P(u.update.align,s.align),u.update.angle=_P(u.update.angle,s.angle),u.update.baseline=_P(u.update.baseline,s.baseline),hR({type:aR,role:rO,style:Yz,from:r,encode:u},n)}(t,n,r.title,f)),QR(sR({role:JN,from:f,encode:YN(MP(l,t),i,Kz),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:a,style:s}),e)}(t,e))),de(t.marks).forEach((t=>QR(t,e))),de(t.legends).forEach((t=>function(t,e){const n=e.config.legend,r=t.encode||{},i=lR(t,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,l=o.style,u={};let c,f,d,h=0;Jz.forEach((e=>t[e]?(u[e]=t[e],h=h||t[e]):0)),h||Rt("Missing valid scale for legend.");const p=function(t,e){let n=t.type||Vz;return t.type||1!==function(t){return Jz.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=Dh(e)?Gz:Th(e)?Xz:Vz),n!==Gz?n:Th(e)?Xz:Gz}(t,e.scaleType(h)),m={title:null!=t.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=wO(e.add(HO(null,[m]))),y=wO(e.add(KO(f={type:p,scale:e.scaleRef(h),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===Gz?(d=[pR(t,h,n,r.gradient),vR(t,n,r.labels,y)],f.count=f.count||e.signalRef("max(2,2*floor((".concat(NO(i.gradientLength()),")/100))"))):p===Xz?d=[mR(t,h,n,r.gradient,y),vR(t,n,r.labels,y)]:(c=function(t,e){const n=lR(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),d=[bR(t,n,r,y,NO(c.columns))],f.size=function(t,e,n){const r=NO(KR("size",t,n)),i=NO(KR("strokeWidth",t,n)),o=NO(function(t,e,n){return uR("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r.fontSize}(0,e,n)}(n[1].encode,e,Zz));return ET("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(o,")"),e)}(t,e,d[0].marks)),d=[sR({role:"legend-entry",from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],m.title&&d.push(function(t,e,n,r){const i=lR(t,e),o={enter:{opacity:tR},update:{opacity:eR,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:tR}};return ZN(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:MR},angle:{signal:CR},align:{signal:ER},baseline:{signal:SR},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),hR({type:aR,role:"legend-title",style:Yz,from:r,encode:o},n)}(t,n,r.title,g)),QR(sR({role:"legend",from:g,encode:YN(JR(i,t,n),o,Kz),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:l}),e)}(t,e))),t.title&&function(t,e){const n=lR(t=Oe(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,l=[],u=wO(e.add(HO(null,[{}])));l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ZN(o,{text:t.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),hR({type:aR,role:"title-text",style:"group-title",from:r,encode:o},n)}(t,n,function(t){const e=t.encode;return e&&e.title||we({name:t.name,interactive:t.interactive,style:t.style},e)}(t),u)),t.subtitle&&l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ZN(o,{text:t.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),hR({type:aR,role:"title-subtitle",style:"group-subtitle",from:r,encode:o},n)}(t,n,r.subtitle,u)),QR(sR({role:"title",from:u,encode:eP(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),e)}(t.title,e),e.parseLambdas(),e}function SP(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function DP(t){return(Qt(t)?FP:TP)(t)}function FP(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(Jt(e)?e.signal||DP(e):Be(e))}return n+"]"}function TP(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+Be(e)+":"+(Jt(n)?n.signal||DP(n):Be(n));return r+"}"}SP.prototype={parse(t){return CP(t,this)},fork(){return new SP(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof bO?wO(t):t;return this.add(lz({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(wO(this.add(dz({pulse:t})))),this._parent.push(e),this._lookup.push(n?wO(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Kt(this._parent)},encode(){return Kt(this._encode)},lookup(){return Kt(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(Oe(t))return kO(t,e);t.signal||Rt("Unsupported field reference: "+Be(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=wO(this.add(QO(t)))}return r},compareRef(t){let e=!1;const n=t=>DO(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=de(t.field).map(n),i=de(t.order).map(n);return e?wO(this.add(ZO({fields:r,orders:i}))):EO(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=de(t).map((t=>DO(t)?(n=!0,wO(r[t.signal])):t)),n?wO(this.add(JO({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=MO(t.op,t.field),n=t.order||"ascending";return n.signal?wO(this.add(ZO({fields:e,orders:this.signalRef(n.signal)}))):EO(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return Ee(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&Rt("Duplicate signal name: "+Be(t));const n=e instanceof bO?e:this.add(_O(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||Rt("Unrecognized signal name: "+Be(t)),this.signals[t]},signalRef(t){return this.signals[t]?wO(this.signals[t]):(Ee(this.lambdas,t)||(this.lambdas[t]=this.add(_O(null))),wO(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=ET(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&Jt(t)?this.signalRef(t.signal||DP(t)):t},exprRef(t,e){const n={expr:ET(t,this)};return e&&(n.expr.$name=e),wO(this.add(GO(n)))},addBinding(t,e){this.bindings||Rt("Nested signals do not support binding: "+Be(t)),this.bindings.push(we({signal:t},e))},addScaleProj(t,e){Ee(this.scales,t)&&Rt("Duplicate scale or projection name: "+Be(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,fz(e))},addProjection(t,e){this.addScaleProj(t,sz(e))},getScale(t){return this.scales[t]||Rt("Unrecognized scale name: "+Be(t)),this.scales[t]},scaleRef(t){return wO(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return Ee(this.data,t)&&Rt("Duplicate data set name: "+Be(t)),this.data[t]=e},getData(t){return this.data[t]||Rt("Undefined data set name: "+Be(t)),this.data[t]},addDataPipeline(t,e){return Ee(this.data,t)&&Rt("Duplicate data set name: "+Be(t)),this.addData(t,ZR.fromEntries(this,e))}},we(rs,t,k,A,E,M,S,C,D,F,T,N);var NP=n(138),OP=n.n(NP),zP=n(378),RP=n.n(zP),PP=n(695),BP=n.n(PP);function LP(t,e){return function(t){return!!t.not}(t)?{not:LP(t.not,e)}:function(t){return!!t.and}(t)?{and:t.and.map((t=>LP(t,e)))}:function(t){return!!t.or}(t)?{or:t.or.map((t=>LP(t,e)))}:e(t)}RP();const jP=OP();function UP(t,e){const n={};for(const r of e)Ee(t,r)&&(n[r]=t[r]);return n}function qP(t,e){const n={...t};for(const r of e)delete n[r];return n}Set.prototype.toJSON=function(){return"Set(".concat([...this].map((t=>BP()(t))).join(","),")")};const IP=BP();function WP(t){if(Ne(t))return t;const e=Oe(t)?t:BP()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n&=n;return n}function $P(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function HP(t,e){const n=[],r={};let i;for(const o of t)i=e(o),i in r||(r[i]=1,n.push(o));return n}function ZP(t){return 0===YP(t).length}const YP=Object.keys,VP=Object.values,GP=Object.entries;function XP(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function QP(t){return t.charAt(0).toUpperCase()+t.substr(1)}function JP(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function KP(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function tB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)if(void 0!==r)return r}const eB="row",nB="column",rB="facet",iB="x",oB="y",aB="x2",sB="y2",lB="xOffset",uB="yOffset",cB="radius",fB="radius2",dB="theta",hB="theta2",pB="latitude",mB="longitude",gB="latitude2",yB="longitude2",vB="color",bB="fill",xB="stroke",_B="shape",wB="size",kB="angle",AB="opacity",EB="fillOpacity",MB="strokeOpacity",CB="strokeWidth",SB="strokeDash",DB="text",FB="order",TB="detail",NB="key",OB="tooltip",zB="href",RB="url",PB="description",BB={longitude:1,longitude2:1,latitude:1,latitude2:1};YP(BB);const LB={x:1,y:1,x2:1,y2:1,theta:1,theta2:1,radius:1,radius2:1,...BB,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1},jB={row:1,column:1,facet:1},UB=(YP(jB),{...LB,...jB}),qB=YP(UB),{order:IB,detail:WB,tooltip:$B,...HB}=UB,{row:ZB,column:YB,facet:VB,...GB}=HB;YP(HB),YP(GB);const XB=[aB,sB,gB,yB,hB,fB];function QB(t){return JB(t)!==t}function JB(t){switch(t){case aB:return iB;case sB:return oB;case gB:return pB;case yB:return mB;case hB:return dB;case fB:return cB}return t}YP(LB);const{x:KB,y:tL,x2:eL,y2:nL,xOffset:rL,yOffset:iL,latitude:oL,longitude:aL,latitude2:sL,longitude2:lL,theta:uL,theta2:cL,radius:fL,radius2:dL,...hL}=LB,pL=YP(hL),mL={x:1,y:1};function gL(t){return t in mL}YP(mL);const yL={theta:1,radius:1};YP(yL);const vL={xOffset:1,yOffset:1};YP(vL);const{text:bL,tooltip:xL,href:_L,url:wL,description:kL,detail:AL,key:EL,order:ML,...CL}=hL;YP(CL);const SL={...mL,...yL,...vL,...CL};YP(SL);const{geoshape:DL,...FL}={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},TL={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};function NL(t){return!!t&&!!t.argmin}function OL(t){return!!t&&!!t.argmax}const zL=new Set(["count","valid","missing","distinct"]),RL=new Set(["count","sum","distinct","valid","missing"]);function PL(t){return!0===t||LL(t)&&!t.binned}function BL(t){return"binned"===t||LL(t)&&!0===t.binned}function LL(t){return Jt(t)}function jL(t){switch(t){case eB:case nB:case wB:case vB:case bB:case xB:case CB:case AB:case EB:case MB:case _B:return 6;case SB:return 4;default:return 10}}function UL(t){return!(null===t||void 0===t||!t.signal)}function qL(t,e,n){return function(t,e,n){let r;e=de(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}(t,function(t,e){return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}(e),n)}function IL(t){return"Selection not supported for ".concat(t," yet.")}function WL(t){return'The "columns" property cannot be used when "'.concat(t,'" has nested row/column.')}function $L(t){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(t," are dropped.")}function HL(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned).")}function ZL(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).")}function YL(t){return"1D error band does not support ".concat(t,".")}new Set(["mean","average","median","q1","q3","min","max"]),YP({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1});let VL=Xt(Yt);function GL(){VL.warn(...arguments)}new WeakMap;const XL=(["january","february","march","april","may","june","july","august","september","october","november","december"].map((t=>t.substr(0,3))),["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]);XL.map((t=>t.substr(0,3)));const QL=YP({year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1});function JL(t){if(!t)return;let e;return Oe(t)?e={unit:t}:Jt(t)&&(e={...t,...t.unit?{unit:t.unit}:{}}),e.unit.startsWith("utc")&&(e.utc=!0,e.unit=e.unit.substr(3)),e}const KL={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},tj=KL.quantitative,ej=KL.ordinal,nj=KL.temporal,rj=KL.nominal,ij=KL.geojson;YP(KL);const oj={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};YP(oj);const aj=new Set(["linear","log","pow","sqrt","symlog"]),sj=new Set([...aj,"time","utc"]),lj=new Set(["quantile","quantize","threshold"]);new Set([...sj,...lj,"sequential","identity"]),new Set(["ordinal","bin-ordinal","point","band"]),new Set(["time","utc"]);const uj={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:cj,domain:fj,range:dj,rangeMax:hj,rangeMin:pj,scheme:mj,...gj}=(YP(uj),uj);YP(gj);const yj={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},vj=yj.arc,bj=yj.area,xj=yj.bar,_j=yj.line,wj=yj.point,kj=yj.rule,Aj=yj.text,Ej=yj.tick,Mj=yj.circle,Cj=yj.square;function Sj(t){return["line","area","trail"].includes(t)}const Dj=new Set(YP(yj));function Fj(t){return t.type}function Tj(t){return t&&"number"!==t&&"time"!==t}YP({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),YP({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});const Nj={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Oj(t){return t in Nj}function zj(t){return"row"in t||"column"in t}function Rj(t){return!!t&&"header"in t}function Pj(t){return"sort"in t}function Bj(t){return t&&"condition"in t}function Lj(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!Qt(e)&&Uj(e)}function jj(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!Qt(e)&&Wj(e)}function Uj(t){return t&&(!!t.field||"count"===t.aggregate)}function qj(t){return t&&"datum"in t}function Ij(t){return $j(t)&&!Jj(t)||function(t){return qj(t)&&Ne(t.datum)}(t)}function Wj(t){return Uj(t)||qj(t)}function $j(t){return t&&("field"in t||"count"===t.aggregate)&&"type"in t}function Hj(t){return t&&"value"in t&&"value"in t}function Zj(t){return t&&("scale"in t||"sort"in t)}function Yj(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function Vj(t){return t&&"legend"in t}function Gj(t){return t&&("format"in t||"formatType"in t)}function Xj(t){return qP(t,["legend","axis","header","scale"])}function Qj(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.field;const r=e.prefix;let i=e.suffix,o="";if(function(t){return"count"===t.aggregate}(t))n=function(t){return t.startsWith("__")}(u="count")?u:"__".concat(u);else{let r;if(!e.nofn)if(function(t){return"op"in t}(t))r=t.op;else{var a,s,l;const{bin:u,aggregate:c,timeUnit:f}=t;PL(u)?(r=function(t){return Fe(t)&&(t=oU(t,void 0)),"bin"+YP(t).map((e=>function(t){return null===t||void 0===t?void 0:t.param}(t[e])?XP("_".concat(e,"_").concat(GP(t[e]))):XP("_".concat(e,"_").concat(t[e])))).join("")}(u),i=(null!==(a=e.binSuffix)&&void 0!==a?a:"")+(null!==(s=e.suffix)&&void 0!==s?s:"")):c?OL(c)?(o='["'.concat(n,'"]'),n="argmax_".concat(c.argmax)):NL(c)?(o='["'.concat(n,'"]'),n="argmin_".concat(c.argmin)):r=String(c):f&&(r=function(t){const{utc:e,...n}=JL(t);return n.unit?(e?"utc":"")+YP(n).map((t=>XP("".concat("unit"===t?"":"_".concat(t,"_")).concat(n[t])))).join(""):(e?"utc":"")+"timeunit"+YP(n).map((t=>XP("_".concat(t,"_").concat(n[t])))).join("")}(f),i=(!["range","mid"].includes(e.binSuffix)&&e.binSuffix||"")+(null!==(l=e.suffix)&&void 0!==l?l:""))}r&&(n=n?"".concat(r,"_").concat(n):r)}var u;return i&&(n="".concat(n,"_").concat(i)),r&&(n="".concat(r,"_").concat(n)),e.forAs?function(t){return"".concat(Pt(t).join("."))}(n):e.expr?function(t){return"".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum","[").concat(Be(Pt(t).join(".")),"]")}(n,e.expr)+o:function(t){return"".concat(Pt(t).map(JP).join("\\."))}(n)+o}function Jj(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Uj(t)&&!!t.bin;case"temporal":return!1}throw new Error('Invalid field type "'.concat(t.type,'".'))}let Kj=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(OL(e))return"".concat(i," for argmax(").concat(e.argmax,")");if(NL(e))return"".concat(i," for argmin(").concat(e.argmin,")");const o=JL(r),a=e||(null===o||void 0===o?void 0:o.unit)||(null===o||void 0===o?void 0:o.maxbins)&&"timeunit"||PL(n)&&"bin";return a?"".concat(a.toUpperCase(),"(").concat(i,")"):i}(t);default:return function(t,e){const{field:n,bin:r,timeUnit:i,aggregate:o}=t;if("count"===o)return e.countTitle;if(PL(r))return"".concat(n," (binned)");if(i){var a;const t=null===(a=JL(i))||void 0===a?void 0:a.unit;if(t)return"".concat(n," (").concat(function(t){return QL.filter((e=>function(t,e){const n=t.indexOf(e);return!(n<0||n>0&&"seconds"===e&&"i"===t.charAt(n-1)||t.length>n+3&&"day"===e&&"o"===t.charAt(n+3)||n>0&&"year"===e&&"f"===t.charAt(n-1))}(t,e)))}(t).join("-"),")")}else if(o)return OL(o)?"".concat(n," for max ").concat(o.argmax):NL(o)?"".concat(n," for min ").concat(o.argmin):"".concat(QP(o)," of ").concat(n);return n}(t,e)}};function tU(t,e,n){var r,i;let{allowDisabling:o,includeDefault:a=!0}=n;const s=null===(r=eU(t))||void 0===r?void 0:r.title;if(!Uj(t))return null!==s&&void 0!==s?s:t.title;const l=t,u=a?function(t,e){return Kj(t,e)}(l,e):void 0;return o?tB(s,l.title,u):null!==(i=null!==s&&void 0!==s?s:l.title)&&void 0!==i?i:u}function eU(t){return Yj(t)&&t.axis?t.axis:Vj(t)&&t.legend?t.legend:Rj(t)&&t.header?t.header:void 0}function nU(t){return Uj(t)?t:Lj(t)?t.condition:void 0}function rU(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Oe(t)||Ne(t)||Fe(t)?(GL(function(t,e,n){return"Channel ".concat(t," is a ").concat(e,". Converted to {value: ").concat(IP(n),"}.")}(e,Oe(t)?"string":Ne(t)?"number":"boolean",t)),{value:t}):Wj(t)?iU(t,e,n,r):jj(t)?{...t,condition:iU(t.condition,e,n,r)}:t}function iU(t,e,n,r){if(Gj(t)){const{format:i,formatType:o,...a}=t;if(Tj(o)&&!n.customFormatTypes)return GL($L(e)),iU(a,e,n,r)}else{const i=Yj(t)?"axis":Vj(t)?"legend":Rj(t)?"header":null;if(i&&t[i]){const{format:o,formatType:a,...s}=t[i];if(Tj(a)&&!n.customFormatTypes)return GL($L(e)),iU({...t,[i]:s},e,n,r)}}return Uj(t)?function(t,e){let{compositeMark:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{aggregate:r,timeUnit:i,bin:o,field:a}=t,s={...t};var l;if(n||!r||Oe(l=r)&&TL[l]||OL(r)||NL(r)||(GL(function(t){return'Invalid aggregation operator "'.concat(t,'".')}(r)),delete s.aggregate),i&&(s.timeUnit=JL(i)),a&&(s.field="".concat(a)),PL(o)&&(s.bin=oU(o,e)),BL(o)&&!gL(e)&&GL(function(t){return"Channel ".concat(t,' should not be used with "binned" bin.')}(e)),$j(s)){const{type:t}=s,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case tj:return"quantitative";case"t":case nj:return"temporal";case"o":case ej:return"ordinal";case"n":case rj:return"nominal";case ij:return"geojson"}}(t);t!==e&&(s.type=e),"quantitative"!==t&&function(t){return Oe(t)&&zL.has(t)}(r)&&(GL(function(t,e){return'Invalid field type "'.concat(t,'" for aggregate: "').concat(e,'", using "quantitative" instead.')}(t,r)),s.type="quantitative")}else if(!QB(e)){const t=function(t,e,n){switch(e){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(Pj(t)&&Qt(t.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=t;if(o)return"temporal";if(i||r&&!OL(r)&&!NL(r))return"quantitative";if(Zj(t)&&null!==(n=t.scale)&&void 0!==n&&n.type)switch(oj[t.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(s,e);s.type=t}if($j(s)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:"Channel ".concat(e," should not be used with a geojson data.")};switch(e){case eB:case nB:case rB:return Jj(t)?aU:{compatible:!1,warning:HL(e)};case iB:case oB:case lB:case uB:case vB:case bB:case xB:case DB:case TB:case NB:case OB:case zB:case RB:case kB:case dB:case cB:case PB:return aU;case mB:case yB:case pB:case gB:return n!==tj?{compatible:!1,warning:"Channel ".concat(e," should be used with a quantitative field only, not ").concat(t.type," field.")}:aU;case AB:case EB:case MB:case CB:case wB:case hB:case fB:case aB:case sB:return"nominal"!==n||t.sort?aU:{compatible:!1,warning:"Channel ".concat(e," should not be used with an unsorted discrete field.")};case _B:case SB:return Jj(t)||function(t,e){return Zj(t)&&function(t){return lj.has(t)}(null===(e=t.scale)||void 0===e?void 0:e.type)}(t)?aU:{compatible:!1,warning:ZL(e)};case FB:return"nominal"!==t.type||"sort"in t?aU:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(s,e)||{};!1===t&&GL(n)}if(Pj(s)&&Oe(s.sort)){const{sort:t}=s;if(Oj(t))return{...s,sort:{encoding:t}};const e=t.substr(1);if("-"===t.charAt(0)&&Oj(e))return{...s,sort:{encoding:e,order:"descending"}}}if(Rj(s)){const{header:t}=s;if(t){const{orient:e,...n}=t;if(e)return{...s,header:{...n,labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e}}}}return s}(t,e,r):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=Ne(n)?"quantitative":Oe(n)?"nominal":function(t){if(t&&Jt(t))for(const e of QL)if(e in t)return!0;return!1}(n)?"temporal":void 0,{...t,type:e}}(t)}function oU(t,e){return Fe(t)?{maxbins:jL(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:{...t,maxbins:jL(e)}}const aU={compatible:!0};function sU(t){const{formatType:e}=function(t){if(Gj(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{var e;const n=null!==(e=eU(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}(t);return"time"===e||!e&&function(t){return t&&("temporal"===t.type||Uj(t)&&!!t.timeUnit)}(t)}const lU={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},uU={...lU,style:1,labelExpr:1,encoding:1};function cU(t){return"mark"in t}YP(uU),YP({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});class fU{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!cU(t)&&function(t){return Fj(t)?t.type:t}(t.mark)===this.name}}function dU(t,e){const n=t&&t[e];return!!n&&(Qt(n)?$P(n,(t=>!!t.field)):Uj(n)||Lj(n))}function hU(t,e){const n=[],r=[],i=[],o=[],a={};return function(t,e,n){if(t)for(const r of YP(t)){const i=t[r];if(Qt(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}(t,((s,l)=>{if(Uj(s)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=s;if(c||d||f){const t=eU(s),p=null===t||void 0===t?void 0:t.title;let m=Qj(s,{forAs:!0});const g={...p?[]:{title:tU(s,e,{allowDisabling:!0})},...h,field:m};if(c){let t;if(OL(c)?(t="argmax",m=Qj({op:"argmax",field:c.argmax},{forAs:!0}),g.field="".concat(m,".").concat(u)):NL(c)?(t="argmin",m=Qj({op:"argmin",field:c.argmin},{forAs:!0}),g.field="".concat(m,".").concat(u)):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(t=c),t){const e={op:t,as:m};u&&(e.field=u),o.push(e)}}else if(n.push(m),$j(s)&&PL(f)){if(r.push({bin:f,field:u,as:m}),n.push(Qj(s,{binSuffix:"end"})),function(t,e){return PL(t.bin)?function(t){return!!SL[t]}(e)&&["ordinal","nominal"].includes(t.type):(console.warn("Only call this method for binned field defs."),!1)}(s,l)&&n.push(Qj(s,{binSuffix:"range"})),gL(l)){const t={field:"".concat(m,"_end")};a["".concat(l,"2")]=t}g.bin="binned",QB(l)||(g.type=tj)}else if(d){i.push({timeUnit:d,field:u,as:m});const t=$j(s)&&s.type!==nj&&"time";t&&(l===DB||l===OB?g.formatType=t:function(t){return!!hL[t]}(l)?g.legend={formatType:t,...g.legend}:gL(l)&&(g.axis={formatType:t,...g.axis}))}a[l]=g}else n.push(u),a[l]=t[l]}else a[l]=t[l]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function pU(t,e){const n={};for(const r of YP(t)){const i=rU(t[r],r,e,{compositeMark:!0});n[r]=i}return n}function mU(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};const i=t.map((t=>{let{fieldPrefix:n,titlePrefix:i}=t;const o=r?" of ".concat(gU(e)):"";return{field:n+e.field,type:e.type,title:UL(i)?{signal:"".concat(i,'"').concat(escape(o),'"')}:i+o}})),o=function(t){const e=[];for(const n of YP(t))if(dU(t,n)){const r=de(t[n]);for(const t of r)Uj(t)?e.push(t):Lj(t)&&e.push(t.condition)}return e}(n).map(Xj);return{tooltip:[...i,...HP(o,WP)]}}function gU(t){const{title:e,field:n}=t;return tB(e,n)}function yU(t,e,n,r,i){const{scale:o,axis:a}=n;return s=>{let{partName:l,mark:u,positionPrefix:c,endPositionPrefix:f,extraEncoding:d={}}=s;const h=gU(n);return vU(t,l,i,{mark:u,encoding:{[e]:{field:"".concat(c,"_").concat(n.field),type:n.type,...void 0!==h?{title:h}:{},...void 0!==o?{scale:o}:{},...void 0!==a?{axis:a}:{}},...Oe(f)?{["".concat(e,"2")]:{field:"".concat(f,"_").concat(n.field)}}:{},...r,...d}})}}function vU(t,e,n,r){const{clip:i,color:o,opacity:a}=t,s=t.type;return t[e]||void 0===t[e]&&n[e]?[{...r,mark:{...n[e],...i?{clip:i}:{},...o?{color:o}:{},...a?{opacity:a}:{},...Fj(r.mark)?r.mark:{type:r.mark},style:"".concat(s,"-").concat(String(e)),...Fe(t[e])?{}:t[e]}}]:[]}function bU(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",o=r[i],a=r["".concat(i,"2")],s=r["".concat(i,"Error")],l=r["".concat(i,"Error2")];return{continuousAxisChannelDef:xU(o,n),continuousAxisChannelDef2:xU(a,n),continuousAxisChannelDefError:xU(s,n),continuousAxisChannelDefError2:xU(l,n),continuousAxis:i}}function xU(t,e){if(null!==t&&void 0!==t&&t.aggregate){const{aggregate:n,...r}=t;return n!==e&&GL(function(t,e){return"Continuous axis should not have customized aggregation function ".concat(t,"; ").concat(e," already agregates the axis.")}(n,e)),r}return t}function _U(t,e){const{mark:n,encoding:r}=t,{x:i,y:o}=r;if(Fj(n)&&n.orient)return n.orient;if(Ij(i)){if(Ij(o)){const t=Uj(i)&&i.aggregate,n=Uj(o)&&o.aggregate;if(t||n!==e){if(n||t!==e){if(t===e&&n===e)throw new Error("Both x and y cannot have aggregate");return sU(o)&&!sU(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(Ij(o))return"vertical";throw new Error("Need a valid continuous axis for ".concat(e,"s"))}const wU="boxplot",kU=new fU(wU,EU);function AU(t){return Ne(t)?"tukey":t}function EU(t,e){var n,r;let{config:i}=e;t={...t,encoding:pU(t.encoding,i)};const{mark:o,encoding:a,params:s,projection:l,...u}=t,c=Fj(o)?o:{type:o};s&&GL(IL("boxplot"));const f=null!==(n=c.extent)&&void 0!==n?n:i.boxplot.extent,d=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!o||i&&i!==t?function(t,e,n){let{vgChannel:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return tB(r?qL(t,e,n.style):void 0,qL(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}(t,e,n,r):void 0}("size",c,i),h=c.invalid,p=AU(f),{bins:m,timeUnits:g,transform:y,continuousAxisChannelDef:v,continuousAxis:b,groupby:x,aggregate:_,encodingWithoutContinuousAxis:w,ticksOrient:k,boxOrient:A,customTooltipWithoutAggregatedField:E}=function(t,e,n){const r=_U(t,wU),{continuousAxisChannelDef:i,continuousAxis:o}=bU(t,r,wU),a=i.field,s=AU(e),l=[...MU(a),{op:"median",field:a,as:"mid_box_".concat(a)},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],u="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(a,'"] - datum["lower_box_').concat(a,'"]'),as:"iqr_".concat(a)},{calculate:'min(datum["upper_box_'.concat(a,'"] + datum["iqr_').concat(a,'"] * ').concat(e,', datum["max_').concat(a,'"])'),as:"upper_whisker_".concat(a)},{calculate:'max(datum["lower_box_'.concat(a,'"] - datum["iqr_').concat(a,'"] * ').concat(e,', datum["min_').concat(a,'"])'),as:"lower_whisker_".concat(a)}],{[o]:c,...f}=t.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=function(t){const{tooltip:e,...n}=t;if(!e)return{filteredEncoding:n};let r,i;if(Qt(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return Qt(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:p,timeUnits:m,aggregate:g,groupby:y,encoding:v}=hU(h,n),b="vertical"===r?"horizontal":"vertical",x=r;return{bins:p,timeUnits:m,transform:[...p,...m,{aggregate:[...g,...l],groupby:y},...u],groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:d}}(t,f,i),{color:M,size:C,...S}=w,D=t=>yU(c,b,v,t,i.boxplot),F=D(S),T=D(w),N=D({...S,...C?{size:C}:{}}),O=mU([{fieldPrefix:"min-max"===p?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===p?"lower_whisker_":"min_",titlePrefix:"Min"}],v,w),z={type:"tick",color:"black",opacity:1,orient:k,invalid:h,aria:!1},R="min-max"===p?O:mU([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,w),P=[...F({partName:"rule",mark:{type:"rule",invalid:h,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:R}),...F({partName:"rule",mark:{type:"rule",invalid:h,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:R}),...F({partName:"ticks",mark:z,positionPrefix:"lower_whisker",extraEncoding:R}),...F({partName:"ticks",mark:z,positionPrefix:"upper_whisker",extraEncoding:R})],B=[..."tukey"!==p?P:[],...T({partName:"box",mark:{type:"bar",...d?{size:d}:{},orient:A,invalid:h,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:O}),...N({partName:"median",mark:{type:"tick",invalid:h,...Jt(i.boxplot.median)&&i.boxplot.median.color?{color:i.boxplot.median.color}:{},...d?{size:d}:{},orient:k,aria:!1},positionPrefix:"mid_box",extraEncoding:O})];if("min-max"===p)return{...u,transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(y),layer:B};const L='datum["lower_box_'.concat(v.field,'"]'),j='datum["upper_box_'.concat(v.field,'"]'),U="(".concat(j," - ").concat(L,")"),q="".concat(L," - ").concat(f," * ").concat(U),I="".concat(j," + ").concat(f," * ").concat(U),W='datum["'.concat(v.field,'"]'),$={joinaggregate:MU(v.field),groupby:x},H={transform:[{filter:"(".concat(q," <= ").concat(W,") && (").concat(W," <= ").concat(I,")")},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_".concat(v.field)},{op:"max",field:v.field,as:"upper_whisker_".concat(v.field)},{op:"min",field:"lower_box_".concat(v.field),as:"lower_box_".concat(v.field)},{op:"max",field:"upper_box_".concat(v.field),as:"upper_box_".concat(v.field)},..._],groupby:x}],layer:P},{tooltip:Z,...Y}=S,{scale:V,axis:G}=v,X=gU(v),Q=qP(G,["title"]),J=vU(c,"outliers",i.boxplot,{transform:[{filter:"(".concat(W," < ").concat(q,") || (").concat(W," > ").concat(I,")")}],mark:"point",encoding:{[b]:{field:v.field,type:v.type,...void 0!==X?{title:X}:{},...void 0!==V?{scale:V}:{},...ZP(Q)?{}:{axis:Q}},...Y,...M?{color:M}:{},...E?{tooltip:E}:{}}})[0];let K;const tt=[...m,...g,$];return J?K={transform:tt,layer:[J,H]}:(K=H,K.transform.unshift(...tt)),{...u,layer:[K,{transform:y,layer:B}]}}function MU(t){return[{op:"q1",field:t,as:"lower_box_".concat(t)},{op:"q3",field:t,as:"upper_box_".concat(t)}]}const CU="errorbar",SU=new fU(CU,DU);function DU(t,e){let{config:n}=e;t={...t,encoding:pU(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,ticksOrient:s,markDef:l,outerSpec:u,tooltipEncoding:c}=FU(t,CU,n);delete a.size;const f=yU(l,o,i,a,n.errorbar),d=l.thickness,h=l.size,p={type:"tick",orient:s,aria:!1,...void 0!==d?{thickness:d}:{},...void 0!==h?{size:h}:{}},m=[...f({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:c}),...f({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:c}),...f({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==d?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return{...u,transform:r,...m.length>1?{layer:m}:{...m[0]}}}function FU(t,e,n){var r;const{mark:i,encoding:o,params:a,projection:s,...l}=t,u=Fj(i)?i:{type:i};a&&GL(IL(e));const{orient:c,inputType:f}=function(t,e){const{encoding:n}=t;if(function(t){return(Wj(t.x)||Wj(t.y))&&!Wj(t.x2)&&!Wj(t.y2)&&!Wj(t.xError)&&!Wj(t.xError2)&&!Wj(t.yError)&&!Wj(t.yError2)}(n))return{orient:_U(t,e),inputType:"raw"};const r=function(t){return Wj(t.x2)||Wj(t.y2)}(n),i=function(t){return Wj(t.xError)||Wj(t.xError2)||Wj(t.yError)||Wj(t.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error("".concat(e," cannot be both type aggregated-upper-lower and aggregated-error"));const t=n.x2,r=n.y2;if(Wj(t)&&Wj(r))throw new Error("".concat(e," cannot have both x2 and y2"));if(Wj(t)){if(Ij(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(e))}if(Wj(r)){if(Ij(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(e))}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(Wj(r)&&!Wj(t))throw new Error("".concat(e," cannot have xError2 without xError"));if(Wj(s)&&!Wj(i))throw new Error("".concat(e," cannot have yError2 without yError"));if(Wj(t)&&Wj(i))throw new Error("".concat(e," cannot have both xError and yError with both are quantiative"));if(Wj(t)){if(Ij(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Wj(i)){if(Ij(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(t,e),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:g}=bU(t,c,e),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=function(t,e,n,r,i,o,a,s){let l=[],u=[];const c=e.field;let f,d=!1;if("raw"===o){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!=("iqr"===n)&&GL(function(t,e,n){return"".concat(t," is not usually used with ").concat(e," for ").concat(n,".")}(e,n,a)),"stderr"===n||"stdev"===n)l=[{op:n,field:c,as:"extent_".concat(c)},{op:e,field:c,as:"center_".concat(c)}],u=[{calculate:'datum["center_'.concat(c,'"] + datum["extent_').concat(c,'"]'),as:"upper_".concat(c)},{calculate:'datum["center_'.concat(c,'"] - datum["extent_').concat(c,'"]'),as:"lower_".concat(c)}],f=[{fieldPrefix:"center_",titlePrefix:QP(e)},{fieldPrefix:"upper_",titlePrefix:TU(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:TU(e,n,"-")}],d=!0;else{let t,e,r;"ci"===n?(t="mean",e="ci0",r="ci1"):(t="median",e="q1",r="q3"),l=[{op:e,field:c,as:"lower_".concat(c)},{op:r,field:c,as:"upper_".concat(c)},{op:t,field:c,as:"center_".concat(c)}],f=[{fieldPrefix:"upper_",titlePrefix:tU({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:tU({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:tU({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&GL(function(t,e){return"".concat(e?"extent ":"").concat(e&&t?"and ":"").concat(t?"center ":"").concat(e&&t?"are ":"is ","not needed when data are aggregated.")}(t.center,t.extent)),"aggregated-upper-lower"===o?(f=[],u=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_".concat(c)},{calculate:'datum["'.concat(c,'"]'),as:"lower_".concat(c)}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:'datum["'.concat(c,'"] + datum["').concat(r.field,'"]'),as:"upper_".concat(c)}],i?u.push({calculate:'datum["'.concat(c,'"] + datum["').concat(i.field,'"]'),as:"lower_".concat(c)}):u.push({calculate:'datum["'.concat(c,'"] - datum["').concat(r.field,'"]'),as:"lower_".concat(c)}));for(const t of u)f.push({fieldPrefix:t.as.substring(0,6),titlePrefix:KP(KP(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}(u,d,h,p,m,f,e,n),{[g]:_,["x"===g?"x2":"y2"]:w,["x"===g?"xError":"yError"]:k,["x"===g?"xError2":"yError2"]:A,...E}=o,{bins:M,timeUnits:C,aggregate:S,groupby:D,encoding:F}=hU(E,n),T=[...S,...y],N="raw"!==f?[]:D,O=mU(b,d,F,x);return{transform:[...null!==(r=l.transform)&&void 0!==r?r:[],...M,...C,...0===T.length?[]:[{aggregate:T,groupby:N}],...v],groupby:N,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:F,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:O}}function TU(t,e,n){return"".concat(QP(t)," ").concat(n," ").concat(e)}const NU="errorband",OU=new fU(NU,zU);function zU(t,e){let{config:n}=e;t={...t,encoding:pU(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:l,tooltipEncoding:u}=FU(t,NU,n),c=s,f=yU(c,o,i,a,n.errorband),d=void 0!==t.encoding.x&&void 0!==t.encoding.y;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const m={...c.interpolate?{interpolate:c.interpolate}:{},...c.tension&&c.interpolate?{tension:c.tension}:{}};return d?(h={...h,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):c.interpolate?GL(YL("interpolate")):c.tension&&GL(YL("tension")),{...l,transform:r,layer:[...f({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}const RU={};function PU(t,e,n){const r=new fU(t,e);RU[t]={normalizer:r,parts:n}}PU(wU,EU,["box","median","outliers","rule","ticks"]),PU(CU,DU,["ticks","rule"]),PU(NU,zU,["band","borders"]),YP({titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"}),YP({labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"}),YP({header:1,headerRow:1,headerColumn:1,headerFacet:1});const BU={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1};function LU(t){return!(null===t||void 0===t||!t.select)}YP(BU),YP({align:1,bounds:1,center:1,columns:1,spacing:1}),new Set(["view",...Dj]);class jU{map(t,e){return function(t){return"facet"in t}(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):function(t){return"hconcat"in t}(t)?this.mapHConcat(t,e):function(t){return"vconcat"in t}(t)?this.mapVConcat(t,e):function(t){return"concat"in t}(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(function(t){return"layer"in t}(t))return this.mapLayer(t,e);if(cU(t))return this.mapUnit(t,e);throw new Error(function(t){return"Invalid specification ".concat(IP(t),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}(t))}mapLayer(t,e){return{...t,layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))}}mapHConcat(t,e){return{...t,hconcat:t.hconcat.map((t=>this.map(t,e)))}}mapVConcat(t,e){return{...t,vconcat:t.vconcat.map((t=>this.map(t,e)))}}mapConcat(t,e){const{concat:n,...r}=t;return{...r,concat:n.map((t=>this.map(t,e)))}}mapFacet(t,e){return{...t,spec:this.map(t.spec,e)}}mapRepeat(t,e){return{...t,spec:this.map(t.spec,e)}}}const UU={zero:1,center:1,normalize:1},qU=new Set([vj,xj,bj,kj,wj,Mj,Cj,_j,Aj,Ej]),IU=new Set([xj,bj,vj]);function WU(t){return Uj(t)&&"quantitative"===function(t){return null===t||void 0===t?void 0:t.type}(t)&&!t.bin}function $U(t,e,n){let{orient:r,type:i}=n;const o="x"===e?"y":"radius",a="x"===e,s=t[e],l=t[o];if(Uj(s)&&Uj(l))if(WU(s)&&WU(l)){if(s.stack)return e;if(l.stack)return o;const t=Uj(s)&&!!s.aggregate;if(t!==(Uj(l)&&!!l.aggregate))return t?e:o;if(a&&"bar"===i){if("vertical"===r)return o;if("horizontal"===r)return e}}else{if(WU(s))return e;if(WU(l))return o}else{if(WU(s))return e;if(WU(l))return o}}function HU(t){const{point:e,line:n,...r}=t;return YP(r).length>1?r:r.type}function ZU(t){for(const e of["line","area","rule","trail"])t[e]&&(t={...t,[e]:qP(t[e],["point","line"])});return t}function YU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===t.point?{opacity:0}:t.point?Jt(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?Jt(e.point)?e.point:{}:void 0}function VU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class GU{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(cU(t)){const{mark:n,encoding:r}=t,i=Fj(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!YU(i,e[i.type],r);case"area":return!!YU(i,e[i.type],r)||!!VU(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{params:i,projection:o,mark:a,name:s,encoding:l,...u}=t,c=pU(l,r),f=Fj(a)?a:{type:a},d=YU(f,r[f.type],c),h="area"===f.type&&VU(f,r[f.type]),p=[{name:s,...i?{params:i}:{},mark:HU({..."area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:qP(c,["shape"])}],m=function(t,e){var n,r;const i=Fj(t)?t:{type:t},o=i.type;if(!qU.has(o))return null;const a=$U(e,"x",i)||$U(e,"theta",i);if(!a)return null;const s=e[a],l=Uj(s)?Qj(s,{}):void 0,u=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(a),c=[],f=new Set;if(e[u]){const t=e[u],n=Uj(t)?Qj(t,{}):void 0;n&&n!==l&&(c.push(u),f.add(n));const r="x"===u?"xOffset":"yOffset",i=e[r],o=Uj(i)?Qj(i,{}):void 0;o&&o!==l&&(c.push(r),f.add(o))}const d=pL.reduce(((t,n)=>{if("tooltip"!==n&&dU(e,n)){const r=e[n];for(const e of de(r)){const r=nU(e);if(r.aggregate)continue;const i=Qj(r,{});i&&f.has(i)||t.push({channel:n,fieldDef:r})}}return t}),[]);let h;return void 0!==s.stack?h=Fe(s.stack)?s.stack?"zero":null:s.stack:IU.has(o)&&(h="zero"),h&&h in UU?function(t){return $P(qB,(e=>{if(dU(t,e)){const n=t[e];if(Qt(n))return $P(n,(t=>!!t.aggregate));{const t=nU(n);return t&&!!t.aggregate}}return!1}))}(e)&&0===d.length?null:null!==s&&void 0!==s&&null!==(n=s.scale)&&void 0!==n&&n.type&&"linear"!==(null===s||void 0===s||null===(r=s.scale)||void 0===r?void 0:r.type)?(null!==s&&void 0!==s&&s.stack&&GL("Cannot stack non-linear scale (".concat(s.scale.type,").")),null):Wj(e[function(t){switch(t){case iB:return aB;case oB:return sB;case pB:return gB;case mB:return yB;case dB:return hB;case cB:return fB}}(a)])?(void 0!==s.stack&&GL('Cannot stack "'.concat(p=a,'" if there is already "').concat(p,'2".')),null):(Uj(s)&&s.aggregate&&!RL.has(s.aggregate)&&GL('Stacking is applied even though the aggregate function is non-summative ("'.concat(s.aggregate,'").')),{groupbyChannels:c,groupbyFields:f,fieldChannel:a,impute:null!==s.impute&&Sj(o),stackBy:d,offset:h}):null;var p}(f,c);let g=c;if(m){const{fieldChannel:t,offset:e}=m;g={...c,[t]:{...c[t],...e?{stack:e}:{}}}}return g=qP(g,["y2","x2"]),h&&p.push({...o?{projection:o}:{},mark:{type:"line",...UP(f,["clip","interpolate","tension","tooltip"]),...h},encoding:g}),d&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...UP(f,["clip","tooltip"]),...d},encoding:g}),n({...u,layer:p},{...e,config:ZU(r)})}}function XU(t,e){return e?zj(t)?nq(t,e):KU(t,e):t}function QU(t,e){return e?nq(t,e):t}function JU(t,e,n){const r=e[t];return function(t){return t&&!Oe(t)&&"repeat"in t}(r)?r.repeat in n?{...e,[t]:n[r.repeat]}:void GL(function(t){return'Unknown repeated value "'.concat(t,'".')}(r.repeat)):e}function KU(t,e){if(void 0!==(t=JU("field",t,e))){if(null===t)return null;if(Pj(t)&&(n=t.sort)&&("count"===n.op||n.field)){const n=JU("field",t.sort,e);t={...t,...n?{sort:n}:{}}}return t}var n}function tq(t,e){if(Uj(t))return KU(t,e);{const n=JU("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function eq(t,e){if(!Wj(t)){if(jj(t)){const n=tq(t.condition,e);if(n)return{...t,condition:n};{const{condition:e,...n}=t;return n}}return t}{const n=tq(t,e);if(n)return n;if(Bj(t))return{condition:t.condition}}}function nq(t,e){const n={};for(const r in t)if(Ee(t,r)){const i=t[r];if(Qt(i))n[r]=i.map((t=>eq(t,e))).filter((t=>t));else{const t=eq(i,e);void 0!==t&&(n[r]=t)}}return n}class rq{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(cU(t)){const{encoding:e,mark:n}=t;if("line"===n||Fj(n)&&"line"===n.type)for(const t of XB){const n=e[JB(t)];if(e[t]&&(Uj(n)&&!BL(n.bin)||qj(n)))return!0}}return!1}run(t,e,n){const{encoding:r,mark:i}=t;var o,a;return GL((o=!!r.x2,a=!!r.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(o&&a?"x2 and y2":o?"x2":"y2",". We will use the rule mark (line segments) instead."))),n({...t,mark:Jt(i)?{...i,type:"rule"}:"rule"},e)}}function iq(t){let{parentEncoding:e,encoding:n={},layer:r}=t,i={};if(e){const t=new Set([...YP(e),...YP(n)]);for(const o of t){const t=n[o],a=e[o];if(Wj(t)){const e={...a,...t};i[o]=e}else jj(t)?i[o]={...t,condition:{...a,...t.condition}}:t||null===t?i[o]=t:(r||Hj(a)||UL(a)||Wj(a)||Qt(a))&&(i[o]=a)}}else i=n;return!i||ZP(i)?void 0:i}function oq(t){const{parentProjection:e,projection:n}=t;return e&&n&&GL(function(t){const{parentProjection:e,projection:n}=t;return"Layer's shared projection ".concat(IP(e)," is overridden by a child projection ").concat(IP(n),".")}({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function aq(t,e){const{transform:n,...r}=t;if(n){const t=n.map((t=>{if(function(t){return"filter"in t}(t))return{filter:uq(t,e)};if(function(t){return"bin"in t}(t)&&LL(t.bin))return{...t,bin:lq(t.bin)};if(function(t){return"lookup"in t}(t)){const{selection:e,...n}=t.from;return e?{...t,from:{param:e,...n}}:t}return t}));return{...r,transform:t}}return t}function sq(t,e){var n;const r=jP(t);if(Uj(r)&&LL(r.bin)&&(r.bin=lq(r.bin)),Zj(r)&&null!==(n=r.scale)&&void 0!==n&&null!==(n=n.domain)&&void 0!==n&&n.selection){const{selection:t,...e}=r.scale.domain;r.scale.domain={...e,...t?{param:t}:{}}}if(Bj(r))if(Qt(r.condition))r.condition=r.condition.map((t=>{const{selection:n,param:r,test:i,...o}=t;return r?t:{...o,test:uq(t,e)}}));else{const{selection:t,param:n,test:i,...o}=sq(r.condition,e);r.condition=n?r.condition:{...o,test:uq(r.condition,e)}}return r}function lq(t){const e=t.extent;if(null!==e&&void 0!==e&&e.selection){const{selection:n,...r}=e;return{...t,extent:{...r,param:n}}}return t}function uq(t,e){const n=t=>LP(t,(t=>{var n,r,i;const o={param:t,empty:null===(n=e.emptySelections[t])||void 0===n||n};return null!==(r=(i=e.selectionPredicates)[t])&&void 0!==r||(i[t]=[]),e.selectionPredicates[t].push(o),o}));return t.selection?n(t.selection):LP(t.test||t.filter,(t=>t.selection?n(t.selection):t))}class cq extends jU{map(t,e){var n;const r=null!==(n=e.selections)&&void 0!==n?n:[];if(t.params&&!cU(t)){const e=[];for(const n of t.params)LU(n)?r.push(n):e.push(n);t.params=e}return e.selections=r,super.map(t,e)}mapUnit(t,e){var n;const r=e.selections;if(!r||!r.length)return t;const i=(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name),o=[];for(const a of r)if(a.views&&a.views.length)for(const e of a.views)(Oe(e)&&(e===t.name||i.includes(e))||Qt(e)&&e.map((t=>i.indexOf(t))).every(((t,e,n)=>-1!==t&&(0===e||t>n[e-1]))))&&o.push(a);else o.push(a);return o.length&&(t.params=o),t}}for(const n of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=cq.prototype[n];cq.prototype[n]=function(e,n){return t.call(this,e,fq(e,n))}}function fq(t,e){var n;return t.name?{...e,path:(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name)}:e}var dq,hq;new class extends jU{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[kU,SU,OU,new GU,new rq]}map(t,e){if(cU(t)){const n=dU(t.encoding,eB),r=dU(t.encoding,nB),i=dU(t.encoding,rB);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=QU(t.encoding,e.repeater),o={...t,...t.name?{name:[e.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{},...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,e);const a=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(o,e.config))return s.run(o,e,a);return o}mapRepeat(t,e){return function(t){return!Qt(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r,...i}=t,{row:o,column:a,layer:s}=n,{repeater:l={},repeaterPrefix:u=""}=e;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:r}},e):{...i,layer:s.map((t=>{const n={...l,layer:t},i="".concat((r.name?"".concat(r.name,"_"):"")+u,"child__layer_").concat(XP(t)),o=this.mapLayerOrUnit(r,{...e,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:o,...a}=t;!Qt(r)&&t.columns&&(t=qP(t,["columns"]),GL(WL("repeat")));const s=[],{repeater:l={},repeaterPrefix:u=""}=e,c=!Qt(r)&&r.row||[l?l.row:null],f=!Qt(r)&&r.column||[l?l.column:null],d=Qt(r)&&r||[l?l.repeat:null];for(const p of d)for(const t of c)for(const n of f){const o={repeat:p,row:t,column:n,layer:l.layer},a=(i.name?"".concat(i.name,"_"):"")+u+"child__"+(Qt(r)?"".concat(XP(p)):(r.row?"row_".concat(XP(t)):"")+(r.column?"column_".concat(XP(n)):"")),c=this.map(i,{...e,repeater:o,repeaterPrefix:a});c.name=a,s.push(qP(c,["data"]))}const h=Qt(r)?t.columns:r.column?r.column.length:1;return{data:null!==(n=i.data)&&void 0!==n?n:o,align:"all",...a,columns:h,concat:s}}mapFacet(t,e){const{facet:n}=t;return zj(n)&&t.columns&&(t=qP(t,["columns"]),GL(WL("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:o,config:a}=e,s=oq({parentProjection:o,projection:r}),l=iq({parentEncoding:i,encoding:QU(n,e.repeater)});return this.mapUnit({...t,...s?{projection:s}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,e){const{row:n,column:r,facet:i,...o}=t.encoding,{mark:a,width:s,projection:l,height:u,view:c,params:f,encoding:d,...h}=t,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},e),g=QU(o,e.repeater);return this.mapFacet({...h,...m,facet:p,spec:{...s?{width:s}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:a,encoding:g,...f?{params:f}:{}}},e)}getFacetMappingAndLayout(t,e){const{row:n,column:r,facet:i}=t;if(n||r){i&&GL("Facet encoding dropped as ".concat((a=[...n?[eB]:[],...r?[nB]:[]]).join(" and ")," ").concat(a.length>1?"are":"is"," also specified."));const e={},s={};for(const n of[eB,nB]){const r=t[n];if(r){const{align:t,center:i,spacing:a,columns:l,...u}=r;e[n]=u;for(const e of["align","center","spacing"]){var o;void 0!==r[e]&&(null!==(o=s[e])&&void 0!==o||(s[e]={}),s[e][n]=r[e])}}}return{facetMapping:e,layout:s}}{const{align:t,center:n,spacing:r,columns:o,...a}=i;return{facetMapping:XU(a,e.repeater),layout:{...t?{align:t}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}var a}mapLayer(t,e){let{parentEncoding:n,parentProjection:r,...i}=e;const{encoding:o,projection:a,...s}=t,l={...i,parentEncoding:iq({parentEncoding:n,encoding:o,layer:!0}),parentProjection:oq({parentProjection:r,projection:a})};return super.mapLayer({...s,...t.name?{name:[l.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{}},l)}},new class extends jU{map(t,e){var n,r;return null!==(n=e.emptySelections)&&void 0!==n||(e.emptySelections={}),null!==(r=e.selectionPredicates)&&void 0!==r||(e.selectionPredicates={}),t=aq(t,e),super.map(t,e)}mapLayerOrUnit(t,e){if((t=aq(t,e)).encoding){const n={};for(const[r,i]of GP(t.encoding))n[r]=sq(i,e);t={...t,encoding:n}}return super.mapLayerOrUnit(t,e)}mapUnit(t,e){const{selection:n,...r}=t;return n?{...r,params:GP(n).map((t=>{let[n,r]=t;const{init:i,bind:o,empty:a,...s}=r;"single"===s.type?(s.type="point",s.toggle=!1):"multi"===s.type&&(s.type="point"),e.emptySelections[n]="none"!==a;for(const u of VP(null!==(l=e.selectionPredicates[n])&&void 0!==l?l:{})){var l;u.empty="none"!==a}return{name:n,value:i,select:s,bind:o}}))}:t}},new cq,(hq=dq||(dq={}))[hq.Raw=0]="Raw",hq[hq.Main=1]="Main",hq[hq.Row=2]="Row",hq[hq.Column=3]="Column",hq[hq.Lookup=4]="Lookup",new Set(["aria","width","height"]);const pq={...BU,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1};YP(pq),new WeakMap;const mq={disable:1,gridScale:1,scale:1,...lU,labelExpr:1,encode:1};YP(mq),new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);const gq=(t,e)=>("temporal"!==e.type||t instanceof Date?"quantitative"===e.type&&vq(String(t))&&(t=Number(String(t))):t=new Date(t),t instanceof Date?bq(t,e.timeUnit):"string"==typeof t||isNaN(t)||t%1==0?String(t):Number(t).toFixed(2));function yq(t,e){var n;return"temporal"===e.type?(n=t,t=Array.isArray(n)?n.map((t=>new Date(t).getTime())):new Date(n).getTime()):Oe(t)&&vq(t)&&(t=Number(t)),t}function vq(t){return function(t){return!!Ne(t)||!isNaN(t)&&!isNaN(parseFloat(t))}(t.replaceAll(",",""))}function bq(t,e){if(!e)return t.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"});const n={};return e.includes("year")&&(n.year="numeric"),e.includes("month")&&(n.month="short"),e.includes("day")&&(n.weekday="short"),e.includes("date")&&(n.day="numeric"),e.includes("hours")&&(n.hour="numeric"),e.includes("minutes")&&(n.minute="numeric"),e.includes("seconds")&&(n.second="numeric"),Object.keys(n).length?t.toLocaleString("en-US",n):t.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}const xq="E",_q="R",wq="R-E",kq="R-LE",Aq="R-RE",Eq="LT",Mq="LTE",Cq="GT",Sq="GTE",Dq="VALID",Fq=t=>"equal"in t?xq:"lt"in t?Eq:"gt"in t?Cq:"lte"in t?Mq:"gte"in t?Sq:"range"in t?t.inclusive?_q:Aq:"oneOf"in t?"ONE":"valid"in t?Dq:"E";function Tq(t){if(t){const e=t=>t[Object.keys(t).find((t=>"field"!==t))];if("and"in t){const e=t.and.map((t=>Tq(t)));return{unit:"",fields:e.flatMap((t=>(null==t?void 0:t.fields)||[])),values:e.flatMap((t=>(null==t?void 0:t.values)||[]))}}if("or"in t)t.or;else{if(!("not"in t)){const n=[{type:Fq(t),field:t.field}],r=[e(t)];return n.length||r.length?{unit:"",fields:n,values:r}:null}t.not}}}function Nq(t,e){try{const n=Tq(e);return n?t.filter((t=>function(t,e){var n,r=e.fields,i=e.values;return r.every(((e,r)=>{switch(Te(n=t[e.field])&&(n=te(n)),Te(i[r])&&(i[r]=te(i[r])),Te(i[r][0])&&(i[r]=i[r].map(te)),e.type){case xq:return!(Qt(i[r])?i[r].indexOf(n)<0:n!==i[r]);case _q:return De(n,i[r],!0,!0);case Aq:return De(n,i[r],!0,!1);case wq:return De(n,i[r],!1,!1);case kq:return De(n,i[r],!1,!0);case Eq:return n<i[r];case Cq:return n>i[r];case Mq:return n<=i[r];case Sq:return n>=i[r];case Dq:return!(null===n||isNaN(n));default:return!0}}))}(t,n))):t}catch(e){return console.error(e),t}}function Oq(t,e,n){const r=new Set,i=n?Nq(e,n):e;if(t.timeUnit){const e=new Set;i.map((e=>e[t.field])).forEach((n=>{if(n instanceof Date){const i=bq(n,t.timeUnit);e.has(i)||(e.add(i),r.add(n))}}))}else{const e=new Set;i.map((e=>e[t.field])).forEach((t=>{if(t instanceof Date){const n=t.getTime();e.has(n)||(e.add(n),r.add(t))}else r.add(t)}))}return[...r].filter((t=>null!=t)).sort(((t,e)=>t instanceof Date&&e instanceof Date?t.getTime()-e.getTime():"string"==typeof t&&"string"==typeof e?t.localeCompare(e):t-e))}function zq(t,e){return e.find((e=>e.field===t))}function Rq(){}function Pq(t){return null==t?Rq:function(){return this.querySelector(t)}}function Bq(){return[]}function Lq(t){return null==t?Bq:function(){return this.querySelectorAll(t)}}function jq(t){return function(){return this.matches(t)}}function Uq(t){return function(e){return e.matches(t)}}var qq=Array.prototype.find;function Iq(){return this.firstElementChild}var Wq=Array.prototype.filter;function $q(){return Array.from(this.children)}function Hq(t){return new Array(t.length)}function Zq(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Yq(t,e,n,r,i,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Zq(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function Vq(t,e,n,r,i,o,a){var s,l,u,c=new Map,f=e.length,d=o.length,h=new Array(f);for(s=0;s<f;++s)(l=e[s])&&(h[s]=u=a.call(l,l.__data__,s,e)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<d;++s)u=a.call(t,o[s],s,o)+"",(l=c.get(u))?(r[s]=l,l.__data__=o[s],c.delete(u)):n[s]=new Zq(t,o[s]);for(s=0;s<f;++s)(l=e[s])&&c.get(h[s])===l&&(i[s]=l)}function Gq(t){return t.__data__}function Xq(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Qq(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Zq.prototype={constructor:Zq,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Jq="http://www.w3.org/1999/xhtml";const Kq={svg:"http://www.w3.org/2000/svg",xhtml:Jq,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function tI(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Kq.hasOwnProperty(e)?{space:Kq[e],local:t}:t}function eI(t){return function(){this.removeAttribute(t)}}function nI(t){return function(){this.removeAttributeNS(t.space,t.local)}}function rI(t,e){return function(){this.setAttribute(t,e)}}function iI(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function oI(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function aI(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function sI(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function lI(t){return function(){this.style.removeProperty(t)}}function uI(t,e,n){return function(){this.style.setProperty(t,e,n)}}function cI(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function fI(t,e){return t.style.getPropertyValue(e)||sI(t).getComputedStyle(t,null).getPropertyValue(e)}function dI(t){return function(){delete this[t]}}function hI(t,e){return function(){this[t]=e}}function pI(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function mI(t){return t.trim().split(/^|\s+/)}function gI(t){return t.classList||new yI(t)}function yI(t){this._node=t,this._names=mI(t.getAttribute("class")||"")}function vI(t,e){for(var n=gI(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function bI(t,e){for(var n=gI(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function xI(t){return function(){vI(this,t)}}function _I(t){return function(){bI(this,t)}}function wI(t,e){return function(){(e.apply(this,arguments)?vI:bI)(this,t)}}function kI(){this.textContent=""}function AI(t){return function(){this.textContent=t}}function EI(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function MI(){this.innerHTML=""}function CI(t){return function(){this.innerHTML=t}}function SI(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function DI(){this.nextSibling&&this.parentNode.appendChild(this)}function FI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function TI(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Jq&&e.documentElement.namespaceURI===Jq?e.createElement(t):e.createElementNS(n,t)}}function NI(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function OI(t){var e=tI(t);return(e.local?NI:TI)(e)}function zI(){return null}function RI(){var t=this.parentNode;t&&t.removeChild(this)}function PI(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function BI(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function LI(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function jI(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function UI(t,e,n){var r=sI(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function qI(t,e){return function(){return UI(this,t,e)}}function II(t,e){return function(){return UI(this,t,e.apply(this,arguments))}}yI.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var WI=[null];function $I(t,e){this._groups=t,this._parents=e}function HI(){return new $I([[document.documentElement]],WI)}$I.prototype=HI.prototype={constructor:$I,select:function(t){"function"!=typeof t&&(t=Pq(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new $I(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return function(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):Lq(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(t.call(a,a.__data__,u,s)),i.push(a));return new $I(r,i)},selectChild:function(t){return this.select(null==t?Iq:function(t){return function(){return qq.call(this.children,t)}}("function"==typeof t?t:Uq(t)))},selectChildren:function(t){return this.selectAll(null==t?$q:function(t){return function(){return Wq.call(this.children,t)}}("function"==typeof t?t:Uq(t)))},filter:function(t){"function"!=typeof t&&(t=jq(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new $I(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Gq);var n=e?Vq:Yq,r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],f=i[u],d=f.length,h=Xq(t.call(c,c&&c.__data__,u,r)),p=h.length,m=s[u]=new Array(p),g=a[u]=new Array(p);n(c,f,m,g,l[u]=new Array(d),h,e);for(var y,v,b=0,x=0;b<p;++b)if(y=m[b]){for(b>=x&&(x=b+1);!(v=g[x])&&++x<p;);y._next=v||null}}return(a=new $I(a,r))._enter=s,a._exit=l,a},enter:function(){return new $I(this._enter||this._groups.map(Hq),this._parents)},exit:function(){return new $I(this._exit||this._groups.map(Hq),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,c=n[l],f=r[l],d=c.length,h=s[l]=new Array(d),p=0;p<d;++p)(u=c[p]||f[p])&&(h[p]=u);for(;l<i;++l)s[l]=n[l];return new $I(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Qq);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(e)}return new $I(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=tI(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?nI:eI:"function"==typeof e?n.local?aI:oI:n.local?iI:rI)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?lI:"function"==typeof e?cI:uI)(t,e,null==n?"":n)):fI(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?dI:"function"==typeof e?pI:hI)(t,e)):this.node()[t]},classed:function(t,e){var n=mI(t+"");if(arguments.length<2){for(var r=gI(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?wI:e?xI:_I)(n,e))},text:function(t){return arguments.length?this.each(null==t?kI:("function"==typeof t?EI:AI)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?MI:("function"==typeof t?SI:CI)(t)):this.node().innerHTML},raise:function(){return this.each(DI)},lower:function(){return this.each(FI)},append:function(t){var e="function"==typeof t?t:OI(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:OI(t),r=null==e?zI:"function"==typeof e?e:Pq(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(RI)},clone:function(t){return this.select(t?BI:PI)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?jI:LI,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?II:qI)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};const ZI=HI;function YI(t,e,n){var r=new jA;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}var VI=EA("start","end","cancel","interrupt"),GI=[],XI=0,QI=3;function JI(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var u,c,f,d;if(1!==n.state)return s();for(u in i)if((d=i[u]).name===n.name){if(d.state===QI)return YI(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(YI((function(){n.state===QI&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=QI,r=new Array(f=n.tween.length),u=0,c=-1;u<f;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=UA((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:VI,tween:GI,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:XI})}function KI(t,e){var n=eW(t,e);if(n.state>XI)throw new Error("too late; already scheduled");return n}function tW(t,e){var n=eW(t,e);if(n.state>QI)throw new Error("too late; already running");return n}function eW(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function nW(t,e){var n,r;return function(){var i=tW(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function rW(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=tW(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function iW(t,e,n){var r=t._id;return t.each((function(){var t=tW(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return eW(t,r).value[e]}}function oW(t,e){var n;return("number"==typeof e?Yc:e instanceof hc?Lc:(n=hc(e))?(e=n,Lc):Qc)(t,e)}function aW(t){return function(){this.removeAttribute(t)}}function sW(t){return function(){this.removeAttributeNS(t.space,t.local)}}function lW(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function uW(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function cW(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function fW(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function dW(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function hW(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function pW(t,e){return function(){KI(this,t).delay=+e.apply(this,arguments)}}function mW(t,e){return e=+e,function(){KI(this,t).delay=e}}function gW(t,e){return function(){tW(this,t).duration=+e.apply(this,arguments)}}function yW(t,e){return e=+e,function(){tW(this,t).duration=e}}var vW=ZI.prototype.constructor;function bW(t){return function(){this.style.removeProperty(t)}}var xW=0;function _W(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function wW(){return++xW}var kW=ZI.prototype;_W.prototype=function(t){return ZI().transition(t)}.prototype={constructor:_W,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Pq(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=r[a],c=u.length,f=o[a]=new Array(c),d=0;d<c;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),f[d]=l,JI(f[d],e,n,d,f,eW(s,n)));return new _W(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Lq(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,f=0;f<c;++f)if(l=u[f]){for(var d,h=t.call(l,l.__data__,f,u),p=eW(l,n),m=0,g=h.length;m<g;++m)(d=h[m])&&JI(d,e,n,m,h,p);o.push(h),a.push(l)}return new _W(o,a,e,n)},selectChild:kW.selectChild,selectChildren:kW.selectChildren,filter:function(t){"function"!=typeof t&&(t=jq(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new _W(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=e[s],c=n[s],f=u.length,d=a[s]=new Array(f),h=0;h<f;++h)(l=u[h]||c[h])&&(d[h]=l);for(;s<r;++s)a[s]=e[s];return new _W(a,this._parents,this._name,this._id)},selection:function(){return new vW(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=wW(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=eW(a,e);JI(a,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new _W(r,this._parents,t,n)},call:kW.call,nodes:kW.nodes,node:kW.node,size:kW.size,empty:kW.empty,each:kW.each,on:function(t,e){var n=this._id;return arguments.length<2?eW(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?KI:tW;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}(n,t,e))},attr:function(t,e){var n=tI(t),r="transform"===n?ld:oW;return this.attrTween(t,"function"==typeof e?(n.local?fW:cW)(n,r,iW(this,"attr."+t,e)):null==e?(n.local?sW:aW)(n):(n.local?uW:lW)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=tI(t);return this.tween(n,(r.local?dW:hW)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?sd:oW;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=fI(this,t),a=(this.style.removeProperty(t),fI(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,bW(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=fI(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=fI(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,iW(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=tW(this,t),u=l.on,c=null==l.value[a]?o||(o=bW(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=fI(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(iW(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=eW(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?nW:rW)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?pW:mW)(e,t)):eW(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?gW:yW)(e,t)):eW(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){tW(this,t).ease=e}}(e,t)):eW(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;tW(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--i&&o()}};n.each((function(){var n=tW(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:kW[Symbol.iterator]};var AW={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function EW(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error("transition ".concat(e," not found"));return n}ZI.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},ZI.prototype.transition=function(t){var e,n;t instanceof _W?(e=t._id,t=t._name):(e=wW(),(n=AW).time=BA(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&JI(a,t,e,u,s,n||EW(a,e));return new _W(r,this._parents,t,e)};const{abs:MW,max:CW,min:SW}=Math;function DW(t){return{type:t}}function FW(t,e,n){this.k=t,this.x=e,this.y=n}function TW(t,e,n,r,i){const o=zq(t,n),a=Oq(o,e,i),s=[];let l=r;if(!l)if("temporal"===o.type)l=Lf().domain([a[0],a[a.length-1]]).ticks(6);else{if(o.bin&&t.startsWith("bin_"))return a.map((n=>{const r=e.find((e=>e[t]===n))[t+"_end"];return[Number(n),Number(r)]}));{const t=X({maxbins:10,extent:[a[0],a[a.length-1]]});l=[];for(let e=t.start;e<=t.stop;e+=t.step)l.push(e)}}l=l.filter((t=>t>=a[0]&&t<=a[a.length-1])),a[0]<l[0]&&s.push([a[0],l[0]]);for(let u=0;u<l.length-1;u++)s.push([l[u],l[u+1]]);return a[a.length-1]>l[l.length-1]&&s.push([l[l.length-1],a[a.length-1]]),s}function NW(t){return t.slice(0,1).toUpperCase()+t.slice(1)}function OW(t){return t.endsWith(".")?t.slice(0,-1):t}["w","e"].map(DW),["n","s"].map(DW),["n","w","e","s","nw","ne","sw","se"].map(DW),FW.prototype={constructor:FW,scale:function(t){return 1===t?this:new FW(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new FW(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new FW(1,0,0),FW.prototype;const zW=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return"".concat(t," ").concat(e).concat(1!==t?n:"")},RW=(t,e)=>Math.round(t.reduce(((t,n)=>t+Number(n[e])),0)/t.length);let PW={name:!0,index:!0,type:!0,children:!0,data:!0,size:!0,level:!1,parent:!0,quartile:!1,aggregate:!0,instructions:!0};var BW=n(925),LW=n.n(BW);function jW(t){const e=function(){let t;try{throw t=new(LW())("settingsData"),t.version,new Error("Incompatible legacy storage schema")}catch(e){t=new(LW())("settingsData",1),t.write(PW)}return t}().read();return Array.from(t.description).filter((t=>{let[n,r]=t;return e[n]})).map((t=>{let[e,n]=t;return n})).filter((t=>t.length>0)).map(NW).map(OW).join(". ")+"."}function UW(t,e){return"and"in t?t.and.map((t=>UW(t,e))).join(" and "):"or"in t?t.or.map((t=>UW(t,e))).join(" or "):"not"in t?"not ".concat(UW(t.not,e)):function(t,e){const n=zq(t.field,e),r=n.label||n.field;return"equal"in t?"".concat(r," equals ").concat(gq(t.equal,n)):"range"in t?"".concat(r," is between ").concat(gq(t.range[0],n)," and ").concat(gq(t.range[1],n)):"lt"in t?"".concat(r," is less than ").concat(gq(t.lt,n)):"lte"in t?"".concat(r," is less than or equal to ").concat(gq(t.lte,n)):"gt"in t?"".concat(r," is greater than ").concat(gq(t.gt,n)):"gte"in t?"".concat(r," is greater than or equal to ").concat(gq(t.gte,n)):""}(t,e)}var qW=n(62),IW=n.n(qW),WW=n(36),$W=n.n(WW),HW=n(793),ZW=n.n(HW),YW=n(892),VW=n.n(YW),GW=n(173),XW=n.n(GW),QW=n(464),JW=n.n(QW),KW=n(914),t$={};function e$(t){switch(t){case"=":return"equal";case"between":return"range";case"<":return"lt";case"<=":return"lte";case">":return"gt";case">=":return"gte"}}function n$(t,e,n,r){const i=document.createElement("div"),o=document.createElement("select");o.classList.add("olli-field-select"),o.setAttribute("name","olli-field-select");const a=document.createElement("select");a.classList.add("olli-op-select"),a.setAttribute("name","olli-op-select");const s=document.createElement("span");s.classList.add("olli-value-container");const l=e.fields.map((t=>{const e=document.createElement("option");return e.setAttribute("value",t.field),e.innerText=t.field,e}));function u(e){const o=r.indexOf(i);n[o]=e,t.setAttribute("data-state",JSON.stringify(n))}o.replaceChildren(...l),o.onchange=()=>{const t=zq(o.value,e.fields);let n=["="];"quantitative"!==t.type&&"temporal"!==t.type||(n=["between","<","<=",">",">=","="]);const r=n.map((t=>{const e=document.createElement("option");return e.setAttribute("value",t),e.innerText=t,e}));a.replaceChildren(...r),a.onchange(null)},a.onchange=()=>{const t=o.value,n=a.value,r=zq(t,e.fields);if("="!==n||"nominal"!==r.type&&"ordinal"!==r.type){if("between"===n){if("quantitative"===r.type){const e=document.createElement("input");e.setAttribute("type","number");const n=document.createElement("input");n.setAttribute("type","number"),s.replaceChildren(e,n),e.onchange=n.onchange=()=>{const r=Number(e.value),i=Number(n.value);u({field:t,range:[r,i]})}}else if("temporal"===r.type){const e=document.createElement("input");e.setAttribute("type","datetime-local");const n=document.createElement("input");n.setAttribute("type","datetime-local"),s.replaceChildren(e,n),e.onchange=n.onchange=()=>{const i=yq(new Date(e.value),r),o=yq(new Date(n.value),r);u({field:t,range:[i,o]})}}}else if("quantitative"===r.type){const e=document.createElement("input");e.setAttribute("type","number"),s.replaceChildren(e),e.onchange=()=>{const r=Number(e.value),i=e$(n);u({field:t,[i]:r})}}else if("temporal"===r.type){const e=document.createElement("input");e.setAttribute("type","datetime-local"),s.replaceChildren(e),e.onchange=()=>{const i=yq(new Date(e.value),r),o=e$(n);u({field:t,[o]:i})}}}else{const n=Oq(r,e.data),i=document.createElement("select"),o=n.map((t=>{const e=document.createElement("option");return e.setAttribute("value",yq(t,r)),e.innerText=String(t),e}));i.replaceChildren(...o),s.replaceChildren(i),i.onchange=()=>{const e=i.value;u({field:t,equal:e})}}},i.replaceChildren(o,a,s);const c=document.createElement("button");return c.innerText="Remove condition",c.onclick=()=>{const e=r.indexOf(i);r.splice(e,1),n.splice(e,1),t.setAttribute("data-state",JSON.stringify(n)),i.remove(),0===r.length&&t.querySelector(".olli-clear-button").classList.add("olli-hidden"),document.querySelector(".olli-status-text").innerHTML=zW(r.length,"condition")},i.appendChild(c),o.onchange(null),i}t$.styleTagTransform=JW(),t$.setAttributes=VW(),t$.insert=ZW().bind(null,"head"),t$.domAPI=$W(),t$.insertStyleElement=XW(),IW()(KW.Z,t$),KW.Z&&KW.Z.locals&&KW.Z.locals;const r$=t=>"operator"in t;function i$(t,e){function n(t){t.children.forEach((e=>{e.parent=t}));const n=o$(t,e)||(r$(e)?{data:e.units.flatMap((t=>t.data)),selection:null,fields:e.units.flatMap((t=>t.fields)).filter((t=>void 0!==t)),axes:e.units.flatMap((t=>t.axes)).filter((t=>void 0!==t)),legends:e.units.flatMap((t=>t.legends)).filter((t=>void 0!==t))}:e),r=n.selection?Nq(n.data,n.selection):n.data;t.description=function(t,e,n){var r,i,o;const a="".concat(((null===(r=t.parent)||void 0===r?void 0:r.children.indexOf(t))||0)+1," of ").concat(((null===(i=t.parent)||void 0===i?void 0:i.children)||[]).length),s=n.description||"",l=function(t){var e,n,r;if(t.mark){if("point"===t.mark&&2===(null===(e=t.axes)||void 0===e?void 0:e.length)){if(t.axes.every((e=>"quantitative"===zq(e.field,t.fields).type)))return"scatterplot";if(t.axes.find((e=>"quantitative"===zq(e.field,t.fields).type))&&!t.axes.find((e=>"temporal"===zq(e.field,t.fields).type)))return"dotplot"}return"line"===t.mark&&2===(null===(n=t.axes)||void 0===n?void 0:n.length)&&1===(null===(r=t.guides)||void 0===r?void 0:r.length)&&t.axes.every((e=>"quantitative"===zq(e.field,t.fields).type))&&"order"===t.guides[0].channel?"connected scatterplot":"".concat(t.mark," chart")}return"dataset"}(n),u=null===(o=n.axes)||void 0===o?void 0:o.map((t=>{const e=zq(t.field,n.fields);return t.title||e.label||t.field})).join(" and "),c=new Map([["root",["name","type","size","children","level"]],["view",["index","type","name","children","level"]],["xAxis",["name","type","data","parent","aggregate","level"]],["yAxis",["name","type","data","parent","aggregate","level"]],["legend",["name","type","data","parent","aggregate","level"]],["guide",["name","type","data","parent","level"]],["filteredData",["index","data","size","parent","aggregate","quartile","level","instructions"]],["annotations",["size","level"]],["other",["index","data","size","level","instructions"]]]),f=new Map([["name",function(t){var e,r,i;switch(t.nodeType){case"root":return"groupby"in t?s:n.mark&&n.description||"";case"view":return"predicate"in t&&"equal"in t.predicate?"titled ".concat(gq(t.predicate.equal,zq(t.predicate.field,n.fields))):"";case"xAxis":case"yAxis":case"legend":case"guide":const o=zq(t.groupby,n.fields),a=(null===(e=n.axes)||void 0===e?void 0:e.find((e=>e.field===t.groupby)))||(null===(r=n.legends)||void 0===r?void 0:r.find((e=>e.field===t.groupby)))||(null===(i=n.guides)||void 0===i?void 0:i.find((e=>e.field===t.groupby)));return"".concat("xAxis"===t.nodeType?"x-axis":"yAxis"===t.nodeType?"y-axis":"legend"===t.nodeType?"legend":a.channel?a.channel:"guide"," titled ").concat(a.title||o.label||o.field);default:throw"Node type ".concat(t.nodeType," does not have the 'name' token.")}}],["index",function(t){switch(t.nodeType){case"view":case"filteredData":case"other":return a;default:throw"Node type ".concat(t.nodeType," does not have the 'index' token.")}}],["type",function(t){var r,i,o;switch(t.nodeType){case"root":if("groupby"in t)return"a ".concat(((t,e)=>t&&"groupby"in t&&"root"===t.nodeType?"line"===e.mark?"multi-series ":"multi-view ":"")(t,n)).concat(l);if(n.mark)return"a ".concat(l);if(t.children.length){if("layer"===t.children[0].viewType)return"a layered chart";if("concat"===t.children[0].viewType)return"a multi-view chart"}return"a dataset";case"view":return"a ".concat("line"===n.mark?"line":n.mark?l:t.viewType?t.viewType:"view");case"xAxis":case"yAxis":case"legend":case"guide":if("groupby"in t){const a=zq(t.groupby,n.fields);if("quantitative"!==a.type&&"temporal"!==a.type)return"for a ".concat(a.type," scale");{const s=(null===(r=n.axes)||void 0===r?void 0:r.find((e=>e.field===t.groupby)))||(null===(i=n.legends)||void 0===i?void 0:i.find((e=>e.field===t.groupby)))||(null===(o=n.guides)||void 0===o?void 0:o.find((e=>e.field===t.groupby)));if(TW(t.groupby,e,n.fields,"ticks"in s&&Array.isArray(s.ticks)?s.ticks:void 0).length)return"for a ".concat("scaleType"in s&&s.scaleType||a.type," scale")}}return"";default:throw"Node type ".concat(t.nodeType," does not have the 'type' token.")}}],["children",function(t){var e,r;switch(t.nodeType){case"root":if("groupby"in t||n.mark&&(null===(e=n.axes)||void 0===e?void 0:e.length))return"with ".concat(n.axes.length>1?"axes":"axis"," ").concat(u);const i=n.fields.map((t=>t.label||t.field));return i.length<=3?" "+[...i].join(", "):"";case"view":return(null===(r=n.axes)||void 0===r?void 0:r.length)?"with ".concat(n.axes.length>1?"axes":"axis"," ").concat(u):"";default:throw"Node type ".concat(t.nodeType," does not have the 'children' token.")}}],["data",function(t){var r;switch(t.nodeType){case"xAxis":case"yAxis":case"legend":case"guide":if("groupby"in t){const i=zq(t.groupby,n.fields);let o,a;if("quantitative"===i.type||"temporal"===i.type){const s=null===(r=n.axes)||void 0===r?void 0:r.find((e=>e.field===t.groupby)),l=TW(t.groupby,e,n.fields,s?s.ticks:void 0);if(l.length)return o=gq(l[0][0],i),a=gq(l[l.length-1][1],i),"with values from ".concat(o," to ").concat(a)}else{const t=Oq(i,e);if(t.length)return o=gq(t[0],i),a=gq(t[t.length-1],i),"with ".concat(zW(t.length,"value")," from ").concat(o," to ").concat(a)}}return"";case"filteredData":return"predicate"in t?UW(t.predicate,n.fields):"";case"other":if("groupby"in t)return"grouped by ".concat(t.groupby);if("predicate"in t)return UW(t.predicate,n.fields);default:throw"Node type ".concat(t.nodeType," does not have the 'data' token.")}}],["size",function(t){var r;switch(t.nodeType){case"root":return"groupby"in t?"with ".concat(t.children.length," views for ").concat(t.groupby):n.mark&&(null===(r=n.axes)||void 0===r?void 0:r.length)||n.mark?"":"with ".concat(n.fields.length," fields");case"filteredData":if("predicate"in t){const n=Nq(e,t.fullPredicate);return"".concat(zW(n.length,"value"))}return"";case"annotations":return"".concat(t.children.length," annotations");case"other":if("groupby"in t)return"".concat(t.children.length," groups");if("predicate"in t){const n=Nq(e,t.fullPredicate);return"".concat(zW(n.length,"value"))}return"";default:throw"Node type ".concat(t.nodeType," does not have the 'size' token.")}}],["level",function(t){return"level ".concat(t.level)}],["parent",function(t){switch(t.nodeType){case"xAxis":case"yAxis":case"legend":case"guide":case"filteredData":let e=t;for(;e.parent&&"view"!=e.nodeType;)e=e.parent;return"predicate"in e&&"equal"in e.predicate?"".concat(gq(e.predicate.equal,zq(e.predicate.field,n.fields))):"";default:throw"Node type ".concat(t.nodeType," does not have the 'parent' token.")}}],["quartile",function(t){var r,i,o,a;if("filteredData"===t.nodeType){const s="xAxis"===t.parent.nodeType?"x":"y",l=null===(r=n.axes)||void 0===r?void 0:r.find((t=>t.axisType!==s));if(!l)return"";const u=zq(l.field,n.fields);if("quantitative"!==u.type)return"";const c=u.label||u.field,f=u.field,d=[];t.parent.children.forEach((t=>{const n=Nq(e,t.fullPredicate);0!=n.length?d.push(Number(RW(n,f))):d.push(0)})),d.sort((function(t,e){return t-e}));const h=Nq(e,t.fullPredicate),p=0==h.length?0:RW(h,f),m=d.indexOf(Number(p))/d.length;return"this section's average ".concat(c," is in the ").concat((a=(i=Math.max(1,Math.ceil(4*m)))%100,1==(o=i%10)&&11!=a?i+"st":2==o&&12!=a?i+"nd":3==o&&13!=a?i+"rd":i+"th")," quartile  of all sections")}throw"Node type ".concat(t.nodeType," does not have the 'quartile' token.")}],["aggregate",function(t){var r;let i;switch(t.nodeType){case"xAxis":case"yAxis":case"legend":i="xAxis"===t.nodeType?"x":"y";case"filteredData":i||(i="xAxis"===t.parent.nodeType?"x":"y");let o=zq(t.groupby,n.fields);if(!o||"quantitative"!==o.type){const t=null===(r=n.axes)||void 0===r?void 0:r.find((t=>t.axisType!==i));if(!t)return"";const e=zq(t.field,n.fields);if("quantitative"!==e.type)return"";o=e}const a=o.label||o.field,s=o.field,l=Nq(e,t.fullPredicate);if(0===l.length)return"";if(1===l.length)return"the ".concat(a," value is ").concat(gq(l[0][s],o));const u=RW(l,s),c=l.reduce(((t,e)=>Math.max(t,Number(e[s]))),Number(l[0][s])),f=l.reduce(((t,e)=>Math.min(t,Number(e[s]))),Number(l[0][s]));return"the average value for the ".concat(a," field is ").concat(gq(u,o),", the maximum is ").concat(gq(c,o),", and the minimum is ").concat(gq(f,o));default:throw"Node type ".concat(t.nodeType," does not have the 'aggregate' token.")}}],["instructions",function(t){switch(t.nodeType){case"filteredData":case"other":return"predicate"in t&&Nq(e,t.fullPredicate).length?"press t to open table":"";default:throw"Node type ".concat(t.nodeType," does not have the 'instructions' token.")}}]]),d=new Map,h=c.get(t.nodeType);if(void 0!==h)for(const p of h){const e=f.get(p);void 0!==e&&d.set(p,e(t))}return d}(t,r,n)}const r=[t];for(;r.length>0;){const t=r.shift();n(t),r.push(...t.children)}}function o$(t,e){return r$(e)?e.units[t.specIndex]:e}function a$(t,e,n,r,i){const o=document.createElement("div");o.setAttribute("class","olli-dialog"),o.setAttribute("role","dialog"),o.setAttribute("aria-labelledby","overlay-title"),o.setAttribute("aria-describedby","overlay-instructions");const a=document.createElement("div");a.setAttribute("role","document");const s=document.createElement("h2");s.setAttribute("id","overlay-title"),s.innerText=e;const l=document.createElement("p");l.setAttribute("id","overlay-instructions"),l.innerText=n;const u=()=>{o.remove(),t.setFocusToItem(t.lastFocusedTreeItem),(null==i?void 0:i.onClose)&&(null==i||i.onClose())};o.addEventListener("keydown",(t=>{"Escape"===t.key&&u()}));const c=document.createElement("button");c.innerText="Close "+e,c.addEventListener("click",u);const f=document.createElement("div");if(f.setAttribute("id","olli-dialog-content"),f.appendChild(r),a.appendChild(c),a.appendChild(s),a.appendChild(l),a.appendChild(f),null==i?void 0:i.onOk){const t=document.createElement("button");t.innerText="Cancel",t.addEventListener("click",u),a.appendChild(t);const e=document.createElement("button");e.innerText="Ok",e.addEventListener("click",(()=>{u(),null==i||i.onOk()})),a.appendChild(e)}return o.appendChild(a),o}function s$(t,e){e.querySelectorAll(".olli-dialog").forEach((t=>{t.remove()})),e.appendChild(t),window.requestAnimationFrame((()=>{t.querySelector("button").focus()}))}class l${constructor(t,e,n,r){t.tabIndex=-1,this.tree=e,this.domNode=t,this.olliNode=n,this.isExpandable=!1,this.inGroup=!1,r&&(this.inGroup=!0),this.parent=r,this.children=[];let i=t.firstElementChild;for(;i;){if("ul"==i.tagName.toLowerCase()){this.isExpandable=!0;break}i=i.nextElementSibling}}init(){this.domNode.tabIndex=-1,this.domNode.addEventListener("keydown",this.handleKeydown.bind(this)),this.domNode.addEventListener("click",this.handleClick.bind(this)),this.domNode.addEventListener("focus",this.handleFocus.bind(this)),this.domNode.addEventListener("blur",this.handleBlur.bind(this)),this.isExpandable||(this.domNode.addEventListener("mouseover",this.handleMouseOver.bind(this)),this.domNode.addEventListener("mouseout",this.handleMouseOut.bind(this)))}isExpanded(){return!!this.isExpandable&&this.domNode.classList.contains("expanded")}handleKeydown(t){t.altKey||t.ctrlKey||t.metaKey||this.checkBaseKeys(t)}checkBaseKeys(t){switch(t.key){case"Enter":case" ":this.isExpandable&&(this.isExpanded()?this.tree.collapseTreeItem(this):this.tree.expandTreeItem(this));break;case"ArrowDown":this.children.length>0&&this.isExpandable&&this.tree.setFocusToNextLayer(this);break;case"Escape":case"ArrowUp":this.inGroup&&this.tree.setFocusToParentItem(this);break;case"ArrowLeft":t.shiftKey?this.tree.isLateralPossible()&&this.tree.setFocusToLateralItem(this,"left"):this.tree.setFocusToPreviousItem(this);break;case"ArrowRight":t.shiftKey?this.tree.isLateralPossible()&&this.tree.setFocusToLateralItem(this,"right"):this.tree.setFocusToNextItem(this);break;case"Home":this.parent&&this.tree.setFocusToFirstInLayer(this);break;case"End":this.parent&&this.tree.setFocusToLastInLayer(this);break;case"x":this.tree.focusOnNodeType("xAxis",this);break;case"y":this.tree.focusOnNodeType("yAxis",this);break;case"l":this.tree.focusOnNodeType("legend",this);break;case"t":!function(t,e){const n=o$(t,e.olliSpec),r=function(t,e){const n=document.createElement("table"),r=document.createElement("thead"),i=document.createElement("tr");e.forEach((t=>{const e=document.createElement("th");e.setAttribute("scope","col"),e.innerText=t.label||t.field,i.appendChild(e)})),r.appendChild(i),n.appendChild(r);const o=document.createElement("tbody");return t.forEach((t=>{const n=document.createElement("tr");e.forEach((e=>{const r=document.createElement("td");r.innerText=gq(t[e.field],e),n.appendChild(r)})),o.appendChild(n)})),n.appendChild(o),n}(Nq(n.data,t.fullPredicate),n.fields);s$(a$(e,"Table View",UW(t.fullPredicate,n.fields),r),e.renderContainer)}(this.olliNode,this.tree);break;case"f":!function(t,e){const n=function(t){const e=t.selection?"and"in t.selection?t.selection.and:[t.selection]:[],n=document.createElement("div"),r=document.createElement("div"),i=[];e.length&&e.forEach(((r,o)=>{i.length<=o&&i.push(n$(n,t,e,i)),function(t,e,n){const r=t.querySelector(".olli-field-select"),i=t.querySelector(".olli-op-select"),o=t.querySelector(".olli-value-container"),a=e.field,s=zq(a,n.fields),l=Object.keys(e).find((t=>"field"!==t)),u=e[l];if(r.value=a,r.onchange(null),i.value=function(t){switch(t){case"equal":return"=";case"range":return"between";case"lt":return"<";case"lte":return"<=";case"gt":return">";case"gte":return">="}}(l),i.onchange(null),"range"===l){const t=u[0],e=u[1],n=o.querySelectorAll("input");if("temporal"===s.type){const t=new Date(u[0]);t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),n[0].value=t.toISOString().slice(0,16);const e=new Date(u[1]);e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),n[1].value=e.toISOString().slice(0,16)}else n[0].value=t,n[1].value=e}else if("equal"===l&&o.querySelector("select"))o.querySelector("select").value=u;else{const t=o.querySelector("input");if("temporal"===s.type){const e=new Date(u);e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),t.value=e.toISOString().slice(0,16)}else t.value=u}}(i[o],r,t)})),r.replaceChildren(...i);const o=document.createElement("button");o.innerText="Add condition",o.onclick=()=>{i.push(n$(n,t,e,i)),r.replaceChildren(...i),i.length>0&&(n.querySelector(".olli-clear-button").classList.remove("olli-hidden"),document.querySelector(".olli-status-text").innerHTML=zW(i.length,"condition"))};const a=document.createElement("button");a.classList.add("olli-clear-button"),a.innerText="Clear conditions",0===i.length&&a.classList.add("olli-hidden"),a.onclick=()=>{i.forEach((t=>{t.remove()})),i.splice(0,i.length),r.replaceChildren(...i),e.splice(0,e.length),n.setAttribute("data-state",JSON.stringify(e)),document.querySelector(".olli-status-text").innerHTML=zW(i.length,"condition")};const s=document.createElement("div");return s.setAttribute("role","status"),s.classList.add("olli-status-text"),s.innerHTML=zW(i.length,"condition"),n.replaceChildren(s,o,r,a),n.setAttribute("data-state",JSON.stringify(e)),n}(o$(t,e.olliSpec));s$(a$(e,"Filter Menu","Define a custom filter.",n,{onOk:()=>{var t,r;const i={and:JSON.parse(n.getAttribute("data-state"))};e.setSelection(i),(null===(t=e.callbacks)||void 0===t?void 0:t.onSelection)&&(null===(r=e.callbacks)||void 0===r||r.onSelection(i))}}),e.renderContainer)}(this.olliNode,this.tree);break;case"r":!function(t){const e=function(t){const e=document.createElement("div");let n=t.rootTreeItem.olliNode.id;const r=function r(i){if(!i.children||!i.children.length)return null;const o=o$(i,t.olliSpec),a=document.createElement("div"),s=document.createElement("div"),l=document.createElement("select"),u=[...i.children].sort(((t,e)=>{const n=Nq(o.data,t.fullPredicate).length;return Nq(o.data,e.fullPredicate).length-n})),c=u.map((e=>{var n;const r=document.createElement("option");return r.setAttribute("value",e.id),r.innerText=jW(e),(null===(n=t.lastFocusedTreeItem)||void 0===n?void 0:n.olliNode.id.startsWith(e.id))&&r.setAttribute("selected","selected"),r}));return l.replaceChildren(...c),l.onchange=()=>{n=l.value,e.setAttribute("data-state",n);const i=r(t.olliNodeLookup[n]);i?s.replaceChildren(i):s.replaceChildren()},l.onchange(null),a.replaceChildren(l,s),a}(t.rootTreeItem.olliNode);return e.replaceChildren(r),e}(t);s$(a$(t,"Targeted Navigation Menu","Jump to a location in this chart.",e,{onOk:()=>{const n=e.getAttribute("data-state"),r=t.treeItems.find((t=>t.olliNode.id===n));r&&t.setFocusToItem(r)}}),t.renderContainer)}(this.tree);break;default:return}t.stopPropagation(),t.preventDefault()}handleClick(t){this.isExpandable?(this.isExpanded()?this.tree.collapseTreeItem(this):this.tree.expandTreeItem(this),t.stopPropagation()):(this.tree.setFocusToItem(this),t.stopPropagation())}handleFocus(){let t=this.domNode;this.isExpandable&&(t=t.firstElementChild),t.classList.add("focus")}handleBlur(){let t=this.domNode;this.isExpandable&&(t=t.firstElementChild),t.classList.remove("focus")}handleMouseOver(t){t.currentTarget.classList.add("hover")}handleMouseOut(t){t.currentTarget.classList.remove("hover")}}var u$=n(370),c$={};c$.styleTagTransform=JW(),c$.setAttributes=VW(),c$.insert=ZW().bind(null,"head"),c$.domAPI=$W(),c$.insertStyleElement=XW(),IW()(u$.Z,c$),u$.Z&&u$.Z.locals&&u$.Z.locals;class f${constructor(t,e,n){this.olliSpec=t,this.renderContainer=e,this.callbacks=n,this.treeItems=[]}init(){var t;const e=null===(t=this.lastFocusedTreeItem)||void 0===t?void 0:t.olliNode,n=function(t){const e=(Math.random()+1).toString(36).substring(7);function n(t){return 1!==t.length||["xAxis","yAxis"].includes(t[0].nodeType)?(t.forEach((function t(e){e.level=e.level+1,e.children.forEach(t)})),{id:e,nodeType:"root",fullPredicate:{and:[]},description:new Map,children:t,level:1}):t[0]}function r(t,e,n,i,o,a,s){return n?n.map(((n,l)=>{var u;if("groupby"in n){const c=function(t,e){var n,r,i;if(t===e.facet)return"root";const o=null===(n=e.axes)||void 0===n?void 0:n.find((e=>e.field===t));if(o)switch(o.axisType){case"x":return"xAxis";case"y":return"yAxis"}return(null===(r=e.legends)||void 0===r?void 0:r.find((e=>e.field===t)))?"legend":(null===(i=e.guides)||void 0===i?void 0:i.find((e=>e.field===t)))?"guide":"other"}(n.groupby,t),f=null===(u=t.axes)||void 0===u?void 0:u.find((t=>t.field===n.groupby)),d=function(t,e,n,r){const i=zq(t,n);if("nominal"===i.type||"ordinal"===i.type||i.timeUnit)return Oq(i,e).map((e=>({field:t,equal:yq(e,i)})));{const i=function(t,e,n,r,i){const o=TW(t,e,n,r,void 0);return o.map(((e,n)=>({field:t,range:e,inclusive:n===o.length-1})))}(t,e,n,r);return i}}(n.groupby,i,t.fields,f?f.ticks:void 0);return{id:"".concat(a,"-").concat(l),fullPredicate:o,nodeType:c,specIndex:e,groupby:n.groupby,description:new Map,children:d.map(((u,f)=>{const d={and:[...o.and,u]},h="".concat(a,"-").concat(l,"-").concat(f);return{id:h,nodeType:"root"===c?"view":"filteredData",viewType:"root"===c?"facet":void 0,specIndex:e,predicate:u,fullPredicate:d,description:new Map,children:r(t,e,n.children,i,d,h,s+2),level:s+2}})),level:s+1}}if("predicate"in n){const u=n.predicate,c={and:[...o.and,u]},f="".concat(a,"-").concat(l);return{id:f,nodeType:"filteredData",specIndex:e,fullPredicate:c,predicate:u,description:new Map,children:r(t,e,n.children,i,c,f,s+1),level:s+1}}if("annotations"in n){const u="".concat(a,"-").concat(l);return{id:u,fullPredicate:o,nodeType:"annotations",specIndex:e,description:new Map,children:r(t,e,n.annotations,i,o,u,s+1),level:s+1}}throw new Error("Invalid node type")})):[]}if(r$(t)){const i=n(t.units.map(((n,i)=>{const o=r(n,i,Array.isArray(n.structure)?n.structure:[n.structure],n.selection?Nq(n.data,n.selection):n.data,{and:[]},"".concat(e,"-").concat(i),1);return{id:"".concat(e,"-").concat(i),nodeType:"view",viewType:t.operator,specIndex:i,fullPredicate:{and:[]},description:new Map,children:o,level:1}})));return i$(i,t),i}{const i=Array.isArray(t.structure)?t.structure:[t.structure],o=t.selection?Nq(t.data,t.selection):t.data,a=n(r(t,void 0,i,o,{and:[]},e,0));return i$(a,t),a}}(this.olliSpec);this.olliNodeLookup=function(t){const e={},n=[t];for(;n.length>0;){const t=n.shift();e[t.id]=t,n.push(...t.children)}return e}(n);const r=function(t){var e;const n=document.createElement("ul"),r="".concat(t.id,"-label");return n.setAttribute("role","tree"),n.setAttribute("aria-labelledby",r),n.appendChild(function t(e,n,r,i){const o=document.createElement("li");o.setAttribute("role","treeitem"),o.setAttribute("aria-level",String(n)),o.setAttribute("aria-setsize",String(i)),o.setAttribute("aria-posinset",String(r)),o.setAttribute("id",e.id);const a=document.createElement("span");if(a.innerText=jW(e),o.appendChild(a),e.children.length){const r=document.createElement("ul");r.setAttribute("role","group"),e.children.forEach(((e,i,o)=>{r.appendChild(t(e,n+1,i+1,o.length))})),o.appendChild(r)}return o}(t,1,1,1)),null===(e=n.querySelector("span"))||void 0===e||e.setAttribute("id",r),n}(n);if(this.rootDomNode=r,this.renderContainer.replaceChildren(r),this.treeItems=[],function t(e,n,r,i){let o=e.firstElementChild,a=i;for(;o;)"li"===o.tagName.toLowerCase()&&(a=new l$(o,n,r[o.id],i),a.init(),i&&i.children.push(a),n.treeItems.push(a)),o.firstElementChild&&t(o,n,r,a),o=o.nextElementSibling}(this.rootDomNode,this,this.olliNodeLookup,void 0),this.rootTreeItem=this.treeItems[0],this.rootTreeItem.domNode.tabIndex=0,e)if("root"===e.nodeType)this.setFocusToItem(this.rootTreeItem);else{const t=this.treeItems.filter((t=>t.olliNode.nodeType===e.nodeType));if("groupby"in e){const n=t.find((t=>t.olliNode.groupby===e.groupby));this.setFocusToItem(n||this.rootTreeItem)}else if("predicate"in e){const n=o$(e,this.olliSpec),r=t.filter((t=>"predicate"in t.olliNode)),i=Nq(n.data,{and:[n.selection,e.predicate]}),o=r.find((t=>Nq(n.data,{and:[n.selection,t.olliNode.predicate]}).some((t=>i.includes(t)))));this.setFocusToItem(o||this.rootTreeItem)}else this.setFocusToItem(this.rootTreeItem)}}renderTreeDescription(){!function t(e,n){if(e.children.length)for(const r of e.children){const e=r.firstElementChild;n[r.id]&&(e.innerText=jW(n[r.id]),r.children[1]&&t(r.children[1],n))}}(this.rootDomNode,this.olliNodeLookup)}setSelection(t){var e;o$(null===(e=this.lastFocusedTreeItem)||void 0===e?void 0:e.olliNode,this.olliSpec).selection=t,this.init()}setFocusToItem(t){for(var e=0;e<this.treeItems.length;e++){var n=this.treeItems[e];n===t?(this.expandParents(n),this.collapseChildren(n),n.domNode.tabIndex=0,n.domNode.focus(),this.lastFocusedTreeItem=n,this.callbacks.onFocus&&this.callbacks.onFocus(n.domNode,n.olliNode),z({lastVisitedInstance:this})):(this.collapseTreeItem(n),n.domNode.tabIndex=-1)}}setFocusToNextItem(t){if(t.parent){const e=t.parent.children.indexOf(t);e<t.parent.children.length-1&&this.setFocusToItem(t.parent.children[e+1])}}setFocusToPreviousItem(t){if(t.parent){let e=t.parent.children.indexOf(t);e>0&&this.setFocusToItem(t.parent.children[e-1])}}getPathFromView(t){if(t.viewType&&("facet"===t.viewType||"layer"===t.viewType))return{view:t,path:""};const e=t.parent.children.indexOf(t),n=this.getPathFromView(t.parent);return Object.assign(Object.assign({},n),{path:n.path+"/"+e})}getNodeForPathFromView(t,e){const n=e.split("/").filter((t=>t.length)).map((t=>parseInt(t,10)));let r=t;for(let i of n)r.children[i]&&(r=r.children[i]);return r}isLateralPossible(){return this.rootTreeItem.children.map((t=>t.olliNode.viewType)).every((t=>"facet"===t||"layer"===t))}setFocusToLateralItem(t,e){const{view:n,path:r}=this.getPathFromView(t.olliNode),i=n.parent.children.indexOf(n),o="left"===e?i-1:i+1;if(o>=0&&o<n.parent.children.length){const e=n.parent.children[o],i=this.getNodeForPathFromView(e,r),a=t.tree.treeItems.find((t=>t.olliNode===i));this.setFocusToItem(a)}}setFocusToNextLayer(t){t.lastVisitedChild?this.setFocusToItem(t.lastVisitedChild):this.setFocusToItem(t.children[0])}setFocusToParentItem(t){t.parent&&(t.parent.lastVisitedChild=t,this.setFocusToItem(t.parent))}setFocusToFirstInLayer(t){t.parent&&this.setFocusToItem(t.parent.children[0])}setFocusToLastInLayer(t){t.parent&&this.setFocusToItem(t.parent.children[t.parent.children.length-1])}expandTreeItem(t){t.isExpandable&&(t.parent&&t.parent.children.forEach((e=>{e!==t&&e.domNode.classList.remove("expanded")})),t.domNode.classList.add("expanded"))}collapseTreeItem(t){t&&t.isExpanded()&&t.domNode.classList.remove("expanded")}expandParents(t){t.parent&&t.parent.isExpandable&&!t.parent.isExpanded()&&(this.expandParents(t.parent),this.expandTreeItem(t.parent))}collapseChildren(t){var e;null===(e=null==t?void 0:t.children)||void 0===e||e.forEach((t=>{t.isExpandable&&t.isExpanded()&&(this.collapseChildren(t),this.collapseTreeItem(t))})),this.collapseTreeItem(t)}focusOnNodeType(t,e){let n=e;for(;n;){if(n.olliNode.nodeType===t){this.setFocusToItem(n);break}n=n.parent}}}var d$=n(879),h$=n.n(d$);function p$(t,e){const n=t.map((t=>t[e]));var r,i={boolean:function(t){return"true"===t||"false"===t||!0===(e=t)||!1===e||"[object Boolean]"==toString.call(e);var e},integer:function(t){return i.number(t)&&(t=+t)==~~t},number:function(t){return!(isNaN(+t)||(e=t,"[object Date]"===toString.call(e)));var e},date:function(t){return h$()(t).isValid()}},o=["boolean","integer","number","date"];for(let a=0;a<n.length;++a){const t=n[a];for(let e=0;e<o.length;++e)null==(r=t)||r!=r||i[o[e]](t)||(o.splice(e,1),e-=1);if(0===o.length)break}switch(o.length?o[0]:"string"){case"boolean":case"string":return"nominal";case"integer":const t=.05,e=40,r=new Set(n).size;return r<e&&r/n.length<t?"nominal":"quantitative";case"number":return"quantitative";case"date":return"temporal"}}function m$(t){return t.fields=t.fields||Object.keys(t.data[0]).map((t=>({field:t}))),t.fields=t.fields.map((e=>Object.assign(Object.assign({},e),{type:e.type||p$(t.data,e.field)}))),t.structure&&0!==[t.structure].flat().length||(t.structure=function(t){var e,n,r,i,o,a,s;function l(t,e,n){let r=[];return t&&(r=r.concat(t.map((t=>({groupby:t.field,children:[]}))))),e&&(r=r.concat(e.map((t=>({groupby:t.field,children:[]}))))),n&&(r=r.concat(n.map((t=>({groupby:t.field,children:[]}))))),r.filter(((t,e,n)=>!("groupby"in t)||n.findIndex((e=>"groupby"in e&&e.groupby===t.groupby))===e))}if(t.facet)return(null===(e=t.axes)||void 0===e?void 0:e.length)||(null===(n=t.legends)||void 0===n?void 0:n.length)?{groupby:t.facet,children:l(t.axes,t.legends,t.guides)}:{groupby:t.facet,children:t.fields.filter((e=>e.field!==t.facet)).map((t=>({groupby:t.field})))};if("line"!==t.mark||!(null===(r=t.legends)||void 0===r?void 0:r.length)){if("bar"===t.mark){if(null===(i=t.axes)||void 0===i?void 0:i.length){const e=null===(o=t.axes)||void 0===o?void 0:o.find((e=>{const n=zq(e.field,t.fields);return"quantitative"===n.type&&!n.bin}));return l(t.axes.filter((t=>t!==e)),t.legends)}{const e=t.fields.find((t=>"quantitative"===t.type));return t.fields.filter((t=>t!==e)).map((t=>({groupby:t.field,children:[]})))}}return(null===(a=t.axes)||void 0===a?void 0:a.length)||(null===(s=t.legends)||void 0===s?void 0:s.length)?l(t.axes,t.legends):t.fields.map((t=>({groupby:t.field,children:[]})))}{const e=t.legends.find((t=>"color"===t.channel));if(e)return{groupby:e.field,children:l(t.axes,t.legends.filter((t=>t!==e)),t.guides)}}}(t)),t}function g$(t,e){t=function(t){return r$(t)?Object.assign(Object.assign({},t),{units:t.units.map((t=>m$(t)))}):m$(t)}(t);const n=document.createElement("div");n.classList.add("olli-vis");const r={onFocus:null==e?void 0:e.onFocus,onSelection:null==e?void 0:e.onSelection},i=new f$(t,n,r);return i.init(),R(i),n}})(),_})(),t.exports=_()},888:(t,e,n)=>{"use strict";var r=n(47);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},7:(t,e,n)=>{t.exports=n(888)()},47:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},463:(t,e,n)=>{"use strict";var r=n(791),i=n(296);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(t,e){u(t,e),u(t+"Capture",e)}function u(t,e){for(s[t]=e,t=0;t<e.length;t++)a.add(e[t])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function m(t,e,n,r,i,o,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){g[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];g[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){g[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){g[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){g[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){g[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){g[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){g[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){g[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function b(t,e,n,r){var i=g.hasOwnProperty(e)?g[e]:null;(null!==i?0!==i.type:r||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!f.call(p,t)||!f.call(h,t)&&(d.test(t)?p[t]=!0:(h[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),C=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var z=Symbol.iterator;function R(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=z&&t[z]||t["@@iterator"])?t:null}var P,B=Object.assign;function L(t){if(void 0===P)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);P=e&&e[1]||""}return"\n"+P+t}var j=!1;function U(t,e){if(!t||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=s);break}}}finally{j=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?L(t):""}function q(t){switch(t.tag){case 5:return L(t.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return t=U(t.type,!1);case 11:return t=U(t.type.render,!1);case 1:return t=U(t.type,!0);default:return""}}function I(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case k:return"Fragment";case w:return"Portal";case E:return"Profiler";case A:return"StrictMode";case D:return"Suspense";case F:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case C:return(t.displayName||"Context")+".Consumer";case M:return(t._context.displayName||"Context")+".Provider";case S:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case T:return null!==(e=t.displayName||null)?e:I(t.type)||"Memo";case N:e=t._payload,t=t._init;try{return I(t(e))}catch(n){}}return null}function W(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(e);case 8:return e===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function $(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function H(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Z(t){t._valueTracker||(t._valueTracker=function(t){var e=H(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Y(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=H(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function V(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function G(t,e){var n=e.checked;return B({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function X(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=$(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Q(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function J(t,e){Q(t,e);var n=$(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,$(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function K(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&V(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function rt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return B({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function it(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(et(n)){if(1<n.length)throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:$(n)}}function ot(t,e){var n=$(e.value),r=$(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function at(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ut,ct,ft=(ct=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ut=ut||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ut.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return ct(t,e)}))}:ct);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ht={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ht.hasOwnProperty(t)&&ht[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=mt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(ht).forEach((function(t){pt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ht[e]=ht[t]}))}));var yt=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function bt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=null;function _t(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var wt=null,kt=null,At=null;function Et(t){if(t=bi(t)){if("function"!==typeof wt)throw Error(o(280));var e=t.stateNode;e&&(e=_i(e),wt(t.stateNode,t.type,e))}}function Mt(t){kt?At?At.push(t):At=[t]:kt=t}function Ct(){if(kt){var t=kt,e=At;if(At=kt=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function St(t,e){return t(e)}function Dt(){}var Ft=!1;function Tt(t,e,n){if(Ft)return t(e,n);Ft=!0;try{return St(t,e,n)}finally{Ft=!1,(null!==kt||null!==At)&&(Dt(),Ct())}}function Nt(t,e){var n=t.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(o(231,e,typeof n));return n}var Ot=!1;if(c)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){Ot=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch(ct){Ot=!1}function Rt(t,e,n,r,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Pt=!1,Bt=null,Lt=!1,jt=null,Ut={onError:function(t){Pt=!0,Bt=t}};function qt(t,e,n,r,i,o,a,s,l){Pt=!1,Bt=null,Rt.apply(Ut,arguments)}function It(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Wt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function $t(t){if(It(t)!==t)throw Error(o(188))}function Ht(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=It(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return $t(i),t;if(a===r)return $t(i),e;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t))?Zt(t):null}function Zt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Zt(t);if(null!==e)return e;t=t.sibling}return null}var Yt=i.unstable_scheduleCallback,Vt=i.unstable_cancelCallback,Gt=i.unstable_shouldYield,Xt=i.unstable_requestPaint,Qt=i.unstable_now,Jt=i.unstable_getCurrentPriorityLevel,Kt=i.unstable_ImmediatePriority,te=i.unstable_UserBlockingPriority,ee=i.unstable_NormalPriority,ne=i.unstable_LowPriority,re=i.unstable_IdlePriority,ie=null,oe=null;var ae=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(se(t)/le|0)|0},se=Math.log,le=Math.LN2;var ue=64,ce=4194304;function fe(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=fe(s):0!==(o&=a)&&(r=fe(o))}else 0!==(a=n&~i)?r=fe(a):0!==o&&(r=fe(o));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&i)&&((i=r&-r)>=(o=e&-e)||16===i&&0!==(4194240&o)))return e;if(0!==(4&r)&&(r|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)i=1<<(n=31-ae(e)),r|=t[n],e&=~i;return r}function he(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=ue;return 0===(4194240&(ue<<=1))&&(ue=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ye(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-ae(e)]=n}function ve(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ae(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var be=0;function xe(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var _e,we,ke,Ae,Ee,Me=!1,Ce=[],Se=null,De=null,Fe=null,Te=new Map,Ne=new Map,Oe=[],ze="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Re(t,e){switch(t){case"focusin":case"focusout":Se=null;break;case"dragenter":case"dragleave":De=null;break;case"mouseover":case"mouseout":Fe=null;break;case"pointerover":case"pointerout":Te.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ne.delete(e.pointerId)}}function Pe(t,e,n,r,i,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==e&&(null!==(e=bi(e))&&we(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==i&&-1===e.indexOf(i)&&e.push(i),t)}function Be(t){var e=vi(t.target);if(null!==e){var n=It(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Wt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){ke(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Le(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ge(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=bi(n))&&we(e),t.blockedOn=n,!1;var r=new(n=t.nativeEvent).constructor(n.type,n);xt=r,n.target.dispatchEvent(r),xt=null,e.shift()}return!0}function je(t,e,n){Le(t)&&n.delete(e)}function Ue(){Me=!1,null!==Se&&Le(Se)&&(Se=null),null!==De&&Le(De)&&(De=null),null!==Fe&&Le(Fe)&&(Fe=null),Te.forEach(je),Ne.forEach(je)}function qe(t,e){t.blockedOn===e&&(t.blockedOn=null,Me||(Me=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ue)))}function Ie(t){function e(e){return qe(e,t)}if(0<Ce.length){qe(Ce[0],t);for(var n=1;n<Ce.length;n++){var r=Ce[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==Se&&qe(Se,t),null!==De&&qe(De,t),null!==Fe&&qe(Fe,t),Te.forEach(e),Ne.forEach(e),n=0;n<Oe.length;n++)(r=Oe[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Oe.length&&null===(n=Oe[0]).blockedOn;)Be(n),null===n.blockedOn&&Oe.shift()}var We=x.ReactCurrentBatchConfig,$e=!0;function He(t,e,n,r){var i=be,o=We.transition;We.transition=null;try{be=1,Ye(t,e,n,r)}finally{be=i,We.transition=o}}function Ze(t,e,n,r){var i=be,o=We.transition;We.transition=null;try{be=4,Ye(t,e,n,r)}finally{be=i,We.transition=o}}function Ye(t,e,n,r){if($e){var i=Ge(t,e,n,r);if(null===i)$r(t,e,r,Ve,n),Re(t,r);else if(function(t,e,n,r,i){switch(e){case"focusin":return Se=Pe(Se,t,e,n,r,i),!0;case"dragenter":return De=Pe(De,t,e,n,r,i),!0;case"mouseover":return Fe=Pe(Fe,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Te.set(o,Pe(Te.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Ne.set(o,Pe(Ne.get(o)||null,t,e,n,r,i)),!0}return!1}(i,t,e,n,r))r.stopPropagation();else if(Re(t,r),4&e&&-1<ze.indexOf(t)){for(;null!==i;){var o=bi(i);if(null!==o&&_e(o),null===(o=Ge(t,e,n,r))&&$r(t,e,r,Ve,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else $r(t,e,r,null,n)}}var Ve=null;function Ge(t,e,n,r){if(Ve=null,null!==(t=vi(t=_t(r))))if(null===(e=It(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Wt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ve=t,null}function Xe(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jt()){case Kt:return 1;case te:return 4;case ee:case ne:return 16;case re:return 536870912;default:return 16}default:return 16}}var Qe=null,Je=null,Ke=null;function tn(){if(Ke)return Ke;var t,e,n=Je,r=n.length,i="value"in Qe?Qe.value:Qe.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return Ke=i.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function on(t){function e(e,n,r,i,o){for(var a in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var an,sn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(un),fn=B({},un,{view:0,detail:0}),dn=on(fn),hn=B({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(an=t.screenX-ln.screenX,sn=t.screenY-ln.screenY):sn=an=0,ln=t),an)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),pn=on(hn),mn=on(B({},hn,{dataTransfer:0})),gn=on(B({},fn,{relatedTarget:0})),yn=on(B({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=B({},un,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bn=on(vn),xn=on(B({},un,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function An(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=kn[t])&&!!e[t]}function En(){return An}var Mn=B({},fn,{key:function(t){if(t.key){var e=_n[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Cn=on(Mn),Sn=on(B({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Dn=on(B({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Fn=on(B({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=B({},hn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=on(Tn),On=[9,13,27,32],zn=c&&"CompositionEvent"in window,Rn=null;c&&"documentMode"in document&&(Rn=document.documentMode);var Pn=c&&"TextEvent"in window&&!Rn,Bn=c&&(!zn||Rn&&8<Rn&&11>=Rn),Ln=String.fromCharCode(32),jn=!1;function Un(t,e){switch(t){case"keyup":return-1!==On.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var In=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $n(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function Hn(t,e,n,r){Mt(r),0<(e=Zr(e,"onChange")).length&&(n=new cn("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Zn=null,Yn=null;function Vn(t){Lr(t,0)}function Gn(t){if(Y(xi(t)))return t}function Xn(t,e){if("change"===t)return e}var Qn=!1;if(c){var Jn;if(c){var Kn="oninput"in document;if(!Kn){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),Kn="function"===typeof tr.oninput}Jn=Kn}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function er(){Zn&&(Zn.detachEvent("onpropertychange",nr),Yn=Zn=null)}function nr(t){if("value"===t.propertyName&&Gn(Yn)){var e=[];Hn(e,Yn,t,_t(t)),Tt(Vn,e)}}function rr(t,e,n){"focusin"===t?(er(),Yn=n,(Zn=e).attachEvent("onpropertychange",nr)):"focusout"===t&&er()}function ir(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Gn(Yn)}function or(t,e){if("click"===t)return Gn(e)}function ar(t,e){if("input"===t||"change"===t)return Gn(e)}var sr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function lr(t,e){if(sr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!f.call(e,i)||!sr(t[i],e[i]))return!1}return!0}function ur(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function cr(t,e){var n,r=ur(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=ur(r)}}function fr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?fr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dr(){for(var t=window,e=V();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=V((t=e.contentWindow).document)}return e}function hr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pr(t){var e=dr(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(e=r.start,void 0===(t=r.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=cr(n,o);var a=cr(n,r);i&&a&&(1!==t.rangeCount||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function xr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==V(r)||("selectionStart"in(r=gr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Zr(yr,"onSelect")).length&&(e=new cn("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gr)))}function _r(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},kr={},Ar={};function Er(t){if(kr[t])return kr[t];if(!wr[t])return t;var e,n=wr[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ar)return kr[t]=n[e];return t}c&&(Ar=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Mr=Er("animationend"),Cr=Er("animationiteration"),Sr=Er("animationstart"),Dr=Er("transitionend"),Fr=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(t,e){Fr.set(t,e),l(e,[t])}for(var Or=0;Or<Tr.length;Or++){var zr=Tr[Or];Nr(zr.toLowerCase(),"on"+(zr[0].toUpperCase()+zr.slice(1)))}Nr(Mr,"onAnimationEnd"),Nr(Cr,"onAnimationIteration"),Nr(Sr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(Dr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Br(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,i,a,s,l,u){if(qt.apply(this,arguments),Pt){if(!Pt)throw Error(o(198));var c=Bt;Pt=!1,Bt=null,Lt||(Lt=!0,jt=c)}}(r,e,void 0,t),t.currentTarget=null}function Lr(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;t:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break t;Br(i,s,u),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,u=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break t;Br(i,s,u),o=l}}}if(Lt)throw t=jt,Lt=!1,jt=null,t}function jr(t,e){var n=e[mi];void 0===n&&(n=e[mi]=new Set);var r=t+"__bubble";n.has(r)||(Wr(e,t,2,!1),n.add(r))}function Ur(t,e,n){var r=0;e&&(r|=4),Wr(n,t,r,e)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Ir(t){if(!t[qr]){t[qr]=!0,a.forEach((function(e){"selectionchange"!==e&&(Pr.has(e)||Ur(e,!1,t),Ur(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[qr]||(e[qr]=!0,Ur("selectionchange",!1,e))}}function Wr(t,e,n,r){switch(Xe(e)){case 1:var i=He;break;case 4:i=Ze;break;default:i=Ye}n=i.bind(null,e,n,t),i=void 0,!Ot||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(i=!0),r?void 0!==i?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):void 0!==i?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function $r(t,e,n,r,i){var o=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=vi(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue t}s=s.parentNode}}r=r.return}Tt((function(){var r=o,i=_t(n),a=[];t:{var s=Fr.get(t);if(void 0!==s){var l=cn,u=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=Cn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Dn;break;case Mr:case Cr:case Sr:l=yn;break;case Dr:l=Fn;break;case"scroll":l=dn;break;case"wheel":l=Nn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Sn}var c=0!==(4&e),f=!c&&"scroll"===t,d=c?null!==s?s+"Capture":null:s;c=[];for(var h,p=r;null!==p;){var m=(h=p).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==d&&(null!=(m=Nt(p,d))&&c.push(Hr(p,m,h)))),f)break;p=p.return}0<c.length&&(s=new l(s,u,null,n,i),a.push({event:s,listeners:c}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===xt||!(u=n.relatedTarget||n.fromElement)||!vi(u)&&!u[pi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?vi(u):null)&&(u!==(f=It(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(c=Sn,m="onPointerLeave",d="onPointerEnter",p="pointer"),f=null==l?s:xi(l),h=null==u?s:xi(u),(s=new c(m,p+"leave",l,n,i)).target=f,s.relatedTarget=h,m=null,vi(i)===r&&((c=new c(d,p+"enter",u,n,i)).target=h,c.relatedTarget=f,m=c),f=m,l&&u)t:{for(d=u,p=0,h=c=l;h;h=Yr(h))p++;for(h=0,m=d;m;m=Yr(m))h++;for(;0<p-h;)c=Yr(c),p--;for(;0<h-p;)d=Yr(d),h--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break t;c=Yr(c),d=Yr(d)}c=null}else c=null;null!==l&&Vr(a,s,l,c,!1),null!==u&&null!==f&&Vr(a,f,u,c,!0)}if("select"===(l=(s=r?xi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Xn;else if($n(s))if(Qn)g=ar;else{g=ir;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(t,r))?Hn(a,g,n,i):(y&&y(t,s,r),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&tt(s,"number",s.value)),y=r?xi(r):window,t){case"focusin":($n(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(a,n,i)}var v;if(zn)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else In?Un(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(In||"onCompositionStart"!==b?"onCompositionEnd"===b&&In&&(v=tn()):(Je="value"in(Qe=i)?Qe.value:Qe.textContent,In=!0)),0<(y=Zr(r,b)).length&&(b=new xn(b,t,null,n,i),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=qn(n))&&(b.data=v))),(v=Pn?function(t,e){switch(t){case"compositionend":return qn(e);case"keypress":return 32!==e.which?null:(jn=!0,Ln);case"textInput":return(t=e.data)===Ln&&jn?null:t;default:return null}}(t,n):function(t,e){if(In)return"compositionend"===t||!zn&&Un(t,e)?(t=tn(),Ke=Je=Qe=null,In=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(r=Zr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Lr(a,e)}))}function Hr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zr(t,e){for(var n=e+"Capture",r=[];null!==t;){var i=t,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Nt(t,n))&&r.unshift(Hr(t,o,i)),null!=(o=Nt(t,e))&&r.push(Hr(t,o,i))),t=t.return}return r}function Yr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Vr(t,e,n,r,i){for(var o=e._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(l=Nt(n,o))&&a.unshift(Hr(n,l,s)):i||null!=(l=Nt(n,o))&&a.push(Hr(n,l,s))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}var Gr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Qr(t){return("string"===typeof t?t:""+t).replace(Gr,"\n").replace(Xr,"")}function Jr(t,e,n){if(e=Qr(e),Qr(t)!==e&&n)throw Error(o(425))}function Kr(){}var ti=null,ei=null;function ni(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(t){return oi.resolve(null).then(t).catch(si)}:ri;function si(t){setTimeout((function(){throw t}))}function li(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return t.removeChild(i),void Ie(e);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ie(e)}function ui(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ci(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var fi=Math.random().toString(36).slice(2),di="__reactFiber$"+fi,hi="__reactProps$"+fi,pi="__reactContainer$"+fi,mi="__reactEvents$"+fi,gi="__reactListeners$"+fi,yi="__reactHandles$"+fi;function vi(t){var e=t[di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pi]||n[di]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ci(t);null!==t;){if(n=t[di])return n;t=ci(t)}return e}n=(t=n).parentNode}return null}function bi(t){return!(t=t[di]||t[pi])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function xi(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function _i(t){return t[hi]||null}var wi=[],ki=-1;function Ai(t){return{current:t}}function Ei(t){0>ki||(t.current=wi[ki],wi[ki]=null,ki--)}function Mi(t,e){ki++,wi[ki]=t.current,t.current=e}var Ci={},Si=Ai(Ci),Di=Ai(!1),Fi=Ci;function Ti(t,e){var n=t.type.contextTypes;if(!n)return Ci;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Ni(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Oi(){Ei(Di),Ei(Si)}function zi(t,e,n){if(Si.current!==Ci)throw Error(o(168));Mi(Si,e),Mi(Di,n)}function Ri(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(o(108,W(t)||"Unknown",i));return B({},n,r)}function Pi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ci,Fi=Si.current,Mi(Si,t),Mi(Di,Di.current),!0}function Bi(t,e,n){var r=t.stateNode;if(!r)throw Error(o(169));n?(t=Ri(t,e,Fi),r.__reactInternalMemoizedMergedChildContext=t,Ei(Di),Ei(Si),Mi(Si,t)):Ei(Di),Mi(Di,n)}var Li=null,ji=!1,Ui=!1;function qi(t){null===Li?Li=[t]:Li.push(t)}function Ii(){if(!Ui&&null!==Li){Ui=!0;var t=0,e=be;try{var n=Li;for(be=1;t<n.length;t++){var r=n[t];do{r=r(!0)}while(null!==r)}Li=null,ji=!1}catch(i){throw null!==Li&&(Li=Li.slice(t+1)),Yt(Kt,Ii),i}finally{be=e,Ui=!1}}return null}var Wi=[],$i=0,Hi=null,Zi=0,Yi=[],Vi=0,Gi=null,Xi=1,Qi="";function Ji(t,e){Wi[$i++]=Zi,Wi[$i++]=Hi,Hi=t,Zi=e}function Ki(t,e,n){Yi[Vi++]=Xi,Yi[Vi++]=Qi,Yi[Vi++]=Gi,Gi=t;var r=Xi;t=Qi;var i=32-ae(r)-1;r&=~(1<<i),n+=1;var o=32-ae(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Xi=1<<32-ae(e)+i|n<<i|r,Qi=o+t}else Xi=1<<o|n<<i|r,Qi=t}function to(t){null!==t.return&&(Ji(t,1),Ki(t,1,0))}function eo(t){for(;t===Hi;)Hi=Wi[--$i],Wi[$i]=null,Zi=Wi[--$i],Wi[$i]=null;for(;t===Gi;)Gi=Yi[--Vi],Yi[Vi]=null,Qi=Yi[--Vi],Yi[Vi]=null,Xi=Yi[--Vi],Yi[Vi]=null}var no=null,ro=null,io=!1,oo=null;function ao(t,e){var n=Nu(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function so(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,no=t,ro=ui(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,no=t,ro=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Gi?{id:Xi,overflow:Qi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Nu(18,null,null,0)).stateNode=e,n.return=t,t.child=n,no=t,ro=null,!0);default:return!1}}function lo(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function uo(t){if(io){var e=ro;if(e){var n=e;if(!so(t,e)){if(lo(t))throw Error(o(418));e=ui(n.nextSibling);var r=no;e&&so(t,e)?ao(r,n):(t.flags=-4097&t.flags|2,io=!1,no=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,io=!1,no=t}}}function co(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;no=t}function fo(t){if(t!==no)return!1;if(!io)return co(t),io=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!ni(t.type,t.memoizedProps)),e&&(e=ro)){if(lo(t))throw ho(),Error(o(418));for(;e;)ao(t,e),e=ui(e.nextSibling)}if(co(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ro=ui(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ro=null}}else ro=no?ui(t.stateNode.nextSibling):null;return!0}function ho(){for(var t=ro;t;)t=ui(t.nextSibling)}function po(){ro=no=null,io=!1}function mo(t){null===oo?oo=[t]:oo.push(t)}var go=x.ReactCurrentBatchConfig;function yo(t,e){if(t&&t.defaultProps){for(var n in e=B({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var vo=Ai(null),bo=null,xo=null,_o=null;function wo(){_o=xo=bo=null}function ko(t){var e=vo.current;Ei(vo),t._currentValue=e}function Ao(t,e,n){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Eo(t,e){bo=t,_o=xo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(xs=!0),t.firstContext=null)}function Mo(t){var e=t._currentValue;if(_o!==t)if(t={context:t,memoizedValue:e,next:null},null===xo){if(null===bo)throw Error(o(308));xo=t,bo.dependencies={lanes:0,firstContext:t}}else xo=xo.next=t;return e}var Co=null;function So(t){null===Co?Co=[t]:Co.push(t)}function Do(t,e,n,r){var i=e.interleaved;return null===i?(n.next=n,So(e)):(n.next=i.next,i.next=n),e.interleaved=n,Fo(t,r)}function Fo(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var To=!1;function No(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ro(t,e,n){var r=t.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Dl)){var i=r.pending;return null===i?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Fo(t,n)}return null===(i=r.interleaved)?(e.next=e,So(r)):(e.next=i.next,i.next=e),r.interleaved=e,Fo(t,n)}function Po(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}function Bo(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=e:o=o.next=e}else i=o=e;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Lo(t,e,n,r){var i=t.updateQueue;To=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,u=l.next;l.next=null,null===a?o=u:a.next=u,a=l;var c=t.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(null!==o){var f=i.baseState;for(a=0,c=u=l=null,s=o;;){var d=s.lane,h=s.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var p=t,m=s;switch(d=e,h=n,m.tag){case 1:if("function"===typeof(p=m.payload)){f=p.call(h,f,d);break t}f=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(h,f,d):p)||void 0===d)break t;f=B({},f,d);break t;case 2:To=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else h={eventTime:h,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=h,l=f):c=c.next=h,a|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===c&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(e=i.shared.interleaved)){i=e;do{a|=i.lane,i=i.next}while(i!==e)}else null===o&&(i.shared.lanes=0);Bl|=a,t.lanes=a,t.memoizedState=f}}function jo(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Uo=(new r.Component).refs;function qo(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:B({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var Io={isMounted:function(t){return!!(t=t._reactInternals)&&It(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=eu(),i=nu(t),o=zo(r,i);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=Ro(t,o,i))&&(ru(e,t,i,r),Po(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=eu(),i=nu(t),o=zo(r,i);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=Ro(t,o,i))&&(ru(e,t,i,r),Po(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=eu(),r=nu(t),i=zo(n,r);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),null!==(e=Ro(t,i,r))&&(ru(e,t,r,n),Po(e,t,r))}};function Wo(t,e,n,r,i,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,o))}function $o(t,e,n){var r=!1,i=Ci,o=e.contextType;return"object"===typeof o&&null!==o?o=Mo(o):(i=Ni(e)?Fi:Si.current,o=(r=null!==(r=e.contextTypes)&&void 0!==r)?Ti(t,i):Ci),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Io,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Ho(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Io.enqueueReplaceState(e,e.state,null)}function Zo(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=Uo,No(t);var o=e.contextType;"object"===typeof o&&null!==o?i.context=Mo(o):(o=Ni(e)?Fi:Si.current,i.context=Ti(t,o)),i.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(qo(t,e,o,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&Io.enqueueReplaceState(i,i.state,null),Lo(t,n,i,r),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308)}function Yo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,t));var i=r,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=i.refs;e===Uo&&(e=i.refs={}),null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function Vo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Go(t){return(0,t._init)(t._payload)}function Xo(t){function e(e,n){if(t){var r=e.deletions;null===r?(e.deletions=[n],e.flags|=16):r.push(n)}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=zu(t,e)).index=0,t.sibling=null,t}function a(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags|=2,n):r:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,r){return null===e||6!==e.tag?((e=Lu(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function u(t,e,n,r){var o=n.type;return o===k?f(t,e,n.props.children,r,n.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===N&&Go(o)===e.type)?((r=i(e,n.props)).ref=Yo(t,e,n),r.return=t,r):((r=Ru(n.type,n.key,n.props,null,t.mode,r)).ref=Yo(t,e,n),r.return=t,r)}function c(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=ju(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function f(t,e,n,r,o){return null===e||7!==e.tag?((e=Pu(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Lu(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case _:return(n=Ru(e.type,e.key,e.props,null,t.mode,n)).ref=Yo(t,null,e),n.return=t,n;case w:return(e=ju(e,t.mode,n)).return=t,e;case N:return d(t,(0,e._init)(e._payload),n)}if(et(e)||R(e))return(e=Pu(e,t.mode,n,null)).return=t,e;Vo(t,e)}return null}function h(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?u(t,e,n,r):null;case w:return n.key===i?c(t,e,n,r):null;case N:return h(t,e,(i=n._init)(n._payload),r)}if(et(n)||R(n))return null!==i?null:f(t,e,n,r,null);Vo(t,n)}return null}function p(t,e,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return u(e,t=t.get(null===r.key?n:r.key)||null,r,i);case w:return c(e,t=t.get(null===r.key?n:r.key)||null,r,i);case N:return p(t,e,n,(0,r._init)(r._payload),i)}if(et(r)||R(r))return f(e,t=t.get(n)||null,r,i,null);Vo(e,r)}return null}function m(i,o,s,l){for(var u=null,c=null,f=o,m=o=0,g=null;null!==f&&m<s.length;m++){f.index>m?(g=f,f=null):g=f.sibling;var y=h(i,f,s[m],l);if(null===y){null===f&&(f=g);break}t&&f&&null===y.alternate&&e(i,f),o=a(y,o,m),null===c?u=y:c.sibling=y,c=y,f=g}if(m===s.length)return n(i,f),io&&Ji(i,m),u;if(null===f){for(;m<s.length;m++)null!==(f=d(i,s[m],l))&&(o=a(f,o,m),null===c?u=f:c.sibling=f,c=f);return io&&Ji(i,m),u}for(f=r(i,f);m<s.length;m++)null!==(g=p(f,i,m,s[m],l))&&(t&&null!==g.alternate&&f.delete(null===g.key?m:g.key),o=a(g,o,m),null===c?u=g:c.sibling=g,c=g);return t&&f.forEach((function(t){return e(i,t)})),io&&Ji(i,m),u}function g(i,s,l,u){var c=R(l);if("function"!==typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var f=c=null,m=s,g=s=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=h(i,m,v.value,u);if(null===b){null===m&&(m=y);break}t&&m&&null===b.alternate&&e(i,m),s=a(b,s,g),null===f?c=b:f.sibling=b,f=b,m=y}if(v.done)return n(i,m),io&&Ji(i,g),c;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,u))&&(s=a(v,s,g),null===f?c=v:f.sibling=v,f=v);return io&&Ji(i,g),c}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,u))&&(t&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=a(v,s,g),null===f?c=v:f.sibling=v,f=v);return t&&m.forEach((function(t){return e(i,t)})),io&&Ji(i,g),c}return function t(r,o,a,l){if("object"===typeof a&&null!==a&&a.type===k&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case _:t:{for(var u=a.key,c=o;null!==c;){if(c.key===u){if((u=a.type)===k){if(7===c.tag){n(r,c.sibling),(o=i(c,a.props.children)).return=r,r=o;break t}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===N&&Go(u)===c.type){n(r,c.sibling),(o=i(c,a.props)).ref=Yo(r,c,a),o.return=r,r=o;break t}n(r,c);break}e(r,c),c=c.sibling}a.type===k?((o=Pu(a.props.children,r.mode,l,a.key)).return=r,r=o):((l=Ru(a.type,a.key,a.props,null,r.mode,l)).ref=Yo(r,o,a),l.return=r,r=l)}return s(r);case w:t:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break t}n(r,o);break}e(r,o),o=o.sibling}(o=ju(a,r.mode,l)).return=r,r=o}return s(r);case N:return t(r,o,(c=a._init)(a._payload),l)}if(et(a))return m(r,o,a,l);if(R(a))return g(r,o,a,l);Vo(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Lu(a,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var Qo=Xo(!0),Jo=Xo(!1),Ko={},ta=Ai(Ko),ea=Ai(Ko),na=Ai(Ko);function ra(t){if(t===Ko)throw Error(o(174));return t}function ia(t,e){switch(Mi(na,e),Mi(ea,t),Mi(ta,Ko),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ei(ta),Mi(ta,e)}function oa(){Ei(ta),Ei(ea),Ei(na)}function aa(t){ra(na.current);var e=ra(ta.current),n=lt(e,t.type);e!==n&&(Mi(ea,t),Mi(ta,n))}function sa(t){ea.current===t&&(Ei(ta),Ei(ea))}var la=Ai(0);function ua(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ca=[];function fa(){for(var t=0;t<ca.length;t++)ca[t]._workInProgressVersionPrimary=null;ca.length=0}var da=x.ReactCurrentDispatcher,ha=x.ReactCurrentBatchConfig,pa=0,ma=null,ga=null,ya=null,va=!1,ba=!1,xa=0,_a=0;function wa(){throw Error(o(321))}function ka(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function Aa(t,e,n,r,i,a){if(pa=a,ma=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,da.current=null===t||null===t.memoizedState?ss:ls,t=n(r,i),ba){a=0;do{if(ba=!1,xa=0,25<=a)throw Error(o(301));a+=1,ya=ga=null,e.updateQueue=null,da.current=us,t=n(r,i)}while(ba)}if(da.current=as,e=null!==ga&&null!==ga.next,pa=0,ya=ga=ma=null,va=!1,e)throw Error(o(300));return t}function Ea(){var t=0!==xa;return xa=0,t}function Ma(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ya?ma.memoizedState=ya=t:ya=ya.next=t,ya}function Ca(){if(null===ga){var t=ma.alternate;t=null!==t?t.memoizedState:null}else t=ga.next;var e=null===ya?ma.memoizedState:ya.next;if(null!==e)ya=e,ga=t;else{if(null===t)throw Error(o(310));t={memoizedState:(ga=t).memoizedState,baseState:ga.baseState,baseQueue:ga.baseQueue,queue:ga.queue,next:null},null===ya?ma.memoizedState=ya=t:ya=ya.next=t}return ya}function Sa(t,e){return"function"===typeof e?e(t):e}function Da(t){var e=Ca(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var r=ga,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=s=null,u=null,c=a;do{var f=c.lane;if((pa&f)===f)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=d,s=r):u=u.next=d,ma.lanes|=f,Bl|=f}c=c.next}while(null!==c&&c!==a);null===u?s=r:u.next=l,sr(r,e.memoizedState)||(xs=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=u,n.lastRenderedState=r}if(null!==(t=n.interleaved)){i=t;do{a=i.lane,ma.lanes|=a,Bl|=a,i=i.next}while(i!==t)}else null===i&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Fa(t){var e=Ca(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=t(a,s.action),s=s.next}while(s!==i);sr(a,e.memoizedState)||(xs=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Ta(){}function Na(t,e){var n=ma,r=Ca(),i=e(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,xs=!0),r=r.queue,$a(Ra.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||null!==ya&&1&ya.memoizedState.tag){if(n.flags|=2048,ja(9,za.bind(null,n,r,i,e),void 0,null),null===Fl)throw Error(o(349));0!==(30&pa)||Oa(n,e,i)}return i}function Oa(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=ma.updateQueue)?(e={lastEffect:null,stores:null},ma.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function za(t,e,n,r){e.value=n,e.getSnapshot=r,Pa(e)&&Ba(t)}function Ra(t,e,n){return n((function(){Pa(e)&&Ba(t)}))}function Pa(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch(r){return!0}}function Ba(t){var e=Fo(t,1);null!==e&&ru(e,t,1,-1)}function La(t){var e=Ma();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sa,lastRenderedState:t},e.queue=t,t=t.dispatch=ns.bind(null,ma,t),[e.memoizedState,t]}function ja(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=ma.updateQueue)?(e={lastEffect:null,stores:null},ma.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function Ua(){return Ca().memoizedState}function qa(t,e,n,r){var i=Ma();ma.flags|=t,i.memoizedState=ja(1|e,n,void 0,void 0===r?null:r)}function Ia(t,e,n,r){var i=Ca();r=void 0===r?null:r;var o=void 0;if(null!==ga){var a=ga.memoizedState;if(o=a.destroy,null!==r&&ka(r,a.deps))return void(i.memoizedState=ja(e,n,o,r))}ma.flags|=t,i.memoizedState=ja(1|e,n,o,r)}function Wa(t,e){return qa(8390656,8,t,e)}function $a(t,e){return Ia(2048,8,t,e)}function Ha(t,e){return Ia(4,2,t,e)}function Za(t,e){return Ia(4,4,t,e)}function Ya(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Va(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Ia(4,4,Ya.bind(null,e,t),n)}function Ga(){}function Xa(t,e){var n=Ca();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&ka(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Qa(t,e){var n=Ca();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&ka(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ja(t,e,n){return 0===(21&pa)?(t.baseState&&(t.baseState=!1,xs=!0),t.memoizedState=n):(sr(n,e)||(n=me(),ma.lanes|=n,Bl|=n,t.baseState=!0),e)}function Ka(t,e){var n=be;be=0!==n&&4>n?n:4,t(!0);var r=ha.transition;ha.transition={};try{t(!1),e()}finally{be=n,ha.transition=r}}function ts(){return Ca().memoizedState}function es(t,e,n){var r=nu(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(t))is(e,n);else if(null!==(n=Do(t,e,n,r))){ru(n,t,r,eu()),os(n,e,r)}}function ns(t,e,n){var r=nu(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(t))is(e,i);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var l=e.interleaved;return null===l?(i.next=i,So(e)):(i.next=l.next,l.next=i),void(e.interleaved=i)}}catch(u){}null!==(n=Do(t,e,i,r))&&(ru(n,t,r,i=eu()),os(n,e,r))}}function rs(t){var e=t.alternate;return t===ma||null!==e&&e===ma}function is(t,e){ba=va=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function os(t,e,n){if(0!==(4194240&n)){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}var as={readContext:Mo,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useInsertionEffect:wa,useLayoutEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useMutableSource:wa,useSyncExternalStore:wa,useId:wa,unstable_isNewReconciler:!1},ss={readContext:Mo,useCallback:function(t,e){return Ma().memoizedState=[t,void 0===e?null:e],t},useContext:Mo,useEffect:Wa,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,qa(4194308,4,Ya.bind(null,e,t),n)},useLayoutEffect:function(t,e){return qa(4194308,4,t,e)},useInsertionEffect:function(t,e){return qa(4,2,t,e)},useMemo:function(t,e){var n=Ma();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ma();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=es.bind(null,ma,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Ma().memoizedState=t},useState:La,useDebugValue:Ga,useDeferredValue:function(t){return Ma().memoizedState=t},useTransition:function(){var t=La(!1),e=t[0];return t=Ka.bind(null,t[1]),Ma().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ma,i=Ma();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=e(),null===Fl)throw Error(o(349));0!==(30&pa)||Oa(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,Wa(Ra.bind(null,r,a,t),[t]),r.flags|=2048,ja(9,za.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=Ma(),e=Fl.identifierPrefix;if(io){var n=Qi;e=":"+e+"R"+(n=(Xi&~(1<<32-ae(Xi)-1)).toString(32)+n),0<(n=xa++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=_a++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ls={readContext:Mo,useCallback:Xa,useContext:Mo,useEffect:$a,useImperativeHandle:Va,useInsertionEffect:Ha,useLayoutEffect:Za,useMemo:Qa,useReducer:Da,useRef:Ua,useState:function(){return Da(Sa)},useDebugValue:Ga,useDeferredValue:function(t){return Ja(Ca(),ga.memoizedState,t)},useTransition:function(){return[Da(Sa)[0],Ca().memoizedState]},useMutableSource:Ta,useSyncExternalStore:Na,useId:ts,unstable_isNewReconciler:!1},us={readContext:Mo,useCallback:Xa,useContext:Mo,useEffect:$a,useImperativeHandle:Va,useInsertionEffect:Ha,useLayoutEffect:Za,useMemo:Qa,useReducer:Fa,useRef:Ua,useState:function(){return Fa(Sa)},useDebugValue:Ga,useDeferredValue:function(t){var e=Ca();return null===ga?e.memoizedState=t:Ja(e,ga.memoizedState,t)},useTransition:function(){return[Fa(Sa)[0],Ca().memoizedState]},useMutableSource:Ta,useSyncExternalStore:Na,useId:ts,unstable_isNewReconciler:!1};function cs(t,e){try{var n="",r=e;do{n+=q(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:i,digest:null}}function fs(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function ds(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=zo(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hl||(Hl=!0,Zl=r),ds(0,e)},n}function ms(t,e,n){(n=zo(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ds(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ds(0,e),"function"!==typeof r&&(null===Yl?Yl=new Set([this]):Yl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function gs(t,e,n){var r=t.pingCache;if(null===r){r=t.pingCache=new hs;var i=new Set;r.set(e,i)}else void 0===(i=r.get(e))&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Mu.bind(null,t,e,n),e.then(t,t))}function ys(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function vs(t,e,n,r,i){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=zo(-1,1)).tag=2,Ro(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=i,t)}var bs=x.ReactCurrentOwner,xs=!1;function _s(t,e,n,r){e.child=null===t?Jo(e,null,n,r):Qo(e,t.child,n,r)}function ws(t,e,n,r,i){n=n.render;var o=e.ref;return Eo(e,i),r=Aa(t,e,n,r,o,i),n=Ea(),null===t||xs?(io&&n&&to(e),e.flags|=1,_s(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Hs(t,e,i))}function ks(t,e,n,r,i){if(null===t){var o=n.type;return"function"!==typeof o||Ou(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ru(n.type,null,r,e,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,As(t,e,o,r,i))}if(o=t.child,0===(t.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&t.ref===e.ref)return Hs(t,e,i)}return e.flags|=1,(t=zu(o,r)).ref=e.ref,t.return=e,e.child=t}function As(t,e,n,r,i){if(null!==t){var o=t.memoizedProps;if(lr(o,r)&&t.ref===e.ref){if(xs=!1,e.pendingProps=r=o,0===(t.lanes&i))return e.lanes=t.lanes,Hs(t,e,i);0!==(131072&t.flags)&&(xs=!0)}}return Cs(t,e,n,r,i)}function Es(t,e,n){var r=e.pendingProps,i=r.children,o=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mi(zl,Ol),Ol|=n;else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Mi(zl,Ol),Ol|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Mi(zl,Ol),Ol|=r}else null!==o?(r=o.baseLanes|n,e.memoizedState=null):r=n,Mi(zl,Ol),Ol|=r;return _s(t,e,i,n),e.child}function Ms(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Cs(t,e,n,r,i){var o=Ni(n)?Fi:Si.current;return o=Ti(e,o),Eo(e,i),n=Aa(t,e,n,r,o,i),r=Ea(),null===t||xs?(io&&r&&to(e),e.flags|=1,_s(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Hs(t,e,i))}function Ss(t,e,n,r,i){if(Ni(n)){var o=!0;Pi(e)}else o=!1;if(Eo(e,i),null===e.stateNode)$s(t,e),$o(e,n,r),Zo(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=Mo(u):u=Ti(e,u=Ni(n)?Fi:Si.current);var c=n.getDerivedStateFromProps,f="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;f||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==u)&&Ho(e,a,r,u),To=!1;var d=e.memoizedState;a.state=d,Lo(e,r,a,i),l=e.memoizedState,s!==r||d!==l||Di.current||To?("function"===typeof c&&(qo(e,n,c,r),l=e.memoizedState),(s=To||Wo(e,n,s,r,d,l,u))?(f||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"===typeof a.componentDidMount&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Oo(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:yo(e.type,s),a.props=u,f=e.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Mo(l):l=Ti(e,l=Ni(n)?Fi:Si.current);var h=n.getDerivedStateFromProps;(c="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==f||d!==l)&&Ho(e,a,r,l),To=!1,d=e.memoizedState,a.state=d,Lo(e,r,a,i);var p=e.memoizedState;s!==f||d!==p||Di.current||To?("function"===typeof h&&(qo(e,n,h,r),p=e.memoizedState),(u=To||Wo(e,n,u,r,d,p,l)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Ds(t,e,n,r,o,i)}function Ds(t,e,n,r,i,o){Ms(t,e);var a=0!==(128&e.flags);if(!r&&!a)return i&&Bi(e,n,!1),Hs(t,e,o);r=e.stateNode,bs.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&a?(e.child=Qo(e,t.child,null,o),e.child=Qo(e,null,s,o)):_s(t,e,s,o),e.memoizedState=r.state,i&&Bi(e,n,!0),e.child}function Fs(t){var e=t.stateNode;e.pendingContext?zi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&zi(0,e.context,!1),ia(t,e.containerInfo)}function Ts(t,e,n,r,i){return po(),mo(i),e.flags|=256,_s(t,e,n,r),e.child}var Ns,Os,zs,Rs,Ps={dehydrated:null,treeContext:null,retryLane:0};function Bs(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ls(t,e,n){var r,i=e.pendingProps,a=la.current,s=!1,l=0!==(128&e.flags);if((r=l)||(r=(null===t||null!==t.memoizedState)&&0!==(2&a)),r?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),Mi(la,1&a),null===t)return uo(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=i.children,t=i.fallback,s?(i=e.mode,s=e.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Bu(l,i,0,null),t=Pu(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Bs(n),e.memoizedState=Ps,t):js(e,l));if(null!==(a=t.memoizedState)&&null!==(r=a.dehydrated))return function(t,e,n,r,i,a,s){if(n)return 256&e.flags?(e.flags&=-257,Us(t,e,s,r=fs(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=Bu({mode:"visible",children:r.children},i,0,null),(a=Pu(a,i,s,null)).flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,0!==(1&e.mode)&&Qo(e,t.child,null,s),e.child.memoizedState=Bs(s),e.memoizedState=Ps,a);if(0===(1&e.mode))return Us(t,e,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Us(t,e,s,r=fs(a=Error(o(419)),r,void 0))}if(l=0!==(s&t.childLanes),xs||l){if(null!==(r=Fl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Fo(t,i),ru(r,t,i,-1))}return gu(),Us(t,e,s,r=fs(Error(o(421))))}return"$?"===i.data?(e.flags|=128,e.child=t.child,e=Su.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,ro=ui(i.nextSibling),no=e,io=!0,oo=null,null!==t&&(Yi[Vi++]=Xi,Yi[Vi++]=Qi,Yi[Vi++]=Gi,Xi=t.id,Qi=t.overflow,Gi=e),e=js(e,r.children),e.flags|=4096,e)}(t,e,l,i,r,a,n);if(s){s=i.fallback,l=e.mode,r=(a=t.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&e.child!==a?((i=e.child).childLanes=0,i.pendingProps=u,e.deletions=null):(i=zu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=zu(r,s):(s=Pu(s,l,n,null)).flags|=2,s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,l=null===(l=t.child.memoizedState)?Bs(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=Ps,i}return t=(s=t.child).sibling,i=zu(s,{mode:"visible",children:i.children}),0===(1&e.mode)&&(i.lanes=n),i.return=e,i.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function js(t,e){return(e=Bu({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Us(t,e,n,r){return null!==r&&mo(r),Qo(e,t.child,null,n),(t=js(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function qs(t,e,n){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),Ao(t.return,e,n)}function Is(t,e,n,r,i){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ws(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(_s(t,e,r.children,n),0!==(2&(r=la.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&qs(t,n,e);else if(19===t.tag)qs(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Mi(la,r),0===(1&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===ua(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Is(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===ua(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Is(e,!0,n,null,o);break;case"together":Is(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $s(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Hs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Bl|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=zu(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=zu(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Zs(t,e){if(!io)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ys(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=t,i=i.sibling;else for(i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Vs(t,e,n){var r=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ys(e),null;case 1:case 17:return Ni(e.type)&&Oi(),Ys(e),null;case 3:return r=e.stateNode,oa(),Ei(Di),Ei(Si),fa(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(fo(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==oo&&(su(oo),oo=null))),Os(t,e),Ys(e),null;case 5:sa(e);var i=ra(na.current);if(n=e.type,null!==t&&null!=e.stateNode)zs(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(o(166));return Ys(e),null}if(t=ra(ta.current),fo(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[di]=e,r[hi]=a,t=0!==(1&e.mode),n){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(i=0;i<Rr.length;i++)jr(Rr[i],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":X(r,a),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},jr("invalid",r);break;case"textarea":it(r,a),jr("invalid",r)}for(var l in vt(n,a),i=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,u,t),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,u,t),i=["children",""+u]):s.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&jr("scroll",r)}switch(n){case"input":Z(r),K(r,a,!0);break;case"textarea":Z(r),at(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Kr)}r=i,e.updateQueue=r,null!==r&&(e.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),"select"===n&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[di]=e,t[hi]=r,Ns(t,e,!1,!1),e.stateNode=t;t:{switch(l=bt(n,r),n){case"dialog":jr("cancel",t),jr("close",t),i=r;break;case"iframe":case"object":case"embed":jr("load",t),i=r;break;case"video":case"audio":for(i=0;i<Rr.length;i++)jr(Rr[i],t);i=r;break;case"source":jr("error",t),i=r;break;case"img":case"image":case"link":jr("error",t),jr("load",t),i=r;break;case"details":jr("toggle",t),i=r;break;case"input":X(t,r),i=G(t,r),jr("invalid",t);break;case"option":default:i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=B({},r,{value:void 0}),jr("invalid",t);break;case"textarea":it(t,r),i=rt(t,r),jr("invalid",t)}for(a in vt(n,i),u=i)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?gt(t,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&ft(t,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&dt(t,c):"number"===typeof c&&dt(t,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&jr("scroll",t):null!=c&&b(t,a,c,l))}switch(n){case"input":Z(t),K(t,r,!1);break;case"textarea":Z(t),at(t);break;case"option":null!=r.value&&t.setAttribute("value",""+$(r.value));break;case"select":t.multiple=!!r.multiple,null!=(a=r.value)?nt(t,!!r.multiple,a,!1):null!=r.defaultValue&&nt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(t.onclick=Kr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Ys(e),null;case 6:if(t&&null!=e.stateNode)Rs(t,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(o(166));if(n=ra(na.current),ra(ta.current),fo(e)){if(r=e.stateNode,n=e.memoizedProps,r[di]=e,(a=r.nodeValue!==n)&&null!==(t=no))switch(t.tag){case 3:Jr(r.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&t.mode))}a&&(e.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=e,e.stateNode=r}return Ys(e),null;case 13:if(Ei(la),r=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&e.mode)&&0===(128&e.flags))ho(),po(),e.flags|=98560,a=!1;else if(a=fo(e),null!==r&&null!==r.dehydrated){if(null===t){if(!a)throw Error(o(318));if(!(a=null!==(a=e.memoizedState)?a.dehydrated:null))throw Error(o(317));a[di]=e}else po(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Ys(e),a=!1}else null!==oo&&(su(oo),oo=null),a=!0;if(!a)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((r=null!==r)!==(null!==t&&null!==t.memoizedState)&&r&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&la.current)?0===Rl&&(Rl=3):gu())),null!==e.updateQueue&&(e.flags|=4),Ys(e),null);case 4:return oa(),Os(t,e),null===t&&Ir(e.stateNode.containerInfo),Ys(e),null;case 10:return ko(e.type._context),Ys(e),null;case 19:if(Ei(la),null===(a=e.memoizedState))return Ys(e),null;if(r=0!==(128&e.flags),null===(l=a.rendering))if(r)Zs(a,!1);else{if(0!==Rl||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=ua(t))){for(e.flags|=128,Zs(a,!1),null!==(r=l.updateQueue)&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;null!==n;)t=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Mi(la,1&la.current|2),e.child}t=t.sibling}null!==a.tail&&Qt()>Wl&&(e.flags|=128,r=!0,Zs(a,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=ua(l))){if(e.flags|=128,r=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Zs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return Ys(e),null}else 2*Qt()-a.renderingStartTime>Wl&&1073741824!==n&&(e.flags|=128,r=!0,Zs(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=a.last)?n.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Qt(),e.sibling=null,n=la.current,Mi(la,r?1&n|2:1&n),e):(Ys(e),null);case 22:case 23:return du(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Ol)&&(Ys(e),6&e.subtreeFlags&&(e.flags|=8192)):Ys(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function Gs(t,e){switch(eo(e),e.tag){case 1:return Ni(e.type)&&Oi(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return oa(),Ei(Di),Ei(Si),fa(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return sa(e),null;case 13:if(Ei(la),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));po()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ei(la),null;case 4:return oa(),null;case 10:return ko(e.type._context),null;case 22:case 23:return du(),null;default:return null}}Ns=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(){},zs=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ra(ta.current);var o,a=null;switch(n){case"input":i=G(t,i),r=G(t,r),a=[];break;case"select":i=B({},i,{value:void 0}),r=B({},r,{value:void 0}),a=[];break;case"textarea":i=rt(t,i),r=rt(t,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(t.onclick=Kr)}for(c in vt(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&jr("scroll",t),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(e.updateQueue=c)&&(e.flags|=4)}},Rs=function(t,e,n,r){n!==r&&(e.flags|=4)};var Xs=!1,Qs=!1,Js="function"===typeof WeakSet?WeakSet:Set,Ks=null;function tl(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Eu(t,e,r)}else n.current=null}function el(t,e,n){try{n()}catch(r){Eu(t,e,r)}}var nl=!1;function rl(t,e,n){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,void 0!==o&&el(e,n,o)}i=i.next}while(i!==r)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ol(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function al(t){var e=t.alternate;null!==e&&(t.alternate=null,al(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[di],delete e[hi],delete e[mi],delete e[gi],delete e[yi])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sl(t){return 5===t.tag||3===t.tag||4===t.tag}function ll(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||sl(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ul(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Kr));else if(4!==r&&null!==(t=t.child))for(ul(t,e,n),t=t.sibling;null!==t;)ul(t,e,n),t=t.sibling}function cl(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(cl(t,e,n),t=t.sibling;null!==t;)cl(t,e,n),t=t.sibling}var fl=null,dl=!1;function hl(t,e,n){for(n=n.child;null!==n;)pl(t,e,n),n=n.sibling}function pl(t,e,n){if(oe&&"function"===typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(ie,n)}catch(s){}switch(n.tag){case 5:Qs||tl(n,e);case 6:var r=fl,i=dl;fl=null,hl(t,e,n),dl=i,null!==(fl=r)&&(dl?(t=fl,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):fl.removeChild(n.stateNode));break;case 18:null!==fl&&(dl?(t=fl,n=n.stateNode,8===t.nodeType?li(t.parentNode,n):1===t.nodeType&&li(t,n),Ie(t)):li(fl,n.stateNode));break;case 4:r=fl,i=dl,fl=n.stateNode.containerInfo,dl=!0,hl(t,e,n),fl=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&el(n,e,a),i=i.next}while(i!==r)}hl(t,e,n);break;case 1:if(!Qs&&(tl(n,e),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Eu(n,e,s)}hl(t,e,n);break;case 21:hl(t,e,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,hl(t,e,n),Qs=r):hl(t,e,n);break;default:hl(t,e,n)}}function ml(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Js),e.forEach((function(e){var r=Du.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function gl(t,e){var n=e.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,s=e,l=s;t:for(;null!==l;){switch(l.tag){case 5:fl=l.stateNode,dl=!1;break t;case 3:case 4:fl=l.stateNode.containerInfo,dl=!0;break t}l=l.return}if(null===fl)throw Error(o(160));pl(a,s,i),fl=null,dl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){Eu(i,e,c)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)yl(e,t),e=e.sibling}function yl(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gl(e,t),vl(t),4&r){try{rl(3,t,t.return),il(3,t)}catch(g){Eu(t,t.return,g)}try{rl(5,t,t.return)}catch(g){Eu(t,t.return,g)}}break;case 1:gl(e,t),vl(t),512&r&&null!==n&&tl(n,n.return);break;case 5:if(gl(e,t),vl(t),512&r&&null!==n&&tl(n,n.return),32&t.flags){var i=t.stateNode;try{dt(i,"")}catch(g){Eu(t,t.return,g)}}if(4&r&&null!=(i=t.stateNode)){var a=t.memoizedProps,s=null!==n?n.memoizedProps:a,l=t.type,u=t.updateQueue;if(t.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Q(i,a),bt(l,s);var c=bt(l,a);for(s=0;s<u.length;s+=2){var f=u[s],d=u[s+1];"style"===f?gt(i,d):"dangerouslySetInnerHTML"===f?ft(i,d):"children"===f?dt(i,d):b(i,f,d,c)}switch(l){case"input":J(i,a);break;case"textarea":ot(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?nt(i,!!a.multiple,p,!1):h!==!!a.multiple&&(null!=a.defaultValue?nt(i,!!a.multiple,a.defaultValue,!0):nt(i,!!a.multiple,a.multiple?[]:"",!1))}i[hi]=a}catch(g){Eu(t,t.return,g)}}break;case 6:if(gl(e,t),vl(t),4&r){if(null===t.stateNode)throw Error(o(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(g){Eu(t,t.return,g)}}break;case 3:if(gl(e,t),vl(t),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ie(e.containerInfo)}catch(g){Eu(t,t.return,g)}break;case 4:default:gl(e,t),vl(t);break;case 13:gl(e,t),vl(t),8192&(i=t.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Il=Qt())),4&r&&ml(t);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&t.mode?(Qs=(c=Qs)||f,gl(e,t),Qs=c):gl(e,t),vl(t),8192&r){if(c=null!==t.memoizedState,(t.stateNode.isHidden=c)&&!f&&0!==(1&t.mode))for(Ks=t,f=t.child;null!==f;){for(d=Ks=f;null!==Ks;){switch(p=(h=Ks).child,h.tag){case 0:case 11:case 14:case 15:rl(4,h,h.return);break;case 1:tl(h,h.return);var m=h.stateNode;if("function"===typeof m.componentWillUnmount){r=h,n=h.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Eu(r,n,g)}}break;case 5:tl(h,h.return);break;case 22:if(null!==h.memoizedState){wl(d);continue}}null!==p?(p.return=h,Ks=p):wl(d)}f=f.sibling}t:for(f=null,d=t;;){if(5===d.tag){if(null===f){f=d;try{i=d.stateNode,c?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=mt("display",s))}catch(g){Eu(t,t.return,g)}}}else if(6===d.tag){if(null===f)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Eu(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(e,t),vl(t),4&r&&ml(t);case 21:}}function vl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(sl(n)){var r=n;break t}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(dt(i,""),r.flags&=-33),cl(t,ll(t),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ul(t,ll(t),a);break;default:throw Error(o(161))}}catch(s){Eu(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function bl(t,e,n){Ks=t,xl(t,e,n)}function xl(t,e,n){for(var r=0!==(1&t.mode);null!==Ks;){var i=Ks,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Xs;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Qs;s=Xs;var u=Qs;if(Xs=a,(Qs=l)&&!u)for(Ks=i;null!==Ks;)l=(a=Ks).child,22===a.tag&&null!==a.memoizedState?kl(i):null!==l?(l.return=a,Ks=l):kl(i);for(;null!==o;)Ks=o,xl(o,e,n),o=o.sibling;Ks=i,Xs=s,Qs=u}_l(t)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Ks=o):_l(t)}}function _l(t){for(;null!==Ks;){var e=Ks;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Qs||il(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!Qs)if(null===n)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:yo(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&jo(e,a,r);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}jo(e,s,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var c=e.alternate;if(null!==c){var f=c.memoizedState;if(null!==f){var d=f.dehydrated;null!==d&&Ie(d)}}}break;default:throw Error(o(163))}Qs||512&e.flags&&ol(e)}catch(h){Eu(e,e.return,h)}}if(e===t){Ks=null;break}if(null!==(n=e.sibling)){n.return=e.return,Ks=n;break}Ks=e.return}}function wl(t){for(;null!==Ks;){var e=Ks;if(e===t){Ks=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Ks=n;break}Ks=e.return}}function kl(t){for(;null!==Ks;){var e=Ks;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{il(4,e)}catch(l){Eu(e,n,l)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var i=e.return;try{r.componentDidMount()}catch(l){Eu(e,i,l)}}var o=e.return;try{ol(e)}catch(l){Eu(e,o,l)}break;case 5:var a=e.return;try{ol(e)}catch(l){Eu(e,a,l)}}}catch(l){Eu(e,e.return,l)}if(e===t){Ks=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Ks=s;break}Ks=e.return}}var Al,El=Math.ceil,Ml=x.ReactCurrentDispatcher,Cl=x.ReactCurrentOwner,Sl=x.ReactCurrentBatchConfig,Dl=0,Fl=null,Tl=null,Nl=0,Ol=0,zl=Ai(0),Rl=0,Pl=null,Bl=0,Ll=0,jl=0,Ul=null,ql=null,Il=0,Wl=1/0,$l=null,Hl=!1,Zl=null,Yl=null,Vl=!1,Gl=null,Xl=0,Ql=0,Jl=null,Kl=-1,tu=0;function eu(){return 0!==(6&Dl)?Qt():-1!==Kl?Kl:Kl=Qt()}function nu(t){return 0===(1&t.mode)?1:0!==(2&Dl)&&0!==Nl?Nl&-Nl:null!==go.transition?(0===tu&&(tu=me()),tu):0!==(t=be)?t:t=void 0===(t=window.event)?16:Xe(t.type)}function ru(t,e,n,r){if(50<Ql)throw Ql=0,Jl=null,Error(o(185));ye(t,n,r),0!==(2&Dl)&&t===Fl||(t===Fl&&(0===(2&Dl)&&(Ll|=n),4===Rl&&lu(t,Nl)),iu(t,r),1===n&&0===Dl&&0===(1&e.mode)&&(Wl=Qt()+500,ji&&Ii()))}function iu(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-ae(o),s=1<<a,l=i[a];-1===l?0!==(s&n)&&0===(s&r)||(i[a]=he(s,e)):l<=e&&(t.expiredLanes|=s),o&=~s}}(t,e);var r=de(t,t===Fl?Nl:0);if(0===r)null!==n&&Vt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=n&&Vt(n),1===e)0===t.tag?function(t){ji=!0,qi(t)}(uu.bind(null,t)):qi(uu.bind(null,t)),ai((function(){0===(6&Dl)&&Ii()})),n=null;else{switch(xe(r)){case 1:n=Kt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=re}n=Fu(n,ou.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ou(t,e){if(Kl=-1,tu=0,0!==(6&Dl))throw Error(o(327));var n=t.callbackNode;if(ku()&&t.callbackNode!==n)return null;var r=de(t,t===Fl?Nl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=yu(t,r);else{e=r;var i=Dl;Dl|=2;var a=mu();for(Fl===t&&Nl===e||($l=null,Wl=Qt()+500,hu(t,e));;)try{bu();break}catch(l){pu(t,l)}wo(),Ml.current=a,Dl=i,null!==Tl?e=0:(Fl=null,Nl=0,e=Rl)}if(0!==e){if(2===e&&(0!==(i=pe(t))&&(r=i,e=au(t,i))),1===e)throw n=Pl,hu(t,0),lu(t,r),iu(t,Qt()),n;if(6===e)lu(t,r);else{if(i=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(i)&&(2===(e=yu(t,r))&&(0!==(a=pe(t))&&(r=a,e=au(t,a))),1===e))throw n=Pl,hu(t,0),lu(t,r),iu(t,Qt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(o(345));case 2:case 5:wu(t,ql,$l);break;case 3:if(lu(t,r),(130023424&r)===r&&10<(e=Il+500-Qt())){if(0!==de(t,0))break;if(((i=t.suspendedLanes)&r)!==r){eu(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ri(wu.bind(null,t,ql,$l),e);break}wu(t,ql,$l);break;case 4:if(lu(t,r),(4194240&r)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-ae(r);a=1<<s,(s=e[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Qt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){t.timeoutHandle=ri(wu.bind(null,t,ql,$l),r);break}wu(t,ql,$l);break;default:throw Error(o(329))}}}return iu(t,Qt()),t.callbackNode===n?ou.bind(null,t):null}function au(t,e){var n=Ul;return t.current.memoizedState.isDehydrated&&(hu(t,e).flags|=256),2!==(t=yu(t,e))&&(e=ql,ql=n,null!==e&&su(e)),t}function su(t){null===ql?ql=t:ql.push.apply(ql,t)}function lu(t,e){for(e&=~jl,e&=~Ll,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ae(e),r=1<<n;t[n]=-1,e&=~r}}function uu(t){if(0!==(6&Dl))throw Error(o(327));ku();var e=de(t,0);if(0===(1&e))return iu(t,Qt()),null;var n=yu(t,e);if(0!==t.tag&&2===n){var r=pe(t);0!==r&&(e=r,n=au(t,r))}if(1===n)throw n=Pl,hu(t,0),lu(t,e),iu(t,Qt()),n;if(6===n)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wu(t,ql,$l),iu(t,Qt()),null}function cu(t,e){var n=Dl;Dl|=1;try{return t(e)}finally{0===(Dl=n)&&(Wl=Qt()+500,ji&&Ii())}}function fu(t){null!==Gl&&0===Gl.tag&&0===(6&Dl)&&ku();var e=Dl;Dl|=1;var n=Sl.transition,r=be;try{if(Sl.transition=null,be=1,t)return t()}finally{be=r,Sl.transition=n,0===(6&(Dl=e))&&Ii()}}function du(){Ol=zl.current,Ei(zl)}function hu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,ii(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(eo(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:oa(),Ei(Di),Ei(Si),fa();break;case 5:sa(r);break;case 4:oa();break;case 13:case 19:Ei(la);break;case 10:ko(r.type._context);break;case 22:case 23:du()}n=n.return}if(Fl=t,Tl=t=zu(t.current,null),Nl=Ol=e,Rl=0,Pl=null,jl=Ll=Bl=0,ql=Ul=null,null!==Co){for(e=0;e<Co.length;e++)if(null!==(r=(n=Co[e]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Co=null}return t}function pu(t,e){for(;;){var n=Tl;try{if(wo(),da.current=as,va){for(var r=ma.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}va=!1}if(pa=0,ya=ga=ma=null,ba=!1,xa=0,Cl.current=null,null===n||null===n.return){Rl=1,Pl=e,Tl=null;break}t:{var a=t,s=n.return,l=n,u=e;if(e=Nl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,f=l,d=f.tag;if(0===(1&f.mode)&&(0===d||11===d||15===d)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=ys(s);if(null!==p){p.flags&=-257,vs(p,s,l,0,e),1&p.mode&&gs(a,c,e),u=c;var m=(e=p).updateQueue;if(null===m){var g=new Set;g.add(u),e.updateQueue=g}else m.add(u);break t}if(0===(1&e)){gs(a,c,e),gu();break t}u=Error(o(426))}else if(io&&1&l.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),vs(y,s,l,0,e),mo(cs(u,l));break t}}a=u=cs(u,l),4!==Rl&&(Rl=2),null===Ul?Ul=[a]:Ul.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e,Bo(a,ps(0,u,e));break t;case 1:l=u;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Yl||!Yl.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e,Bo(a,ms(a,l,e));break t}}a=a.return}while(null!==a)}_u(n)}catch(x){e=x,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function mu(){var t=Ml.current;return Ml.current=as,null===t?as:t}function gu(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Fl||0===(268435455&Bl)&&0===(268435455&Ll)||lu(Fl,Nl)}function yu(t,e){var n=Dl;Dl|=2;var r=mu();for(Fl===t&&Nl===e||($l=null,hu(t,e));;)try{vu();break}catch(i){pu(t,i)}if(wo(),Dl=n,Ml.current=r,null!==Tl)throw Error(o(261));return Fl=null,Nl=0,Rl}function vu(){for(;null!==Tl;)xu(Tl)}function bu(){for(;null!==Tl&&!Gt();)xu(Tl)}function xu(t){var e=Al(t.alternate,t,Ol);t.memoizedProps=t.pendingProps,null===e?_u(t):Tl=e,Cl.current=null}function _u(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Vs(n,e,Ol)))return void(Tl=n)}else{if(null!==(n=Gs(n,e)))return n.flags&=32767,void(Tl=n);if(null===t)return Rl=6,void(Tl=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Tl=e);Tl=e=t}while(null!==e);0===Rl&&(Rl=5)}function wu(t,e,n){var r=be,i=Sl.transition;try{Sl.transition=null,be=1,function(t,e,n,r){do{ku()}while(null!==Gl);if(0!==(6&Dl))throw Error(o(327));n=t.finishedWork;var i=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ae(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}(t,a),t===Fl&&(Tl=Fl=null,Nl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Vl||(Vl=!0,Fu(ee,(function(){return ku(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Sl.transition,Sl.transition=null;var s=be;be=1;var l=Dl;Dl|=4,Cl.current=null,function(t,e){if(ti=$e,hr(t=dr())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var r=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(_){n=null;break t}var s=0,l=-1,u=-1,c=0,f=0,d=t,h=null;e:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=s+i),d!==a||0!==r&&3!==d.nodeType||(u=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)h=d,d=p;for(;;){if(d===t)break e;if(h===n&&++c===i&&(l=s),h===a&&++f===r&&(u=s),null!==(p=d.nextSibling))break;h=(d=h).parentNode}d=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ei={focusedElem:t,selectionRange:n},$e=!1,Ks=e;null!==Ks;)if(t=(e=Ks).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Ks=t;else for(;null!==Ks;){e=Ks;try{var m=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:yo(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(_){Eu(e,e.return,_)}if(null!==(t=e.sibling)){t.return=e.return,Ks=t;break}Ks=e.return}m=nl,nl=!1}(t,n),yl(n,t),pr(ei),$e=!!ti,ei=ti=null,t.current=n,bl(n,t,i),Xt(),Dl=l,be=s,Sl.transition=a}else t.current=n;if(Vl&&(Vl=!1,Gl=t,Xl=i),a=t.pendingLanes,0===a&&(Yl=null),function(t){if(oe&&"function"===typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(ie,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),iu(t,Qt()),null!==e)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,t=Zl,Zl=null,t;0!==(1&Xl)&&0!==t.tag&&ku(),a=t.pendingLanes,0!==(1&a)?t===Jl?Ql++:(Ql=0,Jl=t):Ql=0,Ii()}(t,e,n,r)}finally{Sl.transition=i,be=r}return null}function ku(){if(null!==Gl){var t=xe(Xl),e=Sl.transition,n=be;try{if(Sl.transition=null,be=16>t?16:t,null===Gl)var r=!1;else{if(t=Gl,Gl=null,Xl=0,0!==(6&Dl))throw Error(o(331));var i=Dl;for(Dl|=4,Ks=t.current;null!==Ks;){var a=Ks,s=a.child;if(0!==(16&Ks.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Ks=c;null!==Ks;){var f=Ks;switch(f.tag){case 0:case 11:case 15:rl(8,f,a)}var d=f.child;if(null!==d)d.return=f,Ks=d;else for(;null!==Ks;){var h=(f=Ks).sibling,p=f.return;if(al(f),f===c){Ks=null;break}if(null!==h){h.return=p,Ks=h;break}Ks=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Ks=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Ks=s;else t:for(;null!==Ks;){if(0!==(2048&(a=Ks).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Ks=v;break t}Ks=a.return}}var b=t.current;for(Ks=b;null!==Ks;){var x=(s=Ks).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Ks=x;else t:for(s=b;null!==Ks;){if(0!==(2048&(l=Ks).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(w){Eu(l,l.return,w)}if(l===s){Ks=null;break t}var _=l.sibling;if(null!==_){_.return=l.return,Ks=_;break t}Ks=l.return}}if(Dl=i,Ii(),oe&&"function"===typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(ie,t)}catch(w){}r=!0}return r}finally{be=n,Sl.transition=e}}return!1}function Au(t,e,n){t=Ro(t,e=ps(0,e=cs(n,e),1),1),e=eu(),null!==t&&(ye(t,1,e),iu(t,e))}function Eu(t,e,n){if(3===t.tag)Au(t,t,n);else for(;null!==e;){if(3===e.tag){Au(e,t,n);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Yl||!Yl.has(r))){e=Ro(e,t=ms(e,t=cs(n,t),1),1),t=eu(),null!==e&&(ye(e,1,t),iu(e,t));break}}e=e.return}}function Mu(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=eu(),t.pingedLanes|=t.suspendedLanes&n,Fl===t&&(Nl&n)===n&&(4===Rl||3===Rl&&(130023424&Nl)===Nl&&500>Qt()-Il?hu(t,0):jl|=n),iu(t,e)}function Cu(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ce,0===(130023424&(ce<<=1))&&(ce=4194304)));var n=eu();null!==(t=Fo(t,e))&&(ye(t,e,n),iu(t,n))}function Su(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Cu(t,n)}function Du(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(e),Cu(t,n)}function Fu(t,e){return Yt(t,e)}function Tu(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nu(t,e,n,r){return new Tu(t,e,n,r)}function Ou(t){return!(!(t=t.prototype)||!t.isReactComponent)}function zu(t,e){var n=t.alternate;return null===n?((n=Nu(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ru(t,e,n,r,i,a){var s=2;if(r=t,"function"===typeof t)Ou(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case k:return Pu(n.children,i,a,e);case A:s=8,i|=8;break;case E:return(t=Nu(12,n,e,2|i)).elementType=E,t.lanes=a,t;case D:return(t=Nu(13,n,e,i)).elementType=D,t.lanes=a,t;case F:return(t=Nu(19,n,e,i)).elementType=F,t.lanes=a,t;case O:return Bu(n,i,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case M:s=10;break t;case C:s=9;break t;case S:s=11;break t;case T:s=14;break t;case N:s=16,r=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Nu(s,n,e,i)).elementType=t,e.type=r,e.lanes=a,e}function Pu(t,e,n,r){return(t=Nu(7,t,r,e)).lanes=n,t}function Bu(t,e,n,r){return(t=Nu(22,t,r,e)).elementType=O,t.lanes=n,t.stateNode={isHidden:!1},t}function Lu(t,e,n){return(t=Nu(6,t,null,e)).lanes=n,t}function ju(t,e,n){return(e=Nu(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Uu(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qu(t,e,n,r,i,o,a,s,l){return t=new Uu(t,e,n,s,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Nu(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},No(o),t}function Iu(t){if(!t)return Ci;t:{if(It(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Ni(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var n=t.type;if(Ni(n))return Ri(t,n,e)}return e}function Wu(t,e,n,r,i,o,a,s,l){return(t=qu(n,r,!0,t,0,o,0,s,l)).context=Iu(null),n=t.current,(o=zo(r=eu(),i=nu(n))).callback=void 0!==e&&null!==e?e:null,Ro(n,o,i),t.current.lanes=i,ye(t,i,r),iu(t,r),t}function $u(t,e,n,r){var i=e.current,o=eu(),a=nu(i);return n=Iu(n),null===e.context?e.context=n:e.pendingContext=n,(e=zo(o,a)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),null!==(t=Ro(i,e,a))&&(ru(t,i,a,o),Po(t,i,a)),a}function Hu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Zu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Yu(t,e){Zu(t,e),(t=t.alternate)&&Zu(t,e)}Al=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Di.current)xs=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return xs=!1,function(t,e,n){switch(e.tag){case 3:Fs(e),po();break;case 5:aa(e);break;case 1:Ni(e.type)&&Pi(e);break;case 4:ia(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Mi(vo,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=e.memoizedState))return null!==r.dehydrated?(Mi(la,1&la.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Ls(t,e,n):(Mi(la,1&la.current),null!==(t=Hs(t,e,n))?t.sibling:null);Mi(la,1&la.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(128&t.flags)){if(r)return Ws(t,e,n);e.flags|=128}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Mi(la,la.current),r)break;return null;case 22:case 23:return e.lanes=0,Es(t,e,n)}return Hs(t,e,n)}(t,e,n);xs=0!==(131072&t.flags)}else xs=!1,io&&0!==(1048576&e.flags)&&Ki(e,Zi,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$s(t,e),t=e.pendingProps;var i=Ti(e,Si.current);Eo(e,n),i=Aa(null,e,r,t,i,n);var a=Ea();return e.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ni(r)?(a=!0,Pi(e)):a=!1,e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,No(e),i.updater=Io,e.stateNode=i,i._reactInternals=e,Zo(e,r,t,n),e=Ds(null,e,r,!0,a,n)):(e.tag=0,io&&a&&to(e),_s(null,e,i,n),e=e.child),e;case 16:r=e.elementType;t:{switch($s(t,e),t=e.pendingProps,r=(i=r._init)(r._payload),e.type=r,i=e.tag=function(t){if("function"===typeof t)return Ou(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===S)return 11;if(t===T)return 14}return 2}(r),t=yo(r,t),i){case 0:e=Cs(null,e,r,t,n);break t;case 1:e=Ss(null,e,r,t,n);break t;case 11:e=ws(null,e,r,t,n);break t;case 14:e=ks(null,e,r,yo(r.type,t),n);break t}throw Error(o(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,Cs(t,e,r,i=e.elementType===r?i:yo(r,i),n);case 1:return r=e.type,i=e.pendingProps,Ss(t,e,r,i=e.elementType===r?i:yo(r,i),n);case 3:t:{if(Fs(e),null===t)throw Error(o(387));r=e.pendingProps,i=(a=e.memoizedState).element,Oo(t,e),Lo(e,r,null,n);var s=e.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=Ts(t,e,r,n,i=cs(Error(o(423)),e));break t}if(r!==i){e=Ts(t,e,r,n,i=cs(Error(o(424)),e));break t}for(ro=ui(e.stateNode.containerInfo.firstChild),no=e,io=!0,oo=null,n=Jo(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),r===i){e=Hs(t,e,n);break t}_s(t,e,r,n)}e=e.child}return e;case 5:return aa(e),null===t&&uo(e),r=e.type,i=e.pendingProps,a=null!==t?t.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(e.flags|=32),Ms(t,e),_s(t,e,s,n),e.child;case 6:return null===t&&uo(e),null;case 13:return Ls(t,e,n);case 4:return ia(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Qo(e,null,r,n):_s(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,ws(t,e,r,i=e.elementType===r?i:yo(r,i),n);case 7:return _s(t,e,e.pendingProps,n),e.child;case 8:case 12:return _s(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,Mi(vo,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!Di.current){e=Hs(t,e,n);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===a.tag){(u=zo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var f=(c=c.shared).pending;null===f?u.next=u:(u.next=f.next,f.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),Ao(a.return,n,e),l.lanes|=n;break}u=u.next}}else if(10===a.tag)s=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ao(s,n,e),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}_s(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Eo(e,n),r=r(i=Mo(i)),e.flags|=1,_s(t,e,r,n),e.child;case 14:return i=yo(r=e.type,e.pendingProps),ks(t,e,r,i=yo(r.type,i),n);case 15:return As(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yo(r,i),$s(t,e),e.tag=1,Ni(r)?(t=!0,Pi(e)):t=!1,Eo(e,n),$o(e,r,i),Zo(e,r,i,n),Ds(null,e,r,!0,t,n);case 19:return Ws(t,e,n);case 22:return Es(t,e,n)}throw Error(o(156,e.tag))};var Vu="function"===typeof reportError?reportError:function(t){console.error(t)};function Gu(t){this._internalRoot=t}function Xu(t){this._internalRoot=t}function Qu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Ju(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Ku(){}function tc(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var t=Hu(a);s.call(t)}}$u(e,a,t,i)}else a=function(t,e,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var t=Hu(a);o.call(t)}}var a=Wu(e,r,t,0,null,!1,0,"",Ku);return t._reactRootContainer=a,t[pi]=a.current,Ir(8===t.nodeType?t.parentNode:t),fu(),a}for(;i=t.lastChild;)t.removeChild(i);if("function"===typeof r){var s=r;r=function(){var t=Hu(l);s.call(t)}}var l=qu(t,0,!1,null,0,!1,0,"",Ku);return t._reactRootContainer=l,t[pi]=l.current,Ir(8===t.nodeType?t.parentNode:t),fu((function(){$u(e,l,n,r)})),l}(n,e,t,i,r);return Hu(a)}Xu.prototype.render=Gu.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));$u(t,e,null,null)},Xu.prototype.unmount=Gu.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;fu((function(){$u(null,t,null,null)})),e[pi]=null}},Xu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ae();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oe.length&&0!==e&&e<Oe[n].priority;n++);Oe.splice(n,0,t),0===n&&Be(t)}},_e=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=fe(e.pendingLanes);0!==n&&(ve(e,1|n),iu(e,Qt()),0===(6&Dl)&&(Wl=Qt()+500,Ii()))}break;case 13:fu((function(){var e=Fo(t,1);if(null!==e){var n=eu();ru(e,t,1,n)}})),Yu(t,1)}},we=function(t){if(13===t.tag){var e=Fo(t,134217728);if(null!==e)ru(e,t,134217728,eu());Yu(t,134217728)}},ke=function(t){if(13===t.tag){var e=nu(t),n=Fo(t,e);if(null!==n)ru(n,t,e,eu());Yu(t,e)}},Ae=function(){return be},Ee=function(t,e){var n=be;try{return be=t,e()}finally{be=n}},wt=function(t,e,n){switch(e){case"input":if(J(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=_i(r);if(!i)throw Error(o(90));Y(r),J(r,i)}}}break;case"textarea":ot(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},St=cu,Dt=fu;var ec={usingClientEntryPoint:!1,Events:[bi,xi,_i,Mt,Ct,cu]},nc={findFiberByHostInstance:vi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Ht(t))?null:t.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{ie=ic.inject(rc),oe=ic}catch(ct){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qu(e))throw Error(o(200));return function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Qu(t))throw Error(o(299));var n=!1,r="",i=Vu;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(r=e.identifierPrefix),void 0!==e.onRecoverableError&&(i=e.onRecoverableError)),e=qu(t,1,!1,null,0,n,0,r,i),t[pi]=e.current,Ir(8===t.nodeType?t.parentNode:t),new Gu(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return t=null===(t=Ht(e))?null:t.stateNode},e.flushSync=function(t){return fu(t)},e.hydrate=function(t,e,n){if(!Ju(e))throw Error(o(200));return tc(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Qu(t))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=Vu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Wu(e,null,t,1,null!=n?n:null,i,0,a,s),t[pi]=e.current,Ir(t),r)for(t=0;t<r.length;t++)i=(i=(n=r[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Xu(e)},e.render=function(t,e,n){if(!Ju(e))throw Error(o(200));return tc(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Ju(t))throw Error(o(40));return!!t._reactRootContainer&&(fu((function(){tc(null,null,t,!1,(function(){t._reactRootContainer=null,t[pi]=null}))})),!0)},e.unstable_batchedUpdates=cu,e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ju(n))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return tc(t,e,n,!1,r)},e.version="18.2.0-next-9e3b772b8-20220608"},250:(t,e,n)=>{"use strict";var r=n(164);e.createRoot=r.createRoot,e.hydrateRoot=r.hydrateRoot},164:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(463)},374:(t,e,n)=>{"use strict";var r=n(791),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var r,o={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(c=e.ref),e)a.call(e,r)&&!l.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===o[r]&&(o[r]=e[r]);return{$$typeof:i,type:t,key:u,ref:c,props:o,_owner:s.current}}e.Fragment=o,e.jsx=u,e.jsxs=u},117:(t,e)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}function v(){}function b(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,k={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,r){var i,o={},a=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)w.call(e,i)&&!A.hasOwnProperty(i)&&(o[i]=e[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:t,key:a,ref:s,props:o,_owner:k.current}}function M(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var C=/\/+/g;function S(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function D(t,e,i,o,a){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=t),t=""===o?"."+S(l,0):o,_(a)?(i="",null!=t&&(i=t.replace(C,"$&/")+"/"),D(a,e,i,"",(function(t){return t}))):null!=a&&(M(a)&&(a=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+t)),e.push(a)),1;if(l=0,o=""===o?".":o+":",_(t))for(var u=0;u<t.length;u++){var c=o+S(s=t[u],u);l+=D(s,e,i,c,a)}else if(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=h&&t[h]||t["@@iterator"])?t:null}(t),"function"===typeof c)for(t=c.call(t),u=0;!(s=t.next()).done;)l+=D(s=s.value,e,i,c=o+S(s,u++),a);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function F(t,e,n){if(null==t)return t;var r=[],i=0;return D(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function T(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var N={current:null},O={transition:null},z={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:O,ReactCurrentOwner:k};e.Children={map:F,forEach:function(t,e,n){F(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return F(t,(function(){e++})),e},toArray:function(t){return F(t,(function(t){return t}))||[]},only:function(t){if(!M(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=i,e.Profiler=a,e.PureComponent=b,e.StrictMode=o,e.Suspense=c,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=m({},t.props),o=t.key,a=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,s=k.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)w.call(e,u)&&!A.hasOwnProperty(u)&&(i[u]=void 0===e[u]&&void 0!==l?l[u]:e[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:t.type,key:o,ref:a,props:i,_owner:s}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=M,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:T}},e.memo=function(t,e){return{$$typeof:f,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=O.transition;O.transition={};try{t()}finally{O.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return N.current.useCallback(t,e)},e.useContext=function(t){return N.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return N.current.useDeferredValue(t)},e.useEffect=function(t,e){return N.current.useEffect(t,e)},e.useId=function(){return N.current.useId()},e.useImperativeHandle=function(t,e,n){return N.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return N.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return N.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return N.current.useMemo(t,e)},e.useReducer=function(t,e,n){return N.current.useReducer(t,e,n)},e.useRef=function(t){return N.current.useRef(t)},e.useState=function(t){return N.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return N.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return N.current.useTransition()},e.version="18.2.0"},791:(t,e,n)=>{"use strict";t.exports=n(117)},184:(t,e,n)=>{"use strict";t.exports=n(374)},813:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var r=n-1>>>1,i=t[r];if(!(0<o(i,e)))break t;t[r]=e,t[n]=i,n=r}}function r(t){return 0===t.length?null:t[0]}function i(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=t[s],u=s+1,c=t[u];if(0>o(l,n))u<i&&0>o(c,l)?(t[r]=c,t[u]=n,r=u):(t[r]=l,t[s]=n,r=s);else{if(!(u<i&&0>o(c,n)))break t;t[r]=c,t[u]=n,r=u}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var u=[],c=[],f=1,d=null,h=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(t){for(var e=r(c);null!==e;){if(null===e.callback)i(c);else{if(!(e.startTime<=t))break;i(c),e.sortIndex=e.expirationTime,n(u,e)}e=r(c)}}function _(t){if(g=!1,x(t),!m)if(null!==r(u))m=!0,O(w);else{var e=r(c);null!==e&&z(_,e.startTime-t)}}function w(t,n){m=!1,g&&(g=!1,v(M),M=-1),p=!0;var o=h;try{for(x(n),d=r(u);null!==d&&(!(d.expirationTime>n)||t&&!D());){var a=d.callback;if("function"===typeof a){d.callback=null,h=d.priorityLevel;var s=a(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?d.callback=s:d===r(u)&&i(u),x(n)}else i(u);d=r(u)}if(null!==d)var l=!0;else{var f=r(c);null!==f&&z(_,f.startTime-n),l=!1}return l}finally{d=null,h=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,A=!1,E=null,M=-1,C=5,S=-1;function D(){return!(e.unstable_now()-S<C)}function F(){if(null!==E){var t=e.unstable_now();S=t;var n=!0;try{n=E(!0,t)}finally{n?k():(A=!1,E=null)}}else A=!1}if("function"===typeof b)k=function(){b(F)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,N=T.port2;T.port1.onmessage=F,k=function(){N.postMessage(null)}}else k=function(){y(F,0)};function O(t){E=t,A||(A=!0,k())}function z(t,n){M=y((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,O(w))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(t){switch(h){case 1:case 2:case 3:var e=3;break;default:e=h}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_scheduleCallback=function(t,i,o){var a=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:f++,callback:i,priorityLevel:t,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(t.sortIndex=o,n(c,t),null===r(u)&&t===r(c)&&(g?(v(M),M=-1):g=!0,z(_,o-a))):(t.sortIndex=s,n(u,t),m||p||(m=!0,O(w))),t},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(t){var e=h;return function(){var n=h;h=e;try{return t.apply(this,arguments)}finally{h=n}}}},296:(t,e,n)=>{"use strict";t.exports=n(813)},391:t=>{"use strict";var e=function(){};t.exports=e},400:t=>{t.exports=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))},t.exports.__esModule=!0,t.exports.default=t.exports},418:(t,e)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];n&&(t=a(t,o(n)))}return t}function o(t){if("string"===typeof t||"number"===typeof t)return t;if("object"!==typeof t)return"";if(Array.isArray(t))return i.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var e="";for(var n in t)r.call(t,n)&&t[n]&&(e=a(e,n));return e}function a(t,e){return e?t?t+" "+e:t+e:t}t.exports?(i.default=i,t.exports=i):void 0===(n=function(){return i}.apply(e,[]))||(t.exports=n)}()},662:t=>{"use strict";var e=/("(?:[^\\"]|\\.)*")|[:,]/g;t.exports=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),i=""===r?1/0:void 0===n.maxLength?80:n.maxLength,o=n.replacer,function t(n,a,s){var l,u,c,f,d,h,p,m,g,y,v,b;if(n&&"function"===typeof n.toJSON&&(n=n.toJSON()),void 0===(v=JSON.stringify(n,o)))return v;if(p=i-a.length-s,v.length<=p&&(g=v.replace(e,(function(t,e){return e||t+" "}))).length<=p)return g;if(null!=o&&(n=JSON.parse(v),o=void 0),"object"===typeof n&&null!==n){if(m=a+r,c=[],u=0,Array.isArray(n))for(y="[",l="]",p=n.length;u<p;u++)c.push(t(n[u],m,u===p-1?0:1)||"null");else for(y="{",l="}",p=(h=Object.keys(n)).length;u<p;u++)f=h[u],d=JSON.stringify(f)+": ",void 0!==(b=t(n[f],m,d.length+(u===p-1?0:1)))&&c.push(d+b);if(c.length>0)return[y,r+c.join(",\n"+m),l].join("\n"+a)}return v}(t,"",0)}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&i&&r;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>r[t]));return a.default=()=>r,n.d(o,a),o}})(),n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((e,r)=>(n.f[r](t,e),e)),[])),n.u=t=>"static/js/"+t+".9e9f4ffd.chunk.js",n.miniCssF=t=>{},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="frontend:";n.l=(r,i,o,a)=>{if(t[r])t[r].push(i);else{var s,l;if(void 0!==o)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var f=u[c];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==e+o){s=f;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",e+o),s.src=r),t[r]=[i];var d=(e,n)=>{s.onerror=s.onload=null,clearTimeout(h);var i=t[r];if(delete t[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((t=>t(n))),e)return e(n)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/VizAbility/",(()=>{var t={179:0};n.f.j=(e,r)=>{var i=n.o(t,e)?t[e]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise(((n,r)=>i=t[e]=[n,r]));r.push(i[2]=o);var a=n.p+n.u(e),s=new Error;n.l(a,(r=>{if(n.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}}),"chunk-"+e,e)}};var e=(e,r)=>{var i,o,a=r[0],s=r[1],l=r[2],u=0;if(a.some((e=>0!==t[e]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)l(n)}for(e&&e(r);u<a.length;u++)o=a[u],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0},r=self.webpackChunkfrontend=self.webpackChunkfrontend||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),(()=>{"use strict";var t={};n.r(t),n.d(t,{JsonPatchError:()=>ye,_areEquals:()=>Ce,applyOperation:()=>we,applyPatch:()=>ke,applyReducer:()=>Ae,deepClone:()=>ve,getValueByPointer:()=>_e,validate:()=>Me,validator:()=>Ee});var e={};n.r(e),n.d(e,{compare:()=>Re,generate:()=>Oe,observe:()=>Ne,unobserve:()=>Te});var r={};n.r(r),n.d(r,{aggregate:()=>zc,bin:()=>Rc,collect:()=>Bc,compare:()=>Lc,countpattern:()=>Uc,cross:()=>qc,density:()=>Hc,dotbin:()=>Xc,expression:()=>Qc,extent:()=>Kc,facet:()=>ef,field:()=>nf,filter:()=>of,flatten:()=>af,fold:()=>sf,formula:()=>lf,generate:()=>uf,impute:()=>df,joinaggregate:()=>hf,kde:()=>pf,key:()=>mf,load:()=>yf,lookup:()=>bf,multiextent:()=>xf,multivalues:()=>wf,params:()=>Af,pivot:()=>Ef,prefacet:()=>Mf,project:()=>Cf,proxy:()=>Sf,quantile:()=>Df,relay:()=>Ff,sample:()=>Tf,sequence:()=>Nf,sieve:()=>Of,subflow:()=>tf,timeunit:()=>zf,tupleindex:()=>Pf,values:()=>Bf,window:()=>If});var i={};n.r(i),n.d(i,{interpolate:()=>Tp,interpolateArray:()=>kp,interpolateBasis:()=>cp,interpolateBasisClosed:()=>fp,interpolateCubehelix:()=>Mg,interpolateCubehelixLong:()=>Cg,interpolateDate:()=>Ep,interpolateDiscrete:()=>Tm,interpolateHcl:()=>hg,interpolateHclLong:()=>pg,interpolateHsl:()=>Wm,interpolateHslLong:()=>$m,interpolateHue:()=>Nm,interpolateLab:()=>fg,interpolateNumber:()=>Mp,interpolateNumberArray:()=>_p,interpolateObject:()=>Cp,interpolateRgb:()=>yp,interpolateRgbBasis:()=>bp,interpolateRgbBasisClosed:()=>xp,interpolateRound:()=>Np,interpolateString:()=>Fp,interpolateTransformCss:()=>Lm,interpolateTransformSvg:()=>jm,interpolateZoom:()=>qm,piecewise:()=>xm,quantize:()=>Sg});var o={};n.r(o),n.d(o,{bound:()=>Mk,identifier:()=>Dk,mark:()=>Fk,overlap:()=>Tk,render:()=>Lk,viewlayout:()=>aA});var a={};n.r(a),n.d(a,{axisticks:()=>lA,datajoin:()=>uA,encode:()=>fA,legendentries:()=>dA,linkpath:()=>yA,pie:()=>wA,scale:()=>MA,sortitems:()=>FA,stack:()=>RA});var s={};n.r(s),n.d(s,{contour:()=>kS,geojson:()=>MS,geopath:()=>CS,geopoint:()=>SS,geoshape:()=>DS,graticule:()=>FS,heatmap:()=>TS,isocontour:()=>hS,kde2d:()=>xS,projection:()=>OS});var l={};n.r(l),n.d(l,{force:()=>ND});var u={};n.r(u),n.d(u,{nest:()=>jF,pack:()=>HF,partition:()=>YF,stratify:()=>VF,tree:()=>QF,treelinks:()=>JF,treemap:()=>eT});var c={};n.r(c),n.d(c,{label:()=>AT});var f={};n.r(f),n.d(f,{loess:()=>MT,regression:()=>ST});var d={};n.r(d),n.d(d,{voronoi:()=>sN});var h={};n.r(h),n.d(h,{wordcloud:()=>kN});var p={};n.r(p),n.d(p,{crossfilter:()=>FN,resolvefilter:()=>TN});var m={};n.r(m),n.d(m,{Bounds:()=>Zv,CanvasHandler:()=>C_,CanvasRenderer:()=>O_,DATE:()=>no,DAY:()=>ro,DAYOFYEAR:()=>io,Dataflow:()=>ou,Debug:()=>on,Error:()=>en,EventStream:()=>$l,Gradient:()=>Xy,GroupItem:()=>Vv,HOURS:()=>oo,Handler:()=>o_,HybridHandler:()=>Mw,HybridRenderer:()=>Aw,Info:()=>rn,Item:()=>Yv,MILLISECONDS:()=>lo,MINUTES:()=>ao,MONTH:()=>to,Marks:()=>Wx,MultiPulse:()=>tu,None:()=>tn,Operator:()=>ql,Parameters:()=>Ll,Pulse:()=>Xl,QUARTER:()=>Ki,RenderType:()=>Fw,Renderer:()=>s_,ResourceLoader:()=>Gv,SECONDS:()=>so,SVGHandler:()=>R_,SVGRenderer:()=>sw,SVGStringRenderer:()=>_w,Scenegraph:()=>Qx,TIME_UNITS:()=>uo,Transform:()=>su,View:()=>BB,WEEK:()=>eo,Warn:()=>nn,YEAR:()=>Ji,accessor:()=>Le,accessorFields:()=>Ue,accessorName:()=>je,array:()=>Nn,ascending:()=>Bn,bandwidthNRD:()=>Au,bin:()=>Eu,bootstrapCI:()=>Su,boundClip:()=>Lw,boundContext:()=>gb,boundItem:()=>$x,boundMark:()=>Zx,boundStroke:()=>Jv,changeset:()=>Pl,clampRange:()=>On,codegenExpression:()=>_z,compare:()=>Pn,constant:()=>qn,cumulativeLogNormal:()=>Wu,cumulativeNormal:()=>Bu,cumulativeUniform:()=>Gu,dayofyear:()=>yo,debounce:()=>In,defaultLocale:()=>Vs,definition:()=>uu,densityLogNormal:()=>Iu,densityNormal:()=>Pu,densityUniform:()=>Vu,domChild:()=>e_,domClear:()=>n_,domCreate:()=>Kx,domFind:()=>t_,dotbin:()=>Du,error:()=>$e,expressionFunction:()=>OP,extend:()=>Wn,extent:()=>$n,extentIndex:()=>Hn,falsy:()=>Je,fastmap:()=>Gn,field:()=>Ze,flush:()=>Xn,font:()=>Rx,fontFamily:()=>zx,fontSize:()=>Dx,format:()=>vl,formatLocale:()=>Us,formats:()=>bl,hasOwnProperty:()=>Yn,id:()=>Ye,identity:()=>Ve,inferType:()=>fl,inferTypes:()=>dl,ingest:()=>Fl,inherits:()=>Qn,inrange:()=>Jn,interpolate:()=>vy,interpolateColors:()=>my,interpolateRange:()=>py,intersect:()=>Ow,intersectBoxLine:()=>Cb,intersectPath:()=>kb,intersectPoint:()=>Ab,intersectRule:()=>Mb,isArray:()=>sn,isBoolean:()=>Kn,isDate:()=>tr,isFunction:()=>zn,isIterable:()=>er,isNumber:()=>nr,isObject:()=>ln,isRegExp:()=>rr,isString:()=>ir,isTuple:()=>Cl,key:()=>or,lerp:()=>ar,lineHeight:()=>Fx,loader:()=>wl,locale:()=>Ys,logger:()=>an,lruCache:()=>lr,markup:()=>K_,merge:()=>ur,mergeConfig:()=>cn,multiLineOffset:()=>Nx,one:()=>Xe,pad:()=>fr,panLinear:()=>_n,panLog:()=>wn,panPow:()=>kn,panSymlog:()=>An,parse:()=>_I,parseExpression:()=>vz,parseSelector:()=>eL,path:()=>ah,pathCurves:()=>Jy,pathEqual:()=>qw,pathParse:()=>iv,pathRectangle:()=>Sv,pathRender:()=>mv,pathSymbols:()=>bv,pathTrail:()=>Dv,peek:()=>hn,point:()=>i_,projection:()=>tS,quantileLogNormal:()=>$u,quantileNormal:()=>Lu,quantileUniform:()=>Xu,quantiles:()=>wu,quantizeInterpolator:()=>gy,quarter:()=>Fn,quartiles:()=>ku,random:()=>Mu,randomInteger:()=>Tu,randomKDE:()=>Uu,randomLCG:()=>Fu,randomLogNormal:()=>Hu,randomMixture:()=>Zu,randomNormal:()=>ju,randomUniform:()=>Qu,read:()=>_l,regressionConstant:()=>Ju,regressionExp:()=>oc,regressionLinear:()=>rc,regressionLoess:()=>dc,regressionLog:()=>ic,regressionPoly:()=>lc,regressionPow:()=>ac,regressionQuad:()=>sc,renderModule:()=>Nw,repeat:()=>cr,resetDefaultLocale:()=>Gs,resetSVGClipId:()=>$v,resetSVGDefIds:()=>Iw,responseType:()=>xl,runtimeContext:()=>WP,sampleCurve:()=>gc,sampleLogNormal:()=>qu,sampleNormal:()=>Ru,sampleUniform:()=>Yu,scale:()=>iy,sceneEqual:()=>Uw,sceneFromJSON:()=>Gx,scenePickVisit:()=>Lb,sceneToJSON:()=>Vx,sceneVisit:()=>Bb,sceneZOrder:()=>Pb,scheme:()=>wy,serializeXML:()=>tw,setHybridRendererOptions:()=>kw,setRandom:()=>Cu,span:()=>dr,splitAccessPath:()=>He,stringValue:()=>hr,textMetrics:()=>kx,timeBin:()=>sa,timeFloor:()=>Oo,timeFormatLocale:()=>Hs,timeInterval:()=>jo,timeOffset:()=>Io,timeSequence:()=>Ho,timeUnitSpecifier:()=>po,timeUnits:()=>fo,toBoolean:()=>pr,toDate:()=>gr,toNumber:()=>pn,toSet:()=>vr,toString:()=>yr,transform:()=>cu,transforms:()=>lu,truncate:()=>br,truthy:()=>Qe,tupleid:()=>Sl,typeParsers:()=>ll,utcFloor:()=>Po,utcInterval:()=>Uo,utcOffset:()=>Wo,utcSequence:()=>Zo,utcdayofyear:()=>ko,utcquarter:()=>Tn,utcweek:()=>Ao,version:()=>wI,visitArray:()=>xr,week:()=>vo,writeConfig:()=>fn,zero:()=>Ge,zoomLinear:()=>Mn,zoomLog:()=>Cn,zoomPow:()=>Sn,zoomSymlog:()=>Dn});var g={};n.r(g),n.d(g,{accessPathDepth:()=>yW,accessPathWithDatum:()=>fW,compile:()=>f5,contains:()=>HI,deepEqual:()=>CW,deleteNestedProperty:()=>uW,duplicate:()=>jI,entries:()=>oW,every:()=>YI,fieldIntersection:()=>eW,flatAccessWithDatum:()=>dW,getFirstDefined:()=>vW,hasIntersection:()=>KI,hash:()=>WI,internalField:()=>wW,isBoolean:()=>aW,isEmpty:()=>nW,isEqual:()=>QI,isInternalField:()=>kW,isNullOrFalse:()=>$I,isNumeric:()=>EW,keys:()=>rW,logicalExpr:()=>lW,mergeDeep:()=>VI,never:()=>UI,normalize:()=>AJ,normalizeAngle:()=>AW,omit:()=>II,pick:()=>qI,prefixGenerator:()=>tW,removePathFromField:()=>gW,replaceAll:()=>mW,replacePathInField:()=>pW,resetIdCounter:()=>_W,setEqual:()=>JI,some:()=>ZI,stringify:()=>SW,titleCase:()=>cW,unique:()=>XI,uniqueId:()=>xW,vals:()=>iW,varName:()=>sW,version:()=>d5});var y={};n.r(y),n.d(y,{carbong10:()=>d6,carbong100:()=>p6,carbong90:()=>h6,carbonwhite:()=>f6,dark:()=>y5,excel:()=>b5,fivethirtyeight:()=>A5,ggplot2:()=>M5,googlecharts:()=>Y5,latimes:()=>N5,powerbi:()=>a6,quartz:()=>R5,urbaninstitute:()=>W5,version:()=>m6,vox:()=>B5});var v,b=n(791),x=n.t(b,2),_=n(250),w=n(164),k=n.t(w,2);function A(){return A=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},A.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(v||(v={}));const E="popstate";function M(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function C(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(n){}}}function S(t,e){return{usr:t.state,key:t.key,idx:e}}function D(t,e,n,r){return void 0===n&&(n=null),A({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?T(e):e,{state:n,key:e&&e.key||r||Math.random().toString(36).substr(2,8)})}function F(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function T(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function N(t,e,n,r){void 0===r&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s=v.Pop,l=null,u=c();function c(){return(a.state||{idx:null}).idx}function f(){s=v.Pop;let t=c(),e=null==t?null:t-u;u=t,l&&l({action:s,location:h.location,delta:e})}function d(t){let e="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof t?t:F(t);return M(e,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,e)}null==u&&(u=0,a.replaceState(A({},a.state,{idx:u}),""));let h={get action(){return s},get location(){return t(i,a)},listen(t){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(E,f),l=t,()=>{i.removeEventListener(E,f),l=null}},createHref:t=>e(i,t),createURL:d,encodeLocation(t){let e=d(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,e){s=v.Push;let r=D(h.location,t,e);n&&n(r,t),u=c()+1;let f=S(r,u),d=h.createHref(r);try{a.pushState(f,"",d)}catch($e){if($e instanceof DOMException&&"DataCloneError"===$e.name)throw $e;i.location.assign(d)}o&&l&&l({action:s,location:h.location,delta:1})},replace:function(t,e){s=v.Replace;let r=D(h.location,t,e);n&&n(r,t),u=c();let i=S(r,u),f=h.createHref(r);a.replaceState(i,"",f),o&&l&&l({action:s,location:h.location,delta:0})},go:t=>a.go(t)};return h}var O;!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(O||(O={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function z(t,e,n){void 0===n&&(n="/");let r=V(("string"===typeof e?T(e):e).pathname||"/",n);if(null==r)return null;let i=R(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let n=t.length===e.length&&t.slice(0,-1).every(((t,n)=>t===e[n]));return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(i);let o=null;for(let a=0;null==o&&a<i.length;++a)o=H(i[a],Y(r));return o}function R(t,e,n,r){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(t,i,o)=>{let a={relativePath:void 0===o?t.path||"":o,caseSensitive:!0===t.caseSensitive,childrenIndex:i,route:t};a.relativePath.startsWith("/")&&(M(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let s=G([r,a.relativePath]),l=n.concat(a);t.children&&t.children.length>0&&(M(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),R(t.children,e,l,s)),(null!=t.path||t.index)&&e.push({path:s,score:$(s,t.index),routesMeta:l})};return t.forEach(((t,e)=>{var n;if(""!==t.path&&null!=(n=t.path)&&n.includes("?"))for(let r of P(t.path))i(t,e,r);else i(t,e)})),e}function P(t){let e=t.split("/");if(0===e.length)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let a=P(r.join("/")),s=[];return s.push(...a.map((t=>""===t?o:[o,t].join("/")))),i&&s.push(...a),s.map((e=>t.startsWith("/")&&""===e?"/":e))}const B=/^:[\w-]+$/,L=3,j=2,U=1,q=10,I=-2,W=t=>"*"===t;function $(t,e){let n=t.split("/"),r=n.length;return n.some(W)&&(r+=I),e&&(r+=j),n.filter((t=>!W(t))).reduce(((t,e)=>t+(B.test(e)?L:""===e?U:q)),r)}function H(t,e){let{routesMeta:n}=t,r={},i="/",o=[];for(let a=0;a<n.length;++a){let t=n[a],s=a===n.length-1,l="/"===i?e:e.slice(i.length)||"/",u=Z({path:t.relativePath,caseSensitive:t.caseSensitive,end:s},l);if(!u)return null;Object.assign(r,u.params);let c=t.route;o.push({params:r,pathname:G([i,u.pathname]),pathnameBase:X(G([i,u.pathnameBase])),route:c}),"/"!==u.pathnameBase&&(i=G([i,u.pathnameBase]))}return o}function Z(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=function(t,e,n){void 0===e&&(e=!1);void 0===n&&(n=!0);C("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((t,e,n)=>(r.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));t.endsWith("*")?(r.push({paramName:"*"}),i+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==t&&"/"!==t&&(i+="(?:(?=\\/|$))");let o=new RegExp(i,e?void 0:"i");return[o,r]}(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1),l=r.reduce(((t,e,n)=>{let{paramName:r,isOptional:i}=e;if("*"===r){let t=s[n]||"";a=o.slice(0,o.length-t.length).replace(/(.)\/+$/,"$1")}const l=s[n];return t[r]=i&&!l?void 0:function(t,e){try{return decodeURIComponent(t)}catch($e){return C(!1,'The value for the URL param "'+e+'" will not be decoded because the string "'+t+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+$e+")."),t}}(l||"",r),t}),{});return{params:l,pathname:o,pathnameBase:a,pattern:t}}function Y(t){try{return decodeURI(t)}catch($e){return C(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+$e+")."),t}}function V(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&"/"!==r?null:t.slice(n)||"/"}const G=t=>t.join("/").replace(/\/\/+/g,"/"),X=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/");Error;function Q(t){return null!=t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"boolean"===typeof t.internal&&"data"in t}const J=["post","put","patch","delete"],K=(new Set(J),["get",...J]);new Set(K),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function tt(){return tt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tt.apply(this,arguments)}const et=b.createContext(null);const nt=b.createContext(null);const rt=b.createContext(null);const it=b.createContext(null);const ot=b.createContext({outlet:null,matches:[],isDataRoute:!1});const at=b.createContext(null);function st(){return null!=b.useContext(it)}function lt(){return st()||M(!1),b.useContext(it).location}function ut(t,e,n,r){st()||M(!1);let{navigator:i}=b.useContext(rt),{matches:o}=b.useContext(ot),a=o[o.length-1],s=a?a.params:{},l=(a&&a.pathname,a?a.pathnameBase:"/");a&&a.route;let u,c=lt();if(e){var f;let t="string"===typeof e?T(e):e;"/"===l||(null==(f=t.pathname)?void 0:f.startsWith(l))||M(!1),u=t}else u=c;let d=u.pathname||"/",h=z(t,{pathname:"/"===l?d:d.slice(l.length)||"/"});let p=pt(h&&h.map((t=>Object.assign({},t,{params:Object.assign({},s,t.params),pathname:G([l,i.encodeLocation?i.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?l:G([l,i.encodeLocation?i.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),o,n,r);return e&&p?b.createElement(it.Provider,{value:{location:tt({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:v.Pop}},p):p}function ct(){let t=function(){var t;let e=b.useContext(at),n=gt(mt.UseRouteError),r=yt(mt.UseRouteError);if(void 0!==e)return e;return null==(t=n.errors)?void 0:t[r]}(),e=Q(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:i},n):null,null)}const ft=b.createElement(ct,null);class dt extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return void 0!==this.state.error?b.createElement(ot.Provider,{value:this.props.routeContext},b.createElement(at.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ht(t){let{routeContext:e,match:n,children:r}=t,i=b.useContext(et);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),b.createElement(ot.Provider,{value:e},r)}function pt(t,e,n,r){var i;if(void 0===e&&(e=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==t){var o;if(null==(o=n)||!o.errors)return null;t=n.matches}let a=t,s=null==(i=n)?void 0:i.errors;if(null!=s){let t=a.findIndex((t=>t.route.id&&(null==s?void 0:s[t.route.id])));t>=0||M(!1),a=a.slice(0,Math.min(a.length,t+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let t=a[c];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(u=c),t.route.id){let{loaderData:e,errors:r}=n,i=t.route.loader&&void 0===e[t.route.id]&&(!r||void 0===r[t.route.id]);if(t.route.lazy||i){l=!0,a=u>=0?a.slice(0,u+1):[a[0]];break}}}return a.reduceRight(((t,r,i)=>{let o,c=!1,f=null,d=null;n&&(o=s&&r.route.id?s[r.route.id]:void 0,f=r.route.errorElement||ft,l&&(u<0&&0===i?(!function(t,e,n){e||vt[t]||(vt[t]=!0)}("route-fallback",!1),c=!0,d=null):u===i&&(c=!0,d=r.route.hydrateFallbackElement||null)));let h=e.concat(a.slice(0,i+1)),p=()=>{let e;return e=o?f:c?d:r.route.Component?b.createElement(r.route.Component,null):r.route.element?r.route.element:t,b.createElement(ht,{match:r,routeContext:{outlet:t,matches:h,isDataRoute:null!=n},children:e})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===i)?b.createElement(dt,{location:n.location,revalidation:n.revalidation,component:f,error:o,children:p(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):p()}),null)}var mt=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(mt||{});function gt(t){let e=b.useContext(nt);return e||M(!1),e}function yt(t){let e=function(t){let e=b.useContext(ot);return e||M(!1),e}(),n=e.matches[e.matches.length-1];return n.route.id||M(!1),n.route.id}const vt={};x.startTransition;function bt(t){M(!1)}function xt(t){let{basename:e="/",children:n=null,location:r,navigationType:i=v.Pop,navigator:o,static:a=!1,future:s}=t;st()&&M(!1);let l=e.replace(/^\/*/,"/"),u=b.useMemo((()=>({basename:l,navigator:o,static:a,future:tt({v7_relativeSplatPath:!1},s)})),[l,s,o,a]);"string"===typeof r&&(r=T(r));let{pathname:c="/",search:f="",hash:d="",state:h=null,key:p="default"}=r,m=b.useMemo((()=>{let t=V(c,l);return null==t?null:{location:{pathname:t,search:f,hash:d,state:h,key:p},navigationType:i}}),[l,c,f,d,h,p,i]);return null==m?null:b.createElement(rt.Provider,{value:u},b.createElement(it.Provider,{children:n,value:m}))}function _t(t){let{children:e,location:n}=t;return ut(wt(e),n)}new Promise((()=>{}));b.Component;function wt(t,e){void 0===e&&(e=[]);let n=[];return b.Children.forEach(t,((t,r)=>{if(!b.isValidElement(t))return;let i=[...e,r];if(t.type===b.Fragment)return void n.push.apply(n,wt(t.props.children,i));t.type!==bt&&M(!1),t.props.index&&t.props.children&&M(!1);let o={id:t.props.id||i.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=wt(t.props.children,i)),n.push(o)})),n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);new Map;const kt=x.startTransition;k.flushSync,x.useId;function At(t){let{basename:e,children:n,future:r,window:i}=t,o=b.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:i,v5Compat:!0})&&(a={}),N((function(t,e){let{pathname:n,search:r,hash:i}=t.location;return D("",{pathname:n,search:r,hash:i},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"===typeof e?e:F(e)}),null,a)));let s=o.current,[l,u]=b.useState({action:s.action,location:s.location}),{v7_startTransition:c}=r||{},f=b.useCallback((t=>{c&&kt?kt((()=>u(t))):u(t)}),[u,c]);return b.useLayoutEffect((()=>s.listen(f)),[s,f]),b.createElement(xt,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:s,future:r})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Et,Mt;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Et||(Et={})),function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(Mt||(Mt={}));var Ct=n(418),St=n.n(Ct),Dt=n(184);const Ft=["as","disabled"];function Tt(t){let{tagName:e,disabled:n,href:r,target:i,rel:o,role:a,onClick:s,tabIndex:l=0,type:u}=t;e||(e=null!=r||null!=i||null!=o?"a":"button");const c={tagName:e};if("button"===e)return[{type:u||"button",disabled:n},c];const f=t=>{(n||"a"===e&&function(t){return!t||"#"===t.trim()}(r))&&t.preventDefault(),n?t.stopPropagation():null==s||s(t)};return"a"===e&&(r||(r="#"),n&&(r=void 0)),[{role:null!=a?a:"button",disabled:void 0,tabIndex:n?void 0:l,href:r,target:"a"===e?i:void 0,"aria-disabled":n||void 0,rel:"a"===e?o:void 0,onClick:f,onKeyDown:t=>{" "===t.key&&(t.preventDefault(),f(t))}},c]}const Nt=b.forwardRef(((t,e)=>{let{as:n,disabled:r}=t,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,Ft);const[o,{tagName:a}]=Tt(Object.assign({tagName:n,disabled:r},i));return(0,Dt.jsx)(a,Object.assign({},i,o,{ref:e}))}));Nt.displayName="Button";const Ot=["xxl","xl","lg","md","sm","xs"],zt="xs",Rt=b.createContext({prefixes:{},breakpoints:Ot,minBreakpoint:zt}),{Consumer:Pt,Provider:Bt}=Rt;function Lt(t,e){const{prefixes:n}=(0,b.useContext)(Rt);return t||n[e]||e}function jt(){const{breakpoints:t}=(0,b.useContext)(Rt);return t}function Ut(){const{minBreakpoint:t}=(0,b.useContext)(Rt);return t}const qt=b.forwardRef(((t,e)=>{let{as:n,bsPrefix:r,variant:i="primary",size:o,active:a=!1,disabled:s=!1,className:l,...u}=t;const c=Lt(r,"btn"),[f,{tagName:d}]=Tt({tagName:n,disabled:s,...u}),h=d;return(0,Dt.jsx)(h,{...f,...u,ref:e,disabled:s,className:St()(l,c,a&&"active",i&&"".concat(c,"-").concat(i),o&&"".concat(c,"-").concat(o),u.href&&s&&"disabled")})}));qt.displayName="Button";const It=qt,Wt=b.forwardRef(((t,e)=>{let{bsPrefix:n,className:r,as:i="div",...o}=t;const a=Lt(n,"row"),s=jt(),l=Ut(),u="".concat(a,"-cols"),c=[];return s.forEach((t=>{const e=o[t];let n;delete o[t],null!=e&&"object"===typeof e?({cols:n}=e):n=e;const r=t!==l?"-".concat(t):"";null!=n&&c.push("".concat(u).concat(r,"-").concat(n))})),(0,Dt.jsx)(i,{ref:e,...o,className:St()(r,a,...c)})}));Wt.displayName="Row";const $t=Wt;var Ht=n(191),Zt=n(872);const Yt=t=>{let{graphSpec:e,showOlli:n}=t;return(0,b.useEffect)((()=>{e&&(0,Zt.VegaLiteAdapter)(e).then((t=>{const e=(0,Ht.olli)(t);document.getElementById("olli-container")&&document.getElementById("olli-container").replaceChildren(e)})).catch((t=>{console.log("Error in olliSpec:",t)}))}),[e]),(0,b.useEffect)((()=>{const t=document.getElementById("olli-section");t.style.display=n?"block":"none"}),[n]),(0,Dt.jsxs)("div",{id:"olli-section",children:[(0,Dt.jsx)("b",{children:"(For Screen Readers) Explore the structure and components of the chart through a text representation. Instructions: Press enter on the treeview to explore the contents of the chart. Navigate using the arrows keys. To exit, press escape."}),(0,Dt.jsx)("div",{id:"olli-container"})]})},Vt={Africa:["Algeria","Angola","Benin","Botswana","Burkina Faso","Burundi","Cabo Verde","Cameroon","Central African Republic","Chad","Comoros","Democratic Republic of Congo","Djibouti","Egypt","Equatorial Guinea","Eritrea","Eswatini","Ethiopia","Gabon","Gambia","Ghana","Guinea","Guinea-Bissau","Ivory Coast","Kenya","Lesotho","Liberia","Libya","Madagascar","Malawi","Mali","Mauritania","Mauritius","Morocco","Mozambique","Namibia","Niger","Nigeria","Congo","Rwanda","Sao Tome and Principe","Senegal","Seychelles","Sierra Leone","Somalia","South Africa","South Sudan","Sudan","Tanzania","Togo","Tunisia","Uganda","Zambia","Zimbabwe"],Asia:["Afghanistan","Armenia","Azerbaijan","Bahrain","Bangladesh","Bhutan","Brunei","Cambodia","China","Cyprus","Georgia","Hong Kong","India","Indonesia","Iran","Iraq","Israel","Japan","Jordan","Kazakhstan","Kuwait","Kyrgyzstan","Laos","Lebanon","Malaysia","Maldives","Mongolia","Myanmar","Nepal","North Korea","Oman","Pakistan","Palestine","Philippines","Qatar","Saudi Arabia","Singapore","South Korea","Sri Lanka","Syria","Taiwan","Tajikistan","Thailand","Timor-Leste","Turkey","Turkmenistan","United Arab Emirates","Uzbekistan","Vietnam","Yemen"],Europe:["Albania","Andorra","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus","Czechia","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Isle of Man","Italy","Kosovo","Latvia","Liechtenstein","Lithuania","Luxembourg","Malta","Moldova","Monaco","Montenegro","Netherlands","North Macedonia","Norway","Poland","Portugal","Romania","Russia","San Marino","Serbia","Slovakia","Slovenia","Spain","Sweden","Switzerland","Ukraine","United Kingdom","Vatican City"],"North America":["Anguilla","Antigua and Barbuda","Bahamas","Barbados","Belize","Bermuda","Canada","Costa Rica","Cuba","Dominica","Dominican Republic","El Salvador","Greenland","Grenada","Guatemala","Haiti","Honduras","Jamaica","Mexico","Montserrat","Nicaragua","Panama","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Trinidad and Tobago","United States"],Oceania:["Australia","Fiji","Kiribati","Marshall Islands","Micronesia","Nauru","New Caledonia","New Zealand","Palau","Papua New Guinea","Samoa","Solomon Islands","Tonga","Tuvalu","Vanuatu"],"South America":["Argentina","Aruba","Bolivia","Brazil","Chile","Colombia","Ecuador","Guyana","Paraguay","Peru","Suriname","Uruguay","Venezuela"]};function Gt(t,e){return t[e]||[]}function Xt(t){for(const e in Vt)if(Vt[e].includes(t))return e;return"Null"}const Qt={Amber:{50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00"},"Blue Grey":{50:"#ECEFF1",100:"#CFD8DC",200:"#B0BEC5",300:"#90A4AE",400:"#78909C",500:"#607D8B",600:"#546E7A",700:"#455A64",800:"#37474F",900:"#263238"},Blue:{50:"#E3F2FD",100:"#BBDEFB",200:"#90CAF9",300:"#64B5F6",400:"#42A5F5",500:"#2196F3",600:"#1E88E5",700:"#1976D2",800:"#1565C0",900:"#0D47A1"},Brown:{50:"#EFEBE9",100:"#D7CCC8",200:"#BCAAA4",300:"#A1887F",400:"#8D6E63",500:"#795548",600:"#6D4C41",700:"#5D4037",800:"#4E342E",900:"#3E2723"},Cyan:{50:"#E0F7FA",100:"#B2EBF2",200:"#80DEEA",300:"#4DD0E1",400:"#26C6DA",500:"#00BCD4",600:"#00ACC1",700:"#0097A7",800:"#00838F",900:"#006064"},"Deep Orange":{50:"#FBE9E7",100:"#FFCCBC",200:"#FFAB91",300:"#FF8A65",400:"#FF7043",500:"#FF5722",600:"#F4511E",700:"#E64A19",800:"#D84315",900:"#BF360C"},"Deep Purple":{50:"#EDE7F6",100:"#D1C4E9",200:"#B39DDB",300:"#9575CD",400:"#7E57C2",500:"#673AB7",600:"#5E35B1",700:"#512DA8",800:"#4527A0",900:"#311B92"},Green:{50:"#E8F5E9",100:"#C8E6C9",200:"#A5D6A7",300:"#81C784",400:"#66BB6A",500:"#4CAF50",600:"#43A047",700:"#388E3C",800:"#2E7D32",900:"#1B5E20"},Grey:{50:"#FAFAFA",100:"#F5F5F5",200:"#EEEEEE",300:"#E0E0E0",400:"#BDBDBD",500:"#9E9E9E",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},Indigo:{50:"#E8EAF6",100:"#C5CAE9",200:"#9FA8DA",300:"#7986CB",400:"#5C6BC0",500:"#3F51B5",600:"#3949AB",700:"#303F9F",800:"#283593",900:"#1A237E"},"Light Blue":{50:"#E1F5FE",100:"#B3E5FC",200:"#81D4FA",300:"#4FC3F7",400:"#29B6F6",500:"#03A9F4",600:"#039BE5",700:"#0288D1",800:"#0277BD",900:"#01579B"},"Light Green":{50:"#F1F8E9",100:"#DCEDC8",200:"#C5E1A5",300:"#AED581",400:"#9CCC65",500:"#8BC34A",600:"#7CB342",700:"#689F38",800:"#558B2F",900:"#33691E"},Lime:{50:"#F9FBE7",100:"#F0F4C3",200:"#E6EE9C",300:"#DCE775",400:"#D4E157",500:"#CDDC39",600:"#C0CA33",700:"#AFB42B",800:"#9E9D24",900:"#827717"},Orange:{50:"#FFF3E0",100:"#FFE0B2",200:"#FFCC80",300:"#FFB74D",400:"#FFA726",500:"#FF9800",600:"#FB8C00",700:"#F57C00",800:"#EF6C00",900:"#E65100"},Pink:{50:"#FCE4EC",100:"#F8BBD0",200:"#F48FB1",300:"#F06292",400:"#EC407A",500:"#E91E63",600:"#D81B60",700:"#C2185B",800:"#AD1457",900:"#880E4F"},Purple:{50:"#F3E5F5",100:"#E1BEE7",200:"#CE93D8",300:"#BA68C8",400:"#AB47BC",500:"#9C27B0",600:"#8E24AA",700:"#7B1FA2",800:"#6A1B9A",900:"#4A148C"},Red:{50:"#FFEBEE",100:"#FFCDD2",200:"#EF9A9A",300:"#E57373",400:"#EF5350",500:"#F44336",600:"#E53935",700:"#D32F2F",800:"#C62828",900:"#B71C1C"},Teal:{50:"#E0F2F1",100:"#B2DFDB",200:"#80CBC4",300:"#4DB6AC",400:"#26A69A",500:"#009688",600:"#00897B",700:"#00796B",800:"#00695C",900:"#004D40"},Yellow:{50:"#FFFDE7",100:"#FFF9C4",200:"#FFF59D",300:"#FFF176",400:"#FFEE58",500:"#FFEB3B",600:"#FDD835",700:"#FBC02D",800:"#F9A825",900:"#F57F17"}};function Jt(t){let e=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16);e/=255,n/=255,r/=255,e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,n>.04045?n=Math.pow((n+.055)/1.055,2.4):n/=12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,e*=100,n*=100,r*=100;let i=.4124*e+.3576*n+.1805*r,o=.2126*e+.7152*n+.0722*r,a=.0193*e+.1192*n+.9505*r;i/=95.047,o/=100,a/=108.883,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116;return{L:116*o-16,A:500*(i-o),B:200*(o-a)}}function Kt(t){let e=t;t.startsWith("rgb")&&(e=function(t){const[e,n,r]=t.match(/\d+/g).map(Number);return"#".concat(((1<<24)+(e<<16)+(n<<8)+r).toString(16).slice(1))}(t));const n=Jt(e);let r=Number.MAX_VALUE,i=null;for(const o in Qt)if(Qt.hasOwnProperty(o)){const t=Qt[o];for(const e in t)if(t.hasOwnProperty(e)){const a=Jt(t[e]),s=n.L-a.L,l=n.A-a.A,u=n.B-a.B,c=Math.sqrt(s*s+l*l+u*u);c<r&&(r=c,i=o)}}return i}async function te(t,e){return fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/prompt?question="+t+"&gpt_model="+e,{redirect:"manual"}).then((function(t){return t.json()})).then((function(t){return t.response}))}async function ee(t,e){return fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/apply-agent?question="+t+e,{redirect:"manual"}).then((function(t){return t.json()})).then((function(t){return t.response}))}function ne(t,e,n,r){if(-1!==n&&n<t.length){return t.substring(0,n+r.length)+e+t.substring(n+r.length)}return"Invalid index or substring not found."}async function re(t,e,n,r,i){const o="gptPrompts/descrPost.txt";let a="\nHere's a structural layout of a data set. It is a hierarchy/tree data structure, where each sentence is preceded by its placement within the tree. For instance, 1.1.2 refers to the second child of the first child of the head:\n"+e+"Active Element: "+n+" // "+r+"\n";try{const n=await async function(t){return fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-validation-few-shot-prompting?user_query="+t,{redirect:"manual"}).then((function(t){return t.json()})).then((async function(e){return te(e.contents+t,"gpt-3.5-turbo-1106").then((function(t){return t})).catch((function(t){console.error(t)}))}))}(t);console.log("type",n);let r="";const s="gptPrompts/improveUserQueryPrompt.txt",l=await fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-backend-file?file_path="+s,{redirect:"manual"});let u=(await l.json()).contents;u=u.replace("{Description}",a).replace("{Question}",t);let c=await te(u,"gpt-4");if(c.startsWith("Question:")&&(c=c.slice(9).trim()),console.log("question rev",c),n.includes("Analytical Query")||n.includes("Visual Query")){const e=await fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-backend-file?file_path="+o),i=(await e.json()).contents;r='Your question "'+t+'" was categorized as being data-driven, and as such, has been answered based on the data in the chart.';return{answer:await ee(a+i,c),questionRevised:c,queryType:n,supplement:a}}if(n.includes("Contextual Query")){return{answer:await te("Here is a description of a dataset:"+e+"Use this description of the dataset along with outside knowledge to answer the following question:\nQuestion: "+c,"gpt-3.5-turbo-1106"),questionRevised:c,queryType:n,supplement:a}}if(n.includes("Navigation Query")){const t=a+"\nUse all of this to answer the following question:\n"+c,e=await async function(t){return fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-backend-file?file_path=gptPrompts/navigationQuery.txt",{redirect:"manual"}).then((function(t){return t.json()})).then((async function(e){return te(e.contents+t,"gpt-3.5-turbo-1106").then((function(t){return t})).catch((function(t){console.error(t)}))}))}(t),r=/Starting Address: ([\d.]+)/,o=/Ending Address: ([\d.]+)/,s=e.match(r),l=e.match(o);let u="",f="",d="";if(l&&s){f=s[1],d=l[1];let t=i.getNodeFromAddress(d);console.log("End Node: ",d);let e=i.getNodeFromAddress(f);console.log("Start Node: ",f),u=i.getShortestPath(e,t)}else if(s){f=s[1];u="Current Position: "+i.getNodeFromAddress(f).getInnerText()}else u="The question was interpreted as involving navigation but either no starting/ending point was provided or the Treeview was not activated. Please try again.";return{answer:u,questionRevised:c,queryType:n,supplement:a}}{const t=await fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-backend-file?file_path="+o),e=(await t.json()).contents;return await ee(a+e,c)}}catch($e){console.log("Error in getting answer: ",$e)}}const ie={};function oe(t,e){void 0===t&&(t=ie),void 0===e&&(e=ie);const n=Object.keys(t),r=Object.keys(e);return t===e||n.length===r.length&&n.every((n=>t[n]===e[n]))}var ae=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),se=Object.prototype.hasOwnProperty;function le(t,e){return se.call(t,e)}function ue(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var r=[];for(var i in t)le(t,i)&&r.push(i);return r}function ce(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function fe(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function de(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function he(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function pe(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(pe(t[e]))return!0}else if("object"===typeof t)for(var r=ue(t),i=r.length,o=0;o<i;o++)if(pe(t[r[o]]))return!0;return!1}function me(t,e){var n=[t];for(var r in e){var i="object"===typeof e[r]?JSON.stringify(e[r],null,2):e[r];"undefined"!==typeof i&&n.push(r+": "+i)}return n.join("\n")}var ge=function(t){function e(e,n,r,i,o){var a=this.constructor,s=t.call(this,me(e,{name:n,index:r,operation:i,tree:o}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=me(e,{name:n,index:r,operation:i,tree:o}),s}return ae(e,t),e}(Error),ye=ge,ve=ce,be={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=_e(n,this.path);r&&(r=ce(r));var i=we(n,{op:"remove",path:this.from}).removed;return we(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=_e(n,this.from);return we(n,{op:"add",path:this.path,value:ce(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:Ce(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},xe={add:function(t,e,n){return fe(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:be.move,copy:be.copy,test:be.test,_get:be._get};function _e(t,e){if(""==e)return t;var n={op:"_get",path:e};return we(t,n),n.value}function we(t,e,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(e,0,t,e.path):Ee(e,0)),""===e.path){var a={newDocument:t};if("add"===e.op)return a.newDocument=e.value,a;if("replace"===e.op)return a.newDocument=e.value,a.removed=t,a;if("move"===e.op||"copy"===e.op)return a.newDocument=_e(t,e.from),"move"===e.op&&(a.removed=t),a;if("test"===e.op){if(a.test=Ce(t,e.value),!1===a.test)throw new ye("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return a.newDocument=t,a}if("remove"===e.op)return a.removed=t,a.newDocument=null,a;if("_get"===e.op)return e.value=t,a;if(n)throw new ye("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,e,t);return a}r||(t=ce(t));var s=(e.path||"").split("/"),l=t,u=1,c=s.length,f=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:Ee;;){if((d=s[u])&&-1!=d.indexOf("~")&&(d=he(d)),i&&("__proto__"==d||"prototype"==d&&u>0&&"constructor"==s[u-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===l[d]?f=s.slice(0,u).join("/"):u==c-1&&(f=e.path),void 0!==f&&h(e,0,t,f)),u++,Array.isArray(l)){if("-"===d)d=l.length;else{if(n&&!fe(d))throw new ye("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,e,t);fe(d)&&(d=~~d)}if(u>=c){if(n&&"add"===e.op&&d>l.length)throw new ye("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,e,t);if(!1===(a=xe[e.op].call(e,l,d,t)).test)throw new ye("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return a}}else if(u>=c){if(!1===(a=be[e.op].call(e,l,d,t)).test)throw new ye("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return a}if(l=l[d],n&&u<c&&(!l||"object"!==typeof l))throw new ye("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,e,t)}}function ke(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new ye("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=ce(t));for(var o=new Array(e.length),a=0,s=e.length;a<s;a++)o[a]=we(t,e[a],n,!0,i,a),t=o[a].newDocument;return o.newDocument=t,o}function Ae(t,e,n){var r=we(t,e);if(!1===r.test)throw new ye("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function Ee(t,e,n,r){if("object"!==typeof t||null===t||Array.isArray(t))throw new ye("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!be[t.op])throw new ye("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!==typeof t.path)throw new ye("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new ye('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!==typeof t.from)throw new ye("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new ye("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&pe(t.value))throw new ye("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new ye("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new ye("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var a=Me([{op:"_get",path:t.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new ye("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function Me(t,e,n){try{if(!Array.isArray(t))throw new ye("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)ke(ce(e),ce(t),n||!0);else{n=n||Ee;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof ye)return i;throw i}}function Ce(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,o=Array.isArray(t),a=Array.isArray(e);if(o&&a){if((r=t.length)!=e.length)return!1;for(n=r;0!==n--;)if(!Ce(t[n],e[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(t);if((r=s.length)!==Object.keys(e).length)return!1;for(n=r;0!==n--;)if(!e.hasOwnProperty(s[n]))return!1;for(n=r;0!==n--;)if(!Ce(t[i=s[n]],e[i]))return!1;return!0}return t!==t&&e!==e}var Se=new WeakMap,De=function(t){this.observers=new Map,this.obj=t},Fe=function(t,e){this.callback=t,this.observer=e};function Te(t,e){e.unobserve()}function Ne(t,e){var n,r=function(t){return Se.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new De(t),Se.set(t,r);if(n)return n;if(n={},r.value=ce(t),e){n.callback=e,n.next=null;var o=function(){Oe(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!==typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=t,n.unobserve=function(){Oe(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(e,new Fe(e,n)),n}function Oe(t,e){void 0===e&&(e=!1);var n=Se.get(t.object);ze(n.value,t.object,t.patches,"",e),t.patches.length&&ke(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function ze(t,e,n,r,i){if(e!==t){"function"===typeof e.toJSON&&(e=e.toJSON());for(var o=ue(e),a=ue(t),s=!1,l=a.length-1;l>=0;l--){var u=t[f=a[l]];if(!le(e,f)||void 0===e[f]&&void 0!==u&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+de(f),value:ce(u)}),n.push({op:"remove",path:r+"/"+de(f)}),s=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}),!0);else{var c=e[f];"object"==typeof u&&null!=u&&"object"==typeof c&&null!=c&&Array.isArray(u)===Array.isArray(c)?ze(u,c,n,r+"/"+de(f),i):u!==c&&(!0,i&&n.push({op:"test",path:r+"/"+de(f),value:ce(u)}),n.push({op:"replace",path:r+"/"+de(f),value:ce(c)}))}}if(s||o.length!=a.length)for(l=0;l<o.length;l++){var f;le(t,f=o[l])||void 0===e[f]||n.push({op:"add",path:r+"/"+de(f),value:ce(e[f])})}}}function Re(t,e,n){void 0===n&&(n=!1);var r=[];return ze(t,e,r,"",n),r}Object.assign({},t,e,{JsonPatchError:ge,deepClone:ce,escapePathComponent:de,unescapePathComponent:he});var Pe=n(662),Be=n.n(Pe);function Le(t,e,n){return t.fields=e||[],t.fname=n,t}function je(t){return null==t?null:t.fname}function Ue(t){return null==t?null:t.fields}function qe(t){return 1===t.length?Ie(t[0]):We(t)}const Ie=t=>function(e){return e[t]},We=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function $e(t){throw Error(t)}function He(t){const e=[],n=t.length;let r,i,o,a=null,s=0,l="";function u(){e.push(l+t.substring(r,i)),l="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)l+=t.substring(r,i++),r=i;else if(o===a)u(),a=null,s=-1;else{if(a)continue;r===s&&'"'===o||r===s&&"'"===o?(r=i+1,a=o):"."!==o||s?"["===o?(i>r&&u(),s=r=i+1):"]"===o&&(s||$e("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&$e("Access path missing closing bracket: "+t),a&&$e("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function Ze(t,e,n){const r=He(t);return t=1===r.length?r[0]:t,Le((n&&n.get||qe)(r),[t],e||t)}const Ye=Ze("id"),Ve=Le((t=>t),[],"identity"),Ge=Le((()=>0),[],"zero"),Xe=Le((()=>1),[],"one"),Qe=Le((()=>!0),[],"true"),Je=Le((()=>!1),[],"false");function Ke(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const tn=0,en=1,nn=2,rn=3,on=4;function an(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ke,r=t||tn;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=en&&n(e||"error","ERROR",arguments),this},warn(){return r>=nn&&n(e||"warn","WARN",arguments),this},info(){return r>=rn&&n(e||"log","INFO",arguments),this},debug(){return r>=on&&n(e||"log","DEBUG",arguments),this}}}var sn=Array.isArray;function ln(t){return t===Object(t)}const un=t=>"__proto__"!==t;function cn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=dn(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;fn(t,n,e[n],r)}return t}),{})}function fn(t,e,n,r){if(!un(e))return;let i,o;if(ln(n)&&!sn(n))for(i in o=ln(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?fn(o,i,n[i]):un(i)&&(o[i]=n[i]);else t[e]=n}function dn(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function hn(t){return t[t.length-1]}function pn(t){return null==t||""===t?null:+t}const mn=t=>e=>t*Math.exp(e),gn=t=>e=>Math.log(t*e),yn=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),vn=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,bn=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function xn(t,e,n,r){const i=n(t[0]),o=n(hn(t)),a=(o-i)*e;return[r(i-a),r(o-a)]}function _n(t,e){return xn(t,e,pn,Ve)}function wn(t,e){var n=Math.sign(t[0]);return xn(t,e,gn(n),mn(n))}function kn(t,e,n){return xn(t,e,bn(n),bn(1/n))}function An(t,e,n){return xn(t,e,yn(n),vn(n))}function En(t,e,n,r,i){const o=r(t[0]),a=r(hn(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function Mn(t,e,n){return En(t,e,n,pn,Ve)}function Cn(t,e,n){const r=Math.sign(t[0]);return En(t,e,n,gn(r),mn(r))}function Sn(t,e,n,r){return En(t,e,n,bn(r),bn(1/r))}function Dn(t,e,n,r){return En(t,e,n,yn(r),vn(r))}function Fn(t){return 1+~~(new Date(t).getMonth()/3)}function Tn(t){return 1+~~(new Date(t).getUTCMonth()/3)}function Nn(t){return null!=t?sn(t)?t:[t]:[]}function On(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]}function zn(t){return"function"===typeof t}const Rn="descending";function Pn(t,e,n){n=n||{},e=Nn(e)||[];const r=[],i=[],o={},a=n.comparator||Ln;return Nn(t).forEach(((t,a)=>{null!=t&&(r.push(e[a]===Rn?-1:1),i.push(t=zn(t)?t:Ze(t,null,n)),(Ue(t)||[]).forEach((t=>o[t]=1)))})),0===i.length?null:Le(a(i,r),Object.keys(o))}const Bn=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),Ln=(t,e)=>1===t.length?jn(t[0],e[0]):Un(t,e,t.length),jn=(t,e)=>function(n,r){return Bn(t(n),t(r))*e},Un=(t,e,n)=>(e.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=t[s],a=Bn(o(r),o(i));return a*e[s]});function qn(t){return zn(t)?t:()=>t}function In(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function Wn(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function $n(t,e){let n,r,i,o,a=0;if(t&&(n=t.length))if(null==e){for(r=t[a];a<n&&(null==r||r!==r);r=t[++a]);for(i=o=r;a<n;++a)r=t[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[a]);a<n&&(null==r||r!==r);r=e(t[++a]));for(i=o=r;a<n;++a)r=e(t[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function Hn(t,e){const n=t.length;let r,i,o,a,s,l=-1;if(null==e){for(;++l<n;)if(i=t[l],null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=t[l],null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}else{for(;++l<n;)if(i=e(t[l],l,t),null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(a=s=l;++l<n;)i=e(t[l],l,t),null!=i&&(r>i&&(r=i,a=l),o<i&&(o=i,s=l))}return[a,s]}const Zn=Object.prototype.hasOwnProperty;function Yn(t,e){return Zn.call(t,e)}const Vn={};function Gn(t){let e,n={};function r(t){return Yn(n,t)&&n[t]!==Vn}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===Vn&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=Vn),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===Vn||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function Xn(t,e,n,r,i,o){if(!n&&0!==n)return o;const a=+n;let s,l=t[0],u=hn(t);u<l&&(s=l,l=u,u=s),s=Math.abs(e-l);const c=Math.abs(u-e);return s<c&&s<=a?r:c<=a?i:o}function Qn(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Wn(r,n)}function Jn(t,e,n,r){let i,o=e[0],a=e[e.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=a:t<a)}function Kn(t){return"boolean"===typeof t}function tr(t){return"[object Date]"===Object.prototype.toString.call(t)}function er(t){return t&&zn(t[Symbol.iterator])}function nr(t){return"number"===typeof t}function rr(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function ir(t){return"string"===typeof t}function or(t,e,n){t&&(t=e?Nn(t).map((t=>t.replace(/\\(.)/g,"$1"))):Nn(t));const r=t&&t.length,i=n&&n.get||qe,o=t=>i(e?[t]:He(t));let a;if(r)if(1===r){const e=o(t[0]);a=function(t){return""+e(t)}}else{const e=t.map(o);a=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else a=function(){return""};return Le(a,t,"key")}function ar(t,e){const n=t[0],r=hn(t),i=+e;return i?1===i?r:n+i*(r-n):n}const sr=1e4;function lr(t){let e,n,r;t=+t||sr;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>Yn(e,t)||Yn(n,t),get:t=>Yn(e,t)?e[t]:Yn(n,t)?o(t,n[t]):void 0,set:(t,n)=>Yn(e,t)?e[t]=n:o(t,n)}}function ur(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const a=r||new e.constructor(i+o);let s=0,l=0,u=0;for(;s<i&&l<o;++u)a[u]=t(e[s],n[l])>0?n[l++]:e[s++];for(;s<i;++s,++u)a[u]=e[s];for(;l<o;++l,++u)a[u]=n[l];return a}function cr(t,e){let n="";for(;--e>=0;)n+=t;return n}function fr(t,e,n,r){const i=n||" ",o=t+"",a=e-o.length;return a<=0?o:"left"===r?cr(i,a)+o:"center"===r?cr(i,~~(a/2))+o+cr(i,Math.ceil(a/2)):o+cr(i,a)}function dr(t){return t&&hn(t)-t[0]||0}function hr(t){return sn(t)?"["+t.map(hr)+"]":ln(t)||ir(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function pr(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const mr=t=>nr(t)||tr(t)?t:Date.parse(t);function gr(t,e){return e=e||mr,null==t||""===t?null:e(t)}function yr(t){return null==t||""===t?null:t+""}function vr(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function br(t,e,n,r){const i=null!=r?r:"\u2026",o=t+"",a=o.length,s=Math.max(0,e-i.length);return a<=e?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i}function xr(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var _r={},wr={},kr=34,Ar=10,Er=13;function Mr(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Cr(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Sr(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Dr(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Sr(-e,6):e>9999?"+"+Sr(e,6):Sr(e,4))+"-"+Sr(t.getUTCMonth()+1,2)+"-"+Sr(t.getUTCDate(),2)+(o?"T"+Sr(n,2)+":"+Sr(r,2)+":"+Sr(i,2)+"."+Sr(o,3)+"Z":i?"T"+Sr(n,2)+":"+Sr(r,2)+":"+Sr(i,2)+"Z":r||n?"T"+Sr(n,2)+":"+Sr(r,2)+"Z":"")}function Fr(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return wr;if(u)return u=!1,_r;var e,r,i=a;if(t.charCodeAt(i)===kr){for(;a++<o&&t.charCodeAt(a)!==kr||t.charCodeAt(++a)===kr;);return(e=a)>=o?l=!0:(r=t.charCodeAt(a++))===Ar?u=!0:r===Er&&(u=!0,t.charCodeAt(a)===Ar&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===Ar)u=!0;else if(r===Er)u=!0,t.charCodeAt(a)===Ar&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===Ar&&--o,t.charCodeAt(o-1)===Er&&--o;(r=c())!==wr;){for(var f=[];r!==_r&&r!==wr;)f.push(r),r=c();e&&null==(f=e(f,s++))||i.push(f)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?Dr(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Mr(t);return function(r,i){return e(n(r),i,t)}}(t,e):Mr(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=Cr(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Cr(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}function Tr(t){return t}function Nr(t,e){return"string"===typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return Or(t,e)}))}:Or(t,e)}function Or(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=zr(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function zr(t,e){var n=function(t){if(null==t)return Tr;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+a;l<u;)c[l]=t[l],++l;return c}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,a)}function o(t){return n(t)}function a(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=a(e.arcs);break;case"MultiLineString":n=e.arcs.map(a);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function Rr(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)})),e.forEach((function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1];return e<0?[n,i]:[i,n]}(e),s=a[0],l=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=l]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o}function Pr(t){return zr(t,Br.apply(this,arguments))}function Br(t,e,n){var r,i,o;if(arguments.length>1)r=function(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function l(t){t.forEach(s)}function u(t){t.forEach(l)}function c(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(c);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":l(t.arcs);break;case"MultiPolygon":u(t.arcs)}}return c(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:Rr(t,r)}}const Lr=Math.sqrt(50),jr=Math.sqrt(10),Ur=Math.sqrt(2);function qr(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Lr?10:o>=jr?5:o>=Ur?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?qr(t,e,2*n):[s,l,u]}function Ir(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[i,o,a]=r?qr(e,t,n):qr(t,e,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function Wr(t,e,n){return qr(t=+t,e=+e,n=+n)[2]}function $r(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?Wr(e,t,n):Wr(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}var Hr,Zr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yr(t){if(!(e=Zr.exec(t)))throw new Error("invalid format: "+t);var e;return new Vr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Vr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Gr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Xr(t){return(t=Gr(Math.abs(t)))?t[1]:NaN}function Qr(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Xr(e)/3)))-Xr(Math.abs(t)))}function Jr(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Xr(e)-Xr(t))+1}function Kr(t){return Math.max(0,-Xr(Math.abs(t)))}function ti(t,e){var n=Gr(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Yr.prototype=Vr.prototype,Vr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const ei={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ti(100*t,e),r:ti,s:function(t,e){var n=Gr(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Hr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Gr(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ni(t){return t}var ri,ii,oi,ai=Array.prototype.map,si=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function li(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ni:(e=ai.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?ni:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ai.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=Yr(t)).fill,n=t.align,f=t.sign,d=t.symbol,h=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):ei[v]||(void 0===g&&(g=12),y=!0,v="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?o:/[%p]/.test(v)?l:"",_=ei[v],w=/[defgprs%]/.test(v);function k(t){var i,o,l,d=b,k=x;if("c"===v)k=_(t)+k,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:_(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&"+"!==f&&(A=!1),d=(A?"("===f?f:u:"-"===f||"("===f?"":f)+d,k=("s"===v?si[8+Hr/3]:"")+k+(A&&"("===f?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){k=(46===l?a+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}m&&!h&&(t=r(t,1/0));var E=d.length+t.length+k.length,M=E<p?new Array(p-E+1).join(e):"";switch(m&&h&&(t=r(M+t,M.length?p-k.length:1/0),M=""),n){case"<":t=d+t+k+M;break;case"=":t=d+M+t+k;break;case"^":t=M.slice(0,E=M.length>>1)+d+t+k+M.slice(E);break;default:t=M+d+t+k}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:f,formatPrefix:function(t,e){var n=f(((t=Yr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Xr(e)/3))),i=Math.pow(10,-r),o=si[8+r/3];return function(t){return n(i*t)+o}}}}!function(t){ri=li(t),ii=ri.format,oi=ri.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const ui=new Date,ci=new Date;function fi(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=e=>(t(e=new Date(+e)),e),i.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),i.round=t=>{const e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return a;let s;do{a.push(s=new Date(+n)),e(n,o),t(n)}while(s<n&&n<r);return a},i.filter=n=>fi((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})),n&&(i.count=(e,r)=>(ui.setTime(+e),ci.setTime(+r),t(ui),t(ci),Math.floor(n(ui,ci))),i.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?e=>r(e)%t===0:e=>i.count(0,e)%t===0):i:null)),i}const di=1e3,hi=6e4,pi=36e5,mi=864e5,gi=6048e5,yi=2592e6,vi=31536e6,bi=fi((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*hi)/mi),(t=>t.getDate()-1)),xi=(bi.range,fi((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/mi),(t=>t.getUTCDate()-1))),_i=(xi.range,fi((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/mi),(t=>Math.floor(t/mi))));_i.range;function wi(t){return fi((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*hi)/gi))}const ki=wi(0),Ai=wi(1),Ei=wi(2),Mi=wi(3),Ci=wi(4),Si=wi(5),Di=wi(6);ki.range,Ai.range,Ei.range,Mi.range,Ci.range,Si.range,Di.range;function Fi(t){return fi((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/gi))}const Ti=Fi(0),Ni=Fi(1),Oi=Fi(2),zi=Fi(3),Ri=Fi(4),Pi=Fi(5),Bi=Fi(6),Li=(Ti.range,Ni.range,Oi.range,zi.range,Ri.range,Pi.range,Bi.range,fi((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear())));Li.every=t=>isFinite(t=Math.floor(t))&&t>0?fi((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null;Li.range;const ji=fi((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));ji.every=t=>isFinite(t=Math.floor(t))&&t>0?fi((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null;ji.range;const Ui=fi((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth())),qi=(Ui.range,fi((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth()))),Ii=(qi.range,fi((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*di-t.getMinutes()*hi)}),((t,e)=>{t.setTime(+t+e*pi)}),((t,e)=>(e-t)/pi),(t=>t.getHours()))),Wi=(Ii.range,fi((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*pi)}),((t,e)=>(e-t)/pi),(t=>t.getUTCHours()))),$i=(Wi.range,fi((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*di)}),((t,e)=>{t.setTime(+t+e*hi)}),((t,e)=>(e-t)/hi),(t=>t.getMinutes()))),Hi=($i.range,fi((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*hi)}),((t,e)=>(e-t)/hi),(t=>t.getUTCMinutes()))),Zi=(Hi.range,fi((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*di)}),((t,e)=>(e-t)/di),(t=>t.getUTCSeconds()))),Yi=(Zi.range,fi((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t)));Yi.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?fi((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):Yi:null);Yi.range;function Vi(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Gi(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Xi(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=Vi,n=(e,n)=>Vi(t(e),n),r=(e,n)=>t(e)-n):(e=t===Vi||t===Gi?t:Qi,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function Qi(){return 0}const Ji="year",Ki="quarter",to="month",eo="week",no="date",ro="day",io="dayofyear",oo="hours",ao="minutes",so="seconds",lo="milliseconds",uo=[Ji,Ki,to,eo,no,ro,io,oo,ao,so,lo],co=uo.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function fo(t){const e=Nn(t).slice(),n={};e.length||$e("Missing time unit."),e.forEach((t=>{Yn(co,t)?n[t]=1:$e("Invalid time unit: ".concat(t,"."))}));return(n[eo]||n[ro]?1:0)+(n[Ki]||n[to]||n[no]?1:0)+(n[io]?1:0)>1&&$e("Incompatible time units: ".concat(t)),e.sort(((t,e)=>co[t]-co[e])),e}const ho={[Ji]:"%Y ",[Ki]:"Q%q ",[to]:"%b ",[no]:"%d ",[eo]:"W%U ",[ro]:"%a ",[io]:"%j ",[oo]:"%H:00",[ao]:"00:%M",[so]:":%S",[lo]:".%L",["".concat(Ji,"-").concat(to)]:"%Y-%m ",["".concat(Ji,"-").concat(to,"-").concat(no)]:"%Y-%m-%d ",["".concat(oo,"-").concat(ao)]:"%H:%M"};function po(t,e){const n=Wn({},ho,e),r=fo(t),i=r.length;let o,a,s="",l=0;for(l=0;l<i;)for(o=r.length;o>l;--o)if(a=r.slice(l,o).join("-"),null!=n[a]){s+=n[a],l=o;break}return s.trim()}const mo=new Date;function go(t){return mo.setFullYear(t),mo.setMonth(0),mo.setDate(1),mo.setHours(0,0,0,0),mo}function yo(t){return bo(new Date(t))}function vo(t){return xo(new Date(t))}function bo(t){return bi.count(go(t.getFullYear())-1,t)}function xo(t){return ki.count(go(t.getFullYear())-1,t)}function _o(t){return go(t).getDay()}function wo(t,e,n,r,i,o,a){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,o,a);return s.setFullYear(t),s}return new Date(t,e,n,r,i,o,a)}function ko(t){return Eo(new Date(t))}function Ao(t){return Mo(new Date(t))}function Eo(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return xi.count(e-1,t)}function Mo(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Ti.count(e-1,t)}function Co(t){return mo.setTime(Date.UTC(t,0,1)),mo.getUTCDay()}function So(t,e,n,r,i,o,a){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,a));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,a))}function Do(t,e,n,r,i){const o=e||1,a=hn(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===a&&o,e),l=new Date,u=vr(t),c=u[Ji]?s(Ji):qn(2012),f=u[to]?s(to):u[Ki]?s(Ki):Ge,d=u[eo]&&u[ro]?s(ro,1,eo+ro):u[eo]?s(eo,1):u[ro]?s(ro,1):u[no]?s(no,1):u[io]?s(io,1):Xe,h=u[oo]?s(oo):Ge,p=u[ao]?s(ao):Ge,m=u[so]?s(so):Ge,g=u[lo]?s(lo):Ge;return function(t){l.setTime(+t);const e=c(l);return i(e,f(l),d(l,e),h(l),p(l),m(l),g(l))}}function Fo(t,e,n){return e+7*t-(n+6)%7}const To={[Ji]:t=>t.getFullYear(),[Ki]:t=>Math.floor(t.getMonth()/3),[to]:t=>t.getMonth(),[no]:t=>t.getDate(),[oo]:t=>t.getHours(),[ao]:t=>t.getMinutes(),[so]:t=>t.getSeconds(),[lo]:t=>t.getMilliseconds(),[io]:t=>bo(t),[eo]:t=>xo(t),[eo+ro]:(t,e)=>Fo(xo(t),t.getDay(),_o(e)),[ro]:(t,e)=>Fo(1,t.getDay(),_o(e))},No={[Ki]:t=>3*t,[eo]:(t,e)=>Fo(t,0,_o(e))};function Oo(t,e){return Do(t,e||1,To,No,wo)}const zo={[Ji]:t=>t.getUTCFullYear(),[Ki]:t=>Math.floor(t.getUTCMonth()/3),[to]:t=>t.getUTCMonth(),[no]:t=>t.getUTCDate(),[oo]:t=>t.getUTCHours(),[ao]:t=>t.getUTCMinutes(),[so]:t=>t.getUTCSeconds(),[lo]:t=>t.getUTCMilliseconds(),[io]:t=>Eo(t),[eo]:t=>Mo(t),[ro]:(t,e)=>Fo(1,t.getUTCDay(),Co(e)),[eo+ro]:(t,e)=>Fo(Mo(t),t.getUTCDay(),Co(e))},Ro={[Ki]:t=>3*t,[eo]:(t,e)=>Fo(t,0,Co(e))};function Po(t,e){return Do(t,e||1,zo,Ro,So)}const Bo={[Ji]:Li,[Ki]:Ui.every(3),[to]:Ui,[eo]:ki,[no]:bi,[ro]:bi,[io]:bi,[oo]:Ii,[ao]:$i,[so]:Zi,[lo]:Yi},Lo={[Ji]:ji,[Ki]:qi.every(3),[to]:qi,[eo]:Ti,[no]:xi,[ro]:xi,[io]:xi,[oo]:Wi,[ao]:Hi,[so]:Zi,[lo]:Yi};function jo(t){return Bo[t]}function Uo(t){return Lo[t]}function qo(t,e,n){return t?t.offset(e,n):void 0}function Io(t,e,n){return qo(jo(t),e,n)}function Wo(t,e,n){return qo(Uo(t),e,n)}function $o(t,e,n,r){return t?t.range(e,n,r):void 0}function Ho(t,e,n,r){return $o(jo(t),e,n,r)}function Zo(t,e,n,r){return $o(Uo(t),e,n,r)}const Yo=1e3,Vo=6e4,Go=36e5,Xo=864e5,Qo=2592e6,Jo=31536e6,Ko=[Ji,to,no,oo,ao,so,lo],ta=Ko.slice(0,-1),ea=ta.slice(0,-1),na=ea.slice(0,-1),ra=na.slice(0,-1),ia=[Ji,to],oa=[Ji],aa=[[ta,1,Yo],[ta,5,5e3],[ta,15,15e3],[ta,30,3e4],[ea,1,Vo],[ea,5,3e5],[ea,15,9e5],[ea,30,18e5],[na,1,Go],[na,3,108e5],[na,6,216e5],[na,12,432e5],[ra,1,Xo],[[Ji,eo],1,6048e5],[ia,1,Qo],[ia,3,7776e6],[oa,1,Jo]];function sa(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(dr(e))/n;let i,o,a=Xi((t=>t[2])).right(aa,r);return a===aa.length?(i=oa,o=$r(e[0]/Jo,e[1]/Jo,n)):a?(a=aa[r/aa[a-1][2]<aa[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=Ko,o=Math.max($r(e[0],e[1],n),1)),{units:i,step:o}}function la(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function ua(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ca(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function fa(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,u=ka(i),c=Aa(i),f=ka(o),d=Aa(o),h=ka(a),p=Aa(a),m=ka(s),g=Aa(s),y=ka(l),v=Aa(l),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Ha,e:Ha,f:Xa,g:ss,G:us,H:Za,I:Ya,j:Va,L:Ga,m:Qa,M:Ja,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Ns,s:Os,S:Ka,u:ts,U:es,V:rs,w:is,W:os,x:null,X:null,y:as,Y:ls,Z:cs,"%":Ts},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:fs,e:fs,f:gs,g:Cs,G:Ds,H:ds,I:hs,j:ps,L:ms,m:ys,M:vs,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Ns,s:Os,S:bs,u:xs,U:_s,V:ks,w:As,W:Es,x:null,X:null,y:Ms,Y:Ss,Z:Fs,"%":Ts},_={a:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:Ra,e:Ra,f:qa,g:Ta,G:Fa,H:Ba,I:Ba,j:Pa,L:Ua,m:za,M:La,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:Oa,Q:Wa,s:$a,S:ja,u:Ma,U:Ca,V:Sa,w:Ea,W:Da,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:Ta,Y:Fa,Z:Na,"%":Ia};function w(t,e){return function(n){var r,i,o,a=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(i=ya[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}}function k(t,e){return function(n){var r,i,o=ca(1900,void 0,1);if(A(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=ua(ca(o.y,0,1))).getUTCDay(),r=i>4||0===i?Ni.ceil(r):Ni(r),r=xi.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=la(ca(o.y,0,1))).getDay(),r=i>4||0===i?Ai.ceil(r):Ai(r),r=bi.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?ua(ca(o.y,0,1)).getUTCDay():la(ca(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,ua(o)):la(o)}}function A(t,e,n,r){for(var i,o,a=0,s=e.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=_[i in ya?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=k(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=k(t+="",!0);return e.toString=function(){return t},e}}}var da,ha,pa,ma,ga,ya={"-":"",_:" ",0:"0"},va=/^\s*\d+/,ba=/^%/,xa=/[\\^$*+?|[\]().{}]/g;function _a(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function wa(t){return t.replace(xa,"\\$&")}function ka(t){return new RegExp("^(?:"+t.map(wa).join("|")+")","i")}function Aa(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function Ea(t,e,n){var r=va.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ma(t,e,n){var r=va.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ca(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Sa(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Da(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Fa(t,e,n){var r=va.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ta(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Na(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Oa(t,e,n){var r=va.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function za(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Ra(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Pa(t,e,n){var r=va.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Ba(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function La(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function ja(t,e,n){var r=va.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Ua(t,e,n){var r=va.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function qa(t,e,n){var r=va.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ia(t,e,n){var r=ba.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Wa(t,e,n){var r=va.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function $a(t,e,n){var r=va.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Ha(t,e){return _a(t.getDate(),e,2)}function Za(t,e){return _a(t.getHours(),e,2)}function Ya(t,e){return _a(t.getHours()%12||12,e,2)}function Va(t,e){return _a(1+bi.count(Li(t),t),e,3)}function Ga(t,e){return _a(t.getMilliseconds(),e,3)}function Xa(t,e){return Ga(t,e)+"000"}function Qa(t,e){return _a(t.getMonth()+1,e,2)}function Ja(t,e){return _a(t.getMinutes(),e,2)}function Ka(t,e){return _a(t.getSeconds(),e,2)}function ts(t){var e=t.getDay();return 0===e?7:e}function es(t,e){return _a(ki.count(Li(t)-1,t),e,2)}function ns(t){var e=t.getDay();return e>=4||0===e?Ci(t):Ci.ceil(t)}function rs(t,e){return t=ns(t),_a(Ci.count(Li(t),t)+(4===Li(t).getDay()),e,2)}function is(t){return t.getDay()}function os(t,e){return _a(Ai.count(Li(t)-1,t),e,2)}function as(t,e){return _a(t.getFullYear()%100,e,2)}function ss(t,e){return _a((t=ns(t)).getFullYear()%100,e,2)}function ls(t,e){return _a(t.getFullYear()%1e4,e,4)}function us(t,e){var n=t.getDay();return _a((t=n>=4||0===n?Ci(t):Ci.ceil(t)).getFullYear()%1e4,e,4)}function cs(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+_a(e/60|0,"0",2)+_a(e%60,"0",2)}function fs(t,e){return _a(t.getUTCDate(),e,2)}function ds(t,e){return _a(t.getUTCHours(),e,2)}function hs(t,e){return _a(t.getUTCHours()%12||12,e,2)}function ps(t,e){return _a(1+xi.count(ji(t),t),e,3)}function ms(t,e){return _a(t.getUTCMilliseconds(),e,3)}function gs(t,e){return ms(t,e)+"000"}function ys(t,e){return _a(t.getUTCMonth()+1,e,2)}function vs(t,e){return _a(t.getUTCMinutes(),e,2)}function bs(t,e){return _a(t.getUTCSeconds(),e,2)}function xs(t){var e=t.getUTCDay();return 0===e?7:e}function _s(t,e){return _a(Ti.count(ji(t)-1,t),e,2)}function ws(t){var e=t.getUTCDay();return e>=4||0===e?Ri(t):Ri.ceil(t)}function ks(t,e){return t=ws(t),_a(Ri.count(ji(t),t)+(4===ji(t).getUTCDay()),e,2)}function As(t){return t.getUTCDay()}function Es(t,e){return _a(Ni.count(ji(t)-1,t),e,2)}function Ms(t,e){return _a(t.getUTCFullYear()%100,e,2)}function Cs(t,e){return _a((t=ws(t)).getUTCFullYear()%100,e,2)}function Ss(t,e){return _a(t.getUTCFullYear()%1e4,e,4)}function Ds(t,e){var n=t.getUTCDay();return _a((t=n>=4||0===n?Ri(t):Ri.ceil(t)).getUTCFullYear()%1e4,e,4)}function Fs(){return"+0000"}function Ts(){return"%"}function Ns(t){return+t}function Os(t){return Math.floor(+t/1e3)}function zs(t){const e={};return n=>e[n]||(e[n]=t(n))}function Rs(t){const e=zs(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Yr(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let o=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const a=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+a}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,o){o=Yr(null==o?",f":o);const a=$r(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=Qr(a,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(l=Jr(a,s))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=Kr(a))||(o.precision=l-2*("%"===o.type))}return e(o)}}}let Ps,Bs;function Ls(){return Ps=Rs({format:ii,formatPrefix:oi})}function js(t){return Rs(li(t))}function Us(t){return arguments.length?Ps=js(t):Ps}function qs(t,e,n){ln(n=n||{})||$e("Invalid time multi-format specifier: ".concat(n));const r=e(so),i=e(ao),o=e(oo),a=e(no),s=e(eo),l=e(to),u=e(Ki),c=e(Ji),f=t(n[lo]||".%L"),d=t(n[so]||":%S"),h=t(n[ao]||"%I:%M"),p=t(n[oo]||"%I %p"),m=t(n[no]||n[ro]||"%a %d"),g=t(n[eo]||"%b %d"),y=t(n[to]||"%B"),v=t(n[Ki]||"%B"),b=t(n[Ji]||"%Y");return t=>(r(t)<t?f:i(t)<t?d:o(t)<t?h:a(t)<t?p:l(t)<t?s(t)<t?m:g:c(t)<t?u(t)<t?y:v:b)(t)}function Is(t){const e=zs(t.format),n=zs(t.utcFormat);return{timeFormat:t=>ir(t)?e(t):qs(e,jo,t),utcFormat:t=>ir(t)?n(t):qs(n,Uo,t),timeParse:zs(t.parse),utcParse:zs(t.utcParse)}}function Ws(){return Bs=Is({format:ha,parse:pa,utcFormat:ma,utcParse:ga})}function $s(t){return Is(fa(t))}function Hs(t){return arguments.length?Bs=$s(t):Bs}!function(t){da=fa(t),ha=da.format,pa=da.parse,ma=da.utcFormat,ga=da.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Ls(),Ws();const Zs=(t,e)=>Wn({},t,e);function Ys(t,e){const n=t?js(t):Us(),r=e?$s(e):Hs();return Zs(n,r)}function Vs(t,e){const n=arguments.length;return n&&2!==n&&$e("defaultLocale expects either zero or two arguments."),n?Zs(Us(t),Hs(e)):Zs(Us(),Hs())}function Gs(){return Ls(),Ws(),Vs()}const Xs=/^(data:|([A-Za-z]+:)?\/\/)/,Qs=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Js=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Ks="file://";async function tl(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function el(t,e){e=Wn({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,a;const s=Qs.test(t.replace(Js,""));null!=t&&"string"===typeof t&&s||$e("Sanitize failure, invalid URI: "+hr(t));const l=Xs.test(t);return(a=e.baseURL)&&!l&&(t.startsWith("/")||a.endsWith("/")||(t="/"+t),t=a+t),o=(i=t.startsWith(Ks))||"file"===e.mode||"http"!==e.mode&&!l&&n,i?t=t.slice(Ks.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function nl(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):rl}async function rl(){$e("No file system access.")}function il(t){return t?async function(e,n){const r=Wn({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?zn(o[i])?o[i]():o.text():$e(o.status+""+o.statusText)}:ol}async function ol(){$e("No HTTP fetch method available.")}const al=t=>null!=t&&t===t,sl=t=>!Number.isNaN(+t)&&!(t instanceof Date),ll={boolean:pr,integer:pn,number:pn,date:gr,string:yr,unknown:Ve},ul=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>sl(t)&&Number.isInteger(+t),sl,t=>!Number.isNaN(Date.parse(t))],cl=["boolean","integer","number","date"];function fl(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=ul.length,i=ul.map(((t,e)=>e+1));for(let o,a,s=0,l=0;s<n;++s)for(a=e?t[s][e]:t[s],o=0;o<r;++o)if(i[o]&&al(a)&&!ul[o](a)&&(i[o]=0,++l,l===ul.length))return"string";return cl[i.reduce(((t,e)=>0===t?e:t),0)-1]}function dl(t,e){return e.reduce(((e,n)=>(e[n]=fl(t,n),e)),{})}function hl(t){const e=function(e,n){const r={delimiter:t};return pl(e,n?Wn(n,r):r)};return e.responseType="text",e}function pl(t,e){return e.header&&(t=e.header.map(hr).join(e.delimiter)+"\n"+t),Fr(e.delimiter).parse(t+"")}function ml(t,e){const n=e&&e.property?Ze(e.property):Ve;return!ln(t)||(r=t,"function"===typeof Buffer&&zn(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!sn(t)&&er(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}pl.responseType="text",ml.responseType="json";const gl={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function yl(t,e){let n,r,i,o;return t=ml(t,e),e&&e.feature?(n=Nr,i=e.feature):e&&e.mesh?(n=Pr,i=e.mesh,o=gl[e.filter]):$e("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):$e("Invalid TopoJSON object: "+i),r&&r.features||[r]}yl.responseType="json";const vl={dsv:pl,csv:hl(","),tsv:hl("\t"),json:ml,topojson:yl};function bl(t,e){return arguments.length>1?(vl[t]=e,this):Yn(vl,t)?vl[t]:null}function xl(t){const e=bl(t);return e&&e.responseType||"text"}function _l(t,e,n,r){const i=bl((e=e||{}).type||"json");return i||$e("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=Hs();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,l,u,c,f=t.columns||Object.keys(t[0]);"auto"===e&&(e=dl(t,f));f=Object.keys(e);const d=f.map((t=>{const i=e[t];let o,a;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){o=i.split(/:(.+)?/,2),a=o[1],("'"===a[0]&&"'"===a[a.length-1]||'"'===a[0]&&'"'===a[a.length-1])&&(a=a.slice(1,-1));return("utc"===o[0]?r:n)(a)}if(!ll[i])throw Error("Illegal format pattern: "+t+":"+i);return ll[i]}));for(s=0,u=t.length,c=f.length;s<u;++s)for(o=t[s],l=0;l<c;++l)a=f[l],o[a]=d[l](o[a])}(t,e.parse,n,r),Yn(t,"columns")&&delete t.columns,t}const wl=function(t,e){return n=>({options:n||{},sanitize:el,load:tl,fileAccess:!!e,file:nl(e),http:il(t)})}("undefined"!==typeof fetch&&fetch,null);function kl(t){const e=t||Ve,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function Al(t,e){try{await e(t)}catch(n){t.error(n)}}const El=Symbol("vega_id");let Ml=1;function Cl(t){return!(!t||!Sl(t))}function Sl(t){return t[El]}function Dl(t,e){return t[El]=e,t}function Fl(t){const e=t===Object(t)?t:{data:t};return Sl(e)?e:Dl(e,Ml++)}function Tl(t){return Nl(t,Fl({}))}function Nl(t,e){for(const n in t)e[n]=t[n];return e}function Ol(t,e){return Dl(e,Sl(t))}function zl(t,e){return t?e?(n,r)=>t(n,r)||Sl(e(n))-Sl(e(r)):(e,n)=>t(e,n)||Sl(e)-Sl(n):null}function Rl(t){return t&&t.constructor===Pl}function Pl(){const t=[],e=[],n=[],r=[],i=[];let o=null,a=!1;return{constructor:Pl,insert(e){const n=Nn(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=zn(t)?r:e,i=Nn(t),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify(t,e,r){const o={field:e,value:qn(r)};return zn(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return zn(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return a=!0,this},pulse(s,l){const u={},c={};let f,d,h,p,m,g;for(f=0,d=l.length;f<d;++f)u[Sl(l[f])]=1;for(f=0,d=e.length;f<d;++f)m=e[f],u[Sl(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach((t=>{p(t)&&(u[Sl(t)]=-1)}));for(f=0,d=t.length;f<d;++f)m=t[f],g=Sl(m),u[g]?u[g]=1:s.add.push(Fl(t[f]));for(f=0,d=l.length;f<d;++f)m=l[f],u[Sl(m)]<0&&s.rem.push(m);function y(t,e,n){n?t[e]=n(t):s.encode=e,a||(c[Sl(t)]=t)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,g=u[Sl(m)],g>0&&(y(m,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach((t=>{p(t)&&u[Sl(t)]>0&&y(t,h.field,h.value)})),s.modifies(h.field);if(a)s.mod=e.length||r.length?l.filter((t=>u[Sl(t)]>0)):l.slice();else for(g in c)s.mod.push(c[g]);return(o||null==o&&(e.length||r.length))&&s.clean(!0),s}}}const Bl="_:mod:_";function Ll(){Object.defineProperty(this,Bl,{writable:!0,value:{}})}Ll.prototype={set(t,e,n,r){const i=this,o=i[t],a=i[Bl];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,a[e+":"+t]=-1,a[t]=-1):(o!==n||r)&&(i[t]=n,a[t]=sn(n)?1+n.length:-1),i},modified(t,e){const n=this[Bl];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(sn(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[Bl]={},this}};let jl=0;const Ul=new Ll;function ql(t,e,n,r){this.id=++jl,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function Il(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}ql.prototype={targets(){return this._targets||(this._targets=kl(Ye))},set(t){return this.value!==t?(this.value=t,1):0},skip:Il(1),modified:Il(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new Ll,i=this._argops=this._argops||[],o=[];let a,s,l,u;const c=(t,n,a)=>{a instanceof ql?(a!==this&&(e&&a.targets().add(this),o.push(a)),i.push({op:a,name:t,index:n})):r.set(t,n,a)};for(a in t)if(s=t[a],"pulse"===a)Nn(s).forEach((t=>{t instanceof ql?t!==this&&(t.targets().add(this),o.push(t)):$e("Pulse parameters must be operator instances.")})),this.source=s;else if(sn(s))for(r.set(a,-1,Array(l=s.length)),u=0;u<l;++u)c(a,u,s[u]);else c(a,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(t){const e=this._argval||Ul,n=this._argops;let r,i,o,a;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===t,e.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let Wl=0;function $l(t,e,n){this.id=++Wl,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function Hl(t,e,n){return new $l(t,e,n)}$l.prototype={_filter:Qe,_apply:Ve,targets(){return this._targets||(this._targets=kl(Ye))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=Hl(t);return this.targets().add(e),e},apply(t){const e=Hl(null,t);return this.targets().add(e),e},merge(){const t=Hl();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=Hl();return this.targets().add(Hl(null,null,In(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(Hl(null,null,(()=>n=!0))),e.targets().add(Hl(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=Qe,this._targets=null}};const Zl={skip:!0};function Yl(t,e,n,r,i,o){const a=Wn({},o,Zl);let s,l;zn(n)||(n=qn(n)),void 0===r?s=e=>t.touch(n(e)):zn(r)?(l=new ql(null,r,i,!1),s=e=>{l.evaluate(e);const r=n(e),i=l.value;Rl(i)?t.pulse(r,i,o):t.update(r,i,a)}):s=e=>t.update(n(e),r,a),e.apply(s)}function Vl(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const a=o||{},s=new ql(null,function(t,e){return e=zn(e)?e:qn(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(a.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const Gl={};function Xl(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Ql(t,e){const n=[];return xr(t,e,(t=>n.push(t))),n}function Jl(t,e){const n={};return t.visit(e,(t=>{n[Sl(t)]=1})),t=>n[Sl(t)]?null:t}function Kl(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function tu(t,e,n,r){const i=this;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===e){if(a.fields){const t=i.fields||(i.fields={});for(const e in a.fields)t[e]=1}a.changed(i.ADD)&&(o|=i.ADD),a.changed(i.REM)&&(o|=i.REM),a.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function eu(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}Xl.prototype={StopPropagation:Gl,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new Xl(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new Xl(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,Jl(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return sn(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?sn(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Kl(n.addF,e)),2&t&&(n.remF=Kl(n.remF,e)),4&t&&(n.modF=Kl(n.modF,e)),16&t&&(n.srcF=Kl(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=Ql(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=Ql(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=Ql(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return xr(n.source,n.srcF,r),n;1&t&&xr(n.add,n.addF,r),2&t&&xr(n.rem,n.remF,r),4&t&&xr(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||xr(i,t?Jl(n,5):n.srcF,r)}return n}},Qn(tu,Xl,{fork(t){const e=new Xl(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?sn(t)?t.some((t=>n[t])):n[t]:0},filter(){$e("MultiPulse does not support filtering.")},materialize(){$e("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const nu={skip:!1,force:!1};function ru(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),iu(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,o=t[e];let a,s=1+(e<<1);for(;s<i;)a=s+1,a<i&&n(t[s],t[a])>=0&&(s=a),t[e]=t[s],s=1+((e=s)<<1);t[e]=o,iu(t,r,e,n)}(e,0,t)):r=n,r}}}function iu(t,e,n,r){let i,o;const a=t[n];for(;n>e&&(o=n-1>>1,i=t[o],r(a,i)<0);)t[n]=i,n=o;return t[n]=a}function ou(){this.logger(an()),this.logLevel(en),this._clock=0,this._rank=0,this._locale=Vs();try{this._loader=wl()}catch(t){}this._touched=kl(Ye),this._input={},this._pulse=null,this._heap=ru(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function au(t){return function(){return this._log[t].apply(this,arguments)}}function su(t,e){ql.call(this,t,null,e)}ou.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:au("error"),warn:au("warn"),info:au("info"),debug:au("debug"),logLevel:au("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,o=1;return t instanceof ql?i=t:t&&t.prototype instanceof ql?i=new t:zn(t)?i=new ql(null,t):(o=0,i=new ql(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&$e("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||nu);const r=new Xl(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||nu;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||nu;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:Pl,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return _l(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0===--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(Qe).insert(o.data||[])),i.done(),o},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:xl(e&&e.type)});try{r=n.parse(r,e)}catch(o){i=-2,n.warn("Data ingestion failed",t,o)}}catch(o){i=-1,n.warn("Loading failed",t,o)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,o=Hl(n,r),a=function(t){t.dataflow=i;try{o.receive(t)}catch($e){i.error($e)}finally{i.run()}};let s;s="string"===typeof t&&"undefined"!==typeof document?document.querySelectorAll(t):Nn(t);const l=s.length;for(let u=0;u<l;++u)s[u].addEventListener(e,a);return o},on:function(t,e,n,r,i){return(t instanceof ql?Vl:Yl)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return eu(r);if(r._pending&&await r._pending,e&&await Al(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Xl(r,o,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=kl(Ye);let a,s,l,u=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,t)),s.then?s=await s:s.async&&(i.push(s.async),s=Gl),s!==Gl&&a._targets&&a._targets.forEach((t=>r._enqueue(t))),++u):r._enqueue(a,!0)}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug("Pulse ".concat(o,": ").concat(u," operators")),l&&(r._postrun=[],r.error(l)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await Al(r,t[e].callback)}return n&&await Al(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(c){r.error(c)}}))})))),r},run:function(t,e,n){return this._pulse?eu(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&sn(n)?new tu(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){if(e&&e.stamp===t.stamp)return e;t=t.fork(),e&&e!==Gl&&(t.source=e.source);return t}(this._pulse,n&&n.pulse)}},Qn(su,ql,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const lu={};function uu(t){const e=cu(t);return e&&e.Definition||null}function cu(t){return t=t&&t.toLowerCase(),Yn(lu,t)?lu[t]:null}function fu(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function du(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function hu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vi;if(t===Vi)return pu;if("function"!==typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}function pu(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function mu(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?pu:hu(i);r>n;){if(r-n>600){const o=r-n+1,a=e-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);mu(t,e,Math.max(n,Math.floor(e-a*l/o+u)),Math.min(r,Math.floor(e+(o-a)*l/o+u)),i)}const o=t[e];let a=n,s=r;for(gu(t,n,e),i(t[r],o)>0&&gu(t,n,r);a<s;){for(gu(t,a,s),++a,--s;i(t[a],o)<0;)++a;for(;i(t[s],o)>0;)--s}0===i(t[n],o)?gu(t,n,s):(++s,gu(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function gu(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function yu(t){return null===t?NaN:+t}function vu(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return du(t);if(e>=1)return fu(t);var r,i=(r-1)*e,o=Math.floor(i),a=fu(mu(t,o).subarray(0,o+1));return a+(du(t.subarray(o+1))-a)*(i-o)}}function bu(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yu;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}}function xu(t,e){return vu(t,.5,e)}function*_u(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function wu(t,e,n){const r=Float64Array.from(_u(t,n));return r.sort(Vi),e.map((t=>bu(r,t)))}function ku(t,e){return wu(t,[.25,.5,.75],e)}function Au(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let a of t)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of t)null!=(s=e(s,++a,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=ku(t,e),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function Eu(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let o,a,s,l,u,c,f=t.extent[0],d=t.extent[1];const h=t.span||d-f||Math.abs(f)||1;if(t.step)o=t.step;else if(t.steps){for(l=h/e,u=0,c=t.steps.length;u<c&&t.steps[u]<l;++u);o=t.steps[Math.max(0,u-1)]}else{for(a=Math.ceil(Math.log(e)/r),s=t.minstep||0,o=Math.max(s,Math.pow(n,Math.round(Math.log(h)/r)-a));Math.ceil(h/o)>e;)o*=n;for(u=0,c=i.length;u<c;++u)l=o/i[u],l>=s&&h/l<=e&&(o=l)}l=Math.log(o);const p=l>=0?0:1+~~(-l/r),m=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(l=Math.floor(f/o+m)*o,f=f<l?l-o:l,d=Math.ceil(d/o)*o),{start:f,stop:d===f?f+o:d,step:o}}var Mu=Math.random;function Cu(t){Mu=t}function Su(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(_u(t,r)),o=i.length,a=e;let s,l,u,c;for(u=0,c=Array(a);u<a;++u){for(s=0,l=0;l<o;++l)s+=i[~~(Mu()*o)];c[u]=s/o}return c.sort(Vi),[vu(c,n/2),vu(c,1-n/2)]}function Du(t,e,n,r){r=r||(t=>t);const i=t.length,o=new Float64Array(i);let a,s=0,l=1,u=r(t[0]),c=u,f=u+e;for(;l<i;++l){if(a=r(t[l]),a>=f){for(c=(u+c)/2;s<l;++s)o[s]=c;f=a+e,u=a}c=a}for(c=(u+c)/2;s<l;++s)o[s]=c;return n?function(t,e){const n=t.length;let r,i,o=0,a=1;for(;t[o]===t[a];)++a;for(;a<n;){for(r=a+1;t[a]===t[r];)++r;if(t[a]-t[a-1]<e){for(i=a+(o+r-a-a>>1);i<a;)t[i++]=t[a];for(;i>a;)t[i--]=t[o]}o=a,a=r}return t}(o,e+e/4):o}function Fu(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}}function Tu(t,e){let n,r,i;null==e&&(e=t,t=0);const o={min(t){return arguments.length?(n=t||0,i=r-n,o):n},max(t){return arguments.length?(r=t||0,i=r-n,o):r},sample:()=>n+Math.floor(i*Mu()),pdf:t=>t===Math.floor(t)&&t>=n&&t<r?1/i:0,cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf:t=>t>=0&&t<=1?n-1+Math.floor(t*i):NaN};return o.min(t).max(e)}const Nu=Math.sqrt(2*Math.PI),Ou=Math.SQRT2;let zu=NaN;function Ru(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(zu===zu)i=zu,zu=NaN;else{do{i=2*Mu()-1,o=2*Mu()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,zu=o*r}return t+i*e}function Pu(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*Nu)}function Bu(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,o=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,o/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,o=t/e/2.506628274631)}return r>0?1-o:o}function Lu(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*Ou*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function ju(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Ru(n,r),pdf:t=>Pu(t,n,r),cdf:t=>Bu(t,n,r),icdf:t=>Lu(t,n,r)};return i.mean(t).stdev(e)}function Uu(t,e){const n=ju();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=Au(t)),i):e},sample:()=>t[~~(Mu()*r)]+e*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-t[a])/e);return o/e/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-t[a])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function qu(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+Ru()*e)}function Iu(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*Nu*t)}function Wu(t,e,n){return Bu(Math.log(t),e,n)}function $u(t,e,n){return Math.exp(Lu(t,e,n))}function Hu(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>qu(n,r),pdf:t=>Iu(t,n,r),cdf:t=>Wu(t,n,r),icdf:t=>$u(t,n,r)};return i.mean(t).stdev(e)}function Zu(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=Mu();let i=t[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(e<o){i=t[a];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)}function Yu(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*Mu()}function Vu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function Gu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function Xu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function Qu(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Yu(n,r),pdf:t=>Vu(t,n,r),cdf:t=>Gu(t,n,r),icdf:t=>Xu(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}function Ju(t,e,n){let r=0,i=0;for(const o of t){const t=n(o);null==e(o)||null==t||isNaN(t)||(r+=(t-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function Ku(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-o*t,o]}function tc(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,o=new Float64Array(i),a=new Float64Array(i);let s,l,u,c=0,f=0,d=0;for(u of t)o[c]=s=+e(u),a[c]=l=+n(u),++c,f+=(s-f)/c,d+=(l-d)/c;for(c=0;c<i;++c)o[c]-=f,a[c]-=d;return[o,a,f,d]}function ec(t,e,n,r){let i,o,a=-1;for(const s of t)i=e(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}function nc(t,e,n,r,i){let o=0,a=0;return ec(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;o+=n*n,a+=s*s})),1-o/a}function rc(t,e,n){let r=0,i=0,o=0,a=0,s=0;ec(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=Ku(r,i,o,a),u=t=>l[0]+l[1]*t;return{coef:l,predict:u,rSquared:nc(t,e,n,i,u)}}function ic(t,e,n){let r=0,i=0,o=0,a=0,s=0;ec(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));const l=Ku(r,i,o,a),u=t=>l[0]+l[1]*Math.log(t);return{coef:l,predict:u,rSquared:nc(t,e,n,i,u)}}function oc(t,e,n){const[r,i,o,a]=tc(t,e,n);let s,l,u,c=0,f=0,d=0,h=0,p=0;ec(t,e,n,((t,e)=>{s=r[p++],l=Math.log(e),u=s*e,c+=(e*l-c)/p,f+=(u-f)/p,d+=(u*l-d)/p,h+=(s*u-h)/p}));const[m,g]=Ku(f/a,c/a,d/a,h/a),y=t=>Math.exp(m+g*(t-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:nc(t,e,n,a,y)}}function ac(t,e,n){let r=0,i=0,o=0,a=0,s=0,l=0;ec(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++l,r+=(n-r)/l,i+=(u-i)/l,o+=(n*u-o)/l,a+=(n*n-a)/l,s+=(e-s)/l}));const u=Ku(r,i,o,a),c=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:nc(t,e,n,s,c)}}function sc(t,e,n){const[r,i,o,a]=tc(t,e,n),s=r.length;let l,u,c,f,d=0,h=0,p=0,m=0,g=0;for(l=0;l<s;)u=r[l],c=i[l++],f=u*u,d+=(f-d)/l,h+=(f*u-h)/l,p+=(f*f-p)/l,m+=(u*c-m)/l,g+=(f*c-g)/l;const y=p-d*d,v=d*y-h*h,b=(g*d-m*h)/v,x=(m*y-g*h)/v,_=-b*d,w=t=>b*(t-=o)*t+x*t+_+a;return{coef:[_-x*o+b*o*o+a,x-2*b*o,b],predict:w,rSquared:nc(t,e,n,a,w)}}function lc(t,e,n,r){if(0===r)return Ju(t,e,n);if(1===r)return rc(t,e,n);if(2===r)return sc(t,e,n);const[i,o,a,s]=tc(t,e,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d)*o[p];for(u.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(u);const y=function(t){const e=t.length-1,n=[];let r,i,o,a,s;for(r=0;r<e;++r){for(a=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][a])&&(a=i);for(o=r;o<e+1;++o)s=t[o][r],t[o][r]=t[o][a],t[o][a]=s;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,o=i+1;o<e;++o)s+=t[o][i]*n[o];n[i]=(t[e][i]-s)/t[i][i]}return n}(c),v=t=>{t-=a;let e=s+y[0]+y[1]*t+y[2]*t*t;for(d=3;d<f;++d)e+=y[d]*Math.pow(t,d);return e};return{coef:uc(f,y,-a,s),predict:v,rSquared:nc(t,e,n,s,v)}}function uc(t,e,n,r){const i=Array(t);let o,a,s,l;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(s=e[o],l=1,i[o]+=s,a=1;a<=o;++a)l*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*l;return i[0]+=r,i}const cc=2,fc=1e-12;function dc(t,e,n,r){const[i,o,a,s]=tc(t,e,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=cc;){const t=[0,u-1];for(let n=0;n<l;++n){const e=i[n],r=t[0],a=t[1],s=e-i[r]>i[a]-e?r:a;let l=0,u=0,h=0,p=0,m=0;const g=1/Math.abs(i[s]-e||1);for(let t=r;t<=a;++t){const n=i[t],r=o[t],a=hc(Math.abs(e-n)*g)*d[t],s=n*a;l+=a,u+=s,h+=r*a,p+=r*s,m+=n*s}const[y,v]=Ku(u/l,h/l,p/l,m/l);c[n]=y+v*e,f[n]=Math.abs(o[n]-c[n]),pc(i,n+1,t)}if(h===cc)break;const e=xu(f);if(Math.abs(e)<fc)break;for(let n,r,i=0;i<l;++i)n=f[i]/(6*e),d[i]=n>=1?fc:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,o=[];let a,s=0,l=0,u=[];for(;s<i;++s)a=t[s]+n,u[0]===a?u[1]+=(e[s]-u[1])/++l:(l=0,u[1]+=r,u=[a,e[s]],o.push(u));return u[1]+=r,o}(i,c,a,s)}function hc(t){return(t=1-t*t*t)*t*t}function pc(t,e,n){const r=t[e];let i=n[0],o=n[1]+1;if(!(o>=t.length))for(;e>i&&t[o]-r<=r-t[i];)n[0]=++i,n[1]=o,++o}const mc=.5*Math.PI/180;function gc(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],a=e[1],s=a-o,l=s/r,u=[i(o)],c=[];if(n===r){for(let t=1;t<r;++t)u.push(i(o+t/n*s));return u.push(i(a)),u}c.push(i(a));for(let m=n;--m>0;)c.push(i(o+m/n*s));let f=u[0],d=c[c.length-1];const h=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let o=0;o<i;++o){const t=e[o][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(f[1],c);for(;d;){const t=i((f[0]+d[0])/2);t[0]-f[0]>=l&&yc(f,t,d,h,p)>mc?c.push(t):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function yc(t,e,n,r,i){const o=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),a=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(o-a)}function vc(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function bc(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function xc(t,e,n){return n||t+(e?"_"+e:"")}const _c=()=>{},wc={init:_c,add:_c,rem:_c,idx:0},kc={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.valid?t.sum:void 0,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(t,e)=>{t.exp=0,t.exp_r=e},value:t=>t.valid?t.exp*(1-t.exp_r)/(1-t.exp_r**t.valid):void 0,add:(t,e)=>t.exp=t.exp_r*t.exp+e,rem:(t,e)=>t.exp=(t.exp-e/t.exp_r**(t.valid-1))/t.exp_r},exponentialb:{value:t=>t.valid?t.exp*(1-t.exp_r):void 0,req:["exponential"],idx:1}},Ac=Object.keys(kc).filter((t=>"__count__"!==t));function Ec(t,e,n){return kc[t](n,e)}function Mc(t,e){return t.idx-e.idx}function Cc(){this.valid=0,this.missing=0,this._ops.forEach((t=>null==t.aggregate_param?t.init(this):t.init(this,t.aggregate_param)))}function Sc(t,e){null!=t&&""!==t?t===t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function Dc(t,e){null!=t&&""!==t?t===t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function Fc(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function Tc(t,e){const n=e||Ve,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=kc[t]())}))};return t.forEach(n),Object.values(e).sort(Mc)}(t),i=t.slice().sort(Mc);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=Cc,o.prototype.add=Sc,o.prototype.rem=Dc,o.prototype.set=Fc,o.prototype.get=n,o.fields=t.map((t=>t.out)),o}function Nc(t){this._key=t?Ze(t):Sl,this.reset()}[...Ac,"__count__"].forEach((t=>{kc[t]=function(t,e){return(n,r)=>Wn({name:t,aggregate_param:r,out:n||t},wc,e)}(t,kc[t])}));const Oc=Nc.prototype;function zc(t){su.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Oc.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Oc.add=function(t){this._add.push(t)},Oc.rem=function(t){this._rem.push(t)},Oc.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,o=Array(r-i),a={};let s,l,u;for(s=0;s<i;++s)a[n(e[s])]=1;for(s=0,l=0;s<r;++s)a[n(u=t[s])]?a[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o},Oc.distinct=function(t){const e=this.values(),n={};let r,i=e.length,o=0;for(;--i>=0;)r=t(e[i])+"",Yn(n,r)||(n[r]=1,++o);return o},Oc.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=Hn(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},Oc.argmin=function(t){return this.extent(t)[0]||{}},Oc.argmax=function(t){return this.extent(t)[1]||{}},Oc.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},Oc.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},Oc.quartile=function(t){return this._get===t&&this._q||(this._q=ku(this.values(),t),this._get=t),this._q},Oc.q1=function(t){return this.quartile(t)[0]},Oc.q2=function(t){return this.quartile(t)[1]},Oc.q3=function(t){return this.quartile(t)[2]},Oc.ci=function(t){return this._get===t&&this._ci||(this._ci=Su(this.values(),1e3,.05,t),this._get=t),this._ci},Oc.ci0=function(t){return this.ci(t)[0]},Oc.ci1=function(t){return this.ci(t)[1]},zc.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Ac},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},Qn(zc,su,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):Object.create(null),e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function o(t){let e,o,a,s;for(e in t)for(a=t[e].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(t._prev),o(e),function o(a,s,l){const u=n[l],c=r[l++];for(const n in c){const r=a?a+"|"+n:n;s[u]=c[n],l<i?o(r,s,l):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=Nn(Ue(t)),i=n.length;let o,a=0;for(;a<i;++a)r[o=n[a]]||(r[o]=1,e.push(o))}this._dims=Nn(t.groupby),this._dnames=this._dims.map((t=>{const e=je(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:bc(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=t.fields||[null],a=t.ops||["count"],s=t.aggregate_params||[null],l=t.as||[],u=o.length,c={};let f,d,h,p,m,g,y;for(u!==a.length&&$e("Unmatched number of fields and aggregate ops."),y=0;y<u;++y)f=o[y],d=a[y],h=s[y]||null,null==f&&"count"!==d&&$e("Null aggregate field specified."),m=je(f),g=xc(d,m,l[y]),n.push(g),"count"!==d?(p=c[m],p||(i(f),p=c[m]=[],p.field=f,this._measures.push(p)),"count"!==d&&(this._countOnly=!1),p.push(Ec(d,h,g))):this._counts.push(g);return this._measures=this._measures.map((t=>Tc(t,t.field))),Object.create(null)},cellkey:bc(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new Nc),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](t);return e?Ol(e.tuple,o):Fl(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,a=t.rem,s=t.mod;let l,u,c,f;if(r)for(u in r)l=r[u],i&&!l.num||a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(e[c])),e[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(0===l.num&&i?a:s).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,t}});function Rc(t){su.call(this,null,t)}function Pc(t,e,n){const r=t;let i=e||[],o=n||[],a={},s=0;return{add:t=>o.push(t),remove:t=>a[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter((t=>!a[r(t)])),a={},s=0),e&&t&&i.sort(t),o.length&&(i=t?ur(t,i,o.sort(t)):i.concat(o),o=[]),i)}}function Bc(t){su.call(this,[],t)}function Lc(t){ql.call(this,null,jc,t)}function jc(t){return this.value&&!t.modified()?this.value:Pn(t.fields,t.orders)}function Uc(t){su.call(this,null,t)}function qc(t){su.call(this,null,t)}Rc.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},Qn(Rc,su,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,a=t.as||["bin0","bin1"],s=a[0],l=a[1];let u;return u=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(Ue(t.field))?e.ADD_MOD:e.ADD,e.visit(u,n?t=>{const e=r(t);t[s]=e,t[l]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[s]=r(t)),e.modifies(n?a:s)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=Eu(t),r=n.step;let i,o,a=n.start,s=a+Math.ceil((n.stop-a)/r)*r;null!=(i=t.anchor)&&(o=i-(a+r*Math.floor((i-a)/r)),a+=o,s+=o);const l=function(t){let n=pn(e(t));return null==n?null:n<a?-1/0:n>s?1/0:(n=Math.max(a,Math.min(n,s-r)),a+r*Math.floor(1e-14+(n-a)/r))};return l.start=a,l.stop=n.stop,l.step=r,this.value=Le(l,Ue(e),t.name||"bin_"+je(e))}}),Bc.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Qn(Bc,su,{transform(t,e){const n=e.fork(e.ALL),r=Pc(Sl,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(zl(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),Qn(Lc,ql),Uc.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},Qn(Uc,su,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,o)||[],l=0,u=i.length;l<u;++l)a.test(r=i[l])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,a=this._stop,s=t.field,l=t.as||["text","count"],u=n((t=>i[t]=1+(i[t]||0))),c=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,u):(e.visit(e.ADD,u),e.visit(e.REM,c)),this._finish(e,l)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],o=e[1],a=t.fork(t.NO_SOURCE|t.NO_FIELDS);let s,l,u;for(s in n)l=r[s],u=n[s]||0,!l&&u?(r[s]=l=Fl({}),l[i]=s,l[o]=u,a.add.push(l)):0===u?(l&&a.rem.push(l),n[s]=null,r[s]=null):l[o]!==u&&(l[o]=u,a.mod.push(l));return a.modifies(e)}}),qc.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Qn(qc,su,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],o=r[1],a=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,o,a=[],s={},l=t.length,u=0;u<l;++u)for(s[e]=o=t[u],i=0;i<l;++i)s[n]=t[i],r(s)&&(a.push(Fl(s)),(s={})[e]=o);return a}(s,i,o,t.filter||Qe)):n.mod=s,n.source=this.value,n.modifies(r)}});const Ic={kde:Uu,mixture:Zu,normal:ju,lognormal:Hu,uniform:Qu},Wc="function";function $c(t,e){const n=t[Wc];Yn(Ic,n)||$e("Unknown distribution function: "+n);const r=Ic[n]();for(const i in t)"field"===i?r.data((t.from||e()).map(t[i])):"distributions"===i?r[i](t[i].map((t=>$c(t,e)))):typeof r[i]===Wc&&r[i](t[i]);return r}function Hc(t){su.call(this,null,t)}const Zc=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Yc={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Zc},{name:"weights",type:"number",array:!0}]};function Vc(t,e){return t?t.map(((t,n)=>e[n]||je(t))):null}function Gc(t,e,n){const r=[],i=t=>t(l);let o,a,s,l,u,c;if(null==e)r.push(t.map(n));else for(o={},a=0,s=t.length;a<s;++a)l=t[a],u=e.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}Hc.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Zc.concat(Yc)},{name:"as",type:"string",array:!0,default:["value","density"]}]},Qn(Hc,su,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=$c(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let a=t.method||"pdf";"pdf"!==a&&"cdf"!==a&&$e("Invalid density method: "+a),t.extent||r.data||$e("Missing density extent parameter."),a=r[a];const s=t.as||["value","density"],l=gc(a,t.extent||$n(r.data()),i,o).map((t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],Fl(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function Xc(t){su.call(this,null,t)}Xc.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function Qc(t){ql.call(this,null,Jc,t),this.modified(!0)}function Jc(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Le((n=>e(n,t)),Ue(e),je(e))}function Kc(t){su.call(this,[void 0,void 0],t)}function tf(t,e){ql.call(this,t),this.parent=e,this.count=0}function ef(t){su.call(this,{},t),this._keys=Gn();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function nf(t){ql.call(this,null,rf,t)}function rf(t){return this.value&&!t.modified()?this.value:sn(t.name)?Nn(t.name).map((t=>Ze(t))):Ze(t.name,t.as)}function of(t){su.call(this,Gn(),t)}function af(t){su.call(this,[],t)}function sf(t){su.call(this,[],t)}function lf(t){su.call(this,null,t)}function uf(t){su.call(this,[],t)}Qn(Xc,su,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=Gc(e.source,t.groupby,Ve),i=t.smooth||!1,o=t.field,a=t.step||((t,e)=>dr($n(t,e))/30)(n,o),s=zl(((t,e)=>o(t)-o(e))),l=t.as||"bin",u=r.length;let c,f=1/0,d=-1/0,h=0;for(;h<u;++h){const t=r[h].sort(s);c=-1;for(const e of Du(t,a,i,o))e<f&&(f=e),e>d&&(d=e),t[++c][l]=e}return this.value={start:f,stop:d,step:a},e.reflow(!0).modifies(l)}}),Qn(Qc,ql),Kc.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Qn(Kc,su,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let o=n[0],a=n[1];if((i||null==o)&&(o=1/0,a=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=pn(r(t));null!=e&&(e<o&&(o=e),e>a&&(a=e))})),!Number.isFinite(o)||!Number.isFinite(a)){let t=je(r);t&&(t=' for field "'.concat(t,'"')),e.dataflow.warn("Infinite extent".concat(t,": [").concat(o,", ").concat(a,"]")),o=a=void 0}this.value=[o,a]}}),Qn(tf,ql,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),Qn(ef,su,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let o,a,s=Yn(i,t)&&i[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[t])&&a.tuple,o=n.dataflow,s=new tf(n.fork(n.NO_SOURCE),this),o.add(s).connect(e(o,t,a)),i[t]=s,this.activate(s)),s},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,a=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=Sl(t),n=o.get(e);void 0!==n&&(o.delete(e),s(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);o.set(Sl(t),e),s(e).add(t)})),a||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=Sl(t),n=o.get(e),i=r(t);n===i?s(i).mod(t):(o.set(e,i),s(n).rem(t),s(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{s(o.get(Sl(t))).mod(t)})),a&&e.visit(e.REFLOW,(t=>{const e=Sl(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),s(n).rem(t),s(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),Qn(nf,ql),of.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Qn(of,su,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),o=i.add,a=i.rem,s=i.mod,l=t.expr;let u=!0;function c(e){const n=Sl(e),i=l(e,t),c=r.get(n);i&&c?(r.delete(n),o.push(e)):i||c?u&&i&&!c&&s.push(e):(r.set(n,1),a.push(e))}return e.visit(e.REM,(t=>{const e=Sl(t);r.has(e)?r.delete(e):a.push(t)})),e.visit(e.ADD,(e=>{l(e,t)?o.push(e):r.set(Sl(e),1)})),e.visit(e.MOD,c),t.modified()&&(u=!1,e.visit(e.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),af.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Qn(af,su,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Vc(r,t.as||[]),o=t.index||null,a=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),s=e.reduce(((t,e)=>Math.max(t,e.length)),0);let l,u,c,f=0;for(;f<s;++f){for(u=Tl(t),l=0;l<a;++l)u[i[l]]=null==(c=e[l][f])?null:c;o&&(u[o]=f),n.add.push(u)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),sf.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Qn(sf,su,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(je),o=t.as||["key","value"],a=o[0],s=o[1],l=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,o=0;o<l;++o)e=Tl(t),e[a]=i[o],e[s]=r[o](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(o)}}),lf.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Qn(lf,su,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,(e=>e[r]=n(e,t)))}}),Qn(uf,su,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,o,a,s=this.value,l=t.size-s.length;if(l>0){for(i=[];--l>=0;)i.push(a=Fl(r(t))),s.push(a);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=s.slice(0,-l),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,s=s.slice(-l);return n.source=this.value=s,n}});const cf={value:"value",median:xu,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:du,max:fu},ff=[];function df(t){su.call(this,[],t)}function hf(t){zc.call(this,t)}function pf(t){su.call(this,null,t)}function mf(t){ql.call(this,null,gf,t)}function gf(t){return this.value&&!t.modified()?this.value:or(t.fields,t.flat)}function yf(t){su.call(this,[],t),this._pending=null}function vf(t,e,n){n.forEach(Fl);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function bf(t){su.call(this,{},t)}function xf(t){ql.call(this,null,_f,t)}function _f(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,o=1/0,a=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<o&&(o=i[0]),i[1]>a&&(a=i[1]);return[o,a]}function wf(t){ql.call(this,null,kf,t)}function kf(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function Af(t){su.call(this,null,t)}function Ef(t){zc.call(this,t)}function Mf(t){ef.call(this,t)}function Cf(t){su.call(this,null,t)}function Sf(t){su.call(this,null,t)}function Df(t){su.call(this,null,t)}df.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Qn(df,su,{transform(t,e){var n,r,i,o,a,s,l,u,c,f,d=e.fork(e.ALL),h=function(t){var e,n=t.method||cf.value;if(null!=cf[n])return n===cf.value?(e=void 0!==t.value?t.value:0,()=>e):cf[n];$e("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),m=je(t.field),g=je(t.key),y=(t.groupby||[]).map(je),v=function(t,e,n,r){var i,o,a,s,l,u,c,f,d=t=>t(f),h=[],p=r?r.slice():[],m={},g={};for(p.forEach(((t,e)=>m[t]=e+1)),s=0,c=t.length;s<c;++s)u=n(f=t[s]),l=m[u]||(m[u]=p.push(u)),(a=g[o=(i=e?e.map(d):ff)+""])||(a=g[o]=[],h.push(a),a.values=i),a[l-1]=f;return h.domain=p,h}(e.source,t.groupby,t.key,t.keyvals),b=[],x=this.value,_=v.domain.length;for(a=0,u=v.length;a<u;++a)for(i=(n=v[a]).values,r=NaN,l=0;l<_;++l)if(null==n[l]){for(o=v.domain[l],f={_impute:!0},s=0,c=i.length;s<c;++s)f[y[s]]=i[s];f[g]=o,f[m]=Number.isNaN(r)?r=h(n,p):r,b.push(Fl(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),hf.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Ac},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},Qn(hf,zc,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{Wn(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),pf.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Qn(pf,su,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=Gc(r,t.groupby,t.field),o=(t.groupby||[]).map(je),a=t.bandwidth,s=t.cumulative?"cdf":"pdf",l=t.as||["value","density"],u=[];let c=t.extent,f=t.steps||t.minsteps||25,d=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&$e("Invalid density method: "+s),"shared"===t.resolve&&(c||(c=$n(r,t.field)),f=d=t.steps||d),i.forEach((e=>{const n=Uu(e,a)[s],r=t.counts?e.length:1;gc(n,c||$n(e),f,d).forEach((t=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=e.dims[r];n[l[0]]=t[0],n[l[1]]=t[1]*r,u.push(Fl(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),Qn(mf,ql),Qn(yf,su,{transform(t,e){const n=e.dataflow;if(this._pending)return vf(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return vf(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then((t=>(this._pending=Nn(t.data),t=>t.touch(this))));return{async:e}}return n.request(t.url,t.format).then((t=>vf(this,e,Nn(t.data))))}}),bf.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Qn(bf,su,{transform(t,e){const n=t.fields,r=t.index,i=t.values,o=null==t.default?null:t.default,a=t.modified(),s=n.length;let l,u,c,f=a?e.SOURCE:e.ADD,d=e,h=t.as;return i?(u=i.length,s>1&&!h&&$e('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==s*u&&$e('The "as" parameter has too few output field names.'),h=h||i.map(je),l=function(t){for(var e,a,l=0,c=0;l<s;++l)if(null==(a=r.get(n[l](t))))for(e=0;e<u;++e,++c)t[h[c]]=o;else for(e=0;e<u;++e,++c)t[h[c]]=i[e](a)}):(h||$e("Missing output field names."),l=function(t){for(var e,i=0;i<s;++i)e=r.get(n[i](t)),t[h[i]]=null==e?o:e}),a?d=e.reflow(!0):(c=n.some((t=>e.modified(t.fields))),f|=c?e.MOD:0),e.visit(f,l),d.modifies(h)}}),Qn(xf,ql),Qn(wf,ql),Qn(Af,su,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Ef.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Ac,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},Qn(Ef,zc,{_transform:zc.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=Ue(n).concat(Ue(r)),a=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(Bn),e?i.slice(0,e):i}(n,t.limit||0,e);e.changed()&&t.set("__pivot__",null,null,!0);return{key:t.key,groupby:t.groupby,ops:a.map((()=>i)),fields:a.map((t=>function(t,e,n,r){return Le((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,o))),as:a.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),Qn(Mf,ef,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Sl(t),n,e,t);return(t.modified("field")||r&&e.modified(Ue(r)))&&$e("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(Fl(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),Cf.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Qn(Cf,su,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Vc(t.fields,t.as||[]),o=r?(t,e)=>function(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):Nl;let a;return this.value?a=this.value:(e=e.addAll(),a=this.value={}),e.visit(e.REM,(t=>{const e=Sl(t);n.rem.push(a[e]),a[e]=null})),e.visit(e.ADD,(t=>{const e=o(t,Fl({}));a[Sl(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(o(t,a[Sl(t)]))})),n}}),Qn(Sf,su,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),Df.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Ff(t){su.call(this,null,t)}function Tf(t){su.call(this,[],t),this.count=0}function Nf(t){su.call(this,null,t)}function Of(t){su.call(this,null,t),this.modified(!0)}function zf(t){su.call(this,null,t)}Qn(Df,su,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=Gc(e.materialize(e.SOURCE).source,t.groupby,t.field),o=(t.groupby||[]).map(je),a=[],s=t.step||.01,l=t.probs||vc(s/2,1-1e-14,s),u=l.length;return i.forEach((t=>{const e=wu(t,l);for(let n=0;n<u;++n){const i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[r[0]]=l[n],i[r[1]]=e[n],a.push(Fl(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),Qn(Ff,su,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=Sl(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=Tl(t);r[Sl(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[Sl(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),Tf.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Qn(Tf,su,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value.reduce(((t,e)=>(t[Sl(e)]=1,t)),{});let a=this.value,s=this.count,l=0;function u(t){let e,r;a.length<i?a.push(t):(r=~~((s+1)*Mu()),r<a.length&&r>=l&&(e=a[r],o[Sl(e)]&&n.rem.push(e),a[r]=t)),++s}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=Sl(t);o[e]&&(o[e]=-1,n.rem.push(t)),--s})),a=a.filter((t=>-1!==o[Sl(t)]))),(e.rem.length||r)&&a.length<i&&e.source&&(l=s=a.length,e.visit(e.SOURCE,(t=>{o[Sl(t)]||u(t)})),l=-1),r&&a.length>i){const t=a.length-i;for(let e=0;e<t;++e)o[Sl(a[e])]=-1,n.rem.push(a[e]);a=a.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{o[Sl(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,u),(e.add.length||l<0)&&(n.add=a.filter((t=>!o[Sl(t)]))),this.count=s,this.value=n.source=a,n}}),Nf.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Qn(Nf,su,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=vc(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,Fl(e)})),n.add=e.add.concat(this.value),n}}),Qn(Of,su,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const Rf=["unit0","unit1"];function Pf(t){su.call(this,Gn(),t)}function Bf(t){su.call(this,null,t)}zf.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:uo,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Rf}]},Qn(zf,su,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),a=(i?Uo:jo)(o.unit).offset,s=t.as||Rf,l=s[0],u=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=e.ADD;return(t.modified()||e.changed(e.REM)||e.modified(Ue(n)))&&(h=(e=e.reflow(!0)).SOURCE,f=1/0,d=-1/0),e.visit(h,(t=>{const e=n(t);let i,s;null==e?(t[l]=null,r&&(t[u]=null)):(t[l]=i=s=o(e),r&&(t[u]=s=a(i,c)),i<f&&(f=i),s>d&&(d=s))})),o.start=f,o.stop=d,e.modifies(r?s:l)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:sa({extent:t.extent||$n(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),o=fo(r),a=this.value||{},s=(n?Po:Oo)(o,i);return s.unit=hn(o),s.units=o,s.step=i,s.start=a.start,s.stop=a.stop,this.value=s}}),Qn(Pf,su,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let a=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),Qn(Bf,su,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(zl(t.sort)):e.source).map(t.field))}});const Lf={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=Lf.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||$e("ntile num must be greater than zero.");const n=Lf.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||$e("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n){if(null!=t(e[n]))return n}return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}};const jf=Object.keys(Lf);function Uf(t){const e=Nn(t.ops),n=Nn(t.fields),r=Nn(t.params),i=Nn(t.aggregate_params),o=Nn(t.as),a=this.outputs=[],s=this.windows=[],l={},u={},c=[],f=[];let d=!0;function h(t){Nn(Ue(t)).forEach((t=>l[t]=1))}h(t.sort),e.forEach(((t,e)=>{const l=n[e],p=r[e],m=i[e]||null,g=je(l),y=xc(t,g,o[e]);if(h(l),a.push(y),Yn(Lf,t))s.push(function(t,e,n,r){const i=Lf[t](e,n);return{init:i.init||Ge,update:function(t,e){e[r]=i.next(t)}}}(t,l,p,y));else{if(null==l&&"count"!==t&&$e("Null aggregate field specified."),"count"===t)return void c.push(y);d=!1;let e=u[g];e||(e=u[g]=[],e.field=l,f.push(e)),e.push(Ec(t,m,y))}})),(c.length||f.length)&&(this.cell=function(t,e,n){t=t.map((t=>Tc(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new t[a](r);if(r.store)var s=r.data=new Nc;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,a;for(s&&s.values(),i=0,a=e.length;i<a;++i)t[e[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)o[t].init()},r}(f,c,d)),this.inputs=Object.keys(l)}const qf=Uf.prototype;function If(t){su.call(this,{},t),this._mlen=0,this._mods=[]}function Wf(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=t.data(n),l=s.length,u=o?Xi(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||qn(-1)};e.init();for(let f=0;f<l;++f)$f(c,a,f,l),o&&Hf(c,u),e.update(c,s[f])}function $f(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Hf(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}function Zf(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Yf(t){this._context=t}function Vf(){}function Gf(t){this._context=t}function Xf(t){this._context=t}function Qf(t,e){this._basis=new Yf(t),this._beta=e}qf.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},qf.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,o=r&&r.length;let a;if(n){for(a=t.p0;a<t.i0;++a)n.rem(i[a]);for(a=t.p1;a<t.i1;++a)n.add(i[a]);n.set(e)}for(a=0;a<o;++a)r[a].update(t,e)},If.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:jf.concat(Ac)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},Qn(If,su,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=zl(t.sort),i=bc(t.groupby),o=t=>this.group(i(t));let a=this.state;a&&!n||(a=this.state=new Uf(t)),n||e.modified(a.inputs)?(this.value={},e.visit(e.SOURCE,(t=>o(t).add(t)))):(e.visit(e.REM,(t=>o(t).remove(t))),e.visit(e.ADD,(t=>o(t).add(t))));for(let s=0,l=this._mlen;s<l;++s)Wf(this._mods[s],a,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(a.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=Pc(Sl),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),Yf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Zf(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Zf(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Gf.prototype={areaStart:Vf,areaEnd:Vf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Zf(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Xf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Zf(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Qf.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*a),this._beta*e[l]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const Jf=function t(e){function n(t){return 1===e?new Yf(t):new Qf(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Kf(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function td(t,e){this._context=t,this._k=(1-e)/6}td.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Kf(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Kf(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const ed=function t(e){function n(t){return new td(t,e)}return n.tension=function(e){return t(+e)},n}(0);function nd(t,e){this._context=t,this._k=(1-e)/6}nd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Kf(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const rd=function t(e){function n(t){return new nd(t,e)}return n.tension=function(e){return t(+e)},n}(0);function id(t,e){this._context=t,this._k=(1-e)/6}id.prototype={areaStart:Vf,areaEnd:Vf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Kf(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const od=function t(e){function n(t){return new id(t,e)}return n.tension=function(e){return t(+e)},n}(0),ad=Math.abs,sd=Math.atan2,ld=Math.cos,ud=Math.max,cd=Math.min,fd=Math.sin,dd=Math.sqrt,hd=1e-12,pd=Math.PI,md=pd/2,gd=2*pd;function yd(t){return t>=1?md:t<=-1?-md:Math.asin(t)}function vd(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>hd){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>hd){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function bd(t,e){this._context=t,this._alpha=e}bd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:vd(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const xd=function t(e){function n(t){return e?new bd(t,e):new td(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function _d(t,e){this._context=t,this._alpha=e}_d.prototype={areaStart:Vf,areaEnd:Vf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:vd(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const wd=function t(e){function n(t){return e?new _d(t,e):new id(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function kd(t,e){this._context=t,this._alpha=e}kd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:vd(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Ad=function t(e){function n(t){return e?new kd(t,e):new nd(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Ed(t){this._context=t}function Md(t){return new Ed(t)}function Cd(t){this._context=t}function Sd(t){return t<0?-1:1}function Dd(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Sd(o)+Sd(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Fd(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Td(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function Nd(t){this._context=t}function Od(t){this._context=new zd(t)}function zd(t){this._context=t}function Rd(t){this._context=t}function Pd(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function Bd(t,e){this._context=t,this._t=e}function Ld(t){return function(){return t}}function jd(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Ud,qd,Id,Wd,$d,Hd,Zd,Yd,Vd,Gd,Xd,Qd,Jd,Kd;Ed.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},Cd.prototype={areaStart:Vf,areaEnd:Vf,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Nd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Td(this,this._t0,Fd(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Td(this,Fd(this,n=Dd(this,t,e)),n);break;default:Td(this,this._t0,n=Dd(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Od.prototype=Object.create(Nd.prototype)).point=function(t,e){Nd.prototype.point.call(this,e,t)},zd.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},Rd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=Pd(t),i=Pd(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Bd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const th=Math.PI,eh=2*th,nh=1e-6,rh=eh-nh;function ih(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class oh{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?ih:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: ".concat(t));if(e>15)return ih;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append(Ud||(Ud=jd(["M",",",""])),this._x0=this._x1=+t,this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(qd||(qd=jd(["Z"]))))}lineTo(t,e){this._append(Id||(Id=jd(["L",",",""])),this._x1=+t,this._y1=+e)}quadraticCurveTo(t,e,n,r){this._append(Wd||(Wd=jd(["Q",",",",",",",""])),+t,+e,this._x1=+n,this._y1=+r)}bezierCurveTo(t,e,n,r,i,o){this._append($d||($d=jd(["C",",",",",",",",",",",""])),+t,+e,+n,+r,this._x1=+i,this._y1=+o)}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let o=this._x1,a=this._y1,s=n-t,l=r-e,u=o-t,c=a-e,f=u*u+c*c;if(null===this._x1)this._append(Hd||(Hd=jd(["M",",",""])),this._x1=t,this._y1=e);else if(f>nh)if(Math.abs(c*s-l*u)>nh&&i){let d=n-o,h=r-a,p=s*s+l*l,m=d*d+h*h,g=Math.sqrt(p),y=Math.sqrt(f),v=i*Math.tan((th-Math.acos((p+f-m)/(2*g*y)))/2),b=v/y,x=v/g;Math.abs(b-1)>nh&&this._append(Yd||(Yd=jd(["L",",",""])),t+b*u,e+b*c),this._append(Vd||(Vd=jd(["A",",",",0,0,",",",",",""])),i,i,+(c*d>u*h),this._x1=t+x*s,this._y1=e+x*l)}else this._append(Zd||(Zd=jd(["L",",",""])),this._x1=t,this._y1=e);else;}arc(t,e,n,r,i,o){if(t=+t,e=+e,o=!!o,(n=+n)<0)throw new Error("negative radius: ".concat(n));let a=n*Math.cos(r),s=n*Math.sin(r),l=t+a,u=e+s,c=1^o,f=o?r-i:i-r;null===this._x1?this._append(Gd||(Gd=jd(["M",",",""])),l,u):(Math.abs(this._x1-l)>nh||Math.abs(this._y1-u)>nh)&&this._append(Xd||(Xd=jd(["L",",",""])),l,u),n&&(f<0&&(f=f%eh+eh),f>rh?this._append(Qd||(Qd=jd(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,c,t-a,e-s,n,n,c,this._x1=l,this._y1=u):f>nh&&this._append(Jd||(Jd=jd(["A",",",",0,",",",",",",",""])),n,n,+(f>=th),c,this._x1=t+n*Math.cos(i),this._y1=e+n*Math.sin(i)))}rect(t,e,n,r){this._append(Kd||(Kd=jd(["M",",","h","v","h","Z"])),this._x0=this._x1=+t,this._y0=this._y1=+e,n=+n,+r,-n)}toString(){return this._}}function ah(){return new oh}function sh(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: ".concat(n));e=t}return t},()=>new oh(e)}function lh(t){return t.innerRadius}function uh(t){return t.outerRadius}function ch(t){return t.startAngle}function fh(t){return t.endAngle}function dh(t){return t&&t.padAngle}function hh(t,e,n,r,i,o,a){var s=t-n,l=e-r,u=(a?o:-o)/dd(s*s+l*l),c=u*l,f=-u*s,d=t+c,h=e+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,v=p-d,b=m-h,x=v*v+b*b,_=i-o,w=d*m-p*h,k=(b<0?-1:1)*dd(ud(0,_*_*x-w*w)),A=(w*b-v*k)/x,E=(-w*v-b*k)/x,M=(w*b+v*k)/x,C=(-w*v+b*k)/x,S=A-g,D=E-y,F=M-g,T=C-y;return S*S+D*D>F*F+T*T&&(A=M,E=C),{cx:A,cy:E,x01:-c,y01:-f,x11:A*(i/_-1),y11:E*(i/_-1)}}ah.prototype=oh.prototype;Array.prototype.slice;function ph(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function mh(t){return t[0]}function gh(t){return t[1]}function yh(t,e){var n=Ld(!0),r=null,i=Md,o=null,a=sh(s);function s(s){var l,u,c,f=(s=ph(s)).length,d=!1;for(null==r&&(o=i(c=a())),l=0;l<=f;++l)!(l<f&&n(u=s[l],l,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+t(u,l,s),+e(u,l,s));if(c)return o=null,c+""||null}return t="function"===typeof t?t:void 0===t?mh:Ld(t),e="function"===typeof e?e:void 0===e?gh:Ld(e),s.x=function(e){return arguments.length?(t="function"===typeof e?e:Ld(+e),s):t},s.y=function(t){return arguments.length?(e="function"===typeof t?t:Ld(+t),s):e},s.defined=function(t){return arguments.length?(n="function"===typeof t?t:Ld(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s}function vh(t,e,n){var r=null,i=Ld(!0),o=null,a=Md,s=null,l=sh(u);function u(u){var c,f,d,h,p,m=(u=ph(u)).length,g=!1,y=new Array(m),v=new Array(m);for(null==o&&(s=a(p=l())),c=0;c<=m;++c){if(!(c<m&&i(h=u[c],c,u))===g)if(g=!g)f=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=c-1;d>=f;--d)s.point(y[d],v[d]);s.lineEnd(),s.areaEnd()}g&&(y[c]=+t(h,c,u),v[c]=+e(h,c,u),s.point(r?+r(h,c,u):y[c],n?+n(h,c,u):v[c]))}if(p)return s=null,p+""||null}function c(){return yh().defined(i).curve(a).context(o)}return t="function"===typeof t?t:void 0===t?mh:Ld(+t),e="function"===typeof e?e:Ld(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?gh:Ld(+n),u.x=function(e){return arguments.length?(t="function"===typeof e?e:Ld(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"===typeof e?e:Ld(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:Ld(+t),u):r},u.y=function(t){return arguments.length?(e="function"===typeof t?t:Ld(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"===typeof t?t:Ld(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:Ld(+t),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"===typeof t?t:Ld(!!t),u):i},u.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),u):a},u.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),u):o},u}dd(3);const bh={draw(t,e){const n=dd(e/pd);t.moveTo(n,0),t.arc(0,0,n,0,gd)}},xh=(dd(1/3),fd(pd/10)/fd(7*pd/10));fd(gd/10),ld(gd/10),dd(3),dd(3),dd(3),dd(12);function _h(t,e){if("undefined"!==typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const wh=()=>"undefined"!==typeof Image?Image:null,kh=Xi(Vi),Ah=kh.right,Eh=kh.left,Mh=(Xi(yu).center,Ah);function Ch(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Sh(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Dh(){}var Fh=.7,Th=1/Fh,Nh="\\s*([+-]?\\d+)\\s*",Oh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rh=/^#([0-9a-f]{3,8})$/,Ph=new RegExp("^rgb\\(".concat(Nh,",").concat(Nh,",").concat(Nh,"\\)$")),Bh=new RegExp("^rgb\\(".concat(zh,",").concat(zh,",").concat(zh,"\\)$")),Lh=new RegExp("^rgba\\(".concat(Nh,",").concat(Nh,",").concat(Nh,",").concat(Oh,"\\)$")),jh=new RegExp("^rgba\\(".concat(zh,",").concat(zh,",").concat(zh,",").concat(Oh,"\\)$")),Uh=new RegExp("^hsl\\(".concat(Oh,",").concat(zh,",").concat(zh,"\\)$")),qh=new RegExp("^hsla\\(".concat(Oh,",").concat(zh,",").concat(zh,",").concat(Oh,"\\)$")),Ih={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Wh(){return this.rgb().formatHex()}function $h(){return this.rgb().formatRgb()}function Hh(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Rh.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Zh(e):3===n?new Xh(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Yh(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Yh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ph.exec(t))?new Xh(e[1],e[2],e[3],1):(e=Bh.exec(t))?new Xh(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Lh.exec(t))?Yh(e[1],e[2],e[3],e[4]):(e=jh.exec(t))?Yh(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Uh.exec(t))?np(e[1],e[2]/100,e[3]/100,1):(e=qh.exec(t))?np(e[1],e[2]/100,e[3]/100,e[4]):Ih.hasOwnProperty(t)?Zh(Ih[t]):"transparent"===t?new Xh(NaN,NaN,NaN,0):null}function Zh(t){return new Xh(t>>16&255,t>>8&255,255&t,1)}function Yh(t,e,n,r){return r<=0&&(t=e=n=NaN),new Xh(t,e,n,r)}function Vh(t){return t instanceof Dh||(t=Hh(t)),t?new Xh((t=t.rgb()).r,t.g,t.b,t.opacity):new Xh}function Gh(t,e,n,r){return 1===arguments.length?Vh(t):new Xh(t,e,n,null==r?1:r)}function Xh(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Qh(){return"#".concat(ep(this.r)).concat(ep(this.g)).concat(ep(this.b))}function Jh(){const t=Kh(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(tp(this.r),", ").concat(tp(this.g),", ").concat(tp(this.b)).concat(1===t?")":", ".concat(t,")"))}function Kh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function tp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ep(t){return((t=tp(t))<16?"0":"")+t.toString(16)}function np(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new op(t,e,n,r)}function rp(t){if(t instanceof op)return new op(t.h,t.s,t.l,t.opacity);if(t instanceof Dh||(t=Hh(t)),!t)return new op;if(t instanceof op)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new op(a,s,l,t.opacity)}function ip(t,e,n,r){return 1===arguments.length?rp(t):new op(t,e,n,null==r?1:r)}function op(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ap(t){return(t=(t||0)%360)<0?t+360:t}function sp(t){return Math.max(0,Math.min(1,t||0))}function lp(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function up(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function cp(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return up((n-r/e)*e,a,i,o,s)}}function fp(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return up((n-r/e)*e,i,o,a,s)}}Ch(Dh,Hh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Wh,formatHex:Wh,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return rp(this).formatHsl()},formatRgb:$h,toString:$h}),Ch(Xh,Gh,Sh(Dh,{brighter(t){return t=null==t?Th:Math.pow(Th,t),new Xh(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Fh:Math.pow(Fh,t),new Xh(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Xh(tp(this.r),tp(this.g),tp(this.b),Kh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qh,formatHex:Qh,formatHex8:function(){return"#".concat(ep(this.r)).concat(ep(this.g)).concat(ep(this.b)).concat(ep(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Jh,toString:Jh})),Ch(op,ip,Sh(Dh,{brighter(t){return t=null==t?Th:Math.pow(Th,t),new op(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Fh:Math.pow(Fh,t),new op(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Xh(lp(t>=240?t-240:t+120,i,r),lp(t,i,r),lp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new op(ap(this.h),sp(this.s),sp(this.l),Kh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Kh(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(ap(this.h),", ").concat(100*sp(this.s),"%, ").concat(100*sp(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const dp=t=>()=>t;function hp(t,e){return function(n){return t+n*e}}function pp(t,e){var n=e-t;return n?hp(t,n>180||n<-180?n-360*Math.round(n/360):n):dp(isNaN(t)?e:t)}function mp(t){return 1===(t=+t)?gp:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):dp(isNaN(e)?n:e)}}function gp(t,e){var n=e-t;return n?hp(t,n):dp(isNaN(t)?e:t)}const yp=function t(e){var n=mp(e);function r(t,e){var r=n((t=Gh(t)).r,(e=Gh(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=gp(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function vp(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Gh(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var bp=vp(cp),xp=vp(fp);function _p(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function wp(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function kp(t,e){return(wp(e)?_p:Ap)(t,e)}function Ap(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Tp(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function Ep(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Mp(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Cp(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Tp(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Sp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dp=new RegExp(Sp.source,"g");function Fp(t,e){var n,r,i,o=Sp.lastIndex=Dp.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=Sp.exec(t))&&(r=Dp.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Mp(n,r)})),o=Dp.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function Tp(t,e){var n,r=typeof e;return null==e||"boolean"===r?dp(e):("number"===r?Mp:"string"===r?(n=Hh(e))?(e=n,yp):Fp:e instanceof Hh?yp:e instanceof Date?Ep:wp(e)?_p:Array.isArray(e)?Ap:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Cp:Mp)(t,e)}function Np(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Op(t){return+t}var zp=[0,1];function Rp(t){return t}function Pp(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Bp(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Pp(i,r),o=n(a,o)):(r=Pp(r,i),o=n(o,a)),function(t){return o(r(t))}}function Lp(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Pp(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Mh(t,e,1,r)-1;return o[n](i[n](e))}}function jp(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Up(){var t,e,n,r,i,o,a=zp,s=zp,l=Tp,u=Rp;function c(){var t=Math.min(a.length,s.length);return u!==Rp&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(a[0],a[t-1])),r=t>2?Lp:Bp,i=o=null,f}function f(e){return null==e||isNaN(e=+e)?n:(i||(i=r(a.map(t),s,l)))(t(u(e)))}return f.invert=function(n){return u(e((o||(o=r(s,a.map(t),Mp)))(n)))},f.domain=function(t){return arguments.length?(a=Array.from(t,Op),c()):a.slice()},f.range=function(t){return arguments.length?(s=Array.from(t),c()):s.slice()},f.rangeRound=function(t){return s=Array.from(t),l=Np,c()},f.clamp=function(t){return arguments.length?(u=!!t||Rp,c()):u!==Rp},f.interpolate=function(t){return arguments.length?(l=t,c()):l},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,c()}}function qp(){return Up()(Rp,Rp)}function Ip(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Wp(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}function $p(t,e,n,r){var i,o=$r(t,e,n);switch((r=Yr(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Qr(o,a))||(r.precision=i),oi(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Jr(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Kr(o))||(r.precision=i-2*("%"===r.type))}return ii(r)}function Hp(t){var e=t.domain;return t.ticks=function(t){var n=e();return Ir(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return $p(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,s=o.length-1,l=o[a],u=o[s],c=10;for(u<l&&(i=l,l=u,u=i,i=a,a=s,s=i);c-- >0;){if((i=Wr(l,u,n))===r)return o[a]=l,o[s]=u,e(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function Zp(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}function Yp(t){return Math.log(t)}function Vp(t){return Math.exp(t)}function Gp(t){return-Math.log(-t)}function Xp(t){return-Math.exp(-t)}function Qp(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Jp(t){return(e,n)=>-t(-e,n)}function Kp(t){const e=t(Yp,Vp),n=e.domain;let r,i,o=10;function a(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(o),i=function(t){return 10===t?Qp:t===Math.E?Math.exp:e=>Math.pow(t,e)}(o),n()[0]<0?(r=Jp(r),i=Jp(i),t(Gp,Xp)):t(Yp,Vp),e}return e.base=function(t){return arguments.length?(o=+t,a()):o},e.domain=function(t){return arguments.length?(n(t),a()):n()},e.ticks=t=>{const e=n();let a=e[0],s=e[e.length-1];const l=s<a;l&&([a,s]=[s,a]);let u,c,f=r(a),d=r(s);const h=null==t?10:+t;let p=[];if(!(o%1)&&d-f<h){if(f=Math.floor(f),d=Math.ceil(d),a>0){for(;f<=d;++f)for(u=1;u<o;++u)if(c=f<0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}}else for(;f<=d;++f)for(u=o-1;u>=1;--u)if(c=f>0?u/i(-f):u*i(f),!(c<a)){if(c>s)break;p.push(c)}2*p.length<h&&(p=Ir(a,s,h))}else p=Ir(f,d,Math.min(d-f,h)).map(i);return l?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===o?"s":","),"function"!==typeof n&&(o%1||null!=(n=Yr(n)).precision||(n.trim=!0),n=ii(n)),t===1/0)return n;const a=Math.max(1,o*t/e.ticks().length);return t=>{let e=t/i(Math.round(r(t)));return e*o<o-.5&&(e*=o),e<=a?n(t):""}},e.nice=()=>n(Zp(n(),{floor:t=>i(Math.floor(r(t))),ceil:t=>i(Math.ceil(r(t)))})),e}function tm(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function em(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function nm(t){return t<0?-t*t:t*t}function rm(t){var e=t(Rp,Rp),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(Rp,Rp):.5===n?t(em,nm):t(tm(n),tm(1/n)):n},Hp(e)}function im(){var t=rm(Up());return t.copy=function(){return jp(t,im()).exponent(t.exponent())},Ip.apply(t,arguments),t}function om(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function am(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function sm(t){var e=1,n=t(om(e),am(e));return n.constant=function(n){return arguments.length?t(om(e=+n),am(e)):e},Hp(n)}function lm(t,e,n,r,i,o){const a=[[Zi,1,di],[Zi,5,5e3],[Zi,15,15e3],[Zi,30,3e4],[o,1,hi],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,pi],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,mi],[r,2,1728e5],[n,1,gi],[e,1,yi],[e,3,7776e6],[t,1,vi]];function s(e,n,r){const i=Math.abs(n-e)/r,o=Xi((t=>{let[,,e]=t;return e})).right(a,i);if(o===a.length)return t.every($r(e/vi,n/vi,r));if(0===o)return Yi.every(Math.max($r(e,n,r),1));const[s,l]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(l)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"===typeof n.range?n:s(t,e,n),o=i?i.range(t,+e+1):[];return r?o.reverse():o},s]}const[um,cm]=lm(ji,qi,Ti,_i,Wi,Hi),[fm,dm]=lm(Li,Ui,ki,bi,Ii,$i);function hm(t){return new Date(t)}function pm(t){return t instanceof Date?+t:+new Date(+t)}function mm(t,e,n,r,i,o,a,s,l,u){var c=qp(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),v=u("%b %d"),b=u("%B"),x=u("%Y");function _(t){return(l(t)<t?h:s(t)<t?p:a(t)<t?m:o(t)<t?g:r(t)<t?i(t)<t?y:v:n(t)<t?b:x)(t)}return c.invert=function(t){return new Date(f(t))},c.domain=function(t){return arguments.length?d(Array.from(t,pm)):d().map(hm)},c.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},c.tickFormat=function(t,e){return null==e?_:u(e)},c.nice=function(t){var n=d();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(Zp(n,t)):c},c.copy=function(){return jp(c,mm(t,e,n,r,i,o,a,s,l,u))},c}function gm(){var t,e,n,r,i,o=0,a=1,s=Rp,l=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([o,a]=i,t=r(o=+o),e=r(a=+a),n=t===e?0:1/(e-t),u):[o,a]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=c(Tp),u.rangeRound=c(Np),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),u}}function ym(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function vm(){var t=Hp(gm()(Rp));return t.copy=function(){return ym(t,vm())},Wp.apply(t,arguments)}function bm(){var t=rm(gm());return t.copy=function(){return ym(t,bm()).exponent(t.exponent())},Wp.apply(t,arguments)}function xm(t,e){void 0===e&&(e=t,t=Tp);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function _m(){var t,e,n,r,i,o,a,s=0,l=.5,u=1,c=1,f=Rp,d=!1;function h(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(c*t<c*e?r:i),f(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,f=xm(t,[n,r,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(a){return arguments.length?([s,l,u]=a,t=o(s=+s),e=o(l=+l),n=o(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,h):[s,l,u]},h.clamp=function(t){return arguments.length?(d=!!t,h):d},h.interpolator=function(t){return arguments.length?(f=t,h):f},h.range=p(Tp),h.rangeRound=p(Np),h.unknown=function(t){return arguments.length?(a=t,h):a},function(a){return o=a,t=a(s),e=a(l),n=a(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,h}}function wm(){var t=rm(_m());return t.copy=function(){return ym(t,wm()).exponent(t.exponent())},Wp.apply(t,arguments)}class km extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sm;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(Em(this,t))}has(t){return super.has(Em(this,t))}set(t,e){return super.set(Mm(this,t),e)}delete(t){return super.delete(Cm(this,t))}}class Am extends Set{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sm;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const n of t)this.add(n)}has(t){return super.has(Em(this,t))}add(t){return super.add(Mm(this,t))}delete(t){return super.delete(Cm(this,t))}}function Em(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function Mm(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function Cm(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function Sm(t){return null!==t&&"object"===typeof t?t.valueOf():t}const Dm=Symbol("implicit");function Fm(){var t=new km,e=[],n=[],r=Dm;function i(i){let o=t.get(i);if(void 0===o){if(r!==Dm)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new km;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Fm(e,n).unknown(r)},Ip.apply(i,arguments),i}function Tm(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Nm(t,e){var n=pp(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}var Om,zm=180/Math.PI,Rm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Pm(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*zm,skewX:Math.atan(l)*zm,scaleX:a,scaleY:s}}function Bm(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:Mp(t,i)},{i:l-2,x:Mp(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Mp(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Mp(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Mp(t,n)},{i:s-2,x:Mp(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var Lm=Bm((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Rm:Pm(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),jm=Bm((function(t){return null==t?Rm:(Om||(Om=document.createElementNS("http://www.w3.org/2000/svg","g")),Om.setAttribute("transform",t),(t=Om.transform.baseVal.consolidate())?Pm((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Rm)}),", ",")",")");function Um(t){return((t=Math.exp(t))+1/t)/2}const qm=function t(e,n,r){function i(t,i){var o,a,s=t[0],l=t[1],u=t[2],c=i[0],f=i[1],d=i[2],h=c-s,p=f-l,m=h*h+p*p;if(m<1e-12)a=Math.log(d/u)/e,o=function(t){return[s+t*h,l+t*p,u*Math.exp(e*t*a)]};else{var g=Math.sqrt(m),y=(d*d-u*u+r*m)/(2*u*n*g),v=(d*d-u*u-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-b)/e,o=function(t){var r=t*a,i=Um(b),o=u/(n*g)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+o*h,l+o*p,u*i/Um(e*r+b)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function Im(t){return function(e,n){var r=t((e=ip(e)).h,(n=ip(n)).h),i=gp(e.s,n.s),o=gp(e.l,n.l),a=gp(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}const Wm=Im(pp);var $m=Im(gp);const Hm=Math.PI/180,Zm=180/Math.PI,Ym=.96422,Vm=1,Gm=.82521,Xm=4/29,Qm=6/29,Jm=3*Qm*Qm,Km=.008856451679035631;function tg(t){if(t instanceof ng)return new ng(t.l,t.a,t.b,t.opacity);if(t instanceof ug)return cg(t);t instanceof Xh||(t=Vh(t));var e,n,r=ag(t.r),i=ag(t.g),o=ag(t.b),a=rg((.2225045*r+.7168786*i+.0606169*o)/Vm);return r===i&&i===o?e=n=a:(e=rg((.4360747*r+.3850649*i+.1430804*o)/Ym),n=rg((.0139322*r+.0971045*i+.7141733*o)/Gm)),new ng(116*a-16,500*(e-a),200*(a-n),t.opacity)}function eg(t,e,n,r){return 1===arguments.length?tg(t):new ng(t,e,n,null==r?1:r)}function ng(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function rg(t){return t>Km?Math.pow(t,1/3):t/Jm+Xm}function ig(t){return t>Qm?t*t*t:Jm*(t-Xm)}function og(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ag(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function sg(t){if(t instanceof ug)return new ug(t.h,t.c,t.l,t.opacity);if(t instanceof ng||(t=tg(t)),0===t.a&&0===t.b)return new ug(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Zm;return new ug(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function lg(t,e,n,r){return 1===arguments.length?sg(t):new ug(t,e,n,null==r?1:r)}function ug(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function cg(t){if(isNaN(t.h))return new ng(t.l,0,0,t.opacity);var e=t.h*Hm;return new ng(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function fg(t,e){var n=gp((t=eg(t)).l,(e=eg(e)).l),r=gp(t.a,e.a),i=gp(t.b,e.b),o=gp(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function dg(t){return function(e,n){var r=t((e=lg(e)).h,(n=lg(n)).h),i=gp(e.c,n.c),o=gp(e.l,n.l),a=gp(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}Ch(ng,eg,Sh(Dh,{brighter(t){return new ng(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new ng(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Xh(og(3.1338561*(e=Ym*ig(e))-1.6168667*(t=Vm*ig(t))-.4906146*(n=Gm*ig(n))),og(-.9787684*e+1.9161415*t+.033454*n),og(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Ch(ug,lg,Sh(Dh,{brighter(t){return new ug(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new ug(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return cg(this).rgb()}}));const hg=dg(pp);var pg=dg(gp),mg=-.14861,gg=1.78277,yg=-.29227,vg=-.90649,bg=1.97294,xg=bg*vg,_g=bg*gg,wg=gg*yg-vg*mg;function kg(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Ag)return new Ag(t.h,t.s,t.l,t.opacity);t instanceof Xh||(t=Vh(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(wg*r+xg*e-_g*n)/(wg+xg-_g),o=r-i,a=(bg*(n-i)-yg*o)/vg,s=Math.sqrt(a*a+o*o)/(bg*i*(1-i)),l=s?Math.atan2(a,o)*Zm-120:NaN;return new Ag(l<0?l+360:l,s,i,t.opacity)}(t):new Ag(t,e,n,null==r?1:r)}function Ag(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Eg(t){return function e(n){function r(e,r){var i=t((e=kg(e)).h,(r=kg(r)).h),o=gp(e.s,r.s),a=gp(e.l,r.l),s=gp(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Ch(Ag,kg,Sh(Dh,{brighter(t){return t=null==t?Th:Math.pow(Th,t),new Ag(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Fh:Math.pow(Fh,t),new Ag(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*Hm,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Xh(255*(e+n*(mg*r+gg*i)),255*(e+n*(yg*r+vg*i)),255*(e+n*(bg*r)),this.opacity)}}));const Mg=Eg(pp);var Cg=Eg(gp);function Sg(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function Dg(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const Fg="linear",Tg="log",Ng="pow",Og="sqrt",zg="symlog",Rg="time",Pg="utc",Bg="sequential",Lg="diverging",jg="quantile",Ug="quantize",qg="threshold",Ig="ordinal",Wg="point",$g="band",Hg="bin-ordinal",Zg="continuous",Yg="discrete",Vg="discretizing",Gg="interpolating",Xg="temporal";function Qg(){const t=Fm().unknown(void 0),e=t.domain,n=t.range;let r,i,o=[0,1],a=!1,s=0,l=0,u=.5;function c(){const t=e().length,c=o[1]<o[0],f=o[1-c],d=Dg(t,s,l);let h=o[c-0];r=(f-h)/(d||1),a&&(r=Math.floor(r)),h+=(f-h-r*(t-s))*u,i=r*(1-s),a&&(h=Math.round(h),i=Math.round(i));const p=vc(t).map((t=>h+r*t));return n(c?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),c()):e()},t.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},t.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,c()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(a=!!t,c()):a},t.padding=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),s=l,c()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),c()):s},t.paddingOuter=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=o[1]<o[0],a=r?n().reverse():n(),s=a.length-1;let l,u,c,f=+t[0],d=+t[1];return f!==f||d!==d||(d<f&&(c=f,f=d,d=c),d<a[0]||f>o[1-r])?void 0:(l=Math.max(0,Ah(a,f)-1),u=f===d?l:Ah(a,d)-1,f-a[l]>i+1e-10&&++l,r&&(c=l,l=s-u,u=s-c),l>u?void 0:e().slice(l,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return Qg().domain(e()).range(o).round(a).paddingInner(s).paddingOuter(l).align(u)},c()}function Jg(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return Jg(e())},t}var Kg=Array.prototype.map;const ty=Array.prototype.slice;const ey=new Map,ny=Symbol("vega_scale");function ry(t){return t[ny]=!0,t}function iy(t,e,n){return arguments.length>1?(ey.set(t,function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,o,a,s=e[0],l=e[1],u=-1;for(l<s&&(i=s,s=l,l=i),o=0,a=n.length;o<a;++o)n[o]>=s&&n[o]<=l&&(u<0&&(u=o),r=o);if(!(u<0))return s=t.invertExtent(n[u]),l=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=t,ry(n)};return r.metadata=vr(Nn(n)),r}(t,e,n)),this):oy(t)?ey.get(t):void 0}function oy(t){return ey.has(t)}function ay(t,e){const n=ey.get(t);return n&&n.metadata[e]}function sy(t){return ay(t,Zg)}function ly(t){return ay(t,Yg)}function uy(t){return ay(t,Vg)}function cy(t){return ay(t,Tg)}function fy(t){return ay(t,Gg)}function dy(t){return ay(t,jg)}iy("identity",(function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,Op),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,Op):[0,1],Hp(r)})),iy(Fg,(function t(){var e=qp();return e.copy=function(){return jp(e,t())},Ip.apply(e,arguments),Hp(e)}),Zg),iy(Tg,(function t(){const e=Kp(Up()).domain([1,10]);return e.copy=()=>jp(e,t()).base(e.base()),Ip.apply(e,arguments),e}),[Zg,Tg]),iy(Ng,im,Zg),iy(Og,(function(){return im.apply(null,arguments).exponent(.5)}),Zg),iy(zg,(function t(){var e=sm(Up());return e.copy=function(){return jp(e,t()).constant(e.constant())},Ip.apply(e,arguments)}),Zg),iy(Rg,(function(){return Ip.apply(mm(fm,dm,Li,Ui,ki,bi,Ii,$i,Zi,ha).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Zg,Xg]),iy(Pg,(function(){return Ip.apply(mm(um,cm,ji,qi,Ti,xi,Wi,Hi,Zi,ma).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Zg,Xg]),iy(Bg,vm,[Zg,Gg]),iy("".concat(Bg,"-").concat(Fg),vm,[Zg,Gg]),iy("".concat(Bg,"-").concat(Tg),(function t(){var e=Kp(gm()).domain([1,10]);return e.copy=function(){return ym(e,t()).base(e.base())},Wp.apply(e,arguments)}),[Zg,Gg,Tg]),iy("".concat(Bg,"-").concat(Ng),bm,[Zg,Gg]),iy("".concat(Bg,"-").concat(Og),(function(){return bm.apply(null,arguments).exponent(.5)}),[Zg,Gg]),iy("".concat(Bg,"-").concat(zg),(function t(){var e=sm(gm());return e.copy=function(){return ym(e,t()).constant(e.constant())},Wp.apply(e,arguments)}),[Zg,Gg]),iy("".concat(Lg,"-").concat(Fg),(function t(){var e=Hp(_m()(Rp));return e.copy=function(){return ym(e,t())},Wp.apply(e,arguments)}),[Zg,Gg]),iy("".concat(Lg,"-").concat(Tg),(function t(){var e=Kp(_m()).domain([.1,1,10]);return e.copy=function(){return ym(e,t()).base(e.base())},Wp.apply(e,arguments)}),[Zg,Gg,Tg]),iy("".concat(Lg,"-").concat(Ng),wm,[Zg,Gg]),iy("".concat(Lg,"-").concat(Og),(function(){return wm.apply(null,arguments).exponent(.5)}),[Zg,Gg]),iy("".concat(Lg,"-").concat(zg),(function t(){var e=sm(_m());return e.copy=function(){return ym(e,t()).constant(e.constant())},Wp.apply(e,arguments)}),[Zg,Gg]),iy(jg,(function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=bu(n,t/e);return a}function a(t){return null==t||isNaN(t=+t)?e:r[Mh(i,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(Vi),o()},a.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return i.slice()},a.copy=function(){return t().domain(n).range(r).unknown(e)},Ip.apply(a,arguments)}),[Vg,jg]),iy(Ug,(function t(){var e,n=0,r=1,i=1,o=[.5],a=[0,1];function s(t){return null!=t&&t<=t?a[Mh(o,t,0,i)]:e}function l(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,l()):[n,r]},s.range=function(t){return arguments.length?(i=(a=Array.from(t)).length-1,l()):a.slice()},s.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(a).unknown(e)},Ip.apply(Hp(s),arguments)}),Vg),iy(qg,(function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return null!=t&&t<=t?r[Mh(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},Ip.apply(o,arguments)}),Vg),iy(Hg,(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(Mh(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return Kg.call(t,pn)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=ty.call(t),r):n.slice()},r.tickFormat=function(t,n){return $p(e[0],hn(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[Yg,Vg]),iy(Ig,Fm,Yg),iy($g,Qg,Yg),iy(Wg,(function(){return Jg(Qg().paddingInner(1))}),Yg);const hy=["clamp","base","constant","exponent"];function py(t,e){const n=e[0],r=hn(e)-n;return function(e){return t(n+e*r)}}function my(t,e,n){return xm(vy(e||"rgb",n),t)}function gy(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function yy(t,e,n){const r=n-e;let i,o,a;return r&&Number.isFinite(r)?(i=(o=t.type).indexOf("-"),o=i<0?o:o.slice(i+1),a=iy(o)().domain([e,n]).range([0,1]),hy.forEach((e=>t[e]?a[e](t[e]()):0)),a):qn(.5)}function vy(t,e){const n=i[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function by(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function xy(t,e){for(const n in t)wy(n,e(t[n]))}const _y={};function wy(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(_y[t]=e,this):_y[t]}xy({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},by),xy({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>my(by(t))));const ky="symbol",Ay="discrete",Ey=t=>sn(t)?t.map((t=>String(t))):String(t),My=(t,e)=>t[1]-e[1],Cy=(t,e)=>e[1]-t[1];function Sy(t,e,n){let r;return nr(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(dr(t.domain())/n||1)+1))),ln(e)&&(r=e.step,e=e.interval),ir(e)&&(e=t.type===Rg?jo(e):t.type==Pg?Uo(e):$e("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function Dy(t,e,n){let r=t.range(),i=r[0],o=hn(r),a=My;if(i>o&&(r=o,o=i,i=r,a=Cy),i=Math.floor(i),o=Math.ceil(o),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=o)).sort(a).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],hn(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function Fy(t,e){return t.bins?Dy(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Ty(t,e,n,r,i,o){const a=e.type;let s=Ey;if(a===Rg||i===Rg)s=t.timeFormat(r);else if(a===Pg||i===Pg)s=t.utcFormat(r);else if(cy(a)){const i=t.formatFloat(r);if(o||e.bins)s=i;else{const t=Ny(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function Ny(t,e,n){const r=Fy(t,e),i=t.base(),o=Math.log(i),a=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=a};return n?r.filter(s):s}const Oy={[jg]:"quantiles",[Ug]:"thresholds",[qg]:"domain"},zy={[jg]:"quantiles",[Ug]:"domain"};function Ry(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=hn(t),e}(t.bins):t.type===Tg?Ny(t,e,!0):Oy[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Oy[t.type]]()):Fy(t,e)}const Py=t=>Oy[t.type]||t.bins;function By(t,e,n,r,i,o,a){const s=zy[e.type]&&o!==Rg&&o!==Pg?function(t,e,n){const r=e[zy[e.type]](),i=r.length;let o,a=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return t.formatSpan(0,a,30,n)}(t,e,i):Ty(t,e,n,i,o,a);return r===ky&&Py(e)?Ly(s):r===Ay?Uy(s):qy(s)}const Ly=t=>(e,n,r)=>{const i=jy(r[n+1],jy(r.max,1/0)),o=Iy(e,t),a=Iy(i,t);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},jy=(t,e)=>null!=t?t:e,Uy=t=>(e,n)=>n?t(e):null,qy=t=>e=>t(e),Iy=(t,e)=>Number.isFinite(t)?e(t):null;function Wy(t,e,n,r){const i=r||e.type;return ir(n)&&function(t){return ay(t,Xg)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Rg?n||i!==Pg?By(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function $y(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Wy(t,e,n.format,n.formatType);if(uy(e.type)){const t=Ry(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(ly(e.type)){const t=e.domain(),n=t.length,o=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(o)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(hn(t)))}}let Hy=0;const Zy="p_";function Yy(t){return t&&t.gradient}function Vy(t,e,n){const r=t.gradient;let i=t.id,o="radial"===r?Zy:"";return i||(i=t.id="gradient_"+Hy++,"radial"===r?(t.x1=Gy(t.x1,.5),t.y1=Gy(t.y1,.5),t.r1=Gy(t.r1,0),t.x2=Gy(t.x2,.5),t.y2=Gy(t.y2,.5),t.r2=Gy(t.r2,.5),o=Zy):(t.x1=Gy(t.x1,0),t.y1=Gy(t.y1,0),t.x2=Gy(t.x2,1),t.y2=Gy(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+o+i+")"}function Gy(t,e){return null!=t?t:e}function Xy(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}const Qy={basis:{curve:function(t){return new Yf(t)}},"basis-closed":{curve:function(t){return new Gf(t)}},"basis-open":{curve:function(t){return new Xf(t)}},bundle:{curve:Jf,tension:"beta",value:.85},cardinal:{curve:ed,tension:"tension",value:0},"cardinal-open":{curve:rd,tension:"tension",value:0},"cardinal-closed":{curve:od,tension:"tension",value:0},"catmull-rom":{curve:xd,tension:"alpha",value:.5},"catmull-rom-closed":{curve:wd,tension:"alpha",value:.5},"catmull-rom-open":{curve:Ad,tension:"alpha",value:.5},linear:{curve:Md},"linear-closed":{curve:function(t){return new Cd(t)}},monotone:{horizontal:function(t){return new Od(t)},vertical:function(t){return new Nd(t)}},natural:{curve:function(t){return new Rd(t)}},step:{curve:function(t){return new Bd(t,.5)}},"step-after":{curve:function(t){return new Bd(t,1)}},"step-before":{curve:function(t){return new Bd(t,0)}}};function Jy(t,e,n){var r=Yn(Qy,t)&&Qy[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const Ky={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},tv=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,ev=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,nv=/^((\s+,?\s*)|(,\s*))/,rv=/^[01]/;function iv(t){const e=[];return(t.match(tv)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=Ky[r],o=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let o=0;o<e;++o){const e="a"!==t||3!==o&&4!==o?ev:rv,a=n.slice(i).match(e);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const s=n.slice(i).match(nv);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),a=o.length;if(a<i||a&&a%i!==0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...o.slice(0,i)]),a!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<a;t+=i)e.push([n,...o.slice(t,t+i)])}})),e}const ov=Math.PI/180,av=Math.PI/2,sv=2*Math.PI,lv=Math.sqrt(3)/2;var uv={},cv={},fv=[].join;function dv(t){const e=fv.call(t);if(cv[e])return cv[e];var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7];const c=u*a,f=-l*s,d=l*a,h=u*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),_=n+p-x*m,w=r+m+x*p,k=n+g,A=r+y,E=k+x*y,M=A-x*g;return cv[e]=[c*_+f*w,d*_+h*w,c*E+f*M,d*E+h*M,c*k+f*A,d*k+h*A]}const hv=["l",0,0,0,0,0,0,0];function pv(t,e,n){const r=hv[0]=t[0];if("a"===r||"A"===r)hv[1]=e*t[1],hv[2]=n*t[2],hv[3]=t[3],hv[4]=t[4],hv[5]=t[5],hv[6]=e*t[6],hv[7]=n*t[7];else if("h"===r||"H"===r)hv[1]=e*t[1];else if("v"===r||"V"===r)hv[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)hv[i]=(i%2==1?e:n)*t[i];return hv}function mv(t,e,n,r,i,o){var a,s,l,u,c,f=null,d=0,h=0,p=0,m=0,g=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var v=0,b=e.length;v<b;++v){switch(a=e[v],1===i&&1===o||(a=pv(a,i,o)),a[0]){case"l":d+=a[1],h+=a[2],t.lineTo(d+n,h+r);break;case"L":d=a[1],h=a[2],t.lineTo(d+n,h+r);break;case"h":d+=a[1],t.lineTo(d+n,h+r);break;case"H":d=a[1],t.lineTo(d+n,h+r);break;case"v":h+=a[1],t.lineTo(d+n,h+r);break;case"V":h=a[1],t.lineTo(d+n,h+r);break;case"m":g=d+=a[1],y=h+=a[2],t.moveTo(d+n,h+r);break;case"M":g=d=a[1],y=h=a[2],t.moveTo(d+n,h+r);break;case"c":s=d+a[5],l=h+a[6],p=d+a[3],m=h+a[4],t.bezierCurveTo(d+a[1]+n,h+a[2]+r,p+n,m+r,s+n,l+r),d=s,h=l;break;case"C":d=a[5],h=a[6],p=a[3],m=a[4],t.bezierCurveTo(a[1]+n,a[2]+r,p+n,m+r,d+n,h+r);break;case"s":s=d+a[3],l=h+a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,d+a[1]+n,h+a[2]+r,s+n,l+r),p=d+a[1],m=h+a[2],d=s,h=l;break;case"S":s=a[3],l=a[4],p=2*d-p,m=2*h-m,t.bezierCurveTo(p+n,m+r,a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"q":s=d+a[3],l=h+a[4],p=d+a[1],m=h+a[2],t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"Q":s=a[3],l=a[4],t.quadraticCurveTo(a[1]+n,a[2]+r,s+n,l+r),d=s,h=l,p=a[1],m=a[2];break;case"t":s=d+a[1],l=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,m=h):"t"===f[0]?(p=2*d-u,m=2*h-c):"q"===f[0]&&(p=2*d-p,m=2*h-m),u=p,c=m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),h=l,p=(d=s)+a[1],m=h+a[2];break;case"T":s=a[1],l=a[2],p=2*d-p,m=2*h-m,t.quadraticCurveTo(p+n,m+r,s+n,l+r),d=s,h=l;break;case"a":gv(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+r]),d+=a[6],h+=a[7];break;case"A":gv(t,d+n,h+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],h=a[7];break;case"z":case"Z":d=g,h=y,t.closePath()}f=a}}function gv(t,e,n,r){const i=function(t,e,n,r,i,o,a,s,l){const u=fv.call(arguments);if(uv[u])return uv[u];const c=a*ov,f=Math.sin(c),d=Math.cos(c),h=d*(s-t)*.5+f*(l-e)*.5,p=d*(l-e)*.5-f*(s-t)*.5;let m=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=d/n,y=f/n,v=-f/r,b=d/r,x=g*s+y*l,_=v*s+b*l,w=g*t+y*e,k=v*t+b*e;let A=1/((w-x)*(w-x)+(k-_)*(k-_))-.25;A<0&&(A=0);let E=Math.sqrt(A);o==i&&(E=-E);const M=.5*(x+w)-E*(k-_),C=.5*(_+k)+E*(w-x),S=Math.atan2(_-C,x-M);let D=Math.atan2(k-C,w-M)-S;D<0&&1===o?D+=sv:D>0&&0===o&&(D-=sv);const F=Math.ceil(Math.abs(D/(av+.001))),T=[];for(let N=0;N<F;++N){const t=S+N*D/F,e=S+(N+1)*D/F;T[N]=[M,C,t,e,n,r,f,d]}return uv[u]=T}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let o=0;o<i.length;++o){const e=dv(i[o]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const yv=.5773502691896257,vv={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,sv)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=lv*n,i=r-n*yv,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=lv*n,i=r-n*yv;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=lv*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=lv*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=lv*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=lv*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function bv(t){return Yn(vv,t)?vv[t]:function(t){if(!Yn(xv,t)){const e=iv(t);xv[t]={draw:function(t,n){mv(t,e,0,0,Math.sqrt(n)/2)}}}return xv[t]}(t)}var xv={};const _v=.448084975506;function wv(t){return t.x}function kv(t){return t.y}function Av(t){return t.width}function Ev(t){return t.height}function Mv(t){return"function"===typeof t?t:()=>+t}function Cv(t,e,n){return Math.max(e,Math.min(t,n))}function Sv(){var t=wv,e=kv,n=Av,r=Ev,i=Mv(0),o=i,a=i,s=i,l=null;function u(u,c,f){var d,h=null!=c?c:+t.call(this,u),p=null!=f?f:+e.call(this,u),m=+n.call(this,u),g=+r.call(this,u),y=Math.min(m,g)/2,v=Cv(+i.call(this,u),0,y),b=Cv(+o.call(this,u),0,y),x=Cv(+a.call(this,u),0,y),_=Cv(+s.call(this,u),0,y);if(l||(l=d=ah()),v<=0&&b<=0&&x<=0&&_<=0)l.rect(h,p,m,g);else{var w=h+m,k=p+g;l.moveTo(h+v,p),l.lineTo(w-b,p),l.bezierCurveTo(w-_v*b,p,w,p+_v*b,w,p+b),l.lineTo(w,k-_),l.bezierCurveTo(w,k-_v*_,w-_v*_,k,w-_,k),l.lineTo(h+x,k),l.bezierCurveTo(h+_v*x,k,h,k-_v*x,h,k-x),l.lineTo(h,p+v),l.bezierCurveTo(h,p+_v*v,h+_v*v,p,h+v,p),l.closePath()}if(d)return l=null,d+""||null}return u.x=function(e){return arguments.length?(t=Mv(e),u):t},u.y=function(t){return arguments.length?(e=Mv(t),u):e},u.width=function(t){return arguments.length?(n=Mv(t),u):n},u.height=function(t){return arguments.length?(r=Mv(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=Mv(t),o=null!=e?Mv(e):i,s=null!=n?Mv(n):i,a=null!=r?Mv(r):o,u):i},u.context=function(t){return arguments.length?(l=null==t?null:t,u):l},u}function Dv(){var t,e,n,r,i,o,a,s,l=null;function u(t,e,n){const r=n/2;if(i){var u=a-e,c=t-o;if(u||c){var f=Math.hypot(u,c),d=(u/=f)*s,h=(c/=f)*s,p=Math.atan2(c,u);l.moveTo(o-d,a-h),l.lineTo(t-u*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+d,a+h),l.arc(o,a,s,p,p+Math.PI)}else l.arc(t,e,r,0,sv);l.closePath()}else i=1;o=t,a=e,s=r}function c(o){var a,s,c,f=o.length,d=!1;for(null==l&&(l=c=ah()),a=0;a<=f;++a)!(a<f&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&u(+t(s,a,o),+e(s,a,o),+n(s,a,o));if(c)return l=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(r=t,c):r},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}function Fv(t,e){return null!=t?t:e}const Tv=t=>t.x||0,Nv=t=>t.y||0,Ov=t=>!(!1===t.defined),zv=function(){var t=lh,e=uh,n=Ld(0),r=null,i=ch,o=fh,a=dh,s=null,l=sh(u);function u(){var u,c,f=+t.apply(this,arguments),d=+e.apply(this,arguments),h=i.apply(this,arguments)-md,p=o.apply(this,arguments)-md,m=ad(p-h),g=p>h;if(s||(s=u=l()),d<f&&(c=d,d=f,f=c),d>hd)if(m>gd-hd)s.moveTo(d*ld(h),d*fd(h)),s.arc(0,0,d,h,p,!g),f>hd&&(s.moveTo(f*ld(p),f*fd(p)),s.arc(0,0,f,p,h,g));else{var y,v,b=h,x=p,_=h,w=p,k=m,A=m,E=a.apply(this,arguments)/2,M=E>hd&&(r?+r.apply(this,arguments):dd(f*f+d*d)),C=cd(ad(d-f)/2,+n.apply(this,arguments)),S=C,D=C;if(M>hd){var F=yd(M/f*fd(E)),T=yd(M/d*fd(E));(k-=2*F)>hd?(_+=F*=g?1:-1,w-=F):(k=0,_=w=(h+p)/2),(A-=2*T)>hd?(b+=T*=g?1:-1,x-=T):(A=0,b=x=(h+p)/2)}var N=d*ld(b),O=d*fd(b),z=f*ld(w),R=f*fd(w);if(C>hd){var P,B=d*ld(x),L=d*fd(x),j=f*ld(_),U=f*fd(_);if(m<pd)if(P=function(t,e,n,r,i,o,a,s){var l=n-t,u=r-e,c=a-i,f=s-o,d=f*l-c*u;if(!(d*d<hd))return[t+(d=(c*(e-o)-f*(t-i))/d)*l,e+d*u]}(N,O,j,U,B,L,z,R)){var q=N-P[0],I=O-P[1],W=B-P[0],$=L-P[1],H=1/fd(function(t){return t>1?0:t<-1?pd:Math.acos(t)}((q*W+I*$)/(dd(q*q+I*I)*dd(W*W+$*$)))/2),Z=dd(P[0]*P[0]+P[1]*P[1]);S=cd(C,(f-Z)/(H-1)),D=cd(C,(d-Z)/(H+1))}else S=D=0}A>hd?D>hd?(y=hh(j,U,N,O,d,D,g),v=hh(B,L,z,R,d,D,g),s.moveTo(y.cx+y.x01,y.cy+y.y01),D<C?s.arc(y.cx,y.cy,D,sd(y.y01,y.x01),sd(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,D,sd(y.y01,y.x01),sd(y.y11,y.x11),!g),s.arc(0,0,d,sd(y.cy+y.y11,y.cx+y.x11),sd(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,D,sd(v.y11,v.x11),sd(v.y01,v.x01),!g))):(s.moveTo(N,O),s.arc(0,0,d,b,x,!g)):s.moveTo(N,O),f>hd&&k>hd?S>hd?(y=hh(z,R,B,L,f,-S,g),v=hh(N,O,j,U,f,-S,g),s.lineTo(y.cx+y.x01,y.cy+y.y01),S<C?s.arc(y.cx,y.cy,S,sd(y.y01,y.x01),sd(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,S,sd(y.y01,y.x01),sd(y.y11,y.x11),!g),s.arc(0,0,f,sd(y.cy+y.y11,y.cx+y.x11),sd(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,S,sd(v.y11,v.x11),sd(v.y01,v.x01),!g))):s.arc(0,0,f,w,_,g):s.lineTo(z,R)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-pd/2;return[ld(r)*n,fd(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:Ld(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:Ld(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:Ld(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:Ld(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:Ld(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"===typeof t?t:Ld(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"===typeof t?t:Ld(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),Rv=vh().x(Tv).y1(Nv).y0((t=>(t.y||0)+(t.height||0))).defined(Ov),Pv=vh().y(Nv).x1(Tv).x0((t=>(t.x||0)+(t.width||0))).defined(Ov),Bv=yh().x(Tv).y(Nv).defined(Ov),Lv=Sv().x(Tv).y(Nv).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Fv(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Fv(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Fv(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Fv(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),jv=function(t,e){let n=null,r=sh(i);function i(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"===typeof t?t:Ld(t||bh),e="function"===typeof e?e:Ld(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"===typeof e?e:Ld(e),i):t},i.size=function(t){return arguments.length?(e="function"===typeof t?t:Ld(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}().type((t=>bv(t.shape||"circle"))).size((t=>Fv(t.size,64))),Uv=Dv().x(Tv).y(Nv).defined(Ov).size((t=>t.size||1));function qv(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function Iv(t,e,n,r){return Lv.context(t)(e,n,r)}var Wv=1;function $v(){Wv=1}function Hv(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+Wv++),a=i.clipping[o]||(i.clipping[o]={id:o});return zn(r)?a.path=r(null):qv(n)?a.path=Iv(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Zv(t){this.clear(),t&&this.union(t)}function Yv(t){this.mark=t,this.bounds=this.bounds||new Zv}function Vv(t){Yv.call(this,t),this.items=this.items||[]}function Gv(t){this._pending=0,this._loader=t||wl()}function Xv(t){t._pending+=1}function Qv(t){t._pending-=1}function Jv(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}Zv.prototype={clone(){return new Zv(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(t),l=Math.sin(t),u=e-e*s+n*l,c=n-e*l-n*s;return[s*r-l*i+u,l*r+s*i+c,s*r-l*a+u,l*r+s*a+c,s*o-l*i+u,l*o+s*i+c,s*o-l*a+u,l*o+s*a+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Qn(Vv,Yv),Gv.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return Xv(e),e._loader.sanitize(t,{context:"href"}).then((t=>(Qv(e),t))).catch((()=>(Qv(e),null)))},loadImage(t){const e=this,n=wh();return Xv(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=Yn(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>Qv(e),i.onerror=()=>Qv(e),i.src=r,i})).catch((t=>(Qv(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const Kv=sv-1e-8;let tb,eb,nb,rb,ib,ob,ab,sb;const lb=(t,e)=>tb.add(t,e),ub=(t,e)=>lb(eb=t,nb=e),cb=t=>lb(t,tb.y1),fb=t=>lb(tb.x1,t),db=(t,e)=>ib*t+ab*e,hb=(t,e)=>ob*t+sb*e,pb=(t,e)=>lb(db(t,e),hb(t,e)),mb=(t,e)=>ub(db(t,e),hb(t,e));function gb(t,e){return tb=t,e?(rb=e*ov,ib=sb=Math.cos(rb),ob=Math.sin(rb),ab=-ob):(ib=sb=1,rb=ob=ab=0),yb}const yb={beginPath(){},closePath(){},moveTo:mb,lineTo:mb,rect(t,e,n,r){rb?(pb(t+n,e),pb(t+n,e+r),pb(t,e+r),mb(t,e)):(lb(t+n,e+r),ub(t,e))},quadraticCurveTo(t,e,n,r){const i=db(t,e),o=hb(t,e),a=db(n,r),s=hb(n,r);vb(eb,i,a,cb),vb(nb,o,s,fb),ub(a,s)},bezierCurveTo(t,e,n,r,i,o){const a=db(t,e),s=hb(t,e),l=db(n,r),u=hb(n,r),c=db(i,o),f=hb(i,o);bb(eb,a,l,c,cb),bb(nb,s,u,f,fb),ub(c,f)},arc(t,e,n,r,i,o){if(r+=rb,i+=rb,eb=n*Math.cos(i)+t,nb=n*Math.sin(i)+e,Math.abs(i-r)>Kv)lb(t-n,e-n),lb(t+n,e+n);else{const a=r=>lb(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,l;if(a(r),a(i),i!==r)if((r%=sv)<0&&(r+=sv),(i%=sv)<0&&(i+=sv),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=sv,s=r-r%av,l=0;l<4&&s>i;++l,s-=av)a(s);else for(s=r-r%av+av,l=0;l<4&&s<i;++l,s+=av)a(s)}}};function vb(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function bb(t,e,n,r,i){const o=r-t+3*e-3*n,a=t+n-2*e,s=t-e;let l,u=0,c=0;Math.abs(o)>1e-14?(l=a*a+s*o,l>=0&&(l=Math.sqrt(l),u=(-a+l)/o,c=(-a-l)/o)):u=.5*s/a,0<u&&u<1&&i(xb(u,t,e,n,r)),0<c&&c<1&&i(xb(c,t,e,n,r))}function xb(t,e,n,r,i){const o=1-t,a=o*o,s=t*t;return a*o*e+3*a*t*n+3*o*s*r+s*t*i}var _b=(_b=_h(1,1))?_b.getContext("2d"):null;const wb=new Zv;function kb(t){return function(e,n){if(!_b)return!0;t(_b,e),wb.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=wb;for(let t=i;t<=a;++t)for(let e=r;e<=o;++e)if(_b.isPointInPath(e,t))return!0;return!1}}function Ab(t,e){return e.contains(t.x||0,t.y||0)}function Eb(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,o=t.height||0;return e.intersects(wb.set(n,r,n+i,r+o))}function Mb(t,e){const n=t.x||0,r=t.y||0;return Cb(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function Cb(t,e,n,r,i){const{x1:o,y1:a,x2:s,y2:l}=t,u=r-e,c=i-n;let f,d,h,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(f=-u,d=-(o-e)),1===p&&(f=u,d=s-e),2===p&&(f=-c,d=-(a-n)),3===p&&(f=c,d=l-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>g)return!1;h>m&&(m=h)}else if(f>0){if(h<m)return!1;h<g&&(g=h)}}return!0}function Sb(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Db(t,e){return null==t?e:t}function Fb(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Tb(t,e,n){return Yy(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+Db(e.x1,.5)*r,n.y1+Db(e.y1,.5)*i,Math.max(r,i)*Db(e.r1,0),n.x1+Db(e.x2,.5)*r,n.y1+Db(e.y2,.5)*i,Math.max(r,i)*Db(e.r2,.5));else{const a=Db(e.x1,0),s=Db(e.y1,0),l=Db(e.x2,1),u=Db(e.y2,0);if(a!==l&&s!==u&&r!==i){const n=_h(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=Fb(o.createLinearGradient(a,s,l,u),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+l*r,n.y1+u*i)}return Fb(o,e.stops)}(t,n,e.bounds):n}function Nb(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Tb(t,e,e.fill),!0)}var Ob=[];function zb(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Tb(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Ob),t.lineDashOffset=e.strokeDashOffset||0),!0))}function Rb(t,e){return t.zindex-e.zindex||t.index-e.index}function Pb(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(Rb)}function Bb(t,e){var n,r,i=t.items;if(!i||!i.length)return;const o=Pb(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}function Lb(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const o=Pb(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function jb(t){return function(e,n,r){Bb(n,(n=>{r&&!r.intersects(n.bounds)||qb(t,e,n,n)}))}}function Ub(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||qb(t,e,n.items[0],n.items)}}function qb(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Sb(e,n),n.fill&&Nb(e,n,i)&&e.fill(),n.stroke&&zb(e,n,i)&&e.stroke()))}function Ib(t){return t=t||Qe,function(e,n,r,i,o,a){return r*=e.pixelRatio,i*=e.pixelRatio,Lb(n,(n=>{const s=n.bounds;if((!s||s.contains(o,a))&&s)return t(e,n,r,i,o,a)?n:void 0}))}}function Wb(t,e){return function(n,r,i,o){var a,s,l=Array.isArray(r)?r[0]:r,u=null==e?l.fill:e,c=l.stroke&&n.isPointInStroke;return c&&(a=l.strokeWidth,s=l.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function $b(t){return Ib(Wb(t))}function Hb(t,e){return"translate("+t+","+e+")"}function Zb(t){return"rotate("+t+")"}function Yb(t){return Hb(t.x||0,t.y||0)}function Vb(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=ov),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return Hb(t.x||0,t.y||0)+(t.angle?" "+Zb(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(gb(t,n.angle),n),Jv(t,n).translate(n.x||0,n.y||0)},draw:jb(r),pick:$b(r),isect:n||kb(r)}}var Gb=Vb("arc",(function(t,e){return zv.context(t)(e)}));function Xb(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=Wb(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(gb(t),r),Jv(t,r[0]))},draw:Ub(r),pick:function(t,e,n,r,o,a){var s=e.items,l=e.bounds;return!s||!s.length||l&&!l.contains(o,a)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Ab,tip:n}}var Qb=Xb("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Pv:Rv).curve(Jy(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",a=t.length,s=1/0;--a>=0;)!1!==t[a].defined&&(r=Math.abs(t[a][o]-i))<s&&(s=r,n=t[a]);return n}));function Jb(t,e){t.beginPath(),qv(e)?Iv(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Kb(t){const e=Db(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function tx(t,e){const n=Kb(e);t("d",Iv(null,e,n,n))}function ex(t,e,n,r){const i=Kb(e);t.beginPath(),Iv(t,e,(n||0)+i,(r||0)+i)}const nx=Wb(ex),rx=Wb(ex,!1),ix=Wb(ex,!0);var ox={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Yb(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Jv(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){Bb(e,(e=>{const i=e.x||0,o=e.y||0,a=e.strokeForeground,s=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&s&&(ex(t,e,i,o),Sb(t,e),e.fill&&Nb(t,e,s)&&t.fill(),e.stroke&&!a&&zb(t,e,s)&&t.stroke()),t.save(),t.translate(i,o),e.clip&&Jb(t,e),n&&n.translate(-i,-o),Bb(e,(e=>{("group"===e.marktype||null==r||r.includes(e.marktype))&&this.draw(t,e,n,r)})),n&&n.translate(i,o),t.restore(),a&&e.stroke&&s&&(ex(t,e,i,o),Sb(t,e),zb(t,e,s)&&t.stroke())}))},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const a=n*t.pixelRatio,s=r*t.pixelRatio;return Lb(e,(l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),m=l.clip;if(m&&(i<c||i>h||o<f||o>p))return;if(t.save(),t.translate(c,f),c=i-c,f=o-f,m&&qv(l)&&!ix(t,l,a,s))return t.restore(),null;const g=l.strokeForeground,y=!1!==e.interactive;return y&&g&&l.stroke&&rx(t,l,a,s)?(t.restore(),l):(u=Lb(l,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,c,f)?this.pick(t,n,r,c,f):null)),!u&&y&&(l.fill||!g&&l.stroke)&&nx(t,l,a,s)&&(u=l),t.restore(),u||null)}))},isect:Eb,content:function(t,e,n){t("clip-path",e.clip?Hv(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),tx(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?tx(t,e):t("d","")}},ax={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function sx(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function lx(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function ux(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function cx(t,e){return"center"===t?e/2:"right"===t?e:0}function fx(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var dx={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=sx(e,n),i=lx(e,r),o=ux(e,r),a=(e.x||0)-cx(e.align,i),s=(e.y||0)-fx(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",ax["xmlns:xlink"],"xlink:href"),t("transform",Hb(a,s)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=lx(e,n),i=ux(e,n),o=(e.x||0)-cx(e.align,r),a=(e.y||0)-fx(e.baseline,i);return t.set(o,a,o+r,a+i)},draw:function(t,e,n){Bb(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=sx(e,this);let i=lx(e,r),o=ux(e,r);if(0===i||0===o)return;let a,s,l,u,c=(e.x||0)-cx(e.align,i),f=(e.y||0)-fx(e.baseline,o);!1!==e.aspect&&(s=r.width/r.height,l=e.width/e.height,s===s&&l===l&&s!==l&&(l<s?(u=i/s,f+=(o-u)/2,o=u):(u=o*s,c+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(Sb(t,e),t.globalAlpha=null!=(a=e.opacity)?a:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,c,f,i,o))}))},pick:Ib(),isect:Qe,get:sx,xOffset:cx,yOffset:fx},hx=Xb("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Bv.curve(Jy(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function px(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,a=e.scaleY||1,s=(e.angle||0)*ov,l=e.pathCache;l&&l.path===n||((e.pathCache=l=iv(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),mv(t,l,0,0,o,a),t.rotate(-s),t.translate(-r,-i)):mv(t,l,r,i,o,a)}var mx={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return Hb(t.x||0,t.y||0)+(t.angle?" "+Zb(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return px(gb(t,e.angle),e)?t.set(0,0,0,0):Jv(t,e,!0)},draw:jb(px),pick:$b(px),isect:kb(px)};function gx(t,e){t.beginPath(),Iv(t,e)}var yx={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",Iv(null,e))},bound:function(t,e){var n,r;return Jv(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:jb(gx),pick:$b(gx),isect:Eb};function vx(t,e,n){var r,i,o,a;return!(!e.stroke||!zb(t,e,n))&&(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,a=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),!0)}var bx={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Yb(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return Jv(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Bb(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&vx(t,e,r)&&(Sb(t,e),t.stroke())}}))},pick:Ib((function(t,e,n,r){return!!t.isPointInStroke&&(vx(t,e,1)&&t.isPointInStroke(n,r))})),isect:Mb},xx=Vb("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),_x=Vb("symbol",(function(t,e){return jv.context(t)(e)}),Ab);const wx=lr();var kx={height:Dx,measureWidth:Cx,estimateWidth:Ex,width:Ex,canvas:Ax};function Ax(t){kx.width=t&&_b?Cx:Ex}function Ex(t,e){return Mx(Ox(t,e),Dx(t))}function Mx(t,e){return~~(.8*t.length*e)}function Cx(t,e){return Dx(t)<=0||!(e=Ox(t,e))?0:Sx(e,Rx(t))}function Sx(t,e){const n="(".concat(e,") ").concat(t);let r=wx.get(n);return void 0===r&&(_b.font=e,r=_b.measureText(t).width,wx.set(n,r)),r}function Dx(t){return null!=t.fontSize?+t.fontSize||0:11}function Fx(t){return null!=t.lineHeight?t.lineHeight:Dx(t)+2}function Tx(t){return e=t.lineBreak&&t.text&&!sn(t.text)?t.text.split(t.lineBreak):t.text,sn(e)?e.length>1?e:e[0]:e;var e}function Nx(t){const e=Tx(t);return(sn(e)?e.length-1:0)*Fx(t)}function Ox(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(kx.width===Cx){const e=Rx(t);return t=>Sx(t,e)}if(kx.width===Ex){const e=Dx(t);return t=>Mx(t,e)}return e=>kx.width(t,e)}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"\u2026",a="rtl"===t.dir,s=0,l=e.length;if(n-=r(o),a){for(;s<l;)i=s+l>>>1,r(e.slice(i))>n?s=i+1:l=i;return o+e.slice(s)}for(;s<l;)i=1+(s+l>>>1),r(e.slice(0,i))<n?s=i:l=i-1;return e.slice(0,s)+o}(t,n):n}function zx(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Rx(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Dx(t)+"px "+zx(t,e)}function Px(t){var e=t.baseline,n=Dx(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Fx(t):"line-bottom"===e?.29*n-.5*Fx(t):0)}Ax(!0);const Bx={left:"start",center:"middle",right:"end"},Lx=new Zv;function jx(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-av,n+=i*Math.cos(e),r+=i*Math.sin(e)),Lx.x1=n,Lx.y1=r,Lx}function Ux(t,e,n){var r,i=kx.height(e),o=e.align,a=jx(e),s=a.x1,l=a.y1,u=e.dx||0,c=(e.dy||0)+Px(e)-Math.round(.8*i),f=Tx(e);if(sn(f)?(i+=Fx(e)*(f.length-1),r=f.reduce(((t,n)=>Math.max(t,kx.width(e,n))),0)):r=kx.width(e,f),"center"===o?u-=r/2:"right"===o&&(u-=r),t.set(u+=s,c+=l,u+r,c+i),e.angle&&!n)t.rotate(e.angle*ov,s,l);else if(2===n)return t.rotatedPoints(e.angle*ov,s,l);return t}var qx={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Px(e),o=jx(e),a=o.x1,s=o.y1,l=e.angle||0;t("text-anchor",Bx[e.align]||"start"),l?(n=Hb(a,s)+" "+Zb(l),(r||i)&&(n+=" "+Hb(r,i))):n=Hb(a+r,s+i),t("transform",n)},bound:Ux,draw:function(t,e,n){Bb(e,(e=>{var r,i,o,a,s,l,u,c=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===c||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Rx(e),t.textAlign=e.align||"left",i=(r=jx(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*ov),i=o=0),i+=e.dx||0,o+=(e.dy||0)+Px(e),l=Tx(e),Sb(t,e),sn(l))for(s=Fx(e),a=0;a<l.length;++a)u=Ox(e,l[a]),e.fill&&Nb(t,e,c)&&t.fillText(u,i,o),e.stroke&&zb(t,e,c)&&t.strokeText(u,i,o),o+=s;else u=Ox(e,l),e.fill&&Nb(t,e,c)&&t.fillText(u,i,o),e.stroke&&zb(t,e,c)&&t.strokeText(u,i,o);e.angle&&t.restore()}}))},pick:Ib((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var a=jx(e),s=a.x1,l=a.y1,u=Ux(Lx,e,1),c=-e.angle*ov,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(s-f*s+d*l),p=d*i+f*o+(l-d*s-f*l);return u.contains(h,p)})),isect:function(t,e){const n=Ux(Lx,t,2);return Cb(e,n[0],n[1],n[2],n[3])||Cb(e,n[0],n[1],n[4],n[5])||Cb(e,n[4],n[5],n[6],n[7])||Cb(e,n[2],n[3],n[6],n[7])}},Ix=Xb("trail",(function(t,e){return Uv.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),Wx={arc:Gb,area:Qb,group:ox,image:dx,line:hx,path:mx,rect:yx,rule:bx,shape:xx,symbol:_x,text:qx,trail:Ix};function $x(t,e,n){var r=Wx[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new Zv),t,n)}var Hx={mark:null};function Zx(t,e,n){var r,i,o,a,s=Wx[t.marktype],l=s.bound,u=t.items,c=u&&u.length;if(s.nested)return c?o=u[0]:(Hx.mark=t,o=Hx),a=$x(o,l,n),e=e&&e.union(a)||a;if(e=e||t.bounds&&t.bounds.clear()||new Zv,c)for(r=0,i=u.length;r<i;++r)e.union($x(u[r],l,n));return t.bounds=e}const Yx=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Vx(t,e){return JSON.stringify(t,Yx,e)}function Gx(t){return Xx("string"===typeof t?JSON.parse(t):t)}function Xx(t){var e,n,r,i=t.marktype,o=t.items;if(o)for(n=0,r=o.length;n<r;++n)e=i?"mark":"group",o[n][e]=t,o[n].zindex&&(o[n][e].zdirty=!0),"group"===(i||e)&&Xx(o[n]);return i&&Zx(t),t}function Qx(t){arguments.length?this.root=Gx(t):(this.root=Jx({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Vv(this.root)])}function Jx(t,e){const n={bounds:new Zv,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function Kx(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function t_(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function e_(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=Kx(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function n_(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function r_(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function i_(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function o_(t,e){this._active=null,this._handlers={},this._loader=t||wl(),this._tooltip=e||a_}function a_(t,e,n,r){t.element().setAttribute("title",r||"")}function s_(t){this._el=null,this._bgcolor=null,this._loader=new Gv(t)}Qx.prototype={toJSON(t){return Vx(this.root,t||0)},mark(t,e,n){const r=Jx(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},o_.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=Kx(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,o,a=t&&t.mark;if(a&&(i=Wx[a.marktype]).tip){for((o=i_(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(a.items,o)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,l+=t.y||0;return{x:s,y:l,width:o,height:a,left:s,top:l,right:s+o,bottom:l+a}}},s_.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t,e){const n=this;return n._call=function(){n._render(t,e)},n._call(),n._call=null,n},_render(){},renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then((()=>n)):Promise.resolve(n)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const l_="dragenter",u_="dragleave",c_="dragover",f_="pointerdown",d_="pointermove",h_="pointerout",p_="pointerover",m_="mousedown",g_="mousemove",y_="mouseout",v_="mouseover",b_="click",x_="mousewheel",__="touchstart",w_="touchmove",k_="touchend",A_=d_,E_=h_,M_=b_;function C_(t,e){o_.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function S_(t,e){(t=>t===__||t===w_||t===k_?[__,w_,k_]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function D_(t,e,n){e.forEach((e=>t.fire(e,n)))}function F_(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||D_(this,n,r),this._active=o,D_(this,e,r)),D_(this,t,r)}}function T_(t){return function(e){D_(this,t,e),this._active=null}}function N_(t,e,n,r,i,o){const a="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),l=a?"undefined"!==typeof window&&window.devicePixelRatio||1:i;t.width=e*l,t.height=n*l;for(const u in o)s[u]=o[u];return a&&1!==l&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1]),t}function O_(t){s_.call(this,t),this._options={},this._redraw=!1,this._dirty=new Zv,this._tempb=new Zv}Qn(C_,o_,{initialize(t,e,n){return this._canvas=t&&t_(t,"canvas"),[b_,m_,f_,d_,h_,u_].forEach((t=>S_(this,t))),o_.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",l_,u_,c_,f_,"pointerup",d_,h_,p_,m_,"mouseup",g_,y_,v_,b_,"dblclick","wheel",x_,__,w_,k_],DOMMouseScroll(t){this.fire(x_,t)},pointermove:F_([d_,g_],[p_,v_],[h_,y_]),dragover:F_([c_],[l_],[u_]),pointerout:T_([h_,y_]),dragleave:T_([u_]),pointerdown(t){this._down=this._active,this.fire(f_,t)},mousedown(t){this._down=this._active,this.fire(m_,t)},click(t){this._down===this._active&&(this.fire(b_,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(__,t,!0)},touchmove(t){this.fire(w_,t,!0)},touchend(t){this.fire(k_,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===M_&&r&&r.href?this.handleHref(e,r,r.href):t!==A_&&t!==E_||this.handleTooltip(e,r,t!==E_),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(S_(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=i_(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const o=this.context();return Wx[t.marktype].pick.call(this,o,t,e,n,r,i)}});const z_=s_.prototype;function R_(t,e){o_.call(this,t,e);const n=this;n._hrefHandler=P_(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=P_(n,((t,e)=>{n.handleTooltip(t,e,t.type!==E_)}))}Qn(O_,s_,{initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:_h(1,1,this._options.type),t&&this._canvas&&(n_(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),z_.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(z_.resize.call(this,t,e,n,r),this._canvas)N_(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||$e("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t,e){const n=this.context(),r=this._origin,i=this._width,o=this._height,a=this._dirty,s=((t,e,n)=>(new Zv).set(0,0,e,n).translate(-t[0],-t[1]))(r,i,o);n.save();const l=this._redraw||a.empty()?(this._redraw=!1,s.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(n,s.intersect(a),r);return this.clear(-r[0],-r[1],i,o),this.draw(n,t,l,e),n.restore(),a.clear(),this},draw(t,e,n,r){if("group"!==e.marktype&&null!=r&&!r.includes(e.marktype))return;const i=Wx[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),zn(n)?(t.beginPath(),n(t),t.clip()):Jb(t,e.group)}(t,e),i.draw.call(this,t,e,n,r),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}});const P_=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};Qn(R_,o_,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(M_,this._hrefHandler),r.removeEventListener(A_,this._tooltipHandler),r.removeEventListener(E_,this._tooltipHandler)),this._svg=r=t&&t_(t,"svg"),r&&(r.addEventListener(M_,this._hrefHandler),r.addEventListener(A_,this._tooltipHandler),r.addEventListener(E_,this._tooltipHandler)),o_.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:P_(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const B_="aria-hidden",L_="aria-label",j_="role",U_="aria-roledescription",q_="graphics-object",I_="graphics-symbol",W_=(t,e,n)=>({[j_]:t,[U_]:e,[L_]:n||void 0}),$_=vr(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),H_={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?X_(t):null,i=t.context,o=i.scales[e.scale].value,a=i.dataflow.locale(),s=o.type,l="left"===n||"right"===n?"Y":"X";return"".concat(l,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(ly(s)?"discrete":s," scale")+" with ".concat($y(a,o,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?X_(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,o=Object.keys(i),a=t.context,s=a.scales[i[o[0]]].value,l=a.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+hn(t)}(o))+" with ".concat($y(l,s,t))}},"title-text":{desc:"title",caption:t=>"Title text '".concat(G_(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(G_(t),"'")}},Z_={ariaRole:j_,ariaRoleDescription:U_,description:L_};function Y_(t,e){const n=!1===e.aria;if(t(B_,n||void 0),n||null==e.description)for(const r in Z_)t(Z_[r],void 0);else{const n=e.mark.marktype;t(L_,e.description),t(j_,e.ariaRole||("group"===n?q_:I_)),t(U_,e.ariaRoleDescription||"".concat(n," mark"))}}function V_(t){return!1===t.aria?{[B_]:!0}:$_[t.role]?null:H_[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return W_(e.role||I_,e.desc,n.description||r(n))}catch(n){return null}}(t,H_[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return W_(n?q_:I_,"".concat(e," mark container"),t.description)}(t)}function G_(t){return Nn(t.text).join(" ")}function X_(t){try{return Nn(hn(t.items).items[0].text).join(" ")}catch(e){return null}}const Q_=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),J_=t=>Q_(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function K_(){let t="",e="",n="";const r=[],i=()=>e=n="",o=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(J_(n),'"')),a),a={open(s){(o=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(o)})(s),e="<"+s;for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(const t of u)for(const e in t)o(e,t[e]);return a},close(){const o=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(o,">"):"/>"):"</".concat(o,">"),i(),a},attr:o,text:t=>(n+=Q_(t),a),toString:()=>t};return a}const tw=t=>ew(K_(),t)+"";function ew(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):ew(t,e)}return t.close()}const nw={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},rw={blend:"mix-blend-mode"},iw={fill:"none","stroke-miterlimit":10},ow="http://www.w3.org/2000/xmlns/",aw=ax.xmlns;function sw(t){s_.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const lw=s_.prototype;function uw(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function cw(t,e,n){let r,i,o;if("radial"===e.gradient){let r=e_(t,n++,"pattern",aw);vw(r,{id:Zy+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=e_(r,0,"rect",aw),vw(r,{width:1,height:1,fill:"url(".concat(xw(),"#").concat(e.id,")")}),vw(t=e_(t,n++,"radialGradient",aw),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else vw(t=e_(t,n++,"linearGradient",aw),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=e_(t,r,"stop",aw),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return n_(t,r),n}function fw(t,e,n){let r;return(t=e_(t,n,"clipPath",aw)).setAttribute("id",e.id),e.path?(r=e_(t,0,"path",aw),r.setAttribute("d",e.path)):(r=e_(t,0,"rect",aw),vw(r,{x:0,y:0,width:e.width,height:e.height})),n_(t,1),n+1}function dw(t,e,n,r,i){let o,a=t._svg;if(!a&&(o=e.ownerDocument,a=Kx(o,r,aw),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},"g"===r))){const e=Kx(o,"path",aw);a.appendChild(e),e.__data__=t;const n=Kx(o,"g",aw);a.appendChild(n),n.__data__=t;const r=Kx(o,"path",aw);a.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}Qn(sw,s_,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=e_(t,0,"svg",aw),this._svg.setAttributeNS(ow,"xmlns",aw),this._svg.setAttributeNS(ow,"xmlns:xlink",ax["xmlns:xlink"]),this._svg.setAttribute("version",ax.version),this._svg.setAttribute("class","marks"),n_(t,1),this._root=e_(this._svg,0,"g",aw),vw(this._root,iw),n_(this._svg,1)),this.background(this._bgcolor),lw.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),lw.background.apply(this,arguments)},resize(t,e,n,r){return lw.resize.call(this,t,e,n,r),this._svg&&(vw(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=e_(t,0,"rect",aw),vw(n,{width:this._width,height:this._height,fill:e}));const r=tw(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),n_(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,o,a,s,l;for(a=0,s=t.length;a<s;++a)n=t[a],r=n.mark,r.marktype!==i&&(i=r.marktype,o=Wx[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,uw(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,uw(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n,r){if(!this.isDirty(e))return e._svg;const i=this._svg,o=e.marktype,a=Wx[o],s=!1===e.interactive?"none":null,l="g"===a.tag,u=dw(e,t,n,"g",i);if("group"!==o&&null!=r&&!r.includes(o))return n_(u,0),e._svg;u.setAttribute("class",r_(e));const c=V_(e);for(const p in c)bw(u,p,c[p]);l||bw(u,"pointer-events",s),bw(u,"clip-path",e.clip?Hv(this,e,e.group):null);let f=null,d=0;const h=t=>{const e=this.isDirty(t),n=dw(t,u,f,a.tag,i);e&&(this._update(a,n,t),l&&function(t,e,n,r){e=e.lastChild.previousSibling;let i,o=0;Bb(n,(n=>{i=t.mark(e,n,i,r),++o})),n_(e,1+o)}(this,n,t,r)),f=n,++d};return a.nested?e.items.length&&h(e.items[0]):Bb(e,h),n_(u,d),u},_update(t,e,n){hw=e,pw=e.__values__,Y_(gw,n),t.attr(gw,n,this);const r=mw[t.type];r&&r.call(this,t,e,n),hw&&this.style(hw,n)},style(t,e){if(null!=e){for(const n in nw){let r="font"===n?zx(e):e[n];if(r===pw[n])continue;const i=nw[n];null==r?t.removeAttribute(i):(Yy(r)&&(r=Vy(r,this._defs.gradient,xw())),t.setAttribute(i,r+"")),pw[n]=r}for(const n in rw)yw(t,rw[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=e_(t,1,"defs",aw)),r=cw(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=e_(t,1,"defs",aw)),r=fw(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):n_(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let hw=null,pw=null;const mw={group(t,e,n){const r=hw=e.childNodes[2];pw=r.__values__,t.foreground(gw,n,this),pw=e.__values__,hw=e.childNodes[1],t.content(gw,n,this);const i=hw=e.childNodes[0];t.background(gw,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==pw.events&&(bw(r,"pointer-events",o),bw(i,"pointer-events",o),pw.events=o),n.strokeForeground&&n.stroke){const t=n.fill;bw(r,"display",null),this.style(i,n),bw(i,"stroke",null),t&&(n.fill=null),pw=r.__values__,this.style(r,n),t&&(n.fill=t),hw=null}else bw(r,"display","none")},image(t,e,n){!1===n.smooth?(yw(e,"image-rendering","optimizeSpeed"),yw(e,"image-rendering","pixelated")):yw(e,"image-rendering",null)},text(t,e,n){const r=Tx(n);let i,o,a,s;sn(r)?(o=r.map((t=>Ox(n,t))),i=o.join("\n"),i!==pw.text&&(n_(e,0),a=e.ownerDocument,s=Fx(n),o.forEach(((t,r)=>{const i=Kx(a,"tspan",aw);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),pw.text=i)):(o=Ox(n,r),o!==pw.text&&(e.textContent=o,pw.text=o)),bw(e,"font-family",zx(n)),bw(e,"font-size",Dx(n)+"px"),bw(e,"font-style",n.fontStyle),bw(e,"font-variant",n.fontVariant),bw(e,"font-weight",n.fontWeight)}};function gw(t,e,n){e!==pw[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(hw,t,e,n):bw(hw,t,e),pw[t]=e)}function yw(t,e,n){n!==pw[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),pw[e]=n)}function vw(t,e){for(const n in e)bw(t,n,e[n])}function bw(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function xw(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function _w(t){s_.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}Qn(_w,s_,{svg(){return this._text},_render(t){const e=K_();e.open("svg",Wn({},ax,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",iw,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Wx[e.marktype],r=n.tag,i=[Y_,n.attr];t.open("g",{class:r_(e),"clip-path":e.clip?Hv(this,e,e.group):null},V_(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&t.open("a",a),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=Tx(o);if(sn(e)){const n={x:0,dy:Fx(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Ox(o,e[r])).close()}else t.text(Ox(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),Bb(o,(e=>this.mark(t,e))),t.close(),r&&a?(i&&(o.fill=null),o.stroke=a,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),a&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):Bb(e,o),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(o,e,this))):n(o,e,this),r&&function(t,e,n,r,i){let o;if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(t["font-family"]=zx(e),t["font-size"]=Dx(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in nw){let n=e[a];const r=nw[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(Yy(n)&&(n=Vy(n,i.gradient,"")),t[r]=n)}for(const a in rw){const t=e[a];null!=t&&(o=o||[],o.push("".concat(rw[a],": ").concat(t,";")))}o&&(t.style=o.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:Zy+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const ww={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function kw(t){var e,n,r;ww.svgMarkTypes=null!==(e=t.svgMarkTypes)&&void 0!==e?e:["text"],ww.svgOnTop=null===(n=t.svgOnTop)||void 0===n||n,ww.debug=null!==(r=t.debug)&&void 0!==r&&r}function Aw(t){s_.call(this,t),this._svgRenderer=new sw(t),this._canvasRenderer=new O_(t)}const Ew=s_.prototype;function Mw(t,e){C_.call(this,t,e)}Qn(Aw,s_,{initialize(t,e,n,r,i){this._root_el=e_(t,0,"div");const o=e_(this._root_el,0,"div"),a=e_(this._root_el,1,"div");return this._root_el.style.position="relative",ww.debug||(o.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=ww.svgOnTop?a:o,this._canvasEl=ww.svgOnTop?o:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,r,i),this._svgRenderer.initialize(this._svgEl,e,n,r,i),Ew.initialize.call(this,t,e,n,r,i)},dirty(t){return ww.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this},_render(t,e){const n=(null!==e&&void 0!==e?e:["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((t=>!ww.svgMarkTypes.includes(t)));this._svgRenderer.render(t,ww.svgMarkTypes),this._canvasRenderer.render(t,n)},resize(t,e,n,r){return Ew.resize.call(this,t,e,n,r),this._svgRenderer.resize(t,e,n,r),this._canvasRenderer.resize(t,e,n,r),this},background(t){return ww.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}),Qn(Mw,C_,{initialize(t,e,n){const r=e_(e_(t,0,"div"),ww.svgOnTop?0:1,"div");return C_.prototype.initialize.call(this,r,e,n)}});const Cw="canvas",Sw="hybrid",Dw="none",Fw={Canvas:Cw,PNG:"png",SVG:"svg",Hybrid:Sw,None:Dw},Tw={};function Nw(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Tw[t]=e,this):Tw[t]}function Ow(t,e,n){const r=[],i=(new Zv).union(e),o=t.marktype;return o?zw(t,i,n,r):"group"===o?Rw(t,i,n,r):$e("Intersect scene must be mark node or group item.")}function zw(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)Rw(i[s],e,n,r);else for(const t=Wx[o].isect;s<a;++s){const n=i[s];Pw(n,e,t)&&r.push(n)}}return r}function Rw(t,e,n,r){n&&n(t.mark)&&Pw(t,e,Wx.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const a=t.x||0,s=t.y||0;e.translate(-a,-s);for(let t=0;t<o;++t)zw(i[t],e,n,r);e.translate(a,s)}return r}function Pw(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}Tw[Cw]=Tw.png={renderer:O_,headless:O_,handler:C_},Tw.svg={renderer:sw,headless:_w,handler:R_},Tw[Sw]={renderer:Aw,headless:Aw,handler:Mw},Tw[Dw]={};const Bw=new Zv;function Lw(t){const e=t.clip;if(zn(e))e(gb(Bw.clear()));else{if(!e)return;Bw.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(Bw)}const jw=1e-9;function Uw(t,e,n){return t===e||("path"===n?qw(t,e):t instanceof Date&&e instanceof Date?+t===+e:nr(t)&&nr(e)?Math.abs(t-e)<=jw:t&&e&&(ln(t)||ln(e))?function(t,e){var n,r,i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!Uw(t[n=i[r]],e[n],n))return!1;return typeof t===typeof e}(t,e):t==e)}function qw(t,e){return Uw(iv(t),iv(e))}function Iw(){$v(),Hy=0}const Ww="top",$w="left",Hw="right",Zw="bottom",Yw="top-left",Vw="top-right",Gw="bottom-left",Xw="bottom-right",Qw="start",Jw="middle",Kw="end",tk="x",ek="y",nk="group",rk="axis",ik="title",ok="frame",ak="scope",sk="legend",lk="row-header",uk="row-footer",ck="row-title",fk="column-header",dk="column-footer",hk="column-title",pk="padding",mk="symbol",gk="fit",yk="fit-x",vk="fit-y",bk="pad",xk="none",_k="all",wk="each",kk="flush",Ak="column",Ek="row";function Mk(t){su.call(this,null,t)}function Ck(t,e,n){return e(t.bounds.clear(),t,n)}Qn(Mk,su,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=Wx[i],a=o.bound;let s,l=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),l=Ck(r,a),r.items.forEach((t=>{t.bounds.clear().union(l)}));else if(i===nk||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),l.clear(),r.items.forEach((t=>l.union(Ck(t,a)))),r.role){case rk:case sk:case ik:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,(t=>{l.union(Ck(t,a))})),e.visit(e.MOD,(t=>{s=s||l.alignsWith(t.bounds),n.dirty(t),l.union(Ck(t,a))})),s&&(l.clear(),r.items.forEach((t=>l.union(t.bounds))));return Lw(r),e.modifies("bounds")}});const Sk=":vega_identifier:";function Dk(t){su.call(this,0,t)}function Fk(t){su.call(this,null,t)}function Tk(t){su.call(this,null,t)}Dk.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Qn(Dk,su,{transform(t,e){const n=(i=e.dataflow)._signals[Sk]||(i._signals[Sk]=i.add(0)),r=t.as;var i;let o=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++o)),n.set(this.value=o),e}}),Qn(Fk,su,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===nk?Vv:Yv;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const Nk={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&Ok(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},Ok=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),zk=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(Ok(o,n=t[r].bounds,e))return!0},Rk=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},Pk=t=>(t.forEach((t=>t.opacity=1)),t),Bk=(t,e)=>t.reflow(e.modified()).modifies("opacity");function Lk(t){su.call(this,null,t)}Qn(Tk,su,{transform(t,e){const n=Nk[t.method]||Nk.parity,r=t.separation||0;let i,o,a=e.materialize(e.SOURCE).source;if(!a||!a.length)return;if(!t.method)return t.modified("method")&&(Pk(a),e=Bk(e,t)),e;if(a=a.filter(Rk),!a.length)return;if(t.sort&&(a=a.slice().sort(t.sort)),i=Pk(a),e=Bk(e,t),i.length>=3&&zk(i,r)){do{i=n(i,r)}while(i.length>=3&&zk(i,r));i.length<3&&!hn(a).opacity&&(i.length>1&&(hn(i).opacity=0),hn(a).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=((t,e,n)=>{var r=t.range(),i=new Zv;return e===Ww||e===Zw?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),a.forEach((t=>{o(t)||(t.opacity=0)})));const s=i[0].mark.bounds.clear();return a.forEach((t=>{t.opacity&&s.union(t.bounds)})),e}}),Qn(Lk,su,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const jk=new Zv;function Uk(t,e,n){return t[e]===n?0:(t[e]=n,1)}function qk(t){var e=t.items[0].orient;return e===$w||e===Hw}function Ik(t,e,n,r){var i,o,a=e.items[0],s=a.datum,l=null!=a.translate?a.translate:.5,u=a.orient,c=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&Nx(g),x=0,_=0;switch(jk.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),u){case Ww:x=h||0,_=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(f,0),g&&Wk(t,g,o,y,b,0,-1,v);break;case $w:x=-d,_=h||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,f),g&&Wk(t,g,o,y,b,1,-1,v);break;case Hw:x=n+d,_=h||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,f),g&&Wk(t,g,o,y,b,1,1,v);break;case Zw:x=h||0,_=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(f,o),g&&Wk(t,g,o,y,0,0,1,v);break;default:x=a.x,_=a.y}return Jv(v.translate(x,_),a),Uk(a,"x",x+l)|Uk(a,"y",_+l)&&(a.bounds=jk,t.dirty(a),a.bounds=v,t.dirty(a)),a.mark.bounds.clear().union(v)}function Wk(t,e,n,r,i,o,a,s){const l=e.bounds;if(e.auto){const s=a*(n+i+r);let u=0,c=0;t.dirty(e),o?u=(e.x||0)-(e.x=s):c=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(l.translate(-u,-c)),t.dirty(e)}s.union(l)}const $k=(t,e)=>Math.floor(Math.min(t,e)),Hk=(t,e)=>Math.ceil(Math.max(t,e));function Zk(t){return(new Zv).set(0,0,t.width||0,t.height||0)}function Yk(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function Vk(t,e,n){const r=ln(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function Gk(t){return t<0?Math.ceil(-t):0}function Xk(t,e,n){var r,i,o,a,s,l,u,c,f,d,h,p=!n.nodirty,m=n.bounds===kk?Zk:Yk,g=jk.set(0,0,0,0),y=Vk(n.align,Ak),v=Vk(n.align,Ek),b=Vk(n.padding,Ak),x=Vk(n.padding,Ek),_=n.columns||e.length,w=_<=0?1:Math.ceil(e.length/_),k=e.length,A=Array(k),E=Array(_),M=0,C=Array(k),S=Array(w),D=0,F=Array(k),T=Array(k),N=Array(k);for(i=0;i<_;++i)E[i]=0;for(i=0;i<w;++i)S[i]=0;for(i=0;i<k;++i)l=e[i],s=N[i]=m(l),l.x=l.x||0,F[i]=0,l.y=l.y||0,T[i]=0,o=i%_,a=~~(i/_),M=Math.max(M,u=Math.ceil(s.x2)),D=Math.max(D,c=Math.ceil(s.y2)),E[o]=Math.max(E[o],u),S[a]=Math.max(S[a],c),A[i]=b+Gk(s.x1),C[i]=x+Gk(s.y1),p&&t.dirty(e[i]);for(i=0;i<k;++i)i%_===0&&(A[i]=0),i<_&&(C[i]=0);if(y===wk)for(o=1;o<_;++o){for(h=0,i=o;i<k;i+=_)h<A[i]&&(h=A[i]);for(i=o;i<k;i+=_)A[i]=h+E[o-1]}else if(y===_k){for(h=0,i=0;i<k;++i)i%_&&h<A[i]&&(h=A[i]);for(i=0;i<k;++i)i%_&&(A[i]=h+M)}else for(y=!1,o=1;o<_;++o)for(i=o;i<k;i+=_)A[i]+=E[o-1];if(v===wk)for(a=1;a<w;++a){for(h=0,r=(i=a*_)+_;i<r;++i)h<C[i]&&(h=C[i]);for(i=a*_;i<r;++i)C[i]=h+S[a-1]}else if(v===_k){for(h=0,i=_;i<k;++i)h<C[i]&&(h=C[i]);for(i=_;i<k;++i)C[i]=h+D}else for(v=!1,a=1;a<w;++a)for(r=(i=a*_)+_;i<r;++i)C[i]+=S[a-1];for(f=0,i=0;i<k;++i)f=A[i]+(i%_?f:0),F[i]+=f-e[i].x;for(o=0;o<_;++o)for(d=0,i=o;i<k;i+=_)d+=C[i],T[i]+=d-e[i].y;if(y&&Vk(n.center,Ak)&&w>1)for(i=0;i<k;++i)(f=(s=y===_k?M:E[i%_])-N[i].x2-e[i].x-F[i])>0&&(F[i]+=f/2);if(v&&Vk(n.center,Ek)&&1!==_)for(i=0;i<k;++i)(d=(s=v===_k?D:S[~~(i/_)])-N[i].y2-e[i].y-T[i])>0&&(T[i]+=d/2);for(i=0;i<k;++i)g.union(N[i].translate(F[i],T[i]));switch(f=Vk(n.anchor,tk),d=Vk(n.anchor,ek),Vk(n.anchor,Ak)){case Kw:f-=g.width();break;case Jw:f-=g.width()/2}switch(Vk(n.anchor,Ek)){case Kw:d-=g.height();break;case Jw:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),i=0;i<k;++i)e[i].mark.bounds.clear();for(i=0;i<k;++i)(l=e[i]).x+=F[i]+=f,l.y+=T[i]+=d,g.union(l.mark.bounds.union(l.bounds.translate(F[i],T[i]))),p&&t.dirty(l);return g}function Qk(t,e,n){var r,i,o,a,s,l,u,c=function(t){var e,n,r=t.items,i=r.length,o=0;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(e=r[o]).items,e.marktype===nk)switch(e.role){case rk:case sk:case ik:break;case lk:a.rowheaders.push(...n);break;case uk:a.rowfooters.push(...n);break;case fk:a.colheaders.push(...n);break;case dk:a.colfooters.push(...n);break;case ck:a.rowtitle=n[0];break;case hk:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(e),f=c.marks,d=n.bounds===kk?Jk:Kk,h=n.offset,p=n.columns||f.length,m=p<=0?1:Math.ceil(f.length/p),g=m*p;const y=Xk(t,f,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(l=Vk(n.headerBand,Ek,null),r=tA(t,c.rowheaders,f,p,m,-Vk(h,"rowHeader"),$k,0,d,"x1",0,p,1,l)),c.colheaders&&(l=Vk(n.headerBand,Ak,null),i=tA(t,c.colheaders,f,p,p,-Vk(h,"columnHeader"),$k,1,d,"y1",0,1,p,l)),c.rowfooters&&(l=Vk(n.footerBand,Ek,null),o=tA(t,c.rowfooters,f,p,m,Vk(h,"rowFooter"),Hk,0,d,"x2",p-1,p,1,l)),c.colfooters&&(l=Vk(n.footerBand,Ak,null),a=tA(t,c.colfooters,f,p,p,Vk(h,"columnFooter"),Hk,1,d,"y2",g-p,1,p,l)),c.rowtitle&&(s=Vk(n.titleAnchor,Ek),u=Vk(h,"rowTitle"),u=s===Kw?o+u:r-u,l=Vk(n.titleBand,Ek,.5),eA(t,c.rowtitle,u,0,y,l)),c.coltitle&&(s=Vk(n.titleAnchor,Ak),u=Vk(h,"columnTitle"),u=s===Kw?a+u:i-u,l=Vk(n.titleBand,Ak,.5),eA(t,c.coltitle,u,1,y,l))}function Jk(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function Kk(t,e){return t.bounds[e]}function tA(t,e,n,r,i,o,a,s,l,u,c,f,d,h){var p,m,g,y,v,b,x,_,w,k=n.length,A=0,E=0;if(!k)return A;for(p=c;p<k;p+=f)n[p]&&(A=a(A,l(n[p],u)));if(!e.length)return A;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),A+=o,m=0,y=e.length;m<y;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=c,m=0,y=e.length;m<y;++m,p+=f){for(v=(b=e[m]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);s?(_=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),w=A):(_=A,w=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),v.union(b.bounds.translate(_-(b.x||0),w-(b.y||0))),b.x=_,b.y=w,t.dirty(b),E=a(E,v[u])}return E}function eA(t,e,n,r,i,o){if(e){t.dirty(e);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),e.bounds.translate(a-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=a,e.y=s,t.dirty(e)}}function nA(t,e,n,r,i,o,a){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),l=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,s("offset",0)),u=s("anchor",Qw),c=u===Kw?1:u===Jw?.5:0,f={align:wk,bounds:s("bounds",kk),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case $w:f.anchor={x:Math.floor(r.x1)-l,column:Kw,y:c*(a||r.height()+2*r.y1),row:u};break;case Hw:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case Ww:f.anchor={y:Math.floor(i.y1)-l,row:Kw,x:c*(o||i.width()+2*i.x1),column:u};break;case Zw:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case Yw:f.anchor={x:l,y:l};break;case Vw:f.anchor={x:o-l,y:l,column:Kw};break;case Gw:f.anchor={x:l,y:a-l,row:Kw};break;case Xw:f.anchor={x:o-l,y:a-l,column:Kw,row:Kw}}return f}function rA(t,e){var n,r,i=e.items[0],o=i.datum,a=i.orient,s=i.bounds,l=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var a=e.items[1].items[0],s=a.anchor,l=e.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case $w:i+=Math.ceil(a.bounds.width())+l;break;case Hw:case Zw:break;default:o+=a.bounds.height()+l}switch((i||o)&&oA(t,n,i,o),a.orient){case $w:c+=iA(e,n,a,s,1,1);break;case Hw:u+=iA(e,n,a,Kw,0,0)+l,c+=iA(e,n,a,s,1,1);break;case Zw:u+=iA(e,n,a,s,0,0),c+=iA(e,n,a,Kw,-1,0,1)+l;break;default:u+=iA(e,n,a,s,0,0)}(u||c)&&oA(t,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(oA(t,n,-u,0),oA(t,a,-u,0))}else(i||o)&&oA(t,n,i,o)}(t,i,i.items[0].items[0]),s=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),o.type===mk&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),a!==xk&&(i.x=l=0,i.y=u=0),i.width=n,i.height=r,Jv(s.set(l,u,l+n,u+r),i),i.mark.bounds.clear().union(s),i}function iA(t,e,n,r,i,o,a){const s="symbol"!==t.datum.type,l=n.datum.vgrad,u=(!s||!o&&l||a?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,c=l&&o?u:0,f=l&&o?0:u,d=i<=0?0:Nx(n);return Math.round(r===Qw?c:r===Kw?f-d:.5*(u-d))}function oA(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function aA(t){su.call(this,null,t)}function sA(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function lA(t){su.call(this,null,t)}function uA(t){su.call(this,null,t)}function cA(){return Fl({})}function fA(t){su.call(this,null,t)}function dA(t){su.call(this,[],t)}Qn(aA,su,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&Qk(n,e,t.layout),function(t,e,n){var r,i,o,a,s,l=e.items,u=Math.max(0,e.width||0),c=Math.max(0,e.height||0),f=(new Zv).set(0,0,u,c),d=f.clone(),h=f.clone(),p=[];for(a=0,s=l.length;a<s;++a)switch((i=l[a]).role){case rk:(qk(i)?d:h).union(Ik(t,i,u,c));break;case ik:r=i;break;case sk:p.push(rA(t,i));break;case ok:case ak:case lk:case uk:case ck:case fk:case dk:case hk:d.union(i.bounds),h.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(o=t.orient||Hw)!==xk&&(e[o]||(e[o]=[])).push(t)}));for(const r in e){const i=e[r];Xk(t,i,nA(i,r,n.legends,d,h,u,c))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),!n.autosize||n.autosize.type!==gk&&n.autosize.type!==yk&&n.autosize.type!==vk)f.union(r);else switch(e.orient){case $w:case Hw:f.add(r.x1,0).add(r.x2,0);break;case Ww:case Zw:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(t,e,n,r,i){var o,a=e.items[0],s=a.frame,l=a.orient,u=a.anchor,c=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=l===$w||l===Hw?r:n,m=0,g=0,y=0,v=0,b=0;if(s!==nk?l===$w?(m=i.y2,p=i.y1):l===Hw?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):l===$w&&(m=r,p=0),o=u===Qw?m:u===Kw?p:(m+p)/2,h&&h.text){switch(l){case Ww:case Zw:b=d.bounds.height()+f;break;case $w:v=d.bounds.width()+f;break;case Hw:v=-d.bounds.width()-f}jk.clear().union(h.bounds),jk.translate(v-(h.x||0),b-(h.y||0)),Uk(h,"x",v)|Uk(h,"y",b)&&(t.dirty(h),h.bounds.clear().union(jk),h.mark.bounds.clear().union(jk),t.dirty(h)),jk.clear().union(h.bounds)}else jk.clear();switch(jk.union(d.bounds),l){case Ww:g=o,y=i.y1-jk.height()-c;break;case $w:g=i.x1-jk.width()-c,y=o;break;case Hw:g=i.x2+jk.width()+c,y=o;break;case Zw:g=o,y=i.y2+c;break;default:g=a.x,y=a.y}return Uk(a,"x",g)|Uk(a,"y",y)&&(jk.translate(g,y),t.dirty(a),a.bounds.clear().union(jk),e.bounds.clear().union(jk),t.dirty(a)),a.bounds}(t,r,u,c,f));e.clip&&f.set(0,0,e.width||0,e.height||0);!function(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let a=t._width,s=t._height,l=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,e.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===pk){const e=t.padding();a-=e.left+e.right,s-=e.top+e.bottom}o===xk?(u=0,f=0,l=a,c=s):o===gk?(l=Math.max(0,a-u-d),c=Math.max(0,s-f-h)):o===yk?(l=Math.max(0,a-u-d),s=c+f+h):o===vk?(a=l+u+d,c=Math.max(0,s-f-h)):o===bk&&(a=l+u+d,s=c+f+h);t._resizeView(a,s,l,c,[u,f],i.resize)}(t,e,f,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}}),Qn(lA,su,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,a=Sy(o,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||Ty(n,o,a,t.formatSpecifier,t.formatType,!!t.values),l=t.values?Dy(o,t.values,a):Fy(o,a);return i&&(r.rem=i),i=l.map(((t,e)=>Fl({index:e/(l.length-1||1),value:t,label:s(t)}))),t.extra&&i.length&&i.push(Fl({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),Qn(uA,su,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||cA,o=t.key||Sl,a=this.value;return sn(r.encode)&&(r.encode=null),a&&(t.modified("key")||e.modified(o))&&$e("DataJoin does not support modified key function or fields."),a||(e=e.addAll(),this.value=a=function(t){const e=Gn().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(o)),e.visit(e.ADD,(t=>{const e=o(t);let n=a.get(e);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),a.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=o(t),n=a.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=o(t),n=a.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),Qn(fA,su,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if(sn(o)){if(!n.changed()&&!o.every((t=>i[t])))return e.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||Je,l=i.enter||Je,u=i.exit||Je,c=(o&&!a?i[o]:s)||Je;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{l(e,t),s(e,t)})),n.modifies(l.output),n.modifies(s.output),c!==Je&&c!==s&&(e.visit(e.ADD,(e=>{c(e,t)})),n.modifies(c.output))),e.changed(e.REM)&&u!==Je&&(e.visit(e.REM,(e=>{u(e,t)})),n.modifies(u.output)),a||c!==Je){const i=e.MOD|(t.modified()?e.REFLOW:0);a?(e.visit(i,(e=>{const i=l(e,t)||r;(c(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)):e.visit(i,(e=>{(c(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:e.StopPropagation}}),Qn(dA,su,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,a,s=e.dataflow.locale(),l=e.fork(e.NO_SOURCE|e.NO_FIELDS),u=this.value,c=t.type||ky,f=t.scale,d=+t.limit,h=Sy(f,null==t.count?5:t.count,t.minstep),p=!!t.values||c===ky,m=t.format||By(s,f,h,c,t.formatSpecifier,t.formatType,p),g=t.values||Ry(f,h);return u&&(l.rem=u),c===ky?(d&&g.length>d?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=g.slice(0,d-1),a=!0):u=g,zn(i=t.size)?(t.values||0!==f(u[0])||(u=u.slice(1)),o=u.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=qn(o=i||8),u=u.map(((e,n)=>Fl({index:n,label:m(e,n,u),value:e,offset:o,size:i(e,t)}))),a&&(a=g[u.length],u.push(Fl({index:u.length,label:"\u2026".concat(g.length-u.length," entries"),value:a,offset:o,size:i(a,t)})))):"gradient"===c?(n=f.domain(),r=yy(f,n[0],hn(n)),g.length<3&&!t.values&&n[0]!==hn(n)&&(g=[n[0],hn(n)]),u=g.map(((t,e)=>Fl({index:e,label:m(t,e,g),value:t,perc:r(t)})))):(i=g.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+hn(e),o=i-r;if(t.type===qg){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}(f),u=g.map(((t,e)=>Fl({index:e,label:m(t,e,g),value:t,perc:e?r(t):0,perc2:e===i?1:r(g[e+1])})))),l.source=u,l.add=u,this.value=u,l}});const hA=t=>t.source.x,pA=t=>t.source.y,mA=t=>t.target.x,gA=t=>t.target.y;function yA(t){su.call(this,{},t)}yA.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Qn(yA,su,{transform(t,e){var n=t.sourceX||hA,r=t.sourceY||pA,i=t.targetX||mA,o=t.targetY||gA,a=t.as||"path",s=t.orient||"vertical",l=t.shape||"line",u=_A.get(l+"-"+s)||_A.get(l);return u||$e("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[a]=u(n(t),r(t),i(t),o(t))})),e.reflow(t.modified()).modifies(a)}});const vA=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,bA=(t,e,n,r)=>{var i=n-t,o=r-e,a=Math.hypot(i,o)/2;return"M"+t+","+e+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},xA=(t,e,n,r)=>{const i=n-t,o=r-e,a=.2*(i+o),s=.2*(o-i);return"M"+t+","+e+"C"+(t+a)+","+(e+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},_A=Gn({line:vA,"line-radial":(t,e,n,r)=>vA(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:bA,"arc-radial":(t,e,n,r)=>bA(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:xA,"curve-radial":(t,e,n,r)=>xA(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*a+","+e*s+"L"+r*a+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n),l=(e+r)/2;return"M"+e*i+","+e*o+"C"+l*i+","+l*o+" "+l*a+","+l*s+" "+r*a+","+r*s}});function wA(t){su.call(this,null,t)}wA.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Qn(wA,su,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],a=o[0],s=o[1],l=t.field||Xe,u=t.startAngle||0,c=null!=t.endAngle?t.endAngle:2*Math.PI,f=e.source,d=f.map(l),h=d.length,p=u,m=(c-u)/sA(d),g=vc(h);for(t.sort&&g.sort(((t,e)=>d[t]-d[e])),n=0;n<h;++n)i=d[g[n]],(r=f[g[n]])[a]=p,r[s]=p+=i*m;return this.value=d,e.reflow(t.modified()).modifies(o)}});const kA=5;function AA(t){return sy(t)&&t!==Bg}const EA=vr(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function MA(t){su.call(this,null,t),this.modified(!0)}function CA(t,e,n){if(cy(t)){var r=Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0));r!==e.length&&n.warn("Log scale domain includes zero: "+hr(e))}return e}function SA(t,e,n){return zn(t)&&(e||n)?py(t,DA(e||[0,1],n)):t}function DA(t,e){return e?t.slice().reverse():t}function FA(t){su.call(this,null,t)}Qn(MA,su,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";if(n===Bg)return Bg+"-"+Fg;(function(t){const e=t.type;return sy(e)&&e!==Rg&&e!==Pg&&(t.scheme||t.range&&t.range.length&&t.range.every(ir))})(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?Bg+"-":3===e?Lg+"-":"");return(r+n||Fg).toLowerCase()}(t);for(i in r&&i===r.type||(this.value=r=iy(i)()),t)if(!EA[i]){if("padding"===i&&AA(r.type))continue;zn(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){t!==$g&&t!==Wg&&$e("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===Wg?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Dg(n,i,r)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i=e.schemeExtent;sn(e.scheme)?r=my(e.scheme,e.interpolate,e.interpolateGamma):(r=wy(e.scheme.toLowerCase()))||$e("Unrecognized scheme name: ".concat(e.scheme));return n=t===qg?n+1:t===Hg?n-1:t===jg||t===Ug?+e.schemeCount||kA:n,fy(t)?SA(r,i,e.reverse):zn(r)?gy(SA(r,i),n):t===Ig?r:r.slice(0,n)}(r,e,n),zn(o))){if(t.interpolator)return t.interpolator(o);$e("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&fy(r))return t.interpolator(my(DA(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(vy(e.interpolate,e.interpolateGamma)):zn(t.round)?t.round(i):zn(t.rangeRound)&&t.interpolate(i?Np:Tp);o&&t.range(DA(o,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!sn(r)){const e=t.domain(),n=e[0],i=hn(e),o=r.step;let a=null==r.start?n:r.start,s=null==r.stop?i:r.stop;o||$e("Scale bins parameter missing step property."),a<n&&(a=o*Math.ceil(n/o)),s>i&&(s=o*Math.floor(i/o)),r=vc(a,s+o/2,o)}r?t.bins=r:t.bins&&delete t.bins;t.type===Hg&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain());return n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(CA(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,a=e.domain,s=t.type,l=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===Fg||e===Ng||e===Og)}(t);if(!a)return 0;AA(s)&&e.padding&&a[0]!==hn(a)&&(a=function(t,e,n,r,i,o){var a=Math.abs(hn(n)-n[0]),s=a/(a-2*r),l=t===Tg?Cn(e,null,s):t===Og?Sn(e,null,s,.5):t===Ng?Sn(e,null,s,i||1):t===zg?Dn(e,null,s,o||1):Mn(e,null,s);return e=e.slice(),e[0]=l[0],e[e.length-1]=l[1],e}(s,a,e.range,e.padding,e.exponent,e.constant));if((l||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(a=a.slice()).length-1||1,l&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=e.domainMin&&(a[0]=e.domainMin),null!=e.domainMax&&(a[i]=e.domainMax),null!=e.domainMid)){const t=(o=e.domainMid)>a[i]?i+1:o<a[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(t,0,o)}t.domain(CA(s,a,n)),s===Ig&&t.unknown(e.domainImplicit?Dm:void 0);e.nice&&t.nice&&t.nice(!0!==e.nice&&Sy(t,e.nice)||null);return a.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Qn(FA,su,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(zl(t.sort)),this.modified(n),e}});const TA="zero",NA="center",OA="normalize",zA=["y0","y1"];function RA(t){su.call(this,null,t)}function PA(t,e,n,r,i){for(var o,a=(e-t.sum)/2,s=t.length,l=0;l<s;++l)(o=t[l])[r]=a,o[i]=a+=Math.abs(n(o))}function BA(t,e,n,r,i){for(var o,a=1/t.sum,s=0,l=t.length,u=0,c=0;u<l;++u)(o=t[u])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function LA(t,e,n,r,i){for(var o,a,s=0,l=0,u=t.length,c=0;c<u;++c)(o=+n(a=t[c]))<0?(a[r]=l,a[i]=l+=o):(a[r]=s,a[i]=s+=o)}RA.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:TA,values:[TA,NA,OA]},{name:"as",type:"string",array:!0,length:2,default:zA}]},Qn(RA,su,{transform(t,e){var n,r,i,o,a=t.as||zA,s=a[0],l=a[1],u=zl(t.sort),c=t.field||Xe,f=t.offset===NA?PA:t.offset===OA?BA:LA;for(n=function(t,e,n,r){var i,o,a,s,l,u,c,f,d,h=[],p=t=>t(l);if(null==e)h.push(t.slice());else for(i={},o=0,a=t.length;o<a;++o)l=t[o],(c=i[u=e.map(p)])||(i[u]=c=[],h.push(c)),c.push(l);for(u=0,d=0,s=h.length;u<s;++u){for(o=0,f=0,a=(c=h[u]).length;o<a;++o)f+=Math.abs(r(c[o]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(e.source,t.groupby,u,c),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,c,s,l);return e.reflow(t.modified()).modifies(a)}});const jA=t=>t;function UA(t,e){t&&IA.hasOwnProperty(t.type)&&IA[t.type](t,e)}var qA={Feature:function(t,e){UA(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)UA(n[r].geometry,e)}},IA={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){WA(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)WA(n[r],e,0)},Polygon:function(t,e){$A(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)$A(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)UA(n[r],e)}};function WA(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function $A(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)WA(t[n],e,1);e.polygonEnd()}function HA(t,e){t&&qA.hasOwnProperty(t.type)?qA[t.type](t,e):UA(t,e)}class ZA{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[n++]=a),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}var YA=1e-6,VA=1e-12,GA=Math.PI,XA=GA/2,QA=GA/4,JA=2*GA,KA=180/GA,tE=GA/180,eE=Math.abs,nE=Math.atan,rE=Math.atan2,iE=Math.cos,oE=Math.ceil,aE=Math.exp,sE=(Math.floor,Math.hypot),lE=Math.log,uE=Math.pow,cE=Math.sin,fE=Math.sign||function(t){return t>0?1:t<0?-1:0},dE=Math.sqrt,hE=Math.tan;function pE(t){return t>1?0:t<-1?GA:Math.acos(t)}function mE(t){return t>1?XA:t<-1?-XA:Math.asin(t)}function gE(){}var yE,vE,bE,xE,_E=new ZA,wE=new ZA,kE={point:gE,lineStart:gE,lineEnd:gE,polygonStart:function(){kE.lineStart=AE,kE.lineEnd=CE},polygonEnd:function(){kE.lineStart=kE.lineEnd=kE.point=gE,_E.add(eE(wE)),wE=new ZA},result:function(){var t=_E/2;return _E=new ZA,t}};function AE(){kE.point=EE}function EE(t,e){kE.point=ME,yE=bE=t,vE=xE=e}function ME(t,e){wE.add(xE*t-bE*e),bE=t,xE=e}function CE(){ME(yE,vE)}const SE=kE;var DE=1/0,FE=DE,TE=-DE,NE=TE,OE={point:function(t,e){t<DE&&(DE=t);t>TE&&(TE=t);e<FE&&(FE=e);e>NE&&(NE=e)},lineStart:gE,lineEnd:gE,polygonStart:gE,polygonEnd:gE,result:function(){var t=[[DE,FE],[TE,NE]];return TE=NE=-(FE=DE=1/0),t}};const zE=OE;var RE,PE,BE,LE,jE=0,UE=0,qE=0,IE=0,WE=0,$E=0,HE=0,ZE=0,YE=0,VE={point:GE,lineStart:XE,lineEnd:KE,polygonStart:function(){VE.lineStart=tM,VE.lineEnd=eM},polygonEnd:function(){VE.point=GE,VE.lineStart=XE,VE.lineEnd=KE},result:function(){var t=YE?[HE/YE,ZE/YE]:$E?[IE/$E,WE/$E]:qE?[jE/qE,UE/qE]:[NaN,NaN];return jE=UE=qE=IE=WE=$E=HE=ZE=YE=0,t}};function GE(t,e){jE+=t,UE+=e,++qE}function XE(){VE.point=QE}function QE(t,e){VE.point=JE,GE(BE=t,LE=e)}function JE(t,e){var n=t-BE,r=e-LE,i=dE(n*n+r*r);IE+=i*(BE+t)/2,WE+=i*(LE+e)/2,$E+=i,GE(BE=t,LE=e)}function KE(){VE.point=GE}function tM(){VE.point=nM}function eM(){rM(RE,PE)}function nM(t,e){VE.point=rM,GE(RE=BE=t,PE=LE=e)}function rM(t,e){var n=t-BE,r=e-LE,i=dE(n*n+r*r);IE+=i*(BE+t)/2,WE+=i*(LE+e)/2,$E+=i,HE+=(i=LE*t-BE*e)*(BE+t),ZE+=i*(LE+e),YE+=3*i,GE(BE=t,LE=e)}const iM=VE;function oM(t){this._context=t}oM.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,JA)}},result:gE};var aM,sM,lM,uM,cM,fM=new ZA,dM={point:gE,lineStart:function(){dM.point=hM},lineEnd:function(){aM&&pM(sM,lM),dM.point=gE},polygonStart:function(){aM=!0},polygonEnd:function(){aM=null},result:function(){var t=+fM;return fM=new ZA,t}};function hM(t,e){dM.point=pM,sM=uM=t,lM=cM=e}function pM(t,e){uM-=t,cM-=e,fM.add(dE(uM*uM+cM*cM)),uM=t,cM=e}const mM=dM;var gM,yM,vM,bM;let xM,_M,wM,kM;class AM{constructor(t){this._append=null==t?EM:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));if(e>15)return EM;if(e!==xM){const t=10**e;xM=e,_M=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return _M}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append(gM||(gM=jd(["M",",",""])),t,e),this._point=1;break;case 1:this._append(yM||(yM=jd(["L",",",""])),t,e);break;default:if(this._append(vM||(vM=jd(["M",",",""])),t,e),this._radius!==wM||this._append!==_M){const t=this._radius,e=this._;this._="",this._append(bM||(bM=jd(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),t,t,t,-2*t,t,t,2*t),wM=t,_M=this._append,kM=this._,this._=e}this._+=kM}}result(){const t=this._;return this._="",t.length?t:null}}function EM(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function MM(t,e){let n,r,i=3,o=4.5;function a(t){return t&&("function"===typeof o&&r.pointRadius(+o.apply(this,arguments)),HA(t,n(r))),r.result()}return a.area=function(t){return HA(t,n(SE)),SE.result()},a.measure=function(t){return HA(t,n(mM)),mM.result()},a.bounds=function(t){return HA(t,n(zE)),zE.result()},a.centroid=function(t){return HA(t,n(iM)),iM.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,jA):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new AM(i)):new oM(e=t),"function"!==typeof o&&r.pointRadius(o),a):e},a.pointRadius=function(t){return arguments.length?(o="function"===typeof t?t:(r.pointRadius(+t),+t),a):o},a.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));i=e}return null===e&&(r=new AM(i)),a},a.projection(t).digits(i).context(e)}function CM(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:gE,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function SM(t,e){return eE(t[0]-e[0])<YA&&eE(t[1]-e[1])<YA}function DM(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function FM(t,e,n,r,i){var o,a,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(SM(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2*YA}s.push(n=new DM(r,t,null,!0)),l.push(n.o=new DM(r,null,n,!1)),s.push(n=new DM(a,t,null,!1)),l.push(n.o=new DM(a,null,n,!0))}})),s.length){for(l.sort(e),TM(s),TM(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function TM(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function NM(t){return[rE(t[1],t[0]),mE(t[2])]}function OM(t){var e=t[0],n=t[1],r=iE(n);return[r*iE(e),r*cE(e),cE(n)]}function zM(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function RM(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function PM(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function BM(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function LM(t){var e=dE(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function jM(t){return eE(t[0])<=GA?t[0]:fE(t[0])*((eE(t[0])+GA)%JA-GA)}function UM(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function qM(t,e,n,r){return function(i){var o,a,s,l=e(i),u=CM(),c=e(u),f=!1,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,a=UM(a);var t=function(t,e){var n=jM(e),r=e[1],i=cE(r),o=[cE(n),-iE(n),0],a=0,s=0,l=new ZA;1===i?r=XA+YA:-1===i&&(r=-XA-YA);for(var u=0,c=t.length;u<c;++u)if(d=(f=t[u]).length)for(var f,d,h=f[d-1],p=jM(h),m=h[1]/2+QA,g=cE(m),y=iE(m),v=0;v<d;++v,p=x,g=w,y=k,h=b){var b=f[v],x=jM(b),_=b[1]/2+QA,w=cE(_),k=iE(_),A=x-p,E=A>=0?1:-1,M=E*A,C=M>GA,S=g*w;if(l.add(rE(S*E*cE(M),y*k+S*iE(M))),a+=C?A+E*JA:A,C^p>=n^x>=n){var D=RM(OM(h),OM(b));LM(D);var F=RM(o,D);LM(F);var T=(C^A>=0?-1:1)*mE(F[2]);(r>T||r===T&&(D[0]||D[1]))&&(s+=C^A>=0?1:-1)}}return(a<-YA||a<YA&&l<-VA)^1&s}(o,r);a.length?(f||(i.polygonStart(),f=!0),FM(a,WM,t,n,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(e,n){t(e,n)&&i.point(e,n)}function p(t,e){l.point(t,e)}function m(){d.point=p,l.lineStart()}function g(){d.point=h,l.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,n,r,l=c.clean(),d=u.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&l){if((e=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else h>1&&2&l&&d.push(d.pop().concat(d.shift())),a.push(d.filter(IM))}return d}}function IM(t){return t.length>1}function WM(t,e){return((t=t.x)[0]<0?t[1]-XA-YA:XA-t[1])-((e=e.x)[0]<0?e[1]-XA-YA:XA-e[1])}const $M=qM((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?GA:-GA,l=eE(o-n);eE(l-GA)<YA?(t.point(n,r=(r+a)/2>0?XA:-XA),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&l>=GA&&(eE(n-i)<YA&&(n-=i*YA),eE(o-s)<YA&&(o-=s*YA),r=function(t,e,n,r){var i,o,a=cE(t-n);return eE(a)>YA?nE((cE(e)*(o=iE(r))*cE(n)-cE(r)*(i=iE(e))*cE(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*XA,r.point(-GA,i),r.point(0,i),r.point(GA,i),r.point(GA,0),r.point(GA,-i),r.point(0,-i),r.point(-GA,-i),r.point(-GA,0),r.point(-GA,i);else if(eE(t[0]-e[0])>YA){var o=t[0]<e[0]?GA:-GA;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-GA,-XA]);function HM(t,e,n,r,i,o){if(n){var a=iE(e),s=cE(e),l=r*n;null==i?(i=e+r*JA,o=e-l/2):(i=ZM(a,i),o=ZM(a,o),(r>0?i<o:i>o)&&(i+=r*JA));for(var u,c=i;r>0?c>o:c<o;c-=l)u=NM([a,-s*iE(c),-s*cE(c)]),t.point(u[0],u[1])}}function ZM(t,e){(e=OM(e))[0]-=t,LM(e);var n=pE(-e[1]);return((-e[2]<0?-n:n)+JA-YA)%JA}var YM=1e9,VM=-YM;function GM(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return eE(r[0]-t)<YA?i>0?0:3:eE(r[0]-n)<YA?i>0?2:1:eE(r[1]-e)<YA?i>0?1:0:i>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var l,u,c,f,d,h,p,m,g,y,v,b=a,x=CM(),_={point:w,lineStart:function(){_.point=k,u&&u.push(c=[]);y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(k(f,d),h&&g&&x.rejoin(),l.push(x.result()));_.point=w,g&&b.lineEnd()},polygonStart:function(){b=x,l=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,a,s=u[n],l=1,c=s.length,f=s[0],d=f[0],h=f[1];l<c;++l)o=d,a=h,d=(f=s[l])[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(t-o)&&++e:h<=r&&(d-o)*(r-a)<(h-a)*(t-o)&&--e;return e}(),n=v&&e,i=(l=UM(l)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&FM(l,s,e,o,a),a.polygonEnd());b=a,l=u=c=null}};function w(t,e){i(t,e)&&b.point(t,e)}function k(o,a){var s=i(o,a);if(u&&c.push([o,a]),y)f=o,d=a,h=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var l=[p=Math.max(VM,Math.min(YM,p)),m=Math.max(VM,Math.min(YM,m))],x=[o=Math.max(VM,Math.min(YM,o)),a=Math.max(VM,Math.min(YM,a))];!function(t,e,n,r,i,o){var a,s=t[0],l=t[1],u=0,c=1,f=e[0]-s,d=e[1]-l;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(t[0]=s+u*f,t[1]=l+u*d),c<1&&(e[0]=s+c*f,e[1]=l+c*d),!0}}}}}(l,x,t,e,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(l[0],l[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return _}}function XM(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function QM(t,e){return eE(t)>GA&&(t-=Math.round(t/JA)*JA),[t,e]}function JM(t,e,n){return(t%=JA)?e||n?XM(tC(t),eC(e,n)):tC(t):e||n?eC(e,n):QM}function KM(t){return function(e,n){return eE(e+=t)>GA&&(e-=Math.round(e/JA)*JA),[e,n]}}function tC(t){var e=KM(t);return e.invert=KM(-t),e}function eC(t,e){var n=iE(t),r=cE(t),i=iE(e),o=cE(e);function a(t,e){var a=iE(e),s=iE(t)*a,l=cE(t)*a,u=cE(e),c=u*n+s*r;return[rE(l*i-c*o,s*n-u*r),mE(c*i+l*o)]}return a.invert=function(t,e){var a=iE(e),s=iE(t)*a,l=cE(t)*a,u=cE(e),c=u*i-l*o;return[rE(l*i+u*o,s*n+c*r),mE(c*n-s*r)]},a}function nC(t){return function(e){var n=new rC;for(var r in t)n[r]=t[r];return n.stream=e,n}}function rC(){}function iC(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),HA(n,t.stream(zE)),e(zE.result()),null!=r&&t.clipExtent(r),t}function oC(t,e,n){return iC(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function aC(t,e,n){return oC(t,[[0,0],e],n)}function sC(t,e,n){return iC(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function lC(t,e,n){return iC(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}QM.invert=QM,rC.prototype={constructor:rC,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var uC=16,cC=iE(30*tE);function fC(t,e){return+e?function(t,e){function n(r,i,o,a,s,l,u,c,f,d,h,p,m,g){var y=u-r,v=c-i,b=y*y+v*v;if(b>4*e&&m--){var x=a+d,_=s+h,w=l+p,k=dE(x*x+_*_+w*w),A=mE(w/=k),E=eE(eE(w)-1)<YA||eE(o-f)<YA?(o+f)/2:rE(_,x),M=t(E,A),C=M[0],S=M[1],D=C-r,F=S-i,T=v*D-y*F;(T*T/b>e||eE((y*D+v*F)/b-.5)>.3||a*d+s*h+l*p<cC)&&(n(r,i,o,a,s,l,C,S,E,x/=k,_/=k,w,m,g),g.point(C,S),n(C,S,E,x,_,w,u,c,f,d,h,p,m,g))}}return function(e){var r,i,o,a,s,l,u,c,f,d,h,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,m.point=v,e.lineStart()}function v(r,i){var o=OM([r,i]),a=t(r,i);n(c,f,u,d,h,p,c=a[0],f=a[1],u=r,d=o[0],h=o[1],p=o[2],uC,e),e.point(c,f)}function b(){m.point=g,e.lineEnd()}function x(){y(),m.point=_,m.lineEnd=w}function _(t,e){v(r=t,e),i=c,o=f,a=d,s=h,l=p,m.point=v}function w(){n(c,f,u,d,h,p,i,o,r,a,s,l,uC,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return nC({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var dC=nC({point:function(t,e){this.stream.point(t*tE,e*tE)}});function hC(t,e,n,r,i,o){if(!o)return function(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}(t,e,n,r,i);var a=iE(o),s=cE(o),l=a*t,u=s*t,c=a/t,f=s/t,d=(s*n-a*e)/t,h=(s*e+a*n)/t;function p(t,o){return[l*(t*=r)-u*(o*=i)+e,n-u*t-l*o]}return p.invert=function(t,e){return[r*(c*t-f*e+d),i*(h-f*t-c*e)]},p}function pC(t){return mC((function(){return t}))()}function mC(t){var e,n,r,i,o,a,s,l,u,c,f=150,d=480,h=250,p=0,m=0,g=0,y=0,v=0,b=0,x=1,_=1,w=null,k=$M,A=null,E=jA,M=.5;function C(t){return l(t[0]*tE,t[1]*tE)}function S(t){return(t=l.invert(t[0],t[1]))&&[t[0]*KA,t[1]*KA]}function D(){var t=hC(f,0,0,x,_,b).apply(null,e(p,m)),r=hC(f,d-t[0],h-t[1],x,_,b);return n=JM(g,y,v),s=XM(e,r),l=XM(n,s),a=fC(s,M),F()}function F(){return u=c=null,C}return C.stream=function(t){return u&&c===t?u:u=dC(function(t){return nC({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(k(a(E(c=t)))))},C.preclip=function(t){return arguments.length?(k=t,w=void 0,F()):k},C.postclip=function(t){return arguments.length?(E=t,A=r=i=o=null,F()):E},C.clipAngle=function(t){return arguments.length?(k=+t?function(t){var e=iE(t),n=6*tE,r=e>0,i=eE(e)>YA;function o(t,n){return iE(t)*iE(n)>e}function a(t,n,r){var i=[1,0,0],o=RM(OM(t),OM(n)),a=zM(o,o),s=o[0],l=a-s*s;if(!l)return!r&&t;var u=e*a/l,c=-e*s/l,f=RM(i,o),d=BM(i,u);PM(d,BM(o,c));var h=f,p=zM(d,h),m=zM(h,h),g=p*p-m*(zM(d,d)-1);if(!(g<0)){var y=dE(g),v=BM(h,(-p-y)/m);if(PM(v,d),v=NM(v),!r)return v;var b,x=t[0],_=n[0],w=t[1],k=n[1];_<x&&(b=x,x=_,_=b);var A=_-x,E=eE(A-GA)<YA;if(!E&&k<w&&(b=w,w=k,k=b),E||A<YA?E?w+k>0^v[1]<(eE(v[0]-x)<YA?w:k):w<=v[1]&&v[1]<=k:A>GA^(x<=v[0]&&v[0]<=_)){var M=BM(h,(-p+y)/m);return PM(M,d),[v,NM(M)]}}}function s(e,n){var i=r?t:GA-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return qM(o,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,d){var h,p=[f,d],m=o(f,d),g=r?m?0:s(f,d):m?s(f+(f<0?GA:-GA),d):0;if(!e&&(u=l=m)&&t.lineStart(),m!==l&&(!(h=a(e,p))||SM(e,h)||SM(p,h))&&(p[2]=1),m!==l)c=0,m?(t.lineStart(),h=a(p,e),t.point(h[0],h[1])):(h=a(e,p),t.point(h[0],h[1],2),t.lineEnd()),e=h;else if(i&&e&&r^m){var y;g&n||!(y=a(p,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!m||e&&SM(e,p)||t.point(p[0],p[1]),e=p,l=m,n=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,r,i,o){HM(o,t,n,i,e,r)}),r?[0,-t]:[-GA,t-GA])}(w=t*tE):(w=null,$M),F()):w*KA},C.clipExtent=function(t){return arguments.length?(E=null==t?(A=r=i=o=null,jA):GM(A=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),F()):null==A?null:[[A,r],[i,o]]},C.scale=function(t){return arguments.length?(f=+t,D()):f},C.translate=function(t){return arguments.length?(d=+t[0],h=+t[1],D()):[d,h]},C.center=function(t){return arguments.length?(p=t[0]%360*tE,m=t[1]%360*tE,D()):[p*KA,m*KA]},C.rotate=function(t){return arguments.length?(g=t[0]%360*tE,y=t[1]%360*tE,v=t.length>2?t[2]%360*tE:0,D()):[g*KA,y*KA,v*KA]},C.angle=function(t){return arguments.length?(b=t%360*tE,D()):b*KA},C.reflectX=function(t){return arguments.length?(x=t?-1:1,D()):x<0},C.reflectY=function(t){return arguments.length?(_=t?-1:1,D()):_<0},C.precision=function(t){return arguments.length?(a=fC(s,M=t*t),F()):dE(M)},C.fitExtent=function(t,e){return oC(C,t,e)},C.fitSize=function(t,e){return aC(C,t,e)},C.fitWidth=function(t,e){return sC(C,t,e)},C.fitHeight=function(t,e){return lC(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&S,D()}}function gC(t){var e=0,n=GA/3,r=mC(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*tE,n=t[1]*tE):[e*KA,n*KA]},i}function yC(t,e){var n=cE(t),r=(n+cE(e))/2;if(eE(r)<YA)return function(t){var e=iE(t);function n(t,n){return[t*e,cE(n)/e]}return n.invert=function(t,n){return[t/e,mE(n*e)]},n}(t);var i=1+n*(2*r-n),o=dE(i)/r;function a(t,e){var n=dE(i-2*r*cE(e))/r;return[n*cE(t*=r),o-n*iE(t)]}return a.invert=function(t,e){var n=o-e,a=rE(t,eE(n))*fE(n);return n*r<0&&(a-=GA*fE(t)*fE(n)),[a/r,mE((i-(t*t+n*n)*r*r)/(2*r))]},a}function vC(){return gC(yC).scale(155.424).center([0,33.6442])}function bC(){return vC().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function xC(t){return function(e,n){var r=iE(e),i=iE(n),o=t(r*i);return o===1/0?[2,0]:[o*i*cE(e),o*cE(n)]}}function _C(t){return function(e,n){var r=dE(e*e+n*n),i=t(r),o=cE(i),a=iE(i);return[rE(e*o,r*a),mE(r&&n*o/r)]}}var wC=xC((function(t){return dE(2/(1+t))}));wC.invert=_C((function(t){return 2*mE(t/2)}));var kC=xC((function(t){return(t=pE(t))&&t/cE(t)}));function AC(t,e){return[t,lE(hE((XA+e)/2))]}function EC(t){var e,n,r,i=pC(t),o=i.center,a=i.scale,s=i.translate,l=i.clipExtent,u=null;function c(){var o=GA*a(),s=i(function(t){function e(e){return(e=t(e[0]*tE,e[1]*tE))[0]*=KA,e[1]*=KA,e}return t=JM(t[0]*tE,t[1]*tE,t.length>2?t[2]*tE:0),e.invert=function(e){return(e=t.invert(e[0]*tE,e[1]*tE))[0]*=KA,e[1]*=KA,e},e}(i.rotate()).invert([0,0]));return l(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===AC?[[Math.max(s[0]-o,u),e],[Math.min(s[0]+o,n),r]]:[[u,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),c()):a()},i.translate=function(t){return arguments.length?(s(t),c()):s()},i.center=function(t){return arguments.length?(o(t),c()):o()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),c()):null==u?null:[[u,e],[n,r]]},c()}function MC(t){return hE((XA+t)/2)}function CC(t,e){var n=iE(t),r=t===e?cE(t):lE(n/iE(e))/lE(MC(e)/MC(t)),i=n*uE(MC(t),r)/r;if(!r)return AC;function o(t,e){i>0?e<-XA+YA&&(e=-XA+YA):e>XA-YA&&(e=XA-YA);var n=i/uE(MC(e),r);return[n*cE(r*t),i-n*iE(r*t)]}return o.invert=function(t,e){var n=i-e,o=fE(r)*dE(t*t+n*n),a=rE(t,eE(n))*fE(n);return n*r<0&&(a-=GA*fE(t)*fE(n)),[a/r,2*nE(uE(i/o,1/r))-XA]},o}function SC(t,e){return[t,e]}function DC(t,e){var n=iE(t),r=t===e?cE(t):(n-iE(e))/(e-t),i=n/r+t;if(eE(r)<YA)return SC;function o(t,e){var n=i-e,o=r*t;return[n*cE(o),i-n*iE(o)]}return o.invert=function(t,e){var n=i-e,o=rE(t,eE(n))*fE(n);return n*r<0&&(o-=GA*fE(t)*fE(n)),[o/r,i-fE(r)*dE(t*t+n*n)]},o}kC.invert=_C((function(t){return t})),AC.invert=function(t,e){return[t,2*nE(aE(e))-XA]},SC.invert=SC;var FC=1.340264,TC=-.081106,NC=893e-6,OC=.003796,zC=dE(3)/2;function RC(t,e){var n=mE(zC*cE(e)),r=n*n,i=r*r*r;return[t*iE(n)/(zC*(FC+3*TC*r+i*(7*NC+9*OC*r))),n*(FC+TC*r+i*(NC+OC*r))]}function PC(t,e){var n=iE(e),r=iE(t)*n;return[n*cE(t)/r,cE(e)/r]}function BC(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function LC(t,e){return[iE(e)*cE(t),cE(e)]}function jC(t,e){var n=iE(e),r=1+iE(t)*n;return[n*cE(t)/r,cE(e)/r]}function UC(t,e){return[lE(hE((XA+e)/2)),-t]}RC.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(FC+TC*i+o*(NC+OC*i))-e)/(FC+3*TC*i+o*(7*NC+9*OC*i)))*r)*i*i,!(eE(n)<VA));++a);return[zC*t*(FC+3*TC*i+o*(7*NC+9*OC*i))/iE(r),mE(cE(r)/zC)]},PC.invert=_C(nE),BC.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(eE(n)>YA&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},LC.invert=_C(mE),jC.invert=_C((function(t){return 2*nE(t)})),UC.invert=function(t,e){return[-e,2*nE(aE(t))-XA]};var qC=Math.abs,IC=(Math.atan,Math.atan2,Math.ceil,Math.cos),WC=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),$C=(Math.tan,1e-6),HC=Math.PI,ZC=HC/2,YC=(Math.SQRT1_2,GC(2));GC(HC);function VC(t){return t>1?ZC:t<-1?-ZC:Math.asin(t)}function GC(t){return t>0?Math.sqrt(t):0}function XC(t,e){var n,r=t*WC(e),i=30;do{e-=n=(e+WC(e)-r)/(1+IC(e))}while(qC(n)>$C&&--i>0);return e/2}var QC=function(t,e,n){function r(r,i){return[t*r*IC(i=XC(n,i)),e*WC(i)]}return r.invert=function(r,i){return i=VC(i/e),[r/(t*IC(i)),VC((2*i+WC(2*i))/n)]},r}(YC/ZC,YC,HC);const JC=MM(),KC=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function tS(t,e){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(nS[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=MM().projection(r),r.copy=r.copy||function(){const t=n();return KC.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},ry(r)}}(t,e),this):nS[t]||null}function eS(t){return t&&t.path||JC}const nS={albers:bC,albersusa:function(){var t,e,n,r,i,o,a=bC(),s=vC().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=vC().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){o=[t,e]}};function c(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function f(){return t=e=null,c}return c.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:a).invert(t)},c.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([a.stream(e=n),s.stream(n),l.stream(n)])},c.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),l.precision(t),f()):a.precision()},c.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),l.scale(t),c.translate(a.translate())):a.scale()},c.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],c=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,c-.238*e],[o+.455*e,c+.238*e]]).stream(u),r=s.translate([o-.307*e,c+.201*e]).clipExtent([[o-.425*e+YA,c+.12*e+YA],[o-.214*e-YA,c+.234*e-YA]]).stream(u),i=l.translate([o-.205*e,c+.212*e]).clipExtent([[o-.214*e+YA,c+.166*e+YA],[o-.115*e-YA,c+.234*e-YA]]).stream(u),f()},c.fitExtent=function(t,e){return oC(c,t,e)},c.fitSize=function(t,e){return aC(c,t,e)},c.fitWidth=function(t,e){return sC(c,t,e)},c.fitHeight=function(t,e){return lC(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return pC(wC).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return pC(kC).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return gC(CC).scale(109.5).parallels([30,30])},conicequalarea:vC,conicequidistant:function(){return gC(DC).scale(131.154).center([0,13.9389])},equalEarth:function(){return pC(RC).scale(177.158)},equirectangular:function(){return pC(SC).scale(152.63)},gnomonic:function(){return pC(PC).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,o,a,s=1,l=0,u=0,c=1,f=1,d=0,h=null,p=1,m=1,g=nC({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=jA;function v(){return p=s*c,m=s*f,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+l,i+u]}return b.invert=function(n){var r=n[0]-l,i=n[1]-u;if(d){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/m]},b.stream=function(t){return o&&a===t?o:o=g(y(a=t))},b.postclip=function(t){return arguments.length?(y=t,h=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(h=n=r=i=null,jA):GM(h=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==h?null:[[h,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],v()):[l,u]},b.angle=function(n){return arguments.length?(e=cE(d=n%360*tE),t=iE(d),v()):d*KA},b.reflectX=function(t){return arguments.length?(c=t?-1:1,v()):c<0},b.reflectY=function(t){return arguments.length?(f=t?-1:1,v()):f<0},b.fitExtent=function(t,e){return oC(b,t,e)},b.fitSize=function(t,e){return aC(b,t,e)},b.fitWidth=function(t,e){return sC(b,t,e)},b.fitHeight=function(t,e){return lC(b,t,e)},b},mercator:function(){return EC(AC).scale(961/JA)},mollweide:function(){return pC(QC).scale(169.529)},naturalEarth1:function(){return pC(BC).scale(175.295)},orthographic:function(){return pC(LC).scale(249.5).clipAngle(90+YA)},stereographic:function(){return pC(jC).scale(250).clipAngle(142)},transversemercator:function(){var t=EC(UC),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const n in nS)tS(n,nS[n]);function rS(t,e,n){var r=vc(t,e-YA,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function iS(t,e,n){var r=vc(t,e-YA,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function oS(){var t,e,n,r,i,o,a,s,l,u,c,f,d=10,h=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return vc(oE(r/p)*p,n,p).map(c).concat(vc(oE(s/m)*m,a,m).map(f)).concat(vc(oE(e/d)*d,t,d).filter((function(t){return eE(t%p)>YA})).map(l)).concat(vc(oE(o/h)*h,i,h).filter((function(t){return eE(t%m)>YA})).map(u))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],y):[p,m]},y.stepMinor=function(t){return arguments.length?(d=+t[0],h=+t[1],y):[d,h]},y.precision=function(d){return arguments.length?(g=+d,l=rS(o,i,90),u=iS(e,t,g),c=rS(s,a,90),f=iS(r,n,g),y):g},y.extentMajor([[-180,-90+YA],[180,90-YA]]).extentMinor([[-180,-80-YA],[180,80+YA]])}function aS(){}const sS=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function lS(){var t=1,e=1,n=a;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,l,u,c,f,d=new Array,h=new Array;a=s=-1,u=n[0]>=r,sS[u<<1].forEach(p);for(;++a<t-1;)l=u,u=n[a+1]>=r,sS[l|u<<1].forEach(p);sS[u<<0].forEach(p);for(;++s<e-1;){for(a=-1,u=n[s*t+t]>=r,c=n[s*t]>=r,sS[u<<1|c<<2].forEach(p);++a<t-1;)l=u,u=n[s*t+t+a+1]>=r,f=c,c=n[s*t+a+1]>=r,sS[l|u<<1|c<<2|f<<3].forEach(p);sS[u|c<<3].forEach(p)}a=-1,c=n[s*t]>=r,sS[c<<2].forEach(p);for(;++a<t-1;)f=c,c=n[s*t+a+1]>=r,sS[c<<2|f<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+a,t[0][1]+s],l=[t[1][0]+a,t[1][1]+s],u=o(r),c=o(l);(e=h[u])?(n=d[c])?(delete h[e.end],delete d[n.start],e===n?(e.ring.push(l),i(e.ring)):d[e.start]=h[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[e.end],e.ring.push(l),h[e.end=c]=e):(e=d[c])?(n=h[u])?(delete d[e.start],delete h[n.end],e===n?(e.ring.push(l),i(e.ring)):d[n.start]=h[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=u]=e):d[u]=h[c]={start:u,end:c,ring:[r,l]}}sS[c<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];for(;++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):s.push(t)})),s.forEach((t=>{for(var e,n=0,r=a.length;n<r;++n)if(-1!==uS((e=a[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach((n=>{var o,a=n[0],s=n[1],l=0|a,u=0|s,c=r[u*t+l];a>0&&a<t&&l===a&&(o=r[u*t+l-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<e&&u===s&&(o=r[(u-1)*t+l],n[1]=s+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||$e("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?a:aS,r):n===a},r}function uS(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=cS(t,e[r]))return n;return 0}function cS(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var l=t[o],u=l[0],c=l[1],f=t[s],d=f[0],h=f[1];if(fS(l,f,e))return 0;c>r!==h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function fS(t,e,n){var r,i,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],a=e[r],i<=o&&o<=a||a<=o&&o<=i)}function dS(t,e,n){return function(r){var i=$n(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,l=e?$r(o,a,t):s/(t+1);return vc(o+l,a,l)}}function hS(t){su.call(this,null,t)}function pS(t,e,n,r,i){const o=t.x1||0,a=t.y1||0,s=e*n<0;function l(t){t.forEach(u)}function u(t){s&&t.reverse(),t.forEach(c)}function c(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-a)*n+i}return function(t){return t.coordinates.forEach(l),t}}function mS(t,e,n){const r=t>=0?t:Au(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function gS(t){return zn(t)?t:qn(+t)}function yS(){var t=t=>t[0],e=t=>t[1],n=Xe,r=[-1,-1],i=960,o=500,a=2;function s(s,l){const u=mS(r[0],s,t)>>a,c=mS(r[1],s,e)>>a,f=u?u+2:0,d=c?c+2:0,h=2*f+(i>>a),p=2*d+(o>>a),m=new Float32Array(h*p),g=new Float32Array(h*p);let y=m;s.forEach((r=>{const i=f+(+t(r)>>a),o=d+(+e(r)>>a);i>=0&&i<h&&o>=0&&o<p&&(m[i+o*h]+=+n(r))})),u>0&&c>0?(vS(h,p,m,g,u),bS(h,p,g,m,c),vS(h,p,m,g,u),bS(h,p,g,m,c),vS(h,p,m,g,u),bS(h,p,g,m,c)):u>0?(vS(h,p,m,g,u),vS(h,p,g,m,u),vS(h,p,m,g,u),y=g):c>0&&(bS(h,p,m,g,c),bS(h,p,g,m,c),bS(h,p,m,g,c),y=g);const v=l?Math.pow(2,-2*a):1/sA(y);for(let t=0,e=h*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(i>>a),y2:d+(o>>a)}}return s.x=function(e){return arguments.length?(t=gS(e),s):t},s.y=function(t){return arguments.length?(e=gS(t),s):e},s.weight=function(t){return arguments.length?(n=gS(t),s):n},s.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||$e("invalid size"),i=e,o=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||$e("invalid cell size"),a=Math.floor(Math.log(t)/Math.LN2),s):1<<a},s.bandwidth=function(t){return arguments.length?(1===(t=Nn(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&$e("invalid bandwidth"),r=t,s):r},s}function vS(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+a*t]),e>=i&&(e>=o&&(s-=n[e-o+a*t]),r[e-i+a*t]=s/Math.min(e+1,t-1+o-e,o))}function bS(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let s=0,l=0;s<e+i;++s)s<e&&(l+=n[a+s*t]),s>=i&&(s>=o&&(l-=n[a+(s-o)*t]),r[a+(s-i)*t]=l/Math.min(s+1,e-1+o-s,o))}function xS(t){su.call(this,null,t)}hS.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Qn(hS,su,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||Ve,o=lS().smooth(!1!==t.smooth),a=t.thresholds||function(t,e,n){const r=dS(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>fu(e(t).values))))}(r,i,t),s=null===t.as?null:t.as||"contour",l=[];return r.forEach((e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,sn(a)?a:a(n.values));!function(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;zn(i)&&(i=i(n,r));zn(o)&&(o=o(n,r));if((1===i||null==i)&&!o)return;const a=(nr(i)?i:i[0])||1,s=(nr(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;t.forEach(pS(e,a,s,l,u))}(r,n,e,t),r.forEach((t=>{l.push(Nl(e,Fl(null!=s?{[s]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),xS.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const _S=["x","y","weight","size","cellSize","bandwidth"];function wS(t,e){return _S.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function kS(t){su.call(this,null,t)}Qn(xS,su,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,o,a,s,l=[],u=t=>t(o);if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}(e.materialize(e.SOURCE).source,t.groupby),o=(t.groupby||[]).map(je),a=wS(yS(),t),s=t.as||"grid";return n=i.map((e=>Fl(function(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}({[s]:a(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),kS.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Qn(kS,su,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=lS().smooth(!1!==t.smooth),a=t.values,s=t.thresholds||dS(t.count||10,t.nice,!!a),l=t.size;return a||(a=e.materialize(e.SOURCE).source,r=pS(n=wS(yS(),t)(a,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],a=n.values),s=sn(s)?s:s(a),a=o.size(l)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(Fl),i}});const AS="Feature",ES="FeatureCollection";function MS(t){su.call(this,null,t)}function CS(t){su.call(this,null,t)}function SS(t){su.call(this,null,t)}function DS(t){su.call(this,null,t)}function FS(t){su.call(this,[],t),this.generator=oS()}function TS(t){su.call(this,null,t)}function NS(t){if(!zn(t))return!1;const e=vr(Ue(t));return e.$x||e.$y||e.$value||e.$max}function OS(t){su.call(this,null,t),this.modified(!0)}function zS(t,e,n){zn(t[e])&&t[e](n)}function RS(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,l,u,c,f,d,h=t._root,p={data:r},m=t._x0,g=t._y0,y=t._x1,v=t._y1;if(!h)return t._root=p,t;for(;h.length;)if((u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=h,!(h=h[f=c<<1|u]))return i[f]=p,t;if(s=+t._x.call(null,h.data),l=+t._y.call(null,h.data),e===s&&n===l)return p.next=h,i?i[f]=p:t._root=p,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((f=c<<1|u)===(d=(l>=a)<<1|s>=o));return i[d]=h,i[f]=p,t}function PS(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function BS(t){return t[0]}function LS(t){return t[1]}function jS(t,e,n){var r=new US(null==e?BS:e,null==n?LS:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function US(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function qS(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}MS.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Qn(MS,su,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,a=o&&o[0],s=o&&o[1],l=t.geojson||!o&&Ve,u=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(Ue(l))||a&&e.modified(Ue(a))||s&&e.modified(Ue(s)),this.value&&!n||(u=e.SOURCE,this._features=r=[],this._points=i=[]),l&&e.visit(u,(t=>r.push(l(t)))),a&&s&&(e.visit(u,(t=>{var e=a(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:AS,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:ES,features:r}}}),CS.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Qn(CS,su,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||Ve,o=t.as||"path",a=n.SOURCE;!r||t.modified()?(this.value=r=eS(t.projection),n.materialize().reflow()):a=i===Ve||e.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(t,e){const n=t.pointRadius();t.context(null),null!=e&&t.pointRadius(e);return n}(r,t.pointRadius);return n.visit(a,(t=>t[o]=r(i(t)))),r.pointRadius(s),n.modifies(o)}}),SS.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Qn(SS,su,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],a=t.as||["x","y"],s=a[0],l=a[1];function u(t){const e=r([i(t),o(t)]);e?(t[s]=e[0],t[l]=e[1]):(t[s]=void 0,t[l]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,u):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,u)),e.modifies(a)}}),DS.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Qn(DS,su,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>(t.context(e),r),r}(eS(t.projection),t.field||Ze("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(t=>t[i]=r)),n.modifies(i)}}),FS.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Qn(FS,su,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const o in t)zn(i[o])&&i[o](t[o]);return n=i(),r.length?e.mod.push(Ol(r[0],n)):e.add.push(Fl(n)),r[0]=n,e}}),TS.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Qn(TS,su,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||Ve,o=function(t,e){let n;zn(t)?(n=n=>t(n,e),n.dep=NS(t)):t?n=qn(t):(n=t=>t.$value/t.$max||0,n.dep=!0);return n}(t.opacity,t),a=function(t,e){let n;zn(t)?(n=n=>Gh(t(n,e)),n.dep=NS(t)):n=qn(Gh(t||"#888"));return n}(t.color,t),s=t.as||"image",l={$x:0,$y:0,$value:0,$max:r?fu(n.map((t=>fu(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=Wn({},t,l);r||(n.$max=fu(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,o=t.height,a=t.x1||0,s=t.y1||0,l=t.x2||i,u=t.y2||o,c=t.values,f=c?t=>c[t]:Ge,d=_h(l-a,u-s),h=d.getContext("2d"),p=h.getImageData(0,0,l-a,u-s),m=p.data;for(let g=s,y=0;g<u;++g){e.$y=g-s;for(let t=a,o=g*i;t<l;++t,y+=4){e.$x=t-a,e.$value=f(t+o);const i=n(e);m[y+0]=i.r,m[y+1]=i.g,m[y+2]=i.b,m[y+3]=~~(255*r(e))}}return h.putImageData(p,0,0),d}(e,n,a.dep?a:qn(a(n)),o.dep?o:qn(o(n)))})),e.reflow(!0).modifies(s)}}),Qn(OS,su,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=tS((t||"mercator").toLowerCase());e||$e("Unrecognized projection type: "+t);return e()}(t.type),KC.forEach((e=>{null!=t[e]&&zS(n,e,t[e])}))):KC.forEach((e=>{t.modified(e)&&zS(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return t=Nn(t),1===t.length?t[0]:{type:ES,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===ES?t.features:Nn(t).filter((t=>null!=t)).map((t=>t.type===AS?t:{type:AS,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var IS=jS.prototype=US.prototype;function WS(t){return function(){return t}}function $S(t){return 1e-6*(t()-.5)}function HS(t){return t.x+t.vx}function ZS(t){return t.y+t.vy}IS.copy=function(){var t,e,n=new US(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=qS(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=qS(e));return n},IS.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return RS(this.cover(e,n),e,n,t)},IS.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>f&&(f=i));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<o;++n)RS(this,a[n],s[n],t[n]);return this},IS.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,l=i-n||1,u=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},IS.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},IS.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},IS.find=function(t,e,n){var r,i,o,a,s,l,u,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new PS(m,c,f,d,h)),null==n?n=1/0:(c=t-n,f=e-n,d=t+n,h=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(o=l.y0)>h||(a=l.x1)<c||(s=l.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new PS(m[3],g,y,a,s),new PS(m[2],i,y,g,s),new PS(m[1],g,o,a,y),new PS(m[0],i,o,g,y)),(u=(e>=y)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var v=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=v*v+b*b;if(x<n){var _=Math.sqrt(n=x);c=t-_,f=e-_,d=t+_,h=e+_,r=m.data}}return r},IS.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,l,u,c,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((u=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(l=(m+y)/2))?m=l:y=l,e=h,!(h=h[f=c<<1|u]))return this;if(!h.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,d=f)}for(;h.data!==t;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(h=e[0]||e[1]||e[2]||e[3])&&h===(e[3]||e[2]||e[1]||e[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},IS.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},IS.root=function(){return this._root},IS.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},IS.visit=function(t){var e,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new PS(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&l.length){var u=(r+o)/2,c=(i+a)/2;(n=l[3])&&s.push(new PS(n,u,c,o,a)),(n=l[2])&&s.push(new PS(n,r,c,u,a)),(n=l[1])&&s.push(new PS(n,u,i,o,c)),(n=l[0])&&s.push(new PS(n,r,i,u,c))}return this},IS.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new PS(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(a+l)/2,f=(s+u)/2;(o=i[0])&&n.push(new PS(o,a,s,c,f)),(o=i[1])&&n.push(new PS(o,c,s,l,f)),(o=i[2])&&n.push(new PS(o,a,f,c,u)),(o=i[3])&&n.push(new PS(o,c,f,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},IS.x=function(t){return arguments.length?(this._x=t,this):this._x},IS.y=function(t){return arguments.length?(this._y=t,this):this._y};var YS={value:()=>{}};function VS(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new GS(r)}function GS(t){this._=t}function XS(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function QS(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=YS,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}GS.prototype=VS.prototype={constructor:GS,on:function(t,e){var n,r=this._,i=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=QS(r[n],t.name,e);else if(null==e)for(n in r)r[n]=QS(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=XS(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new GS(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const JS=VS;var KS,tD,eD=0,nD=0,rD=0,iD=1e3,oD=0,aD=0,sD=0,lD="object"===typeof performance&&performance.now?performance:Date,uD="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function cD(){return aD||(uD(fD),aD=lD.now()+sD)}function fD(){aD=0}function dD(){this._call=this._time=this._next=null}function hD(t,e,n){var r=new dD;return r.restart(t,e,n),r}function pD(){aD=(oD=lD.now())+sD,eD=nD=0;try{!function(){cD(),++eD;for(var t,e=KS;e;)(t=aD-e._time)>=0&&e._call.call(void 0,t),e=e._next;--eD}()}finally{eD=0,function(){var t,e,n=KS,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:KS=e);tD=t,gD(r)}(),aD=0}}function mD(){var t=lD.now(),e=t-oD;e>iD&&(sD-=e,oD=t)}function gD(t){eD||(nD&&(nD=clearTimeout(nD)),t-aD>24?(t<1/0&&(nD=setTimeout(pD,t-lD.now()-sD)),rD&&(rD=clearInterval(rD))):(rD||(oD=lD.now(),rD=setInterval(mD,iD)),eD=1,uD(pD)))}dD.prototype=hD.prototype={constructor:dD,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?cD():+n)+(null==e?0:+e),this._next||tD===this||(tD?tD._next=this:KS=this,tD=this),this._call=t,this._time=n,gD()},stop:function(){this._call&&(this._call=null,this._time=1/0,gD())}};const yD=1664525,vD=1013904223,bD=4294967296;function xD(t){return t.x}function _D(t){return t.y}var wD=10,kD=Math.PI*(3-Math.sqrt(5));function AD(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=hD(f),u=JS("tick","end"),c=function(){let t=1;return()=>(t=(yD*t+vD)%bD)/bD}();function f(){d(),u.call("tick",e),n<r&&(l.stop(),u.call("end",e))}function d(r){var l,u,c=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),l=0;l<c;++l)null==(u=t[l]).fx?u.x+=u.vx*=a:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=a:(u.y=u.fy,u.vy=0);return e}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=wD*Math.sqrt(.5+n),o=n*kD;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),h(),e={tick:d,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(c=t,s.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,l,u=0,c=t.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(a=(i=e-(s=t[u]).x)*i+(o=n-s.y)*o)<r&&(l=s,r=a);return l},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}function ED(t){return t.index}function MD(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const CD={center:function(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,l=0;for(i=0;i<a;++i)s+=(o=n[i]).x,l+=o.y;for(s=(s/a-t)*r,l=(l/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=l}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,o=1;function a(){for(var t,a,l,u,c,f,d,h=e.length,p=0;p<o;++p)for(a=jS(e,HS,ZS).visitAfter(s),t=0;t<h;++t)l=e[t],f=n[l.index],d=f*f,u=l.x+l.vx,c=l.y+l.vy,a.visit(m);function m(t,e,n,o,a){var s=t.data,h=t.r,p=f+h;if(!s)return e>u+p||o<u-p||n>c+p||a<c-p;if(s.index>l.index){var m=u-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=$S(r))*m),0===g&&(y+=(g=$S(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,l.vx+=(m*=y)*(p=(h*=h)/(d+h)),l.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!==typeof t&&(t=WS(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,l()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"===typeof e?e:WS(+e),l(),a):t},a},nbody:function(){var t,e,n,r,i,o=WS(-30),a=1,s=1/0,l=.81;function u(n){var i,o=t.length,a=jS(t,xD,_D).visitAfter(f);for(r=n,i=0;i<o;++i)e=t[i],a.visit(d)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function f(t){var e,n,r,o,a,s=0,l=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,l+=n,r+=n*e.x,o+=n*e.y);t.x=r/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,o,u,c){if(!t.value)return!0;var f=t.x-e.x,d=t.y-e.y,h=c-o,p=f*f+d*d;if(h*h/l<p)return p<s&&(0===f&&(p+=(f=$S(n))*f),0===d&&(p+=(d=$S(n))*d),p<a&&(p=Math.sqrt(a*p)),e.vx+=f*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===f&&(p+=(f=$S(n))*f),0===d&&(p+=(d=$S(n))*d),p<a&&(p=Math.sqrt(a*p)));do{t.data!==e&&(h=i[t.data.index]*r/p,e.vx+=f*h,e.vy+=d*h)}while(t=t.next)}}return u.initialize=function(e,r){t=e,n=r,c()},u.strength=function(t){return arguments.length?(o="function"===typeof t?t:WS(+t),c(),u):o},u.distanceMin=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u},link:function(t){var e,n,r,i,o,a,s=ED,l=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=WS(30),c=1;function f(r){for(var i=0,s=t.length;i<c;++i)for(var l,u,f,d,h,p,m,g=0;g<s;++g)u=(l=t[g]).source,d=(f=l.target).x+f.vx-u.x-u.vx||$S(a),h=f.y+f.vy-u.y-u.vy||$S(a),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*e[g],h*=p,f.vx-=d*(m=o[g]),f.vy-=h*m,u.vx+=d*(m=1-m),u.vy+=h*m}function d(){if(r){var a,l,u=r.length,c=t.length,f=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(a=0,i=new Array(u);a<c;++a)(l=t[a]).index=a,"object"!==typeof l.source&&(l.source=MD(f,l.source)),"object"!==typeof l.target&&(l.target=MD(f,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)l=t[a],o[a]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);e=new Array(c),h(),n=new Array(c),p()}}function h(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+l(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,a=e,d()},f.links=function(e){return arguments.length?(t=e,d(),f):t},f.id=function(t){return arguments.length?(s=t,f):s},f.iterations=function(t){return arguments.length?(c=+t,f):c},f.strength=function(t){return arguments.length?(l="function"===typeof t?t:WS(+t),h(),f):l},f.distance=function(t){return arguments.length?(u="function"===typeof t?t:WS(+t),p(),f):u},f},x:function(t){var e,n,r,i=WS(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!==typeof t&&(t=WS(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"===typeof t?t:WS(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"===typeof e?e:WS(+e),a(),o):t},o},y:function(t){var e,n,r,i=WS(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!==typeof t&&(t=WS(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"===typeof t?t:WS(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"===typeof e?e:WS(+e),a(),o):t},o}},SD="forces",DD=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],FD=["static","iterations"],TD=["x","y","vx","vy"];function ND(t){su.call(this,null,t)}function OD(t,e,n,r){var i,o,a,s,l=Nn(e.forces);for(i=0,o=DD.length;i<o;++i)(a=DD[i])!==SD&&e.modified(a)&&t[a](e[a]);for(i=0,o=l.length;i<o;++i)s=SD+i,(a=n||e.modified(SD,i)?RD(l[i]):r&&zD(l[i],r)?t.force(s):null)&&t.force(s,a);for(o=t.numForces||0;i<o;++i)t.force(SD+i,null);return t.numForces=l.length,t}function zD(t,e){var n,r;for(n in t)if(zn(r=t[n])&&e.modified(Ue(r)))return 1;return 0}function RD(t){var e,n;for(n in Yn(CD,t.force)||$e("Unrecognized force: "+t.force),e=CD[t.force](),t)zn(e[n])&&PD(e[n],t[n],t);return e}function PD(t,e,n){t(zn(e)?t=>e(t,n):e)}function BD(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function LD(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=UD)):void 0===e&&(e=jD);for(var n,r,i,o,a,s=new WD(t),l=[s];n=l.pop();)if((i=e(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)l.push(r=i[o]=new WD(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(ID)}function jD(t){return t.children}function UD(t){return Array.isArray(t)?t[1]:null}function qD(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function ID(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function WD(t){this.data=t,this.depth=this.height=0,this.parent=null}function $D(t){return null==t?null:HD(t)}function HD(t){if("function"!==typeof t)throw new Error;return t}function ZD(){return 0}function YD(t){return function(){return t}}ND.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:TD}]},Qn(ND,su,{transform(t,e){var n,r,i=this.value,o=e.changed(e.ADD_REM),a=t.modified(DD),s=t.iterations||300;if(i?(o&&(e.modifies("index"),i.nodes(e.source)),(a||e.changed(e.MOD))&&OD(i,t,0,e)):(this.value=i=function(t,e){const n=AD(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),OD(n,e,!0).on("end",(()=>o=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(o=!0,i.tick()),e.modifies("index")),a||o||t.modified(FD)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let s,l=this._argops,u=0,c=l.length;u<c;++u)if(s=l[u],s.name===SD&&"link"===s.op._argval.force)for(var r,i=s.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(TD)}}),WD.prototype=LD.prototype={constructor:WD,count:function(){return this.eachAfter(BD)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(e,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return LD(this).eachBefore(qD)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};const VD=1664525,GD=1013904223,XD=4294967296;function QD(t,e){for(var n,r,i=0,o=(t=function(t,e){let n,r,i=t.length;for(;i;)r=e()*i--|0,n=t[i],t[i]=t[r],t[r]=n;return t}(Array.from(t),e)).length,a=[];i<o;)n=t[i],r&&tF(r,n)?++i:(r=nF(a=JD(a,n)),i=0);return r}function JD(t,e){var n,r;if(eF(e,t))return[e];for(n=0;n<t.length;++n)if(KD(e,t[n])&&eF(rF(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(KD(rF(t[n],t[r]),e)&&KD(rF(t[n],e),t[r])&&KD(rF(t[r],e),t[n])&&eF(iF(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function KD(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function tF(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function eF(t,e){for(var n=0;n<e.length;++n)if(!tF(t,e[n]))return!1;return!0}function nF(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return rF(t[0],t[1]);case 3:return iF(t[0],t[1],t[2])}}function rF(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,l=o-n,u=a-r,c=s-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+s)/2}}function iF(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,l=e.r,u=n.x,c=n.y,f=n.r,d=r-a,h=r-u,p=i-s,m=i-c,g=l-o,y=f-o,v=r*r+i*i-o*o,b=v-a*a-s*s+l*l,x=v-u*u-c*c+f*f,_=h*p-d*m,w=(p*x-m*b)/(2*_)-r,k=(m*g-p*y)/_,A=(h*b-d*x)/(2*_)-i,E=(d*y-h*g)/_,M=k*k+E*E-1,C=2*(o+w*k+A*E),S=w*w+A*A-o*o,D=-(Math.abs(M)>1e-6?(C+Math.sqrt(C*C-4*M*S))/(2*M):S/C);return{x:r+w+k*D,y:i+A+E*D,r:D}}function oF(t,e,n){var r,i,o,a,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(i=e.r+n.r,i*=i,a=t.r+n.r,i>(a*=a)?(r=(u+a-i)/(2*u),o=Math.sqrt(Math.max(0,a/u-r*r)),n.x=t.x-r*s-o*l,n.y=t.y-r*l+o*s):(r=(u+i-a)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*s-o*l,n.y=e.y+r*l+o*s)):(n.x=e.x+n.r,n.y=e.y)}function aF(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function sF(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function lF(t){this._=t,this.next=null,this.previous=null}function uF(t,e){if(!(o=(t=function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,r,i,o,a,s,l,u,c,f,d;if((n=t[0]).x=0,n.y=0,!(o>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;oF(r,n,i=t[2]),n=new lF(n),r=new lF(r),i=new lF(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(l=3;l<o;++l){oF(n._,r._,i=t[l]),i=new lF(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(aF(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue t}f+=u._.r,u=u.next}else{if(aF(c._,i._)){(n=c).next=r,r.previous=n,--l;continue t}d+=c._.r,c=c.previous}}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=sF(n);(i=i.next)!==r;)(s=sF(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=QD(n,e),l=0;l<o;++l)(n=t[l]).x-=i.x,n.y-=i.y;return i.r}function cF(t){return Math.sqrt(t.value)}function fF(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function dF(t,e,n){return function(r){if(i=r.children){var i,o,a,s=i.length,l=t(r)*e||0;if(l)for(o=0;o<s;++o)i[o].r+=l;if(a=uF(i,n),l)for(o=0;o<s;++o)i[o].r-=l;r.r=a+l}}}function hF(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function pF(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function mF(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(r-e)/t.value;++s<l;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*u}var gF={depth:-1},yF={},vF={};function bF(t){return t.id}function xF(t){return t.parentId}function _F(){var t,e=bF,n=xF;function r(r){var i,o,a,s,l,u,c,f,d=Array.from(r),h=e,p=n,m=new Map;if(null!=t){const e=d.map(((e,n)=>function(t){t="".concat(t);let e=t.length;kF(t,e-1)&&!kF(t,e-2)&&(t=t.slice(0,-1));return"/"===t[0]?t:"/".concat(t)}(t(e,n,r)))),n=e.map(wF),i=new Set(e).add("");for(const t of n)i.has(t)||(i.add(t),e.push(t),n.push(wF(t)),d.push(vF));h=(t,n)=>e[n],p=(t,e)=>n[e]}for(a=0,i=d.length;a<i;++a)o=d[a],u=d[a]=new WD(o),null!=(c=h(o,a,r))&&(c+="")&&(f=u.id=c,m.set(f,m.has(f)?yF:u)),null!=(c=p(o,a,r))&&(c+="")&&(u.parent=c);for(a=0;a<i;++a)if(c=(u=d[a]).parent){if(!(l=m.get(c)))throw new Error("missing: "+c);if(l===yF)throw new Error("ambiguous: "+c);l.children?l.children.push(u):l.children=[u],u.parent=l}else{if(s)throw new Error("multiple roots");s=u}if(!s)throw new Error("no root");if(null!=t){for(;s.data===vF&&1===s.children.length;)s=s.children[0],--i;for(let t=d.length-1;t>=0&&(u=d[t]).data===vF;--t)u.data=null}if(s.parent=gF,s.eachBefore((function(t){t.depth=t.parent.depth+1,--i})).eachBefore(ID),s.parent=null,i>0)throw new Error("cycle");return s}return r.id=function(t){return arguments.length?(e=$D(t),r):e},r.parentId=function(t){return arguments.length?(n=$D(t),r):n},r.path=function(e){return arguments.length?(t=$D(e),r):t},r}function wF(t){let e=t.length;if(e<2)return"";for(;--e>1&&!kF(t,e););return t.slice(0,e)}function kF(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0===(1&n))return!0}return!1}function AF(t,e){return t.parent===e.parent?1:2}function EF(t){var e=t.children;return e?e[0]:t.t}function MF(t){var e=t.children;return e?e[e.length-1]:t.t}function CF(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function SF(t,e,n){return t.a.parent===e.parent?t.a:n}function DF(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function FF(t,e){return t.parent===e.parent?1:2}function TF(t,e){return t+e.x}function NF(t,e){return Math.max(t,e.y)}function OF(t,e,n,r,i){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(i-n)/t.value;++s<l;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*u}DF.prototype=Object.create(WD.prototype);var zF=(1+Math.sqrt(5))/2;function RF(t,e,n,r,i,o){for(var a,s,l,u,c,f,d,h,p,m,g,y=[],v=e.children,b=0,x=0,_=v.length,w=e.value;b<_;){l=i-n,u=o-r;do{c=v[x++].value}while(!c&&x<_);for(f=d=c,g=c*c*(m=Math.max(u/l,l/u)/(w*t)),p=Math.max(d/g,g/f);x<_;++x){if(c+=s=v[x].value,s<f&&(f=s),s>d&&(d=s),g=c*c*m,(h=Math.max(d/g,g/f))>p){c-=s;break}p=h}y.push(a={value:c,dice:l<u,children:v.slice(b,x)}),a.dice?mF(a,n,r,i,w?r+=u*c/w:o):OF(a,n,r,w?n+=l*c/w:i,o),w-=c,b=x}return y}const PF=function t(e){function n(t,n,r,i,o){RF(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(zF),BF=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,l,u,c,f=-1,d=a.length,h=t.value;++f<d;){for(l=(s=a[f]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?mF(s,n,r,i,h?r+=(o-r)*s.value/h:o):OF(s,n,r,h?n+=(i-n)*s.value/h:i,o),h-=s.value}else t._squarify=a=RF(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(zF);function LF(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function jF(t){su.call(this,null,t)}jF.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const UF=t=>t.values;function qF(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,o=t[r++],a={},s={};let l,u,c,f=-1;for(;++f<i;)l=o(u=e[f])+"",(c=a[l])?c.push(u):a[l]=[u];for(l in a)s[l]=n(a[l],r);return s}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function IF(t){su.call(this,null,t)}Qn(jF,su,{transform(t,e){e.source||$e("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each((t=>{t.children&&Cl(t.data)&&i.rem.push(t.data)})),this.value=o=LD({values:Nn(t.keys).reduce(((t,e)=>(t.key(e),t)),qF()).entries(i.source)},UF),n&&o.each((t=>{t.children&&(t=Fl(t.data),i.add.push(t),i.source.push(t))})),LF(o,Sl,Sl)),i.source.root=o,i}});const WF=(t,e)=>t.parent===e.parent?1:2;Qn(IF,su,{transform(t,e){e.source&&e.source.root||$e(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(zl(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?WF:Xe);try{this.value=n(i)}catch(a){$e(a)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}(t,r,o))),e.reflow(t.modified()).modifies(o).modifies("leaf")}});const $F=["x","y","r","depth","children"];function HF(t){IF.call(this,t)}HF.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:$F.length,default:$F}]},Qn(HF,IF,{layout:function(){var t=null,e=1,n=1,r=ZD;function i(i){const o=function(){let t=1;return()=>(t=(VD*t+GD)%XD)/XD}();return i.x=e/2,i.y=n/2,t?i.eachBefore(fF(t)).eachAfter(dF(r,.5,o)).eachBefore(hF(1)):i.eachBefore(fF(cF)).eachAfter(dF(ZD,1,o)).eachAfter(dF(r,i.r/Math.min(e,n),o)).eachBefore(hF(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=$D(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"===typeof t?t:YD(+t),i):r},i},params:["radius","size","padding"],fields:$F});const ZF=["x0","y0","x1","y1","depth","children"];function YF(t){IF.call(this,t)}function VF(t){su.call(this,null,t)}YF.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:ZF.length,default:ZF}]},Qn(YF,IF,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&mF(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(pF),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:ZF}),VF.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Qn(VF,su,{transform(t,e){e.source||$e("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?LF(_F().id(t.key).parentId(t.parentKey)(i.source),t.key,Qe):LF(_F()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const GF={tidy:function(){var t=AF,e=1,n=1,r=null;function i(i){var l=function(t){for(var e,n,r,i,o,a=new DF(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new DF(r[i],i)),n.parent=e;return(a.parent=new DF(null,0)).children=[a],a}(i);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),r)i.eachBefore(s);else{var u=i,c=i,f=i;i.eachBefore((function(t){t.x<u.x&&(u=t),t.x>c.x&&(c=t),t.depth>f.depth&&(f=t)}));var d=u===c?1:t(u,c)/2,h=d-u.x,p=e/(c.x+d+h),m=n/(f.depth||1);i.eachBefore((function(t){t.x=(t.x+h)*p,t.y=t.depth*m}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,l=o.parent.children[0],u=o.m,c=a.m,f=s.m,d=l.m;s=MF(s),o=EF(o),s&&o;)l=EF(l),(a=MF(a)).a=e,(i=s.z+f-o.z-u+t(s._,o._))>0&&(CF(SF(s,e,r),e,i),u+=i,c+=i),f+=s.m,u+=o.m,d+=l.m,c+=a.m;s&&!MF(a)&&(a.t=s,a.m+=f-c),o&&!EF(l)&&(l.t=o,l.m+=u-d,r=e)}return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=FF,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(TF,0)/t.length}(n),e.y=function(t){return 1+t.reduce(NF,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),l=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),u=s.x-t(s,l)/2,c=l.x+t(l,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-u)/(c-u)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},XF=["x","y","depth","children"];function QF(t){IF.call(this,t)}function JF(t){su.call(this,[],t)}QF.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:XF.length,default:XF}]},Qn(QF,IF,{layout(t){const e=t||"tidy";if(Yn(GF,e))return GF[e]();$e("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:XF}),JF.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Qn(JF,su,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||$e("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>o[Sl(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[Sl(e)]&&o[Sl(n)]&&i.add.push(Fl({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>o[Sl(t)]=1)),n.forEach((t=>{(o[Sl(t.source)]||o[Sl(t.target)])&&i.mod.push(t)}))),i}});const KF={binary:function(t,e,n,r,i){var o,a,s=t.children,l=s.length,u=new Array(l+1);for(u[0]=a=o=0;o<l;++o)u[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,l){if(e>=n-1){var c=s[e];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=l)}var f=u[e],d=r/2+f,h=e+1,p=n-1;for(;h<p;){var m=h+p>>>1;u[m]<d?h=m+1:p=m}d-u[h-1]<u[h]-d&&e+1<h&&--h;var g=u[h]-f,y=r-g;if(a-i>l-o){var v=r?(i*y+a*g)/r:a;t(e,h,g,i,o,v,l),t(h,n,y,v,o,a,l)}else{var b=r?(o*y+l*g)/r:l;t(e,h,g,i,o,a,b),t(h,n,y,i,b,a,l)}}(0,l,t.value,e,n,r,i)},dice:mF,slice:OF,slicedice:function(t,e,n,r,i){(1&t.depth?OF:mF)(t,e,n,r,i)},squarify:PF,resquarify:BF},tT=["x0","y0","x1","y1","depth","children"];function eT(t){IF.call(this,t)}eT.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:tT.length,default:tT}]},Qn(eT,IF,{layout(){const t=function(){var t=PF,e=!1,n=1,r=1,i=[0],o=ZD,a=ZD,s=ZD,l=ZD,u=ZD;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(f),i=[0],e&&t.eachBefore(pF),t}function f(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,f=e.x1-n,d=e.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),e.x0=r,e.y0=c,e.x1=f,e.y1=d,e.children&&(n=i[e.depth+1]=o(e)/2,r+=u(e)-n,c+=a(e)-n,(f-=s(e)-n)<r&&(r=f=(r+f)/2),(d-=l(e)-n)<c&&(c=d=(c+d)/2),t(e,r,c,f,d))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=HD(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(o="function"===typeof t?t:YD(+t),c):o},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(a="function"===typeof t?t:YD(+t),c):a},c.paddingRight=function(t){return arguments.length?(s="function"===typeof t?t:YD(+t),c):s},c.paddingBottom=function(t){return arguments.length?(l="function"===typeof t?t:YD(+t),c):l},c.paddingLeft=function(t){return arguments.length?(u="function"===typeof t?t:YD(+t),c):u},c}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{Yn(KF,e)?t.tile(KF[e]):$e("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:tT});const nT=4278190080;function rT(t,e,n){return new Uint32Array(t.getImageData(0,0,e,n).data.buffer)}function iT(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>iT(t,e.items,n)))})):Wx[r].draw(t,{items:n?e.map(oT):e})}function oT(t){const e=Nl(t,{});return e.stroke&&0!==e.strokeOpacity||e.fill&&0!==e.fillOpacity?{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}:e}const aT=5,sT=31,lT=32,uT=new Uint32Array(lT+1),cT=new Uint32Array(lT+1);cT[0]=0,uT[0]=~cT[0];for(let n=1;n<=lT;++n)cT[n]=cT[n-1]<<1|1,uT[n]=~cT[n];function fT(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),a=t=>~~((t+n)/r);return a.invert=t=>t*r-n,a.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+lT)/lT));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>aT]&1<<(i&sT)},set:(e,n)=>{const i=n*t+e;r(i>>>aT,1<<(i&sT))},clear:(e,n)=>{const r=n*t+e;i(r>>>aT,~(1<<(r&sT)))},getRange:(e,r,i,o)=>{let a,s,l,u,c=o;for(;c>=r;--c)if(a=c*t+e,s=c*t+i,l=a>>>aT,u=s>>>aT,l===u){if(n[l]&uT[a&sT]&cT[1+(s&sT)])return!0}else{if(n[l]&uT[a&sT])return!0;if(n[u]&cT[1+(s&sT)])return!0;for(let t=l+1;t<u;++t)if(n[t])return!0}return!1},setRange:(e,n,i,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+i,l=a>>>aT,u=s>>>aT,l===u)r(l,uT[a&sT]&cT[1+(s&sT)]);else for(r(l,uT[a&sT]),r(u,cT[1+(s&sT)]),c=l+1;c<u;++c)r(c,4294967295)},clearRange:(e,n,r,o)=>{let a,s,l,u,c;for(;n<=o;++n)if(a=n*t+e,s=n*t+r,l=a>>>aT,u=s>>>aT,l===u)i(l,cT[a&sT]|uT[1+(s&sT)]);else for(i(l,cT[a&sT]),i(u,uT[1+(s&sT)]),c=l+1;c<u;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=e||i>=t}}(i,o),a.ratio=r,a.padding=n,a.width=t,a.height=e,a}function dT(t,e,n,r,i,o){let a=n/2;return t-a<0||t+a>i||e-(a=r/2)<0||e+a>o}function hT(t,e,n,r,i,o,a,s){const l=i*o/(2*r),u=t(e-l),c=t(e+l),f=t(n-(o/=2)),d=t(n+o);return a.outOfBounds(u,f,c,d)||a.getRange(u,f,c,d)||s&&s.getRange(u,f,c,d)}const pT=[-1,-1,1,1],mT=[-1,1,-1,1];const gT=["right","center","left"],yT=["bottom","middle","top"];function vT(t,e,n,r,i,o,a,s,l,u,c,f){return!(i.outOfBounds(t,n,e,r)||(f&&o||i).getRange(t,n,e,r))}const bT={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},xT={naive:function(t,e,n,r){const i=t.width,o=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,a=t.datum.fontSize,s=kx.width(t.datum,t.datum.text);let l,u,c,f,d,h,p,m=0;for(let r=0;r<n;++r)l=e[r].x,c=e[r].y,u=void 0===e[r].x2?l:e[r].x2,f=void 0===e[r].y2?c:e[r].y2,d=(l+u)/2,h=(c+f)/2,p=Math.abs(u-l+f-c),p>=m&&(m=p,t.x=d,t.y=h);return d=s/2,h=a/2,l=t.x-d,u=t.x+d,c=t.y-h,f=t.y+h,t.align="center",l<0&&u<=i?t.align="left":0<=l&&i<u&&(t.align="right"),t.baseline="middle",c<0&&f<=o?t.baseline="top":0<=c&&o<f&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1];function l(e,n,r,l,u){const c=t.invert(e),f=t.invert(n);let d,h=r,p=o;if(!dT(c,f,l,u,i,o)&&!hT(t,c,f,u,l,h,a,s)&&!hT(t,c,f,u,l,u,a,null)){for(;p-h>=1;)d=(h+p)/2,hT(t,c,f,u,l,d,a,s)?p=d:h=d;if(h>r)return[c,f,h,!0]}}return function(e){const s=e.datum.datum.items[r].items,u=s.length,c=e.datum.fontSize,f=kx.width(e.datum,e.datum.text);let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C,S,D=n?c:0,F=!1,T=!1,N=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,h=void 0===s[r].x2?d:s[r].x2,m=void 0===s[r].y2?p:s[r].y2,d>h&&(S=d,d=h,h=S),p>m&&(S=p,p=m,m=S),x=t(d),w=t(h),_=~~((x+w)/2),k=t(p),E=t(m),A=~~((k+E)/2),v=_;v>=x;--v)for(b=A;b>=k;--b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);for(v=_;v<=w;++v)for(b=A;b<=E;++b)C=l(v,b,D,f,c),C&&([e.x,e.y,D,F]=C);F||n||(M=Math.abs(h-d+m-p),g=(d+h)/2,y=(p+m)/2,M>=N&&!dT(g,y,f,c,i,o)&&!hT(t,g,y,c,f,c,a,null)&&(N=M,e.x=g,e.y=y,T=!0))}return!(!F&&!T)&&(g=f/2,y=c/2,a.setRange(t(e.x-g),t(e.y-y),t(e.x+g),t(e.y+y)),e.align="center",e.baseline="middle",!0)}},floodfill:function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=t.bitmap();return function(e){const u=e.datum.datum.items[r].items,c=u.length,f=e.datum.fontSize,d=kx.width(e.datum,e.datum.text),h=[];let p,m,g,y,v,b,x,_,w,k,A,E,M=n?f:0,C=!1,S=!1,D=0;for(let r=0;r<c;++r){for(p=u[r].x,g=u[r].y,m=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?g:u[r].y2,h.push([t((p+m)/2),t((g+y)/2)]);h.length;)if([x,_]=h.pop(),!(a.get(x,_)||s.get(x,_)||l.get(x,_))){l.set(x,_);for(let t=0;t<4;++t)v=x+pT[t],b=_+mT[t],l.outOfBounds(v,b,v,b)||h.push([v,b]);if(v=t.invert(x),b=t.invert(_),w=M,k=o,!dT(v,b,d,f,i,o)&&!hT(t,v,b,f,d,w,a,s)&&!hT(t,v,b,f,d,f,a,null)){for(;k-w>=1;)A=(w+k)/2,hT(t,v,b,f,d,A,a,s)?k=A:w=A;w>M&&(e.x=v,e.y=b,M=w,C=!0)}}C||n||(E=Math.abs(m-p+y-g),v=(p+m)/2,b=(g+y)/2,E>=D&&!dT(v,b,d,f,i,o)&&!hT(t,v,b,f,d,f,a,null)&&(D=E,e.x=v,e.y=b,S=!0))}return!(!C&&!S)&&(v=d/2,b=f/2,a.setRange(t(e.x-v),t(e.y-b),t(e.x+v),t(e.y+b)),e.align="center",e.baseline="middle",!0)}}};function _T(t,e,n,r,i,o,a,s,l,u,c){if(!t.length)return t;const f=Math.max(r.length,i.length),d=function(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}(r,f),h=function(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=bT[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}(i,f),p=(x=t[0].datum)&&x.mark&&x.mark.marktype,m="group"===p&&t[0].datum.items[l].marktype,g="area"===m,y=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,m,s,l),v=null===u||u===1/0,b=g&&"naive"===c;var x;let _=-1,w=-1;const k=t.map((t=>{const e=v?kx.width(t,t.text):void 0;return _=Math.max(_,e),w=Math.max(w,t.fontSize),{datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t),textWidth:e}}));u=null===u||u===1/0?Math.max(_,w)+Math.max(...r):u;const A=fT(e[0],e[1],u);let E;if(!b){n&&k.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<h.length&&!e;++t)e=5===h[t]||d[t]<0;const r=(p&&a||g)&&t.map((t=>t.datum));E=o.length||r?function(t,e,n,r,i){const o=t.width,a=t.height,s=r||i,l=_h(o,a).getContext("2d"),u=_h(o,a).getContext("2d"),c=s&&_h(o,a).getContext("2d");n.forEach((t=>iT(l,t,!1))),iT(u,e,!1),s&&iT(c,e,!0);const f=rT(l,o,a),d=rT(u,o,a),h=s&&rT(c,o,a),p=t.bitmap(),m=s&&t.bitmap();let g,y,v,b,x,_,w,k;for(y=0;y<a;++y)for(g=0;g<o;++g)x=y*o+g,_=f[x]&nT,k=d[x]&nT,w=s&&h[x]&nT,(_||w||k)&&(v=t(g),b=t(y),i||!_&&!k||p.set(v,b),s&&(_||w)&&m.set(v,b));return[p,m]}(A,r||[],o,e,g):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(A,a&&k)}const M=g?xT[c](A,E,a,l):function(t,e,n,r){const i=t.width,o=t.height,a=e[0],s=e[1],l=r.length;return function(e){var u;const c=e.boundary,f=e.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d,h,p,m,g,y,v,b,x,_,w,k,A,E,M,C=null!==(u=e.textWidth)&&void 0!==u?u:0;for(let i=0;i<l;++i){if(d=(3&n[i])-1,h=(n[i]>>>2&3)-1,p=0===d&&0===h||r[i]<0,m=d&&h?Math.SQRT1_2:1,g=r[i]<0?-1:1,y=c[1+d]+r[i]*d*m,w=c[4+h]+g*f*h/2+r[i]*h*m,b=w-f/2,x=w+f/2,k=t(y),E=t(b),M=t(x),!C){if(!vT(k,k,E,M,a,s,0,0,0,0,0,p))continue;C=kx.width(e.datum,e.datum.text)}if(_=y+g*C*d/2,y=_-C/2,v=_+C/2,k=t(y),A=t(v),vT(k,A,E,M,a,s,0,0,0,0,0,p))return e.x=d?d*g<0?v:y:_,e.y=h?h*g<0?x:b:w,e.align=gT[d*g+1],e.baseline=yT[h*g+1],a.setRange(k,E,A,M),!0}return!1}}(A,E,h,d);return k.forEach((t=>t.opacity=+M(t))),k}const wT=["x","y","opacity","align","baseline"],kT=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function AT(t){su.call(this,null,t)}function ET(t,e){var n,r,i,o,a,s,l=[],u=function(t){return t(o)};if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(u)])||(n[a]=s=[],s.dims=a,l.push(s)),s.push(o);return l}function MT(t){su.call(this,null,t)}AT.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:kT},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:wT.length,default:wT}]},Qn(AT,su,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t[n];return zn(r)&&e.modified(r.fields)}("sort")))return;t.size&&2===t.size.length||$e("Size parameter should be specified as a [width, height] array.");const r=t.as||wT;return _T(e.materialize(e.SOURCE).source||[],t.size,t.sort,Nn(null==t.offset?1:t.offset),Nn(t.anchor||kT),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),MT.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Qn(MT,su,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=ET(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(je),o=i.length,a=t.as||[je(t.x),je(t.y)],s=[];r.forEach((e=>{dc(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let r=0;r<o;++r)n[i[r]]=e.dims[r];n[a[0]]=t[0],n[a[1]]=t[1],s.push(Fl(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const CT={constant:Ju,linear:rc,log:ic,exp:oc,pow:ac,quad:sc,poly:lc};function ST(t){su.call(this,null,t)}ST.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(CT)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Qn(ST,su,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=ET(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(je),o=t.method||"linear",a=null==t.order?3:t.order,s=((t,e)=>"poly"===t?e:"quad"===t?2:1)(o,a),l=t.as||[je(t.x),je(t.y)],u=CT[o],c=[];let f=t.extent;Yn(CT,o)||$e("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=s)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,t.x,t.y,a);if(t.params)return void c.push(Fl({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=f||$n(n,t.x),h=t=>{const e={};for(let r=0;r<i.length;++r)e[i[r]]=n.dims[r];e[l[0]]=t[0],e[l[1]]=t[1],c.push(Fl(e))};"linear"===o||"constant"===o?d.forEach((t=>h([t,r.predict(t)]))):gc(r.predict,d,25,200).forEach(h)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});const DT=134217729,FT=33306690738754706e-32;function TT(t,e,n,r,i){let o,a,s,l,u=e[0],c=r[0],f=0,d=0;c>u===c>-u?(o=u,u=e[++f]):(o=c,c=r[++d]);let h=0;if(f<t&&d<n)for(c>u===c>-u?(a=u+o,s=o-(a-u),u=e[++f]):(a=c+o,s=o-(a-c),c=r[++d]),o=a,0!==s&&(i[h++]=s);f<t&&d<n;)c>u===c>-u?(a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f]):(a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d]),o=a,0!==s&&(i[h++]=s);for(;f<t;)a=o+u,l=a-o,s=o-(a-l)+(u-l),u=e[++f],o=a,0!==s&&(i[h++]=s);for(;d<n;)a=o+c,l=a-o,s=o-(a-l)+(c-l),c=r[++d],o=a,0!==s&&(i[h++]=s);return 0===o&&0!==h||(i[h++]=o),h}function NT(t){return new Float64Array(t)}const OT=22204460492503146e-32,zT=11093356479670487e-47,RT=NT(4),PT=NT(8),BT=NT(12),LT=NT(16),jT=NT(4);function UT(t,e,n,r,i,o){const a=(e-o)*(n-i),s=(t-i)*(r-o),l=a-s,u=Math.abs(a+s);return Math.abs(l)>=33306690738754716e-32*u?l:-function(t,e,n,r,i,o,a){let s,l,u,c,f,d,h,p,m,g,y,v,b,x,_,w,k,A;const E=t-i,M=n-i,C=e-o,S=r-o;x=E*S,d=DT*E,h=d-(d-E),p=E-h,d=DT*S,m=d-(d-S),g=S-m,_=p*g-(x-h*m-p*m-h*g),w=C*M,d=DT*C,h=d-(d-C),p=C-h,d=DT*M,m=d-(d-M),g=M-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,RT[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,RT[1]=b-(y+f)+(f-w),A=v+y,f=A-v,RT[2]=v-(A-f)+(y-f),RT[3]=A;let D=function(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}(4,RT),F=OT*a;if(D>=F||-D>=F)return D;if(f=t-E,s=t-(E+f)+(f-i),f=n-M,u=n-(M+f)+(f-i),f=e-C,l=e-(C+f)+(f-o),f=r-S,c=r-(S+f)+(f-o),0===s&&0===l&&0===u&&0===c)return D;if(F=zT*a+FT*Math.abs(D),D+=E*c+S*s-(C*u+M*l),D>=F||-D>=F)return D;x=s*S,d=DT*s,h=d-(d-s),p=s-h,d=DT*S,m=d-(d-S),g=S-m,_=p*g-(x-h*m-p*m-h*g),w=l*M,d=DT*l,h=d-(d-l),p=l-h,d=DT*M,m=d-(d-M),g=M-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,jT[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,jT[1]=b-(y+f)+(f-w),A=v+y,f=A-v,jT[2]=v-(A-f)+(y-f),jT[3]=A;const T=TT(4,RT,4,jT,PT);x=E*c,d=DT*E,h=d-(d-E),p=E-h,d=DT*c,m=d-(d-c),g=c-m,_=p*g-(x-h*m-p*m-h*g),w=C*u,d=DT*C,h=d-(d-C),p=C-h,d=DT*u,m=d-(d-u),g=u-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,jT[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,jT[1]=b-(y+f)+(f-w),A=v+y,f=A-v,jT[2]=v-(A-f)+(y-f),jT[3]=A;const N=TT(T,PT,4,jT,BT);x=s*c,d=DT*s,h=d-(d-s),p=s-h,d=DT*c,m=d-(d-c),g=c-m,_=p*g-(x-h*m-p*m-h*g),w=l*u,d=DT*l,h=d-(d-l),p=l-h,d=DT*u,m=d-(d-u),g=u-m,k=p*g-(w-h*m-p*m-h*g),y=_-k,f=_-y,jT[0]=_-(y+f)+(f-k),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-w,f=b-y,jT[1]=b-(y+f)+(f-w),A=v+y,f=A-v,jT[2]=v-(A-f)+(y-f),jT[3]=A;const O=TT(N,BT,4,jT,LT);return LT[O-1]}(t,e,n,r,i,o,u)}NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(8),NT(8),NT(8),NT(4),NT(8),NT(8),NT(8),NT(12);NT(192),NT(192);NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(8),NT(8),NT(8),NT(8),NT(8),NT(8),NT(8),NT(8),NT(8),NT(4),NT(4),NT(4),NT(8),NT(16),NT(16),NT(16),NT(32),NT(32),NT(48),NT(64);NT(1152),NT(1152);NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(4),NT(24),NT(24),NT(24),NT(24),NT(24),NT(24),NT(24),NT(24),NT(24),NT(24),NT(1152),NT(1152),NT(1152),NT(1152),NT(1152),NT(2304),NT(2304),NT(3456),NT(5760),NT(8),NT(8),NT(8),NT(16),NT(24),NT(48),NT(48),NT(96),NT(192),NT(384),NT(384),NT(384),NT(768);NT(96),NT(96),NT(96),NT(1152);const qT=Math.pow(2,-52),IT=new Uint32Array(512);class WT{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:XT;const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new WT(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let a=1/0,s=1/0,l=-1/0,u=-1/0;for(let A=0;A<o;A++){const e=t[2*A],n=t[2*A+1];e<a&&(a=e),n<s&&(s=n),e>l&&(l=e),n>u&&(u=n),this._ids[A]=A}const c=(a+l)/2,f=(s+u)/2;let d,h,p;for(let A=0,E=1/0;A<o;A++){const e=$T(c,f,t[2*A],t[2*A+1]);e<E&&(d=A,E=e)}const m=t[2*d],g=t[2*d+1];for(let A=0,E=1/0;A<o;A++){if(A===d)continue;const e=$T(m,g,t[2*A],t[2*A+1]);e<E&&e>0&&(h=A,E=e)}let y=t[2*h],v=t[2*h+1],b=1/0;for(let A=0;A<o;A++){if(A===d||A===h)continue;const e=ZT(m,g,y,v,t[2*A],t[2*A+1]);e<b&&(p=A,b=e)}let x=t[2*p],_=t[2*p+1];if(b===1/0){for(let r=0;r<o;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];YT(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t],o=this._dists[i];o>r&&(e[n++]=i,r=o)}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(UT(m,g,y,v,x,_)<0){const t=h,e=y,n=v;h=p,y=x,v=_,p=t,x=e,_=n}const w=function(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=t+(u*c-s*f)*d,p=e+(a*f-l*c)*d;return{x:h,y:p}}(m,g,y,v,x,_);this._cx=w.x,this._cy=w.y;for(let A=0;A<o;A++)this._dists[A]=$T(t[2*A],t[2*A+1],w.x,w.y);YT(this._ids,this._dists,0,o-1),this._hullStart=d;let k=3;n[d]=e[p]=h,n[h]=e[d]=p,n[p]=e[h]=d,r[d]=0,r[h]=1,r[p]=2,i.fill(-1),i[this._hashKey(m,g)]=d,i[this._hashKey(y,v)]=h,i[this._hashKey(x,_)]=p,this.trianglesLen=0,this._addTriangle(d,h,p,-1,-1,-1);for(let A,E,M=0;M<this._ids.length;M++){const o=this._ids[M],a=t[2*o],s=t[2*o+1];if(M>0&&Math.abs(a-A)<=qT&&Math.abs(s-E)<=qT)continue;if(A=a,E=s,o===d||o===h||o===p)continue;let l=0;for(let t=0,e=this._hashKey(a,s);t<this._hashSize&&(l=i[(e+t)%this._hashSize],-1===l||l===n[l]);t++);l=e[l];let u,c=l;for(;u=n[c],UT(a,s,t[2*c],t[2*c+1],t[2*u],t[2*u+1])>=0;)if(c=u,c===l){c=-1;break}if(-1===c)continue;let f=this._addTriangle(c,o,n[c],-1,-1,r[c]);r[o]=this._legalize(f+2),r[c]=f,k++;let m=n[c];for(;u=n[m],UT(a,s,t[2*m],t[2*m+1],t[2*u],t[2*u+1])<0;)f=this._addTriangle(m,o,u,r[o],-1,r[m]),r[o]=this._legalize(f+2),n[m]=m,k--,m=u;if(c===l)for(;u=e[c],UT(a,s,t[2*u],t[2*u+1],t[2*c],t[2*c+1])<0;)f=this._addTriangle(u,o,c,-1,r[c],r[u]),this._legalize(f+2),r[u]=f,n[c]=c,k--,c=u;this._hullStart=e[o]=c,n[c]=e[m]=o,n[o]=m,i[this._hashKey(a,s)]=o,i[this._hashKey(t[2*c],t[2*c+1])]=c}this.hull=new Uint32Array(k);for(let A=0,E=this._hullStart;A<k;A++)this.hull[A]=E,E=n[E];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[t],s=t-t%3;if(o=s+(t+2)%3,-1===a){if(0===i)break;t=IT[--i];continue}const l=a-a%3,u=s+(t+1)%3,c=l+(a+2)%3,f=e[o],d=e[t],h=e[u],p=e[c];if(HT(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){e[t]=p,e[a]=f;const r=n[c];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(a,n[o]),this._link(o,c);const s=l+(a+1)%3;i<IT.length&&(IT[i++]=s)}else{if(0===i)break;t=IT[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function $T(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function HT(t,e,n,r,i,o,a,s){const l=t-a,u=e-s,c=n-a,f=r-s,d=i-a,h=o-s,p=c*c+f*f,m=d*d+h*h;return l*(f*m-p*h)-u*(c*m-p*d)+(l*l+u*u)*(c*h-f*d)<0}function ZT(t,e,n,r,i,o){const a=n-t,s=r-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,d=.5/(a*u-s*l),h=(u*c-s*f)*d,p=(a*f-l*c)*d;return h*h+p*p}function YT(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=n&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=n+1,o=r;VT(t,n+r>>1,i),e[t[n]]>e[t[r]]&&VT(t,n,r),e[t[i]]>e[t[r]]&&VT(t,i,r),e[t[n]]>e[t[i]]&&VT(t,n,i);const a=t[i],s=e[a];for(;;){do{i++}while(e[t[i]]<s);do{o--}while(e[t[o]]>s);if(o<i)break;VT(t,i,o)}t[n+1]=t[o],t[o]=a,r-i+1>=o-n?(YT(t,e,i,r),YT(t,e,n,o-1)):(YT(t,e,n,o-1),YT(t,e,i,r))}}function VT(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function GT(t){return t[0]}function XT(t){return t[1]}const QT=1e-6;class JT{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>QT||Math.abs(this._y1-i)>QT)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}rect(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class KT{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class tN{constructor(t){let[e,n,r,i]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(e=+e))||!((i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this;let i,o;const a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,y=0,v=n.length;g<v;g+=3,y+=2){const r=2*n[g],s=2*n[g+1],l=2*n[g+2],u=t[r],c=t[r+1],f=t[s],d=t[s+1],h=t[l],v=t[l+1],b=f-u,x=d-c,_=h-u,w=v-c,k=2*(b*w-x*_);if(Math.abs(k)<1e-9){if(void 0===i){i=o=0;for(const n of e)i+=t[2*n],o+=t[2*n+1];i/=e.length,o/=e.length}const n=1e9*Math.sign((i-u)*w-(o-c)*_);p=(u+h)/2-n*w,m=(c+v)/2+n*_}else{const t=1/k,e=b*b+x*x,n=_*_+w*w;p=u+(w*e-x*n)*t,m=c+(b*n-_*e)*t}a[y]=p,a[y+1]=m}let s,l,u,c=e[e.length-1],f=4*c,d=t[2*c],h=t[2*c+1];r.fill(0);for(let p=0;p<e.length;++p)c=e[p],s=f,l=d,u=h,f=4*c,d=t[2*c],h=t[2*c+1],r[s+2]=r[f]=u-h,r[s+3]=r[f+1]=d-l}render(t){const e=null==t?t=new JT:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let u=0,c=n.length;u<c;++u){const e=n[u];if(e<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(e/3),a=o[r],s=o[r+1],l=o[i],c=o[i+1];this._renderSegment(a,s,l,c,t)}let s,l=i[i.length-1];for(let u=0;u<i.length;++u){s=l,l=i[u];const e=2*Math.floor(r[l]/3),n=o[e],c=o[e+1],f=4*s,d=this._project(n,c,a[f+2],a[f+3]);d&&this._renderSegment(n,c,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new JT:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new JT:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||e.lineTo(r[o],r[o+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new KT;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const a=this._regioncode(t,e),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)===e&&(n=+n)===n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,a=t.length;o<a;o+=2)if(e[r]===t[o]&&e[r+1]===t[o+1]&&e[(r+2)%i]===t[(o+a-2)%a]&&e[(r+3)%i]===t[(o+a-1)%a]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(e[2*n],e[2*n+1]),s=s%3===2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return this._simplify(n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e))}_clipFinite(t,e){const n=e.length;let r,i,o,a,s=null,l=e[n-2],u=e[n-1],c=this._regioncode(l,u),f=0;for(let d=0;d<n;d+=2)if(r=l,i=u,l=e[d],u=e[d+1],o=c,c=this._regioncode(l,u),0===o&&0===c)a=f,f=0,s?s.push(l,u):s=[l,u];else{let e,n,d,h,p;if(0===o){if(null===(e=this._clipSegment(r,i,l,u,o,c)))continue;[n,d,h,p]=e}else{if(null===(e=this._clipSegment(l,u,r,i,c,o)))continue;[h,p,n,d]=e,a=f,f=this._edgecode(n,d),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(n,d):s=[n,d]}a=f,f=this._edgecode(h,p),a&&f&&this._edge(t,a,f,s,s.length),s?s.push(h,p):s=[h,p]}if(s)a=f,f=this._edgecode(s[0],s[1]),a&&f&&this._edge(t,a,f,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,e,n,r,i,o){const a=i<o;for(a&&([t,e,n,r,i,o]=[n,r,t,e,o,i]);;){if(0===i&&0===o)return a?[n,r,t,e]:[t,e,n,r];if(i&o)return null;let s,l,u=i||o;8&u?(s=t+(n-t)*(this.ymax-e)/(r-e),l=this.ymax):4&u?(s=t+(n-t)*(this.ymin-e)/(r-e),l=this.ymin):2&u?(l=e+(r-e)*(this.xmax-t)/(n-t),s=this.xmax):(l=e+(r-e)*(this.xmin-t)/(n-t),s=this.xmin),i?(t=s,e=l,i=this._regioncode(t,e)):(n=s,r=l,o=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,o){let a,s=Array.from(e);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(t,s))for(let l,u=0,c=s.length,f=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)l=f,f=this._edgecode(s[u],s[u+1]),l&&f&&(u=this._edge(t,l,f,s,u),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}return i}_project(t,e,n,r){let i,o,a,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(a=this.ymin,o=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(a=this.ymax,o=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(o=this.xmax,a=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(o=this.xmin,a=e+(s=i)*r)}return[o,a]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const n=(e+2)%t.length,r=(e+4)%t.length;(t[e]===t[n]&&t[n]===t[r]||t[e+1]===t[n+1]&&t[n+1]===t[r+1])&&(t.splice(n,2),e-=2)}t.length||(t=null)}return t}}const eN=2*Math.PI,nN=Math.pow;function rN(t){return t[0]}function iN(t){return t[1]}function oN(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class aN{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rN,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iN,r=arguments.length>3?arguments[3]:void 0;return new aN("length"in t?function(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=t[a];o[2*a]=e.call(r,i,a,t),o[2*a+1]=n.call(r,i,a,t)}return o}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new WT(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],o=2*e[r+2];if((n[o]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[o+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,a=e.length/2;o<a;++o){const t=oN(e[2*o],e[2*o+1],i);e[2*o]=t[0],e[2*o+1]=t[1]}this._delaunator=new WT(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,l=n.length;s<l;++s){const t=i[s%3===2?s-2:s+1];-1!==n[s]&&-1!==o[t]||(o[t]=s)}for(let s=0,l=r.length;s<l;++s)a[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new tN(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const e=a.indexOf(t);return e>0&&(yield a[e-1]),void(e<a.length-1&&(yield a[e+1]))}const s=e[t];if(-1===s)return;let l=s,u=-1;do{if(yield u=o[l],l=l%3===2?l-2:l+1,o[l]!==t)return;if(l=i[l],-1===l){const e=n[(r[t]+1)%n.length];return void(e!==u&&(yield e))}}while(l!==s)}find(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!==t||(e=+e)!==e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:l}=this;if(-1===r[t]||!l.length)return(t+1)%(l.length>>1);let u=t,c=nN(e-l[2*t],2)+nN(n-l[2*t+1],2);const f=r[t];let d=f;do{let r=s[d];const f=nN(e-l[2*r],2)+nN(n-l[2*r+1],2);if(f<c&&(c=f,u=r),d=d%3===2?d-2:d+1,s[d]!==t)break;if(d=a[d],-1===d){if(d=i[(o[t]+1)%i.length],d!==r&&nN(e-l[2*d],2)+nN(n-l[2*d+1],2)<c)return d;break}}while(d!==f);return u}render(t){const e=null==t?t=new JT:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,a=r.length;o<a;++o){const e=r[o];if(e<o)continue;const a=2*i[o],s=2*i[e];t.moveTo(n[a],n[a+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"===typeof t.moveTo||(e=t,t=null),e=void 0==e?2:+e;const n=null==t?t=new JT:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];t.moveTo(n+e,o),t.arc(n,o,e,0,eN)}return n&&n.value()}renderHull(t){const e=null==t?t=new JT:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let a=1;a<o;++a){const e=2*n[a];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new KT;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new JT:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],a=2*i[t+1],s=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[a],r[a+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new KT;return this.renderTriangle(t,e),e.value()}}function sN(t){su.call(this,null,t)}sN.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const lN=[-1e5,-1e5,1e5,1e5];function uN(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}Qn(sN,su,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:lN;const o=this.value=aN.from(r,t.x,t.y).voronoi(i);for(let s=0,l=r.length;s<l;++s){const t=o.cellPolygon(s);r[s][n]=t&&(2!==(a=t).length||a[0][0]!==a[1][0]||a[0][1]!==a[1][1])?uN(t):null}var a;return e.reflow(t.modified()).modifies(n)}});var cN=Math.PI/180,fN=64,dN=2048;function hN(){var t,e,n,r,i,o,a,s=[256,256],l=vN,u=[],c=Math.random,f={};function d(t,e,n){for(var r,i,o,a=e.x,u=e.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=l(s),h=c()<.5?1:-1,p=-h;(r=d(p+=h))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(e.x=a+i,e.y=u+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1])&&(!n||!mN(e,t,s[0]))&&(!n||yN(e,n))){for(var m,g=e.sprite,y=e.width>>5,v=s[0]>>5,b=e.x-(y<<4),x=127&b,_=32-x,w=e.y1-e.y0,k=(e.y+e.y0)*v+(b>>5),A=0;A<w;A++){m=0;for(var E=0;E<=y;E++)t[k+E]|=m<<_|(E<y?(m=g[A*y+E])>>>x:0);k+=v}return e.sprite=null,!0}return!1}return f.layout=function(){for(var l=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(fN<<5)/e,t.height=dN/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(_h()),f=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),h=null,p=u.length,m=-1,g=[],y=u.map((s=>({text:t(s),font:e(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((t,e)=>e.size-t.size));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,pN(l,v,y,m),v.hasText&&d(f,v,h)&&(g.push(v),h?gN(h,v):h=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},f.words=function(t){return arguments.length?(u=t,f):u},f.size=function(t){return arguments.length?(s=[+t[0],+t[1]],f):s},f.font=function(t){return arguments.length?(e=bN(t),f):e},f.fontStyle=function(t){return arguments.length?(r=bN(t),f):r},f.fontWeight=function(t){return arguments.length?(i=bN(t),f):i},f.rotate=function(t){return arguments.length?(o=bN(t),f):o},f.text=function(e){return arguments.length?(t=bN(e),f):t},f.spiral=function(t){return arguments.length?(l=xN[t]||t,f):l},f.fontSize=function(t){return arguments.length?(n=bN(t),f):n},f.padding=function(t){return arguments.length?(a=bN(t),f):a},f.random=function(t){return arguments.length?(c=t,f):c},f}function pN(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,(fN<<5)/o,dN/o);var a,s,l,u,c,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,a=i.measureText(e.text+"m").width*o,l=e.size<<1,e.rotate){var m=Math.sin(e.rotate*cN),g=Math.cos(e.rotate*cN),y=a*g,v=a*m,b=l*g,x=l*m;a=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,l=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(l>h&&(h=l),f+a>=fN<<5&&(f=0,d+=h,h=0),d+l>=dN)break;i.translate((f+(a>>1))/o,(d+(l>>1))/o),e.rotate&&i.rotate(e.rotate*cN),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=a,e.height=l,e.xoff=f,e.yoff=d,e.x1=a>>1,e.y1=l>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=a}for(var _=i.getImageData(0,0,(fN<<5)/o,dN/o).data,w=[];--r>=0;)if((e=n[r]).hasText){for(s=(a=e.width)>>5,l=e.y1-e.y0,u=0;u<l*s;u++)w[u]=0;if(null==(f=e.xoff))return;d=e.yoff;var k=0,A=-1;for(c=0;c<l;c++){for(u=0;u<a;u++){var E=s*c+(u>>5),M=_[(d+c)*(fN<<5)+(f+u)<<2]?1<<31-u%32:0;w[E]|=M,k|=M}k?A=c:(e.y0++,l--,c--,d++)}e.y1=e.y0+A,e.sprite=w.slice(0,(e.y1-e.y0)*s)}}}function mN(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,a=t.x-(o<<4),s=127&a,l=32-s,u=t.y1-t.y0,c=(t.y+t.y0)*n+(a>>5),f=0;f<u;f++){r=0;for(var d=0;d<=o;d++)if((r<<l|(d<o?(r=i[f*o+d])>>>s:0))&e[c+d])return!0;c+=n}return!1}function gN(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function yN(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function vN(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function bN(t){return"function"===typeof t?t:function(){return t}}var xN={archimedean:vN,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const _N=["x","y","font","fontSize","fontStyle","fontWeight","angle"],wN=["text","font","rotate","fontSize","fontStyle","fontWeight"];function kN(t){su.call(this,hN(),t)}kN.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:_N}]},Qn(kN,su,{transform(t,e){!t.size||t.size[0]&&t.size[1]||$e("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||wN.some((function(n){const r=t[n];return zn(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,o=t.as||_N;let a,s=t.fontSize||14;if(zn(s)?a=t.fontSizeRange:s=qn(s),a){const t=s,e=iy("sqrt")().domain($n(r,t)).range(a);s=n=>e(t(n))}r.forEach((t=>{t[o[0]]=NaN,t[o[1]]=NaN,t[o[3]]=0}));const l=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random(Mu).layout(),u=i.size(),c=u[0]>>1,f=u[1]>>1,d=l.length;for(let h,p,m=0;m<d;++m)h=l[m],p=h.datum,p[o[0]]=h.x+c,p[o[1]]=h.y+f,p[o[2]]=h.font,p[o[3]]=h.size,p[o[4]]=h.style,p[o[5]]=h.weight,p[o[6]]=h.rotate;return e.reflow(n).modifies(o)}});const AN=t=>new Uint8Array(t),EN=t=>new Uint16Array(t),MN=t=>new Uint32Array(t);function CN(t,e,n){const r=(e<257?AN:e<65537?EN:MN)(t);return n&&r.set(n),r}function SN(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),o=t.index,a=i[0],s=i[1],l=o.length;let u;for(u=0;u<a;++u)e[o[u]]|=r;for(u=s;u<l;++u)e[o[u]]|=r;return n}}}function DN(){let t=MN(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const a=n,s=i.length,l=MN(s);let u,c,f,d=Array(s);for(f=0;f<s;++f)d[f]=r(i[f]),l[f]=f;if(d=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),function(t,e){return Array.from(e,(e=>t[e]))}(t,e)}(d,l),a)u=e,c=t,e=Array(a+s),t=MN(a+s),function(t,e,n,r,i,o,a,s,l){let u,c=0,f=0;for(u=0;c<r&&f<a;++u)e[c]<i[f]?(s[u]=e[c],l[u]=n[c++]):(s[u]=i[f],l[u]=o[f++]+t);for(;c<r;++c,++u)s[u]=e[c],l[u]=n[c];for(;f<a;++f,++u)s[u]=i[f],l[u]=o[f]+t}(o,u,c,a,d,l,s,e,t);else{if(o>0)for(f=0;f<s;++f)l[f]+=o;e=d,t=l}return n=a+s,{index:l,value:d}},remove:function(r,i){const o=n;let a,s,l;for(s=0;!i[t[s]]&&s<o;++s);for(l=s;s<o;++s)i[a=t[s]]||(t[l]=a,e[l]=e[s],++l);n=o-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[Eh(r,t[0],0,i),Ah(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function FN(t){su.call(this,function(){let t=8,e=[],n=MN(0),r=CN(0,t),i=CN(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const o=e.length,a=Array(o-t),s=e;let l,u,c;for(u=0;!n[u]&&u<o;++u)a[u]=e[u],s[u]=u;for(c=u;u<o;++u)l=e[u],n[u]?s[u]=-1:(s[u]=c,r[c]=r[u],i[c]=i[u],a[c]=l,l._index=c++),r[u]=0;return e=a,s},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=CN(e,t,r),i=CN(e,t))}}}(),t),this._indices=null,this._dims=null}function TN(t){su.call(this,null,t)}FN.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Qn(FN,su,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},o=this._dims=[],a=r.length;let s,l,u=0;for(;u<a;++u)s=n[u].fname,l=i[s]||(i[s]=DN()),o.push(SN(l,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,o=this._indices,a=this._dims,s=this.value,l=s.curr(),u=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,g,y,v,b,x,_,w,k;if(u.set(l),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&s.add(e.add),e.mod.length)for(x={},v=e.mod,_=0,w=v.length;_<w;++_)x[v[_]._index]=1;for(_=0;_<h;++_)k=r[_],(!a[_]||t.modified("fields",_)||e.modified(k.fields))&&(y=k.fname,(m=p[y])||(o[y]=g=DN(),p[y]=m=g.insert(k,e.source,0)),a[_]=SN(g,_,i[_]).onAdd(m,l));for(_=0,w=s.data().length;_<w;++_)b[_]||(u[_]!==l[_]?f.push(_):x[_]&&l[_]!==c&&d.push(_));return s.mask=(1<<h)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,o=this._dims,a=this._indices,s=t.fields,l={},u=n.add,c=i.size()+r.length,f=o.length;let d,h,p,m=i.size();i.resize(c,f),i.add(r);const g=i.curr(),y=i.prev(),v=i.all();for(d=0;d<f;++d)h=s[d].fname,p=l[h]||(l[h]=a[h].insert(s[d],r,m)),o[d].onAdd(p,g);for(;m<c;++m)y[m]=v,g[m]!==v&&u.push(m)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),o=r.all(),a=t.mod;let s,l,u;for(s=0,l=a.length;s<l;++s)u=a[s]._index,i[u]!==o&&n.push(u)},remove(t,e,n){const r=this._indices,i=this.value,o=i.curr(),a=i.prev(),s=i.all(),l={},u=n.rem,c=e.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,a[h]=p=o[h],o[h]=s,p!==s&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(e,d,l),l},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,o=e.stamp,a=r.length;let s,l,u=0;for(n.filters=0,l=0;l<a;++l)t.modified("query",l)&&(s=l,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(l=0,u=0;l<a;++l)t.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,o=i.seen(),a=i.curr(),s=i.prev(),l=t.index(),u=t.bisect(t.range),c=t.bisect(e),f=c[0],d=c[1],h=u[0],p=u[1],m=t.one;let g,y,v;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)v=l[g],o[v]!==n&&(s[v]=a[v],o[v]=n,r.push(v)),a[v]^=m;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),o=t.index(),a=t.bisect(t.range),s=t.bisect(e),l=s[0],u=s[1],c=a[0],f=a[1],d=t.one;let h,p,m;if(l<c)for(h=l,p=Math.min(c,u);h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(l>c)for(h=c,p=Math.min(l,f);h<p;++h)m=o[h],i[m]^=d,r.push(m);if(u>f)for(h=Math.max(l,f),p=u;h<p;++h)m=o[h],i[m]^=d,n.push(m);else if(u<f)for(h=Math.max(c,u),p=f;h<p;++h)m=o[h],i[m]^=d,r.push(m);t.range=e.slice()}}),TN.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Qn(TN,su,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0===(i&n))return e.StopPropagation;const o=e.fork(e.ALL),a=r.data(),s=r.curr(),l=r.prev(),u=t=>s[t]&n?null:a[t];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,(t=>{const e=s[t]&n;return!e&&e^l[t]&n?a[t]:null})),o.filter(o.REM,(t=>{const e=s[t]&n;return e&&!(e^e^l[t]&n)?a[t]:null}))):(o.filter(o.ADD,u),o.filter(o.REM,(t=>(s[t]&n)===i?a[t]:null))),o.filter(o.SOURCE,(t=>u(t._index)))}});const NN="Literal",ON="Property",zN="ArrayExpression",RN="BinaryExpression",PN="CallExpression",BN="ConditionalExpression",LN="LogicalExpression",jN="MemberExpression",UN="ObjectExpression",qN="UnaryExpression";function IN(t){this.type=t}var WN,$N,HN,ZN,YN;IN.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case zN:return t.elements;case RN:case LN:return[t.left,t.right];case PN:return[t.callee].concat(t.arguments);case BN:return[t.test,t.consequent,t.alternate];case jN:return[t.object,t.property];case UN:return t.properties;case ON:return[t.key,t.value];case qN:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var VN=1,GN=2,XN=3,QN=4,JN=5,KN=6,tO=7,eO=8;(WN={})[VN]="Boolean",WN[GN]="<end>",WN[XN]="Identifier",WN[QN]="Keyword",WN[JN]="Null",WN[KN]="Numeric",WN[tO]="Punctuator",WN[eO]="String",WN[9]="RegularExpression";var nO="ArrayExpression",rO="BinaryExpression",iO="CallExpression",oO="ConditionalExpression",aO="Identifier",sO="Literal",lO="LogicalExpression",uO="MemberExpression",cO="ObjectExpression",fO="Property",dO="UnaryExpression",hO="Unexpected token %0",pO="Unexpected number",mO="Unexpected string",gO="Unexpected identifier",yO="Unexpected reserved word",vO="Unexpected end of input",bO="Invalid regular expression",xO="Invalid regular expression: missing /",_O="Octal literals are not allowed in strict mode.",wO="Duplicate data property in object literal not allowed in strict mode",kO="ILLEGAL",AO="Disabled.",EO=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),MO=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function CO(t,e){if(!t)throw new Error("ASSERT: "+e)}function SO(t){return t>=48&&t<=57}function DO(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function FO(t){return"01234567".indexOf(t)>=0}function TO(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function NO(t){return 10===t||13===t||8232===t||8233===t}function OO(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&EO.test(String.fromCharCode(t))}function zO(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&MO.test(String.fromCharCode(t))}const RO={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function PO(){for(;HN<ZN;){const t=$N.charCodeAt(HN);if(!TO(t)&&!NO(t))break;++HN}}function BO(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)HN<ZN&&DO($N[HN])?(r=$N[HN++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):KO({},hO,kO);return String.fromCharCode(i)}function LO(){var t,e,n,r;for(e=0,"}"===(t=$N[HN])&&KO({},hO,kO);HN<ZN&&DO(t=$N[HN++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&KO({},hO,kO),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function jO(){var t,e;for(t=$N.charCodeAt(HN++),e=String.fromCharCode(t),92===t&&(117!==$N.charCodeAt(HN)&&KO({},hO,kO),++HN,(t=BO("u"))&&"\\"!==t&&OO(t.charCodeAt(0))||KO({},hO,kO),e=t);HN<ZN&&zO(t=$N.charCodeAt(HN));)++HN,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==$N.charCodeAt(HN)&&KO({},hO,kO),++HN,(t=BO("u"))&&"\\"!==t&&zO(t.charCodeAt(0))||KO({},hO,kO),e+=t);return e}function UO(){var t,e;return t=HN,e=92===$N.charCodeAt(HN)?jO():function(){var t,e;for(t=HN++;HN<ZN;){if(92===(e=$N.charCodeAt(HN)))return HN=t,jO();if(!zO(e))break;++HN}return $N.slice(t,HN)}(),{type:1===e.length?XN:RO.hasOwnProperty(e)?QN:"null"===e?JN:"true"===e||"false"===e?VN:XN,value:e,start:t,end:HN}}function qO(){var t,e,n,r,i=HN,o=$N.charCodeAt(HN),a=$N[HN];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++HN,{type:tO,value:String.fromCharCode(o),start:i,end:HN};default:if(61===(t=$N.charCodeAt(HN+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return HN+=2,{type:tO,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:HN};case 33:case 61:return HN+=2,61===$N.charCodeAt(HN)&&++HN,{type:tO,value:$N.slice(i,HN),start:i,end:HN}}}return">>>="===(r=$N.substr(HN,4))?{type:tO,value:r,start:i,end:HN+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:tO,value:n,start:i,end:HN+=3}:a===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===e?{type:tO,value:e,start:i,end:HN+=2}:("//"===e&&KO({},hO,kO),"<>=!+-*%&|^/".indexOf(a)>=0?(++HN,{type:tO,value:a,start:i,end:HN}):void KO({},hO,kO))}function IO(){var t,e,n;if(CO(SO((n=$N[HN]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=HN,t="","."!==n){if(t=$N[HN++],n=$N[HN],"0"===t){if("x"===n||"X"===n)return++HN,function(t){let e="";for(;HN<ZN&&DO($N[HN]);)e+=$N[HN++];return 0===e.length&&KO({},hO,kO),OO($N.charCodeAt(HN))&&KO({},hO,kO),{type:KN,value:parseInt("0x"+e,16),start:t,end:HN}}(e);if(FO(n))return function(t){let e="0"+$N[HN++];for(;HN<ZN&&FO($N[HN]);)e+=$N[HN++];return(OO($N.charCodeAt(HN))||SO($N.charCodeAt(HN)))&&KO({},hO,kO),{type:KN,value:parseInt(e,8),octal:!0,start:t,end:HN}}(e);n&&SO(n.charCodeAt(0))&&KO({},hO,kO)}for(;SO($N.charCodeAt(HN));)t+=$N[HN++];n=$N[HN]}if("."===n){for(t+=$N[HN++];SO($N.charCodeAt(HN));)t+=$N[HN++];n=$N[HN]}if("e"===n||"E"===n)if(t+=$N[HN++],"+"!==(n=$N[HN])&&"-"!==n||(t+=$N[HN++]),SO($N.charCodeAt(HN)))for(;SO($N.charCodeAt(HN));)t+=$N[HN++];else KO({},hO,kO);return OO($N.charCodeAt(HN))&&KO({},hO,kO),{type:KN,value:parseFloat(t),start:e,end:HN}}function WO(){var t,e,n,r;return YN=null,PO(),t=HN,e=function(){var t,e,n,r;for(CO("/"===(t=$N[HN]),"Regular expression literal must start with a slash"),e=$N[HN++],n=!1,r=!1;HN<ZN;)if(e+=t=$N[HN++],"\\"===t)NO((t=$N[HN++]).charCodeAt(0))&&KO({},xO),e+=t;else if(NO(t.charCodeAt(0)))KO({},xO);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||KO({},xO),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";HN<ZN&&zO((t=$N[HN]).charCodeAt(0));)++HN,"\\"===t&&HN<ZN?KO({},hO,kO):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&KO({},bO,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";KO({},bO)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){KO({},bO)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:HN}}function $O(){if(PO(),HN>=ZN)return{type:GN,start:HN,end:HN};const t=$N.charCodeAt(HN);return OO(t)?UO():40===t||41===t||59===t?qO():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(CO("'"===(t=$N[HN])||'"'===t,"String literal must starts with a quote"),e=HN,++HN;HN<ZN;){if((n=$N[HN++])===t){t="";break}if("\\"===n)if((n=$N[HN++])&&NO(n.charCodeAt(0)))"\r"===n&&"\n"===$N[HN]&&++HN;else switch(n){case"u":case"x":"{"===$N[HN]?(++HN,i+=LO()):i+=BO(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:FO(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),HN<ZN&&FO($N[HN])&&(o=!0,r=8*r+"01234567".indexOf($N[HN++]),"0123".indexOf(n)>=0&&HN<ZN&&FO($N[HN])&&(r=8*r+"01234567".indexOf($N[HN++]))),i+=String.fromCharCode(r)):i+=n}else{if(NO(n.charCodeAt(0)))break;i+=n}}return""!==t&&KO({},hO,kO),{type:eO,value:i,octal:o,start:e,end:HN}}():46===t?SO($N.charCodeAt(HN+1))?IO():qO():SO(t)?IO():qO()}function HO(){const t=YN;return HN=t.end,YN=$O(),HN=t.end,t}function ZO(){const t=HN;YN=$O(),HN=t}function YO(t,e,n){const r=new IN("||"===t||"&&"===t?lO:rO);return r.operator=t,r.left=e,r.right=n,r}function VO(t,e){const n=new IN(iO);return n.callee=t,n.arguments=e,n}function GO(t){const e=new IN(aO);return e.name=t,e}function XO(t){const e=new IN(sO);return e.value=t.value,e.raw=$N.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function QO(t,e,n){const r=new IN(uO);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function JO(t,e,n){const r=new IN(fO);return r.key=e,r.value=n,r.kind=t,r}function KO(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(CO(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=HN,n.description=i,n}function tz(t){t.type===GN&&KO(t,vO),t.type===KN&&KO(t,pO),t.type===eO&&KO(t,mO),t.type===XN&&KO(t,gO),t.type===QN&&KO(t,yO),KO(t,hO,t.value)}function ez(t){const e=HO();e.type===tO&&e.value===t||tz(e)}function nz(t){return YN.type===tO&&YN.value===t}function rz(t){return YN.type===QN&&YN.value===t}function iz(){const t=[];for(HN=YN.start,ez("[");!nz("]");)nz(",")?(HO(),t.push(null)):(t.push(gz()),nz("]")||ez(","));return HO(),function(t){const e=new IN(nO);return e.elements=t,e}(t)}function oz(){HN=YN.start;const t=HO();return t.type===eO||t.type===KN?(t.octal&&KO(t,_O),XO(t)):GO(t.value)}function az(){var t,e,n;return HN=YN.start,(t=YN).type===XN?(n=oz(),ez(":"),JO("init",n,gz())):t.type!==GN&&t.type!==tO?(e=oz(),ez(":"),JO("init",e,gz())):void tz(t)}function sz(){var t,e,n=[],r={},i=String;for(HN=YN.start,ez("{");!nz("}");)e="$"+((t=az()).key.type===aO?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?KO({},wO):r[e]=!0,n.push(t),nz("}")||ez(",");return ez("}"),function(t){const e=new IN(cO);return e.properties=t,e}(n)}const lz={if:1};function uz(){var t,e,n;if(nz("("))return function(){ez("(");const t=yz();return ez(")"),t}();if(nz("["))return iz();if(nz("{"))return sz();if(t=YN.type,HN=YN.start,t===XN||lz[YN.value])n=GO(HO().value);else if(t===eO||t===KN)YN.octal&&KO(YN,_O),n=XO(HO());else{if(t===QN)throw new Error(AO);t===VN?((e=HO()).value="true"===e.value,n=XO(e)):t===JN?((e=HO()).value=null,n=XO(e)):nz("/")||nz("/=")?(n=XO(WO()),ZO()):tz(HO())}return n}function cz(){const t=[];if(ez("("),!nz(")"))for(;HN<ZN&&(t.push(gz()),!nz(")"));)ez(",");return ez(")"),t}function fz(){HN=YN.start;const t=HO();return function(t){return t.type===XN||t.type===QN||t.type===VN||t.type===JN}(t)||tz(t),GO(t.value)}function dz(){ez("[");const t=yz();return ez("]"),t}function hz(){const t=function(){var t;for(t=uz();;)if(nz("."))ez("."),t=QO(".",t,fz());else if(nz("("))t=VO(t,cz());else{if(!nz("["))break;t=QO("[",t,dz())}return t}();if(YN.type===tO&&(nz("++")||nz("--")))throw new Error(AO);return t}function pz(){var t,e;if(YN.type!==tO&&YN.type!==QN)e=hz();else{if(nz("++")||nz("--"))throw new Error(AO);if(nz("+")||nz("-")||nz("~")||nz("!"))t=HO(),e=pz(),e=function(t,e){const n=new IN(dO);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(rz("delete")||rz("void")||rz("typeof"))throw new Error(AO);e=hz()}}return e}function mz(t){let e=0;if(t.type!==tO&&t.type!==QN)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function gz(){var t,e;return t=function(){var t,e,n,r,i,o,a,s,l,u;if(t=YN,l=pz(),0===(i=mz(r=YN)))return l;for(r.prec=i,HO(),e=[t,YN],o=[l,r,a=pz()];(i=mz(YN))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,l=o.pop(),e.pop(),n=YO(s,l,a),o.push(n);(r=HO()).prec=i,o.push(r),e.push(YN),n=pz(),o.push(n)}for(n=o[u=o.length-1],e.pop();u>1;)e.pop(),n=YO(o[u-1].value,o[u-2],n),u-=2;return n}(),nz("?")&&(HO(),e=gz(),ez(":"),t=function(t,e,n){const r=new IN(oO);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,gz())),t}function yz(){const t=gz();if(nz(","))throw new Error(AO);return t}function vz(t){HN=0,ZN=($N=t).length,YN=null,ZO();const e=yz();if(YN.type!==GN)throw new Error("Unexpect token after expression.");return e}var bz={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function xz(t){function e(e,n,r){return i=>function(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&$e("Missing arguments to clamp function."),e.length>3&&$e("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&$e("Missing arguments to if function."),e.length>3&&$e("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function _z(t){const e=(t=t||{}).allowed?vr(t.allowed):{},n=t.forbidden?vr(t.forbidden):{},r=t.constants||bz,i=(t.functions||xz)(f),o=t.globalvar,a=t.fieldvar,s=zn(o)?o:t=>"".concat(o,'["').concat(t,'"]');let l={},u={},c=0;function f(t){if(ir(t))return t;const e=d[t.type];return null==e&&$e("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return c>0?i:Yn(n,i)?$e("Illegal identifier: "+i):Yn(r,i)?r[i]:Yn(e,i)?i:(l[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=f(t.object);e&&(c+=1);const r=f(t.property);return n===a&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&$e("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Yn(i,e)&&i[e];return r||$e("Unrecognized function: "+e),zn(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(f).join(",")+"]",BinaryExpression:t=>"("+f(t.left)+" "+t.operator+" "+f(t.right)+")",UnaryExpression:t=>"("+t.operator+f(t.argument)+")",ConditionalExpression:t=>"("+f(t.test)+"?"+f(t.consequent)+":"+f(t.alternate)+")",LogicalExpression:t=>"("+f(t.left)+t.operator+f(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(f).join(",")+"}",Property:t=>{c+=1;const e=f(t.key);return c-=1,e+":"+f(t.value)}};function h(t){const e={code:f(t),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},e}return h.functions=i,h.constants=r,h}var wz,kz,Az,Ez,Mz,Cz,Sz,Dz,Fz,Tz,Nz,Oz,zz,Rz,Pz,Bz,Lz=new ZA,jz=new ZA,Uz={point:gE,lineStart:gE,lineEnd:gE,polygonStart:function(){Lz=new ZA,Uz.lineStart=qz,Uz.lineEnd=Iz},polygonEnd:function(){var t=+Lz;jz.add(t<0?JA+t:t),this.lineStart=this.lineEnd=this.point=gE},sphere:function(){jz.add(JA)}};function qz(){Uz.point=Wz}function Iz(){$z(wz,kz)}function Wz(t,e){Uz.point=$z,wz=t,kz=e,Az=t*=tE,Ez=iE(e=(e*=tE)/2+QA),Mz=cE(e)}function $z(t,e){var n=(t*=tE)-Az,r=n>=0?1:-1,i=r*n,o=iE(e=(e*=tE)/2+QA),a=cE(e),s=Mz*a,l=Ez*o+s*iE(i),u=s*r*cE(i);Lz.add(rE(u,l)),Az=t,Ez=o,Mz=a}var Hz,Zz,Yz,Vz,Gz,Xz,Qz,Jz,Kz,tR,eR,nR,rR,iR,oR,aR,sR={point:lR,lineStart:cR,lineEnd:fR,polygonStart:function(){sR.point=dR,sR.lineStart=hR,sR.lineEnd=pR,Rz=new ZA,Uz.polygonStart()},polygonEnd:function(){Uz.polygonEnd(),sR.point=lR,sR.lineStart=cR,sR.lineEnd=fR,Lz<0?(Cz=-(Dz=180),Sz=-(Fz=90)):Rz>YA?Fz=90:Rz<-YA&&(Sz=-90),Bz[0]=Cz,Bz[1]=Dz},sphere:function(){Cz=-(Dz=180),Sz=-(Fz=90)}};function lR(t,e){Pz.push(Bz=[Cz=t,Dz=t]),e<Sz&&(Sz=e),e>Fz&&(Fz=e)}function uR(t,e){var n=OM([t*tE,e*tE]);if(zz){var r=RM(zz,n),i=RM([r[1],-r[0],0],r);LM(i),i=NM(i);var o,a=t-Tz,s=a>0?1:-1,l=i[0]*KA*s,u=eE(a)>180;u^(s*Tz<l&&l<s*t)?(o=i[1]*KA)>Fz&&(Fz=o):u^(s*Tz<(l=(l+360)%360-180)&&l<s*t)?(o=-i[1]*KA)<Sz&&(Sz=o):(e<Sz&&(Sz=e),e>Fz&&(Fz=e)),u?t<Tz?mR(Cz,t)>mR(Cz,Dz)&&(Dz=t):mR(t,Dz)>mR(Cz,Dz)&&(Cz=t):Dz>=Cz?(t<Cz&&(Cz=t),t>Dz&&(Dz=t)):t>Tz?mR(Cz,t)>mR(Cz,Dz)&&(Dz=t):mR(t,Dz)>mR(Cz,Dz)&&(Cz=t)}else Pz.push(Bz=[Cz=t,Dz=t]);e<Sz&&(Sz=e),e>Fz&&(Fz=e),zz=n,Tz=t}function cR(){sR.point=uR}function fR(){Bz[0]=Cz,Bz[1]=Dz,sR.point=lR,zz=null}function dR(t,e){if(zz){var n=t-Tz;Rz.add(eE(n)>180?n+(n>0?360:-360):n)}else Nz=t,Oz=e;Uz.point(t,e),uR(t,e)}function hR(){Uz.lineStart()}function pR(){dR(Nz,Oz),Uz.lineEnd(),eE(Rz)>YA&&(Cz=-(Dz=180)),Bz[0]=Cz,Bz[1]=Dz,zz=null}function mR(t,e){return(e-=t)<0?e+360:e}function gR(t,e){return t[0]-e[0]}function yR(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var vR={sphere:gE,point:bR,lineStart:_R,lineEnd:AR,polygonStart:function(){vR.lineStart=ER,vR.lineEnd=MR},polygonEnd:function(){vR.lineStart=_R,vR.lineEnd=AR}};function bR(t,e){t*=tE;var n=iE(e*=tE);xR(n*iE(t),n*cE(t),cE(e))}function xR(t,e,n){++Hz,Yz+=(t-Yz)/Hz,Vz+=(e-Vz)/Hz,Gz+=(n-Gz)/Hz}function _R(){vR.point=wR}function wR(t,e){t*=tE;var n=iE(e*=tE);iR=n*iE(t),oR=n*cE(t),aR=cE(e),vR.point=kR,xR(iR,oR,aR)}function kR(t,e){t*=tE;var n=iE(e*=tE),r=n*iE(t),i=n*cE(t),o=cE(e),a=rE(dE((a=oR*o-aR*i)*a+(a=aR*r-iR*o)*a+(a=iR*i-oR*r)*a),iR*r+oR*i+aR*o);Zz+=a,Xz+=a*(iR+(iR=r)),Qz+=a*(oR+(oR=i)),Jz+=a*(aR+(aR=o)),xR(iR,oR,aR)}function AR(){vR.point=bR}function ER(){vR.point=CR}function MR(){SR(nR,rR),vR.point=bR}function CR(t,e){nR=t,rR=e,t*=tE,e*=tE,vR.point=SR;var n=iE(e);iR=n*iE(t),oR=n*cE(t),aR=cE(e),xR(iR,oR,aR)}function SR(t,e){t*=tE;var n=iE(e*=tE),r=n*iE(t),i=n*cE(t),o=cE(e),a=oR*o-aR*i,s=aR*r-iR*o,l=iR*i-oR*r,u=sE(a,s,l),c=mE(u),f=u&&-c/u;Kz.add(f*a),tR.add(f*s),eR.add(f*l),Zz+=c,Xz+=c*(iR+(iR=r)),Qz+=c*(oR+(oR=i)),Jz+=c*(aR+(aR=o)),xR(iR,oR,aR)}function DR(t){return t instanceof Am?t:new Am(t)}const FR=Symbol("vega_selection_getter");function TR(t){return t.getter&&t.getter[FR]||(t.getter=Ze(t.field),t.getter[FR]=!0),t.getter}const NR="intersect",OR="union",zR="_vgsid_",RR=Ze(zR),PR="E",BR="R",LR="R-E",jR="R-LE",UR="R-RE",qR="index:unit";function IR(t,e){for(var n,r,i=e.fields,o=e.values,a=i.length,s=0;s<a;++s)if(tr(n=TR(r=i[s])(t))&&(n=pn(n)),tr(o[s])&&(o[s]=pn(o[s])),sn(o[s])&&tr(o[s][0])&&(o[s]=o[s].map(pn)),r.type===PR){if(sn(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if(r.type===BR){if(!Jn(n,o[s]))return!1}else if(r.type===UR){if(!Jn(n,o[s],!0,!1))return!1}else if(r.type===LR){if(!Jn(n,o[s],!1,!1))return!1}else if(r.type===jR&&!Jn(n,o[s],!1,!0))return!1;return!0}const WR=Xi(RR),$R=WR.left,HR=WR.right;var ZR={["".concat(zR,"_union")]:function(){const t=new Am;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)for(const e of i)t.add(e);return t},["".concat(zR,"_intersect")]:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t=new Am(t),n=n.map(DR);t:for(const i of t)for(const e of n)if(!e.has(i)){t.delete(i);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=pn(e[0]),r=pn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=pn(e[0]),r=pn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function YR(t,e,n,r){e[0].type!==NN&&$e("First argument to selection functions must be a string literal.");const i=e[0].value,o="unit",a="@"+o,s=":"+i;(e.length>=2&&hn(e).value)!==NR||Yn(r,a)||(r[a]=n.getData(i).indataRef(n,o)),Yn(r,s)||(r[s]=n.getData(i).tuplesRef())}function VR(t){const e=this.context.data[t];return e?e.values.value:[]}const GR=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},XR=GR("format"),QR=GR("timeFormat"),JR=GR("utcFormat"),KR=GR("timeParse"),tP=GR("utcParse"),eP=new Date(2e3,0,1);function nP(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(eP.setYear(2e3),eP.setMonth(t),eP.setDate(e),QR.call(this,eP,n)):""}const rP="%",iP="$";function oP(t,e,n,r){e[0].type!==NN&&$e("First argument to data functions must be a string literal.");const i=e[0].value,o=":"+i;if(!Yn(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function aP(t,e,n,r){if(e[0].type===NN)sP(n,r,e[0].value);else for(t in n.scales)sP(n,r,t)}function sP(t,e,n){const r=rP+n;if(!Yn(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function lP(t,e){if(zn(t))return t;if(ir(t)){const n=e.scales[t];return n&&function(t){return t&&!0===t[ny]}(n.value)?n.value:void 0}}function uP(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=aP,n._range=aP,n._scale=aP;const r=e=>"_["+(e.type===NN?hr(rP+e.value):hr(rP)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}function cP(t,e){return function(n,r,i){if(n){const e=lP(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const fP=cP("area",(function(t){return jz=new ZA,HA(t,Uz),2*jz})),dP=cP("bounds",(function(t){var e,n,r,i,o,a,s;if(Fz=Dz=-(Cz=Sz=1/0),Pz=[],HA(t,sR),n=Pz.length){for(Pz.sort(gR),e=1,o=[r=Pz[0]];e<n;++e)yR(r,(i=Pz[e])[0])||yR(r,i[1])?(mR(r[0],i[1])>mR(r[0],r[1])&&(r[1]=i[1]),mR(i[0],r[1])>mR(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(s=mR(r[1],i[0]))>a&&(a=s,Cz=i[0],Dz=r[1])}return Pz=Bz=null,Cz===1/0||Sz===1/0?[[NaN,NaN],[NaN,NaN]]:[[Cz,Sz],[Dz,Fz]]})),hP=cP("centroid",(function(t){Hz=Zz=Yz=Vz=Gz=Xz=Qz=Jz=0,Kz=new ZA,tR=new ZA,eR=new ZA,HA(t,vR);var e=+Kz,n=+tR,r=+eR,i=sE(e,n,r);return i<VA&&(e=Xz,n=Qz,r=Jz,Zz<YA&&(e=Yz,n=Vz,r=Gz),(i=sE(e,n,r))<VA)?[NaN,NaN]:[rE(n,e)*KA,mE(r/i)*KA]}));function pP(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function mP(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function gP(t){const e=Gh(t);return.2126*mP(e.r)+.7152*mP(e.g)+.0722*mP(e.b)}function yP(t,e){return t===e||t!==t&&e!==e||(sn(t)?!(!sn(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!yP(t[n],e[n]))return!1;return!0}(t,e):!(!ln(t)||!ln(e))&&vP(t,e))}function vP(t,e){for(const n in t)if(!yP(t[n],e[n]))return!1;return!0}function bP(t){return e=>vP(t,e)}const xP={};function _P(t){return sn(t)||ArrayBuffer.isView(t)?t:null}function wP(t){return _P(t)||(ir(t)?t:null)}const kP=t=>t.data;function AP(t,e){const n=VR.call(e,t);return n.root&&n.root.lookup||{}}const EP=()=>"undefined"!==typeof window&&window||null;function MP(t,e,n){if(!t)return[];const[r,i]=t,o=(new Zv).set(r[0],r[1],i[0],i[1]);return Ow(n||this.context.dataflow.scenegraph().root,o,function(t){let e=null;if(t){const n=Nn(t.marktype),r=Nn(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))}const CP={random:()=>Mu(),cumulativeNormal:Bu,cumulativeLogNormal:Wu,cumulativeUniform:Gu,densityNormal:Pu,densityLogNormal:Iu,densityUniform:Vu,quantileNormal:Lu,quantileLogNormal:$u,quantileUniform:Xu,sampleNormal:Ru,sampleLogNormal:qu,sampleUniform:Yu,isArray:sn,isBoolean:Kn,isDate:tr,isDefined:t=>void 0!==t,isNumber:nr,isObject:ln,isRegExp:rr,isString:ir,isTuple:Cl,isValid:t=>null!=t&&t===t,toBoolean:pr,toDate:t=>gr(t),toNumber:pn,toString:yr,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return wP(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _P(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return wP(t).lastIndexOf(...n)},replace:function(t,e,n){return zn(n)&&$e("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return _P(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return wP(t).slice(...n)},flush:Xn,lerp:ar,merge:function(){const t=[].slice.call(arguments);return t.unshift({}),Wn(...t)},pad:fr,peek:hn,pluck:function(t,e){const n=xP[e]||(xP[e]=Ze(e));return sn(t)?t.map(n):n(t)},span:dr,inrange:Jn,truncate:br,rgb:Gh,lab:eg,hcl:lg,hsl:ip,luminance:gP,contrast:function(t,e){const n=gP(t),r=gP(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:vc,format:XR,utcFormat:JR,utcParse:tP,utcOffset:Wo,utcSequence:Zo,timeFormat:QR,timeParse:KR,timeOffset:Io,timeSequence:Ho,timeUnitSpecifier:po,monthFormat:function(t){return nP.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return nP.call(this,t,1,"%b")},dayFormat:function(t){return nP.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return nP.call(this,0,2+t,"%a")},quarter:Fn,utcquarter:Tn,week:vo,utcweek:Ao,dayofyear:yo,utcdayofyear:ko,warn:function(){return pP(this.context.dataflow,"warn",arguments)},info:function(){return pP(this.context.dataflow,"info",arguments)},debug:function(){return pP(this.context.dataflow,"debug",arguments)},extent:t=>$n(t),inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:MP,clampRange:On,pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=EP();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=EP();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return Dg(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(Qe).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?mv(n,e=e||iv(t)):t}},panLinear:_n,panLog:wn,panPow:kn,panSymlog:An,zoomLinear:Mn,zoomLog:Cn,zoomPow:Sn,zoomSymlog:Dn,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){const a=this.context.dataflow,s=this.context.data[t],l=s.input,u=a.stamp();let c,f,d=s.changes;if(!1===a._trigger||!(l.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=a.changeset(),d.stamp=u,a.runAfter((()=>{s.modified=!0,a.pulse(l,d).run()}),!0,1)),n&&(c=!0===n?Qe:sn(n)||Cl(n)?n:bP(n),d.remove(c)),e&&d.insert(e),r&&(c=bP(r),l.value.some(c)?d.remove(c):d.insert(r)),i)for(f in o)d.modify(i,f,o[f]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(t=Nn(t))[t.length-1];return void 0===i||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return Nn(t).reduce(((e,n,r)=>{let[i,o]=n;return e+(0==r?"M ".concat(i,",").concat(o," "):r===t.length-1?" Z":"L ".concat(i,",").concat(o," "))}),"")},intersectLasso:function(t,e,n){const{x:r,y:i,mark:o}=n,a=(new Zv).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,l]of e)s<a.x1&&(a.x1=s),s>a.x2&&(a.x2=s),l<a.y1&&(a.y1=l),l>a.y2&&(a.y2=l);return a.translate(r,i),MP([[a.x1,a.y1],[a.x2,a.y2]],t,o).filter((t=>function(t,e,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[a,s]=n[o],[l,u]=n[i];u>e!=s>e&&t<(a-l)*(e-u)/(s-u)+l&&r++}return 1&r}(t.x,t.y,e)))}},SP=["view","item","group","xy","x","y"],DP="this.",FP={},TP={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(hr(iP+t),"]"),functions:function(t){const e=xz(t);SP.forEach((t=>e[t]="event.vega."+t));for(const n in CP)e[n]=DP+n;return Wn(e,uP(t,CP,FP)),e},constants:bz,visitors:FP},NP=_z(TP);function OP(t,e,n){return 1===arguments.length?CP[t]:(CP[t]=e,n&&(FP[t]=n),NP&&(NP.functions[t]=DP+t),this)}function zP(t,e){const n={};let r;try{r=vz(t=ir(t)?t:hr(t)+"")}catch(o){$e("Expression parse error: "+t)}r.visit((t=>{if(t.type!==PN)return;const r=t.callee.name,i=TP.visitors[r];i&&i(r,t.arguments,e,n)}));const i=NP(r);return i.globals.forEach((t=>{const r=iP+t;!Yn(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:Wn({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}OP("bandwidth",(function(t,e){const n=lP(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),aP),OP("copy",(function(t,e){const n=lP(t,(e||this).context);return n?n.copy():void 0}),aP),OP("domain",(function(t,e){const n=lP(t,(e||this).context);return n?n.domain():[]}),aP),OP("range",(function(t,e){const n=lP(t,(e||this).context);return n&&n.range?n.range():[]}),aP),OP("invert",(function(t,e,n){const r=lP(t,(n||this).context);return r?sn(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),aP),OP("scale",(function(t,e,n){const r=lP(t,(n||this).context);return r?r(e):void 0}),aP),OP("gradient",(function(t,e,n,r,i){t=lP(t,(i||this).context);const o=Xy(e,n);let a=t.domain(),s=a[0],l=hn(a),u=Ve;return l-s?u=yy(t,s,l):t=(t.interpolator?iy("sequential")().interpolator(t.interpolator()):iy("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,l=1]),t.ticks&&(a=t.ticks(+r||15),s!==a[0]&&a.unshift(s),l!==hn(a)&&a.push(l)),a.forEach((e=>o.stop(u(e),t(e)))),o}),aP),OP("geoArea",fP,aP),OP("geoBounds",dP,aP),OP("geoCentroid",hP,aP),OP("geoShape",(function(t,e,n){const r=lP(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),aP),OP("geoScale",(function(t,e){const n=lP(t,(e||this).context);return n&&n.scale()}),aP),OP("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==NN&&$e("First argument to indata must be a string literal."),e[1].type!==NN&&$e("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,a="@"+o;Yn(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),OP("data",VR,oP),OP("treePath",(function(t,e,n){const r=AP(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(kP):void 0}),oP),OP("treeAncestors",(function(t,e){const n=AP(t,this)[e];return n?n.ancestors().map(kP):void 0}),oP),OP("vlSelectionTest",(function(t,e,n){for(var r,i,o,a,s,l=this.context.data[t],u=l?l.values.value:[],c=l?l[qR]&&l[qR].value:void 0,f=n===NR,d=u.length,h=0;h<d;++h)if(r=u[h],c&&f){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=IR(e,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(f^(s=IR(e,r)))return s;return d&&f}),YR),OP("vlSelectionIdTest",(function(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],o=r?r[qR]&&r[qR].value:void 0,a=n===NR,s=RR(e),l=$R(i,s);if(l===i.length)return!1;if(RR(i[l])!==s)return!1;if(o&&a){if(1===o.size)return!0;if(HR(i,s)-l<o.size)return!1}return!0}),YR),OP("vlSelectionResolve",(function(t,e,n,r){for(var i,o,a,s,l,u,c,f,d,h,p,m,g=this.context.data[t],y=g?g.values.value:[],v={},b={},x={},_=y.length,w=0;w<_;++w)if(s=(i=y[w]).unit,o=i.fields,a=i.values,o&&a){for(p=0,m=o.length;p<m;++p)l=o[p],f=(c=v[l.field]||(v[l.field]={}))[s]||(c[s]=[]),x[l.field]=d=l.type.charAt(0),h=ZR["".concat(d,"_union")],c[s]=h(f,Nn(a[p]));n&&(f=b[s]||(b[s]=[])).push(Nn(a).reduce(((t,e,n)=>(t[o[n].field]=e,t)),{}))}else l=zR,u=RR(i),(f=(c=v[l]||(v[l]={}))[s]||(c[s]=[])).push(u),n&&(f=b[s]||(b[s]=[])).push({[zR]:u});if(e=e||OR,v[zR]?v[zR]=ZR["".concat(zR,"_").concat(e)](...Object.values(v[zR])):Object.keys(v).forEach((t=>{v[t]=Object.keys(v[t]).map((e=>v[t][e])).reduce(((n,r)=>void 0===n?r:ZR["".concat(x[t],"_").concat(e)](n,r)))})),y=Object.keys(b),n&&y.length){v[r?"vlPoint":"vlMulti"]=e===OR?{or:y.reduce(((t,e)=>(t.push(...b[e]),t)),[])}:{and:y.map((t=>({or:b[t]})))}}return v}),YR),OP("vlSelectionTuples",(function(t,e){return t.map((t=>Wn(e.fields?{values:e.fields.map((e=>TR(e)(t.datum)))}:{[zR]:RR(t.datum)},e)))}));const RP=vr(["rule"]),PP=vr(["group","image","rect"]);function BP(t){return(t+"").toLowerCase()}function LP(t,e,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var jP={operator:(t,e)=>LP(t,["_"],e.code),parameter:(t,e)=>LP(t,["datum","_"],e.code),event:(t,e)=>LP(t,["event"],e.code),handler:(t,e)=>LP(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const t="o["+hr(o)+"]";i+="$=".concat(r[o].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(t,e){let n="";return RP[e]||(t.x2&&(t.x?(PP[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(PP[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",LP(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(hr).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let o,a;return t.path?(o="a".concat(t.path),a="b".concat(t.path)):((n=n||{})["f"+r]=t,o="this.f".concat(r,"(a)"),a="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(o,a,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function UP(t,e,n){if(!t||!ln(t))return t;for(let r,i=0,o=qP.length;i<o;++i)if(r=qP[i],Yn(t,r.key))return r.parse(t,e,n);return t}var qP=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||$e("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=or(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=Le(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=Ze(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=Le(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=Nn(t.$compare).map((t=>t&&t.$tupleid?Sl:t));return e.fn[n]||(e.fn[n]=Pn(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>e.detach(o),a}}},{key:"$tupleid",parse:function(){return Sl}}];const IP={skip:!0};function WP(t,e,n,r){return new $P(t,e,n,r)}function $P(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||jP,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function HP(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function ZP(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}$P.prototype=HP.prototype={fork(){const t=new HP(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),function(t){return"collect"===BP(t)}(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const o in t.data){const r=n.data[o]||(n.data[o]={});t.data[o].forEach((t=>r[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[BP(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;!function(t){return"operator"===BP(t)}(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||$e("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=sn(i)?i.map((t=>UP(t,n,e))):UP(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&$e("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=ln(r=t.source)?r.$ref:r,i=n.get(r),o=t.update,a=void 0;i||$e("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),o&&o.$expr&&(o.$params&&(a=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(t,i,e,o,a)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],IP)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(Qe).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const YP="default";function VP(t,e){const n=t.globalCursor()?"undefined"!==typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function GP(t,e){var n=t._runtime.data;return Yn(n,e)||$e("Unrecognized data set: "+e),n[e]}function XP(t,e){Rl(e)||$e("Second argument to changes must be a changeset.");const n=GP(this,t);return n.modified=!0,this.pulse(n.input,e)}function QP(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function JP(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function KP(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function tB(t,e,n){var r,i,o=t._renderer,a=o&&o.canvas();return a&&(i=KP(t),(r=i_(e.changedTouches?e.changedTouches[0]:e,a))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;ir(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:qn(t),item:qn(e||{}),group:i,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}(t,n,r),e}const eB="view",nB={trap:!1};function rB(t,e,n,r){t._eventListeners.push({type:n,sources:Nn(e),handler:r})}function iB(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||ln(r)&&!r[n])||(t.warn("Blocked ".concat(e," ").concat(n," event listener.")),!1)}function oB(t){return t.item}function aB(t){return t.item.mark.source}function sB(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function lB(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}const uB="vega-bind",cB="vega-bind-name",fB="vega-bind-radio";function dB(t,e,n,r){const i=n.event||"input",o=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,o),rB(r,e,i,o),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!==typeof Event?new Event(t):{type:t}}(i))}}function hB(t,e,n,r){const i=r.signal(n.signal),o=lB("div",{class:uB}),a="radio"===n.input?o:o.appendChild(lB("label"));a.appendChild(lB("span",{class:cB},n.name||n.signal)),e.appendChild(o);let s=pB;switch(n.input){case"checkbox":s=mB;break;case"select":s=gB;break;case"radio":s=yB;break;case"range":s=vB}s(t,a,n,i)}function pB(t,e,n,r){const i=lB("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function mB(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=lB("input",i);e.appendChild(o),o.addEventListener("change",(()=>t.update(o.checked))),t.elements=[o],t.set=t=>o.checked=!!t||null}function gB(t,e,n,r){const i=lB("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};bB(t,r)&&(n.selected=!0),i.appendChild(lB("option",n,(o[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(bB(n.options[e],t))return void(i.selectedIndex=e)}}function yB(t,e,n,r){const i=lB("span",{class:fB}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,a)=>{const s={type:"radio",name:n.signal,value:e};bB(e,r)&&(s.checked=!0);const l=lB("input",s);l.addEventListener("change",(()=>t.update(e)));const u=lB("label",{},(o[a]||e)+"");return u.prepend(l),i.appendChild(u),l})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)bB(n[t].value,e)&&(n[t].checked=!0)}}function vB(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||$r(o,i,100),s=lB("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const l=lB("span",{},+r);e.appendChild(s),e.appendChild(l);const u=()=>{l.textContent=s.value,t.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),t.elements=[s],t.set=t=>{s.value=t,l.textContent=t}}function bB(t,e){return t===e||t+""===e+""}function xB(t,e,n,r,i,o){return(e=e||new r(t.loader())).initialize(n,QP(t),JP(t),KP(t),i,o).background(t.background())}function _B(t,e){return e?function(){try{e.apply(this,arguments)}catch($e){t.error($e)}}:null}function wB(t,e,n){if("string"===typeof e){if("undefined"===typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.textContent=""}catch(r){e=null,t.error(r)}return e}const kB=t=>+t||0;function AB(t){return ln(t)?{top:kB(t.top),bottom:kB(t.bottom),left:kB(t.left),right:kB(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(kB(t))}async function EB(t,e,n,r){const i=Nw(e),o=i&&i.headless;return o||$e("Unrecognized renderer type: "+e),await t.runAsync(),xB(t,null,null,o,n,r).renderAsync(t._scenegraph.root)}var MB="width",CB="height",SB="padding",DB={skip:!0};function FB(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===SB?r.left+r.right:0)}function TB(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===SB?r.top+r.bottom:0)}function NB(t,e){return e.modified&&sn(e.input.value)&&!t.startsWith("_:vega:_")}function OB(t,e){return!("parent"===t||e instanceof lu.proxy)}function zB(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":sn(t)?RB(t):ln(t)&&!tr(t)?(e=t,Object.keys(e).map((t=>{const n=e[t];return t+": "+(sn(n)?RB(n):PB(n))})).join("\n")):t+"";var e}(r))}function RB(t){return"["+t.map(PB).join(", ")+"]"}function PB(t){return sn(t)?"[\u2026]":ln(t)&&!tr(t)?"{\u2026}":t}function BB(t,e){const n=this;if(e=e||{},ou.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=Wn({},t.locale,e.locale);n.locale(Ys(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||Fw.Canvas,n._scenegraph=new Qx;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||zB,n._redraw=!0,n._handler=(new C_).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=Wn({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{sn(t[e])&&(t[e]=vr(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return WP(t,lu,CP,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:Wn({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=FB(n,n._width),n._viewHeight=TB(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e[MB],r=e[CB],i=e[SB];function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=FB(t,e.size),o()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=TB(t,e.size),o()}),{size:r});const a=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:YP,item:null}));t.on(t.events("view","pointermove"),e,((t,n)=>{const r=e.value,i=r?ir(r)?r:r.user:YP,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return ir(n)||(r=n.item,n=n.user),VP(t,n&&n!==YP?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind),e.watchPixelRatio&&n._watchPixelRatio()}function LB(t,e){return Yn(t._signals,e)?t._signals[e]:$e("Unrecognized signal name: "+hr(e))}function jB(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function UB(t,e,n,r){let i=jB(n,r);return i||(i=_B(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function qB(t,e,n){const r=jB(e,n);return r&&e._targets.remove(r),t}Qn(BB,ou,{async evaluate(t,e,n){if(await ou.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(t){var e=KP(t),n=QP(t),r=JP(t);t._renderer.background(t.background()),t._renderer.resize(n,r,e),t._handler.origin(e),t._resizeListeners.forEach((e=>{try{e(n,r)}catch($e){t.error($e)}}))}(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Al(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&ZP(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=LB(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",AB(t)):AB(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(Nw(t)||$e("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(ou.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(LB(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,o){this.runAfter((a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(MB,n,DB),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal(CB,r,DB),a._resizeHeight.skip(!0)),a._viewWidth!==t&&(a._resize=1,a._viewWidth=t),a._viewHeight!==e&&(a._resize=1,a._viewHeight=e),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=_B(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.includes(t)||e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return UB(this,t,LB(this,t),e)},removeSignalListener(t,e){return qB(this,LB(this,t),e)},addDataListener(t,e){return UB(this,t,GP(this,t).values,e)},removeDataListener(t,e){return qB(this,GP(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=VP(this,null);this._globalCursor=!!t,e&&VP(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new dD,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?cD():+n,r._restart((function o(a){a+=i,r._restart(o,i+=e,n),t(a)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,o=new $l(n),a=function(n,r){i.runAsync(null,(()=>{t===eB&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),o.receive(tB(i,n,r))}))};if("timer"===t)iB(i,"timer",e)&&i.timer(a,e);else if(t===eB)iB(i,"view",e)&&i.addEventListener(e,a,nB);else if("window"===t?iB(i,"window",e)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&iB(i,"selector",e)&&(r=Array.from(document.querySelectorAll(t))),r){for(var s=0,l=r.length;s<l;++s)r[s].addEventListener(e,a);rB(i,r,e,a)}else i.warn("Can not resolve event source: "+t);return o},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=o.length;--t>=0;)for(e=(n=o[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","pointerover",oB),aB,sB(t)),this.on(this.events("view","pointerout",oB),aB,sB(e)),this},data:function(t,e){return arguments.length<2?GP(this,t).values.value:XP.call(this,t,Pl().remove(Qe).insert(e))},change:XP,insert:function(t,e){return XP.call(this,t,Pl().insert(e))},remove:function(t,e){return XP.call(this,t,Pl().remove(e))},scale:function(t){var e=this._runtime.scales;return Yn(e,t)||$e("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Nw(r);t=n._el=t?wB(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),ZP(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||C_,s=t?o.renderer:o.headless;return n._renderer=s?xB(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),_B(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,KP(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,a),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=wB(n,e,!0):t.appendChild(lB("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=wB(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=In(r.debounce,i.update))),(null==r.input&&r.element?dB:hB)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==Fw.Canvas&&t!==Fw.SVG&&t!==Fw.PNG&&$e("Unrecognized image type: "+t);const n=await EB(this,t,e);return t===Fw.SVG?function(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await EB(this,Fw.Canvas,t,e)).canvas()},toSVG:async function(t){return(await EB(this,Fw.SVG,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:NB,signals:OB,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this},_watchPixelRatio:function(){if("canvas"===this.renderer()&&this._renderer._canvas){let t=null;const e=()=>{null!=t&&t();const n=matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)"));n.addEventListener("change",e),t=()=>{n.removeEventListener("change",e)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};e()}}});const IB="view",WB="[",$B="]",HB="{",ZB="}",YB=":",VB=",",GB="@",XB=">",QB=/[[\]{}]/,JB={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let KB,tL;function eL(t,e,n){return KB=e||IB,tL=n||JB,rL(t.trim()).map(iL)}function nL(t,e,n,r,i){const o=t.length;let a,s=0;for(;e<o;++e){if(a=t[e],!s&&a===n)return e;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return e}function rL(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=nL(t,i,VB,WB+HB,$B+ZB),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function iL(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=nL(t,r,$B,WB,$B),r===e)throw"Empty between selector: "+t;if(n=rL(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(t=t.slice(r+1).trim(),t[0]!==XB)throw"Expected '>' after between selector: "+t;n=n.map(iL);const i=iL(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:KB},n=[];let r,i,o=[0,0],a=0,s=0,l=t.length,u=0;if(t[l-1]===ZB){if(u=t.lastIndexOf(HB),!(u>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(VB);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}(t.substring(u+1,l-1))}catch(c){throw"Invalid throttle specification: "+t}l=(t=t.slice(0,u).trim()).length,u=0}if(!l)throw t;t[0]===GB&&(a=++u);r=nL(t,u,YB),r<l&&(n.push(t.substring(s,r).trim()),s=u=++r);if(u=nL(t,u,WB),u===l)n.push(t.substring(s,l).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===l)throw"Unmatched left bracket: "+t;for(;u<l;){if(u=nL(t,u,$B),u===l)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<l-1&&t[++u]!==WB)throw"Expected left bracket: "+t;s=++u}if(!(l=n.length)||QB.test(n[l-1]))throw"Invalid event selector: "+t;l>1?(e.type=n[1],a?e.markname=n[0].slice(1):!function(t){return tL[t]}(n[0])?e.source=n[0]:e.marktype=n[0]):e.type=n[0];"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);o[0]&&(e.throttle=o[0]);o[1]&&(e.debounce=o[1]);return e}(t)}function oL(t){return ln(t)?t:{type:t||"pad"}}const aL=t=>+t||0,sL=t=>({top:t,bottom:t,left:t,right:t});function lL(t){return ln(t)?t.signal?t:{top:aL(t.top),bottom:aL(t.bottom),left:aL(t.left),right:aL(t.right)}:sL(aL(t))}const uL=t=>ln(t)&&!sn(t)?Wn({},t):{value:t};function cL(t,e,n,r){if(null!=n){return ln(n)&&!sn(n)||sn(n)&&n.length&&ln(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1}return 0}function fL(t,e,n){for(const r in e)cL(t,r,e[r]);for(const r in n)cL(t,r,n[r],"update")}function dL(t,e,n){for(const r in e)n&&Yn(n,r)||(t[r]=Wn(t[r]||{},e[r]));return t}function hL(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const pL="mark",mL="frame",gL="scope",yL="axis",vL="axis-domain",bL="axis-grid",xL="axis-label",_L="axis-tick",wL="axis-title",kL="legend",AL="legend-band",EL="legend-entry",ML="legend-gradient",CL="legend-label",SL="legend-symbol",DL="legend-title",FL="title",TL="title-text",NL="title-subtitle";function OL(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const zL=t=>ir(t)?hr(t):t.signal?"(".concat(t.signal,")"):LL(t);function RL(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:hr(t)));for(;e.length&&null==hn(e);)e.pop();return e.unshift(zL(t.gradient)),"gradient(".concat(e.join(","),")")}(t);let e=t.signal?"(".concat(t.signal,")"):t.color?function(t){return t.c?PL("hcl",t.h,t.c,t.l):t.h||t.s?PL("hsl",t.h,t.s,t.l):t.l||t.a?PL("lab",t.l,t.a,t.b):t.r||t.g||t.b?PL("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?LL(t.field):void 0!==t.value?hr(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=zL(t.scale);null!=t.range?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(void 0!==e&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(1===+t.band?"":"*"+BL(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),null==e&&(e="0"));return e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e="pow(".concat(e,",").concat(BL(t.exponent),")")),null!=t.mult&&(e+="*".concat(BL(t.mult))),null!=t.offset&&(e+="+".concat(BL(t.offset))),t.round&&(e="round(".concat(e,")")),e}const PL=(t,e,n,r)=>"(".concat(t,"(").concat([e,n,r].map(RL).join(","),")+'')");function BL(t){return ln(t)?"("+RL(t)+")":t}function LL(t){return jL(ln(t)?t:{datum:t})}function jL(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):$e("Invalid field reference: "+hr(t));return t.signal||(r=ir(r)?He(r).map(hr).join("]["):jL(r)),e+"["+r+"]"}function UL(t,e,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},t=function(t,e,n,r,i){const o={},a={};let s,l,u,c;for(l in l="lineBreak","text"!==e||null==i[l]||hL(l,t)||OL(o,l,i[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===mL?i.group:n===pL?Wn({},i.mark,i[e]):null,c)u=hL(l,t)||("fill"===l||"stroke"===l)&&(hL("fill",t)||hL("stroke",t)),u||OL(o,l,c[l]);for(l in Nn(r).forEach((e=>{const n=i.style&&i.style[e];for(const r in n)hL(r,t)||OL(o,r,n[r])})),t=Wn({},t),o)c=o[l],c.signal?(s=s||{})[l]=c:a[l]=c;return t.enter=Wn(a,t.enter),s&&(t.update=Wn(s,t.update)),t}(t,e,n,r,i.config);for(const s in t)a[s]=qL(t[s],e,o,i);return o}function qL(t,e,n,r){const i={},o={};for(const s in t)null!=t[s]&&(i[s]=IL((a=t[s],sn(a)?function(t){let e="";return t.forEach((t=>{const n=RL(t);e+=t.test?"(".concat(t.test,")?").concat(n,":"):n})),":"===hn(e)&&(e+="null"),e}(a):RL(a)),r,n,o));var a;return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function IL(t,e,n,r){const i=zP(t,e);return i.$fields.forEach((t=>r[t]=1)),Wn(n,i.$params),i.$expr}const WL="outer",$L=["value","update","init","react","bind"];function HL(t,e){$e(t+' for "outer" push: '+hr(e))}function ZL(t,e){const n=t.name;if(t.push===WL)e.signals[n]||HL("No prior signal definition",n),$L.forEach((e=>{void 0!==t[e]&&HL("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function YL(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function VL(t,e,n,r){return new YL(t,e,n,r)}function GL(t,e){return VL("operator",t,e)}function XL(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function QL(t,e){return e?{$field:t,$name:e}:{$field:t}}const JL=QL("key");function KL(t,e){return{$compare:t,$order:e}}const tj="descending";function ej(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const nj="scope",rj="view";function ij(t){return t&&t.signal}function oj(t){if(ij(t))return!0;if(ln(t))for(const e in t)if(oj(t[e]))return!0;return!1}function aj(t,e){return null!=t?t:e}function sj(t){return t&&t.signal||t}const lj="timer";function uj(t,e){return(t.merge?cj:t.stream?fj:t.type?dj:$e("Invalid stream specification: "+hr(t)))(t,e)}function cj(t,e){const n=t.merge.map((t=>uj(t,e))),r=hj({merge:n},t,e);return e.addStream(r).id}function fj(t,e){const n=hj({stream:uj(t.stream,e)},t,e);return e.addStream(n).id}function dj(t,e){let n;t.type===lj?(n=e.event(lj,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(function(t){return t===nj?rj:t||rj}(t.source),t.type);const r=hj({stream:n},t,e);return 1===Object.keys(r).length?n:e.addStream(r).id}function hj(t,e,n){let r=e.between;return r&&(2!==r.length&&$e('Stream "between" parameter must have 2 entries: '+hr(e)),t.between=[uj(r[0],n),uj(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===nj&&r.push("inScope(event.item)"),r.length&&(t.filter=zP("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const pj={code:"_.$value",ast:{type:"Identifier",value:"value"}};function mj(t,e,n){const r=t.encode,i={target:n};let o=t.events,a=t.update,s=[];o||$e("Signal update missing events specification."),ir(o)&&(o=eL(o,e.isSubscope()?nj:rj)),o=Nn(o).filter((t=>t.signal||t.scale?(s.push(t),0):1)),s.length>1&&(s=[gj(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),null!=r&&(a&&$e("Signal encode and update are mutually exclusive."),a="encode(item(),"+hr(r)+")"),i.update=ir(a)?zP(a,e):null!=a.expr?zP(a.expr,e):null!=a.value?a.value:null!=a.signal?{$expr:pj,$params:{$value:e.signalRef(a.signal)}}:$e("Invalid signal update specification."),t.force&&(i.options={force:!0}),s.forEach((t=>e.addUpdate(Wn(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):uj(t,e)}}(t,e),i))))}function gj(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const yj=t=>(e,n,r)=>VL(t,n,e||void 0,r),vj=yj("aggregate"),bj=yj("axisticks"),xj=yj("bound"),_j=yj("collect"),wj=yj("compare"),kj=yj("datajoin"),Aj=yj("encode"),Ej=yj("expression"),Mj=yj("facet"),Cj=yj("field"),Sj=yj("key"),Dj=yj("legendentries"),Fj=yj("load"),Tj=yj("mark"),Nj=yj("multiextent"),Oj=yj("multivalues"),zj=yj("overlap"),Rj=yj("params"),Pj=yj("prefacet"),Bj=yj("projection"),Lj=yj("proxy"),jj=yj("relay"),Uj=yj("render"),qj=yj("scale"),Ij=yj("sieve"),Wj=yj("sortitems"),$j=yj("viewlayout"),Hj=yj("values");let Zj=0;const Yj={min:"min",max:"max",count:"sum"};function Vj(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=Jj(t.domain,t,e),null!=t.range&&(n.range=aU(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=Gj(t.type||t),null!=t.gamma&&(e.interpolateGamma=Gj(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=function(t){return ln(t)?{interval:Gj(t.interval),step:Gj(t.step)}:Gj(t)}(t.nice)),null!=t.bins&&(n.bins=function(t,e){return t.signal||sn(t)?Xj(t,e):e.objectProperty(t)}(t.bins,e)),t)Yn(n,r)||"name"===r||(n[r]=Gj(t[r],e))}function Gj(t,e){return ln(t)?t.signal?e.signalRef(t.signal):$e("Unsupported object: "+hr(t)):t}function Xj(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>Gj(t,e)))}function Qj(t){$e("Can not find data set: "+hr(t))}function Jj(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(sn(t)?Kj:t.fields?eU:tU)(t,e,n);null==e.domainMin&&null==e.domainMax||$e("No scale domain defined for domainMin/domainMax to override.")}function Kj(t,e,n){return t.map((t=>Gj(t,n)))}function tU(t,e,n){const r=n.getData(t.data);return r||Qj(t.data),ly(e.type)?r.valuesRef(n,t.field,rU(t.sort,!1)):dy(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function eU(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=ir(e)?{data:r,field:e}:sn(e)||e.signal?function(t,e){const n="_:vega:_"+Zj++,r=_j({});if(sn(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+hr(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,Ij({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(ly(e.type)?nU:dy(e.type)?iU:oU)(t,n,i)}function nU(t,e,n){const r=rU(t.sort,!0);let i,o;const a=n.map((t=>{const n=e.getData(t.data);return n||Qj(t.data),n.countsRef(e,t.field,r)})),s={groupby:JL,pulse:a};r&&(i=r.op||"count",o=r.field?ej(i,r.field):"count",s.ops=[Yj[i]],s.fields=[e.fieldRef(o)],s.as=[o]),i=e.add(vj(s));const l=e.add(_j({pulse:XL(i)}));return o=e.add(Hj({field:JL,sort:e.sortRef(r),pulse:XL(l)})),XL(o)}function rU(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!Yj[t.op]&&$e("Multiple domain scales can not be sorted using "+t.op):$e("No field provided for sort aggregate op: "+t.op):ln(t)?t.field="key":t={field:"key"}),t}function iU(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Qj(t.data),n.domainRef(e,t.field)}));return XL(e.add(Oj({values:r})))}function oU(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Qj(t.data),n.extentRef(e,t.field)}));return XL(e.add(Nj({extents:r})))}function aU(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(ir(i)){if(r&&Yn(r,i))return aU(t=Wn({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=ly(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:$e("Unrecognized scale range value: "+hr(i))}else{if(i.scheme)return n.scheme=sn(i.scheme)?Xj(i.scheme,e):Gj(i.scheme,e),i.extent&&(n.schemeExtent=Xj(i.extent,e)),void(i.count&&(n.schemeCount=Gj(i.count,e)));if(i.step)return void(n.rangeStep=Gj(i.step,e));if(ly(t.type)&&!sn(i))return Jj(i,t,e);sn(i)||$e("Unsupported range type: "+hr(i))}return i.map((t=>(sn(t)?Xj:Gj)(t,e)))}function sU(t,e,n){return sn(t)?t.map((t=>sU(t,e,n))):ln(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:$e("Unsupported parameter object: "+hr(t)):t}const lU="top",uU="left",cU="right",fU="bottom",dU="center",hU="vertical",pU="start",mU="end",gU="index",yU="label",vU="offset",bU="perc",xU="perc2",_U="value",wU="guide-label",kU="guide-title",AU="group-title",EU="group-subtitle",MU="symbol",CU="gradient",SU="discrete",DU="size",FU=[DU,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],TU={name:1,style:1,interactive:1},NU={value:0},OU={value:1},zU="group",RU="rect",PU="rule",BU="symbol",LU="text";function jU(t){return t.type=zU,t.interactive=t.interactive||!1,t}function UU(t,e){const n=(n,r)=>aj(t[n],aj(e[n],r));return n.isVertical=n=>hU===aj(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>aj(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>aj(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>aj(t.columns,aj(e.columns,+n.isVertical(!0))),n}function qU(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function IU(t,e,n){return"item.anchor === '".concat(pU,"' ? ").concat(t," : item.anchor === '").concat(mU,"' ? ").concat(e," : ").concat(n)}const WU=IU(hr(uU),hr(cU),hr(dU));function $U(t,e){return e?t?ln(t)?Object.assign({},t,{offset:$U(t.offset,e)}):{value:t,offset:e}:e:t}function HU(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=dL(t.encode,e,TU)):t.interactive=!1,t}function ZU(t,e,n,r){const i=UU(t,n),o=i.isVertical(),a=i.gradientThickness(),s=i.gradientLength();let l,u,c,f,d;o?(u=[0,1],c=[0,0],f=a,d=s):(u=[0,0],c=[1,0],f=s,d=a);const h={enter:l={opacity:NU,x:NU,y:NU,width:uL(f),height:uL(d)},update:Wn({},l,{opacity:OU,fill:{gradient:e,start:u,stop:c}}),exit:{opacity:NU}};return fL(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),HU({type:RU,role:ML,encode:h},r)}function YU(t,e,n,r,i){const o=UU(t,n),a=o.isVertical(),s=o.gradientThickness(),l=o.gradientLength();let u,c,f,d,h="";a?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:NU,fill:{scale:e,field:_U}};p[u]={signal:h+"datum."+bU,mult:l},p[c]=NU,p[f]={signal:h+"datum."+xU,mult:l},p[d]=uL(s);const m={enter:p,update:Wn({},p,{opacity:OU}),exit:{opacity:NU}};return fL(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),HU({type:RU,role:AL,key:_U,from:i,encode:m},r)}const VU="datum.".concat(bU,'<=0?"').concat(uU,'":datum.').concat(bU,'>=1?"').concat(cU,'":"').concat(dU,'"'),GU="datum.".concat(bU,'<=0?"').concat(fU,'":datum.').concat(bU,'>=1?"').concat(lU,'":"').concat("middle",'"');function XU(t,e,n,r){const i=UU(t,e),o=i.isVertical(),a=uL(i.gradientThickness()),s=i.gradientLength();let l,u,c,f,d=i("labelOverlap"),h="";const p={enter:l={opacity:NU},update:u={opacity:OU,text:{field:yU}},exit:{opacity:NU}};return fL(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:aj(t.labelLimit,e.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=u.baseline={signal:GU},c="y",f="x",h="1-"):(l.align=u.align={signal:VU},l.baseline={value:"top"},c="x",f="y"),l[c]=u[c]={signal:h+"datum."+bU,mult:s},l[f]=u[f]=a,a.offset=aj(t.labelOffset,e.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+gU}:void 0,HU({type:LU,role:CL,style:wU,key:_U,from:r,encode:p,overlap:d},n)}function QU(t,e,n,r,i){const o=UU(t,e),a=n.entries,s=!(!a||!a.interactive),l=a?a.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(vU," : datum.").concat(DU),h=u?uL(u):{field:DU},p="datum.".concat(gU),m="max(1, ".concat(i,")");let g,y,v,b,x;h.mult=.5,g={enter:y={opacity:NU,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:OU,x:y.x,y:y.y},exit:{opacity:NU}};let _=null,w=null;t.fill||(_=e.symbolBaseFillColor,w=e.symbolBaseStrokeColor),fL(g,{fill:o("symbolFillColor",_),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",w),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),FU.forEach((e=>{t[e]&&(v[e]=y[e]={scale:t[e],field:_U})}));const k=HU({type:BU,role:SL,key:_U,from:f,clip:!!u||void 0,encode:g},n.symbols),A=uL(c);A.offset=o("labelOffset"),g={enter:y={opacity:NU,x:{signal:d,offset:A},y:h},update:v={opacity:OU,text:{field:yU},x:y.x,y:y.y},exit:{opacity:NU}},fL(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const E=HU({type:LU,role:CL,style:wU,key:_U,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:NU,height:u?uL(u):NU,opacity:NU},exit:{opacity:NU},update:v={opacity:OU,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(m,")"),v.row.signal="".concat(p,"%").concat(b),v.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(v.row.signal="floor(".concat(p," / ").concat(m,")"),v.column.signal="".concat(p," % ").concat(m),x={field:p}),v.column.signal="(".concat(i,")?").concat(v.column.signal,":").concat(p),jU({role:gL,from:r={facet:{data:r,name:"value",groupby:gU}},encode:dL(g,a,TU),marks:[k,E],name:l,interactive:s,sort:x})}const JU='item.orient === "left"',KU='item.orient === "right"',tq="(".concat(JU," || ").concat(KU,")"),eq="datum.vgrad && ".concat(tq),nq=IU('"top"','"bottom"','"middle"'),rq=IU('"right"','"left"','"center"'),iq="datum.vgrad && ".concat(KU," ? (").concat(rq,") : (").concat(tq," && !(datum.vgrad && ").concat(JU,')) ? "left" : ').concat(WU),oq="item._anchor || (".concat(tq,' ? "middle" : "start")'),aq="".concat(eq," ? (").concat(JU," ? -90 : 90) : 0"),sq="".concat(tq," ? (datum.vgrad ? (").concat(KU,' ? "bottom" : "top") : ').concat(nq,') : "top"');function lq(t,e){let n;return ln(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+uq(t.path)+")":t.sphere&&(n="geoShape("+uq(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function uq(t){return ln(t)&&t.signal?t.signal:hr(t)}function cq(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===zU?gL:e||pL:e}function fq(t){return{marktype:t.type,name:t.name||void 0,role:t.role||cq(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function dq(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function hq(t,e){const n=uu(t.type);n||$e("Unrecognized transform type: "+hr(t.type));const r=VL(n.type.toLowerCase(),null,pq(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function pq(t,e,n){const r={},i=t.params.length;for(let o=0;o<i;++o){const i=t.params[o];r[i.name]=mq(i,e,n)}return r}function mq(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){ir(e.from)||$e('Lookup "from" parameter must be a string literal.');return n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(sn(r)||$e("Expected an array of sub-parameters. Instead: "+hr(r)),r.map((e=>yq(t,e,n)))):yq(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!ij(i)?i.map((e=>gq(t,e,n))):gq(t,i,n):void(t.required&&$e("Missing required "+hr(e.type)+" parameter: "+hr(t.name)))}function gq(t,e,n){const r=t.type;if(ij(e))return _q(r)?$e("Expression references can not be signals."):wq(r)?n.fieldRef(e):kq(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||wq(r);return i&&vq(e)?n.exprRef(e.expr,e.as):i&&bq(e)?QL(e.field,e.as):_q(r)?zP(e,n):xq(r)?XL(n.getData(e).values):wq(r)?QL(e):kq(r)?n.compareRef(e):e}}function yq(t,e,n){const r=t.params.length;let i;for(let a=0;a<r;++a){i=t.params[a];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||$e("Unsupported parameter: "+hr(e));const o=Wn(pq(i,e,n),i.key);return XL(n.add(Rj(o)))}const vq=t=>t&&t.expr,bq=t=>t&&t.field,xq=t=>"data"===t,_q=t=>"expr"===t,wq=t=>"field"===t,kq=t=>"compare"===t;function Aq(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:XL(e.getData(t.data).output)}function Eq(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function Mq(t){return ir(t)?t:null}function Cq(t,e,n){const r=ej(n.op,n.field);let i;if(e.ops){for(let o=0,a=e.as.length;o<a;++o)if(e.as[o]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function Sq(t,e,n,r,i,o,a){const s=e[n]||(e[n]={}),l=function(t){return ln(t)?(t.order===tj?"-":"+")+ej(t.op,t.field):""}(o);let u,c,f=Mq(i);if(null!=f&&(t=e.scope,f+=l?"|"+l:"",u=s[f]),!u){const n=o?{field:JL,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:XL(e.output)};l&&(n.sort=t.sortRef(o)),c=t.add(VL(r,void 0,n)),a&&(e.index[i]=c),u=XL(c),null!=f&&(s[f]=u)}return u}function Dq(t,e,n){const r=t.remove,i=t.insert,o=t.toggle,a=t.modify,s=t.values,l=e.add(GL()),u=zP("if("+t.trigger+',modify("'+n+'",'+[i,r,o,a,s].map((t=>null==t?"null":t)).join(",")+"),0)",e);l.update=u.$expr,l.params=u.$params}function Fq(t,e){const n=cq(t),r=t.type===zU,i=t.from&&t.from.facet,o=t.overlap;let a,s,l,u,c,f,d,h=t.layout||n===gL||n===mL;const p=n===pL||h||i,m=function(t,e,n){let r,i,o,a,s;return t?(r=t.facet)&&(e||$e("Only group marks can be faceted."),null!=r.field?a=s=Aq(r,n):(t.data?s=XL(n.getData(t.data).aggregate):(o=hq(Wn({type:"aggregate",groupby:Nn(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=Aq(r,n),a=s=XL(n.add(o))),i=n.keyRef(r.groupby,!0))):a=XL(n.add(_j(null,[{}]))),a||(a=Aq(t,n)),{key:i,pulse:a,parent:s}}(t.from,r,e);s=e.add(kj({key:m.key||(t.key?QL(t.key):void 0),pulse:m.pulse,clean:!r}));const g=XL(s);s=l=e.add(_j({pulse:g})),s=e.add(Tj({markdef:fq(t),interactive:dq(t.interactive,e),clip:lq(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:XL(s)}));const y=XL(s);s=u=e.add(Aj(UL(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=hq(t,e),r=n.metadata;(r.generates||r.changes)&&$e("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=XL(s),e.add(s=n)})),t.sort&&(s=e.add(Wj({sort:e.compareRef(t.sort),pulse:XL(s)})));const v=XL(s);(i||h)&&(h=e.add($j({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),f=XL(h));const b=e.add(xj({mark:y,pulse:f||v}));d=XL(b),r&&(p&&(a=e.operators,a.pop(),h&&a.pop()),e.pushState(v,f||d,g),i?function(t,e,n){const r=t.from.facet,i=r.name,o=Aq(r,e);let a;r.name||$e("Facet must have a name: "+hr(r)),r.data||$e("Facet must reference a data set: "+hr(r)),r.field?a=e.add(Pj({field:e.fieldRef(r.field),pulse:o})):r.groupby?a=e.add(Mj({key:e.keyRef(r.groupby),group:XL(e.proxy(n.parent)),pulse:o})):$e("Facet must specify groupby or field: "+hr(r));const s=e.fork(),l=s.add(_j()),u=s.add(Ij({pulse:XL(l)}));s.addData(i,new Eq(s,l,l,u)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(t).toRuntime()}}(t,e,m):p?function(t,e,n){const r=e.add(Pj({pulse:n.pulse})),i=e.fork();i.add(Ij()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,m):e.parse(t),e.popState(),p&&(h&&a.push(h),a.push(b))),o&&(d=function(t,e,n){const r=t.method,i=t.bound,o=t.separation,a={separation:ij(o)?n.signalRef(o.signal):o,method:ij(r)?n.signalRef(r.signal):r,pulse:e};t.order&&(a.sort=n.compareRef({field:t.order}));if(i){const t=i.tolerance;a.boundTolerance=ij(t)?n.signalRef(t.signal):+t,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return XL(n.add(zj(a)))}(o,d,e));const x=e.add(Uj({pulse:d})),_=e.add(Ij({pulse:XL(x)},void 0,e.parent()));null!=t.name&&(c=t.name,e.addData(c,new Eq(e,l,x,_)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&$e("Marks only support modify triggers."),Dq(t,e,c)})))}function Tq(t,e){const n=e.config.legend,r=t.encode||{},i=UU(t,n),o=r.legend||{},a=o.name||void 0,s=o.interactive,l=o.style,u={};let c,f,d,h=0;FU.forEach((e=>t[e]?(u[e]=t[e],h=h||t[e]):0)),h||$e("Missing valid scale for legend.");const p=function(t,e){let n=t.type||MU;t.type||1!==function(t){return FU.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=sy(e)?CU:uy(e)?SU:MU);return n!==CU?n:uy(e)?SU:CU}(t,e.scaleType(h)),m={title:null!=t.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=XL(e.add(_j(null,[m]))),y=XL(e.add(Dj(f={type:p,scale:e.scaleRef(h),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===CU?(d=[ZU(t,h,n,r.gradient),XU(t,n,r.labels,y)],f.count=f.count||e.signalRef("max(2,2*floor((".concat(sj(i.gradientLength()),")/100))"))):p===SU?d=[YU(t,h,n,r.gradient,y),XU(t,n,r.labels,y)]:(c=function(t,e){const n=UU(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),d=[QU(t,n,r,y,sj(c.columns))],f.size=function(t,e,n){const r=sj(Oq("size",t,n)),i=sj(Oq("strokeWidth",t,n)),o=sj(function(t,e,n){return qU("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r[t]}("fontSize",e,n)}(n[1].encode,e,wU));return zP("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(o,")"),e)}(t,e,d[0].marks)),d=[jU({role:EL,from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:c,interactive:s})],m.title&&d.push(function(t,e,n,r){const i=UU(t,e),o={enter:{opacity:NU},update:{opacity:OU,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:NU}};return fL(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:oq},angle:{signal:aq},align:{signal:iq},baseline:{signal:sq},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),HU({type:LU,role:DL,style:kU,from:r,encode:o},n)}(t,n,r.title,g)),Fq(jU({role:kL,from:g,encode:dL(Nq(i,t,n),o,TU),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:s,style:l}),e)}function Nq(t,e,n){const r={enter:{},update:{}};return fL(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function Oq(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):qU(t,n[0].encode)}Eq.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let o=e[0],a=null,s=1;for(o&&"load"===o.type&&(o=e[1]),t.add(e[0]);s<n;++s)e[s].params.pulse=XL(e[s-1]),t.add(e[s]),"aggregate"===e[s].type&&(a=e[s]);return new Eq(t,o,i,r,a)},Eq.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),o=Mq(e);let a,s,l;return null!=o&&(t=r.scope,a=i[o]),a?n&&n.field&&Cq(t,a.agg.params,n):(l={groupby:t.fieldRef(e,"key"),pulse:XL(r.output)},n&&n.field&&Cq(t,l,n),s=t.add(vj(l)),a=t.add(_j({pulse:XL(s)})),a={agg:s,ref:XL(a)},null!=o&&(i[o]=a)),a.ref},tuplesRef(){return XL(this.values)},extentRef(t,e){return Sq(t,this,"extent","extent",e,!1)},domainRef(t,e){return Sq(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return Sq(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return Sq(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return Sq(t,this,"indata","tupleindex",e,!0,!0)}};const zq='item.orient==="'.concat(uU,'"?-90:item.orient==="').concat(cU,'"?90:0');function Rq(t,e){const n=UU(t=ir(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},o=i.name||void 0,a=i.interactive,s=i.style,l=[],u=XL(e.add(_j(null,[{}])));return l.push(function(t,e,n,r){const i={value:0},o=t.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return fL(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),HU({type:LU,role:TL,style:AU,from:r,encode:a},n)}(t,n,function(t){const e=t.encode;return e&&e.title||Wn({name:t.name,interactive:t.interactive,style:t.style},e)}(t),u)),t.subtitle&&l.push(function(t,e,n,r){const i={value:0},o=t.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return fL(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),HU({type:LU,role:NL,style:EU,from:r,encode:a},n)}(t,n,r.subtitle,u)),Fq(jU({role:FL,from:u,encode:Pq(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),e)}function Pq(t,e){const n={enter:{},update:{}};return fL(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:WU},angle:{signal:zq},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),dL(n,e,TU)}function Bq(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(hq(t,e))})),t.on&&t.on.forEach((n=>{Dq(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,o,a,s,l,u=null,c=!1,f=!1;t.values?ij(t.values)||oj(t.format)?(r.push(jq(e,t)),r.push(u=Lq())):r.push(u=Lq({$ingest:t.values,$format:t.format})):t.url?oj(t.url)||oj(t.format)?(r.push(jq(e,t)),r.push(u=Lq())):r.push(u=Lq({$request:t.url,$format:t.format})):t.source&&(u=i=Nn(t.source).map((t=>XL(e.getData(t).output))),r.push(null));for(o=0,a=n.length;o<a;++o)s=n[o],l=s.metadata,u||l.source||r.push(u=Lq()),r.push(s),l.generates&&(f=!0),l.modifies&&!f&&(c=!0),l.source?u=s:l.changes&&(u=null);i&&(a=i.length-1,r[0]=jj({derive:c,pulse:a?i:i[0]}),(c||a)&&r.splice(1,0,Lq()));u||r.push(Lq());return r.push(Ij({})),r}(t,e,n))}function Lq(t){const e=_j({},t);return e.metadata={source:!0},e}function jq(t,e){return Fj({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const Uq=t=>t===fU||t===lU,qq=(t,e,n)=>ij(t)?Vq(t.signal,e,n):t===uU||t===lU?e:n,Iq=(t,e,n)=>ij(t)?Zq(t.signal,e,n):Uq(t)?e:n,Wq=(t,e,n)=>ij(t)?Yq(t.signal,e,n):Uq(t)?n:e,$q=(t,e,n)=>ij(t)?Gq(t.signal,e,n):t===lU?{value:e}:{value:n},Hq=(t,e,n)=>ij(t)?Xq(t.signal,e,n):t===cU?{value:e}:{value:n},Zq=(t,e,n)=>Qq("".concat(t," === '").concat(lU,"' || ").concat(t," === '").concat(fU,"'"),e,n),Yq=(t,e,n)=>Qq("".concat(t," !== '").concat(lU,"' && ").concat(t," !== '").concat(fU,"'"),e,n),Vq=(t,e,n)=>Kq("".concat(t," === '").concat(uU,"' || ").concat(t," === '").concat(lU,"'"),e,n),Gq=(t,e,n)=>Kq("".concat(t," === '").concat(lU,"'"),e,n),Xq=(t,e,n)=>Kq("".concat(t," === '").concat(cU,"'"),e,n),Qq=(t,e,n)=>(e=null!=e?uL(e):e,n=null!=n?uL(n):n,Jq(e)&&Jq(n)?(e=e?e.signal||hr(e.value):null,n=n?n.signal||hr(n.value):null,{signal:"".concat(t," ? (").concat(e,") : (").concat(n,")")}):[Wn({test:t},e)].concat(n||[])),Jq=t=>null==t||1===Object.keys(t).length,Kq=(t,e,n)=>({signal:"".concat(t," ? (").concat(eI(e),") : (").concat(eI(n),")")}),tI=(t,e,n,r,i)=>({signal:(null!=r?"".concat(t," === '").concat(uU,"' ? (").concat(eI(r),") : "):"")+(null!=n?"".concat(t," === '").concat(fU,"' ? (").concat(eI(n),") : "):"")+(null!=i?"".concat(t," === '").concat(cU,"' ? (").concat(eI(i),") : "):"")+(null!=e?"".concat(t," === '").concat(lU,"' ? (").concat(eI(e),") : "):"")+"(null)"}),eI=t=>ij(t)?t.signal:null==t?null:hr(t),nI=(t,e)=>0===e?0:ij(t)?{signal:"(".concat(t.signal,") * ").concat(e)}:{value:t*e},rI=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function iI(t,e,n,r){let i;if(e&&Yn(e,t))return e[t];if(Yn(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[kU][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[wU][i]}return null}function oI(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function aI(t,e){return{scale:t.scale,range:e}}function sI(t,e,n,r,i){const o=UU(t,e),a=t.orient,s=t.gridScale,l=qq(a,1,-1),u=function(t,e){if(1===e);else if(ln(t)){let n=t=Wn({},t);for(;null!=n.mult;){if(!ln(n.mult))return n.mult=ij(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n=n.mult=Wn({},n.mult)}n.mult=e}else t=ij(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);return t}(t.offset,l);let c,f,d;const h={enter:c={opacity:NU},update:d={opacity:OU},exit:f={opacity:NU}};fL(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:_U,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=Iq(a,{signal:"height"},{signal:"width"}),g=s?{scale:s,range:0,mult:l,offset:u}:{value:0,offset:u},y=s?{scale:s,range:1,mult:l,offset:u}:Wn(m,{mult:l,offset:u});return c.x=d.x=Iq(a,p,g),c.y=d.y=Wq(a,p,g),c.x2=d.x2=Wq(a,y),c.y2=d.y2=Iq(a,y),f.x=Iq(a,p),f.y=Wq(a,p),HU({type:PU,role:bL,key:_U,from:r,encode:h},n)}function lI(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function uI(t,e,n,r){const i=UU(t,e),o=t.orient,a=qq(o,-1,1);let s,l;const u={enter:s={opacity:NU,anchor:uL(i("titleAnchor",null)),align:{signal:WU}},update:l=Wn({},s,{opacity:OU,text:uL(t.title)}),exit:{opacity:NU}},c={signal:'lerp(range("'.concat(t.scale,'"), ').concat(IU(0,1,.5),")")};return l.x=Iq(o,c),l.y=Wq(o,c),s.angle=Iq(o,NU,nI(a,90)),s.baseline=Iq(o,$q(o,fU,lU),{value:fU}),l.angle=s.angle,l.baseline=s.baseline,fL(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=rI(uL(t),n.update[e]),!1):!hL(e,r),o=i(t("titleX"),"x"),a=i(t("titleY"),"y");n.enter.auto=a===o?uL(a):Iq(e,uL(a),uL(o))}(i,o,u,n),u.update.align=rI(u.update.align,s.align),u.update.angle=rI(u.update.angle,s.angle),u.update.baseline=rI(u.update.baseline,s.baseline),HU({type:LU,role:wL,style:kU,from:r,encode:u},n)}function cI(t,e){const n=function(t,e){var n,r,i,o=e.config,a=o.style,s=o.axis,l="band"===e.scaleType(t.scale)&&o.axisBand,u=t.orient;if(ij(u)){const t=oI([o.axisX,o.axisY]),e=oI([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},t))n[i]=Iq(u,iI(i,o.axisX,s,a),iI(i,o.axisY,s,a));for(i of(r={},e))r[i]=tI(u.signal,iI(i,o.axisTop,s,a),iI(i,o.axisBottom,s,a),iI(i,o.axisLeft,s,a),iI(i,o.axisRight,s,a))}else n=u===lU||u===fU?o.axisX:o.axisY,r=o["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||l?Wn({},s,n,r,l):s}(t,e),r=t.encode||{},i=r.axis||{},o=i.name||void 0,a=i.interactive,s=i.style,l=UU(t,n),u=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(e.signal,") === 'extent'")},ln(i)||(i={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(l),c={scale:t.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=t.title},f=XL(e.add(_j({},[c]))),d=XL(e.add(bj({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),h=[];let p;return c.grid&&h.push(sI(t,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(function(t,e,n,r,i,o){const a=UU(t,e),s=t.orient,l=qq(s,-1,1);let u,c,f;const d={enter:u={opacity:NU},update:f={opacity:OU},exit:c={opacity:NU}};fL(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=uL(i);h.mult=l;const p={scale:t.scale,field:_U,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=u.y=Iq(s,NU,p),f.y2=u.y2=Iq(s,h),c.x=Iq(s,p),f.x=u.x=Wq(s,NU,p),f.x2=u.x2=Wq(s,h),c.y=Wq(s,p),HU({type:PU,role:_L,key:_U,from:r,encode:d},n)}(t,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(function(t,e,n,r,i,o){const a=UU(t,e),s=t.orient,l=t.scale,u=qq(s,-1,1),c=sj(a("labelFlush")),f=sj(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p,m=0===c||!!c;const g=uL(i);g.mult=u,g.offset=uL(a("labelPadding")||0),g.offset.mult=u;const y={scale:l,field:_U,band:.5,offset:$U(o.offset,a("labelOffset"))},v=Iq(s,m?lI(l,c,'"left"','"right"','"center"'):{value:"center"},Hq(s,"left","right")),b=Iq(s,$q(s,"bottom","top"),m?lI(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=lI(l,c,"-(".concat(f,")"),f,0);m=m&&f;const _={opacity:NU,x:Iq(s,y,g),y:Wq(s,y,g)},w={enter:_,update:p={opacity:OU,text:{field:yU},x:_.x,y:_.y,align:v,baseline:b},exit:{opacity:NU,x:_.x,y:_.y}};fL(w,{dx:!d&&m?Iq(s,x):null,dy:!h&&m?Wq(s,x):null}),fL(w,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const k=a("labelBound");let A=a("labelOverlap");return A=A||k?{separation:a("labelSeparation"),method:A,order:"datum.index",bound:k?{scale:l,orient:s,tolerance:k}:null}:void 0,p.align!==v&&(p.align=rI(p.align,v)),p.baseline!==b&&(p.baseline=rI(p.baseline,b)),HU({type:LU,role:xL,style:wU,key:_U,from:r,encode:w,overlap:A},n)}(t,n,r.labels,d,p,u))),c.domain&&h.push(function(t,e,n,r){const i=UU(t,e),o=t.orient;let a,s;const l={enter:a={opacity:NU},update:s={opacity:OU},exit:{opacity:NU}};fL(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=aI(t,0),c=aI(t,1);return a.x=s.x=Iq(o,u,NU),a.x2=s.x2=Iq(o,c),a.y=s.y=Wq(o,u,NU),a.y2=s.y2=Wq(o,c),HU({type:PU,role:vL,from:r,encode:l},n)}(t,n,r.domain,f)),c.title&&h.push(uI(t,n,r.title,f)),Fq(jU({role:yL,from:f,encode:dL(fI(l,t),i,TU),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:a,style:s}),e)}function fI(t,e){const n={enter:{},update:{}};return fL(n,{orient:t("orient"),offset:t("offset")||0,position:aj(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function dI(t,e,n){const r=Nn(t.signals),i=Nn(t.scales);return n||r.forEach((t=>ZL(t,e))),Nn(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=sU(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=sU(n[i],i,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";oy(n)||$e("Unrecognized scale type: "+hr(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),Nn(t.data).forEach((t=>Bq(t,e))),i.forEach((t=>Vj(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?$e("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=zP(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>mj(t,e,n.id)))}(t,e))),Nn(t.axes).forEach((t=>cI(t,e))),Nn(t.marks).forEach((t=>Fq(t,e))),Nn(t.legends).forEach((t=>Tq(t,e))),t.title&&Rq(t.title,e),e.parseLambdas(),e}const hI=t=>dL({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function pI(t,e){const n=e.config,r=XL(e.root=e.add(GL())),i=function(t,e){const n=n=>aj(t[n],e[n]),r=[mI("background",n("background")),mI("autosize",oL(n("autosize"))),mI("padding",lL(n("padding"))),mI("width",n("width")||0),mI("height",n("height")||0)],i=r.reduce(((t,e)=>(t[e.name]=e,t)),{}),o={};return Nn(t.signals).forEach((t=>{Yn(i,t.name)?t=Wn(i[t.name],t):r.push(t),o[t.name]=t})),Nn(e.signals).forEach((t=>{Yn(o,t.name)||Yn(i,t.name)||r.push(t)})),r}(t,n);i.forEach((t=>ZL(t,e))),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const o=e.add(_j()),a=e.add(Aj(UL(hI(t.encode),zU,mL,t.style,e,{pulse:XL(o)}))),s=e.add($j({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:XL(a)}));e.operators.pop(),e.pushState(XL(a),XL(s),null),dI(t,e,i),e.operators.push(s);let l=e.add(xj({mark:r,pulse:XL(s)}));return l=e.add(Uj({pulse:XL(l)})),l=e.add(Ij({pulse:XL(l)})),e.addData("root",new Eq(e,o,o,l)),e}function mI(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function gI(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function yI(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function vI(t){return(sn(t)?bI:xI)(t)}function bI(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(ln(e)?e.signal||vI(e):hr(e))}return n+"]"}function xI(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+hr(e)+":"+(ln(n)?n.signal||vI(n):hr(n));return r+"}"}function _I(t,e,n){return ln(t)||$e("Input Vega specification must be an object."),e=cn(function(){const t="sans-serif",e="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:e},area:{fill:e},image:null,line:{stroke:e,strokeWidth:2},path:{stroke:e},rect:{fill:e},rule:{stroke:n},shape:{stroke:e},symbol:{fill:e,size:64},text:{fill:n,font:t,fontSize:11},trail:{fill:e,size:2},style:{"guide-label":{fill:n,font:t,fontSize:10},"guide-title":{fill:n,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),e,t.config),pI(t,new gI(e,n)).toRuntime()}gI.prototype=yI.prototype={parse(t){return dI(t,this)},fork(){return new yI(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof YL?XL(t):t;return this.add(Lj({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(XL(this.add(Ij({pulse:t})))),this._parent.push(e),this._lookup.push(n?XL(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return hn(this._parent)},encode(){return hn(this._encode)},lookup(){return hn(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(ir(t))return QL(t,e);t.signal||$e("Unsupported field reference: "+hr(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=XL(this.add(Cj(t)))}return r},compareRef(t){let e=!1;const n=t=>ij(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=Nn(t.field).map(n),i=Nn(t.order).map(n);return e?XL(this.add(wj({fields:r,orders:i}))):KL(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=Nn(t).map((t=>ij(t)?(n=!0,XL(r[t.signal])):t)),n?XL(this.add(Sj({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=ej(t.op,t.field),n=t.order||"ascending";return n.signal?XL(this.add(wj({fields:e,orders:this.signalRef(n.signal)}))):KL(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return Yn(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&$e("Duplicate signal name: "+hr(t));const n=e instanceof YL?e:this.add(GL(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||$e("Unrecognized signal name: "+hr(t)),this.signals[t]},signalRef(t){return this.signals[t]?XL(this.signals[t]):(Yn(this.lambdas,t)||(this.lambdas[t]=this.add(GL(null))),XL(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=zP(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&ln(t)?this.signalRef(t.signal||vI(t)):t},exprRef(t,e){const n={expr:zP(t,this)};return e&&(n.expr.$name=e),XL(this.add(Ej(n)))},addBinding(t,e){this.bindings||$e("Nested signals do not support binding: "+hr(t)),this.bindings.push(Wn({signal:t},e))},addScaleProj(t,e){Yn(this.scales,t)&&$e("Duplicate scale or projection name: "+hr(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,qj(e))},addProjection(t,e){this.addScaleProj(t,Bj(e))},getScale(t){return this.scales[t]||$e("Unrecognized scale name: "+hr(t)),this.scales[t]},scaleRef(t){return XL(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return Yn(this.data,t)&&$e("Duplicate data set name: "+hr(t)),this.data[t]=e},getData(t){return this.data[t]||$e("Undefined data set name: "+hr(t)),this.data[t]},addDataPipeline(t,e){return Yn(this.data,t)&&$e("Duplicate data set name: "+hr(t)),this.addData(t,Eq.fromEntries(this,e))}};var wI="5.27.0";Wn(lu,r,o,a,s,l,c,u,f,d,h,p);var kI={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},AI={"*":(t,e)=>t*e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,">":(t,e)=>t>e,"<":(t,e)=>t<e,"<=":(t,e)=>t<=e,">=":(t,e)=>t>=e,"==":(t,e)=>t==e,"!=":(t,e)=>t!=e,"===":(t,e)=>t===e,"!==":(t,e)=>t!==e,"&":(t,e)=>t&e,"|":(t,e)=>t|e,"^":(t,e)=>t^e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e},EI={"+":t=>+t,"-":t=>-t,"~":t=>~t,"!":t=>!t};const MI=Array.prototype.slice,CI=(t,e,n)=>{const r=n?n(e[0]):e[0];return r[t].apply(r,MI.call(e,1))};var SI={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(t,e,n)=>Math.max(e,Math.min(n,t)),now:Date.now,utc:Date.UTC,datetime:(t,e,n,r,i,o,a)=>new Date(t,e||0,null!=n?n:1,r||0,i||0,o||0,a||0),date:t=>new Date(t).getDate(),day:t=>new Date(t).getDay(),year:t=>new Date(t).getFullYear(),month:t=>new Date(t).getMonth(),hours:t=>new Date(t).getHours(),minutes:t=>new Date(t).getMinutes(),seconds:t=>new Date(t).getSeconds(),milliseconds:t=>new Date(t).getMilliseconds(),time:t=>new Date(t).getTime(),timezoneoffset:t=>new Date(t).getTimezoneOffset(),utcdate:t=>new Date(t).getUTCDate(),utcday:t=>new Date(t).getUTCDay(),utcyear:t=>new Date(t).getUTCFullYear(),utcmonth:t=>new Date(t).getUTCMonth(),utchours:t=>new Date(t).getUTCHours(),utcminutes:t=>new Date(t).getUTCMinutes(),utcseconds:t=>new Date(t).getUTCSeconds(),utcmilliseconds:t=>new Date(t).getUTCMilliseconds(),length:t=>t.length,join:function(){return CI("join",arguments)},indexof:function(){return CI("indexOf",arguments)},lastindexof:function(){return CI("lastIndexOf",arguments)},slice:function(){return CI("slice",arguments)},reverse:t=>t.slice().reverse(),parseFloat:parseFloat,parseInt:parseInt,upper:t=>String(t).toUpperCase(),lower:t=>String(t).toLowerCase(),substring:function(){return CI("substring",arguments,String)},split:function(){return CI("split",arguments,String)},replace:function(){return CI("replace",arguments,String)},trim:t=>String(t).trim(),regexp:RegExp,test:(t,e)=>RegExp(t).test(e)};const DI=["view","item","group","xy","x","y"],FI=new Set([Function,eval,setTimeout,setInterval]);"function"===typeof setImmediate&&FI.add(setImmediate);const TI={Literal:(t,e)=>e.value,Identifier:(t,e)=>{const n=e.name;return t.memberDepth>0?n:"datum"===n?t.datum:"event"===n?t.event:"item"===n?t.item:kI[n]||t.params["$"+n]},MemberExpression:(t,e)=>{const n=!e.computed,r=t(e.object);n&&(t.memberDepth+=1);const i=t(e.property);if(n&&(t.memberDepth-=1),!FI.has(r[i]))return r[i];console.error('Prevented interpretation of member "'.concat(i,'" which could lead to insecure code execution'))},CallExpression:(t,e)=>{const n=e.arguments;let r=e.callee.name;return r.startsWith("_")&&(r=r.slice(1)),"if"===r?t(n[0])?t(n[1]):t(n[2]):(t.fn[r]||SI[r]).apply(t.fn,n.map(t))},ArrayExpression:(t,e)=>e.elements.map(t),BinaryExpression:(t,e)=>AI[e.operator](t(e.left),t(e.right)),UnaryExpression:(t,e)=>EI[e.operator](t(e.argument)),ConditionalExpression:(t,e)=>t(e.test)?t(e.consequent):t(e.alternate),LogicalExpression:(t,e)=>"&&"===e.operator?t(e.left)&&t(e.right):t(e.left)||t(e.right),ObjectExpression:(t,e)=>e.properties.reduce(((e,n)=>{t.memberDepth+=1;const r=t(n.key);return t.memberDepth-=1,FI.has(t(n.value))?console.error('Prevented interpretation of property "'.concat(r,'" which could lead to insecure code execution')):e[r]=t(n.value),e}),{})};function NI(t,e,n,r,i,o){const a=t=>TI[t.type](a,t);return a.memberDepth=0,a.fn=Object.create(e),a.params=n,a.datum=r,a.event=i,a.item=o,DI.forEach((t=>a.fn[t]=function(){return i.vega[t](...arguments)})),a(t)}var OI={operator(t,e){const n=e.ast,r=t.functions;return t=>NI(n,r,t)},parameter(t,e){const n=e.ast,r=t.functions;return(t,e)=>NI(n,r,e,t)},event(t,e){const n=e.ast,r=t.functions;return t=>NI(n,r,void 0,void 0,t)},handler(t,e){const n=e.ast,r=t.functions;return(t,e)=>{const i=e.item&&e.item.datum;return NI(n,r,t,i,e)}},encode(t,e){const{marktype:n,channels:r}=e,i=t.functions,o="group"===n||"image"===n||"rect"===n;return(t,e)=>{const a=t.datum;let s,l=0;for(const n in r)s=NI(r[n].ast,i,e,a,void 0,t),t[n]!==s&&(t[n]=s,l=1);return"rule"!==n&&function(t,e,n){let r;e.x2&&(e.x?(n&&t.x>t.x2&&(r=t.x,t.x=t.x2,t.x2=r),t.width=t.x2-t.x):t.x=t.x2-(t.width||0)),e.xc&&(t.x=t.xc-(t.width||0)/2),e.y2&&(e.y?(n&&t.y>t.y2&&(r=t.y,t.y=t.y2,t.y2=r),t.height=t.y2-t.y):t.y=t.y2-(t.height||0)),e.yc&&(t.y=t.yc-(t.height||0)/2)}(t,r,o),l}}};function zI(t){return!!t.or}function RI(t){return!!t.and}function PI(t){return!!t.not}function BI(t,e){if(PI(t))BI(t.not,e);else if(RI(t))for(const n of t.and)BI(n,e);else if(zI(t))for(const n of t.or)BI(n,e);else e(t)}function LI(t,e){return PI(t)?{not:LI(t.not,e)}:RI(t)?{and:t.and.map((t=>LI(t,e)))}:zI(t)?{or:t.or.map((t=>LI(t,e)))}:e(t)}const jI=structuredClone;function UI(t){throw new Error(t)}function qI(t,e){const n={};for(const r of e)Yn(t,r)&&(n[r]=t[r]);return n}function II(t,e){const n={...t};for(const r of e)delete n[r];return n}function WI(t){if(nr(t))return t;const e=ir(t)?t:SW(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++){n=(n<<5)-n+e.charCodeAt(r),n&=n}return n}function $I(t){return!1===t||null===t}function HI(t,e){return t.includes(e)}function ZI(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function YI(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function VI(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)GI(t,null!==i&&void 0!==i?i:{});return t}function GI(t,e){for(const n of rW(e))fn(t,n,e[n],!0)}function XI(t,e){const n=[],r={};let i;for(const o of t)i=e(o),i in r||(r[i]=1,n.push(o));return n}function QI(t,e){const n=rW(t),r=rW(e);if(n.length!==r.length)return!1;for(const i of n)if(t[i]!==e[i])return!1;return!0}function JI(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function KI(t,e){for(const n of t)if(e.has(n))return!0;return!1}function tW(t){const e=new Set;for(const n of t){const t=He(n).map(((t,e)=>0===e?t:"[".concat(t,"]"))),r=t.map(((e,n)=>t.slice(0,n+1).join("")));for(const n of r)e.add(n)}return e}function eW(t,e){return void 0===t||void 0===e||KI(tW(t),tW(e))}function nW(t){return 0===rW(t).length}Set.prototype.toJSON=function(){return"Set(".concat([...this].map((t=>SW(t))).join(","),")")};const rW=Object.keys,iW=Object.values,oW=Object.entries;function aW(t){return!0===t||!1===t}function sW(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function lW(t,e){return PI(t)?"!(".concat(lW(t.not,e),")"):RI(t)?"(".concat(t.and.map((t=>lW(t,e))).join(") && ("),")"):zI(t)?"(".concat(t.or.map((t=>lW(t,e))).join(") || ("),")"):e(t)}function uW(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&uW(t[n],e)&&delete t[n],nW(t)}function cW(t){return t.charAt(0).toUpperCase()+t.substr(1)}function fW(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";const n=He(t),r=[];for(let i=1;i<=n.length;i++){const t="[".concat(n.slice(0,i).map(hr).join("]["),"]");r.push("".concat(e).concat(t))}return r.join(" && ")}function dW(t){return"".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum","[").concat(hr(He(t).join(".")),"]")}function hW(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function pW(t){return"".concat(He(t).map(hW).join("\\."))}function mW(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function gW(t){return"".concat(He(t).join("."))}function yW(t){return t?He(t).length:0}function vW(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)if(void 0!==r)return r}let bW=42;function xW(t){const e=++bW;return t?String(t)+e:e}function _W(){bW=42}function wW(t){return kW(t)?t:"__".concat(t)}function kW(t){return t.startsWith("__")}function AW(t){if(void 0!==t)return(t%360+360)%360}function EW(t){return!!nr(t)||!isNaN(t)&&!isNaN(parseFloat(t))}const MW=Object.getPrototypeOf(structuredClone({}));function CW(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){if(t.constructor.name!==e.constructor.name)return!1;let n,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;0!==r--;)if(!CW(t[r],e[r]))return!1;return!0}if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(r of t.entries())if(!e.has(r[0]))return!1;for(r of t.entries())if(!CW(r[1],e.get(r[0])))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(r of t.entries())if(!e.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(r=n;0!==r--;)if(t[r]!==e[r])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&t.valueOf!==MW.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&t.toString!==MW.toString)return t.toString()===e.toString();const i=Object.keys(t);if(n=i.length,n!==Object.keys(e).length)return!1;for(r=n;0!==r--;)if(!Object.prototype.hasOwnProperty.call(e,i[r]))return!1;for(r=n;0!==r--;){const n=i[r];if(!CW(t[n],e[n]))return!1}return!0}return t!==t&&e!==e}function SW(t){const e=[];return function t(n){if(n&&n.toJSON&&"function"===typeof n.toJSON&&(n=n.toJSON()),void 0===n)return;if("number"==typeof n)return isFinite(n)?""+n:"null";if("object"!==typeof n)return JSON.stringify(n);let r,i;if(Array.isArray(n)){for(i="[",r=0;r<n.length;r++)r&&(i+=","),i+=t(n[r])||"null";return i+"]"}if(null===n)return"null";if(e.includes(n))throw new TypeError("Converting circular structure to JSON");const o=e.push(n)-1,a=Object.keys(n).sort();for(i="",r=0;r<a.length;r++){const e=a[r],o=t(n[e]);o&&(i&&(i+=","),i+=JSON.stringify(e)+":"+o)}return e.splice(o,1),"{".concat(i,"}")}(t)}const DW="row",FW="column",TW="facet",NW="x",OW="y",zW="x2",RW="y2",PW="xOffset",BW="yOffset",LW="radius",jW="radius2",UW="theta",qW="theta2",IW="latitude",WW="longitude",$W="latitude2",HW="longitude2",ZW="color",YW="fill",VW="stroke",GW="shape",XW="size",QW="angle",JW="opacity",KW="fillOpacity",t$="strokeOpacity",e$="strokeWidth",n$="strokeDash",r$="text",i$="order",o$="detail",a$="key",s$="tooltip",l$="href",u$="url",c$="description",f$={theta:1,theta2:1,radius:1,radius2:1};function d$(t){return t in f$}const h$={longitude:1,longitude2:1,latitude:1,latitude2:1};function p$(t){switch(t){case IW:return"y";case $W:return"y2";case WW:return"x";case HW:return"x2"}}function m$(t){return t in h$}const g$=rW(h$),y$={x:1,y:1,x2:1,y2:1,...f$,...h$,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function v$(t){return t===ZW||t===YW||t===VW}const b$={row:1,column:1,facet:1},x$=rW(b$),_$={...y$,...b$},w$=rW(_$),{order:k$,detail:A$,tooltip:E$,...M$}=_$,{row:C$,column:S$,facet:D$,...F$}=M$;rW(M$),rW(F$);function T$(t){return!!_$[t]}const N$=[zW,RW,$W,HW,qW,jW];function O$(t){return z$(t)!==t}function z$(t){switch(t){case zW:return NW;case RW:return OW;case $W:return IW;case HW:return WW;case qW:return UW;case jW:return LW}return t}function R$(t){if(d$(t))switch(t){case UW:return"startAngle";case qW:return"endAngle";case LW:return"outerRadius";case jW:return"innerRadius"}return t}function P$(t){switch(t){case NW:return zW;case OW:return RW;case IW:return $W;case WW:return HW;case UW:return qW;case LW:return jW}}function B$(t){switch(t){case NW:case zW:return"width";case OW:case RW:return"height"}}function L$(t){switch(t){case NW:return"xOffset";case OW:return"yOffset";case zW:return"x2Offset";case RW:return"y2Offset";case UW:return"thetaOffset";case LW:return"radiusOffset";case qW:return"theta2Offset";case jW:return"radius2Offset"}}function j$(t){switch(t){case NW:return"xOffset";case OW:return"yOffset"}}function U$(t){switch(t){case"xOffset":return"x";case"yOffset":return"y"}}const q$=rW(y$),{x:I$,y:W$,x2:$$,y2:H$,xOffset:Z$,yOffset:Y$,latitude:V$,longitude:G$,latitude2:X$,longitude2:Q$,theta:J$,theta2:K$,radius:tH,radius2:eH,...nH}=y$,rH=rW(nH),iH={x:1,y:1},oH=rW(iH);function aH(t){return t in iH}const sH={theta:1,radius:1},lH=rW(sH);function uH(t){return"width"===t?NW:OW}const cH={xOffset:1,yOffset:1};rW(cH);function fH(t){return t in cH}const{text:dH,tooltip:hH,href:pH,url:mH,description:gH,detail:yH,key:vH,order:bH,...xH}=nH,_H=rW(xH);const wH={...iH,...sH,...cH,...xH},kH=rW(wH);function AH(t){return!!wH[t]}function EH(t,e){return function(t){switch(t){case ZW:case YW:case VW:case c$:case o$:case a$:case s$:case l$:case i$:case JW:case KW:case t$:case e$:case TW:case DW:case FW:return MH;case NW:case OW:case PW:case BW:case IW:case WW:return SH;case zW:case RW:case $W:case HW:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case XW:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case n$:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case GW:return{point:"always",geoshape:"always"};case r$:return{text:"always"};case QW:return{point:"always",square:"always",text:"always"};case u$:return{image:"always"};case UW:case LW:return{text:"always",arc:"always"};case qW:case jW:return{arc:"always"}}}(t)[e]}const MH={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:CH,...SH}=MH;function DH(t){switch(t){case NW:case OW:case UW:case LW:case PW:case BW:case XW:case QW:case e$:case JW:case KW:case t$:case zW:case RW:case qW:case jW:return;case TW:case DW:case FW:case GW:case n$:case r$:case s$:case l$:case u$:case c$:return"discrete";case ZW:case YW:case VW:return"flexible";case IW:case WW:case $W:case HW:case o$:case a$:case i$:return}}const FH={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},TH={count:1,min:1,max:1};function NH(t){return!!t&&!!t.argmin}function OH(t){return!!t&&!!t.argmax}function zH(t){return ir(t)&&!!FH[t]}const RH=new Set(["count","valid","missing","distinct"]);function PH(t){return ir(t)&&RH.has(t)}const BH=new Set(["count","sum","distinct","valid","missing"]),LH=new Set(["mean","average","median","q1","q3","min","max"]);function jH(t){return Kn(t)&&(t=QG(t,void 0)),"bin"+rW(t).map((e=>WH(t[e])?sW("_".concat(e,"_").concat(oW(t[e]))):sW("_".concat(e,"_").concat(t[e])))).join("")}function UH(t){return!0===t||IH(t)&&!t.binned}function qH(t){return"binned"===t||IH(t)&&!0===t.binned}function IH(t){return ln(t)}function WH(t){return null===t||void 0===t?void 0:t.param}function $H(t){switch(t){case DW:case FW:case XW:case ZW:case YW:case VW:case e$:case JW:case KW:case t$:case GW:return 6;case n$:return 4;default:return 10}}function HH(t){return!(null===t||void 0===t||!t.expr)}function ZH(t){const e=rW(t||{}),n={};for(const r of e)n[r]=nZ(t[r]);return n}function YH(t){const{anchor:e,frame:n,offset:r,orient:i,angle:o,limit:a,color:s,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...m}=t,g={...e?{anchor:e}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...void 0!==o?{angle:o}:{},...void 0!==a?{limit:a}:{}},y={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}};return{titleMarkConfig:{...m,...s?{fill:s}:{}},subtitleMarkConfig:qI(t,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:g,subtitle:y}}function VH(t){return ir(t)||sn(t)&&ir(t[0])}function GH(t){return!(null===t||void 0===t||!t.signal)}function XH(t){return!!t.step}function QH(t){return!sn(t)&&("field"in t&&"data"in t)}const JH=rW({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),KH={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},tZ=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function eZ(t){const e=sn(t.condition)?t.condition.map(rZ):rZ(t.condition);return{...nZ(t),condition:e}}function nZ(t){if(HH(t)){const{expr:e,...n}=t;return{signal:e,...n}}return t}function rZ(t){if(HH(t)){const{expr:e,...n}=t;return{signal:e,...n}}return t}function iZ(t){if(HH(t)){const{expr:e,...n}=t;return{signal:e,...n}}return GH(t)?t:void 0!==t?{value:t}:void 0}function oZ(t){return GH(t)?t.signal:hr(t)}function aZ(t){return GH(t)?t.signal:hr(t.value)}function sZ(t){return GH(t)?t.signal:null==t?null:hr(t)}function lZ(t,e,n){for(const r of n){const n=fZ(r,e.markDef,e.config);void 0!==n&&(t[r]=iZ(n))}return t}function uZ(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function cZ(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!o||i&&i!==t?fZ(t,e,n,r):void 0}function fZ(t,e,n){let{vgChannel:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return vW(r?dZ(t,e,n.style):void 0,dZ(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function dZ(t,e,n){return hZ(t,uZ(e),n)}function hZ(t,e,n){let r;e=Nn(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function pZ(t,e){return Nn(t).reduce(((t,n)=>{var r;return t.field.push(BG(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t}),{field:[],order:[]})}function mZ(t,e){const n=[...t];return e.forEach((t=>{for(const e of n)if(CW(e,t))return;n.push(t)})),n}function gZ(t,e){return CW(t,e)||!e?t:t?[...Nn(t),...Nn(e)].join(", "):e}function yZ(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((VH(n)||GH(n))&&(VH(r)||GH(r)))return{explicit:t.explicit,value:gZ(n,r)};if(VH(n)||GH(n))return{explicit:t.explicit,value:n};if(VH(r)||GH(r))return{explicit:t.explicit,value:r};if(!VH(n)&&!GH(n)&&!VH(r)&&!GH(r))return{explicit:t.explicit,value:mZ(n,r)};throw new Error("It should never reach here")}function vZ(t){return"Invalid specification ".concat(SW(t),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}const bZ='Autosize "fit" only works for single views and layered views.';function xZ(t){return"".concat("width"==t?"Width":"Height",' "container" only works for single views and layered views.')}function _Z(t){const e="width"==t?"x":"y";return"".concat("width"==t?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat(e,'".')}function wZ(t){return t?'Dropping "fit-'.concat(t,'" because spec has discrete ').concat(B$(t),"."):'Dropping "fit" because spec has discrete size.'}function kZ(t){return"Unknown field for ".concat(t,". Cannot calculate view size.")}function AZ(t){return'Cannot project a selection on encoding channel "'.concat(t,'", which has no field.')}function EZ(t,e){return'Cannot project a selection on encoding channel "'.concat(t,'" as it uses an aggregate function ("').concat(e,'").')}function MZ(t){return"Selection not supported for ".concat(t," yet.")}const CZ="The same selection must be used to override scale domains in a layered view.";function SZ(t){return'The "columns" property cannot be used when "'.concat(t,'" has nested row/column.')}function DZ(t,e,n){return'An ancestor parsed field "'.concat(t,'" as ').concat(n," but a child wants to parse the field as ").concat(e,".")}function FZ(t){return"Ignoring an invalid transform: ".concat(SW(t),".")}function TZ(t){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(t," are dropped.")}function NZ(t){return"".concat(t,"Offset dropped because ").concat(t," is continuous")}function OZ(t){return'Invalid field type "'.concat(t,'".')}function zZ(t,e){const{fill:n,stroke:r}=e;return"Dropping color ".concat(t," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function RZ(t,e){return"Dropping ".concat(SW(t),' from channel "').concat(e,'" since it does not contain any data field, datum, value, or signal.')}function PZ(t,e,n){return"".concat(t,' dropped as it is incompatible with "').concat(e,'"').concat(n?" when ".concat(n):"",".")}function BZ(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned).")}function LZ(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).")}function jZ(t,e){return'Using discrete channel "'.concat(t,'" to encode "').concat(e,'" field can be misleading as it does not encode ').concat("ordinal"===e?"order":"magnitude",".")}function UZ(t){return"Using unaggregated domain with raw field has no effect (".concat(SW(t),").")}function qZ(t){return'Unaggregated domain not applicable for "'.concat(t,'" since it produces values outside the origin domain of the source data.')}function IZ(t){return"Unaggregated domain is currently unsupported for log scale (".concat(SW(t),").")}function WZ(t,e,n){return"".concat(n,"-scale's \"").concat(e,'" is dropped as it does not work with ').concat(t," scale.")}function $Z(t){return'The step for "'.concat(t,'" is dropped because the ').concat("width"===t?"x":"y"," is continuous.")}const HZ="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function ZZ(t,e){return"Invalid ".concat(t,": ").concat(SW(e),".")}function YZ(t){return"1D error band does not support ".concat(t,".")}function VZ(t){return"Channel ".concat(t,' is required for "binned" bin.')}const GZ=an(nn);let XZ=GZ;function QZ(){return XZ=GZ,XZ}function JZ(){XZ.warn(...arguments)}function KZ(t){if(t&&ln(t))for(const e of sY)if(e in t)return!0;return!1}new WeakMap;const tY=["january","february","march","april","may","june","july","august","september","october","november","december"],eY=tY.map((t=>t.substr(0,3))),nY=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],rY=nY.map((t=>t.substr(0,3)));function iY(t,e){const n=[];if(e&&void 0!==t.day&&rW(t).length>1&&(JZ(function(t){return"Dropping day from datetime ".concat(SW(t)," as day cannot be combined with other units.")}(t)),delete(t=jI(t)).day),void 0!==t.year?n.push(t.year):n.push(2012),void 0!==t.month){const r=e?function(t){if(EW(t)&&(t=+t),nr(t))return t-1;{const e=t.toLowerCase(),n=tY.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=eY.indexOf(r);if(-1!==i)return i;throw new Error(ZZ("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(EW(t)&&(t=+t),nr(t))return t>4&&JZ(ZZ("quarter",t)),t-1;throw new Error(ZZ("quarter",t))}(t.quarter):t.quarter;n.push(nr(r)?3*r:"".concat(r,"*3"))}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(EW(t)&&(t=+t),nr(t))return t%7;{const e=t.toLowerCase(),n=nY.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=rY.indexOf(r);if(-1!==i)return i;throw new Error(ZZ("day",t))}}(t.day):t.day;n.push(nr(r)?r+1:"".concat(r,"+1"))}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const e=t[r];n.push("undefined"===typeof e?0:e)}return n}function oY(t){const e=iY(t,!0).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}const aY={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},sY=rW(aY);function lY(t){return ln(t)?t.binned:uY(t)}function uY(t){return t&&t.startsWith("binned")}function cY(t){return t.startsWith("utc")}const fY={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function dY(t){return sY.filter((e=>pY(t,e)))}function hY(t){const e=dY(t);return e[e.length-1]}function pY(t,e){const n=t.indexOf(e);return!(n<0)&&(!(n>0&&"seconds"===e&&"i"===t.charAt(n-1))&&(!(t.length>n+3&&"day"===e&&"o"===t.charAt(n+3))&&!(n>0&&"year"===e&&"f"===t.charAt(n-1))))}function mY(t,e){let{end:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1};const r=fW(e),i=cY(t)?"utc":"";let o;const a={};for(const l of sY)pY(t,l)&&(a[l]="quarter"===(s=l)?"(".concat(i,"quarter(").concat(r,")-1)"):"".concat(i).concat(s,"(").concat(r,")"),o=l);var s;return n&&(a[o]+="+1"),function(t){const e=iY(t,!1).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}(a)}function gY(t){if(!t)return;const e=dY(t);return"timeUnitSpecifier(".concat(SW(e),", ").concat(SW(fY),")")}function yY(t){if(!t)return;let e;return ir(t)?e=uY(t)?{unit:t.substring(6),binned:!0}:{unit:t}:ln(t)&&(e={...t,...t.unit?{unit:t.unit}:{}}),cY(e.unit)&&(e.utc=!0,e.unit=function(t){return t.substring(3)}(e.unit)),e}function vY(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>t;const n=yY(t),r=hY(n.unit);if(r&&"day"!==r){const t={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:i,part:o}=xY(r,n.step),a={...t,[o]:+t[o]+i};return"".concat(e(oY(a))," - ").concat(e(oY(t)))}}const bY={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function xY(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(function(t){return!!bY[t]}(t))return{part:t,step:e};switch(t){case"day":case"dayofyear":return{part:"date",step:e};case"quarter":return{part:"month",step:3*e};case"week":return{part:"date",step:7*e}}}function _Y(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.equal}function wY(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.lt}function kY(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.lte}function AY(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.gt}function EY(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.gte}function MY(t){if(null!==t&&void 0!==t&&t.field){if(sn(t.range)&&2===t.range.length)return!0;if(GH(t.range))return!0}return!1}function CY(t){return!(null===t||void 0===t||!t.field)&&(sn(t.oneOf)||sn(t.in))}function SY(t){return CY(t)||_Y(t)||MY(t)||wY(t)||AY(t)||kY(t)||EY(t)}function DY(t,e){return tX(t,{timeUnit:e,wrapTime:!0})}function FY(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{field:n}=t,r=yY(t.timeUnit),{unit:i,binned:o}=r||{},a=BG(t,{expr:"datum"}),s=i?"time(".concat(o?a:mY(i,n),")"):a;if(_Y(t))return"".concat(s,"===").concat(DY(t.equal,i));if(wY(t)){const e=t.lt;return"".concat(s,"<").concat(DY(e,i))}if(AY(t)){const e=t.gt;return"".concat(s,">").concat(DY(e,i))}if(kY(t)){const e=t.lte;return"".concat(s,"<=").concat(DY(e,i))}if(EY(t)){const e=t.gte;return"".concat(s,">=").concat(DY(e,i))}if(CY(t))return"indexof([".concat(function(t,e){return t.map((t=>DY(t,e)))}(t.oneOf,i).join(","),"], ").concat(s,") !== -1");if(function(t){return!(null===t||void 0===t||!t.field)&&void 0!==t.valid}(t))return TY(s,t.valid);if(MY(t)){const{range:n}=t,r=GH(n)?{signal:"".concat(n.signal,"[0]")}:n[0],o=GH(n)?{signal:"".concat(n.signal,"[1]")}:n[1];if(null!==r&&null!==o&&e)return"inrange("+s+", ["+DY(r,i)+", "+DY(o,i)+"])";const a=[];return null!==r&&a.push("".concat(s," >= ").concat(DY(r,i))),null!==o&&a.push("".concat(s," <= ").concat(DY(o,i))),a.length>0?a.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(SW(t)))}function TY(t){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?"isValid(".concat(t,") && isFinite(+").concat(t,")"):"!isValid(".concat(t,") || !isFinite(+").concat(t,")")}function NY(t){return SY(t)&&t.timeUnit?{...t,timeUnit:yY(t.timeUnit)}:t}const OY={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function zY(t){return"quantitative"===t||"temporal"===t}function RY(t){return"ordinal"===t||"nominal"===t}const PY=OY.quantitative,BY=OY.ordinal,LY=OY.temporal,jY=OY.nominal,UY=OY.geojson;rW(OY);const qY={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},IY={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};rW(IY);function WY(t,e){const n=IY[t],r=IY[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const $Y={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function HY(t){return $Y[t]}const ZY=new Set(["linear","log","pow","sqrt","symlog"]),YY=new Set([...ZY,"time","utc"]);function VY(t){return ZY.has(t)}const GY=new Set(["quantile","quantize","threshold"]),XY=new Set([...YY,...GY,"sequential","identity"]),QY=new Set(["ordinal","bin-ordinal","point","band"]);new Set(["time","utc"]);function JY(t){return QY.has(t)}function KY(t){return XY.has(t)}function tV(t){return YY.has(t)}function eV(t){return GY.has(t)}function nV(t){return null===t||void 0===t?void 0:t.param}const rV={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:iV,domain:oV,range:aV,rangeMax:sV,rangeMin:lV,scheme:uV,...cV}=(rW(rV),rV),fV=rW(cV);function dV(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(t);case"bins":return!["point","band","identity","ordinal"].includes(t);case"round":return tV(t)||"band"===t||"point"===t;case"padding":case"rangeMin":case"rangeMax":return tV(t)||["point","band"].includes(t);case"paddingOuter":case"align":return["point","band"].includes(t);case"paddingInner":return"band"===t;case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return tV(t);case"nice":return tV(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return KY(t)&&!HI(["log","time","utc","threshold","quantile"],t)}}function hV(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return v$(t)?void 0:'Cannot use the scale property "'.concat(e,'" with non-color channel.');case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const pV={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},mV=pV.arc,gV=pV.area,yV=pV.bar,vV=pV.image,bV=pV.line,xV=pV.point,_V=pV.rect,wV=pV.rule,kV=pV.text,AV=pV.tick,EV=pV.trail,MV=pV.circle,CV=pV.square,SV=pV.geoshape;function DV(t){return["line","area","trail"].includes(t)}function FV(t){return["rect","bar","image","arc"].includes(t)}const TV=new Set(rW(pV));function NV(t){return t.type}const OV=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],zV=rW({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),RV=rW({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function PV(t){return t&&void 0!=t.band}const BV={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},LV={binSpacing:1,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5},jV={binSpacing:0,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5};function UV(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:o}=t,a=HV(t);return kG(n)&&!PH(n.aggregate)&&i&&tV(i.get("type"))?function(t){let{fieldDef:e,channel:n,markDef:r,ref:i,config:o}=t;if(DV(r.type))return i;const a=cZ("invalid",r,o);if(null===a)return[qV(e,n),i];return i}({fieldDef:n,channel:e,markDef:r,ref:a,config:o}):a}function qV(t,e){return{test:IV(t,!0),..."y"===z$(e)?{field:{group:"height"}}:{value:0}}}function IV(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return TY(ir(t)?t:BG(t,{expr:"datum"}),!e)}function WV(t,e,n,r){const i={};if(e&&(i.scale=e),EG(t)){const{datum:e}=t;KZ(e)?i.signal=oY(e):GH(e)?i.signal=e.signal:HH(e)?i.signal=e.expr:i.value=e}else i.field=BG(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function $V(t){let{scaleName:e,fieldOrDatumDef:n,fieldOrDatumDef2:r,offset:i,startSuffix:o,endSuffix:a="end",bandPosition:s=.5}=t;const l=!GH(s)&&0<s&&s<1?"datum":void 0,u=BG(n,{expr:l,suffix:o}),c=void 0!==r?BG(r,{expr:l}):BG(n,{suffix:a,expr:l}),f={};if(0===s||1===s){f.scale=e;const t=0===s?u:c;f.field=t}else{const t=GH(s)?"(1-".concat(s.signal,") * ").concat(u," + ").concat(s.signal," * ").concat(c):"".concat(1-s," * ").concat(u," + ").concat(s," * ").concat(c);f.signal='scale("'.concat(e,'", ').concat(t,")")}return i&&(f.offset=i),f}function HV(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c,bandPosition:f}=t;if(n){if(DG(n)){var d,h;const t=null===s||void 0===s?void 0:s.get("type");if(FG(n)){var p;null!==(p=f)&&void 0!==p||(f=gG({fieldDef:n,fieldDef2:r,markDef:i,config:o}));const{bin:s,timeUnit:c,type:d}=n;if(UH(s)||f&&c&&d===LY)return null!==l&&void 0!==l&&l.impute?WV(n,a,{binSuffix:"mid"},{offset:u}):f&&!JY(t)?$V({scaleName:a,fieldOrDatumDef:n,bandPosition:f,offset:u}):WV(n,a,nX(n,e)?{binSuffix:"range"}:{},{offset:u});if(qH(s)){if(kG(r))return $V({scaleName:a,fieldOrDatumDef:n,fieldOrDatumDef2:r,bandPosition:f,offset:u});JZ(VZ(e===NW?zW:RW))}}return WV(n,a,JY(t)?{binSuffix:"range"}:{},{offset:u,band:"band"===t?null!==(d=null!==(h=f)&&void 0!==h?h:n.bandPosition)&&void 0!==d?d:.5:void 0})}if(TG(n)){const t=u?{offset:u}:{};return{...ZV(e,n.value),...t}}}return zn(c)&&(c=c()),c?{...c,...u?{offset:u}:{}}:c}function ZV(t,e){return HI(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:HI(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:iZ(e)}function YV(t){return t&&"number"!==t&&"time"!==t}function VV(t,e,n){return"".concat(t,"(").concat(e).concat(n?", ".concat(SW(n)):"",")")}const GV=" \u2013 ";function XV(t){let{fieldOrDatumDef:e,format:n,formatType:r,expr:i,normalizeStack:o,config:a}=t;if(YV(r))return JV({fieldOrDatumDef:e,format:n,formatType:r,expr:i,config:a});const s=QV(e,i,o),l=AG(e);if(void 0===n&&void 0===r&&a.customFormatTypes){if("quantitative"===l){if(o&&a.normalizedNumberFormatType)return JV({fieldOrDatumDef:e,format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,expr:i,config:a});if(a.numberFormatType)return JV({fieldOrDatumDef:e,format:a.numberFormat,formatType:a.numberFormatType,expr:i,config:a})}if("temporal"===l&&a.timeFormatType&&kG(e)&&void 0===e.timeUnit)return JV({fieldOrDatumDef:e,format:a.timeFormat,formatType:a.timeFormatType,expr:i,config:a})}if(KG(e)){var u,c;const t=function(t){let{field:e,timeUnit:n,format:r,formatType:i,rawTimeFormat:o,isUTCScale:a}=t;return!n||r?!n&&i?"".concat(i,"(").concat(e,", '").concat(r,"')"):(r=ir(r)?r:o,"".concat(a?"utc":"time","Format(").concat(e,", '").concat(r,"')")):function(t,e,n){if(!t)return;const r=gY(t),i=n||cY(t);return"".concat(i?"utc":"time","Format(").concat(e,", ").concat(r,")")}(n,e,a)}({field:s,timeUnit:kG(e)?null===(u=yY(e.timeUnit))||void 0===u?void 0:u.unit:void 0,format:n,formatType:a.timeFormatType,rawTimeFormat:a.timeFormat,isUTCScale:NG(e)&&(null===(c=e.scale)||void 0===c?void 0:c.type)===qY.UTC});return t?{signal:t}:void 0}if(n=eG({type:l,specifiedFormat:n,config:a,normalizeStack:o}),kG(e)&&UH(e.bin)){return{signal:iG(s,BG(e,{expr:i,binSuffix:"end"}),n,r,a)}}return n||"quantitative"===AG(e)?{signal:"".concat(nG(s,n))}:{signal:"isValid(".concat(s,") ? ").concat(s,' : ""+').concat(s)}}function QV(t,e,n){return kG(t)?n?"".concat(BG(t,{expr:e,suffix:"end"}),"-").concat(BG(t,{expr:e,suffix:"start"})):BG(t,{expr:e}):function(t){const{datum:e}=t;return KZ(e)?oY(e):"".concat(SW(e))}(t)}function JV(t){var e;let{fieldOrDatumDef:n,format:r,formatType:i,expr:o,normalizeStack:a,config:s,field:l}=t;if(null!==(e=l)&&void 0!==e||(l=QV(n,o,a)),"datum.value"!==l&&kG(n)&&UH(n.bin)){return{signal:iG(l,BG(n,{expr:o,binSuffix:"end"}),r,i,s)}}return{signal:VV(i,l,r)}}function KV(t,e,n,r,i,o){if(!ir(r)||!YV(r)){if(void 0===n&&void 0===r&&i.customFormatTypes&&"quantitative"===AG(t)){if(i.normalizedNumberFormatType&&OG(t)&&"normalize"===t.stack)return;if(i.numberFormatType)return}if(OG(t)&&"normalize"===t.stack&&i.normalizedNumberFormat)return eG({type:"quantitative",config:i,normalizeStack:!0});if(KG(t)){var a;const e=kG(t)?null===(a=yY(t.timeUnit))||void 0===a?void 0:a.unit:void 0;if(void 0===e&&i.customFormatTypes&&i.timeFormatType)return;return function(t){let{specifiedFormat:e,timeUnit:n,config:r,omitTimeFormatConfig:i}=t;if(e)return e;if(n)return{signal:gY(n)};return i?void 0:r.timeFormat}({specifiedFormat:n,timeUnit:e,config:i,omitTimeFormatConfig:o})}return eG({type:e,specifiedFormat:n,config:i})}}function tG(t,e,n){return t&&(GH(t)||"number"===t||"time"===t)?t:KG(e)&&"time"!==n&&"utc"!==n?kG(e)&&null!==(r=yY(null===e||void 0===e?void 0:e.timeUnit))&&void 0!==r&&r.utc?"utc":"time":void 0;var r}function eG(t){let{type:e,specifiedFormat:n,config:r,normalizeStack:i}=t;return ir(n)?n:e===PY?i?r.normalizedNumberFormat:r.numberFormat:void 0}function nG(t,e){return"format(".concat(t,', "').concat(e||"",'")')}function rG(t,e,n,r){var i;return YV(n)?VV(n,t,e):nG(t,null!==(i=ir(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function iG(t,e,n,r,i){if(void 0===n&&void 0===r&&i.customFormatTypes&&i.numberFormatType)return iG(t,e,i.numberFormat,i.numberFormatType,i);const o=rG(t,n,r,i),a=rG(e,n,r,i);return"".concat(TY(t,!1),' ? "null" : ').concat(o,' + "').concat(GV,'" + ').concat(a)}const oG="min",aG={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function sG(t){return t in aG}function lG(t){return!(null===t||void 0===t||!t.encoding)}function uG(t){return t&&("count"===t.op||!!t.field)}function cG(t){return t&&sn(t)}function fG(t){return"row"in t||"column"in t}function dG(t){return!!t&&"header"in t}function hG(t){return"facet"in t}function pG(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:e}}function mG(t){return"sort"in t}function gG(t){let{fieldDef:e,fieldDef2:n,markDef:r,config:i}=t;if(DG(e)&&void 0!==e.bandPosition)return e.bandPosition;if(kG(e)){const{timeUnit:t,bin:o}=e;if(t&&!n)return fZ("timeUnitBandPosition",r,i);if(UH(o))return.5}}function yG(t){let{channel:e,fieldDef:n,fieldDef2:r,markDef:i,config:o,scaleType:a,useVlSizeChannel:s}=t;const l=B$(e),u=cZ(s?"size":l,i,o,{vgChannel:l});if(void 0!==u)return u;if(kG(n)){const{timeUnit:t,bin:e}=n;if(t&&!r)return{band:fZ("timeUnitBandSize",i,o)};if(UH(e)&&!JY(a))return{band:1}}var c,f,d;return FV(i.type)?a?JY(a)?(null===(f=o[i.type])||void 0===f?void 0:f.discreteBandSize)||{band:1}:null===(d=o[i.type])||void 0===d?void 0:d.continuousBandSize:null===(c=o[i.type])||void 0===c?void 0:c.discreteBandSize:void 0}function vG(t,e,n,r){return!!(UH(t.bin)||t.timeUnit&&FG(t)&&"temporal"===t.type)&&void 0!==gG({fieldDef:t,fieldDef2:e,markDef:n,config:r})}function bG(t){return t&&!!t.sort&&!t.field}function xG(t){return t&&"condition"in t}function _G(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!sn(e)&&kG(e)}function wG(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&!sn(e)&&DG(e)}function kG(t){return t&&(!!t.field||"count"===t.aggregate)}function AG(t){return null===t||void 0===t?void 0:t.type}function EG(t){return t&&"datum"in t}function MG(t){return FG(t)&&!LG(t)||SG(t)}function CG(t){return FG(t)&&"quantitative"===t.type&&!t.bin||SG(t)}function SG(t){return EG(t)&&nr(t.datum)}function DG(t){return kG(t)||EG(t)}function FG(t){return t&&("field"in t||"count"===t.aggregate)&&"type"in t}function TG(t){return t&&"value"in t&&"value"in t}function NG(t){return t&&("scale"in t||"sort"in t)}function OG(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function zG(t){return t&&"legend"in t}function RG(t){return t&&("format"in t||"formatType"in t)}function PG(t){return II(t,["legend","axis","header","scale"])}function BG(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.field;const r=e.prefix;let i=e.suffix,o="";if(function(t){return"count"===t.aggregate}(t))n=wW("count");else{let r;if(!e.nofn)if(function(t){return"op"in t}(t))r=t.op;else{const{bin:u,aggregate:c,timeUnit:f}=t;var a,s;if(UH(u))r=jH(u),i=(null!==(a=e.binSuffix)&&void 0!==a?a:"")+(null!==(s=e.suffix)&&void 0!==s?s:"");else if(c)OH(c)?(o='["'.concat(n,'"]'),n="argmax_".concat(c.argmax)):NH(c)?(o='["'.concat(n,'"]'),n="argmin_".concat(c.argmin)):r=String(c);else if(f&&!lY(f)){var l;r=function(t){const{utc:e,...n}=yY(t);return n.unit?(e?"utc":"")+rW(n).map((t=>sW("".concat("unit"===t?"":"_".concat(t,"_")).concat(n[t])))).join(""):(e?"utc":"")+"timeunit"+rW(n).map((t=>sW("_".concat(t,"_").concat(n[t])))).join("")}(f),i=(!["range","mid"].includes(e.binSuffix)&&e.binSuffix||"")+(null!==(l=e.suffix)&&void 0!==l?l:"")}}r&&(n=n?"".concat(r,"_").concat(n):r)}return i&&(n="".concat(n,"_").concat(i)),r&&(n="".concat(r,"_").concat(n)),e.forAs?gW(n):e.expr?dW(n,e.expr)+o:pW(n)+o}function LG(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return kG(t)&&!!t.bin;case"temporal":return!1}throw new Error(OZ(t.type))}const jG=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(OH(e))return"".concat(i," for argmax(").concat(e.argmax,")");if(NH(e))return"".concat(i," for argmin(").concat(e.argmin,")");const o=r&&!lY(r)?yY(r):void 0,a=e||(null===o||void 0===o?void 0:o.unit)||(null===o||void 0===o?void 0:o.maxbins)&&"timeunit"||UH(n)&&"bin";return a?"".concat(a.toUpperCase(),"(").concat(i,")"):i}(t);default:return function(t,e){const{field:n,bin:r,timeUnit:i,aggregate:o}=t;if("count"===o)return e.countTitle;if(UH(r))return"".concat(n," (binned)");if(i&&!lY(i)){var a;const t=null===(a=yY(i))||void 0===a?void 0:a.unit;if(t)return"".concat(n," (").concat(dY(t).join("-"),")")}else if(o)return OH(o)?"".concat(n," for max ").concat(o.argmax):NH(o)?"".concat(n," for min ").concat(o.argmin):"".concat(cW(o)," of ").concat(n);return n}(t,e)}};let UG=jG;function qG(t){UG=t}function IG(t,e,n){var r;let{allowDisabling:i,includeDefault:o=!0}=n;const a=null===(r=WG(t))||void 0===r?void 0:r.title;if(!kG(t))return null!==a&&void 0!==a?a:t.title;const s=t,l=o?$G(s,e):void 0;return i?vW(a,s.title,l):null!==(u=null!==a&&void 0!==a?a:s.title)&&void 0!==u?u:l;var u}function WG(t){return OG(t)&&t.axis?t.axis:zG(t)&&t.legend?t.legend:dG(t)&&t.header?t.header:void 0}function $G(t,e){return UG(t,e)}function HG(t){if(RG(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{var e;const n=null!==(e=WG(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function ZG(t){return kG(t)?t:_G(t)?t.condition:void 0}function YG(t){return DG(t)?t:wG(t)?t.condition:void 0}function VG(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(ir(t)||nr(t)||Kn(t)){return JZ(function(t,e,n){return"Channel ".concat(t," is a ").concat(e,". Converted to {value: ").concat(SW(n),"}.")}(e,ir(t)?"string":nr(t)?"number":"boolean",t)),{value:t}}return DG(t)?GG(t,e,n,r):wG(t)?{...t,condition:GG(t.condition,e,n,r)}:t}function GG(t,e,n,r){if(RG(t)){const{format:i,formatType:o,...a}=t;if(YV(o)&&!n.customFormatTypes)return JZ(TZ(e)),GG(a,e,n,r)}else{const i=OG(t)?"axis":zG(t)?"legend":dG(t)?"header":null;if(i&&t[i]){const{format:o,formatType:a,...s}=t[i];if(YV(a)&&!n.customFormatTypes)return JZ(TZ(e)),GG({...t,[i]:s},e,n,r)}}return kG(t)?XG(t,e,r):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=nr(n)?"quantitative":ir(n)?"nominal":KZ(n)?"temporal":void 0,{...t,type:e}}(t)}function XG(t,e){let{compositeMark:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{aggregate:r,timeUnit:i,bin:o,field:a}=t,s={...t};if(n||!r||zH(r)||OH(r)||NH(r)||(JZ(function(t){return'Invalid aggregation operator "'.concat(t,'".')}(r)),delete s.aggregate),i&&(s.timeUnit=yY(i)),a&&(s.field="".concat(a)),UH(o)&&(s.bin=QG(o,e)),qH(o)&&!aH(e)&&JZ(function(t){return"Channel ".concat(t,' should not be used with "binned" bin.')}(e)),FG(s)){const{type:t}=s,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case PY:return"quantitative";case"t":case LY:return"temporal";case"o":case BY:return"ordinal";case"n":case jY:return"nominal";case UY:return"geojson"}}(t);t!==e&&(s.type=e),"quantitative"!==t&&PH(r)&&(JZ(function(t,e){return'Invalid field type "'.concat(t,'" for aggregate: "').concat(e,'", using "quantitative" instead.')}(t,r)),s.type="quantitative")}else if(!O$(e)){const t=function(t,e){var n;switch(e){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(mG(t)&&sn(t.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=t;if(o)return"temporal";if(i||r&&!OH(r)&&!NH(r))return"quantitative";if(NG(t)&&null!==(n=t.scale)&&void 0!==n&&n.type)switch(IY[t.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(s,e);s.type=t}if(FG(s)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:"Channel ".concat(e," should not be used with a geojson data.")};switch(e){case DW:case FW:case TW:return LG(t)?JG:{compatible:!1,warning:BZ(e)};case NW:case OW:case PW:case BW:case ZW:case YW:case VW:case r$:case o$:case a$:case s$:case l$:case u$:case QW:case UW:case LW:case c$:return JG;case WW:case HW:case IW:case $W:return n!==PY?{compatible:!1,warning:"Channel ".concat(e," should be used with a quantitative field only, not ").concat(t.type," field.")}:JG;case JW:case KW:case t$:case e$:case XW:case qW:case jW:case zW:case RW:return"nominal"!==n||t.sort?JG:{compatible:!1,warning:"Channel ".concat(e," should not be used with an unsorted discrete field.")};case GW:case n$:return LG(t)||function(t){var e;return NG(t)&&eV(null===(e=t.scale)||void 0===e?void 0:e.type)}(t)?JG:{compatible:!1,warning:LZ(e)};case i$:return"nominal"!==t.type||"sort"in t?JG:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(s,e)||{};!1===t&&JZ(n)}if(mG(s)&&ir(s.sort)){const{sort:t}=s;if(sG(t))return{...s,sort:{encoding:t}};const e=t.substr(1);if("-"===t.charAt(0)&&sG(e))return{...s,sort:{encoding:e,order:"descending"}}}if(dG(s)){const{header:t}=s;if(t){const{orient:e,...n}=t;if(e)return{...s,header:{...n,labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e}}}}return s}function QG(t,e){return Kn(t)?{maxbins:$H(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:{...t,maxbins:$H(e)}}const JG={compatible:!0};function KG(t){const{formatType:e}=HG(t);return"time"===e||!e&&function(t){return t&&("temporal"===t.type||kG(t)&&!!t.timeUnit)}(t)}function tX(t,e){var n;let{timeUnit:r,type:i,wrapTime:o,undefinedIfExprNotRequired:a}=e;const s=r&&(null===(n=yY(r))||void 0===n?void 0:n.unit);let l,u=s||"temporal"===i;return HH(t)?l=t.expr:GH(t)?l=t.signal:KZ(t)?(u=!0,l=oY(t)):(ir(t)||nr(t))&&u&&(l="datetime(".concat(SW(t),")"),function(t){return!!aY[t]}(s)&&(nr(t)&&t<1e4||ir(t)&&isNaN(Date.parse(t)))&&(l=oY({[s]:t}))),l?o&&u?"time(".concat(l,")"):l:a?void 0:SW(t)}function eX(t,e){const{type:n}=t;return e.map((e=>{const r=tX(e,{timeUnit:kG(t)&&!lY(t.timeUnit)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e}))}function nX(t,e){return UH(t.bin)?AH(e)&&["ordinal","nominal"].includes(t.type):(console.warn("Only call this method for binned field defs."),!1)}const rX={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function iX(t){return null===t||void 0===t?void 0:t.condition}const oX=["domain","grid","labels","ticks","title"],aX={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},sX={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},lX={...sX,style:1,labelExpr:1,encoding:1};function uX(t){return!!lX[t]}rW(lX);const cX=rW({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function fX(t){return"mark"in t}class dX{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!fX(t)&&function(t){return NV(t)?t.type:t}(t.mark)===this.name}}function hX(t,e){const n=t&&t[e];return!!n&&(sn(n)?ZI(n,(t=>!!t.field)):kG(n)||_G(n))}function pX(t,e){const n=t&&t[e];return!!n&&(sn(n)?ZI(n,(t=>!!t.field)):kG(n)||EG(n)||wG(n))}function mX(t,e){if(aH(e)){const n=t[e];if((kG(n)||EG(n))&&(RY(n.type)||kG(n)&&n.timeUnit)){return pX(t,j$(e))}}return!1}function gX(t){return ZI(w$,(e=>{if(hX(t,e)){const n=t[e];if(sn(n))return ZI(n,(t=>!!t.aggregate));{const t=ZG(n);return t&&!!t.aggregate}}return!1}))}function yX(t,e){const n=[],r=[],i=[],o=[],a={};return xX(t,((s,l)=>{if(kG(s)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=s;if(c||d||f){const t=WG(s),p=null===t||void 0===t?void 0:t.title;let m=BG(s,{forAs:!0});const g={...p?[]:{title:IG(s,e,{allowDisabling:!0})},...h,field:m};if(c){let t;if(OH(c)?(t="argmax",m=BG({op:"argmax",field:c.argmax},{forAs:!0}),g.field="".concat(m,".").concat(u)):NH(c)?(t="argmin",m=BG({op:"argmin",field:c.argmin},{forAs:!0}),g.field="".concat(m,".").concat(u)):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(t=c),t){const e={op:t,as:m};u&&(e.field=u),o.push(e)}}else if(n.push(m),FG(s)&&UH(f)){if(r.push({bin:f,field:u,as:m}),n.push(BG(s,{binSuffix:"end"})),nX(s,l)&&n.push(BG(s,{binSuffix:"range"})),aH(l)){const t={field:"".concat(m,"_end")};a["".concat(l,"2")]=t}g.bin="binned",O$(l)||(g.type=PY)}else if(d&&!lY(d)){i.push({timeUnit:d,field:u,as:m});const t=FG(s)&&s.type!==LY&&"time";t&&(l===r$||l===s$?g.formatType=t:!function(t){return!!nH[t]}(l)?aH(l)&&(g.axis={formatType:t,...g.axis}):g.legend={formatType:t,...g.legend})}a[l]=g}else n.push(u),a[l]=t[l]}else a[l]=t[l]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function vX(t,e,n){const r=EH(e,n);if(!r)return!1;if("binned"===r){const n=t[e===zW?NW:OW];return!!(kG(n)&&kG(t[e])&&qH(n.bin))}return!0}function bX(t,e){const n={};for(const r of rW(t)){const i=VG(t[r],r,e,{compositeMark:!0});n[r]=i}return n}function xX(t,e,n){if(t)for(const r of rW(t)){const i=t[r];if(sn(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function _X(t,e){return rW(e).reduce(((n,r)=>{switch(r){case NW:case OW:case l$:case c$:case u$:case zW:case RW:case PW:case BW:case UW:case qW:case LW:case jW:case IW:case WW:case $W:case HW:case r$:case GW:case QW:case s$:return n;case i$:if("line"===t||"trail"===t)return n;case o$:case a$:{const t=e[r];if(sn(t)||kG(t))for(const e of Nn(t))e.aggregate||n.push(BG(e,{}));return n}case XW:if("trail"===t)return n;case ZW:case YW:case VW:case JW:case KW:case t$:case n$:case e$:{const t=ZG(e[r]);return t&&!t.aggregate&&n.push(BG(t,{})),n}}}),[])}function wX(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};const i=t.map((t=>{let{fieldPrefix:n,titlePrefix:i}=t;const o=r?" of ".concat(kX(e)):"";return{field:n+e.field,type:e.type,title:GH(i)?{signal:"".concat(i,'"').concat(escape(o),'"')}:i+o}})),o=function(t){const e=[];for(const n of rW(t))if(hX(t,n)){const r=Nn(t[n]);for(const t of r)kG(t)?e.push(t):_G(t)&&e.push(t.condition)}return e}(n).map(PG);return{tooltip:[...i,...XI(o,WI)]}}function kX(t){const{title:e,field:n}=t;return vW(e,n)}function AX(t,e,n,r,i){const{scale:o,axis:a}=n;return s=>{let{partName:l,mark:u,positionPrefix:c,endPositionPrefix:f,extraEncoding:d={}}=s;const h=kX(n);return EX(t,l,i,{mark:u,encoding:{[e]:{field:"".concat(c,"_").concat(n.field),type:n.type,...void 0!==h?{title:h}:{},...void 0!==o?{scale:o}:{},...void 0!==a?{axis:a}:{}},...ir(f)?{["".concat(e,"2")]:{field:"".concat(f,"_").concat(n.field)}}:{},...r,...d}})}}function EX(t,e,n,r){const{clip:i,color:o,opacity:a}=t,s=t.type;return t[e]||void 0===t[e]&&n[e]?[{...r,mark:{...n[e],...i?{clip:i}:{},...o?{color:o}:{},...a?{opacity:a}:{},...NV(r.mark)?r.mark:{type:r.mark},style:"".concat(s,"-").concat(String(e)),...Kn(t[e])?{}:t[e]}}]:[]}function MX(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",o=r[i],a=r["".concat(i,"2")],s=r["".concat(i,"Error")],l=r["".concat(i,"Error2")];return{continuousAxisChannelDef:CX(o,n),continuousAxisChannelDef2:CX(a,n),continuousAxisChannelDefError:CX(s,n),continuousAxisChannelDefError2:CX(l,n),continuousAxis:i}}function CX(t,e){if(null!==t&&void 0!==t&&t.aggregate){const{aggregate:n,...r}=t;return n!==e&&JZ(function(t,e){return"Continuous axis should not have customized aggregation function ".concat(t,"; ").concat(e," already agregates the axis.")}(n,e)),r}return t}function SX(t,e){const{mark:n,encoding:r}=t,{x:i,y:o}=r;if(NV(n)&&n.orient)return n.orient;if(MG(i)){if(MG(o)){const t=kG(i)&&i.aggregate,n=kG(o)&&o.aggregate;if(t||n!==e){if(n||t!==e){if(t===e&&n===e)throw new Error("Both x and y cannot have aggregate");return KG(o)&&!KG(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(MG(o))return"vertical";throw new Error("Need a valid continuous axis for ".concat(e,"s"))}const DX="boxplot",FX=new dX(DX,NX);function TX(t){return nr(t)?"tukey":t}function NX(t,e){var n;let{config:r}=e;t={...t,encoding:bX(t.encoding,r)};const{mark:i,encoding:o,params:a,projection:s,...l}=t,u=NV(i)?i:{type:i};a&&JZ(MZ("boxplot"));const c=null!==(n=u.extent)&&void 0!==n?n:r.boxplot.extent,f=cZ("size",u,r),d=u.invalid,h=TX(c),{bins:p,timeUnits:m,transform:g,continuousAxisChannelDef:y,continuousAxis:v,groupby:b,aggregate:x,encodingWithoutContinuousAxis:_,ticksOrient:w,boxOrient:k,customTooltipWithoutAggregatedField:A}=function(t,e,n){const r=SX(t,DX),{continuousAxisChannelDef:i,continuousAxis:o}=MX(t,r,DX),a=i.field,s=TX(e),l=[...OX(a),{op:"median",field:a,as:"mid_box_".concat(a)},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],u="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(a,'"] - datum["lower_box_').concat(a,'"]'),as:"iqr_".concat(a)},{calculate:'min(datum["upper_box_'.concat(a,'"] + datum["iqr_').concat(a,'"] * ').concat(e,', datum["max_').concat(a,'"])'),as:"upper_whisker_".concat(a)},{calculate:'max(datum["lower_box_'.concat(a,'"] - datum["iqr_').concat(a,'"] * ').concat(e,', datum["min_').concat(a,'"])'),as:"lower_whisker_".concat(a)}],{[o]:c,...f}=t.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=function(t){const{tooltip:e,...n}=t;if(!e)return{filteredEncoding:n};let r,i;if(sn(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return sn(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:p,timeUnits:m,aggregate:g,groupby:y,encoding:v}=yX(h,n),b="vertical"===r?"horizontal":"vertical",x=r,_=[...p,...m,{aggregate:[...g,...l],groupby:y},...u];return{bins:p,timeUnits:m,transform:_,groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:d}}(t,c,r),{color:E,size:M,...C}=_,S=t=>AX(u,v,y,t,r.boxplot),D=S(C),F=S(_),T=S({...C,...M?{size:M}:{}}),N=wX([{fieldPrefix:"min-max"===h?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===h?"lower_whisker_":"min_",titlePrefix:"Min"}],y,_),O={type:"tick",color:"black",opacity:1,orient:w,invalid:d,aria:!1},z="min-max"===h?N:wX([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],y,_),R=[...D({partName:"rule",mark:{type:"rule",invalid:d,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:z}),...D({partName:"rule",mark:{type:"rule",invalid:d,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:z}),...D({partName:"ticks",mark:O,positionPrefix:"lower_whisker",extraEncoding:z}),...D({partName:"ticks",mark:O,positionPrefix:"upper_whisker",extraEncoding:z})],P=[..."tukey"!==h?R:[],...F({partName:"box",mark:{type:"bar",...f?{size:f}:{},orient:k,invalid:d,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:N}),...T({partName:"median",mark:{type:"tick",invalid:d,...ln(r.boxplot.median)&&r.boxplot.median.color?{color:r.boxplot.median.color}:{},...f?{size:f}:{},orient:w,aria:!1},positionPrefix:"mid_box",extraEncoding:N})];var B;if("min-max"===h)return{...l,transform:(null!==(B=l.transform)&&void 0!==B?B:[]).concat(g),layer:P};const L='datum["lower_box_'.concat(y.field,'"]'),j='datum["upper_box_'.concat(y.field,'"]'),U="(".concat(j," - ").concat(L,")"),q="".concat(L," - ").concat(c," * ").concat(U),I="".concat(j," + ").concat(c," * ").concat(U),W='datum["'.concat(y.field,'"]'),$={joinaggregate:OX(y.field),groupby:b},H={transform:[{filter:"(".concat(q," <= ").concat(W,") && (").concat(W," <= ").concat(I,")")},{aggregate:[{op:"min",field:y.field,as:"lower_whisker_".concat(y.field)},{op:"max",field:y.field,as:"upper_whisker_".concat(y.field)},{op:"min",field:"lower_box_".concat(y.field),as:"lower_box_".concat(y.field)},{op:"max",field:"upper_box_".concat(y.field),as:"upper_box_".concat(y.field)},...x],groupby:b}],layer:R},{tooltip:Z,...Y}=C,{scale:V,axis:G}=y,X=kX(y),Q=II(G,["title"]),J=EX(u,"outliers",r.boxplot,{transform:[{filter:"(".concat(W," < ").concat(q,") || (").concat(W," > ").concat(I,")")}],mark:"point",encoding:{[v]:{field:y.field,type:y.type,...void 0!==X?{title:X}:{},...void 0!==V?{scale:V}:{},...nW(Q)?{}:{axis:Q}},...Y,...E?{color:E}:{},...A?{tooltip:A}:{}}})[0];let K;const tt=[...p,...m,$];return J?K={transform:tt,layer:[J,H]}:(K=H,K.transform.unshift(...tt)),{...l,layer:[K,{transform:g,layer:P}]}}function OX(t){return[{op:"q1",field:t,as:"lower_box_".concat(t)},{op:"q3",field:t,as:"upper_box_".concat(t)}]}const zX="errorbar",RX=new dX(zX,PX);function PX(t,e){let{config:n}=e;t={...t,encoding:bX(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,ticksOrient:s,markDef:l,outerSpec:u,tooltipEncoding:c}=LX(t,zX,n);delete a.size;const f=AX(l,o,i,a,n.errorbar),d=l.thickness,h=l.size,p={type:"tick",orient:s,aria:!1,...void 0!==d?{thickness:d}:{},...void 0!==h?{size:h}:{}},m=[...f({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:c}),...f({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:c}),...f({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==d?{size:d}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return{...u,transform:r,...m.length>1?{layer:m}:{...m[0]}}}function BX(t,e){const{encoding:n}=t;if(function(t){return(DG(t.x)||DG(t.y))&&!DG(t.x2)&&!DG(t.y2)&&!DG(t.xError)&&!DG(t.xError2)&&!DG(t.yError)&&!DG(t.yError2)}(n))return{orient:SX(t,e),inputType:"raw"};const r=function(t){return DG(t.x2)||DG(t.y2)}(n),i=function(t){return DG(t.xError)||DG(t.xError2)||DG(t.yError)||DG(t.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error("".concat(e," cannot be both type aggregated-upper-lower and aggregated-error"));const t=n.x2,r=n.y2;if(DG(t)&&DG(r))throw new Error("".concat(e," cannot have both x2 and y2"));if(DG(t)){if(MG(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(e))}if(DG(r)){if(MG(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(e))}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(DG(r)&&!DG(t))throw new Error("".concat(e," cannot have xError2 without xError"));if(DG(s)&&!DG(i))throw new Error("".concat(e," cannot have yError2 without yError"));if(DG(t)&&DG(i))throw new Error("".concat(e," cannot have both xError and yError with both are quantiative"));if(DG(t)){if(MG(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(DG(i)){if(MG(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function LX(t,e,n){var r;const{mark:i,encoding:o,params:a,projection:s,...l}=t,u=NV(i)?i:{type:i};a&&JZ(MZ(e));const{orient:c,inputType:f}=BX(t,e),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:g}=MX(t,c,e),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=function(t,e,n,r,i,o,a,s){let l=[],u=[];const c=e.field;let f,d=!1;if("raw"===o){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!==("iqr"===n)&&JZ(function(t,e,n){return"".concat(t," is not usually used with ").concat(e," for ").concat(n,".")}(e,n,a)),"stderr"===n||"stdev"===n)l=[{op:n,field:c,as:"extent_".concat(c)},{op:e,field:c,as:"center_".concat(c)}],u=[{calculate:'datum["center_'.concat(c,'"] + datum["extent_').concat(c,'"]'),as:"upper_".concat(c)},{calculate:'datum["center_'.concat(c,'"] - datum["extent_').concat(c,'"]'),as:"lower_".concat(c)}],f=[{fieldPrefix:"center_",titlePrefix:cW(e)},{fieldPrefix:"upper_",titlePrefix:jX(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:jX(e,n,"-")}],d=!0;else{let t,e,r;"ci"===n?(t="mean",e="ci0",r="ci1"):(t="median",e="q1",r="q3"),l=[{op:e,field:c,as:"lower_".concat(c)},{op:r,field:c,as:"upper_".concat(c)},{op:t,field:c,as:"center_".concat(c)}],f=[{fieldPrefix:"upper_",titlePrefix:IG({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:IG({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:IG({field:c,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&JZ(function(t,e){return"".concat(e?"extent ":"").concat(e&&t?"and ":"").concat(t?"center ":"").concat(e&&t?"are ":"is ","not needed when data are aggregated.")}(t.center,t.extent)),"aggregated-upper-lower"===o?(f=[],u=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_".concat(c)},{calculate:'datum["'.concat(c,'"]'),as:"lower_".concat(c)}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:'datum["'.concat(c,'"] + datum["').concat(r.field,'"]'),as:"upper_".concat(c)}],i?u.push({calculate:'datum["'.concat(c,'"] + datum["').concat(i.field,'"]'),as:"lower_".concat(c)}):u.push({calculate:'datum["'.concat(c,'"] - datum["').concat(r.field,'"]'),as:"lower_".concat(c)}));for(const t of u)f.push({fieldPrefix:t.as.substring(0,6),titlePrefix:mW(mW(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}(u,d,h,p,m,f,e,n),{[g]:_,["x"===g?"x2":"y2"]:w,["x"===g?"xError":"yError"]:k,["x"===g?"xError2":"yError2"]:A,...E}=o,{bins:M,timeUnits:C,aggregate:S,groupby:D,encoding:F}=yX(E,n),T=[...S,...y],N="raw"!==f?[]:D,O=wX(b,d,F,x);return{transform:[...null!==(r=l.transform)&&void 0!==r?r:[],...M,...C,...0===T.length?[]:[{aggregate:T,groupby:N}],...v],groupby:N,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:F,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:O}}function jX(t,e,n){return"".concat(cW(t)," ").concat(n," ").concat(e)}const UX="errorband",qX=new dX(UX,IX);function IX(t,e){let{config:n}=e;t={...t,encoding:bX(t.encoding,n)};const{transform:r,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:l,tooltipEncoding:u}=LX(t,UX,n),c=s,f=AX(c,o,i,a,n.errorband),d=void 0!==t.encoding.x&&void 0!==t.encoding.y;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const m={...c.interpolate?{interpolate:c.interpolate}:{},...c.tension&&c.interpolate?{tension:c.tension}:{}};return d?(h={...h,...m,ariaRoleDescription:"errorband"},p={...p,...m,aria:!1}):c.interpolate?JZ(YZ("interpolate")):c.tension&&JZ(YZ("tension")),{...l,transform:r,layer:[...f({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:u}),...f({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:u})]}}const WX={};function $X(t,e,n){const r=new dX(t,e);WX[t]={normalizer:r,parts:n}}$X(DX,NX,["box","median","outliers","rule","ticks"]),$X(zX,PX,["ticks","rule"]),$X(UX,IX,["band","borders"]);const HX=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],ZX={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},YX={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},VX=rW(ZX),GX=rW(YX),XX=rW({header:1,headerRow:1,headerColumn:1,headerFacet:1}),QX=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],JX={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},KX=(rW(JX),"_vgsid_"),tQ={point:{on:"click",fields:[KX],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function eQ(t){return"legend"===t||!(null===t||void 0===t||!t.legend)}function nQ(t){return eQ(t)&&ln(t)}function rQ(t){return!(null===t||void 0===t||!t.select)}function iQ(t){const e=[];for(const n of t||[]){if(rQ(n))continue;const{expr:t,bind:r,...i}=n;if(r&&t){const n={...i,bind:r,init:t};e.push(n)}else{const n={...i,...t?{update:t}:{},...r?{bind:r}:{}};e.push(n)}}return e}function oQ(t){return"concat"in t}function aQ(t){return"vconcat"in t}function sQ(t){return"hconcat"in t}function lQ(t){let{step:e,offsetIsDiscrete:n}=t;var r;return n?null!==(r=e.for)&&void 0!==r?r:"offset":"position"}function uQ(t){return ln(t)&&void 0!==t.step}function cQ(t){return t.view||t.width||t.height}const fQ=rW({align:1,bounds:1,center:1,columns:1,spacing:1});function dQ(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function hQ(t,e){const n=pQ(t,e);return uQ(n)?n.step:mQ}function pQ(t,e){var n;return vW(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const mQ=20;const gQ={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:mQ},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:LV,circle:{},geoshape:{},image:{},line:{},point:{},rect:jV,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:tQ,style:{},title:{},facet:{spacing:20},concat:{spacing:20},normalizedNumberFormat:".0%"},yQ=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],vQ={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},bQ={blue:yQ[0],orange:yQ[1],red:yQ[2],teal:yQ[3],green:yQ[4],yellow:yQ[5],purple:yQ[6],pink:yQ[7],brown:yQ[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function xQ(t){const e=rW(t||{}),n={};for(const r of e){const e=t[r];n[r]=iX(e)?eZ(e):nZ(e)}return n}const _Q=[...RV,...cX,...XX,"background","padding","legend","lineBreak","scale","style","title","view"];function wQ(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,font:n,fontSize:r,selection:i,...o}=t,a=cn({},jI(gQ),n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:ln(t)?{...bQ,...t}:bQ}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:ln(t)?{...vQ,...t}:vQ}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},o||{});i&&fn(a,"selection",i,!0);const s=II(a,_Q);for(const l of["background","lineBreak","padding"])a[l]&&(s[l]=nZ(a[l]));for(const l of RV)a[l]&&(s[l]=ZH(a[l]));for(const l of cX)a[l]&&(s[l]=xQ(a[l]));for(const l of XX)a[l]&&(s[l]=ZH(a[l]));return a.legend&&(s.legend=ZH(a.legend)),a.scale&&(s.scale=ZH(a.scale)),a.style&&(s.style=function(t){const e=rW(t),n={};for(const r of e)n[r]=xQ(t[r]);return n}(a.style)),a.title&&(s.title=ZH(a.title)),a.view&&(s.view=ZH(a.view)),s}const kQ=new Set(["view",...TV]),AQ=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],EQ={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]};function MQ(t){t=jI(t);for(const e of AQ)delete t[e];if(t.axis)for(const e in t.axis)iX(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of HX)delete t.legend[e];if(t.mark){for(const e of zV)delete t.mark[e];t.mark.tooltip&&ln(t.mark.tooltip)&&delete t.mark.tooltip}t.params&&(t.signals=(t.signals||[]).concat(iQ(t.params)),delete t.params);for(const e of kQ){for(const r of zV)delete t[e][r];const n=EQ[e];if(n)for(const r of n)delete t[e][r];CQ(t,e)}for(const e of rW(WX))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=YH(t.title);nW(e)||(t.style["group-title"]={...t.style["group-title"],...e});nW(n)||(t.style["group-subtitle"]={...t.style["group-subtitle"],...n});nW(r)?delete t.title:t.title=r}(t);for(const e in t)ln(t[e])&&nW(t[e])&&delete t[e];return nW(t)?void 0:t}function CQ(t,e,n,r){var i;"view"===e&&(n="cell");const o={...r?t[e][r]:t[e],...t.style[null!==(i=n)&&void 0!==i?i:e]};var a;nW(o)||(t.style[null!==(a=n)&&void 0!==a?a:e]=o);r||delete t[e]}function SQ(t){return"layer"in t}class DQ{map(t,e){return hG(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):sQ(t)?this.mapHConcat(t,e):aQ(t)?this.mapVConcat(t,e):oQ(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(SQ(t))return this.mapLayer(t,e);if(fX(t))return this.mapUnit(t,e);throw new Error(vZ(t))}mapLayer(t,e){return{...t,layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))}}mapHConcat(t,e){return{...t,hconcat:t.hconcat.map((t=>this.map(t,e)))}}mapVConcat(t,e){return{...t,vconcat:t.vconcat.map((t=>this.map(t,e)))}}mapConcat(t,e){const{concat:n,...r}=t;return{...r,concat:n.map((t=>this.map(t,e)))}}mapFacet(t,e){return{...t,spec:this.map(t.spec,e)}}mapRepeat(t,e){return{...t,spec:this.map(t.spec,e)}}}const FQ={zero:1,center:1,normalize:1};const TQ=new Set([mV,yV,gV,wV,xV,MV,CV,bV,kV,AV]),NQ=new Set([yV,gV,mV]);function OQ(t){return kG(t)&&"quantitative"===AG(t)&&!t.bin}function zQ(t,e,n){let{orient:r,type:i}=n;const o="x"===e?"y":"radius",a="x"===e&&["bar","area"].includes(i),s=t[e],l=t[o];if(kG(s)&&kG(l))if(OQ(s)&&OQ(l)){if(s.stack)return e;if(l.stack)return o;const t=kG(s)&&!!s.aggregate;if(t!==(kG(l)&&!!l.aggregate))return t?e:o;if(a){if("vertical"===r)return o;if("horizontal"===r)return e}}else{if(OQ(s))return e;if(OQ(l))return o}else{if(OQ(s)){if(a&&"vertical"===r)return;return e}if(OQ(l)){if(a&&"horizontal"===r)return;return o}}}function RQ(t,e){var n,r;const i=NV(t)?t:{type:t},o=i.type;if(!TQ.has(o))return null;const a=zQ(e,"x",i)||zQ(e,"theta",i);if(!a)return null;const s=e[a],l=kG(s)?BG(s,{}):void 0,u=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(a),c=[],f=new Set;if(e[u]){const t=e[u],n=kG(t)?BG(t,{}):void 0;n&&n!==l&&(c.push(u),f.add(n))}const d="x"===u?"xOffset":"yOffset",h=e[d],p=kG(h)?BG(h,{}):void 0;p&&p!==l&&(c.push(d),f.add(p));const m=rH.reduce(((t,n)=>{if("tooltip"!==n&&hX(e,n)){const r=e[n];for(const e of Nn(r)){const r=ZG(e);if(r.aggregate)continue;const i=BG(r,{});i&&f.has(i)||t.push({channel:n,fieldDef:r})}}return t}),[]);let g;return void 0!==s.stack?g=Kn(s.stack)?s.stack?"zero":null:s.stack:NQ.has(o)&&(g="zero"),g&&function(t){return t in FQ}(g)?gX(e)&&0===m.length?null:null!==s&&void 0!==s&&null!==(n=s.scale)&&void 0!==n&&n.type&&(null===s||void 0===s||null===(r=s.scale)||void 0===r?void 0:r.type)!==qY.LINEAR?(null!==s&&void 0!==s&&s.stack&&JZ(function(t){return"Cannot stack non-linear scale (".concat(t,").")}(s.scale.type)),null):DG(e[P$(a)])?(void 0!==s.stack&&JZ('Cannot stack "'.concat(y=a,'" if there is already "').concat(y,'2".')),null):(kG(s)&&s.aggregate&&!BH.has(s.aggregate)&&JZ((v=s.aggregate,'Stacking is applied even though the aggregate function is non-summative ("'.concat(v,'").'))),{groupbyChannels:c,groupbyFields:f,fieldChannel:a,impute:null!==s.impute&&DV(o),stackBy:m,offset:g}):null;var y,v}function PQ(t,e,n){const r=ZH(t),i=cZ("orient",r,n);var o,a;if(r.orient=function(t,e,n){switch(t){case xV:case MV:case CV:case kV:case _V:case vV:return}const{x:r,y:i,x2:o,y2:a}=e;switch(t){case yV:if(kG(r)&&(qH(r.bin)||kG(i)&&i.aggregate&&!r.aggregate))return"vertical";if(kG(i)&&(qH(i.bin)||kG(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o)return(kG(r)&&r.type===PY&&!UH(r.bin)||SG(r))&&kG(i)&&qH(i.bin)?"horizontal":"vertical";if(!a)return(kG(i)&&i.type===PY&&!UH(i.bin)||SG(i))&&kG(r)&&qH(r.bin)?"vertical":"horizontal"}case wV:if(o&&(!kG(r)||!qH(r.bin))&&a&&(!kG(i)||!qH(i.bin)))return;case gV:if(a)return kG(i)&&qH(i.bin)?"horizontal":"vertical";if(o)return kG(r)&&qH(r.bin)?"vertical":"horizontal";if(t===wV){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case bV:case AV:{const e=CG(r),o=CG(i);if(n)return n;if(e&&!o)return"tick"!==t?"horizontal":"vertical";if(!e&&o)return"tick"!==t?"vertical":"horizontal";if(e&&o)return"vertical";{const t=FG(r)&&r.type===LY,e=FG(i)&&i.type===LY;if(t&&!e)return"vertical";if(!t&&e)return"horizontal"}return}}return"vertical"}(r.type,e,i),void 0!==i&&i!==r.orient&&JZ((o=r.orient,a=i,'Specified orient "'.concat(o,'" overridden with "').concat(a,'".'))),"bar"===r.type&&r.orient){const t=cZ("cornerRadiusEnd",r,n);if(void 0!==t){const n="horizontal"===r.orient&&e.x2||"vertical"===r.orient&&e.y2?["cornerRadius"]:BV[r.orient];for(const e of n)r[e]=t;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}void 0===cZ("opacity",r,n)&&(r.opacity=function(t,e){if(HI([xV,AV,MV,CV],t)&&!gX(e))return.7;return}(r.type,e));return void 0===cZ("cursor",r,n)&&(r.cursor=function(t,e,n){if(e.href||t.href||cZ("href",t,n))return"pointer";return t.cursor}(r,e,n)),r}function BQ(t){const{point:e,line:n,...r}=t;return rW(r).length>1?r:r.type}function LQ(t){for(const e of["line","area","rule","trail"])t[e]&&(t={...t,[e]:II(t[e],["point","line"])});return t}function jQ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===t.point?{opacity:0}:t.point?ln(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?ln(e.point)?e.point:{}:void 0}function UQ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class qQ{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(fX(t)){const{mark:n,encoding:r}=t,i=NV(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!jQ(i,e[i.type],r);case"area":return!!jQ(i,e[i.type],r)||!!UQ(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{params:i,projection:o,mark:a,name:s,encoding:l,...u}=t,c=bX(l,r),f=NV(a)?a:{type:a},d=jQ(f,r[f.type],c),h="area"===f.type&&UQ(f,r[f.type]),p=[{name:s,...i?{params:i}:{},mark:BQ({..."area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:II(c,["shape"])}],m=RQ(PQ(f,c,r),c);let g=c;if(m){const{fieldChannel:t,offset:e}=m;g={...c,[t]:{...c[t],...e?{stack:e}:{}}}}return g=II(g,["y2","x2"]),h&&p.push({...o?{projection:o}:{},mark:{type:"line",...qI(f,["clip","interpolate","tension","tooltip"]),...h},encoding:g}),d&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...qI(f,["clip","tooltip"]),...d},encoding:g}),n({...u,layer:p},{...e,config:LQ(r)})}}function IQ(t,e){return e?fG(t)?VQ(t,e):HQ(t,e):t}function WQ(t,e){return e?VQ(t,e):t}function $Q(t,e,n){const r=e[t];return function(t){return t&&!ir(t)&&"repeat"in t}(r)?r.repeat in n?{...e,[t]:n[r.repeat]}:void JZ(function(t){return'Unknown repeated value "'.concat(t,'".')}(r.repeat)):e}function HQ(t,e){if(void 0!==(t=$Q("field",t,e))){if(null===t)return null;if(mG(t)&&uG(t.sort)){const n=$Q("field",t.sort,e);t={...t,...n?{sort:n}:{}}}return t}}function ZQ(t,e){if(kG(t))return HQ(t,e);{const n=$Q("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function YQ(t,e){if(!DG(t)){if(wG(t)){const n=ZQ(t.condition,e);if(n)return{...t,condition:n};{const{condition:e,...n}=t;return n}}return t}{const n=ZQ(t,e);if(n)return n;if(xG(t))return{condition:t.condition}}}function VQ(t,e){const n={};for(const r in t)if(Yn(t,r)){const i=t[r];if(sn(i))n[r]=i.map((t=>YQ(t,e))).filter((t=>t));else{const t=YQ(i,e);void 0!==t&&(n[r]=t)}}return n}class GQ{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(fX(t)){const{encoding:e,mark:n}=t;if("line"===n||NV(n)&&"line"===n.type)for(const t of N$){const n=e[z$(t)];if(e[t]&&(kG(n)&&!qH(n.bin)||EG(n)))return!0}}return!1}run(t,e,n){const{encoding:r,mark:i}=t;var o,a;return JZ((o=!!r.x2,a=!!r.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(o&&a?"x2 and y2":o?"x2":"y2",". We will use the rule mark (line segments) instead."))),n({...t,mark:ln(i)?{...i,type:"rule"}:"rule"},e)}}function XQ(t){let{parentEncoding:e,encoding:n={},layer:r}=t,i={};if(e){const t=new Set([...rW(e),...rW(n)]);for(const o of t){const t=n[o],a=e[o];if(DG(t)){const e={...a,...t};i[o]=e}else wG(t)?i[o]={...t,condition:{...a,...t.condition}}:t||null===t?i[o]=t:(r||TG(a)||GH(a)||DG(a)||sn(a))&&(i[o]=a)}}else i=n;return!i||nW(i)?void 0:i}function QQ(t){const{parentProjection:e,projection:n}=t;return e&&n&&JZ(function(t){const{parentProjection:e,projection:n}=t;return"Layer's shared projection ".concat(SW(e)," is overridden by a child projection ").concat(SW(n),".")}({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function JQ(t){return"filter"in t}function KQ(t){return void 0!==(null===t||void 0===t?void 0:t.stop)}function tJ(t){return"lookup"in t}function eJ(t){return"pivot"in t}function nJ(t){return"density"in t}function rJ(t){return"quantile"in t}function iJ(t){return"regression"in t}function oJ(t){return"loess"in t}function aJ(t){return"sample"in t}function sJ(t){return"window"in t}function lJ(t){return"joinaggregate"in t}function uJ(t){return"flatten"in t}function cJ(t){return"calculate"in t}function fJ(t){return"bin"in t}function dJ(t){return"impute"in t}function hJ(t){return"timeUnit"in t}function pJ(t){return"aggregate"in t}function mJ(t){return"stack"in t}function gJ(t){return"fold"in t}function yJ(t){return"extent"in t&&!("density"in t)}function vJ(t,e){const{transform:n,...r}=t;if(n){const t=n.map((t=>{if(JQ(t))return{filter:_J(t,e)};if(fJ(t)&&IH(t.bin))return{...t,bin:xJ(t.bin)};if(tJ(t)){const{selection:e,...n}=t.from;return e?{...t,from:{param:e,...n}}:t}return t}));return{...r,transform:t}}return t}function bJ(t,e){var n;const r=jI(t);if(kG(r)&&IH(r.bin)&&(r.bin=xJ(r.bin)),NG(r)&&null!==(n=r.scale)&&void 0!==n&&null!==(n=n.domain)&&void 0!==n&&n.selection){const{selection:t,...e}=r.scale.domain;r.scale.domain={...e,...t?{param:t}:{}}}if(xG(r))if(sn(r.condition))r.condition=r.condition.map((t=>{const{selection:n,param:r,test:i,...o}=t;return r?t:{...o,test:_J(t,e)}}));else{const{selection:t,param:n,test:i,...o}=bJ(r.condition,e);r.condition=n?r.condition:{...o,test:_J(r.condition,e)}}return r}function xJ(t){const e=t.extent;if(null!==e&&void 0!==e&&e.selection){const{selection:n,...r}=e;return{...t,extent:{...r,param:n}}}return t}function _J(t,e){const n=t=>LI(t,(t=>{var n,r,i;const o={param:t,empty:null===(n=e.emptySelections[t])||void 0===n||n};return null!==(r=(i=e.selectionPredicates)[t])&&void 0!==r||(i[t]=[]),e.selectionPredicates[t].push(o),o}));return t.selection?n(t.selection):LI(t.test||t.filter,(t=>t.selection?n(t.selection):t))}class wJ extends DQ{map(t,e){var n;const r=null!==(n=e.selections)&&void 0!==n?n:[];if(t.params&&!fX(t)){const e=[];for(const n of t.params)rQ(n)?r.push(n):e.push(n);t.params=e}return e.selections=r,super.map(t,e)}mapUnit(t,e){var n;const r=e.selections;if(!r||!r.length)return t;const i=(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name),o=[];for(const a of r)if(a.views&&a.views.length)for(const e of a.views)(ir(e)&&(e===t.name||i.includes(e))||sn(e)&&e.map((t=>i.indexOf(t))).every(((t,e,n)=>-1!==t&&(0===e||t>n[e-1]))))&&o.push(a);else o.push(a);return o.length&&(t.params=o),t}}for(const n of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=wJ.prototype[n];wJ.prototype[n]=function(e,n){return t.call(this,e,kJ(e,n))}}function kJ(t,e){var n;return t.name?{...e,path:(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name)}:e}function AJ(t,e){void 0===e&&(e=wQ(t.config));const n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={config:e};return CJ.map(EJ.map(MJ.map(t,n),n),n)}(t,e),{width:r,height:i}=t,o=function(t,e,n){let{width:r,height:i}=e;const o=fX(t)||SQ(t),a={};o?"container"==r&&"container"==i?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==i&&(a.type="fit-y",a.contains="padding"):("container"==r&&(JZ(xZ("width")),r=void 0),"container"==i&&(JZ(xZ("height")),i=void 0));const s={type:"pad",...a,...n?SJ(n.autosize):{},...SJ(t.autosize)};"fit"!==s.type||o||(JZ(bZ),s.type="pad");"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&JZ(_Z("width"));"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&JZ(_Z("height"));if(CW(s,{type:"pad"}))return;return s}(n,{width:r,height:i,autosize:t.autosize},e);return{...n,...o?{autosize:o}:{}}}const EJ=new class extends DQ{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[FX,RX,qX,new qQ,new GQ]}map(t,e){if(fX(t)){const n=hX(t.encoding,DW),r=hX(t.encoding,FW),i=hX(t.encoding,TW);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=WQ(t.encoding,e.repeater),o={...t,...t.name?{name:[e.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{},...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,e);const a=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(o,e.config))return s.run(o,e,a);return o}mapRepeat(t,e){return function(t){return!sn(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r,...i}=t,{row:o,column:a,layer:s}=n,{repeater:l={},repeaterPrefix:u=""}=e;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:r}},e):{...i,layer:s.map((t=>{const n={...l,layer:t},i="".concat((r.name?"".concat(r.name,"_"):"")+u,"child__layer_").concat(sW(t)),o=this.mapLayerOrUnit(r,{...e,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:o,...a}=t;!sn(r)&&t.columns&&(t=II(t,["columns"]),JZ(SZ("repeat")));const s=[],{repeater:l={},repeaterPrefix:u=""}=e,c=!sn(r)&&r.row||[l?l.row:null],f=!sn(r)&&r.column||[l?l.column:null],d=sn(r)&&r||[l?l.repeat:null];for(const p of d)for(const t of c)for(const n of f){const o={repeat:p,row:t,column:n,layer:l.layer},a=(i.name?"".concat(i.name,"_"):"")+u+"child__"+(sn(r)?"".concat(sW(p)):(r.row?"row_".concat(sW(t)):"")+(r.column?"column_".concat(sW(n)):"")),c=this.map(i,{...e,repeater:o,repeaterPrefix:a});c.name=a,s.push(II(c,["data"]))}const h=sn(r)?t.columns:r.column?r.column.length:1;return{data:null!==(n=i.data)&&void 0!==n?n:o,align:"all",...a,columns:h,concat:s}}mapFacet(t,e){const{facet:n}=t;return fG(n)&&t.columns&&(t=II(t,["columns"]),JZ(SZ("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:o,config:a}=e,s=QQ({parentProjection:o,projection:r}),l=XQ({parentEncoding:i,encoding:WQ(n,e.repeater)});return this.mapUnit({...t,...s?{projection:s}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,e){const{row:n,column:r,facet:i,...o}=t.encoding,{mark:a,width:s,projection:l,height:u,view:c,params:f,encoding:d,...h}=t,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},e),g=WQ(o,e.repeater);return this.mapFacet({...h,...m,facet:p,spec:{...s?{width:s}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:a,encoding:g,...f?{params:f}:{}}},e)}getFacetMappingAndLayout(t,e){const{row:n,column:r,facet:i}=t;if(n||r){i&&JZ((a=[...n?[DW]:[],...r?[FW]:[]],"Facet encoding dropped as ".concat(a.join(" and ")," ").concat(a.length>1?"are":"is"," also specified.")));const e={},s={};for(const n of[DW,FW]){const r=t[n];if(r){const{align:t,center:i,spacing:a,columns:l,...u}=r;e[n]=u;for(const e of["align","center","spacing"]){var o;if(void 0!==r[e])null!==(o=s[e])&&void 0!==o||(s[e]={}),s[e][n]=r[e]}}}return{facetMapping:e,layout:s}}{const{align:t,center:n,spacing:r,columns:o,...a}=i;return{facetMapping:IQ(a,e.repeater),layout:{...t?{align:t}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}var a}mapLayer(t,e){let{parentEncoding:n,parentProjection:r,...i}=e;const{encoding:o,projection:a,...s}=t,l={...i,parentEncoding:XQ({parentEncoding:n,encoding:o,layer:!0}),parentProjection:QQ({parentProjection:r,projection:a})};return super.mapLayer({...s,...t.name?{name:[l.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{}},l)}},MJ=new class extends DQ{map(t,e){var n,r;return null!==(n=e.emptySelections)&&void 0!==n||(e.emptySelections={}),null!==(r=e.selectionPredicates)&&void 0!==r||(e.selectionPredicates={}),t=vJ(t,e),super.map(t,e)}mapLayerOrUnit(t,e){if((t=vJ(t,e)).encoding){const n={};for(const[r,i]of oW(t.encoding))n[r]=bJ(i,e);t={...t,encoding:n}}return super.mapLayerOrUnit(t,e)}mapUnit(t,e){const{selection:n,...r}=t;return n?{...r,params:oW(n).map((t=>{let[n,r]=t;const{init:i,bind:o,empty:a,...s}=r;"single"===s.type?(s.type="point",s.toggle=!1):"multi"===s.type&&(s.type="point"),e.emptySelections[n]="none"!==a;for(const u of iW(null!==(l=e.selectionPredicates[n])&&void 0!==l?l:{})){var l;u.empty="none"!==a}return{name:n,value:i,select:s,bind:o}}))}:t}},CJ=new wJ;function SJ(t){return ir(t)?{type:t}:null!==t&&void 0!==t?t:{}}const DJ=["background","padding"];function FJ(t,e){const n={};for(const r of DJ)t&&void 0!==t[r]&&(n[r]=nZ(t[r]));return e&&(n.params=t.params),n}class TJ{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.explicit=t,this.implicit=e}clone(){return new TJ(jI(this.explicit),jI(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return vW(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,e){let{value:n,explicit:r}=e;void 0!==n&&this.set(t,n,r)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,e){let{explicit:n,implicit:r}=e;void 0!==n[t]?this.set(t,n[t],!0):void 0!==r[t]&&this.set(t,r[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of rW(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function NJ(t){return{explicit:!0,value:t}}function OJ(t){return{explicit:!1,value:t}}function zJ(t){return(e,n,r,i)=>{const o=t(e.value,n.value);return o>0?e:o<0?n:RJ(e,n,r,i)}}function RJ(t,e,n,r){return t.explicit&&e.explicit&&JZ(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(SW(n)," and ").concat(SW(r),"). Using ").concat(SW(n),".")}(n,r,t.value,e.value)),t}function PJ(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:RJ;return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:CW(t.value,e.value)?t:i(t,e,n,r)}class BJ extends TJ{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function LJ(t){return"url"in t}function jJ(t){return"values"in t}function UJ(t){return"name"in t&&!LJ(t)&&!jJ(t)&&!qJ(t)}function qJ(t){return t&&(IJ(t)||WJ(t)||$J(t))}function IJ(t){return"sequence"in t}function WJ(t){return"sphere"in t}function $J(t){return"graticule"in t}var HJ;function ZJ(t){const{signals:e,hasLegend:n,index:r,...i}=t;return i.field=pW(i.field),i}function YJ(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ve;if(sn(t)){const r=t.map((t=>YJ(t,e,n)));return e?"[".concat(r.join(", "),"]"):r}return KZ(t)?n(e?oY(t):function(t){const e=iY(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n(SW(t)):t}function VJ(t,e){for(const r of iW(null!==(n=t.component.selection)&&void 0!==n?n:{})){var n;const i=r.name;let o="".concat(i).concat(b0,", ").concat("global"===r.resolve?"true":"{unit: ".concat(k0(t),"}"));for(const n of w0)n.defined(r)&&(n.signals&&(e=n.signals(t,r,e)),n.modifyExpr&&(o=n.modifyExpr(t,r,o)));e.push({name:i+x0,on:[{events:{signal:r.name+b0},update:"modify(".concat(hr(r.name+v0),", ").concat(o,")")}]})}return QJ(e)}function GJ(t,e){if(t.component.selection&&rW(t.component.selection).length){const n=hr(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:eL("pointermove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return QJ(e)}function XJ(t,e){for(const r of iW(null!==(n=t.component.selection)&&void 0!==n?n:{})){var n;for(const n of w0)n.defined(r)&&n.marks&&(e=n.marks(t,r,e))}return e}function QJ(t){return t.map((t=>(t.on&&!t.on.length&&delete t.on,t)))}!function(t){t[t.Raw=0]="Raw",t[t.Main=1]="Main",t[t.Row=2]="Row",t[t.Column=3]="Column",t[t.Lookup=4]="Lookup"}(HJ||(HJ={}));class JJ{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.includes(t)?JZ("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const n=t.parent.removeChild(t);this._parent=e,e.addChild(this,n),t.parent=this}}class KJ extends JJ{clone(){const t=new this.constructor;return t.debugName="clone_".concat(this.debugName),t._source=this._source,t._name="clone_".concat(this._name),t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output ".concat(xW())),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function tK(t){return void 0!==t.as}function eK(t){return"".concat(t,"_end")}class nK extends JJ{clone(){return new nK(null,jI(this.timeUnits))}constructor(t,e){super(t),this.timeUnits=e}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{const{field:i,timeUnit:o}=n;if(o){let a;if(lY(o)){if(l3(e)){const{mark:t,markDef:r,config:s}=e,l=gG({fieldDef:n,markDef:r,config:s});(FV(t)||l)&&(a={timeUnit:yY(o),field:i})}}else a={as:BG(n,{forAs:!0}),field:i,timeUnit:o};if(l3(e)){const{mark:t,markDef:i,config:o}=e,s=gG({fieldDef:n,markDef:i,config:o});FV(t)&&aH(r)&&.5!==s&&(a.rectBandPosition=s)}a&&(t[WI(a)]=a)}return t}),{});return nW(n)?null:new nK(t,n)}static makeFromTransform(t,e){const{timeUnit:n,...r}={...e},i={...r,timeUnit:yY(n)};return new nK(t,{[WI(i)]:i})}merge(t){this.timeUnits={...this.timeUnits};for(const e in t.timeUnits)this.timeUnits[e]||(this.timeUnits[e]=t.timeUnits[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}removeFormulas(t){const e={};for(const[n,r]of oW(this.timeUnits)){const i=tK(r)?r.as:"".concat(r.field,"_end");t.has(i)||(e[n]=r)}this.timeUnits=e}producedFields(){return new Set(iW(this.timeUnits).map((t=>tK(t)?t.as:eK(t.field))))}dependentFields(){return new Set(iW(this.timeUnits).map((t=>t.field)))}hash(){return"TimeUnit ".concat(WI(this.timeUnits))}assemble(){const t=[];for(const e of iW(this.timeUnits)){const{rectBandPosition:n}=e,r=yY(e.timeUnit);if(tK(e)){const{field:i,as:o}=e,{unit:a,utc:s,...l}=r,u=[o,"".concat(o,"_end")];t.push({field:pW(i),type:"timeunit",...a?{units:dY(a)}:{},...s?{timezone:"utc"}:{},...l,as:u}),t.push(...aK(u,n,r))}else if(e){const{field:i}=e,o=i.replaceAll("\\.","."),a=oK({timeUnit:r,field:o}),s=eK(o);t.push({type:"formula",expr:a,as:s}),t.push(...aK([o,s],n,r))}}return t}}const rK="offsetted_rect_start",iK="offsetted_rect_end";function oK(t){let{timeUnit:e,field:n,reverse:r}=t;const{unit:i,utc:o}=e,a=hY(i),{part:s,step:l}=xY(a,e.step);return"".concat(o?"utcOffset":"timeOffset","('").concat(s,"', datum['").concat(n,"'], ").concat(r?-l:l,")")}function aK(t,e,n){let[r,i]=t;if(void 0!==e&&.5!==e){const t="datum['".concat(r,"']"),o="datum['".concat(i,"']");return[{type:"formula",expr:sK([oK({timeUnit:n,field:r,reverse:!0}),t],e+.5),as:"".concat(r,"_").concat(rK)},{type:"formula",expr:sK([t,o],e+.5),as:"".concat(r,"_").concat(iK)}]}return[]}function sK(t,e){let[n,r]=t;return"".concat(1-e," * ").concat(n," + ").concat(e," * ").concat(r)}const lK="_tuple_fields";class uK{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.items=e,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const cK={defined:()=>!0,parse:(t,e,n)=>{var r;const i=e.name,o=null!==(r=e.project)&&void 0!==r?r:e.project=new uK,a={},s={},l=new Set,u=(t,e)=>{const n="visual"===e?t.channel:t.field;let r=sW("".concat(i,"_").concat(n));for(let o=1;l.has(r);o++)r=sW("".concat(i,"_").concat(n,"_").concat(o));return l.add(r),{[e]:r}},c=e.type,f=t.config.selection[c],d=void 0!==n.value?Nn(n.value):null;let{fields:h,encodings:p}=ln(n.select)?n.select:{};if(!h&&!p&&d)for(const v of d)if(ln(v))for(const t of rW(v)){var m;if(F$[t])(p||(p=[])).push(t);else if("interval"===c)JZ('Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.'),p=f.encodings;else(null!==(m=h)&&void 0!==m?m:h=[]).push(t)}h||p||(p=f.encodings,"fields"in f&&(h=f.fields));for(const v of null!==(g=p)&&void 0!==g?g:[]){var g;const e=t.fieldDef(v);if(e){let n=e.field;if(e.aggregate){JZ(EZ(v,e.aggregate));continue}if(!n){JZ(AZ(v));continue}if(e.timeUnit&&!lY(e.timeUnit)){n=t.vgField(v);const r={timeUnit:e.timeUnit,as:n,field:e.field};s[WI(r)]=r}if(!a[n]){const r={field:n,channel:v,type:"interval"===c&&AH(v)&&KY(t.getScaleComponent(v).get("type"))?"R":e.bin?"R-RE":"E",index:o.items.length};r.signals={...u(r,"data"),...u(r,"visual")},o.items.push(a[n]=r),o.hasField[n]=a[n],o.hasSelectionId=o.hasSelectionId||n===KX,m$(v)?(r.geoChannel=v,r.channel=p$(v),o.hasChannel[r.channel]=a[n]):o.hasChannel[v]=a[n]}}else JZ(AZ(v))}for(const v of null!==(y=h)&&void 0!==y?y:[]){var y;if(o.hasField[v])continue;const t={type:"E",field:v,index:o.items.length};t.signals={...u(t,"data")},o.items.push(t),o.hasField[v]=t,o.hasSelectionId=o.hasSelectionId||v===KX}d&&(e.init=d.map((t=>o.items.map((e=>ln(t)?void 0!==t[e.geoChannel||e.channel]?t[e.geoChannel||e.channel]:t[e.field]:t))))),nW(s)||(o.timeUnit=new nK(null,s))},signals:(t,e,n)=>{const r=e.name+lK,i=n.filter((t=>t.name===r));return i.length>0||e.project.hasSelectionId?n:n.concat({name:r,value:e.project.items.map(ZJ)})}},fK=cK,dK={defined:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!AH(i))continue;const o=t.getScaleComponent(i),a=o?o.get("type"):void 0;o&&KY(a)?(o.set("selectionExtent",{param:e.name,field:r.field},!0),n.push(r)):JZ("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter((t=>0===n.filter((e=>e.name===t.signals.data)).length));if(!t.parent||mK(t)||0===r.length)return n;const i=n.filter((t=>t.name===e.name))[0];let o=i.update;if(o.indexOf(_0)>=0)i.update="{".concat(r.map((t=>"".concat(hr(pW(t.field)),": ").concat(t.signals.data))).join(", "),"}");else{for(const t of r){const e="".concat(hr(pW(t.field)),": ").concat(t.signals.data);o.includes(e)||(o="".concat(o.substring(0,o.length-1),", ").concat(e,"}"))}i.update=o}return n.concat(r.map((t=>({name:t.signals.data}))))},signals:(t,e,n)=>{if(t.parent&&!mK(t))for(const r of e.scales){const t=n.filter((t=>t.name===r.signals.data))[0];t.push="outer",delete t.value,delete t.update}return n}},hK=dK;function pK(t,e){const n=hr(t.scaleName(e));return"domain(".concat(n,")")}function mK(t){var e;return t.parent&&f3(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:mK(t.parent.parent))}const gK="_brush",yK="_scale_trigger",vK="geo_interval_init_tick",bK="_init",xK={defined:t=>"interval"===t.type,parse:(t,e,n)=>{var r;if(t.hasProjection){const t={...ln(n.select)?n.select:{}};t.fields=[KX],t.encodings||(t.encodings=n.value?rW(n.value):[WW,IW]),n.select={type:"interval",...t}}if(e.translate&&!hK.defined(e)){const t="!event.item || event.item.mark.name !== ".concat(hr(e.name+gK));for(const n of e.events){var i;if(!n.between){JZ("".concat(n," is not an ordered event stream for interval selections."));continue}const e=Nn(null!==(i=(r=n.between[0]).filter)&&void 0!==i?i:r.filter=[]);e.indexOf(t)<0&&e.push(t)}}},signals:(t,e,n)=>{const r=e.name,i=r+b0,o=iW(e.project.hasChannel).filter((t=>t.channel===NW||t.channel===OW)),a=e.init?e.init[0]:null;if(n.push(...o.reduce(((n,r)=>n.concat(function(t,e,n,r){const i=!t.hasProjection,o=n.channel,a=n.signals.visual,s=hr(i?t.scaleName(o):t.projectionName()),l=t=>"scale(".concat(s,", ").concat(t,")"),u=t.getSizeSignalRef(o===NW?"width":"height").signal,c="".concat(o,"(unit)"),f=e.events.reduce(((t,e)=>[...t,{events:e.between[0],update:"[".concat(c,", ").concat(c,"]")},{events:e,update:"[".concat(a,"[0], clamp(").concat(c,", 0, ").concat(u,")]")}]),[]);if(i){const i=n.signals.data,u=hK.defined(e),c=t.getScaleComponent(o),d=c?c.get("type"):void 0,h=r?{init:YJ(r,!0,l)}:{value:[]};return f.push({events:{signal:e.name+yK},update:KY(d)?"[".concat(l("".concat(i,"[0]")),", ").concat(l("".concat(i,"[1]")),"]"):"[0, 0]"}),u?[{name:i,on:[]}]:[{name:a,...h,on:f},{name:i,...r?{init:YJ(r)}:{},on:[{events:{signal:a},update:"".concat(a,"[0] === ").concat(a,"[1] ? null : invert(").concat(s,", ").concat(a,")")}]}]}{const t=o===NW?0:1,n=e.name+bK,i=r?{init:"[".concat(n,"[0][").concat(t,"], ").concat(n,"[1][").concat(t,"]]")}:{value:[]};return[{name:a,...i,on:f}]}}(t,e,r,a&&a[r.index]))),[])),t.hasProjection){const s=hr(t.projectionName()),l=t.projectionName()+"_center",{x:u,y:c}=e.project.hasChannel,f=u&&u.signals.visual,d=c&&c.signals.visual,h=u?a&&a[u.index]:"".concat(l,"[0]"),p=c?a&&a[c.index]:"".concat(l,"[1]"),m=e=>t.getSizeSignalRef(e).signal,g="["+"[".concat(f?f+"[0]":"0",", ").concat(d?d+"[0]":"0","],")+"[".concat(f?f+"[1]":m("width"),", ")+"".concat(d?d+"[1]":m("height"),"]")+"]";if(a&&(n.unshift({name:r+bK,init:"[scale(".concat(s,", [").concat(u?h[0]:h,", ").concat(c?p[0]:p,"]), ")+"scale(".concat(s,", [").concat(u?h[1]:h,", ").concat(c?p[1]:p,"])]")}),!u||!c)){const t=n.find((t=>t.name===l));t||n.unshift({name:l,update:"invert(".concat(s,", [").concat(m("width"),"/2, ").concat(m("height"),"/2])")})}const y="intersect(".concat(g,", {markname: ").concat(hr(t.getName("marks")),"}, unit.mark)"),v="{unit: ".concat(k0(t),"}"),b="vlSelectionTuples(".concat(y,", ").concat(v,")"),x=o.map((t=>t.signals.visual));return n.concat({name:i,on:[{events:[...x.length?[{signal:x.join(" || ")}]:[],...a?[{signal:vK}]:[]],update:b}]})}{if(!hK.defined(e)){const e=r+yK,i=o.map((e=>{const n=e.channel,{data:r,visual:i}=e.signals,o=hr(t.scaleName(n)),a=KY(t.getScaleComponent(n).get("type"))?"+":"";return"(!isArray(".concat(r,") || ")+"(".concat(a,"invert(").concat(o,", ").concat(i,")[0] === ").concat(a).concat(r,"[0] && ")+"".concat(a,"invert(").concat(o,", ").concat(i,")[1] === ").concat(a).concat(r,"[1]))")}));i.length&&n.push({name:e,value:{},on:[{events:o.map((e=>({scale:t.scaleName(e.channel)}))),update:i.join(" && ")+" ? ".concat(e," : {}")}]})}const s=o.map((t=>t.signals.data)),l="unit: ".concat(k0(t),", fields: ").concat(r+lK,", values");return n.concat({name:i,...a?{init:"{".concat(l,": ").concat(YJ(a),"}")}:{},...s.length?{on:[{events:[{signal:s.join(" || ")}],update:"".concat(s.join(" && ")," ? {").concat(l,": [").concat(s,"]} : null")}]}:{}})}},topLevelSignals:(t,e,n)=>{if(l3(t)&&t.hasProjection&&e.init){const t=n.filter((t=>t.name===vK));t.length||n.unshift({name:vK,value:null,on:[{events:"timer{1}",update:"".concat(vK," === null ? {} : ").concat(vK)}]})}return n},marks:(t,e,n)=>{const r=e.name,{x:i,y:o}=e.project.hasChannel,a=null===i||void 0===i?void 0:i.signals.visual,s=null===o||void 0===o?void 0:o.signals.visual,l="data(".concat(hr(e.name+v0),")");if(hK.defined(e)||!i&&!o)return n;const u={x:void 0!==i?{signal:"".concat(a,"[0]")}:{value:0},y:void 0!==o?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==i?{signal:"".concat(a,"[1]")}:{field:{group:"width"}},y2:void 0!==o?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===e.resolve)for(const m of rW(u))u[m]=[{test:"".concat(l,".length && ").concat(l,"[0].unit === ").concat(k0(t)),...u[m]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=e.mark,p=rW(h).reduce(((t,e)=>(t[e]=[{test:[void 0!==i&&"".concat(a,"[0] !== ").concat(a,"[1]"),void 0!==o&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter((t=>t)).join(" && "),value:h[e]},{value:null}],t)),{});return[{name:"".concat(r+gK,"_bg"),type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:u}},...n,{name:r+gK,type:"rect",clip:!0,encode:{enter:{...d?{cursor:{value:d}}:{},fill:{value:"transparent"}},update:{...u,...p}}}]}},_K=xK;const wK={defined:t=>"point"===t.type,signals:(t,e,n)=>{var r;const i=e.name,o=i+lK,a=e.project,s="(item().isVoronoi ? datum.datum : datum)",l=iW(null!==(r=t.component.selection)&&void 0!==r?r:{}).reduce(((t,e)=>"interval"===e.type?t.concat(e.name+gK):t),[]).map((t=>"indexof(item().mark.name, '".concat(t,"') < 0"))).join(" && "),u="datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0".concat(l?" && ".concat(l):"");let c="unit: ".concat(k0(t),", ");if(e.project.hasSelectionId)c+="".concat(KX,": ").concat(s,"[").concat(hr(KX),"]");else{const e=a.items.map((e=>{const n=t.fieldDef(e.channel);return null!==n&&void 0!==n&&n.bin?"[".concat(s,"[").concat(hr(t.vgField(e.channel,{})),"], ")+"".concat(s,"[").concat(hr(t.vgField(e.channel,{binSuffix:"end"})),"]]"):"".concat(s,"[").concat(hr(e.field),"]")})).join(", ");c+="fields: ".concat(o,", values: [").concat(e,"]")}const f=e.events;return n.concat([{name:i+b0,on:f?[{events:f,update:"".concat(u," ? {").concat(c,"} : null"),force:!0}]:[]}])}},kK=wK;function AK(t,e,n,r){const i=xG(e)&&e.condition,o=r(e);if(i){const e=Nn(i).map((e=>{const n=r(e);if(function(t){return t.param}(e)){const{param:r,empty:i}=e;return{test:F0(t,{param:r,empty:i}),...n}}return{test:N0(t,e.test),...n}}));return{[n]:[...e,...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function EK(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";const n=t.encoding[e];return AK(t,n,e,(e=>MK(e,t.config)))}function MK(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(t){if(TG(t))return iZ(t.value);if(DG(t)){const{format:r,formatType:i}=HG(t);return XV({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function CK(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{encoding:n,markDef:r,config:i,stack:o}=t,a=n.tooltip;if(sn(a))return{tooltip:DK({tooltip:a},o,i,e)};{const s=e.reactiveGeom?"datum.datum":"datum";return AK(t,a,"tooltip",(t=>{const a=MK(t,i,s);if(a)return a;if(null===t)return;let l=cZ("tooltip",r,i);return!0===l&&(l={content:"encoding"}),ir(l)?{value:l}:ln(l)?GH(l)?l:"encoding"===l.content?DK(n,o,i,e):{signal:s}:void 0}))}}function SK(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={...n,...n.tooltipFormat},o={},a=r?"datum.datum":"datum",s=[];function l(n,r){var l;const u=z$(r),c=FG(n)?n:{...n,type:t[u].type},f=Nn(c.title||$G(c,i)).join(", ").replaceAll(/"/g,'\\"');let d;if(aH(r)){const e="x"===r?"x2":"y2",n=ZG(t[e]);if(qH(c.bin)&&n){const t=BG(c,{expr:a}),r=BG(n,{expr:a}),{format:s,formatType:l}=HG(c);d=iG(t,r,s,l,i),o[e]=!0}}if((aH(r)||r===UW||r===LW)&&e&&e.fieldChannel===r&&"normalize"===e.offset){const{format:t,formatType:e}=HG(c);d=XV({fieldOrDatumDef:c,format:t,formatType:e,expr:a,config:i,normalizeStack:!0}).signal}null!==(l=d)&&void 0!==l||(d=MK(c,i,a).signal),s.push({channel:r,key:f,value:d})}xX(t,((t,e)=>{kG(t)?l(t,e):_G(t)&&l(t.condition,e)}));const u={};for(const{channel:c,key:f,value:d}of s)o[c]||u[f]||(u[f]=d);return u}function DK(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=SK(t,e,n,{reactiveGeom:r}),o=oW(i).map((t=>{let[e,n]=t;return'"'.concat(e,'": ').concat(n)}));return o.length>0?{signal:"{".concat(o.join(", "),"}")}:void 0}function FK(t){const{markDef:e,config:n}=t,r=cZ("aria",e,n);return!1===r?{}:{...r?{aria:r}:{},...TK(t),...NK(t)}}function TK(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=cZ("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:e in KH?{}:{ariaRoleDescription:{value:e}}}function NK(t){const{encoding:e,markDef:n,config:r,stack:i}=t,o=e.description;if(o)return AK(t,o,"description",(e=>MK(e,t.config)));const a=cZ("description",n,r);if(null!=a)return{description:iZ(a)};if(!1===r.aria)return{};const s=SK(e,i,r);return nW(s)?void 0:{description:{signal:oW(s).map(((t,e)=>{let[n,r]=t;return'"'.concat(e>0?"; ":"").concat(n,': " + (').concat(r,")")})).join(" + ")}}}function OK(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{markDef:r,encoding:i,config:o}=e,{vgChannel:a}=n;let{defaultRef:s,defaultValue:l}=n;var u;void 0===s&&(null!==(u=l)&&void 0!==u||(l=cZ(t,r,o,{vgChannel:a,ignoreVgConfig:!0})),void 0!==l&&(s=iZ(l)));const c=i[t];return AK(e,c,null!==a&&void 0!==a?a:t,(n=>HV({channel:t,channelDef:n,markDef:r,config:o,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:s})))}function zK(t){var e,n,r,i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0};const{markDef:a,encoding:s,config:l}=t,{type:u}=a,c=null!==(e=o.filled)&&void 0!==e?e:cZ("filled",a,l),f=HI(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,d=null!==(n=null!==(r=cZ(!0===c?"color":void 0,a,l,{vgChannel:"fill"}))&&void 0!==r?r:l.mark[!0===c&&"color"])&&void 0!==n?n:f,h=null!==(i=cZ(!1===c?"color":void 0,a,l,{vgChannel:"stroke"}))&&void 0!==i?i:l.mark[!1===c&&"color"],p=c?"fill":"stroke",m={...d?{fill:iZ(d)}:{},...h?{stroke:iZ(h)}:{}};return a.color&&(c?a.fill:a.stroke)&&JZ(zZ("property",{fill:"fill"in a,stroke:"stroke"in a})),{...m,...OK("color",t,{vgChannel:p,defaultValue:c?d:h}),...OK("fill",t,{defaultValue:s.fill?d:void 0}),...OK("stroke",t,{defaultValue:s.stroke?h:void 0})}}function RK(t){const{encoding:e,mark:n}=t,r=e.order;return!DV(n)&&TG(r)?AK(t,r,"zindex",(t=>iZ(t.value))):{}}function PK(t){let{channel:e,markDef:n,encoding:r={},model:i,bandPosition:o}=t;const a="".concat(e,"Offset"),s=n[a],l=r[a];if(("xOffset"===a||"yOffset"===a)&&l){return{offsetType:"encoding",offset:HV({channel:a,channelDef:l,markDef:n,config:null===i||void 0===i?void 0:i.config,scaleName:i.scaleName(a),scale:i.getScaleComponent(a),stack:null,defaultRef:iZ(s),bandPosition:o})}}const u=n[a];return u?{offsetType:"visual",offset:u}:{}}function BK(t,e,n){let{defaultPos:r,vgChannel:i}=n;const{encoding:o,markDef:a,config:s,stack:l}=e,u=o[t],c=o[P$(t)],f=e.scaleName(t),d=e.getScaleComponent(t),{offset:h,offsetType:p}=PK({channel:t,markDef:a,encoding:o,model:e,bandPosition:.5}),m=LK({model:e,defaultPos:r,channel:t,scaleName:f,scale:d}),g=!u&&aH(t)&&(o.latitude||o.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,scaleName:r,stack:i,offset:o,markDef:a}=t;if(DG(n)&&i&&e===i.fieldChannel){if(kG(n)){let t=n.bandPosition;if(void 0!==t||"text"!==a.type||"radius"!==e&&"theta"!==e||(t=.5),void 0!==t)return $V({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:t,offset:o})}return WV(n,r,{suffix:"end"},{offset:o})}return UV(t)}({channel:t,channelDef:u,channel2Def:c,markDef:a,config:s,scaleName:f,scale:d,stack:l,offset:h,defaultRef:m,bandPosition:"encoding"===p?0:void 0});return g?{[i||t]:g}:void 0}function LK(t){let{model:e,defaultPos:n,channel:r,scaleName:i,scale:o}=t;const{markDef:a,config:s}=e;return()=>{const t=z$(r),l=R$(r),u=cZ(r,a,s,{vgChannel:l});if(void 0!==u)return ZV(r,u);switch(n){case"zeroOrMin":case"zeroOrMax":if(i){const t=o.get("type");if(HI([qY.LOG,qY.TIME,qY.UTC],t));else if(o.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===n)return"y"===t?{field:{group:"height"}}:{value:0};switch(t){case"radius":return{signal:"min(".concat(e.width.signal,",").concat(e.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...e[B$(r)],mult:.5}}}}const jK={left:"x",center:"xc",right:"x2"},UK={top:"y",middle:"yc",bottom:"y2"};function qK(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===t||"theta"===t)return R$(t);const i="x"===t?"align":"baseline",o=cZ(i,e,n);let a;return GH(o)?(JZ(function(t){return"The ".concat(t," for range marks cannot be an expression")}(i)),a=void 0):a=o,"x"===t?jK[a||("top"===r?"left":"center")]:UK[a||r]}function IK(t,e,n){let{defaultPos:r,defaultPos2:i,range:o}=n;return o?WK(t,e,{defaultPos:r,defaultPos2:i}):BK(t,e,{defaultPos:r})}function WK(t,e,n){let{defaultPos:r,defaultPos2:i}=n;const{markDef:o,config:a}=e,s=P$(t),l=B$(t),u=function(t,e,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=t,l=z$(n),u=B$(n),c=R$(n),f=r[l],d=t.scaleName(l),h=t.getScaleComponent(l),{offset:p}=PK(n in r||n in o?{channel:n,markDef:o,encoding:r,model:t}:{channel:l,markDef:o,encoding:r,model:t});if(!f&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const e=B$(n),r=t.markDef[e];return null!=r?{[e]:{value:r}}:{[c]:{field:t.getName(n)}}}const m=function(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:o,scaleName:a,scale:s,stack:l,offset:u,defaultRef:c}=t;if(DG(n)&&l&&e.charAt(0)===l.fieldChannel.charAt(0))return WV(n,a,{suffix:"start"},{offset:u});return UV({channel:e,channelDef:r,scaleName:a,scale:s,stack:l,markDef:i,config:o,offset:u,defaultRef:c})}({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:p,defaultRef:void 0});if(void 0!==m)return{[c]:m};return $K(n,o)||$K(n,{[n]:dZ(n,o,s.style),[u]:dZ(u,o,s.style)})||$K(n,s[i])||$K(n,s.mark)||{[c]:LK({model:t,defaultPos:e,channel:n,scaleName:d,scale:h})()}}(e,i,s);return{...BK(t,e,{defaultPos:r,vgChannel:u[l]?qK(t,o,a):R$(t)}),...u}}function $K(t,e){const n=B$(t),r=R$(t);if(void 0!==e[r])return{[r]:ZV(t,e[r])};if(void 0!==e[t])return{[r]:ZV(t,e[t])};if(e[n]){const r=e[n];if(!PV(r))return{[n]:ZV(t,r)};JZ(function(t){return"Position range does not support relative band size for ".concat(t,".")}(n))}}function HK(t,e){var n,r;const{config:i,encoding:o,markDef:a}=t,s=a.type,l=P$(e),u=B$(e),c=o[e],f=o[l],d=t.getScaleComponent(e),h=d?d.get("type"):void 0,p=a.orient,m=null!==(n=null!==(r=o[u])&&void 0!==r?r:o.size)&&void 0!==n?n:cZ("size",a,i,{vgChannel:u}),g=L$(e),y="bar"===s&&("x"===e?"vertical"===p:"horizontal"===p);return!kG(c)||!(UH(c.bin)||qH(c.bin)||c.timeUnit&&!f)||m&&!PV(m)||o[g]||JY(h)?(DG(c)&&JY(h)||y)&&!f?function(t,e,n){var r,i;const{markDef:o,encoding:a,config:s,stack:l}=n,u=o.orient,c=n.scaleName(e),f=n.getScaleComponent(e),d=B$(e),h=P$(e),p=L$(e),m=n.scaleName(p),g=n.getScaleComponent(j$(e)),y="horizontal"===u&&"y"===e||"vertical"===u&&"x"===e;let v;(a.size||o.size)&&(y?v=OK("size",n,{vgChannel:d,defaultRef:iZ(o.size)}):JZ(function(t){return'Cannot apply size to non-oriented mark "'.concat(t,'".')}(o.type)));const b=!!v,x=yG({channel:e,fieldDef:t,markDef:o,config:s,scaleType:null===(r=f||g)||void 0===r?void 0:r.get("type"),useVlSizeChannel:y});v=v||{[d]:ZK(d,m||c,g||f,s,x,!!t,o.type)};const _="band"===(null===(i=f||g)||void 0===i?void 0:i.get("type"))&&PV(x)&&!b?"top":"middle",w=qK(e,o,s,_),k="xc"===w||"yc"===w,{offset:A,offsetType:E}=PK({channel:e,markDef:o,encoding:a,model:n,bandPosition:k?.5:0}),M=UV({channel:e,channelDef:t,markDef:o,config:s,scaleName:c,scale:f,stack:l,offset:A,defaultRef:LK({model:n,defaultPos:"mid",channel:e,scaleName:c,scale:f}),bandPosition:k?"encoding"===E?0:.5:GH(x)?{signal:"(1-".concat(x,")/2")}:PV(x)?(1-x.band)/2:0});if(d)return{[w]:M,...v};{const t=R$(h),e=v[d],n=A?{...e,offset:A}:e;return{[w]:M,[t]:sn(M)?[M[0],{...M[1],offset:n}]:{...M,offset:n}}}}(c,e,t):WK(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function(t){var e,n,r;let{fieldDef:i,fieldDef2:o,channel:a,model:s}=t;const{config:l,markDef:u,encoding:c}=s,f=s.getScaleComponent(a),d=s.scaleName(a),h=f?f.get("type"):void 0,p=f.get("reverse"),m=yG({channel:a,fieldDef:i,markDef:u,config:l,scaleType:h}),g=null===(e=s.component.axes[a])||void 0===e?void 0:e[0],y=null!==(n=null===g||void 0===g?void 0:g.get("translate"))&&void 0!==n?n:.5,v=aH(a)&&null!==(r=cZ("binSpacing",u,l))&&void 0!==r?r:0,b=P$(a),x=R$(a),_=R$(b),w=fZ("minBandSize",u,l),{offset:k}=PK({channel:a,markDef:u,encoding:c,model:s,bandPosition:0}),{offset:A}=PK({channel:b,markDef:u,encoding:c,model:s,bandPosition:0}),E=function(t){let{scaleName:e,fieldDef:n}=t;const r=BG(n,{expr:"datum"}),i=BG(n,{expr:"datum",suffix:"end"});return'abs(scale("'.concat(e,'", ').concat(i,') - scale("').concat(e,'", ').concat(r,"))")}({fieldDef:i,scaleName:d}),M=YK(a,v,p,y,k,w,E),C=YK(b,v,p,y,null!==A&&void 0!==A?A:k,w,E),S=GH(m)?{signal:"(1-".concat(m.signal,")/2")}:PV(m)?(1-m.band)/2:.5,D=gG({fieldDef:i,fieldDef2:o,markDef:u,config:l});if(UH(i.bin)||i.timeUnit){const t=i.timeUnit&&.5!==D;return{[_]:VK({fieldDef:i,scaleName:d,bandPosition:S,offset:C,useRectOffsetField:t}),[x]:VK({fieldDef:i,scaleName:d,bandPosition:GH(S)?{signal:"1-".concat(S.signal)}:1-S,offset:M,useRectOffsetField:t})}}if(qH(i.bin)){const t=WV(i,d,{},{offset:C});if(kG(o))return{[_]:t,[x]:WV(o,d,{},{offset:M})};if(IH(i.bin)&&i.bin.step)return{[_]:t,[x]:{signal:'scale("'.concat(d,'", ').concat(BG(i,{expr:"datum"})," + ").concat(i.bin.step,")"),offset:M}}}return void JZ(VZ(b))}({fieldDef:c,fieldDef2:f,channel:e,model:t})}function ZK(t,e,n,r,i,o,a){if(PV(i)){if(!n)return{mult:i.band,field:{group:t}};{const t=n.get("type");if("band"===t){let t="bandwidth('".concat(e,"')");1!==i.band&&(t="".concat(i.band," * ").concat(t));const n=fZ("minBandSize",{type:a},r);return{signal:n?"max(".concat(sZ(n),", ").concat(t,")"):t}}1!==i.band&&(JZ(function(t){return"Cannot use the relative band size with ".concat(t," scale.")}(t)),i=void 0)}}else{if(GH(i))return i;if(i)return{value:i}}if(n){const t=n.get("range");if(XH(t)&&nr(t.step))return{value:t.step-2}}if(!o){const{bandPaddingInner:e,barBandPaddingInner:n,rectBandPaddingInner:i}=r.scale,o=vW(e,"bar"===a?n:i);if(GH(o))return{signal:"(1 - (".concat(o.signal,")) * ").concat(t)};if(nr(o))return{signal:"".concat(1-o," * ").concat(t)}}return{value:hQ(r.view,t)-2}}function YK(t,e,n,r,i,o,a){if(d$(t))return 0;const s="x"===t||"y2"===t,l=s?-e/2:e/2;if(GH(n)||GH(i)||GH(r)||o){const t=sZ(n),e=sZ(i),u=sZ(r),c=sZ(o),f=s?"":"-",d=o?"(".concat(a," < ").concat(c," ? ").concat(f,"0.5 * (").concat(c," - (").concat(a,")) : ").concat(l,")"):l;return{signal:(u?"".concat(u," + "):"")+(t?"(".concat(t," ? -1 : 1) * "):"")+(e?"(".concat(e," + ").concat(d,")"):d)}}return i=i||0,r+(n?-i-l:+i+l)}function VK(t){let{fieldDef:e,scaleName:n,bandPosition:r,offset:i,useRectOffsetField:o}=t;return $V({scaleName:n,fieldOrDatumDef:e,bandPosition:r,offset:i,...o?{startSuffix:rK,endSuffix:iK}:{}})}const GK=new Set(["aria","width","height"]);function XK(t,e){const{fill:n,stroke:r}="include"===e.color?zK(t):{};return{...JK(t.markDef,e),...QK(t,"fill",n),...QK(t,"stroke",r),...OK("opacity",t),...OK("fillOpacity",t),...OK("strokeOpacity",t),...OK("strokeWidth",t),...OK("strokeDash",t),...RK(t),...CK(t),...EK(t,"href"),...FK(t)}}function QK(t,e,n){const{config:r,mark:i,markDef:o}=t;if("hide"===cZ("invalid",o,r)&&n&&!DV(i)){const r=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum"});o&&KY(i)&&(e[o]=!0)}return e}),{}),o=rW(i);if(o.length>0){const t=n?"||":"&&";return o.map((t=>IV(t,n))).join(" ".concat(t," "))}return}(t,{invalid:!0,channels:kH});if(r)return{[e]:[{test:r,value:null},...Nn(n)]}}return n?{[e]:n}:{}}function JK(t,e){return JH.reduce(((n,r)=>(GK.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=iZ(t[r])),n)),{})}function KK(t){const{config:e,markDef:n}=t;if(cZ("invalid",n,e)){const e=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){var i;const o=r.get("type"),a=t.vgField(n,{expr:"datum",binSuffix:null!==(i=t.stack)&&void 0!==i&&i.impute?"mid":void 0});a&&KY(o)&&(e[a]=!0)}return e}),{}),o=rW(i);if(o.length>0){const t=n?"||":"&&";return o.map((t=>IV(t,n))).join(" ".concat(t," "))}return}(t,{channels:oH});if(e)return{defined:{signal:e}}}return{}}function t0(t,e){if(void 0!==e)return{[t]:iZ(e)}}const e0="voronoi",n0={defined:t=>"point"===t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName(e0)},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,o=t.mark;if(DV(o))return JZ('The "nearest" transform is not supported for '.concat(o," marks.")),n;const a={name:t.getName(e0),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...CK(t,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let s=0,l=!1;return n.forEach(((e,n)=>{var r;const i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?s=n:i.indexOf(e0)>=0&&(l=!0)})),l||n.splice(s+1,0,a),n}},r0=n0,i0={defined:t=>"point"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!eQ(t.bind),parse:(t,e,n)=>E0(e,n),topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,o=e.bind,a=e.init&&e.init[0],s=r0.defined(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((t,i)=>{const l=sW("".concat(r,"_").concat(t.field)),u=n.filter((t=>t.name===l));var c,f;u.length||n.unshift({name:l,...a?{init:YJ(a[i])}:{value:null},on:e.events?[{events:e.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(s,"[").concat(hr(t.field),"] : null")}]:[],bind:null!==(c=null!==(f=o[t.field])&&void 0!==f?f:o[t.channel])&&void 0!==c?c:o})})),n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.filter((t=>t.name===r+b0))[0],a=r+lK,s=i.items.map((t=>sW("".concat(r,"_").concat(t.field)))),l=s.map((t=>"".concat(t," !== null"))).join(" && ");return s.length&&(o.update="".concat(l," ? {fields: ").concat(a,", values: [").concat(s.join(", "),"]} : null")),delete o.value,delete o.on,n}},o0=i0,a0="_toggle",s0={defined:t=>"point"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+a0,value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+b0,r=e.name+a0;return"".concat(r," ? null : ").concat(n,", ")+("global"===e.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(k0(t),"}, "))+"".concat(r," ? ").concat(n," : null")}},l0={defined:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e)=>{e.clear&&(e.clear=ir(e.clear)?eL(e.clear,"view"):e.clear)},topLevelSignals:(t,e,n)=>{if(o0.defined(e))for(const r of e.project.items){const t=n.findIndex((t=>t.name===sW("".concat(e.name,"_").concat(r.field))));-1!==t&&n[t].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const i of e.project.items){const t=n.findIndex((t=>t.name===i.signals.visual));if(r(t,"[0, 0]"),-1===t){r(n.findIndex((t=>t.name===i.signals.data)),"null")}}else{let t=n.findIndex((t=>t.name===e.name+b0));r(t,"null"),s0.defined(e)&&(t=n.findIndex((t=>t.name===e.name+a0)),r(t,"false"))}return n}},u0={defined:t=>{const e="global"===t.resolve&&t.bind&&eQ(t.bind),n=1===t.project.items.length&&t.project.items[0].field!==KX;return e&&!n&&JZ("Legend bindings are only supported for selections over an individual field or encoding channel."),e&&n},parse:(t,e,n)=>{const r=jI(n);if(r.select=ir(r.select)?{type:r.select,toggle:e.toggle}:{...r.select,toggle:e.toggle},E0(e,r),ln(n.select)&&(n.select.on||n.select.clear)){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events){var i;n.filter=Nn(null!==(i=n.filter)&&void 0!==i?i:[]),n.filter.includes(t)||n.filter.push(t)}}const o=nQ(e.bind)?e.bind.legend:"click",a=ir(o)?eL(o,"view"):Nn(o);e.bind={legend:{merge:a}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=nQ(e.bind)&&e.bind.legend,o=t=>e=>{const n=jI(e);return n.markname=t,n};for(const a of e.project.items){if(!a.hasLegend)continue;const t="".concat(sW(a.field),"_legend"),s="".concat(r,"_").concat(t),l=n.filter((t=>t.name===s));if(0===l.length){const r=i.merge.map(o("".concat(t,"_symbols"))).concat(i.merge.map(o("".concat(t,"_labels")))).concat(i.merge.map(o("".concat(t,"_entries"))));n.unshift({name:s,...e.init?{}:{value:null},on:[{events:r,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(s),force:!0}]})}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.find((t=>t.name===r+b0)),a=r+lK,s=i.items.filter((t=>t.hasLegend)).map((t=>sW("".concat(r,"_").concat(sW(t.field),"_legend")))),l=s.map((t=>"".concat(t," !== null"))).join(" && "),u="".concat(l," ? {fields: ").concat(a,", values: [").concat(s.join(", "),"]} : null");e.events&&s.length>0?o.on.push({events:s.map((t=>({signal:t}))),update:u}):s.length>0&&(o.update=u,delete o.value,delete o.on);const c=n.find((t=>t.name===r+a0)),f=nQ(e.bind)&&e.bind.legend;return c&&(e.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};const c0="_translate_anchor",f0="_translate_delta",d0={defined:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=hK.defined(e),o=r+c0,{x:a,y:s}=e.project.hasChannel;let l=eL(e.translate,"scope");return i||(l=l.map((t=>(t.between[0].markname=r+gK,t)))),n.push({name:o,value:{},on:[{events:l.map((t=>t.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==a?", extent_x: ".concat(i?pK(t,NW):"slice(".concat(a.signals.visual,")")):"")+(void 0!==s?", extent_y: ".concat(i?pK(t,OW):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+f0,value:{},on:[{events:l,update:"{x: ".concat(o,".x - x(unit), y: ").concat(o,".y - y(unit)}")}]}),void 0!==a&&h0(t,e,a,"width",n),void 0!==s&&h0(t,e,s,"height",n),n}};function h0(t,e,n,r,i){var o,a;const s=e.name,l=s+c0,u=s+f0,c=n.channel,f=hK.defined(e),d=i.filter((t=>t.name===n.signals[f?"data":"visual"]))[0],h=t.getSizeSignalRef(r).signal,p=t.getScaleComponent(c),m=p&&p.get("type"),g=p&&p.get("reverse"),y=f?c===NW?g?"":"-":g?"-":"":"",v="".concat(l,".extent_").concat(c),b="".concat(y).concat(u,".").concat(c," / ").concat(f?"".concat(h):"span(".concat(v,")")),x=f&&p?"log"===m?"panLog":"symlog"===m?"panSymlog":"pow"===m?"panPow":"panLinear":"panLinear",_=f?"pow"===m?", ".concat(null!==(o=p.get("exponent"))&&void 0!==o?o:1):"symlog"===m?", ".concat(null!==(a=p.get("constant"))&&void 0!==a?a:1):"":"",w="".concat(x,"(").concat(v,", ").concat(b).concat(_,")");d.on.push({events:{signal:u},update:f?w:"clampRange(".concat(w,", 0, ").concat(h,")")})}const p0="_zoom_anchor",m0="_zoom_delta",g0={defined:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=hK.defined(e),o=r+m0,{x:a,y:s}=e.project.hasChannel,l=hr(t.scaleName(NW)),u=hr(t.scaleName(OW));let c=eL(e.zoom,"scope");return i||(c=c.map((t=>(t.markname=r+gK,t)))),n.push({name:r+p0,on:[{events:c,update:i?"{"+[l?"x: invert(".concat(l,", x(unit))"):"",u?"y: invert(".concat(u,", y(unit))"):""].filter((t=>t)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==a&&y0(t,e,a,"width",n),void 0!==s&&y0(t,e,s,"height",n),n}};function y0(t,e,n,r,i){var o,a;const s=e.name,l=n.channel,u=hK.defined(e),c=i.filter((t=>t.name===n.signals[u?"data":"visual"]))[0],f=t.getSizeSignalRef(r).signal,d=t.getScaleComponent(l),h=d&&d.get("type"),p=u?pK(t,l):c.name,m=s+m0,g="".concat(s).concat(p0,".").concat(l),y=u&&d?"log"===h?"zoomLog":"symlog"===h?"zoomSymlog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear",v=u?"pow"===h?", ".concat(null!==(o=d.get("exponent"))&&void 0!==o?o:1):"symlog"===h?", ".concat(null!==(a=d.get("constant"))&&void 0!==a?a:1):"":"",b="".concat(y,"(").concat(p,", ").concat(g,", ").concat(m).concat(v,")");c.on.push({events:{signal:m},update:u?b:"clampRange(".concat(b,", 0, ").concat(f,")")})}const v0="_store",b0="_tuple",x0="_modify",_0="vlSelectionResolve",w0=[kK,_K,fK,s0,o0,hK,u0,l0,d0,g0,r0];function k0(t){let{escape:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0},n=e?hr(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!u3(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of x$)t[e]&&(n+=" + '__facet_".concat(e,"_' + (facet[").concat(hr(r.vgField(e)),"])"))}return n}function A0(t){var e;return iW(null!==(e=t.component.selection)&&void 0!==e?e:{}).reduce(((t,e)=>t||e.project.hasSelectionId),!1)}function E0(t,e){!ir(e.select)&&e.select.on||delete t.events,!ir(e.select)&&e.select.clear||delete t.clear,!ir(e.select)&&e.select.toggle||delete t.toggle}function M0(t){const e=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(e.push(...M0(t.object)),e.push(...M0(t.property))),e)}function C0(t){return"MemberExpression"===t.object.type?C0(t.object):"datum"===t.object.name}function S0(t){const e=vz(t),n=new Set;return e.visit((t=>{"MemberExpression"===t.type&&C0(t)&&n.add(M0(t).slice(1).join("."))})),n}class D0 extends JJ{clone(){return new D0(null,this.model,jI(this.filter))}constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=N0(this.model,this.filter,this),this._dependentFields=S0(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter ".concat(this.expr)}}function F0(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum";const i=ir(e)?e:e.param,o=sW(i),a=hr(o+v0);let s;try{s=t.getSelectionComponent(o,i)}catch(d){return"!!".concat(o)}if(s.project.timeUnit){const e=null!==n&&void 0!==n?n:t.component.data.raw,r=s.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}const l=s.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",u="global"===s.resolve?")":", ".concat(hr(s.resolve),")"),c="".concat(l).concat(a,", ").concat(r).concat(u),f="length(data(".concat(a,"))");return!1===e.empty?"".concat(f," && ").concat(c):"!".concat(f," || ").concat(c)}function T0(t,e,n){const r=sW(e),i=n.encoding;let o,a=n.field;try{o=t.getSelectionComponent(r,e)}catch(s){return r}if(i||a){if(i&&!a){const t=o.project.items.filter((t=>t.channel===i));!t.length||t.length>1?(a=o.project.items[0].field,JZ((t.length?"Multiple ":"No ")+"matching ".concat(hr(i)," encoding found for selection ").concat(hr(n.param),". ")+'Using "field": '.concat(hr(a),"."))):a=t[0].field}}else a=o.project.items[0].field,o.project.items.length>1&&JZ('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(hr(a),"."));return"".concat(o.name,"[").concat(hr(pW(a)),"]")}function N0(t,e,n){return lW(e,(e=>ir(e)?e:function(t){return null===t||void 0===t?void 0:t.param}(e)?F0(t,e,n):FY(e)))}function O0(t,e,n,r){var i,o,a,s,l;null!==(i=t.encode)&&void 0!==i||(t.encode={}),null!==(o=(s=t.encode)[e])&&void 0!==o||(s[e]={}),null!==(a=(l=t.encode[e]).update)&&void 0!==a||(l.update={}),t.encode[e].update[n]=r}function z0(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1};const{disable:i,orient:o,scale:a,labelExpr:s,title:l,zindex:u,...c}=t.combine();if(!i){for(const t in c){const n=aX[t],r=c[t];if(n&&n!==e&&"both"!==n)delete c[t];else if(iX(r)){const{condition:e,...n}=r,i=Nn(e),o=rX[t];if(o){const{vgProp:e,part:r}=o,a=[...i.map((t=>{const{test:e,...n}=t;return{test:N0(null,e),...n}})),n];O0(c,r,e,a),delete c[t]}else if(null===o){const e={signal:i.map((t=>{const{test:e,...n}=t;return"".concat(N0(null,e)," ? ").concat(aZ(n)," : ")})).join("")+aZ(n)};c[t]=e}}else if(GH(r)){const e=rX[t];if(e){const{vgProp:n,part:i}=e;O0(c,i,n,r),delete c[t]}}HI(["labelAlign","labelBaseline"],t)&&null===c[t]&&delete c[t]}if("grid"===e){if(!c.grid)return;if(c.encode){const{grid:t}=c.encode;c.encode={...t?{grid:t}:{}},nW(c.encode)&&delete c.encode}return{scale:a,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:vW(u,0)}}{if(!r.header&&t.mainExtracted)return;if(void 0!==s){var f;let t=s;null!==(f=c.encode)&&void 0!==f&&null!==(f=f.labels)&&void 0!==f&&f.update&&GH(c.encode.labels.update.text)&&(t=mW(s,"datum.label",c.encode.labels.update.text.signal)),O0(c,"labels","text",{signal:t})}if(null===c.labelAlign&&delete c.labelAlign,c.encode){for(const e of oX)t.hasAxisPart(e)||delete c.encode[e];nW(c.encode)&&delete c.encode}const e=function(t,e){if(t)return sn(t)&&!VH(t)?t.map((t=>$G(t,e))).join(", "):t}(l,n);return{scale:a,orient:o,grid:!1,...e?{title:e}:{},...c,...!1===n.aria?{aria:!1}:{},zindex:vW(u,0)}}}}function R0(t){const{axes:e}=t.component,n=[];for(const r of oH)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}function P0(t,e,n,r){return Object.assign.apply(null,[{},...t.map((t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},o=e["x"===n?"axisTop":"axisRight"]||{},a=new Set([...rW(i),...rW(o)]),s={};for(const e of a.values())s[e]={signal:"".concat(r.signal,' === "').concat(t,'" ? ').concat(sZ(i[e])," : ").concat(sZ(o[e]))};return s}return e[t]}))])}function B0(t,e){const n=[{}];for(const i of t){var r;let t=null===(r=e[i])||void 0===r?void 0:r.style;if(t){t=Nn(t);for(const r of t)n.push(e.style[r])}}return Object.assign.apply(null,n)}function L0(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=hZ(t,n,e);if(void 0!==i)return{configFrom:"style",configValue:i};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"]){var o;if(void 0!==(null===(o=r[a])||void 0===o?void 0:o[t]))return{configFrom:a,configValue:r[a][t]}}return{}}const j0={scale:t=>{let{model:e,channel:n}=t;return e.scaleName(n)},format:t=>{let{format:e}=t;return e},formatType:t=>{let{formatType:e}=t;return e},grid:t=>{var e;let{fieldOrDatumDef:n,axis:r,scaleType:i}=t;return null!==(e=r.grid)&&void 0!==e?e:function(t,e){return!JY(t)&&kG(e)&&!UH(null===e||void 0===e?void 0:e.bin)&&!qH(null===e||void 0===e?void 0:e.bin)}(i,n)},gridScale:t=>{let{model:e,channel:n}=t;return function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n);return}(e,n)},labelAlign:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelAlign||I0(n,r,i)},labelAngle:t=>{let{labelAngle:e}=t;return e},labelBaseline:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelBaseline||q0(n,r,i)},labelFlush:t=>{var e;let{axis:n,fieldOrDatumDef:r,channel:i}=t;return null!==(e=n.labelFlush)&&void 0!==e?e:function(t,e){if("x"===e&&HI(["quantitative","temporal"],t))return!0;return}(r.type,i)},labelOverlap:t=>{var e;let{axis:n,fieldOrDatumDef:r,scaleType:i}=t;return null!==(e=n.labelOverlap)&&void 0!==e?e:function(t,e,n,r){if(n&&!ln(r)||"nominal"!==t&&"ordinal"!==t)return"log"!==e&&"symlog"!==e||"greedy";return}(r.type,i,kG(r)&&!!r.timeUnit,kG(r)?r.sort:void 0)},orient:t=>{let{orient:e}=t;return e},tickCount:t=>{var e;let{channel:n,model:r,axis:i,fieldOrDatumDef:o,scaleType:a}=t;const s="x"===n?"width":"y"===n?"height":void 0,l=s?r.getSizeSignalRef(s):void 0;return null!==(e=i.tickCount)&&void 0!==e?e:function(t){let{fieldOrDatumDef:e,scaleType:n,size:r,values:i}=t;if(!i&&!JY(n)&&"log"!==n){if(kG(e)){var o;if(UH(e.bin))return{signal:"ceil(".concat(r.signal,"/10)")};if(e.timeUnit&&HI(["month","hours","day","quarter"],null===(o=yY(e.timeUnit))||void 0===o?void 0:o.unit))return}return{signal:"ceil(".concat(r.signal,"/40)")}}return}({fieldOrDatumDef:o,scaleType:a,size:l,values:i.values})},tickMinStep:function(t){let{format:e,fieldOrDatumDef:n}=t;if("d"===e)return 1;if(kG(n)){const{timeUnit:t}=n;if(t){const e=vY(t);if(e)return{signal:e}}}return},title:t=>{let{axis:e,model:n,channel:r}=t;if(void 0!==e.title)return e.title;const i=W0(n,r);if(void 0!==i)return i;const o=n.typedFieldDef(r),a="x"===r?"x2":"y2",s=n.fieldDef(a);return mZ(o?[pG(o)]:[],kG(s)?[pG(s)]:[])},values:t=>{let{axis:e,fieldOrDatumDef:n}=t;return function(t,e){const n=t.values;if(sn(n))return eX(e,n);if(GH(n))return n;return}(e,n)},zindex:t=>{var e;let{axis:n,fieldOrDatumDef:r,mark:i}=t;return null!==(e=n.zindex)&&void 0!==e?e:function(t,e){if("rect"===t&&LG(e))return 1;return 0}(i,r)}};function U0(t){return"(((".concat(t.signal," % 360) + 360) % 360)")}function q0(t,e,n,r){if(void 0!==t){if("x"===n){if(GH(t)){const n=U0(t),r=GH(e)?"(".concat(e.signal,' === "top")'):"top"===e;return{signal:"(45 < ".concat(n," && ").concat(n," < 135) || (225 < ").concat(n," && ").concat(n,' < 315) ? "middle" :')+"(".concat(n," <= 45 || 315 <= ").concat(n,") === ").concat(r,' ? "bottom" : "top"')}}if(45<t&&t<135||225<t&&t<315)return"middle";if(GH(e)){const n=t<=45||315<=t?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "top" ? "bottom" : "top"')}}return(t<=45||315<=t)===("top"===e)?"bottom":"top"}if(GH(t)){const n=U0(t),i=GH(e)?"(".concat(e.signal,' === "left")'):"left"===e,o=r?'"middle"':"null";return{signal:"".concat(n," <= 45 || 315 <= ").concat(n," || (135 <= ").concat(n," && ").concat(n," <= 225) ? ").concat(o," : (45 <= ").concat(n," && ").concat(n," <= 135) === ").concat(i,' ? "top" : "bottom"')}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(GH(e)){const n=45<=t&&t<=135?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "left" ? "top" : "bottom"')}}return(45<=t&&t<=135)===("left"===e)?"top":"bottom"}}function I0(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(GH(t)){const n=U0(t),a=GH(e)?"(".concat(e.signal,' === "').concat(o,'")'):e===o;return{signal:"(".concat(i?"(".concat(n," + 90)"):n," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(i," < ").concat(n," && ").concat(n," < ").concat(180+i,") === ").concat(a,' ? "left" : "right"')}}if((t+i)%180===0)return r?null:"center";if(GH(e)){const n=i<t&&t<180+i?"===":"!==",r="".concat(e.signal," ").concat(n,' "').concat(o,'"');return{signal:"".concat(r,' ? "left" : "right"')}}return(i<t&&t<180+i)===(e===o)?"left":"right"}function W0(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;return o&&a?gZ(o,a):o||(a||(void 0!==o?o:void 0!==a?a:void 0))}class $0 extends JJ{clone(){return new $0(null,jI(this.transform))}constructor(t,e){super(t),this.transform=e,this._dependentFields=S0(this.transform.calculate)}static parseAllForSortIndex(t,e){return e.forEachFieldDef(((e,n)=>{if(NG(e)&&cG(e.sort)){const{field:r,timeUnit:i}=e,o=e.sort,a=o.map(((t,e)=>"".concat(FY({field:r,timeUnit:i,equal:t})," ? ").concat(e," : "))).join("")+o.length;t=new $0(t,{calculate:a,as:H0(e,n,{forAs:!0})})}})),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate ".concat(WI(this.transform))}}function H0(t,e,n){return BG(t,{prefix:e,suffix:"sort_index",...null!==n&&void 0!==n?n:{}})}function Z0(t,e){return HI(["top","bottom"],e)?"column":HI(["left","right"],e)||"row"===t?"row":"column"}function Y0(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return vW((e||{})[t],i[t],n.header[t])}function V0(t,e,n,r){const i={};for(const o of t){const t=Y0(o,e||{},n,r);void 0!==t&&(i[o]=t)}return i}const G0=["row","column"],X0=["header","footer"];function Q0(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=V0(["titleAnchor","titleAngle","titleOrient"],i.header,r,e),l=Z0(e,s),u=AW(a);return{name:"".concat(e,"-title"),type:"group",role:"".concat(l,"-title"),title:{text:n,..."row"===e?{orient:"left"}:{},style:"guide-title",...K0(u,l),...J0(l,u,o),...a1(r,i,e,VX,ZX)}}}function J0(t,e){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle"){case"start":return{align:"left"};case"end":return{align:"right"}}const n=I0(e,"row"===t?"left":"top","row"===t?"y":"x");return n?{align:n}:{}}function K0(t,e){const n=q0(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function t1(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of X0)if(n[i])for(const o of n[i]){const a=r1(t,e,i,n,o);null!=a&&r.push(a)}return r}function e1(t,e){const{sort:n}=t;var r;return uG(n)?{field:BG(n,{expr:"datum"}),order:null!==(r=n.order)&&void 0!==r?r:"ascending"}:sn(n)?{field:H0(t,e,{expr:"datum"}),order:"ascending"}:{field:BG(t,{expr:"datum"}),order:null!==n&&void 0!==n?n:"ascending"}}function n1(t,e,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:l}=V0(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t.header,n,e),u=XV({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,c=Z0(e,s);return{text:{signal:l?mW(mW(l,"datum.label",u),"datum.value",BG(t,{expr:"parent"})):u},..."row"===e?{orient:"left"}:{},style:"guide-label",frame:"group",...K0(o,c),...J0(c,o,a),...a1(n,t,e,GX,YX)}}function r1(t,e,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=t.config?t.config:void 0;if(a&&i.labels){const{labelOrient:t}=V0(["labelOrient"],a.header,s,e);("row"===e&&!HI(["top","bottom"],t)||"column"===e&&!HI(["left","right"],t))&&(o=n1(a,e,s))}const l=u3(t)&&!fG(t.facet),u=i.axes,c=(null===u||void 0===u?void 0:u.length)>0;if(o||c){const s="row"===e?"height":"width";return{name:t.getName("".concat(e,"_").concat(n)),type:"group",role:"".concat(e,"-").concat(n),...r.facetFieldDef?{from:{data:t.getName("".concat(e,"_domain"))},sort:e1(a,e)}:{},...c&&l?{from:{data:t.getName("facet_domain_".concat(e))}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const i1={column:{start:0,end:1},row:{start:1,end:0}};function o1(t,e){return i1[e][t]}function a1(t,e,n,r,i){const o={};for(const a of r){if(!i[a])continue;const r=Y0(a,null===e||void 0===e?void 0:e.header,t,n);void 0!==r&&(o[i[a]]=r)}return o}function s1(t){return[...l1(t,"width"),...l1(t,"height"),...l1(t,"childWidth"),...l1(t,"childHeight")]}function l1(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),o=e.get("range");if(JY(r)&&XH(o)){const r=t.scaleName(n);if(u3(t.parent)){if("independent"===t.parent.component.resolve.scale[n])return[u1(r,o)]}return[u1(r,o),{name:i,update:c1(r,e,"domain('".concat(r,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r=dQ(t.config.view,e?"width":"height"),o="isFinite(".concat(n,") ? ").concat(n," : ").concat(r);return[{name:i,init:o,on:[{update:o,events:"window:resize"}]}]}return[{name:i,value:r}]}function u1(t,e){const n="".concat(t,"_step");return GH(e.step)?{name:n,update:e.step.signal}:{name:n,value:e.step}}function c1(t,e,n){const r=e.get("type"),i=e.get("padding"),o=vW(e.get("paddingOuter"),i);let a=e.get("paddingInner");return a="band"===r?void 0!==a?a:i:1,"bandspace(".concat(n,", ").concat(sZ(a),", ").concat(sZ(o),") * ").concat(t,"_step")}function f1(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function d1(t,e){return rW(t).reduce(((n,r)=>{const i=t[r];return{...n,...AK(e,i,r,(t=>iZ(t.value)))}}),{})}function h1(t,e){if(u3(e))return"theta"===t?"independent":"shared";if(f3(e))return"shared";if(c3(e))return aH(t)||"theta"===t||"radius"===t?"independent":"shared";throw new Error("invalid model type for resolve")}function p1(t,e){const n=t.scale[e],r=aH(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&JZ(function(t){return'Setting the scale to be independent for "'.concat(t,'" means we also have to set the guide (axis or legend) to be independent.')}(e)),"independent"):t[r][e]||"shared"}const m1={...JX,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},g1=rW(m1);class y1 extends TJ{}const v1={symbols:function(t,e){var n,r,i,o;let{fieldOrDatumDef:a,model:s,channel:l,legendCmpt:u,legendType:c}=e;if("symbol"!==c)return;const{markDef:f,encoding:d,config:h,mark:p}=s,m=f.filled&&"trail"!==p;let g={...lZ({},s,OV),...zK(s,{filled:m})};const y=null!==(n=u.get("symbolOpacity"))&&void 0!==n?n:h.legend.symbolOpacity,v=null!==(r=u.get("symbolFillColor"))&&void 0!==r?r:h.legend.symbolFillColor,b=null!==(i=u.get("symbolStrokeColor"))&&void 0!==i?i:h.legend.symbolStrokeColor,x=void 0===y?null!==(o=b1(d.opacity))&&void 0!==o?o:f.opacity:void 0;if(g.fill){var _;if("fill"===l||m&&l===ZW)delete g.fill;else if(g.fill.field)if(v)delete g.fill;else g.fill=iZ(null!==(_=h.legend.symbolBaseFillColor)&&void 0!==_?_:"black"),g.fillOpacity=iZ(null!==x&&void 0!==x?x:1);else if(sn(g.fill)){var w,k,A;const t=null!==(w=null!==(k=x1(null!==(A=d.fill)&&void 0!==A?A:d.color))&&void 0!==k?k:f.fill)&&void 0!==w?w:m&&f.color;t&&(g.fill=iZ(t))}}if(g.stroke)if("stroke"===l||!m&&l===ZW)delete g.stroke;else if(g.stroke.field||b)delete g.stroke;else if(sn(g.stroke)){const t=vW(x1(d.stroke||d.color),f.stroke,m?f.color:void 0);t&&(g.stroke={value:t})}if(l!==JW){const t=kG(a)&&w1(s,u,a);t?g.opacity=[{test:t,...iZ(null!==x&&void 0!==x?x:1)},iZ(h.legend.unselectedOpacity)]:x&&(g.opacity=iZ(x))}return g={...g,...t},nW(g)?void 0:g},gradient:function(t,e){var n;let{model:r,legendType:i,legendCmpt:o}=e;if("gradient"!==i)return;const{config:a,markDef:s,encoding:l}=r;let u={};const c=void 0===(null!==(n=o.get("gradientOpacity"))&&void 0!==n?n:a.legend.gradientOpacity)?b1(l.opacity)||s.opacity:void 0;c&&(u.opacity=iZ(c));return u={...u,...t},nW(u)?void 0:u},labels:function(t,e){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:o}=e;const a=r.legend(i)||{},s=r.config,l=kG(n)?w1(r,o,n):void 0,u=l?[{test:l,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:c,formatType:f}=a;let d;YV(f)?d=JV({fieldOrDatumDef:n,field:"datum.value",format:c,formatType:f,config:s}):void 0===c&&void 0===f&&s.customFormatTypes&&("quantitative"===n.type&&s.numberFormatType?d=JV({fieldOrDatumDef:n,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):"temporal"===n.type&&s.timeFormatType&&kG(n)&&void 0===n.timeUnit&&(d=JV({fieldOrDatumDef:n,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const h={...u?{opacity:u}:{},...d?{text:d}:{},...t};return nW(h)?void 0:h},entries:function(t,e){let{legendCmpt:n}=e;const r=n.get("selections");return null!==r&&void 0!==r&&r.length?{...t,fill:{value:"transparent"}}:t}};function b1(t){return _1(t,((t,e)=>Math.max(t,e.value)))}function x1(t){return _1(t,((t,e)=>vW(t,e.value)))}function _1(t,e){return function(t){const e=null===t||void 0===t?void 0:t.condition;return!!e&&(sn(e)||TG(e))}(t)?Nn(t.condition).reduce(e,t.value):TG(t)?t.value:void 0}function w1(t,e,n){const r=e.get("selections");if(null===r||void 0===r||!r.length)return;const i=hr(n.field);return r.map((t=>{const e=hr(sW(t)+v0);return"(!length(data(".concat(e,")) || (").concat(t,"[").concat(i,"] && indexof(").concat(t,"[").concat(i,"], datum.value) >= 0))")})).join(" || ")}const k1={direction:t=>{let{direction:e}=t;return e},format:t=>{let{fieldOrDatumDef:e,legend:n,config:r}=t;const{format:i,formatType:o}=n;return KV(e,e.type,i,o,r,!1)},formatType:t=>{let{legend:e,fieldOrDatumDef:n,scaleType:r}=t;const{formatType:i}=e;return tG(i,n,r)},gradientLength:t=>{var e,n;const{legend:r,legendConfig:i}=t;return null!==(e=null!==(n=r.gradientLength)&&void 0!==n?n:i.gradientLength)&&void 0!==e?e:function(t){let{legendConfig:e,model:n,direction:r,orient:i,scaleType:o}=t;const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:s,gradientVerticalMaxLength:l,gradientVerticalMinLength:u}=e;if(tV(o))return"horizontal"===r?"top"===i||"bottom"===i?M1(n,"width",s,a):s:M1(n,"height",u,l);return}(t)},labelOverlap:t=>{var e,n;let{legend:r,legendConfig:i,scaleType:o}=t;return null!==(e=null!==(n=r.labelOverlap)&&void 0!==n?n:i.labelOverlap)&&void 0!==e?e:function(t){if(HI(["quantile","threshold","log","symlog"],t))return"greedy";return}(o)},symbolType:t=>{var e;let{legend:n,markDef:r,channel:i,encoding:o}=t;return null!==(e=n.symbolType)&&void 0!==e?e:function(t,e,n,r){if("shape"!==e){var i;const t=null!==(i=x1(n))&&void 0!==i?i:r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(r.type,i,o.shape,r.shape)},title:t=>{let{fieldOrDatumDef:e,config:n}=t;return IG(e,n,{allowDisabling:!0})},type:t=>{let{legendType:e,scaleType:n,channel:r}=t;if(v$(r)&&tV(n)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:t=>{let{fieldOrDatumDef:e,legend:n}=t;return function(t,e){const n=t.values;if(sn(n))return eX(e,n);if(GH(n))return n;return}(n,e)}};function A1(t){const{legend:e}=t;return vW(e.type,function(t){let{channel:e,timeUnit:n,scaleType:r}=t;if(v$(e)){if(HI(["quarter","month","day"],n))return"symbol";if(tV(r))return"gradient"}return"symbol"}(t))}function E1(t){var e,n;let{legendConfig:r,legendType:i,orient:o,legend:a}=t;return null!==(e=null!==(n=a.direction)&&void 0!==n?n:r[i?"gradientDirection":"symbolDirection"])&&void 0!==e?e:function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(o,i)}function M1(t,e,n,r){const i=t.getSizeSignalRef(e).signal;return{signal:"clamp(".concat(i,", ").concat(n,", ").concat(r,")")}}function C1(t){const e=l3(t)?function(t){const{encoding:e}=t,n={};for(const r of[ZW,...QX]){const i=YG(e[r]);i&&t.getScaleComponent(r)&&(r===GW&&kG(i)&&i.type===UY||(n[r]=D1(t,r)))}return n}(t):function(t){const{legends:e,resolve:n}=t.component;for(const r of t.children){C1(r);for(const i of rW(r.component.legends))n.legend[i]=p1(t.component.resolve,i),"shared"===n.legend[i]&&(e[i]=F1(e[i],r.component.legends[i]),e[i]||(n.legend[i]="independent",delete e[i]))}for(const r of rW(e))for(const e of t.children)e.component.legends[r]&&"shared"===n.legend[r]&&delete e.component.legends[r];return e}(t);return t.component.legends=e,e}function S1(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!(null===n||void 0===n||!n.values);case"title":if("title"===e&&t===(null===r||void 0===r?void 0:r.title))return!0}return t===(n||{})[e]}function D1(t,e){var n,r,i;let o=t.legend(e);const{markDef:a,encoding:s,config:l}=t,u=l.legend,c=new y1({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n){var r;const i=null===(r=t.fieldDef(e))||void 0===r?void 0:r.field;for(const l of iW(null!==(o=t.component.selection)&&void 0!==o?o:{})){var o,a;const t=null!==(a=l.project.hasField[i])&&void 0!==a?a:l.project.hasChannel[e];if(t&&u0.defined(l)){var s;const e=null!==(s=n.get("selections"))&&void 0!==s?s:[];e.push(l.name),n.set("selections",e,!1),t.hasLegend=!0}}}(t,e,c);const f=void 0!==o?!o:u.disable;if(c.set("disable",f,void 0!==o),f)return c;o=o||{};const d=t.getScaleComponent(e).get("type"),h=YG(s[e]),p=kG(h)?null===(n=yY(h.timeUnit))||void 0===n?void 0:n.unit:void 0,m=o.orient||l.legend.orient||"right",g=A1({legend:o,channel:e,timeUnit:p,scaleType:d}),y={legend:o,channel:e,model:t,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:u,config:l,scaleType:d,orient:m,legendType:g,direction:E1({legend:o,legendType:g,orient:m,legendConfig:u})};for(const A of g1){if("gradient"===g&&A.startsWith("symbol")||"symbol"===g&&A.startsWith("gradient"))continue;const n=A in k1?k1[A](y):o[A];if(void 0!==n){const r=S1(n,A,o,t.fieldDef(e));(r||void 0===l.legend[A])&&c.set(A,n,r)}}const v=null!==(r=null===(i=o)||void 0===i?void 0:i.encoding)&&void 0!==r?r:{},b=c.get("selections"),x={},_={fieldOrDatumDef:h,model:t,channel:e,legendCmpt:c,legendType:g};for(const A of["labels","legend","title","symbols","gradient","entries"]){var w;const e=d1(null!==(w=v[A])&&void 0!==w?w:{},t),n=A in v1?v1[A](e,_):e;void 0===n||nW(n)||(x[A]={...null!==b&&void 0!==b&&b.length&&kG(h)?{name:"".concat(sW(h.field),"_legend_").concat(A)}:{},...null!==b&&void 0!==b&&b.length?{interactive:!!b}:{},update:n})}var k;nW(x)||c.set("encode",x,!(null===(k=o)||void 0===k||!k.encoding));return c}function F1(t,e){if(!t)return e.clone();const n=t.getWithExplicit("orient"),r=e.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const s of g1){const n=PJ(t.getWithExplicit(s),e.getWithExplicit(s),s,"legend",((t,e)=>{switch(s){case"symbolType":return T1(t,e);case"title":return yZ(t,e);case"type":return i=!0,OJ("symbol")}return RJ(t,e,s,"legend")}));t.setWithExplicit(s,n)}var o,a;i&&(null!==(o=t.implicit)&&void 0!==o&&null!==(o=o.encode)&&void 0!==o&&o.gradient&&uW(t.implicit,["encode","gradient"]),null!==(a=t.explicit)&&void 0!==a&&null!==(a=a.encode)&&void 0!==a&&a.gradient&&uW(t.explicit,["encode","gradient"]));return t}function T1(t,e){return"circle"===e.value?e:t}function N1(t){const e=t.component.legends,n={};for(const i of rW(e)){const r=SW(t.getScaleComponent(i).get("domains"));if(n[r])for(const t of n[r]){F1(t,e[i])||n[r].push(e[i])}else n[r]=[e[i].clone()]}const r=iW(n).flat().map((e=>function(t,e){var n;const{disable:r,labelExpr:i,selections:o,...a}=t.combine();if(r)return;!1===e.aria&&void 0==a.aria&&(a.aria=!1);if(null!==(n=a.encode)&&void 0!==n&&n.symbols){const t=a.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||a.stroke||(t.stroke={value:"transparent"});for(const e of QX)a[e]&&delete t[e]}a.title||delete a.title;if(void 0!==i){var s;let t=i;null!==(s=a.encode)&&void 0!==s&&null!==(s=s.labels)&&void 0!==s&&s.update&&GH(a.encode.labels.update.text)&&(t=mW(i,"datum.label",a.encode.labels.update.text.signal)),function(t,e,n,r){var i,o,a,s,l;null!==(i=t.encode)&&void 0!==i||(t.encode={}),null!==(o=(s=t.encode)[e])&&void 0!==o||(s[e]={}),null!==(a=(l=t.encode[e]).update)&&void 0!==a||(l.update={}),t.encode[e].update[n]=r}(a,"labels","text",{signal:t})}return a}(e,t.config))).filter((t=>void 0!==t));return r}function O1(t){return f3(t)||c3(t)?function(t){return t.children.reduce(((t,e)=>t.concat(e.assembleProjections())),z1(t))}(t):z1(t)}function z1(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:"[".concat(e.size.map((t=>t.signal)).join(", "),"]")},o=e.data.reduce(((e,n)=>{const r=GH(n)?n.signal:"data('".concat(t.lookupDataSource(n),"')");return HI(e,r)||e.push(r),e}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?"[".concat(o.join(", "),"]"):o[0]},...n}]}return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const R1=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class P1 extends TJ{constructor(t,e,n,r){super({...e},{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function B1(t){t.component.projection=l3(t)?function(t){if(t.hasProjection){var e;const n=ZH(t.specifiedProjection),r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,o=r?function(t){const e=[],{encoding:n}=t;for(const r of[[WW,IW],[HW,$W]])(YG(n[r[0]])||YG(n[r[1]]))&&e.push({signal:t.getName("geojson_".concat(e.length))});t.channelHasField(GW)&&t.typedFieldDef(GW).type===UY&&e.push({signal:t.getName("geojson_".concat(e.length))});0===e.length&&e.push(t.requestDataName(HJ.Main));return e}(t):void 0,a=new P1(t.projectionName(!0),{...null!==(e=ZH(t.config.projection))&&void 0!==e?e:{},...null!==n&&void 0!==n?n:{}},i,o);return a.get("type")||a.set("type","equalEarth",!1),a}return}(t):function(t){if(0===t.children.length)return;let e;for(const r of t.children)B1(r);const n=YI(t.children,(t=>{const n=t.component.projection;if(n){if(e){const t=function(t,e){const n=YI(R1,(n=>!Yn(t.explicit,n)&&!Yn(e.explicit,n)||!!(Yn(t.explicit,n)&&Yn(e.explicit,n)&&CW(t.get(n),e.get(n))))),r=CW(t.size,e.size);if(r){if(n)return t;if(CW(t.explicit,{}))return e;if(CW(e.explicit,{}))return t}return null}(e,n);return t&&(e=t),!!t}return e=n,!0}return!0}));if(e&&n){const n=t.projectionName(!0),r=new P1(n,e.specifiedProjection,e.size,jI(e.data));for(const e of t.children){const t=e.component.projection;t&&(t.isFit&&r.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}return r}return}(t)}function L1(t,e,n,r){if(nX(e,n)){var i,o;const a=l3(t)&&null!==(i=null!==(o=t.axis(n))&&void 0!==o?o:t.legend(n))&&void 0!==i?i:{},s=BG(e,{expr:"datum"}),l=BG(e,{expr:"datum",binSuffix:"end"});return{formulaAs:BG(e,{binSuffix:"range",forAs:!0}),formula:iG(s,l,a.format,a.formatType,r)}}return{}}function j1(t,e){return"".concat(jH(t),"_").concat(e)}function U1(t,e,n){var r;const i=j1(null!==(r=QG(n,void 0))&&void 0!==r?r:{},e);return t.getName("".concat(i,"_bins"))}function q1(t,e,n){let r,i;r=function(t){return"as"in t}(t)?ir(t.as)?[t.as,"".concat(t.as,"_end")]:[t.as[0],t.as[1]]:[BG(t,{forAs:!0}),BG(t,{binSuffix:"end",forAs:!0})];const o={...QG(e,void 0)},a=j1(o,t.field),{signal:s,extentSignal:l}=function(t,e){return{signal:t.getName("".concat(e,"_bins")),extentSignal:t.getName("".concat(e,"_extent"))}}(n,a);if(WH(o.extent)){const t=o.extent;i=T0(n,t.param,t),delete o.extent}return{key:a,binComponent:{bin:o,field:t.field,as:[r],...s?{signal:s}:{},...l?{extentSignal:l}:{},...i?{span:i}:{}}}}class I1 extends JJ{clone(){return new I1(null,jI(this.bins))}constructor(t,e){super(t),this.bins=e}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{if(FG(n)&&UH(n.bin)){const{key:i,binComponent:o}=q1(n,n.bin,e);t[i]={...o,...t[i],...L1(e,n,r,e.config)}}return t}),{});return nW(n)?null:new I1(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=q1(e,e.bin,n);return new I1(t,{[r]:i})}merge(t,e){for(const n of rW(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=XI([...this.bins[n].as,...t.bins[n].as],WI)):this.bins[n]=t.bins[n];for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(iW(this.bins).map((t=>t.as)).flat(2))}dependentFields(){return new Set(iW(this.bins).map((t=>t.field)))}hash(){return"Bin ".concat(WI(this.bins))}assemble(){return iW(this.bins).flatMap((t=>{const e=[],[n,...r]=t.as,{extent:i,...o}=t.bin,a={type:"bin",field:pW(t.field),as:n,signal:t.signal,...WH(i)?{extent:null}:{extent:i},...t.span?{span:{signal:"span(".concat(t.span,")")}}:{},...o};!i&&t.extentSignal&&(e.push({type:"extent",field:pW(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),e.push(a);for(const s of r)for(let t=0;t<2;t++)e.push({type:"formula",expr:BG({field:n[t]},{expr:"datum"}),as:s[t]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e}))}}function W1(t,e,n,r){var i;const o=l3(r)?r.encoding[P$(e)]:void 0;if(FG(n)&&l3(r)&&vG(n,o,r.markDef,r.config)){t.add(BG(n,{})),t.add(BG(n,{suffix:"end"}));const{mark:i,markDef:o,config:a}=r,s=gG({fieldDef:n,markDef:o,config:a});FV(i)&&.5!==s&&aH(e)&&(t.add(BG(n,{suffix:rK})),t.add(BG(n,{suffix:iK}))),n.bin&&nX(n,e)&&t.add(BG(n,{binSuffix:"range"}))}else if(m$(e)){const n=p$(e);t.add(r.getName(n))}else t.add(BG(n));return NG(n)&&function(t){return ln(t)&&"field"in t}(null===(i=n.scale)||void 0===i?void 0:i.range)&&t.add(n.scale.range.field),t}class $1 extends JJ{clone(){return new $1(null,new Set(this.dimensions),jI(this.measures))}constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef((t=>{t.aggregate&&(n=!0)}));const r={},i=new Set;return n?(e.forEachFieldDef(((t,n)=>{const{aggregate:o,field:a}=t;if(o)if("count"===o){var s;null!==(s=r["*"])&&void 0!==s||(r["*"]={}),r["*"].count=new Set([BG(t,{forAs:!0})])}else{if(NH(o)||OH(o)){var l;const t=NH(o)?"argmin":"argmax",e=o[t];null!==(l=r[e])&&void 0!==l||(r[e]={}),r[e][t]=new Set([BG({op:t,field:e},{forAs:!0})])}else{var u;null!==(u=r[a])&&void 0!==u||(r[a]={}),r[a][o]=new Set([BG(t,{forAs:!0})])}var c;if(AH(n)&&"unaggregated"===e.scaleDomain(n))null!==(c=r[a])&&void 0!==c||(r[a]={}),r[a].min=new Set([BG({field:a,aggregate:"min"},{forAs:!0})]),r[a].max=new Set([BG({field:a,aggregate:"max"},{forAs:!0})])}else W1(i,n,t,e)})),i.size+rW(r).length===0?null:new $1(t,i,r)):null}static makeFromTransform(t,e){const n=new Set,r={};for(const s of e.aggregate){const{op:t,field:e,as:n}=s;var i,o;if(t)if("count"===t)null!==(i=r["*"])&&void 0!==i||(r["*"]={}),r["*"].count=new Set([n||BG(s,{forAs:!0})]);else null!==(o=r[e])&&void 0!==o||(r[e]={}),r[e][t]=new Set([n||BG(s,{forAs:!0})])}for(const s of null!==(a=e.groupby)&&void 0!==a?a:[]){var a;n.add(s)}return n.size+rW(r).length===0?null:new $1(t,n,r)}merge(t){return JI(this.dimensions,t.dimensions)?(function(t,e){for(const r of rW(e)){const i=e[r];for(const e of rW(i)){var n;r in t?t[r][e]=new Set([...null!==(n=t[r][e])&&void 0!==n?n:[],...i[e]]):t[r]={[e]:i[e]}}}}(this.measures,t.measures),!0):(function(){XZ.debug(...arguments)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...rW(this.measures)])}producedFields(){const t=new Set;for(const e of rW(this.measures))for(const n of rW(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add("".concat(n,"_").concat(e)):r.forEach(t.add,t)}return t}hash(){return"Aggregate ".concat(WI({dimensions:this.dimensions,measures:this.measures}))}assemble(){const t=[],e=[],n=[];for(const r of rW(this.measures))for(const i of rW(this.measures[r]))for(const o of this.measures[r][i])n.push(o),t.push(i),e.push("*"===r?null:pW(r));return{type:"aggregate",groupby:[...this.dimensions].map(pW),ops:t,fields:e,as:n}}}class H1 extends JJ{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const i of x$){const t=e.facet[i];if(t){const{bin:n,sort:r}=t;this[i]={name:e.getName("".concat(i,"_domain")),fields:[BG(t),...UH(n)?[BG(t,{binSuffix:"end"})]:[]],...uG(r)?{sortField:r}:sn(r)?{sortIndexField:H0(t,i)}:{}}}}this.childModel=e.child}hash(){let t="Facet";for(const e of x$)this[e]&&(t+=" ".concat(e.charAt(0),":").concat(WI(this[e])));return t}get fields(){const t=[];for(const n of x$){var e;null!==(e=this[n])&&void 0!==e&&e.fields&&t.push(...this[n].fields)}return t}dependentFields(){const t=new Set(this.fields);for(const e of x$)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of oH){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(JY(r)&&XH(i)){const n=L2(j2(this.childModel,e));n?t[e]=n:JZ(kZ(e))}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x",facet:void 0}[t],i=[],o=[],a=[];r&&n&&n[r]&&(e?(i.push("distinct_".concat(n[r])),o.push("max")):(i.push(n[r]),o.push("distinct")),a.push("distinct_".concat(n[r])));const{sortField:s,sortIndexField:l}=this[t];if(s){const{op:t=oG,field:e}=s;i.push(e),o.push(t),a.push(BG(s,{forAs:!0}))}else l&&(i.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:null!==e&&void 0!==e?e:this.data,transform:[{type:"aggregate",groupby:this[t].fields,...i.length?{fields:i,ops:o,as:a}:{}}]}}assembleFacetHeaderData(t){const{columns:e}=this.model.layout,{layoutHeaders:n}=this.model.component,r=[],i={};for(const u of G0){for(const t of X0){var o;const e=null!==(o=n[u]&&n[u][t])&&void 0!==o?o:[];for(const t of e){var a;if((null===(a=t.axes)||void 0===a?void 0:a.length)>0){i[u]=!0;break}}}if(i[u]){const t='length(data("'.concat(this.facet.name,'"))'),n="row"===u?e?{signal:"ceil(".concat(t," / ").concat(e,")")}:1:e?{signal:"min(".concat(t,", ").concat(e,")")}:{signal:t};r.push({name:"".concat(this.facet.name,"_").concat(u),transform:[{type:"sequence",start:0,stop:n}]})}}const{row:s,column:l}=i;return(s||l)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let e=null;const n=this.getChildIndependentFieldsWithStep(),{column:r,row:i,facet:o}=this;if(r&&i&&(n.x||n.y)){var a,s;e="cross_".concat(this.column.name,"_").concat(this.row.name);const r=[].concat(null!==(a=n.x)&&void 0!==a?a:[],null!==(s=n.y)&&void 0!==s?s:[]),i=r.map((()=>"distinct"));t.push({name:e,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:r,ops:i}]})}for(const l of[FW,DW])this[l]&&t.push(this.assembleRowColumnHeaderData(l,e,n));if(o){const e=this.assembleFacetHeaderData(n);e&&t.push(...e)}return t}}function Z1(t){return t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t}function Y1(t){const e={};return BI(t.filter,(t=>{if(SY(t)){let r=null;if(_Y(t))r=nZ(t.equal);else if(kY(t))r=nZ(t.lte);else if(wY(t))r=nZ(t.lt);else if(AY(t))r=nZ(t.gt);else if(EY(t))r=nZ(t.gte);else if(MY(t))r=t.range[0];else if(CY(t)){var n;r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]}r&&(KZ(r)?e[t.field]="date":nr(r)?e[t.field]="number":ir(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}})),e}function V1(t){const e={};function n(t){var n;KG(t)?e[t.field]="date":"quantitative"===t.type&&(ir(n=t.aggregate)&&HI(["min","max"],n))?e[t.field]="number":yW(t.field)>1?t.field in e||(e[t.field]="flatten"):NG(t)&&uG(t.sort)&&yW(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((l3(t)||u3(t))&&t.forEachFieldDef(((e,r)=>{if(FG(e))n(e);else{const i=z$(r),o=t.fieldDef(i);n({...e,type:o.type})}})),l3(t)){const{mark:n,markDef:r,encoding:i}=t;if(DV(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];kG(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}class G1 extends JJ{clone(){return new G1(null,jI(this._parse))}constructor(t,e){super(t),this._parse=e}hash(){return"Parse ".concat(WI(this._parse))}static makeExplicit(t,e,n){var r;let i={};const o=e.data;return!qJ(o)&&null!==o&&void 0!==o&&null!==(r=o.format)&&void 0!==r&&r.parse&&(i=o.format.parse),this.makeWithAncestors(t,i,{},n)}static makeWithAncestors(t,e,n,r){for(const a of rW(n)){const t=r.getWithExplicit(a);void 0!==t.value&&(t.explicit||t.value===n[a]||"derived"===t.value||"flatten"===n[a]?delete n[a]:JZ(DZ(a,n[a],t.value)))}for(const a of rW(e)){const t=r.get(a);void 0!==t&&(t===e[a]?delete e[a]:JZ(DZ(a,e[a],t)))}const i=new TJ(e,n);r.copyAll(i);const o={};for(const a of rW(i.combine())){const t=i.get(a);null!==t&&(o[a]=t)}return 0===rW(o).length||r.parseNothing?null:new G1(t,o)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const e of rW(this._parse)){const n=this._parse[e];1===yW(e)&&(t[e]=n)}return t}producedFields(){return new Set(rW(this._parse))}dependentFields(){return new Set(rW(this._parse))}assembleTransforms(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return rW(this._parse).filter((e=>!t||yW(e)>1)).map((t=>{const e=function(t,e){const n=fW(t);if("number"===e)return"toNumber(".concat(n,")");if("boolean"===e)return"toBoolean(".concat(n,")");if("string"===e)return"toString(".concat(n,")");if("date"===e)return"toDate(".concat(n,")");if("flatten"===e)return n;if(e.startsWith("date:")){const t=Z1(e.slice(5,e.length));return"timeParse(".concat(n,",'").concat(t,"')")}if(e.startsWith("utc:")){const t=Z1(e.slice(4,e.length));return"utcParse(".concat(n,",'").concat(t,"')")}return JZ('Unrecognized parse "'.concat(e,'".')),null}(t,this._parse[t]);if(!e)return null;return{type:"formula",expr:e,as:gW(t)}})).filter((t=>null!==t))}}class X1 extends JJ{clone(){return new X1(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([KX])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:KX}}}class Q1 extends JJ{clone(){return new Q1(null,this.params)}constructor(t,e){super(t),this.params=e}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule ".concat(WI(this.params))}assemble(){return{type:"graticule",...!0===this.params?{}:this.params}}}class J1 extends JJ{clone(){return new J1(null,this.params)}constructor(t,e){super(t),this.params=e}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return"Hash ".concat(WI(this.params))}assemble(){return{type:"sequence",...this.params}}}class K1 extends JJ{constructor(t){var e;let n;if(super(null),null!==(e=t)&&void 0!==e||(t={name:"source"}),qJ(t)||(n=t.format?{...II(t.format,["parse"])}:{}),jJ(t))this._data={values:t.values};else if(LJ(t)){if(this._data={url:t.url},!n.type){let e=/(?:\.([^.]+))?$/.exec(t.url)[1];HI(["json","csv","tsv","dsv","topojson"],e)||(e="json"),n.type=e}}else WJ(t)?this._data={values:[{type:"Sphere"}]}:(UJ(t)||qJ(t))&&(this._data={});this._generator=qJ(t),t.name&&(this._name=t.name),n&&!nW(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var t2,e2=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},n2=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};function r2(t){return t instanceof K1||t instanceof Q1||t instanceof J1}class i2{constructor(){t2.set(this,void 0),e2(this,t2,!1,"f")}setModified(){e2(this,t2,!0,"f")}get modifiedFlag(){return n2(this,t2,"f")}}t2=new WeakMap;class o2 extends i2{getNodeDepths(t,e,n){n.set(t,e);for(const r of t.children)this.getNodeDepths(r,e+1,n);return n}optimize(t){const e=[...this.getNodeDepths(t,0,new Map).entries()].sort(((t,e)=>e[1]-t[1]));for(const n of e)this.run(n[0]);return this.modifiedFlag}}class a2 extends i2{optimize(t){this.run(t);for(const e of t.children)this.optimize(e);return this.modifiedFlag}}class s2 extends a2{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map((t=>t.hash())),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const r of rW(n))n[r].length>1&&(this.setModified(),this.mergeNodes(t,n[r]))}}class l2 extends a2{constructor(t){super(),this.requiresSelectionId=t&&A0(t)}run(t){t instanceof X1&&(this.requiresSelectionId&&(r2(t.parent)||t.parent instanceof $1||t.parent instanceof G1)||(this.setModified(),t.remove()))}}class u2 extends i2{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,e){let n=new Set;t instanceof nK&&(n=t.producedFields(),KI(n,e)&&(this.setModified(),t.removeFormulas(e),0===t.producedFields.length&&t.remove()));for(const r of t.children)this.run(r,new Set([...e,...n]))}}class c2 extends a2{constructor(){super()}run(t){t instanceof KJ&&!t.isRequired()&&(this.setModified(),t.remove())}}class f2 extends o2{run(t){if(!r2(t)&&!(t.numChildren()>1))for(const e of t.children)if(e instanceof G1)if(t instanceof G1)this.setModified(),t.merge(e);else{if(eW(t.producedFields(),e.dependentFields()))continue;this.setModified(),e.swapWithParent()}}}class d2 extends o2{run(t){const e=[...t.children],n=t.children.filter((t=>t instanceof G1));if(t.numChildren()>1&&n.length>=1){const r={},i=new Set;for(const t of n){const e=t.parse;for(const t of rW(e))t in r?r[t]!==e[t]&&i.add(t):r[t]=e[t]}for(const t of i)delete r[t];if(!nW(r)){this.setModified();const n=new G1(t,r);for(const i of e){if(i instanceof G1)for(const t of rW(r))delete i.parse[t];t.removeChild(i),i.parent=n,i instanceof G1&&0===rW(i.parse).length&&i.remove()}}}}}class h2 extends o2{run(t){t instanceof KJ||t.numChildren()>0||t instanceof H1||t instanceof K1||(this.setModified(),t.remove())}}class p2 extends o2{run(t){const e=t.children.filter((t=>t instanceof nK)),n=e.pop();for(const r of e)this.setModified(),n.merge(r)}}class m2 extends o2{run(t){const e=t.children.filter((t=>t instanceof $1)),n={};for(const r of e){const t=WI(r.groupBy);t in n||(n[t]=[]),n[t].push(r)}for(const r of rW(n)){const e=n[r];if(e.length>1){const n=e.pop();for(const r of e)n.merge(r)&&(t.removeChild(r),r.parent=n,r.remove(),this.setModified())}}}}class g2 extends o2{constructor(t){super(),this.model=t}run(t){const e=!(r2(t)||t instanceof D0||t instanceof G1||t instanceof X1),n=[],r=[];for(const i of t.children)i instanceof I1&&(e&&!eW(t.producedFields(),i.dependentFields())?n.push(i):r.push(i));if(n.length>0){const e=n.pop();for(const t of n)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof I1?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(r.length>1){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified()}}}class y2 extends o2{run(t){const e=[...t.children];if(!ZI(e,(t=>t instanceof KJ))||t.numChildren()<=1)return;const n=[];let r;for(const i of e)if(i instanceof KJ){let e=i;for(;1===e.numChildren();){const[t]=e.children;if(!(t instanceof KJ))break;e=t}n.push(...e.children),r?(t.removeChild(i),i.parent=r.parent,r.parent.removeChild(r),r.parent=e,this.setModified()):r=e}else n.push(i);if(n.length){this.setModified();for(const t of n)t.parent.removeChild(t),t.parent=r}}}class v2 extends JJ{clone(){return new v2(null,jI(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){this.transform.groupby=XI(this.transform.groupby.concat(t),(t=>t))}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map((t=>t.field)).filter((t=>void 0!==t)).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:BG(t)}hash(){return"JoinAggregateTransform ".concat(WI(this.transform))}assemble(){const t=[],e=[],n=[];for(const i of this.transform.joinaggregate)e.push(i.op),n.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return{type:"joinaggregate",as:n,ops:e,fields:t,...void 0!==r?{groupby:r}:{}}}}class b2 extends JJ{clone(){return new b2(null,jI(this._stack))}constructor(t,e){super(t),this._stack=e}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:o="zero"}=e,a=[],s=[];if(void 0!==e.sort)for(const c of e.sort)a.push(c.field),s.push(vW(c.order,"ascending"));const l={field:a,order:s};let u;return u=function(t){return sn(t)&&t.every((t=>ir(t)))&&t.length>1}(i)?i:ir(i)?[i,"".concat(i,"_end")]:["".concat(e.stack,"_start"),"".concat(e.stack,"_end")],new b2(t,{dimensionFieldDefs:[],stackField:n,groupby:r,offset:o,sort:l,facetby:[],as:u})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannels:i,fieldChannel:o,offset:a,impute:s}=n,l=i.map((t=>ZG(r[t]))).filter((t=>!!t)),u=function(t){return t.stack.stackBy.reduce(((t,e)=>{const n=BG(e.fieldDef);return n&&t.push(n),t}),[])}(e),c=e.encoding.order;let f;if(sn(c)||kG(c))f=pZ(c);else{const t=bG(c)?c.sort:"y"===o?"descending":"ascending";f=u.reduce(((e,n)=>(e.field.push(n),e.order.push(t),e)),{field:[],order:[]})}return new b2(t,{dimensionFieldDefs:l,stackField:e.vgField(o),facetby:[],stackby:u,sort:f,offset:a,impute:s,as:[e.vgField(o,{suffix:"start",forAs:!0}),e.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return"Stack ".concat(WI(this._stack))}getGroupbyFields(){const{dimensionFieldDefs:t,impute:e,groupby:n}=this._stack;return t.length>0?t.map((t=>t.bin?e?[BG(t,{binSuffix:"mid"})]:[BG(t,{}),BG(t,{binSuffix:"end"})]:[BG(t)])).flat():null!==n&&void 0!==n?n:[]}assemble(){const t=[],{facetby:e,dimensionFieldDefs:n,stackField:r,stackby:i,sort:o,offset:a,impute:s,as:l}=this._stack;if(s)for(const u of n){const{bandPosition:n=.5,bin:o}=u;if(o){const e=BG(u,{expr:"datum"}),r=BG(u,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:"".concat(n,"*").concat(e,"+").concat(1-n,"*").concat(r),as:BG(u,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...i,...e],key:BG(u,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:o,as:l,offset:a}),t}}class x2 extends JJ{clone(){return new x2(null,jI(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){this.transform.groupby=XI(this.transform.groupby.concat(t),(t=>t))}dependentFields(){var t,e;const n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(n.add,n),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach((t=>n.add(t.field))),this.transform.window.map((t=>t.field)).filter((t=>void 0!==t)).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:BG(t)}hash(){return"WindowTransform ".concat(WI(this.transform))}assemble(){const t=[],e=[],n=[],r=[];for(const f of this.transform.window)e.push(f.op),n.push(this.getDefaultName(f)),r.push(void 0===f.param?null:f.param),t.push(void 0===f.field?null:f.field);const i=this.transform.frame,o=this.transform.groupby;if(i&&null===i[0]&&null===i[1]&&e.every((t=>zH(t))))return{type:"joinaggregate",as:n,ops:e,fields:t,...void 0!==o?{groupby:o}:{}};const a=[],s=[];if(void 0!==this.transform.sort)for(const f of this.transform.sort){var l;a.push(f.field),s.push(null!==(l=f.order)&&void 0!==l?l:"ascending")}const u={field:a,order:s},c=this.transform.ignorePeers;return{type:"window",params:r,as:n,ops:e,fields:t,sort:u,...void 0!==c?{ignorePeers:c}:{},...void 0!==o?{groupby:o}:{},...void 0!==i?{frame:i}:{}}}}function _2(t){if(t instanceof H1)if(1!==t.numChildren()||t.children[0]instanceof KJ){const n=t.model.component.data.main;w2(n);const r=(e=t,function t(n){if(!(n instanceof H1)){const r=n.clone();if(r instanceof KJ){const t=k2+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof $1||r instanceof b2||r instanceof x2||r instanceof v2)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof $1||e instanceof b2||e instanceof x2||e instanceof v2)&&e.addDimensions(t.fields),e.swapWithParent(),_2(t)}else t.children.map(_2);var e}function w2(t){if(t instanceof KJ&&t.type===HJ.Main&&1===t.numChildren()){const e=t.children[0];e instanceof H1||(e.swapWithParent(),w2(t))}}const k2="scale_",A2=5;function E2(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return!1;if(!E2(e.children))return!1}return!0}function M2(t,e){let n=!1;for(const r of e)n=t.optimize(r)||n;return n}function C2(t,e,n){let r=t.sources,i=!1;return i=M2(new c2,r)||i,i=M2(new l2(e),r)||i,r=r.filter((t=>t.numChildren()>0)),i=M2(new h2,r)||i,r=r.filter((t=>t.numChildren()>0)),n||(i=M2(new f2,r)||i,i=M2(new g2(e),r)||i,i=M2(new u2,r)||i,i=M2(new d2,r)||i,i=M2(new m2,r)||i,i=M2(new p2,r)||i,i=M2(new s2,r)||i,i=M2(new y2,r)||i),t.sources=r,i}class S2{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new S2((()=>t(e)))}}function D2(t){l3(t)?function(t){const e=t.component.scales;for(const n of rW(e)){const r=F2(t,n);if(e[n].setWithExplicit("domains",r),z2(t,n),t.component.data.isFaceted){let e=t;for(;!u3(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)QH(t)&&(t.data=k2+t.data.replace(k2,""))}}}(t):function(t){for(const n of t.children)D2(n);const e=t.component.scales;for(const n of rW(e)){let r,i=null;for(const e of t.children){const t=e.component.scales[n];if(t){r=void 0===r?t.getWithExplicit("domains"):PJ(r,t.getWithExplicit("domains"),"domains","scale",P2);const e=t.get("selectionExtent");i&&e&&i.param!==e.param&&JZ(CZ),i=e}}e[n].setWithExplicit("domains",r),i&&e[n].set("selectionExtent",i,!0)}}(t)}function F2(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=R2(e,n);if(!t)return void JZ(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=R2(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]={...t.specifiedScales[e],domain:i}),"x"===e&&YG(r.x2)?YG(r.x)?PJ(N2(n,i,t,"x"),N2(n,i,t,"x2"),"domain","scale",P2):N2(n,i,t,"x2"):"y"===e&&YG(r.y2)?YG(r.y)?PJ(N2(n,i,t,"y"),N2(n,i,t,"y2"),"domain","scale",P2):N2(n,i,t,"y2"):N2(n,i,t,e)}function T2(t,e,n){var r;const i=null===(r=yY(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map((t=>{const r=tX(t,{timeUnit:n,type:e});return{signal:"{data: ".concat(r,"}")}}))}(t,e,i):[t]}function N2(t,e,n,r){const{encoding:i,markDef:o,mark:a,config:s,stack:l}=n,u=YG(i[r]),{type:c}=u,f=u.timeUnit;if(function(t){return null===t||void 0===t?void 0:t.unionWith}(e)){const i=N2(t,void 0,n,r);return NJ([...T2(e.unionWith,c,f),...i.value])}if(GH(e))return NJ([e]);if(e&&"unaggregated"!==e&&!nV(e))return NJ(T2(e,c,f));if(l&&r===l.fieldChannel){if("normalize"===l.offset)return OJ([[0,1]]);const t=n.requestDataName(HJ.Main);return OJ([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const d=AH(r)&&kG(u)?function(t,e,n){if(!JY(n))return;const r=t.fieldDef(e),i=r.sort;if(cG(i))return{op:"min",field:H0(r,e),order:"ascending"};const{stack:o}=t,a=o?new Set([...o.groupbyFields,...o.stackBy.map((t=>t.fieldDef.field))]):void 0;if(uG(i)){return O2(i,o&&!a.has(i.field))}if(lG(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:s,field:l}=r,u=o&&!a.has(l);if(NH(s)||OH(s))return O2({field:BG(r),order:n},u);if(zH(s)||!s)return O2({op:s,field:l,order:n},u)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(HI(["ascending",void 0],i))return!0}return}(n,r,t):void 0;if(EG(u)){return OJ(T2([u.datum],c,f))}const h=u;if("unaggregated"===e){const t=n.requestDataName(HJ.Main),{field:e}=u;return OJ([{data:t,field:BG({field:e,aggregate:"min"})},{data:t,field:BG({field:e,aggregate:"max"})}])}if(UH(h.bin)){if(JY(t))return OJ("bin-ordinal"===t?[]:[{data:aW(d)?n.requestDataName(HJ.Main):n.requestDataName(HJ.Raw),field:n.vgField(r,nX(h,r)?{binSuffix:"range"}:{}),sort:!0!==d&&ln(d)?d:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=h;if(UH(t)){const e=U1(n,h.field,t);return OJ([new S2((()=>{const t=n.getSignalName(e);return"[".concat(t,".start, ").concat(t,".stop]")}))])}return OJ([{data:n.requestDataName(HJ.Main),field:n.vgField(r,{})}])}}if(h.timeUnit&&HI(["time","utc"],t)){const t=i[P$(r)];if(vG(h,t,o,s)){const e=n.requestDataName(HJ.Main),i=gG({fieldDef:h,fieldDef2:t,markDef:o,config:s}),l=FV(a)&&.5!==i&&aH(r);return OJ([{data:e,field:n.vgField(r,l?{suffix:rK}:{})},{data:e,field:n.vgField(r,{suffix:l?iK:"end"})}])}}return OJ(d?[{data:aW(d)?n.requestDataName(HJ.Main):n.requestDataName(HJ.Raw),field:n.vgField(r),sort:d}]:[{data:n.requestDataName(HJ.Main),field:n.vgField(r)}])}function O2(t,e){const{op:n,field:r,order:i}=t;return{op:null!==n&&void 0!==n?n:e?"sum":oG,...r?{field:pW(r)}:{},...i?{order:i}:{}}}function z2(t,e){var n;const r=t.component.scales[e],i=t.specifiedScales[e].domain,o=null===(n=t.fieldDef(e))||void 0===n?void 0:n.bin,a=nV(i)&&i,s=IH(o)&&WH(o.extent)&&o.extent;(a||s)&&r.set("selectionExtent",null!==a&&void 0!==a?a:s,!0)}function R2(t,e){const{aggregate:n,type:r}=t;return n?ir(n)&&!LH.has(n)?{valid:!1,reason:qZ(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:IZ(t)}:{valid:!0}:{valid:!1,reason:UZ(t)}}function P2(t,e,n,r){return t.explicit&&e.explicit&&JZ(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(SW(n)," and ").concat(SW(r),"). Using the union of the two domains.")}(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function B2(t){const e=XI(t.map((t=>{if(QH(t)){const{sort:e,...n}=t;return n}return t})),WI),n=XI(t.map((t=>{if(QH(t)){const e=t.sort;return void 0===e||aW(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}})).filter((t=>void 0!==t)),WI);if(0===e.length)return;if(1===e.length){const e=t[0];if(QH(e)&&n.length>0){let t=n[0];if(n.length>1){JZ(HZ);const e=n.filter((t=>ln(t)&&"op"in t&&"min"!==t.op));t=!n.every((t=>ln(t)&&"op"in t))||1!==e.length||e[0]}else if(ln(t)&&"field"in t){const n=t.field;e.field===n&&(t=!t.order||{order:t.order})}return{...e,sort:t}}return e}const r=XI(n.map((t=>aW(t)||!("op"in t)||ir(t.op)&&t.op in TH?t:(JZ(function(t){return"Dropping sort property ".concat(SW(t),' as unioned domains only support boolean or op "count", "min", and "max".')}(t)),!0))),WI);let i;1===r.length?i=r[0]:r.length>1&&(JZ(HZ),i=!0);const o=XI(t.map((t=>QH(t)?t.data:null)),(t=>t));if(1===o.length&&null!==o[0]){return{data:o[0],fields:e.map((t=>t.field)),...i?{sort:i}:{}}}return{fields:e,...i?{sort:i}:{}}}function L2(t){if(QH(t)&&ir(t.field))return t.field;if(function(t){return!sn(t)&&"fields"in t&&!("data"in t)}(t)){let e;for(const n of t.fields)if(QH(n)&&ir(n.field))if(e){if(e!==n.field)return JZ("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=n.field;return JZ("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),e}if(function(t){return!sn(t)&&"fields"in t&&"data"in t}(t)){JZ("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const e=t.fields[0];return ir(e)?e:void 0}}function j2(t,e){const n=t.component.scales[e].get("domains").map((e=>(QH(e)&&(e.data=t.lookupDataSource(e.data)),e)));return B2(n)}function U2(t){return f3(t)||c3(t)?t.children.reduce(((t,e)=>t.concat(U2(e))),q2(t)):q2(t)}function q2(t){return rW(t.component.scales).reduce(((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:o,type:a,selectionExtent:s,domains:l,range:u,reverse:c,...f}=i,d=function(t,e,n,r){if(aH(n)){if(XH(t))return{step:{signal:"".concat(e,"_step")}}}else if(ln(t)&&QH(t))return{...t,data:r.lookupDataSource(t.data)};return t}(i.range,o,n,t),h=j2(t,n),p=s?function(t,e,n,r){const i=T0(t,e.param,e);return{signal:KY(n.get("type"))&&sn(r)&&r[0]>r[1]?"isValid(".concat(i,") && reverse(").concat(i,")"):i}}(t,s,r,h):null;return e.push({name:o,type:a,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...void 0!==c?{reverse:c}:{},...f}),e}),[])}class I2 extends TJ{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||ZI(this.get("domains"),(t=>sn(t)&&2===t.length&&nr(t[0])&&t[0]<=0&&nr(t[1])&&t[1]>=0))}}const W2=["range","scheme"];function $2(t,e){const n=t.fieldDef(e);if(null!==n&&void 0!==n&&n.bin){const{bin:r,field:i}=n,o=B$(e),a=t.getName(o);if(ln(r)&&r.binned&&void 0!==r.step)return new S2((()=>{const n=t.scaleName(e),i='(domain("'.concat(n,'")[1] - domain("').concat(n,'")[0]) / ').concat(r.step);return"".concat(t.getSignalName(a)," / (").concat(i,")")}));if(UH(r)){const e=U1(t,i,r);return new S2((()=>{const n=t.getSignalName(e),r="(".concat(n,".stop - ").concat(n,".start) / ").concat(n,".step");return"".concat(t.getSignalName(a)," / (").concat(r,")")}))}}}function H2(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const c of W2)if(void 0!==n[c]){const r=dV(i,c),o=hV(t,c);if(r)if(o)JZ(o);else switch(c){case"range":{const r=n.range;if(sn(r)){if(aH(t))return NJ(r.map((t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return S2.fromName(r,n)}return t})))}else if(ln(r))return NJ({data:e.requestDataName(HJ.Main),field:r.field,sort:{op:"min",field:e.vgField(t)}});return NJ(r)}case"scheme":return NJ(Z2(n[c]))}else JZ(WZ(i,c,t))}const o=t===NW||"xOffset"===t?"width":"height",a=r[o];if(uQ(a))if(aH(t))if(JY(i)){const n=V2(a,e,t);if(n)return NJ({step:n})}else JZ($Z(o));else if(fH(t)){const n=t===PW?"x":"y";if("band"===e.getScaleComponent(n).get("type")){const t=G2(a,i);if(t)return NJ(t)}}const{rangeMin:s,rangeMax:l}=n,u=function(t,e){const{size:n,config:r,mark:i,encoding:o}=e,{type:a}=YG(o[t]),s=e.getScaleComponent(t),l=s.get("type"),{domain:u,domainMid:c}=e.specifiedScales[t];switch(t){case NW:case OW:if(HI(["point","band"],l)){const i=X2(t,n,r.view);if(uQ(i)){return{step:V2(i,e,t)}}}return Y2(t,e,l);case PW:case BW:return function(t,e,n){const r=t===PW?"x":"y",i=e.getScaleComponent(r);if(!i)return Y2(r,e,n,{center:!0});const o=i.get("type"),a=e.scaleName(r),{markDef:s,config:l}=e;if("band"===o){const t=X2(r,e.size,e.config.view);if(uQ(t)){const e=G2(t,n);if(e)return e}return[0,{signal:"bandwidth('".concat(a,"')")}]}{const n=e.encoding[r];if(kG(n)&&n.timeUnit){const t=vY(n.timeUnit,(t=>"scale('".concat(a,"', ").concat(t,")"))),r=e.config.scale.bandWithNestedOffsetPaddingInner,i=gG({fieldDef:n,markDef:s,config:l})-.5,o=0!==i?" + ".concat(i):"";if(r){const e=GH(r)?"".concat(r.signal,"/2")+o:"".concat(r/2+i),n=GH(r)?"(1 - ".concat(r.signal,"/2)")+o:"".concat(1-r/2+i);return[{signal:"".concat(e," * (").concat(t,")")},{signal:"".concat(n," * (").concat(t,")")}]}return[0,{signal:t}]}return UI("Cannot use ".concat(t," scale if ").concat(r," scale is not discrete."))}}(t,e,l);case XW:{const o=Q2(i,e.component.scales[t].get("zero"),r),a=function(t,e,n,r){const i={x:$2(n,"x"),y:$2(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=K2(e,i,r.view);return nr(t)?t-1:new S2((()=>"".concat(t.signal," - 1")))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=K2(e,i,r.view);return nr(t)?Math.pow(J2*t,2):new S2((()=>"pow(".concat(J2," * ").concat(t.signal,", 2)")))}}throw new Error(PZ("size",t))}(i,n,e,r);return eV(l)?function(t,e,n){const r=()=>{const r=sZ(e),i=sZ(t),o="(".concat(r," - ").concat(i,") / (").concat(n," - 1)");return"sequence(".concat(i,", ").concat(r," + ").concat(o,", ").concat(o,")")};return GH(e)?new S2(r):{signal:r()}}(o,a,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&sn(n)?n.length+1:(JZ(function(t){return"Domain for ".concat(t," is required for threshold scale.")}(r)),3)}}(l,r,u,t)):[o,a]}case UW:return[0,2*Math.PI];case QW:return[0,360];case LW:return[0,new S2((()=>{const t=e.getSignalName("width"),n=e.getSignalName("height");return"min(".concat(t,",").concat(n,")/2")}))];case e$:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case n$:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case GW:return"symbol";case ZW:case YW:case VW:return"ordinal"===l?"nominal"===a?"category":"ordinal":void 0!==c?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case JW:case KW:case t$:return[r.scale.minOpacity,r.scale.maxOpacity]}}(t,e);return(void 0!==s||void 0!==l)&&dV(i,"rangeMin")&&sn(u)&&2===u.length?NJ([null!==s&&void 0!==s?s:u[0],null!==l&&void 0!==l?l:u[1]]):OJ(u)}function Z2(t){return function(t){return!ir(t)&&!!t.name}(t)?{scheme:t.name,...II(t,["name"])}:{scheme:t}}function Y2(t,e,n){let{center:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=B$(t),o=e.getName(i),a=e.getSignalName.bind(e);return t===OW&&KY(n)?r?[S2.fromName((t=>"".concat(a(t),"/2")),o),S2.fromName((t=>"-".concat(a(t),"/2")),o)]:[S2.fromName(a,o),0]:r?[S2.fromName((t=>"-".concat(a(t),"/2")),o),S2.fromName((t=>"".concat(a(t),"/2")),o)]:[0,S2.fromName(a,o)]}function V2(t,e,n){const{encoding:r}=e,i=e.getScaleComponent(n),o=j$(n),a=r[o];if("offset"===lQ({step:t,offsetIsDiscrete:DG(a)&&RY(a.type)})&&pX(r,o)){var s;const n=e.getScaleComponent(o),r=e.scaleName(o);let a="domain('".concat(r,"').length");if("band"===n.get("type")){var l,u,c,f;const t=null!==(l=null!==(u=n.get("paddingInner"))&&void 0!==u?u:n.get("padding"))&&void 0!==l?l:0,e=null!==(c=null!==(f=n.get("paddingOuter"))&&void 0!==f?f:n.get("padding"))&&void 0!==c?c:0;a="bandspace(".concat(a,", ").concat(t,", ").concat(e,")")}const d=null!==(s=i.get("paddingInner"))&&void 0!==s?s:i.get("padding");return{signal:"".concat(t.step," * ").concat(a," / (1-").concat(oZ(d),")")}}return t.step}function G2(t,e){if("offset"===lQ({step:t,offsetIsDiscrete:JY(e)}))return{step:t.step}}function X2(t,e,n){const r=t===NW?"width":"height",i=e[r];return i||pQ(n,r)}function Q2(t,e,n){if(e)return GH(e)?{signal:"".concat(e.signal," ? 0 : ").concat(Q2(t,!1,n))}:0;switch(t){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(PZ("size",t))}const J2=.95;function K2(t,e,n){const r=uQ(t.width)?t.width.step:hQ(n,"width"),i=uQ(t.height)?t.height.step:hQ(n,"height");return e.x||e.y?new S2((()=>{const t=[e.x?e.x.signal:r,e.y?e.y.signal:i];return"min(".concat(t.join(", "),")")})):Math.min(r,i)}function t3(t,e){l3(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=t;for(const s of rW(n)){const l=a[s],u=n[s],c=t.getScaleComponent(s),f=YG(i[s]),d=l[e],h=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),g=dV(h,e),y=hV(s,e);if(void 0!==d&&(g?y&&JZ(y):JZ(WZ(h,e,s))),g&&void 0===y)if(void 0!==d){const t=f.timeUnit,n=f.type;switch(e){case"domainMax":case"domainMin":KZ(l[e])||"temporal"===n||t?u.set(e,{signal:tX(l[e],{type:n,timeUnit:t})},!0):u.set(e,l[e],!0);break;default:u.copyKeyFromObject(e,l)}}else{const n=e in e3?e3[e]({model:t,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:m,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:o,config:r,hasNestedOffsetScale:mX(i,s),hasSecondaryRangeChannel:!!i[P$(s)]}):r.scale[e];void 0!==n&&u.set(e,n,!1)}}}(t,e):r3(t,e)}const e3={bins:t=>{let{model:e,fieldOrDatumDef:n}=t;return kG(n)?function(t,e){const n=e.bin;if(UH(n)){const r=U1(t,e.field,n);return new S2((()=>t.getSignalName(r)))}if(qH(n)&&IH(n)&&void 0!==n.step)return{step:n.step};return}(e,n):void 0},interpolate:t=>{let{channel:e,fieldOrDatumDef:n}=t;return function(t,e){if(HI([ZW,YW,VW],t)&&"nominal"!==e)return"hcl";return}(e,n.type)},nice:t=>{let{scaleType:e,channel:n,domain:r,domainMin:i,domainMax:o,fieldOrDatumDef:a}=t;return function(t,e,n,r,i,o){var a;if(null!==(a=ZG(o))&&void 0!==a&&a.bin||sn(n)||null!=i||null!=r||HI([qY.TIME,qY.UTC],t))return;return!!aH(e)||void 0}(e,n,r,i,o,a)},padding:t=>{let{channel:e,scaleType:n,fieldOrDatumDef:r,markDef:i,config:o}=t;return function(t,e,n,r,i,o){if(aH(t)){if(tV(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:a}=i;if("bar"===e&&(!kG(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===t||"horizontal"===a&&"y"===t))return o.continuousBandSize}if(e===qY.POINT)return n.pointPadding}return}(e,n,o.scale,r,i,o.bar)},paddingInner:t=>{let{scalePadding:e,channel:n,markDef:r,scaleType:i,config:o,hasNestedOffsetScale:a}=t;return function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(void 0!==t)return;if(aH(e)){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:r,bandWithNestedOffsetPaddingInner:a}=i;return o?a:vW(t,"bar"===n?e:r)}if(fH(e)&&r===qY.BAND)return i.offsetBandPaddingInner;return}(e,n,r.type,i,o.scale,a)},paddingOuter:t=>{let{scalePadding:e,channel:n,scaleType:r,scalePaddingInner:i,config:o,hasNestedOffsetScale:a}=t;return function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(void 0!==t)return;if(aH(e)){const{bandPaddingOuter:t,bandWithNestedOffsetPaddingOuter:e}=i;if(o)return e;if(n===qY.BAND)return vW(t,GH(r)?{signal:"".concat(r.signal,"/2")}:r/2)}else if(fH(e)){if(n===qY.POINT)return.5;if(n===qY.BAND)return i.offsetBandPaddingOuter}return}(e,n,r,i,o.scale,a)},reverse:t=>{let{fieldOrDatumDef:e,scaleType:n,channel:r,config:i}=t;return function(t,e,n,r){if("x"===n&&void 0!==r.xReverse)return KY(t)&&"descending"===e?GH(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse;if(KY(t)&&"descending"===e)return!0;return}(n,kG(e)?e.sort:void 0,r,i.scale)},zero:t=>{let{channel:e,fieldOrDatumDef:n,domain:r,markDef:i,scaleType:o,config:a,hasSecondaryRangeChannel:s}=t;return function(t,e,n,r,i,o,a){if(n&&"unaggregated"!==n&&KY(i)){if(sn(n)){const t=n[0],e=n[n.length-1];if(nr(t)&&t<=0&&nr(e)&&e>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!eV(i))return!0;if((!kG(e)||!e.bin)&&HI([...oH,...lH],t)){const{orient:e,type:n}=r;return(!HI(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t))&&(!(!HI(["bar","area"],n)||a)||(null===o||void 0===o?void 0:o.zero))}return!1}(e,n,r,i,o,a.scale,s)}};function n3(t){l3(t)?function(t){const e=t.component.scales;for(const n of kH){const r=e[n];if(!r)continue;const i=H2(n,t);r.setWithExplicit("range",i)}}(t):r3(t,"range")}function r3(t,e){const n=t.component.scales;for(const r of t.children)"range"===e?n3(r):t3(r,e);for(const r of rW(n)){let i;for(const n of t.children){const t=n.component.scales[r];if(t){i=PJ(i,t.getWithExplicit(e),e,"scale",zJ(((t,n)=>"range"===e&&t.step&&n.step?t.step-n.step:0)))}}n[r].setWithExplicit(e,i)}}function i3(t,e,n,r){const i=function(t,e,n,r){switch(e.type){case"nominal":case"ordinal":var i;if(v$(t)||"discrete"===DH(t))return"shape"===t&&"ordinal"===e.type&&JZ(jZ(t,"ordinal")),"ordinal";if(aH(t)||fH(t)){if(HI(["rect","bar","image","rule"],n.type))return"band";if(r)return"band"}else if("arc"===n.type&&t in sH)return"band";return PV(n[B$(t)])||OG(e)&&null!==(i=e.axis)&&void 0!==i&&i.tickBand?"band":"point";case"temporal":return v$(t)?"time":"discrete"===DH(t)?(JZ(jZ(t,"temporal")),"ordinal"):kG(e)&&e.timeUnit&&yY(e.timeUnit).utc?"utc":"time";case"quantitative":return v$(t)?kG(e)&&UH(e.bin)?"bin-ordinal":"linear":"discrete"===DH(t)?(JZ(jZ(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(OZ(e.type))}(e,n,r,arguments.length>4&&void 0!==arguments[4]&&arguments[4]),{type:o}=t;return AH(e)?void 0!==o?function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!AH(t))return!1;switch(t){case NW:case OW:case PW:case BW:case UW:case LW:return!!tV(e)||"band"===e||"point"===e&&!n;case XW:case e$:case JW:case KW:case t$:case QW:return tV(e)||eV(e)||HI(["band","point","ordinal"],e);case ZW:case YW:case VW:return"band"!==e;case n$:case GW:return"ordinal"===e||eV(e)}}(e,o)?kG(n)&&(a=o,s=n.type,!(HI([BY,jY],s)?void 0===a||JY(a):s===LY?HI([qY.TIME,qY.UTC,void 0],a):s!==PY||VY(a)||eV(a)||void 0===a))?(JZ(function(t,e){return'FieldDef does not work with "'.concat(t,'" scale. We are using "').concat(e,'" scale instead.')}(o,i)),i):o:(JZ(function(t,e,n){return'Channel "'.concat(t,'" does not work with "').concat(e,'" scale. We are using "').concat(n,'" scale instead.')}(e,o,i)),i):i:null;var a,s}function o3(t){l3(t)?t.component.scales=function(t){const{encoding:e,mark:n,markDef:r}=t,i={};for(const a of kH){const s=YG(e[a]);if(s&&n===SV&&a===GW&&s.type===UY)continue;let l=s&&s.scale;if(s&&null!==l&&!1!==l){var o;null!==(o=l)&&void 0!==o||(l={});const n=i3(l,a,s,r,mX(e,a));i[a]=new I2(t.scaleName("".concat(a),!0),{value:n,explicit:l.type===n})}}return i}(t):t.component.scales=function(t){var e;const n=t.component.scales={},r={},i=t.component.resolve;for(const a of t.children){o3(a);for(const n of rW(a.component.scales)){var o;if(null!==(o=(e=i.scale)[n])&&void 0!==o||(e[n]=h1(n,t)),"shared"===i.scale[n]){const t=r[n],e=a.component.scales[n].getWithExplicit("type");t?WY(t.value,e.value)?r[n]=PJ(t,e,"type","scale",a3):(i.scale[n]="independent",delete r[n]):r[n]=e}}}for(const a of rW(r)){const e=t.scaleName(a,!0),i=r[a];n[a]=new I2(e,i);for(const n of t.children){const t=n.component.scales[a];t&&(n.renameScale(t.get("name"),e),t.merged=!0)}}return n}(t)}const a3=zJ(((t,e)=>HY(t)-HY(e)));class s3{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function l3(t){return"unit"===(null===t||void 0===t?void 0:t.type)}function u3(t){return"facet"===(null===t||void 0===t?void 0:t.type)}function c3(t){return"concat"===(null===t||void 0===t?void 0:t.type)}function f3(t){return"layer"===(null===t||void 0===t?void 0:t.type)}class d3{constructor(t,e,n,r,i,o,a){var s,l;this.type=e,this.parent=n,this.config=i,this.correctDataNames=t=>{var e,n;return null!==(e=t.from)&&void 0!==e&&e.data&&(t.from.data=this.lookupDataSource(t.from.data)),null!==(n=t.from)&&void 0!==n&&null!==(n=n.facet)&&void 0!==n&&n.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t},this.parent=n,this.config=i,this.view=ZH(a),this.name=null!==(s=t.name)&&void 0!==s?s:r,this.title=VH(t.title)?{text:t.title}:t.title?ZH(t.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new s3,this.projectionNameMap=n?n.projectionNameMap:new s3,this.signalNameMap=n?n.signalNameMap:new s3,this.data=t.data,this.description=t.description,this.transforms=function(t){return t.map((t=>JQ(t)?{filter:LI(t.filter,NY)}:t))}(null!==(l=t.transform)&&void 0!==l?l:[]),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){const r=n[e],i={},{spacing:o,columns:a}=r;void 0!==o&&(i.spacing=o),void 0!==a&&(hG(t)&&!fG(t.facet)||oQ(t))&&(i.columns=a),aQ(t)&&(i.columns=1);for(const u of fQ)if(void 0!==t[u])if("spacing"===u){var s,l;const e=t[u];i[u]=nr(e)?e:{row:null!==(s=e.row)&&void 0!==s?s:o,column:null!==(l=e.column)&&void 0!==l?l:o}}else i[u]=t[u];return i}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:hG(t)||(null===n||void 0===n?void 0:n.component.data.isFaceted)&&void 0===t.data},layoutSize:new TJ,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?jI(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t){let{ignoreRange:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o3(t),D2(t);for(const n of fV)t3(t,n);e||n3(t)}(this)}parseProjection(){B1(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){C1(this)}assembleEncodeFromView(t){const{style:e,...n}=t,r={};for(const i of rW(n)){const t=n[i];void 0!==t&&(r[i]=iZ(t))}return r}assembleGroupEncodeEntry(t){let e={};var n;if((this.view&&(e=this.assembleEncodeFromView(this.view)),!t)&&(this.description&&(e.description=iZ(this.description)),"unit"===this.type||"layer"===this.type))return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...null!==(n=e)&&void 0!==n?n:{}};return nW(e)?void 0:e}assembleLayout(){if(!this.layout)return;const{spacing:t,...e}=this.layout,{component:n,config:r}=this,i=function(t,e){const n={};for(const r of x$){const i=t[r];if(null!==i&&void 0!==i&&i.facetFieldDef){const{titleAnchor:t,titleOrient:o}=V0(["titleAnchor","titleOrient"],i.facetFieldDef.header,e,r),a=Z0(r,o),s=o1(t,a);void 0!==s&&(n[a]=s)}}return nW(n)?void 0:n}(n.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...e,...i?{titleBand:i}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of x$)t[n].title&&e.push(Q0(this,n));for(const n of G0)e=e.concat(t1(this,n));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map((t=>z0(t,"grid",e))),...r.map((t=>z0(t,"grid",e))),...n.map((t=>z0(t,"main",e))),...r.map((t=>z0(t,"main",e)))].filter((t=>t))}(this.component.axes,this.config)}assembleLegends(){return N1(this)}assembleProjections(){return O1(this)}assembleTitle(){var t;const{encoding:e,...n}=null!==(t=this.title)&&void 0!==t?t:{},r={...YH(this.config.title).nonMarkTitleProperties,...n,...e?{encode:{update:e}}:{}};if(r.text){var i,o;if(HI(["unit","layer"],this.type)){if(HI(["middle",void 0],r.anchor))null!==(i=r.frame)&&void 0!==i||(r.frame="group")}else null!==(o=r.anchor)&&void 0!==o||(r.anchor="start");return nW(r)?void 0:r}}assembleGroup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e={};t=t.concat(this.assembleSignals()),t.length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||u3(this.parent)?U2(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const o=this.assembleLegends();return o.length>0&&(e.legends=o),e}getName(t){return sW((this.name?"".concat(this.name,"_"):"")+t)}getDataName(t){return this.getName(HJ[t].toLowerCase())}requestDataName(t){const e=this.getDataName(t),n=this.component.data.outputNodeRefCounts;return n[e]=(n[e]||0)+1,e}getSizeSignalRef(t){if(u3(this.parent)){const e=uH(f1(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(JY(t)&&XH(r)){const t=n.get("name"),r=L2(j2(this,e));if(r){return{signal:c1(t,n,BG({aggregate:"distinct",field:r},{expr:"datum"}))}}return JZ(kZ(e)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):T$(t)&&AH(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error('Cannot find a selection named "'.concat(e,'".'));return n}hasAxisOrientSignalRef(){var t,e;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some((t=>t.hasOrientSignalRef())))||(null===(e=this.component.axes.y)||void 0===e?void 0:e.some((t=>t.hasOrientSignalRef())))}}class h3 extends d3{vgField(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.fieldDef(t);if(n)return BG(n,e)}reduceFieldDef(t,e){return function(t,e,n,r){return t?rW(t).reduce(((n,i)=>{const o=t[i];return sn(o)?o.reduce(((t,n)=>e.call(r,t,n,i)),n):e.call(r,n,o,i)}),n):n}(this.getMapping(),((e,n,r)=>{const i=ZG(n);return i?t(e,i,r):e}),e)}forEachFieldDef(t,e){xX(this.getMapping(),((e,n)=>{const r=ZG(e);r&&t(r,n)}),e)}}class p3 extends JJ{clone(){return new p3(null,jI(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=jI(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(i=o[1])&&void 0!==i?i:"density"]}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform ".concat(WI(this.transform))}assemble(){const{density:t,...e}=this.transform,n={type:"kde",field:t,...e};return this.transform.groupby&&(n.resolve="shared"),n}}class m3 extends JJ{clone(){return new m3(null,jI(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=jI(e)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return"ExtentTransform ".concat(WI(this.transform))}assemble(){const{extent:t,param:e}=this.transform;return{type:"extent",field:t,signal:e}}}class g3 extends JJ{clone(){return new g3(null,{...this.filter})}constructor(t,e){super(t),this.filter=e}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==cZ("invalid",i,n))return null;const o=e.reduceFieldDef(((t,n,i)=>{const o=AH(i)&&e.getScaleComponent(i);if(o){KY(o.get("type"))&&"count"!==n.aggregate&&!DV(r)&&(t[n.field]=n)}return t}),{});return rW(o).length?new g3(t,o):null}dependentFields(){return new Set(rW(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid ".concat(WI(this.filter))}assemble(){const t=rW(this.filter).reduce(((t,e)=>{const n=this.filter[e],r=BG(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push("(isDate(".concat(r,") || (isValid(").concat(r,") && isFinite(+").concat(r,")))")):"quantitative"===n.type&&(t.push("isValid(".concat(r,")")),t.push("isFinite(+".concat(r,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class y3 extends JJ{clone(){return new y3(this.parent,jI(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=jI(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((t,e)=>{var n;return null!==(n=r[e])&&void 0!==n?n:t}))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform ".concat(WI(this.transform))}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class v3 extends JJ{clone(){return new v3(null,jI(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=jI(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(i=o[1])&&void 0!==i?i:"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform ".concat(WI(this.transform))}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class b3 extends JJ{clone(){return new b3(null,jI(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[[WW,IW],[HW,$W]]){const i=r.map((t=>{const n=YG(e.encoding[t]);return kG(n)?n.field:EG(n)?{expr:"".concat(n.datum)}:TG(n)?{expr:"".concat(n.value)}:void 0}));(i[0]||i[1])&&(t=new b3(t,i,null,e.getName("geojson_".concat(n++))))}if(e.channelHasField(GW)){const r=e.typedFieldDef(GW);r.type===UY&&(t=new b3(t,null,r.field,e.getName("geojson_".concat(n++))))}return t}constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}dependentFields(){var t;const e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(ir);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(WI(this.fields))}assemble(){return[...this.geojson?[{type:"filter",expr:'isValid(datum["'.concat(this.geojson,'"])')}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class x3 extends JJ{clone(){return new x3(null,this.projection,jI(this.fields),jI(this.as))}constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[[WW,IW],[HW,$W]]){const r=n.map((t=>{const n=YG(e.encoding[t]);return kG(n)?n.field:EG(n)?{expr:"".concat(n.datum)}:TG(n)?{expr:"".concat(n.value)}:void 0})),i=n[0]===HW?"2":"";(r[0]||r[1])&&(t=new x3(t,e.projectionName(),r,[e.getName("x".concat(i)),e.getName("y".concat(i))]))}return t}dependentFields(){return new Set(this.fields.filter(ir))}producedFields(){return new Set(this.as)}hash(){return"Geopoint ".concat(this.projection," ").concat(WI(this.fields)," ").concat(WI(this.as))}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class _3 extends JJ{clone(){return new _3(null,jI(this.transform))}constructor(t,e){super(t),this.transform=e}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t,i=[e,n,...r?[r]:[]].join(",");return{signal:"sequence(".concat(i,")")}}static makeFromTransform(t,e){return new _3(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(kG(r)&&kG(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const a=r.impute?i:i.impute?r:void 0,{method:s,value:l,frame:u,keyvals:c}=o.impute,f=_X(e.mark,n);return new _3(t,{impute:o.field,key:a.field,...s?{method:s}:{},...void 0!==l?{value:l}:{},...u?{frame:u}:{},...void 0!==c?{keyvals:c}:{},...f.length?{groupby:f}:{}})}return null}hash(){return"Impute ".concat(WI(this.transform))}assemble(){const{impute:t,key:e,keyvals:n,method:r,groupby:i,value:o,frame:a=[null,null]}=this.transform,s={type:"impute",field:t,key:e,...n?{keyvals:KQ(n)?this.processSequence(n):n}:{},method:"value",...i?{groupby:i}:{},value:r&&"value"!==r?null:o};if(r&&"value"!==r){return[s,{type:"window",as:["imputed_".concat(t,"_value")],ops:[r],fields:[t],frame:a,ignorePeers:!1,...i?{groupby:i}:{}},{type:"formula",expr:"datum.".concat(t," === null ? datum.imputed_").concat(t,"_value : datum.").concat(t),as:t}]}return[s]}}class w3 extends JJ{clone(){return new w3(null,jI(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=jI(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.loess]}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform ".concat(WI(this.transform))}assemble(){const{loess:t,on:e,...n}=this.transform;return{type:"loess",x:e,y:t,...n}}}class k3 extends JJ{clone(){return new k3(null,jI(this.transform),this.secondary)}constructor(t,e,n){super(t),this.transform=e,this.secondary=n}static make(t,e,n,r){const i=e.component.data.sources,{from:o}=n;let a=null;if(function(t){return"data"in t}(o)){let t=L3(o.data,i);t||(t=new K1(o.data),i.push(t));const n=e.getName("lookup_".concat(r));a=new KJ(t,n,HJ.Lookup,e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=a}else if(function(t){return"param"in t}(o)){const t=o.param;let r;n={as:t,...n};try{r=e.getSelectionComponent(sW(t),t)}catch(s){throw new Error('Lookups can only be performed on selection parameters. "'.concat(t,'" is a variable parameter.'))}if(a=r.materialized,!a)throw new Error(function(t){return'Cannot define and lookup the "'.concat(t,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?"}(t))}return new k3(t,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Nn(this.transform.as):this.transform.from.fields)}hash(){return"Lookup ".concat(WI({transform:this.transform,secondary:this.secondary}))}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:Nn(this.transform.as)}:{}};else{let e=this.transform.as;ir(e)||(JZ('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),e="_lookup"),t={as:[e]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class A3 extends JJ{clone(){return new A3(null,jI(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=jI(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(i=o[1])&&void 0!==i?i:"value"]}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform ".concat(WI(this.transform))}assemble(){const{quantile:t,...e}=this.transform;return{type:"quantile",field:t,...e}}}class E3 extends JJ{clone(){return new E3(null,jI(this.transform))}constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=jI(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.regression]}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform ".concat(WI(this.transform))}assemble(){const{regression:t,on:e,...n}=this.transform;return{type:"regression",x:e,y:t,...n}}}class M3 extends JJ{clone(){return new M3(null,jI(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){var e;this.transform.groupby=XI((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),(t=>t))}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return"PivotTransform ".concat(WI(this.transform))}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return{type:"pivot",field:t,value:e,...void 0!==r?{limit:r}:{},...void 0!==i?{op:i}:{},...void 0!==n?{groupby:n}:{}}}}class C3 extends JJ{clone(){return new C3(null,jI(this.transform))}constructor(t,e){super(t),this.transform=e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform ".concat(WI(this.transform))}assemble(){return{type:"sample",size:this.transform.sample}}}function S3(t){let e=0;return function n(r,i){if(r instanceof K1&&!r.isGenerator&&!LJ(r.data)){t.push(i);i={name:null,source:i.name,transform:[]}}var o;if(r instanceof G1&&(r.parent instanceof K1&&!i.source?(i.format={...null!==(o=i.format)&&void 0!==o?o:{},parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof H1)return i.name||(i.name="data_".concat(e++)),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source,void t.push(...r.assemble());if((r instanceof Q1||r instanceof J1||r instanceof g3||r instanceof D0||r instanceof $0||r instanceof x3||r instanceof $1||r instanceof k3||r instanceof x2||r instanceof v2||r instanceof v3||r instanceof y3||r instanceof p3||r instanceof w3||r instanceof A3||r instanceof E3||r instanceof X1||r instanceof C3||r instanceof M3||r instanceof m3)&&i.transform.push(r.assemble()),(r instanceof I1||r instanceof nK||r instanceof _3||r instanceof b2||r instanceof b3)&&i.transform.push(...r.assemble()),r instanceof KJ)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof KJ)r.setSource(i.name);else if(i.name||(i.name="data_".concat(e++)),r.setSource(i.name),1===r.numChildren()){t.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof KJ&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_".concat(e++));let o=i.name;!i.source||i.transform.length>0?t.push(i):o=i.source;for(const t of r.children){n(t,{name:null,source:o,transform:[]})}break}}}}function D3(t){return"top"===t||"left"===t||GH(t)?"header":"footer"}function F3(t,e){const{facet:n,config:r,child:i,component:o}=t;if(t.channelHasField(e)){var a;const s=n[e],l=Y0("title",null,r,e);let u=IG(s,r,{allowDisabling:!0,includeDefault:void 0===l||!!l});i.component.layoutHeaders[e].title&&(u=sn(u)?u.join(", "):u,u+=" / ".concat(i.component.layoutHeaders[e].title),i.component.layoutHeaders[e].title=null);const c=Y0("labelOrient",s.header,r,e),f=null!==s.header&&vW(null===(a=s.header)||void 0===a?void 0:a.labels,r.header.labels,!0),d=HI(["bottom","right"],c)?"footer":"header";o.layoutHeaders[e]={title:null!==s.header?u:null,facetFieldDef:s,[d]:"facet"===e?[]:[T3(t,e,f)]}}}function T3(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function N3(t,e){const{child:n}=t;if(n.component.axes[e]){const{layoutHeaders:i,resolve:o}=t.component;if(o.axis[e]=p1(o,e),"shared"===o.axis[e]){const o="x"===e?"column":"row",a=i[o];for(const i of n.component.axes[e]){var r;const e=D3(i.get("orient"));null!==(r=a[e])&&void 0!==r||(a[e]=[T3(t,o,!1)]);const n=z0(i,"main",t.config,{header:!0});n&&a[e][0].axes.push(n),i.mainExtracted=!0}}}}function O3(t){for(const e of t.children)e.parseLayoutSize()}function z3(t,e){const n=f1(e),r=uH(n),i=t.component.resolve,o=t.component.layoutSize;let a;for(const l of t.children){var s;const e=l.component.layoutSize.getWithExplicit(n),o=null!==(s=i.scale[r])&&void 0!==s?s:h1(r,t);if("independent"===o&&"step"===e.value){a=void 0;break}if(a){if("independent"===o&&a.value!==e.value){a=void 0;break}a=PJ(a,e,n,"")}else a=e}if(a){for(const r of t.children)t.renameSignal(r.getName(n),t.getName(e)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(e,a)}else o.setWithExplicit(e,{explicit:!1,value:void 0})}function R3(t,e){const n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){const t=i.get("type"),n=i.get("range");if(JY(t)){const t=pQ(r.view,e);return XH(n)||uQ(t)?"step":t}return dQ(r.view,e)}if(t.hasProjection||"arc"===t.mark)return dQ(r.view,e);{const t=pQ(r.view,e);return uQ(t)?t.step:t}}function P3(t,e,n){return BG(e,{suffix:"by_".concat(BG(t)),...null!==n&&void 0!==n?n:{}})}class B3 extends h3{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=c5(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!fG(t))return{facet:this.initFacetFieldDef(t,"facet")};const e=rW(t),n={};for(const r of e){if(![DW,FW].includes(r)){JZ(PZ(r,"facet"));break}const e=t[r];if(void 0===e.field){JZ(RZ(e,r));break}n[r]=this.initFacetFieldDef(e,r)}return n}initFacetFieldDef(t,e){const n=XG(t,e);return n.header?n.header=ZH(n.header):null===n.header&&(n.header=null),n}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=j3(this),this.child.parseData()}parseLayoutSize(){O3(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of x$)F3(t,e);N3(t,"x"),N3(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const i of x$)for(const o of X0){const a=this.component.layoutHeaders[i],s=a[o],{facetFieldDef:l}=a;if(l){const n=Y0("titleOrient",l.header,this.config,i);if(["right","bottom"].includes(n)){var e;const r=Z0(i,n);null!==(e=t.titleAnchor)&&void 0!==e||(t.titleAnchor={}),t.titleAnchor[r]="end"}}if(null!==s&&void 0!==s&&s[0]){const e="row"===i?"height":"width",s="header"===o?"headerBand":"footerBand";var n,r;if("facet"!==i&&!this.child.component.layoutSize.get(e))null!==(n=t[s])&&void 0!==n||(t[s]={}),t[s][i]=.5;if(a.title)null!==(r=t.offset)&&void 0!==r||(t.offset={}),t.offset["row"===i?"rowTitle":"columnTitle"]=10}}return t}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof B3)){const t=this.getName("column_domain");return{signal:"length(data('".concat(t,"'))")}}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof B3?{...this.channelHasField("column")?{encode:{update:{columns:{field:BG(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof B3){if(this.child.channelHasField("column")){const r=BG(this.child.facet.column);t.push(r),e.push("distinct"),n.push("distinct_".concat(r))}}else for(const r of oH){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(JY(o)&&XH(a)){const i=L2(j2(this.child,r));i?(t.push(i),e.push("distinct"),n.push("distinct_".concat(i))):JZ(kZ(r))}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const u of x$){const t=this.facet[u];if(t){s.push(BG(t));const{bin:e,sort:l}=t;if(UH(e)&&s.push(BG(t,{binSuffix:"end"})),uG(l)){const{field:e,op:s=oG}=l,u=P3(t,l);n&&r?(i.push(u),o.push("max"),a.push(u)):(i.push(e),o.push(s),a.push(u))}else if(sn(l)){const e=H0(t,u);i.push(e),o.push("max"),a.push(e)}}}const l=!!n&&!!r;return{name:t,data:e,groupby:s,...l||i.length>0?{aggregate:{...l?{cross:l}:{},...i.length?{fields:i,ops:o,as:a}:{}}}:{}}}facetSortFields(t){const{facet:e}=this,n=e[t];return n?uG(n.sort)?[P3(n,n.sort,{expr:"datum"})]:sn(n.sort)?[H0(n,t,{expr:"datum"})]:[BG(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(uG(t)?t.order:!sn(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:e}=this;if(t.facet)return n1(t.facet,"facet",e);const n={row:["top","bottom"],column:["left","right"]};for(const i of G0)if(t[i]){var r;const o=Y0("labelOrient",null===(r=t[i])||void 0===r?void 0:r.header,e,i);if(n[i].includes(o))return n1(t[i],i,e)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=S3(e);for(const r of t.children)n(r,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle(),o={name:this.getName("cell"),type:"group",...r?{title:r}:{},...i?{style:i}:{},from:{facet:this.assembleFacet()},sort:{field:x$.map((t=>this.facetSortFields(t))).flat(),order:x$.map((t=>this.facetSortOrder(t))).flat()},...e.length>0?{data:e}:{},...n?{encode:{update:n}}:{},...t.assembleGroup(GJ(this,[]))};return[o]}getMapping(){return this.facet}}function L3(t,e){for(const a of e){var n,r,i,o;const e=a.data;if(t.name&&a.hasName()&&t.name!==a.dataName)continue;const s=null===(n=t.format)||void 0===n?void 0:n.mesh,l=null===(r=e.format)||void 0===r?void 0:r.feature;if(s&&l)continue;const u=null===(i=t.format)||void 0===i?void 0:i.feature;if((u||l)&&u!==l)continue;const c=null===(o=e.format)||void 0===o?void 0:o.mesh;if(!s&&!c||s===c)if(jJ(t)&&jJ(e)){if(CW(t.values,e.values))return a}else if(LJ(t)&&LJ(e)){if(t.url===e.url)return a}else if(UJ(t)&&t.name===a.dataName)return a}return null}function j3(t){var e,n,r;let i=function(t,e){if(t.data||!t.parent){if(null===t.data){const t=new K1({values:[]});return e.push(t),t}const n=L3(t.data,e);if(n)return qJ(t.data)||(n.data.format=VI({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new K1(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}(t,t.component.data.sources);const{outputNodes:o,outputNodeRefCounts:a}=t.component.data,s=t.data,l=!(s&&(qJ(s)||LJ(s)||jJ(s)))&&t.parent?t.parent.component.data.ancestorParse.clone():new BJ;qJ(s)?(IJ(s)?i=new J1(i,s.sequence):$J(s)&&(i=new Q1(i,s.graticule)),l.parseNothing=!0):null===(null===s||void 0===s||null===(e=s.format)||void 0===e?void 0:e.parse)&&(l.parseNothing=!0),i=null!==(n=G1.makeExplicit(i,t,l))&&void 0!==n?n:i,i=new X1(i);const u=t.parent&&f3(t.parent);var c;(l3(t)||u3(t))&&(u&&(i=null!==(c=I1.makeFromEncoding(i,t))&&void 0!==c?c:i));t.transforms.length>0&&(i=function(t,e,n){let r=0;for(const a of e.transforms){let s,l;if(cJ(a))l=t=new $0(t,a),s="derived";else if(JQ(a)){var i;const r=Y1(a);l=t=null!==(i=G1.makeWithAncestors(t,{},r,n))&&void 0!==i?i:t,t=new D0(t,e,a.filter)}else if(fJ(a))l=t=I1.makeFromTransform(t,a,e),s="number";else if(hJ(a))s="date",void 0===n.getWithExplicit(a.field).value&&(t=new G1(t,{[a.field]:s}),n.set(a.field,s,!1)),l=t=nK.makeFromTransform(t,a);else if(pJ(a))l=t=$1.makeFromTransform(t,a),s="number",A0(e)&&(t=new X1(t));else if(tJ(a))l=t=k3.make(t,e,a,r++),s="derived";else if(sJ(a))l=t=new x2(t,a),s="number";else if(lJ(a))l=t=new v2(t,a),s="number";else if(mJ(a))l=t=b2.makeFromTransform(t,a),s="derived";else if(gJ(a))l=t=new v3(t,a),s="derived";else if(yJ(a))l=t=new m3(t,a),s="derived";else if(uJ(a))l=t=new y3(t,a),s="derived";else if(eJ(a))l=t=new M3(t,a),s="derived";else if(aJ(a))t=new C3(t,a);else if(dJ(a))l=t=_3.makeFromTransform(t,a),s="derived";else if(nJ(a))l=t=new p3(t,a),s="derived";else if(rJ(a))l=t=new A3(t,a),s="derived";else if(iJ(a))l=t=new E3(t,a),s="derived";else{if(!oJ(a)){JZ(FZ(a));continue}l=t=new w3(t,a),s="derived"}if(l&&void 0!==s)for(const t of null!==(o=l.producedFields())&&void 0!==o?o:[]){var o;n.set(t,s,!1)}}return t}(i,t,l));const f=function(t){const e={};if(l3(t)&&t.component.selection)for(const n of rW(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&yW(t.field)>1&&(e[t.field]="flatten")}return e}(t),d=V1(t);if(i=null!==(r=G1.makeWithAncestors(i,{},{...f,...d},l))&&void 0!==r?r:i,l3(t)&&(i=b3.parseAll(i,t),i=x3.parseAll(i,t)),l3(t)||u3(t)){var h,p;if(!u)i=null!==(p=I1.makeFromEncoding(i,t))&&void 0!==p?p:i;i=null!==(h=nK.makeFromEncoding(i,t))&&void 0!==h?h:i,i=$0.parseAllForSortIndex(i,t)}const m=t.getDataName(HJ.Raw),g=new KJ(i,m,HJ.Raw,a);if(o[m]=g,i=g,l3(t)){var y,v;const e=$1.makeFromEncoding(i,t);e&&(i=e,A0(t)&&(i=new X1(i))),i=null!==(y=_3.makeFromEncoding(i,t))&&void 0!==y?y:i,i=null!==(v=b2.makeFromEncoding(i,t))&&void 0!==v?v:i}var b;l3(t)&&(i=null!==(b=g3.make(i,t))&&void 0!==b?b:i);const x=t.getDataName(HJ.Main),_=new KJ(i,x,HJ.Main,a);o[x]=_,i=_,l3(t)&&function(t,e){for(const[r,i]of oW(null!==(n=t.component.selection)&&void 0!==n?n:{})){var n;const o=t.getName("lookup_".concat(r));t.component.data.outputNodes[o]=i.materialized=new KJ(new D0(e,t,{param:r}),o,HJ.Lookup,t.component.data.outputNodeRefCounts)}}(t,_);let w=null;if(u3(t)){var k;const e=t.getName("facet");i=null!==(k=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(uG(i.sort)){const{field:n,op:r=oG}=i.sort;t=e=new v2(t,{joinaggregate:[{op:r,field:n,as:P3(i,i.sort,{forAs:!0})}],groupby:[BG(i)]})}return e}return null}(i,t.facet))&&void 0!==k?k:i,w=new H1(i,t,e,_.getSource()),o[e]=w}return{...t.component.data,outputNodes:o,outputNodeRefCounts:a,raw:g,main:_,facetRoot:w,ancestorParse:l}}class U3 extends d3{constructor(t,e,n,r){var i,o;super(t,"concat",e,n,r,t.resolve),"shared"!==(null===(i=t.resolve)||void 0===i||null===(i=i.axis)||void 0===i?void 0:i.x)&&"shared"!==(null===(o=t.resolve)||void 0===o||null===(o=o.axis)||void 0===o?void 0:o.y)||JZ("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map(((t,e)=>c5(t,this,this.getName("concat_".concat(e)),void 0,r)))}parseData(){this.component.data=j3(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of rW(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return aQ(t)?t.vconcat:sQ(t)?t.hconcat:t.concat}parseLayoutSize(){!function(t){O3(t);const e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";z3(t,e),z3(t,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.forEach((t=>t.assembleSignals())),[]}assembleLayoutSignals(){const t=s1(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleMarks(){return this.children.map((t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...e?{title:e}:{},...n?{style:n}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}}))}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...null!=t?{columns:t}:{},bounds:"full",align:"each"}}}const q3={disable:1,gridScale:1,scale:1,...sX,labelExpr:1,encode:1},I3=rW(q3);class W3 extends TJ{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new W3(jI(this.explicit),jI(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!function(t){return!1===t||null===t}(this.get(t)))}hasOrientSignalRef(){return GH(this.explicit.orient)}}const $3={bottom:"top",top:"bottom",left:"right",right:"left"};function H3(t,e){if(!t)return e.map((t=>t.clone()));{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!==!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(e.explicit&&o.explicit&&e.value!==o.value)return;t[r]=Z3(n,i)}}}return t}function Z3(t,e){for(const n of I3){const r=PJ(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",((t,e)=>{switch(n){case"title":return yZ(t,e);case"gridScale":return{explicit:t.explicit,value:vW(t.value,e.value)}}return RJ(t,e,n,"axis")}));t.setWithExplicit(n,r)}return t}function Y3(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(GH(n.labelAngle)?n.labelAngle:AW(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===W0(r,i))return!0}return t===n[e]}const V3=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function G3(t,e){var n,r,i,o,a;let s=e.axis(t);const l=new W3,u=YG(e.encoding[t]),{mark:c,config:f}=e,d=(null===(n=s)||void 0===n?void 0:n.orient)||(null===(r=f["x"===t?"axisX":"axisY"])||void 0===r?void 0:r.orient)||(null===(i=f.axis)||void 0===i?void 0:i.orient)||function(t){return"x"===t?"bottom":"left"}(t),h=e.getScaleComponent(t).get("type"),p=function(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:VY(e)?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[],o="x"===t?"axisX":"axisY",a=GH(n)?"axisOrient":"axis".concat(cW(n)),s=[...i,...i.map((t=>o+t.substr(4)))],l=["axis",a,o];return{vlOnlyAxisConfig:P0(s,r,t,n),vgAxisConfig:P0(l,r,t,n),axisConfigStyle:B0([...l,...s],r)}}(t,h,d,e.config),m=void 0!==s?!s:L0("disable",f.style,null===(o=s)||void 0===o?void 0:o.style,p).configValue;if(l.set("disable",m,void 0!==s),m)return l;s=s||{};const g=function(t,e,n,r,i){const o=null===e||void 0===e?void 0:e.labelAngle;if(void 0!==o)return GH(o)?o:AW(o);{const{configValue:o}=L0("labelAngle",r,null===e||void 0===e?void 0:e.style,i);return void 0!==o?AW(o):n!==NW||!HI([jY,BY],t.type)||kG(t)&&t.timeUnit?void 0:270}}(u,s,t,f.style,p),y=tG(s.formatType,u,h),v=KV(u,u.type,s.format,s.formatType,f,!0),b={fieldOrDatumDef:u,axis:s,channel:t,model:e,scaleType:h,orient:d,labelAngle:g,format:v,formatType:y,mark:c,config:f};for(const w of I3){const n=w in j0?j0[w](b):uX(w)?s[w]:void 0,r=void 0!==n,i=Y3(n,w,s,e,t);if(r&&i)l.set(w,n,i);else{const{configValue:t,configFrom:e}=uX(w)&&"values"!==w?L0(w,f.style,s.style,p):{},o=void 0!==t;r&&!o?l.set(w,n,i):("vgAxisConfig"!==e||V3.has(w)&&o||iX(t)||GH(t))&&l.set(w,t,!1)}}const x=null!==(a=s.encoding)&&void 0!==a?a:{},_=oX.reduce(((n,r)=>{var i;if(!l.hasAxisPart(r))return n;const o=d1(null!==(i=x[r])&&void 0!==i?i:{},e),a="labels"===r?function(t,e,n){var r;const{encoding:i,config:o}=t,a=null!==(r=YG(i[e]))&&void 0!==r?r:YG(i[P$(e)]),s=t.axis(e)||{},{format:l,formatType:u}=s;if(YV(u))return{text:JV({fieldOrDatumDef:a,field:"datum.value",format:l,formatType:u,config:o}),...n};if(void 0===l&&void 0===u&&o.customFormatTypes){if("quantitative"===AG(a)){if(OG(a)&&"normalize"===a.stack&&o.normalizedNumberFormatType)return{text:JV({fieldOrDatumDef:a,field:"datum.value",format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,config:o}),...n};if(o.numberFormatType)return{text:JV({fieldOrDatumDef:a,field:"datum.value",format:o.numberFormat,formatType:o.numberFormatType,config:o}),...n}}if("temporal"===AG(a)&&o.timeFormatType&&kG(a)&&!a.timeUnit)return{text:JV({fieldOrDatumDef:a,field:"datum.value",format:o.timeFormat,formatType:o.timeFormatType,config:o}),...n}}return n}(e,t,o):o;return void 0===a||nW(a)||(n[r]={update:a}),n}),{});return nW(_)||l.set("encode",_,!!s.encoding||void 0!==s.labelAngle),l}function X3(t,e){const{config:n}=t;return{...XK(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...BK("x",t,{defaultPos:"mid"}),...BK("y",t,{defaultPos:"mid"}),...OK("size",t),...OK("angle",t),...Q3(t,n,e)}}function Q3(t,e,n){return n?{shape:{value:n}}:OK("shape",t)}const J3={vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?{...XK(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...IK("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n}),...IK("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n}),...OK("size",t,{vgChannel:"strokeWidth"})}:{}}};function K3(t,e,n){if(void 0===cZ("align",t,n))return"center"}function t5(t,e,n){if(void 0===cZ("baseline",t,n))return"middle"}const e5={vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return{...XK(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...BK("x",t,{defaultPos:"mid",vgChannel:"xc"}),...BK("y",t,{defaultPos:"mid",vgChannel:"yc"}),...OK("size",t,{defaultValue:n5(t),vgChannel:i}),[o]:iZ(cZ("thickness",n,e))}}};function n5(t){var e;const{config:n,markDef:r}=t,{orient:i}=r,o="horizontal"===i?"width":"height",a=t.getScaleComponent("horizontal"===i?"x":"y"),s=null!==(e=cZ("size",r,n,{vgChannel:o}))&&void 0!==e?e:n.tick.bandSize;if(void 0!==s)return s;{const t=a?a.get("range"):void 0;if(t&&XH(t)&&nr(t.step))return 3*t.step/4;return 3*hQ(n.view,o)/4}}const r5={arc:{vgMark:"arc",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...BK("x",t,{defaultPos:"mid"}),...BK("y",t,{defaultPos:"mid"}),...HK(t,"radius"),...HK(t,"theta")})},area:{vgMark:"area",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...IK("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient}),...IK("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient}),...KK(t)})},bar:{vgMark:"rect",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...HK(t,"x"),...HK(t,"y")})},circle:{vgMark:"symbol",encodeEntry:t=>X3(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[{type:"geoshape",projection:t.projectionName(),...n&&kG(n)&&n.type===UY?{field:BG(n,{expr:"datum"})}:{}}]}},image:{vgMark:"image",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...HK(t,"x"),...HK(t,"y"),...EK(t,"url")})},line:{vgMark:"line",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...BK("x",t,{defaultPos:"mid"}),...BK("y",t,{defaultPos:"mid"}),...OK("size",t,{vgChannel:"strokeWidth"}),...KK(t)})},point:{vgMark:"symbol",encodeEntry:t=>X3(t)},rect:{vgMark:"rect",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...HK(t,"x"),...HK(t,"y")})},rule:J3,square:{vgMark:"symbol",encodeEntry:t=>X3(t,"square")},text:{vgMark:"text",encodeEntry:t=>{const{config:e,encoding:n}=t;return{...XK(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...BK("x",t,{defaultPos:"mid"}),...BK("y",t,{defaultPos:"mid"}),...EK(t),...OK("size",t,{vgChannel:"fontSize"}),...OK("angle",t),...t0("align",K3(t.markDef,n,e)),...t0("baseline",t5(t.markDef,n,e)),...BK("radius",t,{defaultPos:null}),...BK("theta",t,{defaultPos:null})}}},tick:e5,trail:{vgMark:"trail",encodeEntry:t=>({...XK(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...BK("x",t,{defaultPos:"mid"}),...BK("y",t,{defaultPos:"mid"}),...OK("size",t),...KK(t)})}};function i5(t){if(HI([bV,gV,EV],t.mark)){const e=_X(t.mark,t.encoding);if(e.length>0)return function(t,e){return[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:o5+t.requestDataName(HJ.Main),data:t.requestDataName(HJ.Main),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:s5(t,{fromPrefix:o5})}]}(t,e)}else if(t.mark===yV){const e=tZ.some((e=>cZ(e,t.markDef,t.config)));if(t.stack&&!t.fieldDef("size")&&e)return function(t){var e;const[n]=s5(t,{fromPrefix:a5}),r=t.scaleName(t.stack.fieldChannel),i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.vgField(t.stack.fieldChannel,e)},o=(t,e)=>{const n=[i({prefix:"min",suffix:"start",expr:e}),i({prefix:"max",suffix:"start",expr:e}),i({prefix:"min",suffix:"end",expr:e}),i({prefix:"max",suffix:"end",expr:e})];return"".concat(t,"(").concat(n.map((t=>"scale('".concat(r,"',").concat(t,")"))).join(","),")")};let a,s;"x"===t.stack.fieldChannel?(a={...qI(n.encode.update,["y","yc","y2","height",...tZ]),x:{signal:o("min","datum")},x2:{signal:o("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update={...II(n.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(a={...qI(n.encode.update,["x","xc","x2","width"]),y:{signal:o("min","datum")},y2:{signal:o("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update={...II(n.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const u of tZ){const e=fZ(u,t.markDef,t.config);n.encode.update[u]?(a[u]=n.encode.update[u],delete n.encode.update[u]):e&&(a[u]=iZ(e)),e&&(n.encode.update[u]={value:0})}const l=[];if((null===(e=t.stack.groupbyChannels)||void 0===e?void 0:e.length)>0)for(const u of t.stack.groupbyChannels){const e=t.fieldDef(u),n=BG(e);n&&l.push(n),(null!==e&&void 0!==e&&e.bin||null!==e&&void 0!==e&&e.timeUnit)&&l.push(BG(e,{binSuffix:"end"}))}a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((e,r)=>{if(n.encode.update[r])return{...e,[r]:n.encode.update[r]};{const n=fZ(r,t.markDef,t.config);return void 0!==n?{...e,[r]:iZ(n)}:e}}),a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0});return[{type:"group",from:{facet:{data:t.requestDataName(HJ.Main),name:a5+t.requestDataName(HJ.Main),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}(t)}return s5(t)}const o5="faceted_path_";const a5="stack_group_";function s5(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""};const{mark:n,markDef:r,encoding:i,config:o}=t,a=vW(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!!(null!==e&&void 0!==e&&e.get("selectionExtent")||null!==n&&void 0!==n&&n.get("selectionExtent"))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),s=uZ(r),l=i.key,u=function(t){const{encoding:e,stack:n,mark:r,markDef:i,config:o}=t,a=e.order;if(!(!sn(a)&&TG(a)&&$I(a.value)||!a&&$I(cZ("order",i,o)))){if((sn(a)||kG(a))&&!n)return pZ(a,{expr:"datum"});if(DV(r)){const n="horizontal"===i.orient?"y":"x",r=e[n];if(kG(r)){const e=r.sort;if(sn(e))return{field:BG(r,{prefix:n,suffix:"sort_index",expr:"datum"})};if(uG(e))return{field:BG({aggregate:gX(t.encoding)?e.op:void 0,field:e.field},{expr:"datum"})};if(lG(e))return{field:BG(t.fieldDef(e.encoding),{expr:"datum"}),order:e.order};if(null===e)return;var s;return{field:BG(r,{binSuffix:null!==(s=t.stack)&&void 0!==s&&s.impute?"mid":void 0,expr:"datum"})}}}}}(t),c=function(t){if(!t.component.selection)return null;const e=rW(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=rW(r.component.selection).length,r=r.parent;return n?{interactive:e>0||"geoshape"===t.mark||!!t.encoding.tooltip}:null}(t),f=cZ("aria",r,o),d=r5[n].postEncodingTransform?r5[n].postEncodingTransform(t):null;return[{name:t.getName("marks"),type:r5[n].vgMark,...a?{clip:!0}:{},...s?{style:s}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...!1===f?{aria:f}:{},from:{data:e.fromPrefix+t.requestDataName(HJ.Main)},encode:{update:r5[n].encodeEntry(t)},...d?{transform:d}:{}}]}class l5 extends h3{constructor(t,e,n){var r;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;super(t,"unit",e,n,o,void 0,cQ(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=NV(t.mark)?{...t.mark}:{type:t.mark},s=a.type;void 0===a.filled&&(a.filled=function(t,e,n){let{graticule:r}=n;if(r)return!1;const i=fZ("filled",t,e),o=t.type;return vW(i,o!==xV&&o!==bV&&o!==wV)}(a,o,{graticule:t.data&&$J(t.data)}));const l=this.encoding=function(t,e,n,r){const i={};for(const a of rW(t))T$(a)||JZ("".concat(o=a,"-encoding is dropped as ").concat(o," is not a valid encoding channel."));var o;for(let a of q$){if(!t[a])continue;const o=t[a];if(fH(a)){const t=U$(a),e=i[t];if(kG(e)&&zY(e.type)&&kG(o)&&!e.timeUnit){JZ(NZ(t));continue}}if("angle"!==a||"arc"!==e||t.theta||(JZ("Arc marks uses theta channel rather than angle, replacing angle with theta."),a=UW),vX(t,a,e)){if(a===XW&&"line"===e){const e=ZG(t[a]);if(null!==e&&void 0!==e&&e.aggregate){JZ("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(a===ZW&&(n?"fill"in t:"stroke"in t))JZ(zZ("encoding",{fill:"fill"in t,stroke:"stroke"in t}));else if(a===o$||a===i$&&!sn(o)&&!TG(o)||a===s$&&sn(o)){if(o){if(a===i$){const e=t[a];if(bG(e)){i[a]=e;continue}}i[a]=Nn(o).reduce(((t,e)=>(kG(e)?t.push(XG(e,a)):JZ(RZ(e,a)),t)),[])}}else{if(a===s$&&null===o)i[a]=null;else if(!kG(o)&&!EG(o)&&!TG(o)&&!xG(o)&&!GH(o)){JZ(RZ(o,a));continue}i[a]=VG(o,a,r)}}else JZ(PZ(a,e))}return i}(t.encoding||{},s,a.filled,o);this.markDef=PQ(a,l,o),this.size=function(t){let{encoding:e,size:n}=t;for(const r of oH){const t=B$(r);uQ(n[t])&&MG(e[r])&&(delete n[t],JZ($Z(t)))}return n}({encoding:l,size:cQ(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=RQ(this.markDef,l),this.specifiedScales=this.initScales(s,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=(null!==(r=t.params)&&void 0!==r?r:[]).filter((t=>rQ(t)))}get hasProjection(){const{encoding:t}=this,e=this.mark===SV,n=t&&g$.some((e=>DG(t[e])));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return kH.reduce(((t,n)=>{const r=YG(e[n]);var i;r&&(t[n]=this.initScale(null!==(i=r.scale)&&void 0!==i?i:{}));return t}),{})}initScale(t){const{domain:e,range:n}=t,r=ZH(t);return sn(e)&&(r.domain=e.map(nZ)),sn(n)&&(r.range=n.map(nZ)),r}initAxes(t){return oH.reduce(((e,n)=>{const r=t[n];if(DG(r)||n===NW&&DG(t.x2)||n===OW&&DG(t.y2)){const t=DG(r)?r.axis:void 0;e[n]=t?this.initAxis({...t}):t}return e}),{})}initAxis(t){const e=rW(t),n={};for(const r of e){const e=t[r];n[r]=iX(e)?eZ(e):nZ(e)}return n}initLegends(t){return _H.reduce(((e,n)=>{const r=YG(t[n]);if(r&&function(t){switch(t){case ZW:case YW:case VW:case XW:case GW:case JW:case e$:case n$:return!0;case KW:case t$:case QW:return!1}}(n)){const t=r.legend;e[n]=t?ZH(t):t}return e}),{})}parseData(){this.component.data=j3(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of oH){const i=B$(r);if(e[i]){const t=e[i];n.layoutSize.set(i,uQ(t)?"step":t,!0)}else{const e=R3(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){const n={},r=t.config.selection;if(!e||!e.length)return n;for(const o of e){const e=sW(o.name),a=o.select,s=ir(a)?a:a.type,l=ln(a)?jI(a):{type:s},u=r[s];for(const t in u){var i;"fields"!==t&&"encodings"!==t&&("mark"===t&&(l[t]={...u[t],...l[t]}),(void 0===l[t]||!0===l[t])&&(l[t]=jI(null!==(i=u[t])&&void 0!==i?i:l[t])))}const c=n[e]={...l,name:e,type:s,init:o.value,bind:o.bind,events:ir(l.on)?eL(l.on,"scope"):Nn(jI(l.on))},f=jI(o);for(const n of w0)n.defined(c)&&n.parse&&n.parse(t,c,f)}return n}(this,this.selection)}parseMarkGroup(){this.component.mark=i5(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,oH.reduce(((e,n)=>(t.component.scales[n]&&(e[n]=[G3(n,t)]),e)),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){let n=!1;for(const i of iW(null!==(r=t.component.selection)&&void 0!==r?r:{})){var r;const o=i.name,a=hr(o+v0),s=e.filter((t=>t.name===o));if(0===s.length){const t="global"===i.resolve?"union":i.resolve,n="point"===i.type?", true, true)":")";e.push({name:i.name,update:"".concat(_0,"(").concat(a,", ").concat(hr(t)).concat(n)})}n=!0;for(const n of w0)n.defined(i)&&n.topLevelSignals&&(e=n.topLevelSignals(t,i,e))}if(n){const t=e.filter((t=>"unit"===t.name));0===t.length&&e.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]})}return QJ(e)}(this,t)}assembleSignals(){return[...R0(this),...VJ(this,[])]}assembleSelectionData(t){return function(t,e){const n=[...e],r=k0(t,{escape:!1});for(const o of iW(null!==(i=t.component.selection)&&void 0!==i?i:{})){var i;const t={name:o.name+v0};if(o.project.hasSelectionId&&(t.transform=[{type:"collect",sort:{field:KX}}]),o.init){const e=o.project.items.map(ZJ);t.values=o.project.hasSelectionId?o.init.map((t=>({unit:r,[KX]:YJ(t,!1)[0]}))):o.init.map((t=>({unit:r,fields:e,values:YJ(t,!1)})))}n.filter((t=>t.name===o.name+v0)).length||n.push(t)}return n}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return s1(this)}assembleMarks(){var t;let e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&f3(this.parent)||(e=XJ(this,e)),e.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return hX(this.encoding,t)}fieldDef(t){return ZG(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return FG(e)?e:null}}class u5 extends d3{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const o={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map(((t,e)=>{if(SQ(t))return new u5(t,this,this.getName("layer_".concat(e)),o,i);if(fX(t))return new l5(t,this,this.getName("layer_".concat(e)),o,i);throw new Error(vZ(t))}))}parseData(){this.component.data=j3(this);for(const t of this.children)t.parseData()}parseLayoutSize(){var t;O3(t=this),z3(t,"width"),z3(t,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of rW(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){const{axes:e,resolve:n}=t.component,r={top:0,bottom:0,right:0,left:0};for(const o of t.children){o.parseAxesAndHeaders();for(const r of rW(o.component.axes))n.axis[r]=p1(t.component.resolve,r),"shared"===n.axis[r]&&(e[r]=H3(e[r],o.component.axes[r]),e[r]||(n.axis[r]="independent",delete e[r]))}for(const o of oH){for(const a of t.children)if(a.component.axes[o]){if("independent"===n.axis[o]){var i;e[o]=(null!==(i=e[o])&&void 0!==i?i:[]).concat(a.component.axes[o]);for(const t of a.component.axes[o]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!GH(e)){if(r[e]>0&&!n){const n=$3[e];r[e]>r[n]&&t.set("orient",n,!1)}r[e]++}}}delete a.component.axes[o]}if("independent"===n.axis[o]&&e[o]&&e[o].length>1)for(const[t,n]of(e[o]||[]).entries())t>0&&n.get("grid")&&!n.explicit.grid&&(n.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleSignals())),R0(this))}assembleLayoutSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleLayoutSignals())),s1(this))}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleGroupStyle(){const t=new Set;for(const n of this.children)for(const e of Nn(n.assembleGroupStyle()))t.add(e);const e=Array.from(t);return e.length>1?e:1===e.length?e[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)l3(n)&&(e=XJ(n,e));return e}(this,this.children.flatMap((t=>t.assembleMarks())))}assembleLegends(){return this.children.reduce(((t,e)=>t.concat(e.assembleLegends())),N1(this))}}function c5(t,e,n,r,i){if(hG(t))return new B3(t,e,n,i);if(SQ(t))return new u5(t,e,n,r,i);if(fX(t))return new l5(t,e,n,r,i);if(function(t){return aQ(t)||sQ(t)||oQ(t)}(t))return new U3(t,e,n,i);throw new Error(vZ(t))}function f5(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;e.logger&&(n=e.logger,XZ=n),e.fieldTitle&&qG(e.fieldTitle);try{const n=wQ(cn(e.config,t.config)),r=AJ(t,n),i=c5(r,null,"",void 0,n);i.parse(),function(t,e){E2(t.sources);let n=0,r=0;for(let i=0;i<A2&&C2(t,e,!0);i++)n++;t.sources.map(_2);for(let i=0;i<A2&&C2(t,e,!1);i++)r++;E2(t.sources),Math.max(n,r)===A2&&JZ("Maximum optimization runs(".concat(A2,") reached."))}(i.component.data,i);const o=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const i=t.config?MQ(t.config):void 0,o=[].concat(t.assembleSelectionData([]),function(t,e){const n=[],r=S3(n);let i=0;for(const l of t.sources){l.hasName()||(l.dataName="source_".concat(i++));const t=l.assemble();r(l,t)}for(const l of n)0===l.transform.length&&delete l.transform;let o=0;for(const[l,u]of n.entries()){var a;0!==(null!==(a=u.transform)&&void 0!==a?a:[]).length||u.source||n.splice(o++,0,n.splice(l,1)[0])}for(const l of n)for(const e of null!==(s=l.transform)&&void 0!==s?s:[]){var s;"lookup"===e.type&&(e.from=t.outputNodes[e.from].getSource())}for(const l of n)l.name in e&&(l.values=e[l.name]);return n}(t.component.data,n)),a=t.assembleProjections(),s=t.assembleTitle(),l=t.assembleGroupStyle(),u=t.assembleGroupEncodeEntry(!0);let c=t.assembleLayoutSignals();c=c.filter((t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1)));const{params:f,...d}=e;return{$schema:"https://vega.github.io/schema/vega/v5.json",...t.description?{description:t.description}:{},...d,...s?{title:s}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:o,...a.length>0?{projections:a}:{},...t.assembleGroup([...c,...t.assembleSelectionTopLevelSignals([]),...iQ(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):ir(e)&&(e={type:e});if(i&&o&&(a=e.type,"fit"===a||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)JZ(wZ()),e.type="pad";else if("step"===i||"step"===o){const t="step"===i?"width":"height";JZ(wZ(uH(t)));const n="width"===t?"height":"width";e.type=function(t){return t?"fit-".concat(uH(t)):"fit"}(n)}var a;return{...1===rW(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e},...FJ(n,!1),...FJ(t,!0)}}(t,r.autosize,n,i),t.datasets,t.usermeta);return{spec:o,normalized:r}}finally{e.logger&&QZ(),e.fieldTitle&&qG(jG)}}const d5="5.16.3";const h5=function(t){const[e,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e,version:n}};var p5="2.14.0";const m5="#fff",g5="#888",y5={background:"#333",view:{stroke:g5},title:{color:m5,subtitleColor:m5},style:{"guide-label":{fill:m5},"guide-title":{fill:m5}},axis:{domainColor:m5,gridColor:g5,tickColor:m5}},v5="#4572a7",b5={background:"#fff",arc:{fill:v5},area:{fill:v5},line:{stroke:v5,strokeWidth:2},path:{stroke:v5},rect:{fill:v5},shape:{stroke:v5},symbol:{fill:v5,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},x5="#30a2da",_5="#cbcbcb",w5="#f0f0f0",k5="#333",A5={arc:{fill:x5},area:{fill:x5},axis:{domainColor:_5,grid:!0,gridColor:_5,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:_5,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:w5,group:{fill:w5},legend:{labelColor:k5,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:k5,titleFontSize:14,titlePadding:10},line:{stroke:x5,strokeWidth:2},path:{stroke:x5,strokeWidth:.5},rect:{fill:x5},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:x5},bar:{binSpacing:2,fill:x5,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},E5="#000",M5={group:{fill:"#e5e5e5"},arc:{fill:E5},area:{fill:E5},line:{stroke:E5},path:{stroke:E5},rect:{fill:E5},shape:{stroke:E5},symbol:{fill:E5,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},C5="Benton Gothic, sans-serif",S5="#82c6df",D5="Benton Gothic Bold, sans-serif",F5="normal",T5={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},N5={background:"#ffffff",title:{anchor:"start",color:"#000000",font:D5,fontSize:22,fontWeight:"normal"},arc:{fill:S5},area:{fill:S5},line:{stroke:S5,strokeWidth:2},path:{stroke:S5},rect:{fill:S5},shape:{stroke:S5},symbol:{fill:S5,size:30},axis:{labelFont:C5,labelFontSize:11.5,labelFontWeight:"normal",titleFont:D5,titleFontSize:13,titleFontWeight:F5},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:C5,labelFontSize:11.5,symbolType:"square",titleFont:D5,titleFontSize:13,titleFontWeight:F5},range:{category:T5["category-6"],diverging:T5["fireandice-6"],heatmap:T5["fire-7"],ordinal:T5["fire-7"],ramp:T5["fire-7"]}},O5="#ab5787",z5="#979797",R5={background:"#f9f9f9",arc:{fill:O5},area:{fill:O5},line:{stroke:O5},path:{stroke:O5},rect:{fill:O5},shape:{stroke:O5},symbol:{fill:O5,size:30},axis:{domainColor:z5,domainWidth:.5,gridWidth:.2,labelColor:z5,tickColor:z5,tickWidth:.2,titleColor:z5},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},P5="#3e5c69",B5={background:"#fff",arc:{fill:P5},area:{fill:P5},line:{stroke:P5},path:{stroke:P5},rect:{fill:P5},shape:{stroke:P5},symbol:{fill:P5},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},L5="#1696d2",j5="#000000",U5="Lato",q5="Lato",I5={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},W5={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:U5},axisX:{domain:!0,domainColor:j5,domainWidth:1,grid:!1,labelFontSize:12,labelFont:q5,labelAngle:0,tickColor:j5,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:U5},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:q5,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:U5,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:q5,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:U5,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:I5["six-groups-cat-1"],diverging:I5["diverging-colors"],heatmap:I5["diverging-colors"],ordinal:I5["six-groups-seq"],ramp:I5["shades-blue"]},area:{fill:L5},rect:{fill:L5},line:{color:L5,stroke:L5,strokeWidth:5},trail:{color:L5,stroke:L5,strokeWidth:0,size:1},path:{stroke:L5,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:L5,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:L5,stroke:null}},arc:{fill:L5},shape:{stroke:L5},symbol:{fill:L5,size:30}},$5="#3366CC",H5="#ccc",Z5="Arial, sans-serif",Y5={arc:{fill:$5},area:{fill:$5},path:{stroke:$5},rect:{fill:$5},shape:{stroke:$5},symbol:{stroke:$5},circle:{fill:$5},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Z5,fontSize:12},"guide-title":{font:Z5,fontSize:12},"group-title":{font:Z5,fontSize:12}},title:{font:Z5,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:H5,tickColor:H5,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},V5=t=>t*(1/3+1),G5=V5(9),X5=V5(10),Q5=V5(12),J5="Segoe UI",K5="wf_standard-font, helvetica, arial, sans-serif",t6="#252423",e6="#605E5C",n6="transparent",r6="#118DFF",i6="#DEEFFF",o6=[i6,r6],a6={view:{stroke:n6},background:n6,font:J5,header:{titleFont:K5,titleFontSize:Q5,titleColor:t6,labelFont:J5,labelFontSize:X5,labelColor:e6},axis:{ticks:!1,grid:!1,domain:!1,labelColor:e6,labelFontSize:G5,titleFont:K5,titleColor:t6,titleFontSize:Q5,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:r6},line:{stroke:r6,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:J5,fontSize:G5,fill:e6},arc:{fill:r6},area:{fill:r6,line:!0,opacity:.6},path:{stroke:r6},rect:{fill:r6},point:{fill:r6,filled:!0,size:75},shape:{stroke:r6},symbol:{fill:r6,strokeWidth:1.5,size:50},legend:{titleFont:J5,titleFontWeight:"bold",titleColor:e6,labelFont:J5,labelFontSize:X5,labelColor:e6,symbolType:"circle",symbolSize:75},range:{category:[r6,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:o6,heatmap:o6,ordinal:[i6,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",r6]}},s6='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',l6=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],u6=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function c6(t){let{type:e,background:n}=t;const r="dark"===e?"#161616":"#ffffff",i="dark"===e?"#f4f4f4":"#161616",o="dark"===e?"#d4bbff":"#6929c4";return{background:n,arc:{fill:o},area:{fill:o},path:{stroke:o},rect:{fill:o},shape:{stroke:o},symbol:{stroke:o},circle:{fill:o},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:s6,fontWeight:600},axis:{labelColor:i,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:i,labelAngle:0},style:{"guide-label":{font:s6,fill:i,fontWeight:400},"guide-title":{font:s6,fill:i,fontWeight:400}},range:{category:"dark"===e?l6:u6,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const f6=c6({type:"light",background:"#ffffff"}),d6=c6({type:"light",background:"#f4f4f4"}),h6=c6({type:"dark",background:"#262626"}),p6=c6({type:"dark",background:"#161616"}),m6=p5;function g6(t,e){return JSON.stringify(t,function(t){const e=[];return function(n,r){if("object"!==typeof r||null===r)return r;const i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}const y6="vg-tooltip-element",v6={offsetX:10,offsetY:10,id:y6,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function(t,e,n,r){if(sn(t))return"[".concat(t.map((t=>e(ir(t)?t:g6(t,n)))).join(", "),"]");if(ln(t)){let i="";const{title:o,image:a,...s}=t;o&&(i+="<h2>".concat(e(o),"</h2>")),a&&(i+='<img src="'.concat(new URL(e(a),r||location.href).href,'">'));const l=Object.keys(s);if(l.length>0){i+="<table>";for(const t of l){let r=s[t];void 0!==r&&(ln(r)&&(r=g6(r,n)),i+='<tr><td class="key">'.concat(e(t),'</td><td class="value">').concat(e(r),"</td></tr>"))}i+="</table>"}return i||"{}"}return e(t)},baseURL:""};class b6{constructor(t){this.options={...v6,...t};const e=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n".toString().replace(y6,t)}(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)}}tooltipHandler(t,e,n,r){if(this.el=document.getElementById(this.options.id),!this.el){var i;this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip");(null!==(i=document.fullscreenElement)&&void 0!==i?i:document.body).appendChild(this.el)}if(null==r||""===r)return void this.el.classList.remove("visible","".concat(this.options.theme,"-theme"));this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));const{x:o,y:a}=function(t,e,n,r){let i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);let o=t.clientY+r;return o+e.height>window.innerHeight&&(o=+t.clientY-r-e.height),{x:i,y:o}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top="".concat(a,"px"),this.el.style.left="".concat(o,"px")}}var x6,_6,w6;function k6(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var A6=E6;function E6(t){var e=this;if(e instanceof E6||(e=new E6),e.tail=null,e.head=null,e.length=0,t&&"function"===typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)e.push(arguments[n]);return e}function M6(t,e,n){var r=e===t.head?new D6(n,null,e,t):new D6(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function C6(t,e){t.tail=new D6(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function S6(t,e){t.head=new D6(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function D6(t,e,n,r){if(!(this instanceof D6))return new D6(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}E6.Node=D6,E6.create=E6,E6.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},E6.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},E6.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},E6.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)C6(this,arguments[t]);return this.length},E6.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)S6(this,arguments[t]);return this.length},E6.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},E6.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},E6.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},E6.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},E6.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},E6.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},E6.prototype.map=function(t,e){e=e||this;for(var n=new E6,r=this.head;null!==r;)n.push(t.call(e,r.value,this)),r=r.next;return n},E6.prototype.mapReverse=function(t,e){e=e||this;for(var n=new E6,r=this.tail;null!==r;)n.push(t.call(e,r.value,this)),r=r.prev;return n},E6.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},E6.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},E6.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},E6.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},E6.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new E6;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;null!==i&&r<t;r++)i=i.next;for(;null!==i&&r<e;r++,i=i.next)n.push(i.value);return n},E6.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new E6;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;null!==i&&r>e;r--)i=i.prev;for(;null!==i&&r>t;r--,i=i.prev)n.push(i.value);return n},E6.prototype.splice=function(t,e){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,r=this.head;null!==r&&n<t;n++)r=r.next;var i=[];for(n=0;r&&n<e;n++)i.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=M6(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return i},E6.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{(w6||(w6=1,_6=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),_6)(E6)}catch(C7){}const F6=A6,T6=Symbol("max"),N6=Symbol("length"),O6=Symbol("lengthCalculator"),z6=Symbol("allowStale"),R6=Symbol("maxAge"),P6=Symbol("dispose"),B6=Symbol("noDisposeOnSet"),L6=Symbol("lruList"),j6=Symbol("cache"),U6=Symbol("updateAgeOnGet"),q6=()=>1;const I6=(t,e,n)=>{const r=t[j6].get(e);if(r){const e=r.value;if(W6(t,e)){if(H6(t,r),!t[z6])return}else n&&(t[U6]&&(r.value.now=Date.now()),t[L6].unshiftNode(r));return e.value}},W6=(t,e)=>{if(!e||!e.maxAge&&!t[R6])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[R6]&&n>t[R6]},$6=t=>{if(t[N6]>t[T6])for(let e=t[L6].tail;t[N6]>t[T6]&&null!==e;){const n=e.prev;H6(t,e),e=n}},H6=(t,e)=>{if(e){const n=e.value;t[P6]&&t[P6](n.key,n.value),t[N6]-=n.length,t[j6].delete(n.key),t[L6].removeNode(e)}};class Z6{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const Y6=(t,e,n,r)=>{let i=n.value;W6(t,i)&&(H6(t,n),t[z6]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};var V6=class{constructor(t){if("number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[T6]=t.max||1/0;const e=t.length||q6;if(this[O6]="function"!==typeof e?q6:e,this[z6]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[R6]=t.maxAge||0,this[P6]=t.dispose,this[B6]=t.noDisposeOnSet||!1,this[U6]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!==typeof t||t<0)throw new TypeError("max must be a non-negative number");this[T6]=t||1/0,$6(this)}get max(){return this[T6]}set allowStale(t){this[z6]=!!t}get allowStale(){return this[z6]}set maxAge(t){if("number"!==typeof t)throw new TypeError("maxAge must be a non-negative number");this[R6]=t,$6(this)}get maxAge(){return this[R6]}set lengthCalculator(t){"function"!==typeof t&&(t=q6),t!==this[O6]&&(this[O6]=t,this[N6]=0,this[L6].forEach((t=>{t.length=this[O6](t.value,t.key),this[N6]+=t.length}))),$6(this)}get lengthCalculator(){return this[O6]}get length(){return this[N6]}get itemCount(){return this[L6].length}rforEach(t,e){e=e||this;for(let n=this[L6].tail;null!==n;){const r=n.prev;Y6(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[L6].head;null!==n;){const r=n.next;Y6(this,t,n,e),n=r}}keys(){return this[L6].toArray().map((t=>t.key))}values(){return this[L6].toArray().map((t=>t.value))}reset(){this[P6]&&this[L6]&&this[L6].length&&this[L6].forEach((t=>this[P6](t.key,t.value))),this[j6]=new Map,this[L6]=new F6,this[N6]=0}dump(){return this[L6].map((t=>!W6(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[L6]}set(t,e,n){if((n=n||this[R6])&&"number"!==typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,i=this[O6](e,t);if(this[j6].has(t)){if(i>this[T6])return H6(this,this[j6].get(t)),!1;const o=this[j6].get(t).value;return this[P6]&&(this[B6]||this[P6](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[N6]+=i-o.length,o.length=i,this.get(t),$6(this),!0}const o=new Z6(t,e,i,r,n);return o.length>this[T6]?(this[P6]&&this[P6](t,e),!1):(this[N6]+=o.length,this[L6].unshift(o),this[j6].set(t,this[L6].head),$6(this),!0)}has(t){if(!this[j6].has(t))return!1;const e=this[j6].get(t).value;return!W6(this,e)}get(t){return I6(this,t,!0)}peek(t){return I6(this,t,!1)}pop(){const t=this[L6].tail;return t?(H6(this,t),t.value):null}del(t){H6(this,this[j6].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[j6].forEach(((t,e)=>I6(this,e,!1)))}};const G6=Object.freeze({loose:!0}),X6=Object.freeze({});var Q6=t=>t?"object"!==typeof t?G6:t:X6,J6={exports:{}};var K6={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};var t4="object"===typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/VizAbility",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"https://multimodal-accvis-6lvi554ivq-uc.a.run.app"}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",PUBLIC_URL:"/VizAbility",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"https://multimodal-accvis-6lvi554ivq-uc.a.run.app"}.NODE_DEBUG)?function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return console.error("SEMVER",...e)}:()=>{};!function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=K6,o=t4,a=(e=t.exports={}).re=[],s=e.safeRe=[],l=e.src=[],u=e.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],h=(t,e,n)=>{const r=(t=>{for(const[e,n]of d)t=t.split("".concat(e,"*")).join("".concat(e,"{0,").concat(n,"}")).split("".concat(e,"+")).join("".concat(e,"{1,").concat(n,"}"));return t})(e),i=c++;o(t,i,e),u[t]=i,l[i]=e,a[i]=new RegExp(e,n?"g":void 0),s[i]=new RegExp(r,n?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","\\d+"),h("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(f,"*")),h("MAINVERSION","(".concat(l[u.NUMERICIDENTIFIER],")\\.")+"(".concat(l[u.NUMERICIDENTIFIER],")\\.")+"(".concat(l[u.NUMERICIDENTIFIER],")")),h("MAINVERSIONLOOSE","(".concat(l[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(l[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(l[u.NUMERICIDENTIFIERLOOSE],")")),h("PRERELEASEIDENTIFIER","(?:".concat(l[u.NUMERICIDENTIFIER],"|").concat(l[u.NONNUMERICIDENTIFIER],")")),h("PRERELEASEIDENTIFIERLOOSE","(?:".concat(l[u.NUMERICIDENTIFIERLOOSE],"|").concat(l[u.NONNUMERICIDENTIFIER],")")),h("PRERELEASE","(?:-(".concat(l[u.PRERELEASEIDENTIFIER],"(?:\\.").concat(l[u.PRERELEASEIDENTIFIER],")*))")),h("PRERELEASELOOSE","(?:-?(".concat(l[u.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(l[u.PRERELEASEIDENTIFIERLOOSE],")*))")),h("BUILDIDENTIFIER","".concat(f,"+")),h("BUILD","(?:\\+(".concat(l[u.BUILDIDENTIFIER],"(?:\\.").concat(l[u.BUILDIDENTIFIER],")*))")),h("FULLPLAIN","v?".concat(l[u.MAINVERSION]).concat(l[u.PRERELEASE],"?").concat(l[u.BUILD],"?")),h("FULL","^".concat(l[u.FULLPLAIN],"$")),h("LOOSEPLAIN","[v=\\s]*".concat(l[u.MAINVERSIONLOOSE]).concat(l[u.PRERELEASELOOSE],"?").concat(l[u.BUILD],"?")),h("LOOSE","^".concat(l[u.LOOSEPLAIN],"$")),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE","".concat(l[u.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),h("XRANGEIDENTIFIER","".concat(l[u.NUMERICIDENTIFIER],"|x|X|\\*")),h("XRANGEPLAIN","[v=\\s]*(".concat(l[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(l[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(l[u.XRANGEIDENTIFIER],")")+"(?:".concat(l[u.PRERELEASE],")?").concat(l[u.BUILD],"?")+")?)?"),h("XRANGEPLAINLOOSE","[v=\\s]*(".concat(l[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(l[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(l[u.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(l[u.PRERELEASELOOSE],")?").concat(l[u.BUILD],"?")+")?)?"),h("XRANGE","^".concat(l[u.GTLT],"\\s*").concat(l[u.XRANGEPLAIN],"$")),h("XRANGELOOSE","^".concat(l[u.GTLT],"\\s*").concat(l[u.XRANGEPLAINLOOSE],"$")),h("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),h("COERCERTL",l[u.COERCE],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM","(\\s*)".concat(l[u.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",h("TILDE","^".concat(l[u.LONETILDE]).concat(l[u.XRANGEPLAIN],"$")),h("TILDELOOSE","^".concat(l[u.LONETILDE]).concat(l[u.XRANGEPLAINLOOSE],"$")),h("LONECARET","(?:\\^)"),h("CARETTRIM","(\\s*)".concat(l[u.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",h("CARET","^".concat(l[u.LONECARET]).concat(l[u.XRANGEPLAIN],"$")),h("CARETLOOSE","^".concat(l[u.LONECARET]).concat(l[u.XRANGEPLAINLOOSE],"$")),h("COMPARATORLOOSE","^".concat(l[u.GTLT],"\\s*(").concat(l[u.LOOSEPLAIN],")$|^$")),h("COMPARATOR","^".concat(l[u.GTLT],"\\s*(").concat(l[u.FULLPLAIN],")$|^$")),h("COMPARATORTRIM","(\\s*)".concat(l[u.GTLT],"\\s*(").concat(l[u.LOOSEPLAIN],"|").concat(l[u.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE","^\\s*(".concat(l[u.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(l[u.XRANGEPLAIN],")")+"\\s*$"),h("HYPHENRANGELOOSE","^\\s*(".concat(l[u.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(l[u.XRANGEPLAINLOOSE],")")+"\\s*$"),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(J6,J6.exports);var e4=J6.exports;const n4=/^[0-9]+$/,r4=(t,e)=>{const n=n4.test(t),r=n4.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1};var i4={compareIdentifiers:r4,rcompareIdentifiers:(t,e)=>r4(e,t)};const o4=t4,{MAX_LENGTH:a4,MAX_SAFE_INTEGER:s4}=K6,{safeRe:l4,t:u4}=e4,c4=Q6,{compareIdentifiers:f4}=i4;var d4=class t{constructor(e,n){if(n=c4(n),e instanceof t){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if("string"!==typeof e)throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof e,'".'));if(e.length>a4)throw new TypeError("version is longer than ".concat(a4," characters"));o4("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=e.trim().match(n.loose?l4[u4.LOOSE]:l4[u4.FULL]);if(!r)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>s4||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s4||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s4||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<s4)return e}return t})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(e){if(o4("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if("string"===typeof e&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),f4(this.major,e.major)||f4(this.minor,e.minor)||f4(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{const t=this.prerelease[n],r=e.prerelease[n];if(o4("prerelease compare",n,t,r),void 0===t&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===t)return-1;if(t!==r)return f4(t,r)}while(++n)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let n=0;do{const t=this.build[n],r=e.build[n];if(o4("prerelease compare",n,t,r),void 0===t&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===t)return-1;if(t!==r)return f4(t,r)}while(++n)}inc(t,e,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e,n),this.inc("pre",e,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e,n),this.inc("pre",e,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const t=Number(n)?1:0;if(!e&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[t];else{let r=this.prerelease.length;for(;--r>=0;)"number"===typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(e===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(t)}}if(e){let r=[e,t];!1===n&&(r=[e]),0===f4(this.prerelease[0],e)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error("invalid increment argument: ".concat(t))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}};const h4=d4;var p4=(t,e,n)=>new h4(t,n).compare(new h4(e,n));const m4=p4;var g4=(t,e,n)=>0===m4(t,e,n);const y4=p4;var v4=(t,e,n)=>0!==y4(t,e,n);const b4=p4;var x4=(t,e,n)=>b4(t,e,n)>0;const _4=p4;var w4=(t,e,n)=>_4(t,e,n)>=0;const k4=p4;var A4=(t,e,n)=>k4(t,e,n)<0;const E4=p4;var M4=(t,e,n)=>E4(t,e,n)<=0;const C4=g4,S4=v4,D4=x4,F4=w4,T4=A4,N4=M4;var O4,z4,R4,P4,B4=(t,e,n,r)=>{switch(e){case"===":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t===n;case"!==":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return C4(t,n,r);case"!=":return S4(t,n,r);case">":return D4(t,n,r);case">=":return F4(t,n,r);case"<":return T4(t,n,r);case"<=":return N4(t,n,r);default:throw new TypeError("Invalid operator: ".concat(e))}};function L4(){if(P4)return R4;P4=1;class t{constructor(e,i){if(i=n(i),e instanceof t)return e.loose===!!i.loose&&e.includePrerelease===!!i.includePrerelease?e:new t(e.raw,i);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((t=>this.parseRange(t.trim()))).filter((t=>t.length)),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(this.raw));if(this.set.length>1){const t=this.set[0];if(this.set=this.set.filter((t=>!h(t[0]))),0===this.set.length)this.set=[t];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&p(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((t=>t.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(t){const n=((this.options.includePrerelease&&f)|(this.options.loose&&d))+":"+t,o=e.get(n);if(o)return o;const p=this.options.loose,m=p?a[s.HYPHENRANGELOOSE]:a[s.HYPHENRANGE];t=t.replace(m,M(this.options.includePrerelease)),i("hyphen replace",t),t=t.replace(a[s.COMPARATORTRIM],l),i("comparator trim",t),t=t.replace(a[s.TILDETRIM],u),i("tilde trim",t),t=t.replace(a[s.CARETTRIM],c),i("caret trim",t);let y=t.split(" ").map((t=>g(t,this.options))).join(" ").split(/\s+/).map((t=>E(t,this.options)));p&&(y=y.filter((t=>(i("loose invalid filter",t,this.options),!!t.match(a[s.COMPARATORLOOSE]))))),i("range list",y);const v=new Map,b=y.map((t=>new r(t,this.options)));for(const e of b){if(h(e))return[e];v.set(e.value,e)}v.size>1&&v.has("")&&v.delete("");const x=[...v.values()];return e.set(n,x),x}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some((t=>m(t,n)&&e.set.some((e=>m(e,n)&&t.every((t=>e.every((e=>t.intersects(e,n)))))))))}test(t){if(!t)return!1;if("string"===typeof t)try{t=new o(t,this.options)}catch(C7){return!1}for(let e=0;e<this.set.length;e++)if(C(this.set[e],t,this.options))return!0;return!1}}R4=t;const e=new V6({max:1e3}),n=Q6,r=function(){if(z4)return O4;z4=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(r,i){if(i=n(i),r instanceof e){if(r.loose===!!i.loose)return r;r=r.value}r=r.trim().split(/\s+/).join(" "),a("comparator",r,i),this.options=i,this.loose=!!i.loose,this.parse(r),this.semver===t?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(e){const n=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],o=e.match(n);if(!o)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==o[1]?o[1]:"","="===this.operator&&(this.operator=""),o[2]?this.semver=new s(o[2],this.options.loose):this.semver=t}toString(){return this.value}test(e){if(a("Comparator.test",e,this.options.loose),this.semver===t||e===t)return!0;if("string"===typeof e)try{e=new s(e,this.options)}catch(C7){return!1}return o(e,this.operator,this.semver,this.options)}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new l(t.value,r).test(this.value):""===t.operator?""===t.value||new l(this.value,r).test(t.semver):(!(r=n(r)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==t.value)&&!(!r.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!t.operator.startsWith(">"))||!(!this.operator.startsWith("<")||!t.operator.startsWith("<"))||!(this.semver.version!==t.semver.version||!this.operator.includes("=")||!t.operator.includes("="))||!!(o(this.semver,"<",t.semver,r)&&this.operator.startsWith(">")&&t.operator.startsWith("<"))||!!(o(this.semver,">",t.semver,r)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}}O4=e;const n=Q6,{safeRe:r,t:i}=e4,o=B4,a=t4,s=d4,l=L4();return O4}(),i=t4,o=d4,{safeRe:a,t:s,comparatorTrimReplace:l,tildeTrimReplace:u,caretTrimReplace:c}=e4,{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:d}=K6,h=t=>"<0.0.0-0"===t.value,p=t=>""===t.value,m=(t,e)=>{let n=!0;const r=t.slice();let i=r.pop();for(;n&&r.length;)n=r.every((t=>i.intersects(t,e))),i=r.pop();return n},g=(t,e)=>(i("comp",t,e),t=x(t,e),i("caret",t),t=v(t,e),i("tildes",t),t=w(t,e),i("xrange",t),t=A(t,e),i("stars",t),t),y=t=>!t||"x"===t.toLowerCase()||"*"===t,v=(t,e)=>t.trim().split(/\s+/).map((t=>b(t,e))).join(" "),b=(t,e)=>{const n=e.loose?a[s.TILDELOOSE]:a[s.TILDE];return t.replace(n,((e,n,r,o,a)=>{let s;return i("tilde",t,e,n,r,o,a),y(n)?s="":y(r)?s=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):y(o)?s=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):a?(i("replaceTilde pr",a),s=">=".concat(n,".").concat(r,".").concat(o,"-").concat(a," <").concat(n,".").concat(+r+1,".0-0")):s=">=".concat(n,".").concat(r,".").concat(o," <").concat(n,".").concat(+r+1,".0-0"),i("tilde return",s),s}))},x=(t,e)=>t.trim().split(/\s+/).map((t=>_(t,e))).join(" "),_=(t,e)=>{i("caret",t,e);const n=e.loose?a[s.CARETLOOSE]:a[s.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,((e,n,o,a,s)=>{let l;return i("caret",t,e,n,o,a,s),y(n)?l="":y(o)?l=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):y(a)?l="0"===n?">=".concat(n,".").concat(o,".0").concat(r," <").concat(n,".").concat(+o+1,".0-0"):">=".concat(n,".").concat(o,".0").concat(r," <").concat(+n+1,".0.0-0"):s?(i("replaceCaret pr",s),l="0"===n?"0"===o?">=".concat(n,".").concat(o,".").concat(a,"-").concat(s," <").concat(n,".").concat(o,".").concat(+a+1,"-0"):">=".concat(n,".").concat(o,".").concat(a,"-").concat(s," <").concat(n,".").concat(+o+1,".0-0"):">=".concat(n,".").concat(o,".").concat(a,"-").concat(s," <").concat(+n+1,".0.0-0")):(i("no pr"),l="0"===n?"0"===o?">=".concat(n,".").concat(o,".").concat(a).concat(r," <").concat(n,".").concat(o,".").concat(+a+1,"-0"):">=".concat(n,".").concat(o,".").concat(a).concat(r," <").concat(n,".").concat(+o+1,".0-0"):">=".concat(n,".").concat(o,".").concat(a," <").concat(+n+1,".0.0-0")),i("caret return",l),l}))},w=(t,e)=>(i("replaceXRanges",t,e),t.split(/\s+/).map((t=>k(t,e))).join(" ")),k=(t,e)=>{t=t.trim();const n=e.loose?a[s.XRANGELOOSE]:a[s.XRANGE];return t.replace(n,((n,r,o,a,s,l)=>{i("xRange",t,n,r,o,a,s,l);const u=y(o),c=u||y(a),f=c||y(s),d=f;return"="===r&&d&&(r=""),l=e.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(a=0),s=0,">"===r?(r=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):"<="===r&&(r="<",c?o=+o+1:a=+a+1),"<"===r&&(l="-0"),n="".concat(r+o,".").concat(a,".").concat(s).concat(l)):c?n=">=".concat(o,".0.0").concat(l," <").concat(+o+1,".0.0-0"):f&&(n=">=".concat(o,".").concat(a,".0").concat(l," <").concat(o,".").concat(+a+1,".0-0")),i("xRange return",n),n}))},A=(t,e)=>(i("replaceStars",t,e),t.trim().replace(a[s.STAR],"")),E=(t,e)=>(i("replaceGTE0",t,e),t.trim().replace(a[e.includePrerelease?s.GTE0PRE:s.GTE0],"")),M=t=>(e,n,r,i,o,a,s,l,u,c,f,d,h)=>(n=y(r)?"":y(i)?">=".concat(r,".0.0").concat(t?"-0":""):y(o)?">=".concat(r,".").concat(i,".0").concat(t?"-0":""):a?">=".concat(n):">=".concat(n).concat(t?"-0":""),l=y(u)?"":y(c)?"<".concat(+u+1,".0.0-0"):y(f)?"<".concat(u,".").concat(+c+1,".0-0"):d?"<=".concat(u,".").concat(c,".").concat(f,"-").concat(d):t?"<".concat(u,".").concat(c,".").concat(+f+1,"-0"):"<=".concat(l),"".concat(n," ").concat(l).trim()),C=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let n=0;n<t.length;n++)if(i(t[n].semver),t[n].semver!==r.ANY&&t[n].semver.prerelease.length>0){const r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0};return R4}const j4=L4();var U4=(t,e,n)=>{try{e=new j4(e,n)}catch(C7){return!1}return e.test(t)},q4=k6(U4);var I4='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function W4(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)$4(t,i);return t}function $4(t,e){for(const n of Object.keys(e))fn(t,n,e[n],!0)}const H4=m;let Z4=g;const Y4="undefined"!==typeof window?window:void 0;void 0===Z4&&null!==Y4&&void 0!==Y4&&null!==(x6=Y4.vl)&&void 0!==x6&&x6.compile&&(Z4=Y4.vl);const V4={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},G4={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},X4={vega:"Vega","vega-lite":"Vega-Lite"},Q4={vega:H4.version,"vega-lite":Z4?Z4.version:"not available"},J4={vega:t=>t,"vega-lite":(t,e)=>Z4.compile(t,{config:e}).spec},K4='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',t8="chart-wrapper";function e8(t,e,n,r){const i="<html><head>".concat(e,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),a=window.open("");a.document.write(i+t+o),a.document.title="".concat(X4[r]," JSON Source")}function n8(t){return!(!t||!("load"in t))}function r8(t){return n8(t)?t:H4.loader(t)}async function i8(t,e){var n,r;let i,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ir(e)?(o=r8(a.loader),i=JSON.parse(await o.load(e))):i=e;const s=function(t){var e,n;const r=null!==(e=null===(n=t.usermeta)||void 0===n?void 0:n.embedOptions)&&void 0!==e?e:{};return ir(r.defaultStyle)&&(r.defaultStyle=!1),r}(i),l=s.loader;var u;o&&!l||(o=r8(null!==(u=a.loader)&&void 0!==u?u:l));const c=await o8(s,o),f=await o8(a,o),d={...W4(f,c),config:cn(null!==(n=f.config)&&void 0!==n?n:{},null!==(r=c.config)&&void 0!==r?r:{})};return await async function(t,e){var n,r,i,o,a,s,l;let u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0;const f=u.theme?cn(y[u.theme],null!==(n=u.config)&&void 0!==n?n:{}):u.config,d=Kn(u.actions)?u.actions:W4({},V4,null!==(r=u.actions)&&void 0!==r?r:{}),h={...G4,...u.i18n},p=null!==(i=u.renderer)&&void 0!==i?i:"canvas",m=null!==(o=u.logLevel)&&void 0!==o?o:H4.Warn,g=null!==(a=u.downloadFileName)&&void 0!==a?a:"visualization",v="string"===typeof t?document.querySelector(t):t;if(!v)throw new Error("".concat(t," does not exist"));if(!1!==u.defaultStyle){const t="vega-embed-style",{root:e,rootContainer:n}=function(t){var e;const n=t.getRootNode?t.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(e=document.head)&&void 0!==e?e:document.body}}(v);if(!e.getElementById(t)){const e=document.createElement("style");e.id=t,e.innerHTML=void 0===u.defaultStyle||!0===u.defaultStyle?I4.toString():u.defaultStyle,n.appendChild(e)}}const b=function(t,e){if(t.$schema){const r=h5(t.$schema);var n;e&&e!==r.library&&console.warn("The given visualization spec is written in ".concat(X4[r.library],", but mode argument sets ").concat(null!==(n=X4[e])&&void 0!==n?n:e,"."));const i=r.library;return q4(Q4[i],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(X4[i]," ").concat(r.version,", but the current version of ").concat(X4[i]," is v").concat(Q4[i],".")),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":null!==e&&void 0!==e?e:"vega"}(e,u.mode);let x=J4[b](e,f);if("vega-lite"===b&&x.$schema){const t=h5(x.$schema);q4(Q4.vega,"^".concat(t.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(t.version,", but current version is v").concat(Q4.vega,"."))}v.classList.add("vega-embed"),d&&v.classList.add("has-actions");v.innerHTML="";let _=v;if(d){const t=document.createElement("div");t.classList.add(t8),v.appendChild(t),_=t}const w=u.patch;w&&(x=w instanceof Function?w(x):ke(x,w,!0,!1).newDocument);u.formatLocale&&H4.formatLocale(u.formatLocale);u.timeFormatLocale&&H4.timeFormatLocale(u.timeFormatLocale);if(u.expressionFunctions)for(const y in u.expressionFunctions){const t=u.expressionFunctions[y];"fn"in t?H4.expressionFunction(y,t.fn,t.visitor):t instanceof Function&&H4.expressionFunction(y,t)}const{ast:k}=u,A=H4.parse(x,"vega-lite"===b?{}:f,{ast:k}),E=new(u.viewClass||H4.View)(A,{loader:c,logLevel:m,renderer:p,...k?{expr:null!==(s=null!==(l=H4.expressionInterpreter)&&void 0!==l?l:u.expr)&&void 0!==s?s:OI}:{}});if(E.addSignalListener("autosize",((t,e)=>{const{type:n}=e;"fit-x"==n?(_.classList.add("fit-x"),_.classList.remove("fit-y")):"fit-y"==n?(_.classList.remove("fit-x"),_.classList.add("fit-y")):"fit"==n?_.classList.add("fit-x","fit-y"):_.classList.remove("fit-x","fit-y")})),!1!==u.tooltip){const{loader:t,tooltip:e}=u,n=t&&!n8(t)?null===t||void 0===t?void 0:t.baseURL:void 0,r=function(t){return"function"===typeof t}(e)?e:new b6({baseURL:n,...!0===e?{}:e}).call;E.tooltip(r)}let M,{hover:C}=u;void 0===C&&(C="vega"===b);if(C){const{hoverSet:t,updateSet:e}="boolean"===typeof C?{}:C;E.hover(t,e)}u&&(null!=u.width&&E.width(u.width),null!=u.height&&E.height(u.height),null!=u.padding&&E.padding(u.padding));if(await E.initialize(_,u.bind).runAsync(),!1!==d){let t=v;if(!1!==u.defaultStyle||u.forceActionsMenu){const e=document.createElement("details");e.title=h.CLICK_TO_VIEW_ACTIONS,v.append(e),t=e;const n=document.createElement("summary");n.innerHTML=K4,e.append(n),M=t=>{e.contains(t.target)||e.removeAttribute("open")},document.addEventListener("click",M)}const n=document.createElement("div");if(t.append(n),n.classList.add("vega-actions"),!0===d||!1!==d.export)for(const e of["svg","png"])if(!0===d||!0===d.export||d.export[e]){const t=h["".concat(e.toUpperCase(),"_ACTION")],r=document.createElement("a"),i=ln(u.scaleFactor)?u.scaleFactor[e]:u.scaleFactor;r.text=t,r.href="#",r.target="_blank",r.download="".concat(g,".").concat(e),r.addEventListener("mousedown",(async function(t){t.preventDefault();const n=await E.toImageURL(e,i);this.href=n})),n.append(r)}if(!0===d||!1!==d.source){const t=document.createElement("a");t.text=h.SOURCE_ACTION,t.href="#",t.addEventListener("click",(function(t){var n,r;e8(Be()(e),null!==(n=u.sourceHeader)&&void 0!==n?n:"",null!==(r=u.sourceFooter)&&void 0!==r?r:"",b),t.preventDefault()})),n.append(t)}if("vega-lite"===b&&(!0===d||!1!==d.compiled)){const t=document.createElement("a");t.text=h.COMPILED_ACTION,t.href="#",t.addEventListener("click",(function(t){var e,n;e8(Be()(x),null!==(e=u.sourceHeader)&&void 0!==e?e:"",null!==(n=u.sourceFooter)&&void 0!==n?n:"","vega"),t.preventDefault()})),n.append(t)}if(!0===d||!1!==d.editor){var S;const t=null!==(S=u.editorUrl)&&void 0!==S?S:"https://vega.github.io/editor/",r=document.createElement("a");r.text=h.EDITOR_ACTION,r.href="#",r.addEventListener("click",(function(n){!function(t,e,n){const r=t.open(e),{origin:i}=new URL(e);let o=40;t.addEventListener("message",(function e(n){n.source===r&&(o=0,t.removeEventListener("message",e,!1))}),!1),setTimeout((function t(){o<=0||(r.postMessage(n,i),setTimeout(t,250),o-=1)}),250)}(window,t,{config:f,mode:b,renderer:p,spec:Be()(e)}),n.preventDefault()})),n.append(r)}}function D(){M&&document.removeEventListener("click",M),E.finalize()}return{view:E,spec:e,vgSpec:x,finalize:D,embedOptions:u}}(t,i,d,o)}async function o8(t,e){var n;const r=ir(t.config)?JSON.parse(await e.load(t.config)):null!==(n=t.config)&&void 0!==n?n:{},i=ir(t.patch)?JSON.parse(await e.load(t.patch)):t.patch;return{...t,...i?{patch:i}:{},...r?{config:r}:{}}}function a8(t,e){Object.keys(e).forEach((n=>{!function(t,e,n){var r;n&&((r=n)&&"[object Function]"==={}.toString.call(r)?n(t.data(e)):t.change(e,H4.changeset().remove((()=>!0)).insert(n)))}(t,n,e[n])}))}var s8=n(7),l8=n.n(s8);function u8(t){const e=new Set;return t.forEach((t=>{Object.keys(t).forEach((t=>{e.add(t)}))})),e}const c8=()=>{};function f8(t,e){const n=Object.keys(e);return n.forEach((n=>{try{t.addSignalListener(n,e[n])}catch($e){console.warn("Cannot add invalid signal listener.",$e)}})),n.length>0}var d8=n(262),h8=n.n(d8);function p8(t,e){const n=Object.keys(e);return n.forEach((n=>{try{t.removeSignalListener(n,e[n])}catch($e){console.warn("Cannot remove invalid signal listener.",$e)}})),n.length>0}function m8(t){const{spec:e,width:n,height:r}=t;return"undefined"!==typeof n&&"undefined"!==typeof r?{...e,width:n,height:r}:"undefined"!==typeof n?{...e,width:n}:"undefined"!==typeof r?{...e,height:r}:e}function g8(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class y8 extends b.PureComponent{constructor(){super(...arguments),g8(this,"containerRef",b.createRef()),g8(this,"resultPromise",void 0),g8(this,"handleError",(t=>{const{onError:e=c8}=this.props;e(t,this.containerRef.current),console.warn(t)})),g8(this,"modifyView",(t=>{this.resultPromise&&this.resultPromise.then((e=>(e&&t(e.view),!0))).catch(this.handleError)}))}componentDidMount(){this.createView()}componentDidUpdate(t){const e=u8([this.props,t]);if(e.delete("className"),e.delete("signalListeners"),e.delete("spec"),e.delete("style"),e.delete("width"),e.delete("height"),Array.from(e).some((e=>this.props[e]!==t[e])))this.clearView(),this.createView();else{const e=function(t,e){if(t===e)return!1;const n={width:!1,height:!1,isExpensive:!1},r=u8([t,e]);return!r.has("width")||"width"in t&&"width"in e&&t.width===e.width||("width"in t&&"number"===typeof t.width?n.width=t.width:n.isExpensive=!0),!r.has("height")||"height"in t&&"height"in e&&t.height===e.height||("height"in t&&"number"===typeof t.height?n.height=t.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some((n=>!(n in t)||!(n in e)||!h8()(t[n],e[n])))&&(n.isExpensive=!0),!(!1===n.width&&!1===n.height&&!n.isExpensive)&&n}(m8(this.props),m8(t)),{signalListeners:n}=this.props,{signalListeners:r}=t;if(e)if(e.isExpensive)this.clearView(),this.createView();else{const t=!oe(n,r);this.modifyView((i=>{!1!==e.width&&i.width(e.width),!1!==e.height&&i.height(e.height),t&&(r&&p8(i,r),n&&f8(i,n)),i.run()}))}else oe(n,r)||this.modifyView((t=>{r&&p8(t,r),n&&f8(t,n),t.run()}))}}componentWillUnmount(){this.clearView()}createView(){const{spec:t,onNewView:e,signalListeners:n={},width:r,height:i,...o}=this.props;if(this.containerRef.current){const t=m8(this.props);this.resultPromise=i8(this.containerRef.current,t,o).then((t=>{if(t){const{view:e}=t;f8(e,n)&&e.run()}return t})).catch(this.handleError),e&&this.modifyView(e)}}clearView(){return this.resultPromise&&this.resultPromise.then((t=>{t&&t.finalize()})).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:t,style:e}=this.props;return b.createElement("div",{ref:this.containerRef,className:t,style:e})}}function v8(){return v8=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},v8.apply(this,arguments)}function b8(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}g8(y8,"propTypes",{className:l8().string,onError:l8().func});class x8 extends b.PureComponent{constructor(){super(...arguments),b8(this,"vegaEmbed",b.createRef()),b8(this,"handleNewView",(t=>{this.update();const{onNewView:e=c8}=this.props;e(t)}))}componentDidMount(){this.update()}componentDidUpdate(t){oe(this.props.data,t.data)||this.update()}update(){const{data:t}=this.props;this.vegaEmbed.current&&t&&Object.keys(t).length>0&&this.vegaEmbed.current.modifyView((e=>{a8(e,t),e.resize().run()}))}render(){const{data:t,...e}=this.props;return b.createElement(y8,v8({ref:this.vegaEmbed},e,{onNewView:this.handleNewView}))}}function _8(){return _8=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_8.apply(this,arguments)}function w8(t){return b.createElement(x8,_8({},t,{mode:"vega-lite"}))}b8(x8,"defaultProps",{data:{}});const k8=b.forwardRef(((t,e)=>{let{bsPrefix:n,className:r,striped:i,bordered:o,borderless:a,hover:s,size:l,variant:u,responsive:c,...f}=t;const d=Lt(n,"table"),h=St()(r,d,u&&"".concat(d,"-").concat(u),l&&"".concat(d,"-").concat(l),i&&"".concat(d,"-").concat("string"===typeof i?"striped-".concat(i):"striped"),o&&"".concat(d,"-bordered"),a&&"".concat(d,"-borderless"),s&&"".concat(d,"-hover")),p=(0,Dt.jsx)("table",{...f,className:h,ref:e});if(c){let t="".concat(d,"-responsive");return"string"===typeof c&&(t="".concat(t,"-").concat(c)),(0,Dt.jsx)("div",{className:t,children:p})}return p})),A8=k8,E8=t=>{let{transformedData:e}=t;const[n,r]=(0,b.useState)([]);return(0,b.useEffect)((()=>{e.length&&r(Object.keys(e[0]))}),[e]),(0,Dt.jsx)("div",{className:"table-container",children:(0,Dt.jsxs)(A8,{responsive:!0,striped:!0,bordered:!0,hover:!0,size:"md",children:[(0,Dt.jsx)("thead",{children:(0,Dt.jsx)("tr",{children:n.map(((t,e)=>(0,Dt.jsx)("th",{children:t},"header-"+e)))})}),(0,Dt.jsx)("tbody",{children:e.map(((t,e)=>(0,Dt.jsx)("tr",{children:n.map(((e,n)=>"string"===typeof t[e]||"number"===typeof t[e]?(0,Dt.jsx)("td",{children:t[e]},"row-header"+n):(0,Dt.jsx)("td",{children:"non-string"},"row-header"+n)))},"row-"+e)))})]})})},M8={type:l8().string,tooltip:l8().bool,as:l8().elementType},C8=b.forwardRef(((t,e)=>{let{as:n="div",className:r,type:i="valid",tooltip:o=!1,...a}=t;return(0,Dt.jsx)(n,{...a,ref:e,className:St()(r,"".concat(i,"-").concat(o?"tooltip":"feedback"))})}));C8.displayName="Feedback",C8.propTypes=M8;const S8=C8,D8=b.createContext({}),F8=b.forwardRef(((t,e)=>{let{id:n,bsPrefix:r,className:i,type:o="checkbox",isValid:a=!1,isInvalid:s=!1,as:l="input",...u}=t;const{controlId:c}=(0,b.useContext)(D8);return r=Lt(r,"form-check-input"),(0,Dt.jsx)(l,{...u,ref:e,type:o,id:n||c,className:St()(i,r,a&&"is-valid",s&&"is-invalid")})}));F8.displayName="FormCheckInput";const T8=F8,N8=b.forwardRef(((t,e)=>{let{bsPrefix:n,className:r,htmlFor:i,...o}=t;const{controlId:a}=(0,b.useContext)(D8);return n=Lt(n,"form-check-label"),(0,Dt.jsx)("label",{...o,ref:e,htmlFor:i||a,className:St()(r,n)})}));N8.displayName="FormCheckLabel";const O8=N8;const z8=b.forwardRef(((t,e)=>{let{id:n,bsPrefix:r,bsSwitchPrefix:i,inline:o=!1,reverse:a=!1,disabled:s=!1,isValid:l=!1,isInvalid:u=!1,feedbackTooltip:c=!1,feedback:f,feedbackType:d,className:h,style:p,title:m="",type:g="checkbox",label:y,children:v,as:x="input",..._}=t;r=Lt(r,"form-check"),i=Lt(i,"form-switch");const{controlId:w}=(0,b.useContext)(D8),k=(0,b.useMemo)((()=>({controlId:n||w})),[w,n]),A=!v&&null!=y&&!1!==y||function(t,e){return b.Children.toArray(t).some((t=>b.isValidElement(t)&&t.type===e))}(v,O8),E=(0,Dt.jsx)(T8,{..._,type:"switch"===g?"checkbox":g,ref:e,isValid:l,isInvalid:u,disabled:s,as:x});return(0,Dt.jsx)(D8.Provider,{value:k,children:(0,Dt.jsx)("div",{style:p,className:St()(h,A&&r,o&&"".concat(r,"-inline"),a&&"".concat(r,"-reverse"),"switch"===g&&i),children:v||(0,Dt.jsxs)(Dt.Fragment,{children:[E,A&&(0,Dt.jsx)(O8,{title:m,children:y}),f&&(0,Dt.jsx)(S8,{type:d,tooltip:c,children:f})]})})})}));z8.displayName="FormCheck";const R8=Object.assign(z8,{Input:T8,Label:O8});n(391);const P8=b.forwardRef(((t,e)=>{let{bsPrefix:n,type:r,size:i,htmlSize:o,id:a,className:s,isValid:l=!1,isInvalid:u=!1,plaintext:c,readOnly:f,as:d="input",...h}=t;const{controlId:p}=(0,b.useContext)(D8);return n=Lt(n,"form-control"),(0,Dt.jsx)(d,{...h,type:r,size:o,ref:e,readOnly:f,id:a||p,className:St()(s,c?"".concat(n,"-plaintext"):n,i&&"".concat(n,"-").concat(i),"color"===r&&"".concat(n,"-color"),l&&"is-valid",u&&"is-invalid")})}));P8.displayName="FormControl";const B8=Object.assign(P8,{Feedback:S8}),L8=b.forwardRef(((t,e)=>{let{className:n,bsPrefix:r,as:i="div",...o}=t;return r=Lt(r,"form-floating"),(0,Dt.jsx)(i,{ref:e,className:St()(n,r),...o})}));L8.displayName="FormFloating";const j8=L8,U8=b.forwardRef(((t,e)=>{let{controlId:n,as:r="div",...i}=t;const o=(0,b.useMemo)((()=>({controlId:n})),[n]);return(0,Dt.jsx)(D8.Provider,{value:o,children:(0,Dt.jsx)(r,{...i,ref:e})})}));U8.displayName="FormGroup";const q8=U8;const I8=b.forwardRef(((t,e)=>{const[{className:n,...r},{as:i="div",bsPrefix:o,spans:a}]=function(t){let{as:e,bsPrefix:n,className:r,...i}=t;n=Lt(n,"col");const o=jt(),a=Ut(),s=[],l=[];return o.forEach((t=>{const e=i[t];let r,o,u;delete i[t],"object"===typeof e&&null!=e?({span:r,offset:o,order:u}=e):r=e;const c=t!==a?"-".concat(t):"";r&&s.push(!0===r?"".concat(n).concat(c):"".concat(n).concat(c,"-").concat(r)),null!=u&&l.push("order".concat(c,"-").concat(u)),null!=o&&l.push("offset".concat(c,"-").concat(o))})),[{...i,className:St()(r,...s,...l)},{as:e,bsPrefix:n,spans:s}]}(t);return(0,Dt.jsx)(i,{...r,ref:e,className:St()(n,!a.length&&o)})}));I8.displayName="Col";const W8=I8,$8=b.forwardRef(((t,e)=>{let{as:n="label",bsPrefix:r,column:i=!1,visuallyHidden:o=!1,className:a,htmlFor:s,...l}=t;const{controlId:u}=(0,b.useContext)(D8);r=Lt(r,"form-label");let c="col-form-label";"string"===typeof i&&(c="".concat(c," ").concat(c,"-").concat(i));const f=St()(a,r,o&&"visually-hidden",i&&c);return s=s||u,i?(0,Dt.jsx)(W8,{ref:e,as:"label",className:f,htmlFor:s,...l}):(0,Dt.jsx)(n,{ref:e,className:f,htmlFor:s,...l})}));$8.displayName="FormLabel";const H8=$8,Z8=b.forwardRef(((t,e)=>{let{bsPrefix:n,className:r,id:i,...o}=t;const{controlId:a}=(0,b.useContext)(D8);return n=Lt(n,"form-range"),(0,Dt.jsx)("input",{...o,type:"range",ref:e,className:St()(r,n),id:i||a})}));Z8.displayName="FormRange";const Y8=Z8,V8=b.forwardRef(((t,e)=>{let{bsPrefix:n,size:r,htmlSize:i,className:o,isValid:a=!1,isInvalid:s=!1,id:l,...u}=t;const{controlId:c}=(0,b.useContext)(D8);return n=Lt(n,"form-select"),(0,Dt.jsx)("select",{...u,size:i,ref:e,className:St()(o,n,r&&"".concat(n,"-").concat(r),a&&"is-valid",s&&"is-invalid"),id:l||c})}));V8.displayName="FormSelect";const G8=V8,X8=b.forwardRef(((t,e)=>{let{bsPrefix:n,className:r,as:i="small",muted:o,...a}=t;return n=Lt(n,"form-text"),(0,Dt.jsx)(i,{...a,ref:e,className:St()(r,n,o&&"text-muted")})}));X8.displayName="FormText";const Q8=X8,J8=b.forwardRef(((t,e)=>(0,Dt.jsx)(R8,{...t,ref:e,type:"switch"})));J8.displayName="Switch";const K8=Object.assign(J8,{Input:R8.Input,Label:R8.Label}),t7=b.forwardRef(((t,e)=>{let{bsPrefix:n,className:r,children:i,controlId:o,label:a,...s}=t;return n=Lt(n,"form-floating"),(0,Dt.jsxs)(q8,{ref:e,className:St()(r,n),controlId:o,...s,children:[i,(0,Dt.jsx)("label",{htmlFor:o,children:a})]})}));t7.displayName="FloatingLabel";const e7=t7,n7={_ref:l8().any,validated:l8().bool,as:l8().elementType},r7=b.forwardRef(((t,e)=>{let{className:n,validated:r,as:i="form",...o}=t;return(0,Dt.jsx)(i,{...o,ref:e,className:St()(n,r&&"was-validated")})}));r7.displayName="Form",r7.propTypes=n7;const i7=Object.assign(r7,{Group:q8,Control:B8,Floating:j8,Check:R8,Switch:K8,Label:H8,Text:Q8,Range:Y8,Select:G8,FloatingLabel:e7}),o7=b.createContext(null);o7.displayName="InputGroupContext";const a7=o7,s7=b.forwardRef(((t,e)=>{let{className:n,bsPrefix:r,as:i="span",...o}=t;return r=Lt(r,"input-group-text"),(0,Dt.jsx)(i,{ref:e,className:St()(n,r),...o})}));s7.displayName="InputGroupText";const l7=s7,u7=b.forwardRef(((t,e)=>{let{bsPrefix:n,size:r,hasValidation:i,className:o,as:a="div",...s}=t;n=Lt(n,"input-group");const l=(0,b.useMemo)((()=>({})),[]);return(0,Dt.jsx)(a7.Provider,{value:l,children:(0,Dt.jsx)(a,{ref:e,...s,className:St()(o,n,r&&"".concat(n,"-").concat(r),i&&"has-validation")})})}));u7.displayName="InputGroup";const c7=Object.assign(u7,{Text:l7,Radio:t=>(0,Dt.jsx)(l7,{children:(0,Dt.jsx)(T8,{type:"radio",...t})}),Checkbox:t=>(0,Dt.jsx)(l7,{children:(0,Dt.jsx)(T8,{type:"checkbox",...t})})}),f7=t=>{let{answerToQuestion:e,classificationExplanation:n,isLoadingAnswer:r,suggestedQuestions:i,handleQuestionSubmit:o,revisedQuestion:a}=t;return(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)($t,{children:i.map(((t,e)=>(0,Dt.jsx)(It,{variant:"outline-secondary",onClick:()=>o(t),children:t},"question"+e)))}),(0,Dt.jsx)(i7,{onSubmit:t=>{t.preventDefault(),o(t.target.question.value),t.target.question.value=""},children:(0,Dt.jsxs)(c7,{children:[(0,Dt.jsx)(i7.Control,{name:"question",placeholder:"Type your question here."}),(0,Dt.jsx)(It,{type:"submit",variant:"outline-secondary",children:"Submit"}),(0,Dt.jsx)(It,{variant:"outline-secondary",children:"Record"})]})}),(0,Dt.jsx)($t,{children:r&&(0,Dt.jsx)("p",{children:"Working, please wait!"})}),!r&&n&&e&&(0,Dt.jsxs)($t,{children:[(0,Dt.jsx)("h4",{children:"Response: "}),(0,Dt.jsxs)("p",{children:["Question: ",n]}),(0,Dt.jsxs)("p",{children:["Revised Question: ",a]}),(0,Dt.jsxs)("p",{children:["Answer: ",e]})]})]})};class d7{constructor(){this.items=[]}push(t){this.items.push(t)}pop(){if(this.isEmpty())throw new Error("Stack is empty");return this.items.pop()}peek(){if(this.isEmpty())throw new Error("Stack is empty");return this.items[this.items.length-1]}isEmpty(){return 0===this.items.length}size(){return this.items.length}clear(){this.items=[]}}class h7{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.content=t,this.ariaLevel=this.setAriaLevel(),this.parent=e,this.children=n,this.address="",this.isActiveChild=!1}setAriaLevel(){return this.content?parseInt(this.content.getAttribute("aria-level")):0}setIsActiveChild(t){this.isActiveChild=t}getIsActiveChild(){return this.isActiveChild}setAddress(t){this.address=t}getAddress(){return this.address}getAriaLevel(){return this.ariaLevel}addChild(t){this.children.push(t)}getChildren(){return this.children}setParent(t){this.parent=t}getParent(){return this.parent}getContent(){return this.content}getInnerText(){return this.content?this.content.children[0].innerText:null}}class p7{constructor(){this.elements=[]}enqueue(t){this.elements.push(t)}dequeue(){return this.elements.shift()}isEmpty(){return 0===this.elements.length}size(){return this.elements.length}shift(){if(0===this.elements.length)return null;const t=this.elements[0];return this.elements.splice(0,1),t}}class m7{constructor(t){this.olliVis=t,this.head=new h7(null),this.condensedString="",this.treeItemArray=[this.head],this.treeItemDictionary={},this.addressArray=[],this.initialize()}initialize(){this.populateTreeItemArray(),this.treeItemDictionary=this.convertToDictionary(),this.condensedString=this.convertToCSV(this.treeItemDictionary)}getCondensedString(){return this.condensedString}convertToCSV(t){let e="Hierarchy,Content\n";for(let[n,r]of Object.entries(t)){let t=r.getInnerText().indexOf("."),i=r.getInnerText().indexOf(" of ");r=-1!==i&&-1!==t&&i<t?r.getInnerText().slice(t+2):r.getInnerText(),e+="".concat(n," // ").concat(r.replace("Press t to open table.","").replace("1 value.","").replace(" equals",":"),"\n")}return e}convertToDictionary(){const t={};for(let e=1;e<this.treeItemArray.length;e++){const n=this.treeItemArray[e],r=1===e?"1":this.getHierarchyKey(n);n.setAddress(r),r.endsWith("1")&&n.setIsActiveChild(!0),this.addressArray.push(r),t[r]=n}return t}getHierarchyKey(t){let e="",n=t;for(;null!==n.parent;)e="."+(n.parent.children.indexOf(n)+1)+e,n=n.parent;return e.substring(1,e.length)}getOlliVis(){return this.olliVis}getTreeItemArray(){return this.treeItemArray}recursionFunction(t,e){t.getAriaLevel()>this.treeItemArray[e].getAriaLevel()?(this.treeItemArray[e].addChild(t),t.setParent(this.treeItemArray[e])):this.recursionFunction(t,e-1)}populateTreeItemArray(){if(null===this.olliVis)return;const t=this.olliVis.querySelectorAll('[role="tree"]')[0].querySelectorAll('[role="treeitem"]');for(var e=0;e<t.length;e++){var n=new h7(t[e]);this.recursionFunction(n,e),this.treeItemArray.push(n)}}printIsActiveChildNodes(){this.treeItemArray.forEach((t=>{t.getIsActiveChild()}))}getNodeFromAddress(t){const e=this.treeItemArray.findIndex((e=>e.getAddress()==t));return this.treeItemArray[e]}getShortestPath(t,e){function n(t,e,n){for(let r=0;r<t.length;r++)if(t[r][[e]]&&t[r][[e]][0]==n)return!0;return!1}function r(t){const e=t.getParent();if(e){return e.getChildren().findIndex((e=>e.getAddress()===t.getAddress()))}return-1}function i(t){const e=t.getChildren();for(let n=0;n<e.length;n++)if(e[n].getIsActiveChild())return e[n].getAddress();return null}const o=new p7;o.enqueue({node:t,address:t.getAddress(),activeChildAddress:i(t),indexWithinParent:r(t)});const a=[];for(;o.size()>0;){const{node:t,address:s,activeChildAddress:l,indexWithinParent:u}=o.shift();if(s===e.getAddress())break;if(u>0){const t=s.slice(0,-1)+u;if(this.treeItemDictionary[t]){const e=this.getNodeFromAddress(t);o.enqueue({node:e,address:t,activeChildAddress:i(e),indexWithinParent:u-1}),n(a,t,s)||a.push({[t]:[s,"left"]})}}if(u<t.getParent().getChildren().length-1){const t=s.slice(0,-1)+(u+2);if(this.treeItemDictionary[t]){const e=this.getNodeFromAddress(t);o.enqueue({node:e,address:t,activeChildAddress:i(e),indexWithinParent:u+1}),n(a,t,s)||a.push({[t]:[s,"right"]})}}if(t.getParent()){const t=s.slice(0,-2);if(this.treeItemDictionary[t]){const e=this.getNodeFromAddress(t);o.enqueue({node:e,address:t,activeChildAddress:i(e),indexWithinParent:r(e)}),n(a,t,s)||a.push({[t]:[s,"up"]})}}if(0!=t.getChildren().length){const t=l;if(l){const e=this.getNodeFromAddress(l);o.enqueue({node:e,address:t,activeChildAddress:i(e),indexWithinParent:r(e)}),n(a,t,s)||a.push({[t]:[s,"down"]})}}}let s=null;for(let f=0;f<a.length;f++){Object.keys(a[f])[0]==e.getAddress()&&(s=a[f])}let l=[];l.push(Object.values(s)[0]);const u=new p7;for(u.enqueue(l);u.size()>0&&(l=u.dequeue(),l[l.length-1][0]!=t.getAddress());)for(let t=0;t<a.length;t++)if(Object.keys(a[t])[0]==l[l.length-1][0]){let e=[];for(let t=0;t<l.length;t++)e.push(l[t]);e.push(Object.values(a[t])[0]),u.enqueue(e)}let c="";for(let f=l.length-1;f>=0;f--)c+="Press the "+l[f][1]+" arrow key. ";return c}}let g7,y7="",v7=null,b7=null,x7=null;const _7=t=>{let{graphSpec:e,setGraphSpec:n}=t;const[r,i]=(0,b.useState)(!1),[o,a]=(0,b.useState)(!1),[s,l]=(0,b.useState)([]),[u,c]=(0,b.useState)(!1),[f,d]=(0,b.useState)([]),[h,p]=(0,b.useState)(!1),[m,g]=(0,b.useState)(""),[y,v]=(0,b.useState)(""),[x,_]=(0,b.useState)("");function w(){_(""),g(""),v("")}function k(t){const n=function(t,n){return t.map((t=>{const r={};for(const e in t)if("Symbol(vega_id)"!==e)if("date"==e){let n=Gt(t,e);const i=new Date(n),o=i.getUTCFullYear(),a=i.getUTCMonth()+1,s=i.getUTCDate(),l="".concat(o,"-").concat(a,"-").concat(s);r[e]=t[e],r["formatted_date(Y-M-D)"]=l}else if("country"==e){let n=Xt(Gt(t,e));r.continent=n,r[e]=t[e]}else"inventory"==e?r.inventory_of_houses_for_sale=t[e]:r[e]=t[e];if(e.encoding.color&&e.encoding.color.field){const i=n.scale("color"),o=t[e.encoding.color.field];if("None"!==o){const t=i(o);r.Color=Kt(t)}}return r}))}(t.data("source_0"),t);l(n);const r={content:n};fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/process-json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((t=>{t.ok?console.log("JSON file sent successfully."):console.log("JSON file sent unsuccessfully.")})).catch((t=>{console.error("Error:",t)}))}async function A(t,e,n){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]||n.startsWith("The variables you mentioned")||n.includes("I am sorry but I cannot understand the question")||n.includes("Agent stopped due to iteration limit or time limit")){const r=await async function(t,e,n){return fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-backend-file?file_path=gptPrompts/subsequentSuggestionPrompt.txt",{redirect:"manual"}).then((function(t){return t.json()})).then((async function(r){let i=t.match(/first child of the head:(.*?)(?=Active Element)/s)[1];console.log("EXTRACTED",i);var o=r.contents;let a=o.indexOf("first child of the head:"),s=(o=ne(o,i,a,"first child of the head:")).indexOf("a blind user asked the question:"),l=(o=ne(o,e,s,"a blind user asked the question:")).indexOf("my application responded:");return te(o=ne(o,n,l,"my application responded:"),"gpt-3.5-turbo-1106").then((function(t){return t})).catch((function(t){console.error(t)}))}))}(t,e,n),i=r.split(/Question [1-3]: /).slice(1);d(i)}}return(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)($t,{children:e&&(0,Dt.jsx)(w8,{spec:e,onNewView:t=>{c(!0),w(),k(t);const r=document.querySelector('input[type="range"]');if(r){const i=r.getAttribute("name");r.addEventListener("input",(()=>{const o=parseInt(r.value,10);t.signal(i,o).runAsync();const a={...e};for(let t=0;t<a.params.length;t++)a.params[t].name===i&&(a.params[t].value=o);n(a),k(t)}))}const i=document.getElementById("olli-container"),o=new d7;g7=new m7(document.querySelector(".olli-vis"));!function(t){(async function(t){return fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-backend-file?file_path=gptPrompts/initialSuggestionPrompt.txt",{redirect:"manual"}).then((function(t){return t.json()})).then((async function(e){var n,r=e.contents,i="follows:",o=r.indexOf(i);return-1!==o?n=r.substring(0,o+8)+"\n"+t+r.substring(o+8):console.log("Substring 'follows:' not found in the initialSuggestions string."),te(n,"gpt-3.5-turbo-1106").then((function(t){return t})).catch((function(t){console.error(t)}))}))})(t).then((function(t){const e=t.split(/Question [1-3]: /).slice(1);e.push("What is my current position within the Olli Treeview?"),d(e)})).catch((t=>{console.log("Error in getting suggestion:",t)}))}(g7.getCondensedString()),c(!1),function(t,e){t.addEventListener("keyup",(function(t){t.stopImmediatePropagation(),y7=t.srcElement.firstChild.innerText;const n=g7.getTreeItemArray().findIndex((t=>t.getInnerText()===y7));if(-1!==n){if(v7=g7.getTreeItemArray()[n],b7=v7.getAddress(),x7=v7.getInnerText(),38===t.keyCode){const t=e.peek();let n=null;g7.getTreeItemArray().forEach((e=>{e.getInnerText()==t.getInnerText()&&(n=e),e.getAddress().slice(0,-1)==t.getAddress().slice(0,-1)&&e.setIsActiveChild(!1)})),n.setIsActiveChild(!0)}else 37!==t.keyCode&&39!==t.keyCode||(g7.getTreeItemArray().forEach((t=>{t.getAddress().slice(0,-1)==v7.getAddress().slice(0,-1)&&t.setIsActiveChild(!1)})),v7.setIsActiveChild(!0));e.push(v7)}}))}(i,o)}})}),u&&(0,Dt.jsx)("h3",{children:"LOADING"}),e&&(0,Dt.jsxs)("span",{children:[(0,Dt.jsx)(It,{variant:"outline-secondary",onClick:()=>{i(!r),r||a(!1)},children:"Toggle Olli"}),(0,Dt.jsx)(It,{variant:"outline-success",onClick:()=>{a(!o),o||i(!1)},children:"Toggle Table"})]}),(0,Dt.jsx)(Yt,{showOlli:r,graphSpec:e}),o&&(0,Dt.jsx)(E8,{transformedData:s}),(0,Dt.jsx)(f7,{classificationExplanation:m,answerToQuestion:y,isLoadingAnswer:h,handleQuestionSubmit:async function(t){if(h)return void console.log("STILL WAITING for previous question!");w(),p(!0);const e=await re(t,g7.getCondensedString(),b7,x7,g7),n=e.queryType,r=e.questionRevised,i=e.answer,o=e.supplement;if(_(r),n.includes("Analytical Query")||n.includes("Visual Query")){g('Your question "'+t+'" was categorized as being data-driven, and as such, has been answered based on the data in the chart.'),await A(o,t,i),v("Agent stopped due to iteration limit or time limit."!==i?i:"I'm sorry; the process has been terminated because it either took too long to arrive at an answer or your question was too long.")}else if(n.includes("Contextual Query")){g('Your question "'+t+'" was categorized as being context-seeking, and as such, has been answered based on information found on the web.'),await A(o,r,i),v("Agent stopped due to iteration limit or time limit."!==i?i:"I'm sorry; the process has been terminated because it either took too long to arrive at an answer or your question was too long.")}else if(n.includes("Navigation Query")){g('Your question "'+t+'" was categorized as being related to navigating the chart structure, and as such has been answered based on the treeview.'),v(i)}else{g('Your question "'+t+'" was categorized as being data-driven, and as such, has been answered based on the data in the chart.'),await A(o,r,i,!0),v("Agent stopped due to iteration limit or time limit."!==i?i:"I'm sorry; the process has been terminated because it either took too long to arrive at an answer or your question was too long.")}p(!1)},suggestedQuestions:f,revisedQuestion:x})]})},w7=b.forwardRef(((t,e)=>{let{bsPrefix:n,fluid:r=!1,as:i="div",className:o,...a}=t;const s=Lt(n,"container"),l="string"===typeof r?"-".concat(r):"-fluid";return(0,Dt.jsx)(i,{ref:e,...a,className:St()(o,r?"".concat(s).concat(l):s)})}));w7.displayName="Container";const k7=w7,A7=()=>{const[t,e]=(0,b.useState)(""),[n,r]=(0,b.useState)(!1);return(0,b.useEffect)((()=>{t&&"custom"!==t&&async function(){const e=await fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/get-backend-file?file_path=./test/testVegaLiteSpecs/"+t+".vg"),n=await e.json(),i=JSON.parse(n.contents);r(i)}()}),[t]),(0,Dt.jsxs)("div",{className:"content",children:[(0,Dt.jsx)("h1",{className:"title",children:"VizAbility - Data Visualization"}),(0,Dt.jsxs)("h2",{children:["Load in a chart by selecting one of the four options or upload your own file.",(0,Dt.jsx)("br",{})," Explore the structure and components of the chart through a text representation. ",(0,Dt.jsx)("br",{}),"Supplement your knowledge of the chart by asking questions, either through typing or voice input. "]}),(0,Dt.jsxs)(k7,{children:[(0,Dt.jsx)($t,{children:(0,Dt.jsxs)(i7.Group,{onChange:async function(t){const n=await async function(t){return new Promise(((e,n)=>{if(t.length>0){var r=t[0];if(r.name.endsWith(".json")||r.name.endsWith(".vg")){var i=new FileReader;i.onload=function(t){var n=t.target.result;e({contents:n})},i.onerror=function(t){console.error("Error occurred while reading the file.",t),n(t)},i.readAsText(r)}else alert("Please select a JSON or VG file."),e(null)}else e(null)}))}(t.target.files);try{n&&(console.log("in submit"),function(t){if(t){const e={vgSpec:t.contents};fetch("https://multimodal-accvis-6lvi554ivq-uc.a.run.app/api/process-vega-lite-spec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((t=>{t.ok?console.log("VG Spec sent successfully!"):console.error("Failed to send VG Spec.")})).catch((t=>{console.error("Error in sending spec:",t)}))}}(n),r(JSON.parse(n.contents)),e("custom"))}catch($e){console.log("error",$e)}},controlId:"formFile",className:"mb-3",children:[(0,Dt.jsx)(i7.Label,{children:"Upload Local File"}),(0,Dt.jsx)(i7.Control,{type:"file",accept:".json, .vg"})]})}),(0,Dt.jsxs)($t,{className:"justify-content-md-center",children:[(0,Dt.jsxs)(W8,{children:[" ",(0,Dt.jsx)(It,{size:"lg",onClick:()=>{e("chart1")},children:" Line Chart "})," "]}),(0,Dt.jsxs)(W8,{children:[" ",(0,Dt.jsx)(It,{size:"lg",onClick:()=>{e("chart2")},children:" Bar Chart "})," "]}),(0,Dt.jsxs)(W8,{children:[" ",(0,Dt.jsx)(It,{size:"lg",onClick:()=>{e("chart3")},children:" Scatter Plot "})," "]}),(0,Dt.jsxs)(W8,{children:[" ",(0,Dt.jsx)(It,{size:"lg",onClick:()=>{e("chart4")},children:" Choropleth Map "})," "]})]})]}),t&&(0,Dt.jsx)("p",{children:"Graph selected."}),n&&(0,Dt.jsx)(_7,{graphSpec:n,setGraphSpec:r})]})};const E7=function(){return(0,Dt.jsx)("div",{className:"App",children:(0,Dt.jsx)(At,{children:(0,Dt.jsx)(_t,{children:(0,Dt.jsx)(bt,{path:"/VizAbility",element:(0,Dt.jsx)(A7,{})})})})})},M7=t=>{t&&t instanceof Function&&n.e(787).then(n.bind(n,787)).then((e=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:o,getTTFB:a}=e;n(t),r(t),i(t),o(t),a(t)}))};_.createRoot(document.getElementById("root")).render((0,Dt.jsx)(b.StrictMode,{children:(0,Dt.jsx)(E7,{})})),M7()})()})();
//# sourceMappingURL=main.0e8b0dff.js.map